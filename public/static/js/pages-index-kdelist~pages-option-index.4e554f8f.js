(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-index-kdelist~pages-option-index"],{"0249":function(t,e,a){a("7ba0"),a("3700"),a("4682"),a("bd44"),a("8d4a"),a("e003"),a("395e"),t.exports=a("2194").Map},"0481":function(t,e,a){"use strict";var i=a("23e7"),r=a("a2bf"),n=a("7b0b"),s=a("50c4"),o=a("a691"),h=a("65f0");i({target:"Array",proto:!0},{flat:function(){var t=arguments.length?arguments[0]:void 0,e=n(this),a=s(e.length),i=h(e,0);return i.length=r(i,e,e,a,0,void 0===t?1:o(t)),i}})},"079a":function(t,e,a){var i=a("c7a9"),r=a("9f34"),n=a("ea39"),s=a("3a23")("IE_PROTO"),o=function(){},h="prototype",l=function(){var t,e=a("c023")("iframe"),i=n.length,r="<",s=">";e.style.display="none",a("e4a9").appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write(r+"script"+s+"document.F=Object"+r+"/script"+s),t.close(),l=t.F;while(i--)delete l[h][n[i]];return l()};t.exports=Object.create||function(t,e){var a;return null!==t?(o[h]=i(t),a=new o,o[h]=null,a[s]=t):a=l(),void 0===e?a:r(a,e)}},"0856":function(t,e,a){var i=a("760a")("meta"),r=a("fab1"),n=a("e3b0"),s=a("9492").f,o=0,h=Object.isExtensible||function(){return!0},l=!a("a4bc")((function(){return h(Object.preventExtensions({}))})),u=function(t){s(t,i,{value:{i:"O"+ ++o,w:{}}})},C=function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!n(t,i)){if(!h(t))return"F";if(!e)return"E";u(t)}return t[i].i},D=function(t,e){if(!n(t,i)){if(!h(t))return!0;if(!e)return!1;u(t)}return t[i].w},f=function(t){return l&&c.NEED&&h(t)&&!n(t,i)&&u(t),t},c=t.exports={KEY:i,NEED:!1,fastKey:C,getWeak:D,onFreeze:f}},"0999":function(t,e,a){var i=a("fab1"),r=a("38e8"),n=a("a12e")("species");t.exports=function(t){var e;return r(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!r(e.prototype)||(e=void 0),i(e)&&(e=e[n],null===e&&(e=void 0))),void 0===e?Array:e}},"09b7":function(t,e,a){t.exports={default:a("55a6"),__esModule:!0}},"09cf":function(t,e,a){"use strict";var i=a("d8ed"),r=a("2194"),n=a("9492"),s=a("be29"),o=a("a12e")("species");t.exports=function(t){var e="function"==typeof r[t]?r[t]:i[t];s&&e&&!e[o]&&n.f(e,o,{configurable:!0,get:function(){return this}})}},"0a2e":function(t,e,a){"use strict";var i=a("9bda"),r=a("f7cb"),n=a("1b2a"),s=a("fd84");t.exports=a("b2e7")(Array,"Array",(function(t,e){this._t=s(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,a=this._i++;return!t||a>=t.length?(this._t=void 0,r(1)):r(0,"keys"==e?a:"values"==e?t[a]:[a,t[a]])}),"values"),n.Arguments=n.Array,i("keys"),i("values"),i("entries")},"0a9b":function(t,e){t.exports=function(t,e,a){var i=void 0===a;switch(e.length){case 0:return i?t():t.call(a);case 1:return i?t(e[0]):t.call(a,e[0]);case 2:return i?t(e[0],e[1]):t.call(a,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(a,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(a,e[0],e[1],e[2],e[3])}return t.apply(a,e)}},"0b4c":function(t,e,a){var i=a("db81");i(i.S,"Object",{create:a("079a")})},"0ef2":function(t,e,a){var i=a("e472"),r=a("ea39");t.exports=Object.keys||function(t){return i(t,r)}},"137e":function(t,e,a){a("afd1"),t.exports=a("2194").Math.log10},"16d8":function(t,e,a){var i=a("e3b0"),r=a("8494"),n=a("3a23")("IE_PROTO"),s=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),i(t,n)?t[n]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},"1a52":function(t,e,a){"use strict";var i=a("53ab"),r=a.n(i);r.a},"1b2a":function(t,e){t.exports={}},"1c10":function(t,e,a){a("f7a9")("observable")},"1c7d":function(t,e,a){t.exports={default:a("4604"),__esModule:!0}},"20da":function(t,e,a){var i=a("2194"),r=i.JSON||(i.JSON={stringify:JSON.stringify});t.exports=function(t){return r.stringify.apply(r,arguments)}},2130:function(t,e,a){var i=a("7737");t.exports=function(t,e,a){for(var r in e)a&&t[r]?t[r]=e[r]:i(t,r,e[r]);return t}},"216d":function(t,e,a){"use strict";t.exports.Chart=a("6539").default,t.exports.Stock=a("cd9b").default,t.exports.RegressionTest=a("25b3").default},2194:function(t,e){var a=t.exports={version:"2.6.12"};"number"==typeof __e&&(__e=a)},"23e3":function(t,e,a){var i=a("ccbf"),r=a("3762"),n=a("e42f"),s=a("c7a9"),o=a("91d6"),h=a("295c"),l={},u={};e=t.exports=function(t,e,a,C,D){var f,c,d,m,v=D?function(){return t}:h(t),S=i(a,C,e?2:1),I=0;if("function"!=typeof v)throw TypeError(t+" is not iterable!");if(n(v)){for(f=o(t.length);f>I;I++)if(m=e?S(s(c=t[I])[0],c[1]):S(t[I]),m===l||m===u)return m}else for(d=v.call(t);!(c=d.next()).done;)if(m=r(d,S,c.value,e),m===l||m===u)return m};e.BREAK=l,e.RETURN=u},"247b":function(t,e,a){"use strict";var i;a.d(e,"b",(function(){return r})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){return i}));var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.canvasId?a("v-uni-canvas",{staticClass:"ec-canvas",attrs:{id:t.canvasId,canvasId:t.canvasId},on:{touchstart:function(e){arguments[0]=e=t.$handleEvent(e),t.touchStart.apply(void 0,arguments)},touchmove:function(e){arguments[0]=e=t.$handleEvent(e),t.touchMove.apply(void 0,arguments)},touchend:function(e){arguments[0]=e=t.$handleEvent(e),t.touchEnd.apply(void 0,arguments)},error:function(e){arguments[0]=e=t.$handleEvent(e),t.error.apply(void 0,arguments)}}}):t._e()},n=[]},"25b3":function(t,e,a){"use strict";a("e25e"),Object.defineProperty(e,"__esModule",{value:!0});var i=a("cb17"),r=n(i);function n(t){return t&&t.__esModule?t:{default:t}}function s(){this.HistoryData,this.BuyData,this.SellData,this.IndexClose,this.NetCalculateModel=0,this.InitialCapital=1e4,this.Data=new r.default,this.SetPolicyData=function(t){this.HistoryData=t.KLineData,this.BuyData=t.BuyData,this.SellData=t.SellData,t.IndexClose&&(this.IndexClose=t.IndexClose)},this.ClearData=function(){this.Data=new r.default},this.GetBSData=function(t){for(var e=null,a=0;a<this.HistoryData.length;++a){var i=this.HistoryData[a];if(i.Date>=t){e=a;break}}if(null===e)return null;console.log("[RegressionTest::GetBSData] startDate="+t+" index="+e);var r=[],n=null;for(a=e;a<this.HistoryData.length;++a){var s=this.BuyData[a],o=this.SellData[a],h=this.HistoryData[a];if(null===n){if(s>0){var l={Data:h,Count:0};a+1<this.HistoryData.length&&(l.NextOpen=this.HistoryData[a+1].Open),n={B:[l],S:null}}}else{for(var u in n.B)++n.B[u].Count;if(s>0){l={Data:h,Count:0};a+1<this.HistoryData.length&&(l.NextOpen=this.HistoryData[a+1].Open),n.B.push(l)}else o>0&&(n.S={Data:h},r.push(n),n=null)}}var C={StartDate:this.HistoryData[e].Date,StartIndex:e,Count:this.HistoryData.length-e,BSData:r};return console.log("[RegressionTest::GetBSData] data",C),C},this.Calculate=function(t){var e={Count:t.Count,Max:null,Min:null,Average:null},a={Count:0,Days:0,Success:0,Fail:0,SuccessRate:0};for(var i in t.BSData){var r=t.BSData[i];for(var n in r.B){var s=r.B[n];(null===e.Max||e.Max<s.Count)&&(e.Max=s.Count),(null===e.Min||e.Min>s.Count)&&(e.Min=s.Count),++a.Count,a.Days+=s.Count,r.S.Data.Close>s.Data.Open?++a.Success:++a.Fail}}a.Count>0&&(e.Average=a.Days/a.Count,a.SuccessRate=a.Success/a.Count);var o,h=1;for(var i in t.BSData){r=t.BSData[i];o=1===this.NetCalculateModel&&r.B[0].NextOpen>0?r.B[0].NextOpen:r.B[0].Data.Open;var l=r.S.Data.Close,u=(l-o)/o+1;h*=u}h-=1;var C=this.HistoryData[t.StartIndex].Close,D=this.HistoryData[this.HistoryData.length-1].Close,f=(D-C)/C;console.log("[RegressionTest::Calculate] stock profit first["+this.HistoryData[t.StartIndex].Date+", YClose="+this.HistoryData[t.StartIndex].YClose+"] end["+this.HistoryData[this.HistoryData.length-1].Date+", Close="+this.HistoryData[this.HistoryData.length-1].Close+"]");var c=this.CaclulateNetValue(t),d=null,m=null;c&&c.length>0&&(d=this.CaclulateMaxDropdown(c),this.IndexClose&&(m=this.CaclulateBeta(c)));var v={Day:e,Trade:a,Profit:h,StockProfit:f,Excess:h-f,NetValue:c,MaxDropdown:d,Beta:m,BSDataPair:t.BSData};return console.log("[RegressionTest::Calculate] NetCalculateModel, result ",this.NetCalculateModel,v),v},this.CaclulateNetValue=function(t){for(var e,a=t.StartIndex,i=[],r={Position:0,Cache:this.InitialCapital},n=null,s=a;s<this.HistoryData.length;++s){var o=this.BuyData[s],h=this.SellData[s],l=this.HistoryData[s],u={Date:l.Date,Position:r.Position,Cache:r.Cache,Open:l.Open,Close:l.Close};if(u.MarketValue=u.Position*u.Close+u.Cache,null===n){if(o>0){n={B:{Data:l},S:null},e=1===this.NetCalculateModel&&s+1<this.HistoryData.length&&this.HistoryData[s+1].Open>0?this.HistoryData[s+1].Open:u.Open;var C=parseInt(u.Cache/e),D=u.Cache-e*C;u.Position=C,u.Cache=D,u.MarketValue=u.Position*u.Close+u.Cache}}else if(h>0){n.S={Data:l},n=null;var f=u.Position*u.Close;u.Position=0,u.Cache+=f,u.MarketValue=u.Position*u.Close+u.Cache}r.Position=u.Position,r.Cache=u.Cache,u.Net=u.MarketValue/this.InitialCapital,this.IndexClose&&(u.IndexClose=this.IndexClose[s]),i.push(u)}if(i.length<=0)return[];var c=[];for(s=0;s<i.length;++s){var d=i[s],m={Net:d.Net,Date:d.Date,Close:d.Close};d.IndexClose&&(m.IndexClose=d.IndexClose),c.push(m)}return c},this.CaclulateMaxDropdown=function(t){for(var e,a=t[0].Net,i=0,r=1;r<t.length;++r){var n=t[r],s=1-n.Net/a;i<s&&(i=s,e=n),a<n.Net&&(a=n.Net)}return console.log("[RegressionTest::CaclulateMaxDropdown] maxDay",e),i},this.CaclulateBeta=function(t){for(var e=t[0],a=[],i=[],r=0,n=0,s=1;s<t.length;++s){a[s-1]=0,i[s-1]=0;var o=t[s];o.IndexClose>0&&e.IndexClose>0&&(a[s-1]=(o.IndexClose-e.IndexClose)/e.IndexClose),o.Net>0&&e.Net>0&&(i[s-1]=(o.Net-e.Net)/e.Net),r+=a[s-1],n+=i[s-1],e=o}var h=r/a.length,l=n/i.length,u=0;for(s=0;s<a.length;++s)u+=(i[s]-l)*(a[s]-h);var C=0;for(s=0;s<a.length;++s)C+=(a[s]-h)*(a[s]-h);return u/C},this.Execute=function(t){for(var e in t){var a=t[e];if(this.Data.has(a.Name))console.log("[RegressionTest::Execute] id="+e+" Name="+a.Name+" Date:"+a.Date+" is exsit.");else{console.log("[RegressionTest::Execute] id="+e+" Name="+a.Name+" Date:"+a.Date);var i=this.GetBSData(a.Date),r=this.Calculate(i);this.Data.set(a.Name,r)}}}}s.CaclulateOverlayData=function(t){if(!t.Main||!t.Sub)return null;var e=t.Main.length;for(var a in t.Sub){var i=t.Sub[a];if(i.length!=e)return console.log("[RegressionTest::OverlayData] id="+a+" data count not match. MainData count="+e),null}var r=[],n={Sub:[]};n.Main=t.Main[0],r.push([]);for(a=0;a<t.Sub.length;++a){var s=t.Sub[a];n.Sub[a]=s[0],r.push([])}for(a=0;a<t.Main.length;++a){var o=t.Main[a],h=(o-n.Main)/n.Main;r[0][a]=h;for(var l=0;l<t.Sub.length;++l){s=t.Sub[l];var u=s[a],C=(u-n.Sub[l])/n.Sub[l];r[l+1][a]=C}}return r},s.GetPolicyData=function(t){var e={KLineData:null,IndexClose:null,BuyData:null,SellData:null};for(var a in e.KLineData=t.HistoryData.Data,t.OutVar){var i=t.OutVar[a];"INDEXCLOSE"==i.Name?e.IndexClose=i.Data:"DRAWICON"==i.Name&&i.Draw&&i.Draw.Icon&&(13===i.Draw.Icon.ID?e.BuyData=i.Draw.DrawData:14===i.Draw.Icon.ID&&(e.SellData=i.Draw.DrawData))}return e.KLineData&&e.BuyData&&e.SellData?e:null},e.default={RegressionTest:s}},2721:function(t,e,a){"use strict";var i=a("079a"),r=a("d8ec"),n=a("74ac"),s={};a("7737")(s,a("a12e")("iterator"),(function(){return this})),t.exports=function(t,e,a){t.prototype=i(s,{next:r(1,a)}),n(t,e+" Iterator")}},"295c":function(t,e,a){var i=a("3b3b"),r=a("a12e")("iterator"),n=a("1b2a");t.exports=a("2194").getIteratorMethod=function(t){if(void 0!=t)return t[r]||t["@@iterator"]||n[i(t)]}},"369d":function(t,e,a){var i=a("db81");i(i.S+i.F*!a("be29"),"Object",{defineProperty:a("9492").f})},3700:function(t,e,a){"use strict";var i=a("f98a")(!0);a("b2e7")(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,a=this._i;return a>=e.length?{value:void 0,done:!0}:(t=i(e,a),this._i+=t.length,{value:t,done:!1})}))},"374f":function(t,e,a){var i=a("e1b6");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},3762:function(t,e,a){var i=a("c7a9");t.exports=function(t,e,a,r){try{return r?e(i(a)[0],a[1]):e(a)}catch(s){var n=t["return"];throw void 0!==n&&i(n.call(t)),s}}},"38e8":function(t,e,a){var i=a("e1b6");t.exports=Array.isArray||function(t){return"Array"==i(t)}},"395e":function(t,e,a){a("dd0f")("Map")},"3a23":function(t,e,a){var i=a("6a78")("keys"),r=a("760a");t.exports=function(t){return i[t]||(i[t]=r(t))}},"3a83":function(t,e,a){"use strict";a.r(e);var i=a("247b"),r=a("df7e");for(var n in r)"default"!==n&&function(t){a.d(e,t,(function(){return r[t]}))}(n);a("1a52");var s,o=a("f0c5"),h=Object(o["a"])(r["default"],i["b"],i["c"],!1,null,"505e2c95",null,!1,i["a"],s);e["default"]=h.exports},"3af9":function(t,e,a){"use strict";var i=a("d8ed"),r=a("db81"),n=a("0856"),s=a("a4bc"),o=a("7737"),h=a("2130"),l=a("23e3"),u=a("919c"),C=a("fab1"),D=a("74ac"),f=a("9492").f,c=a("8fa6")(0),d=a("be29");t.exports=function(t,e,a,m,v,S){var I=i[t],p=I,T=v?"set":"add",g=p&&p.prototype,x={};return d&&"function"==typeof p&&(S||g.forEach&&!s((function(){(new p).entries().next()})))?(p=e((function(e,a){u(e,p,t,"_c"),e._c=new I,void 0!=a&&l(a,v,e[T],e)})),c("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),(function(t){var e="add"==t||"set"==t;!(t in g)||S&&"clear"==t||o(p.prototype,t,(function(a,i){if(u(this,p,t),!e&&S&&!C(a))return"get"==t&&void 0;var r=this._c[t](0===a?0:a,i);return e?this:r}))})),S||f(p.prototype,"size",{get:function(){return this._c.size}})):(p=m.getConstructor(e,t,v,T),h(p.prototype,a),n.NEED=!0),D(p,t),x[t]=p,r(r.G+r.W+r.F,x),S||m.setStrong(p,t,v),p}},"3b3b":function(t,e,a){var i=a("e1b6"),r=a("a12e")("toStringTag"),n="Arguments"==i(function(){return arguments}()),s=function(t,e){try{return t[e]}catch(a){}};t.exports=function(t){var e,a,o;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(a=s(e=Object(t),r))?a:n?i(e):"Object"==(o=i(e))&&"function"==typeof e.callee?"Arguments":o}},"3c8c":function(t,e,a){t.exports={default:a("137e"),__esModule:!0}},"3ca0":function(t,e,a){"use strict";var i=a("d291");function r(t){var e,a;this.promise=new t((function(t,i){if(void 0!==e||void 0!==a)throw TypeError("Bad Promise constructor");e=t,a=i})),this.resolve=i(e),this.reject=i(a)}t.exports.f=function(t){return new r(t)}},4069:function(t,e,a){var i=a("44d2");i("flat")},"41d3":function(t,e,a){"use strict";e.__esModule=!0;var i=a("7cbb"),r=h(i),n=a("4ccc"),s=h(n),o="function"===typeof s.default&&"symbol"===typeof r.default?function(t){return typeof t}:function(t){return t&&"function"===typeof s.default&&t.constructor===s.default&&t!==s.default.prototype?"symbol":typeof t};function h(t){return t&&t.__esModule?t:{default:t}}e.default="function"===typeof s.default&&"symbol"===o(r.default)?function(t){return"undefined"===typeof t?"undefined":o(t)}:function(t){return t&&"function"===typeof s.default&&t.constructor===s.default&&t!==s.default.prototype?"symbol":"undefined"===typeof t?"undefined":o(t)}},4307:function(t,e,a){a("4a87"),a("7ba0"),a("a14b"),a("1c10"),t.exports=a("2194").Symbol},4604:function(t,e,a){a("0b4c");var i=a("2194").Object;t.exports=function(t,e){return i.create(t,e)}},4682:function(t,e,a){a("0a2e");for(var i=a("d8ed"),r=a("7737"),n=a("1b2a"),s=a("a12e")("toStringTag"),o="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),h=0;h<o.length;h++){var l=o[h],u=i[l],C=u&&u.prototype;C&&!C[s]&&r(C,s,l),n[l]=n.Array}},"468f":function(t,e,a){t.exports=a("7737")},"4a87":function(t,e,a){"use strict";var i=a("d8ed"),r=a("e3b0"),n=a("be29"),s=a("db81"),o=a("468f"),h=a("0856").KEY,l=a("a4bc"),u=a("6a78"),C=a("74ac"),D=a("760a"),f=a("a12e"),c=a("66f0"),d=a("f7a9"),m=a("ee8a"),v=a("38e8"),S=a("c7a9"),I=a("fab1"),p=a("8494"),T=a("fd84"),g=a("73ff"),x=a("d8ec"),F=a("079a"),y=a("dff4"),L=a("fb65"),E=a("b22c"),M=a("9492"),A=a("0ef2"),N=L.f,w=M.f,O=y.f,R=i.Symbol,P=i.JSON,b=P&&P.stringify,B="prototype",V=f("_hidden"),G=f("toPrimitive"),H={}.propertyIsEnumerable,Y=u("symbol-registry"),k=u("symbols"),_=u("op-symbols"),X=Object[B],W="function"==typeof R&&!!E.f,U=i.QObject,K=!U||!U[B]||!U[B].findChild,J=n&&l((function(){return 7!=F(w({},"a",{get:function(){return w(this,"a",{value:7}).a}})).a}))?function(t,e,a){var i=N(X,e);i&&delete X[e],w(t,e,a),i&&t!==X&&w(X,e,i)}:w,z=function(t){var e=k[t]=F(R[B]);return e._k=t,e},q=W&&"symbol"==typeof R.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof R},Z=function(t,e,a){return t===X&&Z(_,e,a),S(t),e=g(e,!0),S(a),r(k,e)?(a.enumerable?(r(t,V)&&t[V][e]&&(t[V][e]=!1),a=F(a,{enumerable:x(0,!1)})):(r(t,V)||w(t,V,x(1,{})),t[V][e]=!0),J(t,e,a)):w(t,e,a)},Q=function(t,e){S(t);var a,i=m(e=T(e)),r=0,n=i.length;while(n>r)Z(t,a=i[r++],e[a]);return t},j=function(t,e){return void 0===e?F(t):Q(F(t),e)},$=function(t){var e=H.call(this,t=g(t,!0));return!(this===X&&r(k,t)&&!r(_,t))&&(!(e||!r(this,t)||!r(k,t)||r(this,V)&&this[V][t])||e)},tt=function(t,e){if(t=T(t),e=g(e,!0),t!==X||!r(k,e)||r(_,e)){var a=N(t,e);return!a||!r(k,e)||r(t,V)&&t[V][e]||(a.enumerable=!0),a}},et=function(t){var e,a=O(T(t)),i=[],n=0;while(a.length>n)r(k,e=a[n++])||e==V||e==h||i.push(e);return i},at=function(t){var e,a=t===X,i=O(a?_:T(t)),n=[],s=0;while(i.length>s)!r(k,e=i[s++])||a&&!r(X,e)||n.push(k[e]);return n};W||(R=function(){if(this instanceof R)throw TypeError("Symbol is not a constructor!");var t=D(arguments.length>0?arguments[0]:void 0),e=function(a){this===X&&e.call(_,a),r(this,V)&&r(this[V],t)&&(this[V][t]=!1),J(this,t,x(1,a))};return n&&K&&J(X,t,{configurable:!0,set:e}),z(t)},o(R[B],"toString",(function(){return this._k})),L.f=tt,M.f=Z,a("9b21").f=y.f=et,a("8144").f=$,E.f=at,n&&!a("d04b")&&o(X,"propertyIsEnumerable",$,!0),c.f=function(t){return z(f(t))}),s(s.G+s.W+s.F*!W,{Symbol:R});for(var it="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;it.length>rt;)f(it[rt++]);for(var nt=A(f.store),st=0;nt.length>st;)d(nt[st++]);s(s.S+s.F*!W,"Symbol",{for:function(t){return r(Y,t+="")?Y[t]:Y[t]=R(t)},keyFor:function(t){if(!q(t))throw TypeError(t+" is not a symbol!");for(var e in Y)if(Y[e]===t)return e},useSetter:function(){K=!0},useSimple:function(){K=!1}}),s(s.S+s.F*!W,"Object",{create:j,defineProperty:Z,defineProperties:Q,getOwnPropertyDescriptor:tt,getOwnPropertyNames:et,getOwnPropertySymbols:at});var ot=l((function(){E.f(1)}));s(s.S+s.F*ot,"Object",{getOwnPropertySymbols:function(t){return E.f(p(t))}}),P&&s(s.S+s.F*(!W||l((function(){var t=R();return"[null]"!=b([t])||"{}"!=b({a:t})||"{}"!=b(Object(t))}))),"JSON",{stringify:function(t){var e,a,i=[t],r=1;while(arguments.length>r)i.push(arguments[r++]);if(a=e=i[1],(I(e)||void 0!==t)&&!q(t))return v(e)||(e=function(t,e){if("function"==typeof a&&(e=a.call(this,t,e)),!q(e))return e}),i[1]=e,b.apply(P,i)}}),R[B][G]||a("7737")(R[B],G,R[B].valueOf),C(R,"Symbol"),C(Math,"Math",!0),C(i.JSON,"JSON",!0)},"4ccc":function(t,e,a){t.exports={default:a("4307"),__esModule:!0}},"53ab":function(t,e,a){var i=a("6271");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=a("4f06").default;r("282be6e3",i,!0,{sourceMap:!1,shadowMode:!1})},"554f":function(t,e,a){var i,r;a("a4d3"),a("e01a"),a("d28b"),a("99af"),a("4de4"),a("7db0"),a("0481"),a("c975"),a("d81d"),a("26e9"),a("fb6a"),a("4e82"),a("a434"),a("4069"),a("3410"),a("d3b7"),a("acd8"),a("e25e"),a("4d63"),a("ac1f"),a("25f0"),a("3ca3"),a("466d"),a("5319"),a("1276"),a("498a"),a("ddb0"),
/*!
 * jQuery JavaScript Library v3.6.1
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2022-08-26T17:52Z
 */
function(e,a){"use strict";"object"===typeof t.exports?t.exports=e.document?a(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return a(t)}:a(e)}("undefined"!==typeof window?window:this,(function(a,n){"use strict";var s=[],o=Object.getPrototypeOf,h=s.slice,l=s.flat?function(t){return s.flat.call(t)}:function(t){return s.concat.apply([],t)},u=s.push,C=s.indexOf,D={},f=D.toString,c=D.hasOwnProperty,d=c.toString,m=d.call(Object),v={},S=function(t){return"function"===typeof t&&"number"!==typeof t.nodeType&&"function"!==typeof t.item},I=function(t){return null!=t&&t===t.window},p=a.document,T={type:!0,src:!0,nonce:!0,noModule:!0};function g(t,e,a){a=a||p;var i,r,n=a.createElement("script");if(n.text=t,e)for(i in T)r=e[i]||e.getAttribute&&e.getAttribute(i),r&&n.setAttribute(i,r);a.head.appendChild(n).parentNode.removeChild(n)}function x(t){return null==t?t+"":"object"===typeof t||"function"===typeof t?D[f.call(t)]||"object":typeof t}var F="3.6.1",y=function t(e,a){return new t.fn.init(e,a)};function L(t){var e=!!t&&"length"in t&&t.length,a=x(t);return!S(t)&&!I(t)&&("array"===a||0===e||"number"===typeof e&&e>0&&e-1 in t)}y.fn=y.prototype={jquery:F,constructor:y,length:0,toArray:function(){return h.call(this)},get:function(t){return null==t?h.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=y.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return y.each(this,t)},map:function(t){return this.pushStack(y.map(this,(function(e,a){return t.call(e,a,e)})))},slice:function(){return this.pushStack(h.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(y.grep(this,(function(t,e){return(e+1)%2})))},odd:function(){return this.pushStack(y.grep(this,(function(t,e){return e%2})))},eq:function(t){var e=this.length,a=+t+(t<0?e:0);return this.pushStack(a>=0&&a<e?[this[a]]:[])},end:function(){return this.prevObject||this.constructor()},push:u,sort:s.sort,splice:s.splice},y.extend=y.fn.extend=function(){var t,e,a,i,r,n,s=arguments[0]||{},o=1,h=arguments.length,l=!1;for("boolean"===typeof s&&(l=s,s=arguments[o]||{},o++),"object"===typeof s||S(s)||(s={}),o===h&&(s=this,o--);o<h;o++)if(null!=(t=arguments[o]))for(e in t)i=t[e],"__proto__"!==e&&s!==i&&(l&&i&&(y.isPlainObject(i)||(r=Array.isArray(i)))?(a=s[e],n=r&&!Array.isArray(a)?[]:r||y.isPlainObject(a)?a:{},r=!1,s[e]=y.extend(l,n,i)):void 0!==i&&(s[e]=i));return s},y.extend({expando:"jQuery"+(F+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,a;return!(!t||"[object Object]"!==f.call(t))&&(e=o(t),!e||(a=c.call(e,"constructor")&&e.constructor,"function"===typeof a&&d.call(a)===m))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t,e,a){g(t,{nonce:e&&e.nonce},a)},each:function(t,e){var a,i=0;if(L(t)){for(a=t.length;i<a;i++)if(!1===e.call(t[i],i,t[i]))break}else for(i in t)if(!1===e.call(t[i],i,t[i]))break;return t},makeArray:function(t,e){var a=e||[];return null!=t&&(L(Object(t))?y.merge(a,"string"===typeof t?[t]:t):u.call(a,t)),a},inArray:function(t,e,a){return null==e?-1:C.call(e,t,a)},merge:function(t,e){for(var a=+e.length,i=0,r=t.length;i<a;i++)t[r++]=e[i];return t.length=r,t},grep:function(t,e,a){for(var i,r=[],n=0,s=t.length,o=!a;n<s;n++)i=!e(t[n],n),i!==o&&r.push(t[n]);return r},map:function(t,e,a){var i,r,n=0,s=[];if(L(t))for(i=t.length;n<i;n++)r=e(t[n],n,a),null!=r&&s.push(r);else for(n in t)r=e(t[n],n,a),null!=r&&s.push(r);return l(s)},guid:1,support:v}),"function"===typeof Symbol&&(y.fn[Symbol.iterator]=s[Symbol.iterator]),y.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(t,e){D["[object "+e+"]"]=e.toLowerCase()}));var E=
/*!
   * Sizzle CSS Selector Engine v2.3.6
   * https://sizzlejs.com/
   *
   * Copyright JS Foundation and other contributors
   * Released under the MIT license
   * https://js.foundation/
   *
   * Date: 2021-02-16
   */
function(t){var e,a,i,r,n,s,o,h,l,u,C,D,f,c,d,m,v,S,I,p="sizzle"+1*new Date,T=t.document,g=0,x=0,F=ht(),y=ht(),L=ht(),E=ht(),M=function(t,e){return t===e&&(C=!0),0},A={}.hasOwnProperty,N=[],w=N.pop,O=N.push,R=N.push,P=N.slice,b=function(t,e){for(var a=0,i=t.length;a<i;a++)if(t[a]===e)return a;return-1},B="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",V="[\\x20\\t\\r\\n\\f]",G="(?:\\\\[\\da-fA-F]{1,6}"+V+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",H="\\["+V+"*("+G+")(?:"+V+"*([*^$|!~]?=)"+V+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+G+"))|)"+V+"*\\]",Y=":("+G+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+H+")*)|.*)\\)|)",k=new RegExp(V+"+","g"),_=new RegExp("^"+V+"+|((?:^|[^\\\\])(?:\\\\.)*)"+V+"+$","g"),X=new RegExp("^"+V+"*,"+V+"*"),W=new RegExp("^"+V+"*([>+~]|"+V+")"+V+"*"),U=new RegExp(V+"|>"),K=new RegExp(Y),J=new RegExp("^"+G+"$"),z={ID:new RegExp("^#("+G+")"),CLASS:new RegExp("^\\.("+G+")"),TAG:new RegExp("^("+G+"|[*])"),ATTR:new RegExp("^"+H),PSEUDO:new RegExp("^"+Y),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+V+"*(even|odd|(([+-]|)(\\d*)n|)"+V+"*(?:([+-]|)"+V+"*(\\d+)|))"+V+"*\\)|)","i"),bool:new RegExp("^(?:"+B+")$","i"),needsContext:new RegExp("^"+V+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+V+"*((?:-\\d)?\\d*)"+V+"*\\)|)(?=[^-]|$)","i")},q=/HTML$/i,Z=/^(?:input|select|textarea|button)$/i,Q=/^h\d$/i,j=/^[^{]+\{\s*\[native \w/,$=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tt=/[+~]/,et=new RegExp("\\\\[\\da-fA-F]{1,6}"+V+"?|\\\\([^\\r\\n\\f])","g"),at=function(t,e){var a="0x"+t.slice(1)-65536;return e||(a<0?String.fromCharCode(a+65536):String.fromCharCode(a>>10|55296,1023&a|56320))},it=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,rt=function(t,e){return e?"\0"===t?"ï¿½":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},nt=function(){D()},st=pt((function(t){return!0===t.disabled&&"fieldset"===t.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{R.apply(N=P.call(T.childNodes),T.childNodes),N[T.childNodes.length].nodeType}catch(Et){R={apply:N.length?function(t,e){O.apply(t,P.call(e))}:function(t,e){var a=t.length,i=0;while(t[a++]=e[i++]);t.length=a-1}}}function ot(t,e,i,r){var n,o,l,u,C,c,v,S=e&&e.ownerDocument,T=e?e.nodeType:9;if(i=i||[],"string"!==typeof t||!t||1!==T&&9!==T&&11!==T)return i;if(!r&&(D(e),e=e||f,d)){if(11!==T&&(C=$.exec(t)))if(n=C[1]){if(9===T){if(!(l=e.getElementById(n)))return i;if(l.id===n)return i.push(l),i}else if(S&&(l=S.getElementById(n))&&I(e,l)&&l.id===n)return i.push(l),i}else{if(C[2])return R.apply(i,e.getElementsByTagName(t)),i;if((n=C[3])&&a.getElementsByClassName&&e.getElementsByClassName)return R.apply(i,e.getElementsByClassName(n)),i}if(a.qsa&&!E[t+" "]&&(!m||!m.test(t))&&(1!==T||"object"!==e.nodeName.toLowerCase())){if(v=t,S=e,1===T&&(U.test(t)||W.test(t))){S=tt.test(t)&&vt(e.parentNode)||e,S===e&&a.scope||((u=e.getAttribute("id"))?u=u.replace(it,rt):e.setAttribute("id",u=p)),c=s(t),o=c.length;while(o--)c[o]=(u?"#"+u:":scope")+" "+It(c[o]);v=c.join(",")}try{return R.apply(i,S.querySelectorAll(v)),i}catch(g){E(t,!0)}finally{u===p&&e.removeAttribute("id")}}}return h(t.replace(_,"$1"),e,i,r)}function ht(){var t=[];function e(a,r){return t.push(a+" ")>i.cacheLength&&delete e[t.shift()],e[a+" "]=r}return e}function lt(t){return t[p]=!0,t}function ut(t){var e=f.createElement("fieldset");try{return!!t(e)}catch(Et){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function Ct(t,e){var a=t.split("|"),r=a.length;while(r--)i.attrHandle[a[r]]=e}function Dt(t,e){var a=e&&t,i=a&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(i)return i;if(a)while(a=a.nextSibling)if(a===e)return-1;return t?1:-1}function ft(t){return function(e){var a=e.nodeName.toLowerCase();return"input"===a&&e.type===t}}function ct(t){return function(e){var a=e.nodeName.toLowerCase();return("input"===a||"button"===a)&&e.type===t}}function dt(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&st(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function mt(t){return lt((function(e){return e=+e,lt((function(a,i){var r,n=t([],a.length,e),s=n.length;while(s--)a[r=n[s]]&&(a[r]=!(i[r]=a[r]))}))}))}function vt(t){return t&&"undefined"!==typeof t.getElementsByTagName&&t}for(e in a=ot.support={},n=ot.isXML=function(t){var e=t&&t.namespaceURI,a=t&&(t.ownerDocument||t).documentElement;return!q.test(e||a&&a.nodeName||"HTML")},D=ot.setDocument=function(t){var e,r,s=t?t.ownerDocument||t:T;return s!=f&&9===s.nodeType&&s.documentElement?(f=s,c=f.documentElement,d=!n(f),T!=f&&(r=f.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",nt,!1):r.attachEvent&&r.attachEvent("onunload",nt)),a.scope=ut((function(t){return c.appendChild(t).appendChild(f.createElement("div")),"undefined"!==typeof t.querySelectorAll&&!t.querySelectorAll(":scope fieldset div").length})),a.attributes=ut((function(t){return t.className="i",!t.getAttribute("className")})),a.getElementsByTagName=ut((function(t){return t.appendChild(f.createComment("")),!t.getElementsByTagName("*").length})),a.getElementsByClassName=j.test(f.getElementsByClassName),a.getById=ut((function(t){return c.appendChild(t).id=p,!f.getElementsByName||!f.getElementsByName(p).length})),a.getById?(i.filter["ID"]=function(t){var e=t.replace(et,at);return function(t){return t.getAttribute("id")===e}},i.find["ID"]=function(t,e){if("undefined"!==typeof e.getElementById&&d){var a=e.getElementById(t);return a?[a]:[]}}):(i.filter["ID"]=function(t){var e=t.replace(et,at);return function(t){var a="undefined"!==typeof t.getAttributeNode&&t.getAttributeNode("id");return a&&a.value===e}},i.find["ID"]=function(t,e){if("undefined"!==typeof e.getElementById&&d){var a,i,r,n=e.getElementById(t);if(n){if(a=n.getAttributeNode("id"),a&&a.value===t)return[n];r=e.getElementsByName(t),i=0;while(n=r[i++])if(a=n.getAttributeNode("id"),a&&a.value===t)return[n]}return[]}}),i.find["TAG"]=a.getElementsByTagName?function(t,e){return"undefined"!==typeof e.getElementsByTagName?e.getElementsByTagName(t):a.qsa?e.querySelectorAll(t):void 0}:function(t,e){var a,i=[],r=0,n=e.getElementsByTagName(t);if("*"===t){while(a=n[r++])1===a.nodeType&&i.push(a);return i}return n},i.find["CLASS"]=a.getElementsByClassName&&function(t,e){if("undefined"!==typeof e.getElementsByClassName&&d)return e.getElementsByClassName(t)},v=[],m=[],(a.qsa=j.test(f.querySelectorAll))&&(ut((function(t){var e;c.appendChild(t).innerHTML="<a id='"+p+"'></a><select id='"+p+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]="+V+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||m.push("\\["+V+"*(?:value|"+B+")"),t.querySelectorAll("[id~="+p+"-]").length||m.push("~="),e=f.createElement("input"),e.setAttribute("name",""),t.appendChild(e),t.querySelectorAll("[name='']").length||m.push("\\["+V+"*name"+V+"*="+V+"*(?:''|\"\")"),t.querySelectorAll(":checked").length||m.push(":checked"),t.querySelectorAll("a#"+p+"+*").length||m.push(".#.+[+~]"),t.querySelectorAll("\\\f"),m.push("[\\r\\n\\f]")})),ut((function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=f.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&m.push("name"+V+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),c.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),m.push(",.*:")}))),(a.matchesSelector=j.test(S=c.matches||c.webkitMatchesSelector||c.mozMatchesSelector||c.oMatchesSelector||c.msMatchesSelector))&&ut((function(t){a.disconnectedMatch=S.call(t,"*"),S.call(t,"[s!='']:x"),v.push("!=",Y)})),m=m.length&&new RegExp(m.join("|")),v=v.length&&new RegExp(v.join("|")),e=j.test(c.compareDocumentPosition),I=e||j.test(c.contains)?function(t,e){var a=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(a.contains?a.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)while(e=e.parentNode)if(e===t)return!0;return!1},M=e?function(t,e){if(t===e)return C=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(i=(t.ownerDocument||t)==(e.ownerDocument||e)?t.compareDocumentPosition(e):1,1&i||!a.sortDetached&&e.compareDocumentPosition(t)===i?t==f||t.ownerDocument==T&&I(T,t)?-1:e==f||e.ownerDocument==T&&I(T,e)?1:u?b(u,t)-b(u,e):0:4&i?-1:1)}:function(t,e){if(t===e)return C=!0,0;var a,i=0,r=t.parentNode,n=e.parentNode,s=[t],o=[e];if(!r||!n)return t==f?-1:e==f?1:r?-1:n?1:u?b(u,t)-b(u,e):0;if(r===n)return Dt(t,e);a=t;while(a=a.parentNode)s.unshift(a);a=e;while(a=a.parentNode)o.unshift(a);while(s[i]===o[i])i++;return i?Dt(s[i],o[i]):s[i]==T?-1:o[i]==T?1:0},f):f},ot.matches=function(t,e){return ot(t,null,null,e)},ot.matchesSelector=function(t,e){if(D(t),a.matchesSelector&&d&&!E[e+" "]&&(!v||!v.test(e))&&(!m||!m.test(e)))try{var i=S.call(t,e);if(i||a.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(Et){E(e,!0)}return ot(e,f,null,[t]).length>0},ot.contains=function(t,e){return(t.ownerDocument||t)!=f&&D(t),I(t,e)},ot.attr=function(t,e){(t.ownerDocument||t)!=f&&D(t);var r=i.attrHandle[e.toLowerCase()],n=r&&A.call(i.attrHandle,e.toLowerCase())?r(t,e,!d):void 0;return void 0!==n?n:a.attributes||!d?t.getAttribute(e):(n=t.getAttributeNode(e))&&n.specified?n.value:null},ot.escape=function(t){return(t+"").replace(it,rt)},ot.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},ot.uniqueSort=function(t){var e,i=[],r=0,n=0;if(C=!a.detectDuplicates,u=!a.sortStable&&t.slice(0),t.sort(M),C){while(e=t[n++])e===t[n]&&(r=i.push(n));while(r--)t.splice(i[r],1)}return u=null,t},r=ot.getText=function(t){var e,a="",i=0,n=t.nodeType;if(n){if(1===n||9===n||11===n){if("string"===typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)a+=r(t)}else if(3===n||4===n)return t.nodeValue}else while(e=t[i++])a+=r(e);return a},i=ot.selectors={cacheLength:50,createPseudo:lt,match:z,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(et,at),t[3]=(t[3]||t[4]||t[5]||"").replace(et,at),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||ot.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&ot.error(t[0]),t},PSEUDO:function(t){var e,a=!t[6]&&t[2];return z["CHILD"].test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":a&&K.test(a)&&(e=s(a,!0))&&(e=a.indexOf(")",a.length-e)-a.length)&&(t[0]=t[0].slice(0,e),t[2]=a.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(et,at).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=F[t+" "];return e||(e=new RegExp("(^|"+V+")"+t+"("+V+"|$)"))&&F(t,(function(t){return e.test("string"===typeof t.className&&t.className||"undefined"!==typeof t.getAttribute&&t.getAttribute("class")||"")}))},ATTR:function(t,e,a){return function(i){var r=ot.attr(i,t);return null==r?"!="===e:!e||(r+="","="===e?r===a:"!="===e?r!==a:"^="===e?a&&0===r.indexOf(a):"*="===e?a&&r.indexOf(a)>-1:"$="===e?a&&r.slice(-a.length)===a:"~="===e?(" "+r.replace(k," ")+" ").indexOf(a)>-1:"|="===e&&(r===a||r.slice(0,a.length+1)===a+"-"))}},CHILD:function(t,e,a,i,r){var n="nth"!==t.slice(0,3),s="last"!==t.slice(-4),o="of-type"===e;return 1===i&&0===r?function(t){return!!t.parentNode}:function(e,a,h){var l,u,C,D,f,c,d=n!==s?"nextSibling":"previousSibling",m=e.parentNode,v=o&&e.nodeName.toLowerCase(),S=!h&&!o,I=!1;if(m){if(n){while(d){D=e;while(D=D[d])if(o?D.nodeName.toLowerCase()===v:1===D.nodeType)return!1;c=d="only"===t&&!c&&"nextSibling"}return!0}if(c=[s?m.firstChild:m.lastChild],s&&S){D=m,C=D[p]||(D[p]={}),u=C[D.uniqueID]||(C[D.uniqueID]={}),l=u[t]||[],f=l[0]===g&&l[1],I=f&&l[2],D=f&&m.childNodes[f];while(D=++f&&D&&D[d]||(I=f=0)||c.pop())if(1===D.nodeType&&++I&&D===e){u[t]=[g,f,I];break}}else if(S&&(D=e,C=D[p]||(D[p]={}),u=C[D.uniqueID]||(C[D.uniqueID]={}),l=u[t]||[],f=l[0]===g&&l[1],I=f),!1===I)while(D=++f&&D&&D[d]||(I=f=0)||c.pop())if((o?D.nodeName.toLowerCase()===v:1===D.nodeType)&&++I&&(S&&(C=D[p]||(D[p]={}),u=C[D.uniqueID]||(C[D.uniqueID]={}),u[t]=[g,I]),D===e))break;return I-=r,I===i||I%i===0&&I/i>=0}}},PSEUDO:function(t,e){var a,r=i.pseudos[t]||i.setFilters[t.toLowerCase()]||ot.error("unsupported pseudo: "+t);return r[p]?r(e):r.length>1?(a=[t,t,"",e],i.setFilters.hasOwnProperty(t.toLowerCase())?lt((function(t,a){var i,n=r(t,e),s=n.length;while(s--)i=b(t,n[s]),t[i]=!(a[i]=n[s])})):function(t){return r(t,0,a)}):r}},pseudos:{not:lt((function(t){var e=[],a=[],i=o(t.replace(_,"$1"));return i[p]?lt((function(t,e,a,r){var n,s=i(t,null,r,[]),o=t.length;while(o--)(n=s[o])&&(t[o]=!(e[o]=n))})):function(t,r,n){return e[0]=t,i(e,null,n,a),e[0]=null,!a.pop()}})),has:lt((function(t){return function(e){return ot(t,e).length>0}})),contains:lt((function(t){return t=t.replace(et,at),function(e){return(e.textContent||r(e)).indexOf(t)>-1}})),lang:lt((function(t){return J.test(t||"")||ot.error("unsupported lang: "+t),t=t.replace(et,at).toLowerCase(),function(e){var a;do{if(a=d?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return a=a.toLowerCase(),a===t||0===a.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var a=t.location&&t.location.hash;return a&&a.slice(1)===e.id},root:function(t){return t===c},focus:function(t){return t===f.activeElement&&(!f.hasFocus||f.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:dt(!1),disabled:dt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!i.pseudos["empty"](t)},header:function(t){return Q.test(t.nodeName)},input:function(t){return Z.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:mt((function(){return[0]})),last:mt((function(t,e){return[e-1]})),eq:mt((function(t,e,a){return[a<0?a+e:a]})),even:mt((function(t,e){for(var a=0;a<e;a+=2)t.push(a);return t})),odd:mt((function(t,e){for(var a=1;a<e;a+=2)t.push(a);return t})),lt:mt((function(t,e,a){for(var i=a<0?a+e:a>e?e:a;--i>=0;)t.push(i);return t})),gt:mt((function(t,e,a){for(var i=a<0?a+e:a;++i<e;)t.push(i);return t}))}},i.pseudos["nth"]=i.pseudos["eq"],{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[e]=ft(e);for(e in{submit:!0,reset:!0})i.pseudos[e]=ct(e);function St(){}function It(t){for(var e=0,a=t.length,i="";e<a;e++)i+=t[e].value;return i}function pt(t,e,a){var i=e.dir,r=e.next,n=r||i,s=a&&"parentNode"===n,o=x++;return e.first?function(e,a,r){while(e=e[i])if(1===e.nodeType||s)return t(e,a,r);return!1}:function(e,a,h){var l,u,C,D=[g,o];if(h){while(e=e[i])if((1===e.nodeType||s)&&t(e,a,h))return!0}else while(e=e[i])if(1===e.nodeType||s)if(C=e[p]||(e[p]={}),u=C[e.uniqueID]||(C[e.uniqueID]={}),r&&r===e.nodeName.toLowerCase())e=e[i]||e;else{if((l=u[n])&&l[0]===g&&l[1]===o)return D[2]=l[2];if(u[n]=D,D[2]=t(e,a,h))return!0}return!1}}function Tt(t){return t.length>1?function(e,a,i){var r=t.length;while(r--)if(!t[r](e,a,i))return!1;return!0}:t[0]}function gt(t,e,a){for(var i=0,r=e.length;i<r;i++)ot(t,e[i],a);return a}function xt(t,e,a,i,r){for(var n,s=[],o=0,h=t.length,l=null!=e;o<h;o++)(n=t[o])&&(a&&!a(n,i,r)||(s.push(n),l&&e.push(o)));return s}function Ft(t,e,a,i,r,n){return i&&!i[p]&&(i=Ft(i)),r&&!r[p]&&(r=Ft(r,n)),lt((function(n,s,o,h){var l,u,C,D=[],f=[],c=s.length,d=n||gt(e||"*",o.nodeType?[o]:o,[]),m=!t||!n&&e?d:xt(d,D,t,o,h),v=a?r||(n?t:c||i)?[]:s:m;if(a&&a(m,v,o,h),i){l=xt(v,f),i(l,[],o,h),u=l.length;while(u--)(C=l[u])&&(v[f[u]]=!(m[f[u]]=C))}if(n){if(r||t){if(r){l=[],u=v.length;while(u--)(C=v[u])&&l.push(m[u]=C);r(null,v=[],l,h)}u=v.length;while(u--)(C=v[u])&&(l=r?b(n,C):D[u])>-1&&(n[l]=!(s[l]=C))}}else v=xt(v===s?v.splice(c,v.length):v),r?r(null,s,v,h):R.apply(s,v)}))}function yt(t){for(var e,a,r,n=t.length,s=i.relative[t[0].type],o=s||i.relative[" "],h=s?1:0,u=pt((function(t){return t===e}),o,!0),C=pt((function(t){return b(e,t)>-1}),o,!0),D=[function(t,a,i){var r=!s&&(i||a!==l)||((e=a).nodeType?u(t,a,i):C(t,a,i));return e=null,r}];h<n;h++)if(a=i.relative[t[h].type])D=[pt(Tt(D),a)];else{if(a=i.filter[t[h].type].apply(null,t[h].matches),a[p]){for(r=++h;r<n;r++)if(i.relative[t[r].type])break;return Ft(h>1&&Tt(D),h>1&&It(t.slice(0,h-1).concat({value:" "===t[h-2].type?"*":""})).replace(_,"$1"),a,h<r&&yt(t.slice(h,r)),r<n&&yt(t=t.slice(r)),r<n&&It(t))}D.push(a)}return Tt(D)}function Lt(t,e){var a=e.length>0,r=t.length>0,n=function(n,s,o,h,u){var C,c,m,v=0,S="0",I=n&&[],p=[],T=l,x=n||r&&i.find["TAG"]("*",u),F=g+=null==T?1:Math.random()||.1,y=x.length;for(u&&(l=s==f||s||u);S!==y&&null!=(C=x[S]);S++){if(r&&C){c=0,s||C.ownerDocument==f||(D(C),o=!d);while(m=t[c++])if(m(C,s||f,o)){h.push(C);break}u&&(g=F)}a&&((C=!m&&C)&&v--,n&&I.push(C))}if(v+=S,a&&S!==v){c=0;while(m=e[c++])m(I,p,s,o);if(n){if(v>0)while(S--)I[S]||p[S]||(p[S]=w.call(h));p=xt(p)}R.apply(h,p),u&&!n&&p.length>0&&v+e.length>1&&ot.uniqueSort(h)}return u&&(g=F,l=T),I};return a?lt(n):n}return St.prototype=i.filters=i.pseudos,i.setFilters=new St,s=ot.tokenize=function(t,e){var a,r,n,s,o,h,l,u=y[t+" "];if(u)return e?0:u.slice(0);o=t,h=[],l=i.preFilter;while(o){for(s in a&&!(r=X.exec(o))||(r&&(o=o.slice(r[0].length)||o),h.push(n=[])),a=!1,(r=W.exec(o))&&(a=r.shift(),n.push({value:a,type:r[0].replace(_," ")}),o=o.slice(a.length)),i.filter)!(r=z[s].exec(o))||l[s]&&!(r=l[s](r))||(a=r.shift(),n.push({value:a,type:s,matches:r}),o=o.slice(a.length));if(!a)break}return e?o.length:o?ot.error(t):y(t,h).slice(0)},o=ot.compile=function(t,e){var a,i=[],r=[],n=L[t+" "];if(!n){e||(e=s(t)),a=e.length;while(a--)n=yt(e[a]),n[p]?i.push(n):r.push(n);n=L(t,Lt(r,i)),n.selector=t}return n},h=ot.select=function(t,e,a,r){var n,h,l,u,C,D="function"===typeof t&&t,f=!r&&s(t=D.selector||t);if(a=a||[],1===f.length){if(h=f[0]=f[0].slice(0),h.length>2&&"ID"===(l=h[0]).type&&9===e.nodeType&&d&&i.relative[h[1].type]){if(e=(i.find["ID"](l.matches[0].replace(et,at),e)||[])[0],!e)return a;D&&(e=e.parentNode),t=t.slice(h.shift().value.length)}n=z["needsContext"].test(t)?0:h.length;while(n--){if(l=h[n],i.relative[u=l.type])break;if((C=i.find[u])&&(r=C(l.matches[0].replace(et,at),tt.test(h[0].type)&&vt(e.parentNode)||e))){if(h.splice(n,1),t=r.length&&It(h),!t)return R.apply(a,r),a;break}}}return(D||o(t,f))(r,e,!d,a,!e||tt.test(t)&&vt(e.parentNode)||e),a},a.sortStable=p.split("").sort(M).join("")===p,a.detectDuplicates=!!C,D(),a.sortDetached=ut((function(t){return 1&t.compareDocumentPosition(f.createElement("fieldset"))})),ut((function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")}))||Ct("type|href|height|width",(function(t,e,a){if(!a)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)})),a.attributes&&ut((function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")}))||Ct("value",(function(t,e,a){if(!a&&"input"===t.nodeName.toLowerCase())return t.defaultValue})),ut((function(t){return null==t.getAttribute("disabled")}))||Ct(B,(function(t,e,a){var i;if(!a)return!0===t[e]?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null})),ot}(a);y.find=E,y.expr=E.selectors,y.expr[":"]=y.expr.pseudos,y.uniqueSort=y.unique=E.uniqueSort,y.text=E.getText,y.isXMLDoc=E.isXML,y.contains=E.contains,y.escapeSelector=E.escape;var M=function(t,e,a){var i=[],r=void 0!==a;while((t=t[e])&&9!==t.nodeType)if(1===t.nodeType){if(r&&y(t).is(a))break;i.push(t)}return i},A=function(t,e){for(var a=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&a.push(t);return a},N=y.expr.match.needsContext;function w(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var O=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function R(t,e,a){return S(e)?y.grep(t,(function(t,i){return!!e.call(t,i,t)!==a})):e.nodeType?y.grep(t,(function(t){return t===e!==a})):"string"!==typeof e?y.grep(t,(function(t){return C.call(e,t)>-1!==a})):y.filter(e,t,a)}y.filter=function(t,e,a){var i=e[0];return a&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?y.find.matchesSelector(i,t)?[i]:[]:y.find.matches(t,y.grep(e,(function(t){return 1===t.nodeType})))},y.fn.extend({find:function(t){var e,a,i=this.length,r=this;if("string"!==typeof t)return this.pushStack(y(t).filter((function(){for(e=0;e<i;e++)if(y.contains(r[e],this))return!0})));for(a=this.pushStack([]),e=0;e<i;e++)y.find(t,r[e],a);return i>1?y.uniqueSort(a):a},filter:function(t){return this.pushStack(R(this,t||[],!1))},not:function(t){return this.pushStack(R(this,t||[],!0))},is:function(t){return!!R(this,"string"===typeof t&&N.test(t)?y(t):t||[],!1).length}});var P,b=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,B=y.fn.init=function(t,e,a){var i,r;if(!t)return this;if(a=a||P,"string"===typeof t){if(i="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:b.exec(t),!i||!i[1]&&e)return!e||e.jquery?(e||a).find(t):this.constructor(e).find(t);if(i[1]){if(e=e instanceof y?e[0]:e,y.merge(this,y.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:p,!0)),O.test(i[1])&&y.isPlainObject(e))for(i in e)S(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}return r=p.getElementById(i[2]),r&&(this[0]=r,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):S(t)?void 0!==a.ready?a.ready(t):t(y):y.makeArray(t,this)};B.prototype=y.fn,P=y(p);var V=/^(?:parents|prev(?:Until|All))/,G={children:!0,contents:!0,next:!0,prev:!0};function H(t,e){while((t=t[e])&&1!==t.nodeType);return t}y.fn.extend({has:function(t){var e=y(t,this),a=e.length;return this.filter((function(){for(var t=0;t<a;t++)if(y.contains(this,e[t]))return!0}))},closest:function(t,e){var a,i=0,r=this.length,n=[],s="string"!==typeof t&&y(t);if(!N.test(t))for(;i<r;i++)for(a=this[i];a&&a!==e;a=a.parentNode)if(a.nodeType<11&&(s?s.index(a)>-1:1===a.nodeType&&y.find.matchesSelector(a,t))){n.push(a);break}return this.pushStack(n.length>1?y.uniqueSort(n):n)},index:function(t){return t?"string"===typeof t?C.call(y(t),this[0]):C.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(y.uniqueSort(y.merge(this.get(),y(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),y.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return M(t,"parentNode")},parentsUntil:function(t,e,a){return M(t,"parentNode",a)},next:function(t){return H(t,"nextSibling")},prev:function(t){return H(t,"previousSibling")},nextAll:function(t){return M(t,"nextSibling")},prevAll:function(t){return M(t,"previousSibling")},nextUntil:function(t,e,a){return M(t,"nextSibling",a)},prevUntil:function(t,e,a){return M(t,"previousSibling",a)},siblings:function(t){return A((t.parentNode||{}).firstChild,t)},children:function(t){return A(t.firstChild)},contents:function(t){return null!=t.contentDocument&&o(t.contentDocument)?t.contentDocument:(w(t,"template")&&(t=t.content||t),y.merge([],t.childNodes))}},(function(t,e){y.fn[t]=function(a,i){var r=y.map(this,e,a);return"Until"!==t.slice(-5)&&(i=a),i&&"string"===typeof i&&(r=y.filter(i,r)),this.length>1&&(G[t]||y.uniqueSort(r),V.test(t)&&r.reverse()),this.pushStack(r)}}));var Y=/[^\x20\t\r\n\f]+/g;function k(t){var e={};return y.each(t.match(Y)||[],(function(t,a){e[a]=!0})),e}function _(t){return t}function X(t){throw t}function W(t,e,a,i){var r;try{t&&S(r=t.promise)?r.call(t).done(e).fail(a):t&&S(r=t.then)?r.call(t,e,a):e.apply(void 0,[t].slice(i))}catch(t){a.apply(void 0,[t])}}y.Callbacks=function(t){t="string"===typeof t?k(t):y.extend({},t);var e,a,i,r,n=[],s=[],o=-1,h=function(){for(r=r||t.once,i=e=!0;s.length;o=-1){a=s.shift();while(++o<n.length)!1===n[o].apply(a[0],a[1])&&t.stopOnFalse&&(o=n.length,a=!1)}t.memory||(a=!1),e=!1,r&&(n=a?[]:"")},l={add:function(){return n&&(a&&!e&&(o=n.length-1,s.push(a)),function e(a){y.each(a,(function(a,i){S(i)?t.unique&&l.has(i)||n.push(i):i&&i.length&&"string"!==x(i)&&e(i)}))}(arguments),a&&!e&&h()),this},remove:function(){return y.each(arguments,(function(t,e){var a;while((a=y.inArray(e,n,a))>-1)n.splice(a,1),a<=o&&o--})),this},has:function(t){return t?y.inArray(t,n)>-1:n.length>0},empty:function(){return n&&(n=[]),this},disable:function(){return r=s=[],n=a="",this},disabled:function(){return!n},lock:function(){return r=s=[],a||e||(n=a=""),this},locked:function(){return!!r},fireWith:function(t,a){return r||(a=a||[],a=[t,a.slice?a.slice():a],s.push(a),e||h()),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!i}};return l},y.extend({Deferred:function(t){var e=[["notify","progress",y.Callbacks("memory"),y.Callbacks("memory"),2],["resolve","done",y.Callbacks("once memory"),y.Callbacks("once memory"),0,"resolved"],["reject","fail",y.Callbacks("once memory"),y.Callbacks("once memory"),1,"rejected"]],i="pending",r={state:function(){return i},always:function(){return n.done(arguments).fail(arguments),this},catch:function(t){return r.then(null,t)},pipe:function(){var t=arguments;return y.Deferred((function(a){y.each(e,(function(e,i){var r=S(t[i[4]])&&t[i[4]];n[i[1]]((function(){var t=r&&r.apply(this,arguments);t&&S(t.promise)?t.promise().progress(a.notify).done(a.resolve).fail(a.reject):a[i[0]+"With"](this,r?[t]:arguments)}))})),t=null})).promise()},then:function(t,i,r){var n=0;function s(t,e,i,r){return function(){var o=this,h=arguments,l=function(){var a,l;if(!(t<n)){if(a=i.apply(o,h),a===e.promise())throw new TypeError("Thenable self-resolution");l=a&&("object"===typeof a||"function"===typeof a)&&a.then,S(l)?r?l.call(a,s(n,e,_,r),s(n,e,X,r)):(n++,l.call(a,s(n,e,_,r),s(n,e,X,r),s(n,e,_,e.notifyWith))):(i!==_&&(o=void 0,h=[a]),(r||e.resolveWith)(o,h))}},u=r?l:function(){try{l()}catch(a){y.Deferred.exceptionHook&&y.Deferred.exceptionHook(a,u.stackTrace),t+1>=n&&(i!==X&&(o=void 0,h=[a]),e.rejectWith(o,h))}};t?u():(y.Deferred.getStackHook&&(u.stackTrace=y.Deferred.getStackHook()),a.setTimeout(u))}}return y.Deferred((function(a){e[0][3].add(s(0,a,S(r)?r:_,a.notifyWith)),e[1][3].add(s(0,a,S(t)?t:_)),e[2][3].add(s(0,a,S(i)?i:X))})).promise()},promise:function(t){return null!=t?y.extend(t,r):r}},n={};return y.each(e,(function(t,a){var s=a[2],o=a[5];r[a[1]]=s.add,o&&s.add((function(){i=o}),e[3-t][2].disable,e[3-t][3].disable,e[0][2].lock,e[0][3].lock),s.add(a[3].fire),n[a[0]]=function(){return n[a[0]+"With"](this===n?void 0:this,arguments),this},n[a[0]+"With"]=s.fireWith})),r.promise(n),t&&t.call(n,n),n},when:function(t){var e=arguments.length,a=e,i=Array(a),r=h.call(arguments),n=y.Deferred(),s=function(t){return function(a){i[t]=this,r[t]=arguments.length>1?h.call(arguments):a,--e||n.resolveWith(i,r)}};if(e<=1&&(W(t,n.done(s(a)).resolve,n.reject,!e),"pending"===n.state()||S(r[a]&&r[a].then)))return n.then();while(a--)W(r[a],s(a),n.reject);return n.promise()}});var U=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;y.Deferred.exceptionHook=function(t,e){a.console&&a.console.warn&&t&&U.test(t.name)&&a.console.warn("jQuery.Deferred exception: "+t.message,t.stack,e)},y.readyException=function(t){a.setTimeout((function(){throw t}))};var K=y.Deferred();function J(){p.removeEventListener("DOMContentLoaded",J),a.removeEventListener("load",J),y.ready()}y.fn.ready=function(t){return K.then(t).catch((function(t){y.readyException(t)})),this},y.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--y.readyWait:y.isReady)||(y.isReady=!0,!0!==t&&--y.readyWait>0||K.resolveWith(p,[y]))}}),y.ready.then=K.then,"complete"===p.readyState||"loading"!==p.readyState&&!p.documentElement.doScroll?a.setTimeout(y.ready):(p.addEventListener("DOMContentLoaded",J),a.addEventListener("load",J));var z=function t(e,a,i,r,n,s,o){var h=0,l=e.length,u=null==i;if("object"===x(i))for(h in n=!0,i)t(e,a,h,i[h],!0,s,o);else if(void 0!==r&&(n=!0,S(r)||(o=!0),u&&(o?(a.call(e,r),a=null):(u=a,a=function(t,e,a){return u.call(y(t),a)})),a))for(;h<l;h++)a(e[h],i,o?r:r.call(e[h],h,a(e[h],i)));return n?e:u?a.call(e):l?a(e[0],i):s},q=/^-ms-/,Z=/-([a-z])/g;function Q(t,e){return e.toUpperCase()}function j(t){return t.replace(q,"ms-").replace(Z,Q)}var $=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function tt(){this.expando=y.expando+tt.uid++}tt.uid=1,tt.prototype={cache:function(t){var e=t[this.expando];return e||(e={},$(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,a){var i,r=this.cache(t);if("string"===typeof e)r[j(e)]=a;else for(i in e)r[j(i)]=e[i];return r},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][j(e)]},access:function(t,e,a){return void 0===e||e&&"string"===typeof e&&void 0===a?this.get(t,e):(this.set(t,e,a),void 0!==a?a:e)},remove:function(t,e){var a,i=t[this.expando];if(void 0!==i){if(void 0!==e){Array.isArray(e)?e=e.map(j):(e=j(e),e=e in i?[e]:e.match(Y)||[]),a=e.length;while(a--)delete i[e[a]]}(void 0===e||y.isEmptyObject(i))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!y.isEmptyObject(e)}};var et=new tt,at=new tt,it=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rt=/[A-Z]/g;function nt(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:it.test(t)?JSON.parse(t):t)}function st(t,e,a){var i;if(void 0===a&&1===t.nodeType)if(i="data-"+e.replace(rt,"-$&").toLowerCase(),a=t.getAttribute(i),"string"===typeof a){try{a=nt(a)}catch(r){}at.set(t,e,a)}else a=void 0;return a}y.extend({hasData:function(t){return at.hasData(t)||et.hasData(t)},data:function(t,e,a){return at.access(t,e,a)},removeData:function(t,e){at.remove(t,e)},_data:function(t,e,a){return et.access(t,e,a)},_removeData:function(t,e){et.remove(t,e)}}),y.fn.extend({data:function(t,e){var a,i,r,n=this[0],s=n&&n.attributes;if(void 0===t){if(this.length&&(r=at.get(n),1===n.nodeType&&!et.get(n,"hasDataAttrs"))){a=s.length;while(a--)s[a]&&(i=s[a].name,0===i.indexOf("data-")&&(i=j(i.slice(5)),st(n,i,r[i])));et.set(n,"hasDataAttrs",!0)}return r}return"object"===typeof t?this.each((function(){at.set(this,t)})):z(this,(function(e){var a;if(n&&void 0===e)return a=at.get(n,t),void 0!==a?a:(a=st(n,t),void 0!==a?a:void 0);this.each((function(){at.set(this,t,e)}))}),null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each((function(){at.remove(this,t)}))}}),y.extend({queue:function(t,e,a){var i;if(t)return e=(e||"fx")+"queue",i=et.get(t,e),a&&(!i||Array.isArray(a)?i=et.access(t,e,y.makeArray(a)):i.push(a)),i||[]},dequeue:function(t,e){e=e||"fx";var a=y.queue(t,e),i=a.length,r=a.shift(),n=y._queueHooks(t,e),s=function(){y.dequeue(t,e)};"inprogress"===r&&(r=a.shift(),i--),r&&("fx"===e&&a.unshift("inprogress"),delete n.stop,r.call(t,s,n)),!i&&n&&n.empty.fire()},_queueHooks:function(t,e){var a=e+"queueHooks";return et.get(t,a)||et.access(t,a,{empty:y.Callbacks("once memory").add((function(){et.remove(t,[e+"queue",a])}))})}}),y.fn.extend({queue:function(t,e){var a=2;return"string"!==typeof t&&(e=t,t="fx",a--),arguments.length<a?y.queue(this[0],t):void 0===e?this:this.each((function(){var a=y.queue(this,t,e);y._queueHooks(this,t),"fx"===t&&"inprogress"!==a[0]&&y.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){y.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var a,i=1,r=y.Deferred(),n=this,s=this.length,o=function(){--i||r.resolveWith(n,[n])};"string"!==typeof t&&(e=t,t=void 0),t=t||"fx";while(s--)a=et.get(n[s],t+"queueHooks"),a&&a.empty&&(i++,a.empty.add(o));return o(),r.promise(e)}});var ot=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ht=new RegExp("^(?:([+-])=|)("+ot+")([a-z%]*)$","i"),lt=["Top","Right","Bottom","Left"],ut=p.documentElement,Ct=function(t){return y.contains(t.ownerDocument,t)},Dt={composed:!0};ut.getRootNode&&(Ct=function(t){return y.contains(t.ownerDocument,t)||t.getRootNode(Dt)===t.ownerDocument});var ft=function(t,e){return t=e||t,"none"===t.style.display||""===t.style.display&&Ct(t)&&"none"===y.css(t,"display")};function ct(t,e,a,i){var r,n,s=20,o=i?function(){return i.cur()}:function(){return y.css(t,e,"")},h=o(),l=a&&a[3]||(y.cssNumber[e]?"":"px"),u=t.nodeType&&(y.cssNumber[e]||"px"!==l&&+h)&&ht.exec(y.css(t,e));if(u&&u[3]!==l){h/=2,l=l||u[3],u=+h||1;while(s--)y.style(t,e,u+l),(1-n)*(1-(n=o()/h||.5))<=0&&(s=0),u/=n;u*=2,y.style(t,e,u+l),a=a||[]}return a&&(u=+u||+h||0,r=a[1]?u+(a[1]+1)*a[2]:+a[2],i&&(i.unit=l,i.start=u,i.end=r)),r}var dt={};function mt(t){var e,a=t.ownerDocument,i=t.nodeName,r=dt[i];return r||(e=a.body.appendChild(a.createElement(i)),r=y.css(e,"display"),e.parentNode.removeChild(e),"none"===r&&(r="block"),dt[i]=r,r)}function vt(t,e){for(var a,i,r=[],n=0,s=t.length;n<s;n++)i=t[n],i.style&&(a=i.style.display,e?("none"===a&&(r[n]=et.get(i,"display")||null,r[n]||(i.style.display="")),""===i.style.display&&ft(i)&&(r[n]=mt(i))):"none"!==a&&(r[n]="none",et.set(i,"display",a)));for(n=0;n<s;n++)null!=r[n]&&(t[n].style.display=r[n]);return t}y.fn.extend({show:function(){return vt(this,!0)},hide:function(){return vt(this)},toggle:function(t){return"boolean"===typeof t?t?this.show():this.hide():this.each((function(){ft(this)?y(this).show():y(this).hide()}))}});var St=/^(?:checkbox|radio)$/i,It=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,pt=/^$|^module$|\/(?:java|ecma)script/i;(function(){var t=p.createDocumentFragment(),e=t.appendChild(p.createElement("div")),a=p.createElement("input");a.setAttribute("type","radio"),a.setAttribute("checked","checked"),a.setAttribute("name","t"),e.appendChild(a),v.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",v.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue,e.innerHTML="<option></option>",v.option=!!e.lastChild})();var Tt={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function gt(t,e){var a;return a="undefined"!==typeof t.getElementsByTagName?t.getElementsByTagName(e||"*"):"undefined"!==typeof t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&w(t,e)?y.merge([t],a):a}function xt(t,e){for(var a=0,i=t.length;a<i;a++)et.set(t[a],"globalEval",!e||et.get(e[a],"globalEval"))}Tt.tbody=Tt.tfoot=Tt.colgroup=Tt.caption=Tt.thead,Tt.th=Tt.td,v.option||(Tt.optgroup=Tt.option=[1,"<select multiple='multiple'>","</select>"]);var Ft=/<|&#?\w+;/;function yt(t,e,a,i,r){for(var n,s,o,h,l,u,C=e.createDocumentFragment(),D=[],f=0,c=t.length;f<c;f++)if(n=t[f],n||0===n)if("object"===x(n))y.merge(D,n.nodeType?[n]:n);else if(Ft.test(n)){s=s||C.appendChild(e.createElement("div")),o=(It.exec(n)||["",""])[1].toLowerCase(),h=Tt[o]||Tt._default,s.innerHTML=h[1]+y.htmlPrefilter(n)+h[2],u=h[0];while(u--)s=s.lastChild;y.merge(D,s.childNodes),s=C.firstChild,s.textContent=""}else D.push(e.createTextNode(n));C.textContent="",f=0;while(n=D[f++])if(i&&y.inArray(n,i)>-1)r&&r.push(n);else if(l=Ct(n),s=gt(C.appendChild(n),"script"),l&&xt(s),a){u=0;while(n=s[u++])pt.test(n.type||"")&&a.push(n)}return C}var Lt=/^([^.]*)(?:\.(.+)|)/;function Et(){return!0}function Mt(){return!1}function At(t,e){return t===Nt()===("focus"===e)}function Nt(){try{return p.activeElement}catch(t){}}function wt(t,e,a,i,r,n){var s,o;if("object"===typeof e){for(o in"string"!==typeof a&&(i=i||a,a=void 0),e)wt(t,o,a,i,e[o],n);return t}if(null==i&&null==r?(r=a,i=a=void 0):null==r&&("string"===typeof a?(r=i,i=void 0):(r=i,i=a,a=void 0)),!1===r)r=Mt;else if(!r)return t;return 1===n&&(s=r,r=function(t){return y().off(t),s.apply(this,arguments)},r.guid=s.guid||(s.guid=y.guid++)),t.each((function(){y.event.add(this,e,r,i,a)}))}function Ot(t,e,a){a?(et.set(t,e,!1),y.event.add(t,e,{namespace:!1,handler:function(t){var i,r,n=et.get(this,e);if(1&t.isTrigger&&this[e]){if(n.length)(y.event.special[e]||{}).delegateType&&t.stopPropagation();else if(n=h.call(arguments),et.set(this,e,n),i=a(this,e),this[e](),r=et.get(this,e),n!==r||i?et.set(this,e,!1):r={},n!==r)return t.stopImmediatePropagation(),t.preventDefault(),r&&r.value}else n.length&&(et.set(this,e,{value:y.event.trigger(y.extend(n[0],y.Event.prototype),n.slice(1),this)}),t.stopImmediatePropagation())}})):void 0===et.get(t,e)&&y.event.add(t,e,Et)}y.event={global:{},add:function(t,e,a,i,r){var n,s,o,h,l,u,C,D,f,c,d,m=et.get(t);if($(t)){a.handler&&(n=a,a=n.handler,r=n.selector),r&&y.find.matchesSelector(ut,r),a.guid||(a.guid=y.guid++),(h=m.events)||(h=m.events=Object.create(null)),(s=m.handle)||(s=m.handle=function(e){return"undefined"!==typeof y&&y.event.triggered!==e.type?y.event.dispatch.apply(t,arguments):void 0}),e=(e||"").match(Y)||[""],l=e.length;while(l--)o=Lt.exec(e[l])||[],f=d=o[1],c=(o[2]||"").split(".").sort(),f&&(C=y.event.special[f]||{},f=(r?C.delegateType:C.bindType)||f,C=y.event.special[f]||{},u=y.extend({type:f,origType:d,data:i,handler:a,guid:a.guid,selector:r,needsContext:r&&y.expr.match.needsContext.test(r),namespace:c.join(".")},n),(D=h[f])||(D=h[f]=[],D.delegateCount=0,C.setup&&!1!==C.setup.call(t,i,c,s)||t.addEventListener&&t.addEventListener(f,s)),C.add&&(C.add.call(t,u),u.handler.guid||(u.handler.guid=a.guid)),r?D.splice(D.delegateCount++,0,u):D.push(u),y.event.global[f]=!0)}},remove:function(t,e,a,i,r){var n,s,o,h,l,u,C,D,f,c,d,m=et.hasData(t)&&et.get(t);if(m&&(h=m.events)){e=(e||"").match(Y)||[""],l=e.length;while(l--)if(o=Lt.exec(e[l])||[],f=d=o[1],c=(o[2]||"").split(".").sort(),f){C=y.event.special[f]||{},f=(i?C.delegateType:C.bindType)||f,D=h[f]||[],o=o[2]&&new RegExp("(^|\\.)"+c.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=n=D.length;while(n--)u=D[n],!r&&d!==u.origType||a&&a.guid!==u.guid||o&&!o.test(u.namespace)||i&&i!==u.selector&&("**"!==i||!u.selector)||(D.splice(n,1),u.selector&&D.delegateCount--,C.remove&&C.remove.call(t,u));s&&!D.length&&(C.teardown&&!1!==C.teardown.call(t,c,m.handle)||y.removeEvent(t,f,m.handle),delete h[f])}else for(f in h)y.event.remove(t,f+e[l],a,i,!0);y.isEmptyObject(h)&&et.remove(t,"handle events")}},dispatch:function(t){var e,a,i,r,n,s,o=new Array(arguments.length),h=y.event.fix(t),l=(et.get(this,"events")||Object.create(null))[h.type]||[],u=y.event.special[h.type]||{};for(o[0]=h,e=1;e<arguments.length;e++)o[e]=arguments[e];if(h.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,h)){s=y.event.handlers.call(this,h,l),e=0;while((r=s[e++])&&!h.isPropagationStopped()){h.currentTarget=r.elem,a=0;while((n=r.handlers[a++])&&!h.isImmediatePropagationStopped())h.rnamespace&&!1!==n.namespace&&!h.rnamespace.test(n.namespace)||(h.handleObj=n,h.data=n.data,i=((y.event.special[n.origType]||{}).handle||n.handler).apply(r.elem,o),void 0!==i&&!1===(h.result=i)&&(h.preventDefault(),h.stopPropagation()))}return u.postDispatch&&u.postDispatch.call(this,h),h.result}},handlers:function(t,e){var a,i,r,n,s,o=[],h=e.delegateCount,l=t.target;if(h&&l.nodeType&&!("click"===t.type&&t.button>=1))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==t.type||!0!==l.disabled)){for(n=[],s={},a=0;a<h;a++)i=e[a],r=i.selector+" ",void 0===s[r]&&(s[r]=i.needsContext?y(r,this).index(l)>-1:y.find(r,this,null,[l]).length),s[r]&&n.push(i);n.length&&o.push({elem:l,handlers:n})}return l=this,h<e.length&&o.push({elem:l,handlers:e.slice(h)}),o},addProp:function(t,e){Object.defineProperty(y.Event.prototype,t,{enumerable:!0,configurable:!0,get:S(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[y.expando]?t:new y.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){var e=this||t;return St.test(e.type)&&e.click&&w(e,"input")&&Ot(e,"click",Et),!1},trigger:function(t){var e=this||t;return St.test(e.type)&&e.click&&w(e,"input")&&Ot(e,"click"),!0},_default:function(t){var e=t.target;return St.test(e.type)&&e.click&&w(e,"input")&&et.get(e,"click")||w(e,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},y.removeEvent=function(t,e,a){t.removeEventListener&&t.removeEventListener(e,a)},y.Event=function(t,e){if(!(this instanceof y.Event))return new y.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?Et:Mt,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&y.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[y.expando]=!0},y.Event.prototype={constructor:y.Event,isDefaultPrevented:Mt,isPropagationStopped:Mt,isImmediatePropagationStopped:Mt,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=Et,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=Et,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=Et,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},y.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},y.event.addProp),y.each({focus:"focusin",blur:"focusout"},(function(t,e){y.event.special[t]={setup:function(){return Ot(this,t,At),!1},trigger:function(){return Ot(this,t),!0},_default:function(e){return et.get(e.target,t)},delegateType:e}})),y.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){y.event.special[t]={delegateType:e,bindType:e,handle:function(t){var a,i=this,r=t.relatedTarget,n=t.handleObj;return r&&(r===i||y.contains(i,r))||(t.type=n.origType,a=n.handler.apply(this,arguments),t.type=e),a}}})),y.fn.extend({on:function(t,e,a,i){return wt(this,t,e,a,i)},one:function(t,e,a,i){return wt(this,t,e,a,i,1)},off:function(t,e,a){var i,r;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,y(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"===typeof t){for(r in t)this.off(r,e,t[r]);return this}return!1!==e&&"function"!==typeof e||(a=e,e=void 0),!1===a&&(a=Mt),this.each((function(){y.event.remove(this,t,a,e)}))}});var Rt=/<script|<style|<link/i,Pt=/checked\s*(?:[^=]|=\s*.checked.)/i,bt=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function Bt(t,e){return w(t,"table")&&w(11!==e.nodeType?e:e.firstChild,"tr")&&y(t).children("tbody")[0]||t}function Vt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Gt(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function Ht(t,e){var a,i,r,n,s,o,h;if(1===e.nodeType){if(et.hasData(t)&&(n=et.get(t),h=n.events,h))for(r in et.remove(e,"handle events"),h)for(a=0,i=h[r].length;a<i;a++)y.event.add(e,r,h[r][a]);at.hasData(t)&&(s=at.access(t),o=y.extend({},s),at.set(e,o))}}function Yt(t,e){var a=e.nodeName.toLowerCase();"input"===a&&St.test(t.type)?e.checked=t.checked:"input"!==a&&"textarea"!==a||(e.defaultValue=t.defaultValue)}function kt(t,e,a,i){e=l(e);var r,n,s,o,h,u,C=0,D=t.length,f=D-1,c=e[0],d=S(c);if(d||D>1&&"string"===typeof c&&!v.checkClone&&Pt.test(c))return t.each((function(r){var n=t.eq(r);d&&(e[0]=c.call(this,r,n.html())),kt(n,e,a,i)}));if(D&&(r=yt(e,t[0].ownerDocument,!1,t,i),n=r.firstChild,1===r.childNodes.length&&(r=n),n||i)){for(s=y.map(gt(r,"script"),Vt),o=s.length;C<D;C++)h=r,C!==f&&(h=y.clone(h,!0,!0),o&&y.merge(s,gt(h,"script"))),a.call(t[C],h,C);if(o)for(u=s[s.length-1].ownerDocument,y.map(s,Gt),C=0;C<o;C++)h=s[C],pt.test(h.type||"")&&!et.access(h,"globalEval")&&y.contains(u,h)&&(h.src&&"module"!==(h.type||"").toLowerCase()?y._evalUrl&&!h.noModule&&y._evalUrl(h.src,{nonce:h.nonce||h.getAttribute("nonce")},u):g(h.textContent.replace(bt,""),h,u))}return t}function _t(t,e,a){for(var i,r=e?y.filter(e,t):t,n=0;null!=(i=r[n]);n++)a||1!==i.nodeType||y.cleanData(gt(i)),i.parentNode&&(a&&Ct(i)&&xt(gt(i,"script")),i.parentNode.removeChild(i));return t}y.extend({htmlPrefilter:function(t){return t},clone:function(t,e,a){var i,r,n,s,o=t.cloneNode(!0),h=Ct(t);if(!v.noCloneChecked&&(1===t.nodeType||11===t.nodeType)&&!y.isXMLDoc(t))for(s=gt(o),n=gt(t),i=0,r=n.length;i<r;i++)Yt(n[i],s[i]);if(e)if(a)for(n=n||gt(t),s=s||gt(o),i=0,r=n.length;i<r;i++)Ht(n[i],s[i]);else Ht(t,o);return s=gt(o,"script"),s.length>0&&xt(s,!h&&gt(t,"script")),o},cleanData:function(t){for(var e,a,i,r=y.event.special,n=0;void 0!==(a=t[n]);n++)if($(a)){if(e=a[et.expando]){if(e.events)for(i in e.events)r[i]?y.event.remove(a,i):y.removeEvent(a,i,e.handle);a[et.expando]=void 0}a[at.expando]&&(a[at.expando]=void 0)}}}),y.fn.extend({detach:function(t){return _t(this,t,!0)},remove:function(t){return _t(this,t)},text:function(t){return z(this,(function(t){return void 0===t?y.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)}))}),null,t,arguments.length)},append:function(){return kt(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=Bt(this,t);e.appendChild(t)}}))},prepend:function(){return kt(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=Bt(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return kt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return kt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(y.cleanData(gt(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return y.clone(this,t,e)}))},html:function(t){return z(this,(function(t){var e=this[0]||{},a=0,i=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"===typeof t&&!Rt.test(t)&&!Tt[(It.exec(t)||["",""])[1].toLowerCase()]){t=y.htmlPrefilter(t);try{for(;a<i;a++)e=this[a]||{},1===e.nodeType&&(y.cleanData(gt(e,!1)),e.innerHTML=t);e=0}catch(r){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=[];return kt(this,arguments,(function(e){var a=this.parentNode;y.inArray(this,t)<0&&(y.cleanData(gt(this)),a&&a.replaceChild(e,this))}),t)}}),y.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){y.fn[t]=function(t){for(var a,i=[],r=y(t),n=r.length-1,s=0;s<=n;s++)a=s===n?this:this.clone(!0),y(r[s])[e](a),u.apply(i,a.get());return this.pushStack(i)}}));var Xt=new RegExp("^("+ot+")(?!px)[a-z%]+$","i"),Wt=/^--/,Ut=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=a),e.getComputedStyle(t)},Kt=function(t,e,a){var i,r,n={};for(r in e)n[r]=t.style[r],t.style[r]=e[r];for(r in i=a.call(t),e)t.style[r]=n[r];return i},Jt=new RegExp(lt.join("|"),"i"),zt="[\\x20\\t\\r\\n\\f]",qt=new RegExp("^"+zt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+zt+"+$","g");function Zt(t,e,a){var i,r,n,s,o=Wt.test(e),h=t.style;return a=a||Ut(t),a&&(s=a.getPropertyValue(e)||a[e],o&&(s=s.replace(qt,"$1")),""!==s||Ct(t)||(s=y.style(t,e)),!v.pixelBoxStyles()&&Xt.test(s)&&Jt.test(e)&&(i=h.width,r=h.minWidth,n=h.maxWidth,h.minWidth=h.maxWidth=h.width=s,s=a.width,h.width=i,h.minWidth=r,h.maxWidth=n)),void 0!==s?s+"":s}function Qt(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}(function(){function t(){if(u){l.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",u.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ut.appendChild(l).appendChild(u);var t=a.getComputedStyle(u);i="1%"!==t.top,h=12===e(t.marginLeft),u.style.right="60%",s=36===e(t.right),r=36===e(t.width),u.style.position="absolute",n=12===e(u.offsetWidth/3),ut.removeChild(l),u=null}}function e(t){return Math.round(parseFloat(t))}var i,r,n,s,o,h,l=p.createElement("div"),u=p.createElement("div");u.style&&(u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",v.clearCloneStyle="content-box"===u.style.backgroundClip,y.extend(v,{boxSizingReliable:function(){return t(),r},pixelBoxStyles:function(){return t(),s},pixelPosition:function(){return t(),i},reliableMarginLeft:function(){return t(),h},scrollboxSize:function(){return t(),n},reliableTrDimensions:function(){var t,e,i,r;return null==o&&(t=p.createElement("table"),e=p.createElement("tr"),i=p.createElement("div"),t.style.cssText="position:absolute;left:-11111px;border-collapse:separate",e.style.cssText="border:1px solid",e.style.height="1px",i.style.height="9px",i.style.display="block",ut.appendChild(t).appendChild(e).appendChild(i),r=a.getComputedStyle(e),o=parseInt(r.height,10)+parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)===e.offsetHeight,ut.removeChild(t)),o}}))})();var jt=["Webkit","Moz","ms"],$t=p.createElement("div").style,te={};function ee(t){var e=t[0].toUpperCase()+t.slice(1),a=jt.length;while(a--)if(t=jt[a]+e,t in $t)return t}function ae(t){var e=y.cssProps[t]||te[t];return e||(t in $t?t:te[t]=ee(t)||t)}var ie=/^(none|table(?!-c[ea]).+)/,re={position:"absolute",visibility:"hidden",display:"block"},ne={letterSpacing:"0",fontWeight:"400"};function se(t,e,a){var i=ht.exec(e);return i?Math.max(0,i[2]-(a||0))+(i[3]||"px"):e}function oe(t,e,a,i,r,n){var s="width"===e?1:0,o=0,h=0;if(a===(i?"border":"content"))return 0;for(;s<4;s+=2)"margin"===a&&(h+=y.css(t,a+lt[s],!0,r)),i?("content"===a&&(h-=y.css(t,"padding"+lt[s],!0,r)),"margin"!==a&&(h-=y.css(t,"border"+lt[s]+"Width",!0,r))):(h+=y.css(t,"padding"+lt[s],!0,r),"padding"!==a?h+=y.css(t,"border"+lt[s]+"Width",!0,r):o+=y.css(t,"border"+lt[s]+"Width",!0,r));return!i&&n>=0&&(h+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-n-h-o-.5))||0),h}function he(t,e,a){var i=Ut(t),r=!v.boxSizingReliable()||a,n=r&&"border-box"===y.css(t,"boxSizing",!1,i),s=n,o=Zt(t,e,i),h="offset"+e[0].toUpperCase()+e.slice(1);if(Xt.test(o)){if(!a)return o;o="auto"}return(!v.boxSizingReliable()&&n||!v.reliableTrDimensions()&&w(t,"tr")||"auto"===o||!parseFloat(o)&&"inline"===y.css(t,"display",!1,i))&&t.getClientRects().length&&(n="border-box"===y.css(t,"boxSizing",!1,i),s=h in t,s&&(o=t[h])),o=parseFloat(o)||0,o+oe(t,e,a||(n?"border":"content"),s,i,o)+"px"}function le(t,e,a,i,r){return new le.prototype.init(t,e,a,i,r)}y.extend({cssHooks:{opacity:{get:function(t,e){if(e){var a=Zt(t,"opacity");return""===a?"1":a}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,a,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,n,s,o=j(e),h=Wt.test(e),l=t.style;if(h||(e=ae(o)),s=y.cssHooks[e]||y.cssHooks[o],void 0===a)return s&&"get"in s&&void 0!==(r=s.get(t,!1,i))?r:l[e];n=typeof a,"string"===n&&(r=ht.exec(a))&&r[1]&&(a=ct(t,e,r),n="number"),null!=a&&a===a&&("number"!==n||h||(a+=r&&r[3]||(y.cssNumber[o]?"":"px")),v.clearCloneStyle||""!==a||0!==e.indexOf("background")||(l[e]="inherit"),s&&"set"in s&&void 0===(a=s.set(t,a,i))||(h?l.setProperty(e,a):l[e]=a))}},css:function(t,e,a,i){var r,n,s,o=j(e),h=Wt.test(e);return h||(e=ae(o)),s=y.cssHooks[e]||y.cssHooks[o],s&&"get"in s&&(r=s.get(t,!0,a)),void 0===r&&(r=Zt(t,e,i)),"normal"===r&&e in ne&&(r=ne[e]),""===a||a?(n=parseFloat(r),!0===a||isFinite(n)?n||0:r):r}}),y.each(["height","width"],(function(t,e){y.cssHooks[e]={get:function(t,a,i){if(a)return!ie.test(y.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?he(t,e,i):Kt(t,re,(function(){return he(t,e,i)}))},set:function(t,a,i){var r,n=Ut(t),s=!v.scrollboxSize()&&"absolute"===n.position,o=s||i,h=o&&"border-box"===y.css(t,"boxSizing",!1,n),l=i?oe(t,e,i,h,n):0;return h&&s&&(l-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(n[e])-oe(t,e,"border",!1,n)-.5)),l&&(r=ht.exec(a))&&"px"!==(r[3]||"px")&&(t.style[e]=a,a=y.css(t,e)),se(t,a,l)}}})),y.cssHooks.marginLeft=Qt(v.reliableMarginLeft,(function(t,e){if(e)return(parseFloat(Zt(t,"marginLeft"))||t.getBoundingClientRect().left-Kt(t,{marginLeft:0},(function(){return t.getBoundingClientRect().left})))+"px"})),y.each({margin:"",padding:"",border:"Width"},(function(t,e){y.cssHooks[t+e]={expand:function(a){for(var i=0,r={},n="string"===typeof a?a.split(" "):[a];i<4;i++)r[t+lt[i]+e]=n[i]||n[i-2]||n[0];return r}},"margin"!==t&&(y.cssHooks[t+e].set=se)})),y.fn.extend({css:function(t,e){return z(this,(function(t,e,a){var i,r,n={},s=0;if(Array.isArray(e)){for(i=Ut(t),r=e.length;s<r;s++)n[e[s]]=y.css(t,e[s],!1,i);return n}return void 0!==a?y.style(t,e,a):y.css(t,e)}),t,e,arguments.length>1)}}),y.Tween=le,le.prototype={constructor:le,init:function(t,e,a,i,r,n){this.elem=t,this.prop=a,this.easing=r||y.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=n||(y.cssNumber[a]?"":"px")},cur:function(){var t=le.propHooks[this.prop];return t&&t.get?t.get(this):le.propHooks._default.get(this)},run:function(t){var e,a=le.propHooks[this.prop];return this.options.duration?this.pos=e=y.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),a&&a.set?a.set(this):le.propHooks._default.set(this),this}},le.prototype.init.prototype=le.prototype,le.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=y.css(t.elem,t.prop,""),e&&"auto"!==e?e:0)},set:function(t){y.fx.step[t.prop]?y.fx.step[t.prop](t):1!==t.elem.nodeType||!y.cssHooks[t.prop]&&null==t.elem.style[ae(t.prop)]?t.elem[t.prop]=t.now:y.style(t.elem,t.prop,t.now+t.unit)}}},le.propHooks.scrollTop=le.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},y.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},y.fx=le.prototype.init,y.fx.step={};var ue,Ce,De=/^(?:toggle|show|hide)$/,fe=/queueHooks$/;function ce(){Ce&&(!1===p.hidden&&a.requestAnimationFrame?a.requestAnimationFrame(ce):a.setTimeout(ce,y.fx.interval),y.fx.tick())}function de(){return a.setTimeout((function(){ue=void 0})),ue=Date.now()}function me(t,e){var a,i=0,r={height:t};for(e=e?1:0;i<4;i+=2-e)a=lt[i],r["margin"+a]=r["padding"+a]=t;return e&&(r.opacity=r.width=t),r}function ve(t,e,a){for(var i,r=(pe.tweeners[e]||[]).concat(pe.tweeners["*"]),n=0,s=r.length;n<s;n++)if(i=r[n].call(a,e,t))return i}function Se(t,e,a){var i,r,n,s,o,h,l,u,C="width"in e||"height"in e,D=this,f={},c=t.style,d=t.nodeType&&ft(t),m=et.get(t,"fxshow");for(i in a.queue||(s=y._queueHooks(t,"fx"),null==s.unqueued&&(s.unqueued=0,o=s.empty.fire,s.empty.fire=function(){s.unqueued||o()}),s.unqueued++,D.always((function(){D.always((function(){s.unqueued--,y.queue(t,"fx").length||s.empty.fire()}))}))),e)if(r=e[i],De.test(r)){if(delete e[i],n=n||"toggle"===r,r===(d?"hide":"show")){if("show"!==r||!m||void 0===m[i])continue;d=!0}f[i]=m&&m[i]||y.style(t,i)}if(h=!y.isEmptyObject(e),h||!y.isEmptyObject(f))for(i in C&&1===t.nodeType&&(a.overflow=[c.overflow,c.overflowX,c.overflowY],l=m&&m.display,null==l&&(l=et.get(t,"display")),u=y.css(t,"display"),"none"===u&&(l?u=l:(vt([t],!0),l=t.style.display||l,u=y.css(t,"display"),vt([t]))),("inline"===u||"inline-block"===u&&null!=l)&&"none"===y.css(t,"float")&&(h||(D.done((function(){c.display=l})),null==l&&(u=c.display,l="none"===u?"":u)),c.display="inline-block")),a.overflow&&(c.overflow="hidden",D.always((function(){c.overflow=a.overflow[0],c.overflowX=a.overflow[1],c.overflowY=a.overflow[2]}))),h=!1,f)h||(m?"hidden"in m&&(d=m.hidden):m=et.access(t,"fxshow",{display:l}),n&&(m.hidden=!d),d&&vt([t],!0),D.done((function(){for(i in d||vt([t]),et.remove(t,"fxshow"),f)y.style(t,i,f[i])}))),h=ve(d?m[i]:0,i,D),i in m||(m[i]=h.start,d&&(h.end=h.start,h.start=0))}function Ie(t,e){var a,i,r,n,s;for(a in t)if(i=j(a),r=e[i],n=t[a],Array.isArray(n)&&(r=n[1],n=t[a]=n[0]),a!==i&&(t[i]=n,delete t[a]),s=y.cssHooks[i],s&&"expand"in s)for(a in n=s.expand(n),delete t[i],n)a in t||(t[a]=n[a],e[a]=r);else e[i]=r}function pe(t,e,a){var i,r,n=0,s=pe.prefilters.length,o=y.Deferred().always((function(){delete h.elem})),h=function(){if(r)return!1;for(var e=ue||de(),a=Math.max(0,l.startTime+l.duration-e),i=a/l.duration||0,n=1-i,s=0,h=l.tweens.length;s<h;s++)l.tweens[s].run(n);return o.notifyWith(t,[l,n,a]),n<1&&h?a:(h||o.notifyWith(t,[l,1,0]),o.resolveWith(t,[l]),!1)},l=o.promise({elem:t,props:y.extend({},e),opts:y.extend(!0,{specialEasing:{},easing:y.easing._default},a),originalProperties:e,originalOptions:a,startTime:ue||de(),duration:a.duration,tweens:[],createTween:function(e,a){var i=y.Tween(t,l.opts,e,a,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(i),i},stop:function(e){var a=0,i=e?l.tweens.length:0;if(r)return this;for(r=!0;a<i;a++)l.tweens[a].run(1);return e?(o.notifyWith(t,[l,1,0]),o.resolveWith(t,[l,e])):o.rejectWith(t,[l,e]),this}}),u=l.props;for(Ie(u,l.opts.specialEasing);n<s;n++)if(i=pe.prefilters[n].call(l,t,u,l.opts),i)return S(i.stop)&&(y._queueHooks(l.elem,l.opts.queue).stop=i.stop.bind(i)),i;return y.map(u,ve,l),S(l.opts.start)&&l.opts.start.call(t,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),y.fx.timer(y.extend(h,{elem:t,anim:l,queue:l.opts.queue})),l}y.Animation=y.extend(pe,{tweeners:{"*":[function(t,e){var a=this.createTween(t,e);return ct(a.elem,t,ht.exec(e),a),a}]},tweener:function(t,e){S(t)?(e=t,t=["*"]):t=t.match(Y);for(var a,i=0,r=t.length;i<r;i++)a=t[i],pe.tweeners[a]=pe.tweeners[a]||[],pe.tweeners[a].unshift(e)},prefilters:[Se],prefilter:function(t,e){e?pe.prefilters.unshift(t):pe.prefilters.push(t)}}),y.speed=function(t,e,a){var i=t&&"object"===typeof t?y.extend({},t):{complete:a||!a&&e||S(t)&&t,duration:t,easing:a&&e||e&&!S(e)&&e};return y.fx.off?i.duration=0:"number"!==typeof i.duration&&(i.duration in y.fx.speeds?i.duration=y.fx.speeds[i.duration]:i.duration=y.fx.speeds._default),null!=i.queue&&!0!==i.queue||(i.queue="fx"),i.old=i.complete,i.complete=function(){S(i.old)&&i.old.call(this),i.queue&&y.dequeue(this,i.queue)},i},y.fn.extend({fadeTo:function(t,e,a,i){return this.filter(ft).css("opacity",0).show().end().animate({opacity:e},t,a,i)},animate:function(t,e,a,i){var r=y.isEmptyObject(t),n=y.speed(e,a,i),s=function(){var e=pe(this,y.extend({},t),n);(r||et.get(this,"finish"))&&e.stop(!0)};return s.finish=s,r||!1===n.queue?this.each(s):this.queue(n.queue,s)},stop:function(t,e,a){var i=function(t){var e=t.stop;delete t.stop,e(a)};return"string"!==typeof t&&(a=e,e=t,t=void 0),e&&this.queue(t||"fx",[]),this.each((function(){var e=!0,r=null!=t&&t+"queueHooks",n=y.timers,s=et.get(this);if(r)s[r]&&s[r].stop&&i(s[r]);else for(r in s)s[r]&&s[r].stop&&fe.test(r)&&i(s[r]);for(r=n.length;r--;)n[r].elem!==this||null!=t&&n[r].queue!==t||(n[r].anim.stop(a),e=!1,n.splice(r,1));!e&&a||y.dequeue(this,t)}))},finish:function(t){return!1!==t&&(t=t||"fx"),this.each((function(){var e,a=et.get(this),i=a[t+"queue"],r=a[t+"queueHooks"],n=y.timers,s=i?i.length:0;for(a.finish=!0,y.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=n.length;e--;)n[e].elem===this&&n[e].queue===t&&(n[e].anim.stop(!0),n.splice(e,1));for(e=0;e<s;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete a.finish}))}}),y.each(["toggle","show","hide"],(function(t,e){var a=y.fn[e];y.fn[e]=function(t,i,r){return null==t||"boolean"===typeof t?a.apply(this,arguments):this.animate(me(e,!0),t,i,r)}})),y.each({slideDown:me("show"),slideUp:me("hide"),slideToggle:me("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(t,e){y.fn[t]=function(t,a,i){return this.animate(e,t,a,i)}})),y.timers=[],y.fx.tick=function(){var t,e=0,a=y.timers;for(ue=Date.now();e<a.length;e++)t=a[e],t()||a[e]!==t||a.splice(e--,1);a.length||y.fx.stop(),ue=void 0},y.fx.timer=function(t){y.timers.push(t),y.fx.start()},y.fx.interval=13,y.fx.start=function(){Ce||(Ce=!0,ce())},y.fx.stop=function(){Ce=null},y.fx.speeds={slow:600,fast:200,_default:400},y.fn.delay=function(t,e){return t=y.fx&&y.fx.speeds[t]||t,e=e||"fx",this.queue(e,(function(e,i){var r=a.setTimeout(e,t);i.stop=function(){a.clearTimeout(r)}}))},function(){var t=p.createElement("input"),e=p.createElement("select"),a=e.appendChild(p.createElement("option"));t.type="checkbox",v.checkOn=""!==t.value,v.optSelected=a.selected,t=p.createElement("input"),t.value="t",t.type="radio",v.radioValue="t"===t.value}();var Te,ge=y.expr.attrHandle;y.fn.extend({attr:function(t,e){return z(this,y.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each((function(){y.removeAttr(this,t)}))}}),y.extend({attr:function(t,e,a){var i,r,n=t.nodeType;if(3!==n&&8!==n&&2!==n)return"undefined"===typeof t.getAttribute?y.prop(t,e,a):(1===n&&y.isXMLDoc(t)||(r=y.attrHooks[e.toLowerCase()]||(y.expr.match.bool.test(e)?Te:void 0)),void 0!==a?null===a?void y.removeAttr(t,e):r&&"set"in r&&void 0!==(i=r.set(t,a,e))?i:(t.setAttribute(e,a+""),a):r&&"get"in r&&null!==(i=r.get(t,e))?i:(i=y.find.attr(t,e),null==i?void 0:i))},attrHooks:{type:{set:function(t,e){if(!v.radioValue&&"radio"===e&&w(t,"input")){var a=t.value;return t.setAttribute("type",e),a&&(t.value=a),e}}}},removeAttr:function(t,e){var a,i=0,r=e&&e.match(Y);if(r&&1===t.nodeType)while(a=r[i++])t.removeAttribute(a)}}),Te={set:function(t,e,a){return!1===e?y.removeAttr(t,a):t.setAttribute(a,a),a}},y.each(y.expr.match.bool.source.match(/\w+/g),(function(t,e){var a=ge[e]||y.find.attr;ge[e]=function(t,e,i){var r,n,s=e.toLowerCase();return i||(n=ge[s],ge[s]=r,r=null!=a(t,e,i)?s:null,ge[s]=n),r}}));var xe=/^(?:input|select|textarea|button)$/i,Fe=/^(?:a|area)$/i;function ye(t){var e=t.match(Y)||[];return e.join(" ")}function Le(t){return t.getAttribute&&t.getAttribute("class")||""}function Ee(t){return Array.isArray(t)?t:"string"===typeof t&&t.match(Y)||[]}y.fn.extend({prop:function(t,e){return z(this,y.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each((function(){delete this[y.propFix[t]||t]}))}}),y.extend({prop:function(t,e,a){var i,r,n=t.nodeType;if(3!==n&&8!==n&&2!==n)return 1===n&&y.isXMLDoc(t)||(e=y.propFix[e]||e,r=y.propHooks[e]),void 0!==a?r&&"set"in r&&void 0!==(i=r.set(t,a,e))?i:t[e]=a:r&&"get"in r&&null!==(i=r.get(t,e))?i:t[e]},propHooks:{tabIndex:{get:function(t){var e=y.find.attr(t,"tabindex");return e?parseInt(e,10):xe.test(t.nodeName)||Fe.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),v.optSelected||(y.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),y.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){y.propFix[this.toLowerCase()]=this})),y.fn.extend({addClass:function(t){var e,a,i,r,n,s;return S(t)?this.each((function(e){y(this).addClass(t.call(this,e,Le(this)))})):(e=Ee(t),e.length?this.each((function(){if(i=Le(this),a=1===this.nodeType&&" "+ye(i)+" ",a){for(n=0;n<e.length;n++)r=e[n],a.indexOf(" "+r+" ")<0&&(a+=r+" ");s=ye(a),i!==s&&this.setAttribute("class",s)}})):this)},removeClass:function(t){var e,a,i,r,n,s;return S(t)?this.each((function(e){y(this).removeClass(t.call(this,e,Le(this)))})):arguments.length?(e=Ee(t),e.length?this.each((function(){if(i=Le(this),a=1===this.nodeType&&" "+ye(i)+" ",a){for(n=0;n<e.length;n++){r=e[n];while(a.indexOf(" "+r+" ")>-1)a=a.replace(" "+r+" "," ")}s=ye(a),i!==s&&this.setAttribute("class",s)}})):this):this.attr("class","")},toggleClass:function(t,e){var a,i,r,n,s=typeof t,o="string"===s||Array.isArray(t);return S(t)?this.each((function(a){y(this).toggleClass(t.call(this,a,Le(this),e),e)})):"boolean"===typeof e&&o?e?this.addClass(t):this.removeClass(t):(a=Ee(t),this.each((function(){if(o)for(n=y(this),r=0;r<a.length;r++)i=a[r],n.hasClass(i)?n.removeClass(i):n.addClass(i);else void 0!==t&&"boolean"!==s||(i=Le(this),i&&et.set(this,"__className__",i),this.setAttribute&&this.setAttribute("class",i||!1===t?"":et.get(this,"__className__")||""))})))},hasClass:function(t){var e,a,i=0;e=" "+t+" ";while(a=this[i++])if(1===a.nodeType&&(" "+ye(Le(a))+" ").indexOf(e)>-1)return!0;return!1}});var Me=/\r/g;y.fn.extend({val:function(t){var e,a,i,r=this[0];return arguments.length?(i=S(t),this.each((function(a){var r;1===this.nodeType&&(r=i?t.call(this,a,y(this).val()):t,null==r?r="":"number"===typeof r?r+="":Array.isArray(r)&&(r=y.map(r,(function(t){return null==t?"":t+""}))),e=y.valHooks[this.type]||y.valHooks[this.nodeName.toLowerCase()],e&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))}))):r?(e=y.valHooks[r.type]||y.valHooks[r.nodeName.toLowerCase()],e&&"get"in e&&void 0!==(a=e.get(r,"value"))?a:(a=r.value,"string"===typeof a?a.replace(Me,""):null==a?"":a)):void 0}}),y.extend({valHooks:{option:{get:function(t){var e=y.find.attr(t,"value");return null!=e?e:ye(y.text(t))}},select:{get:function(t){var e,a,i,r=t.options,n=t.selectedIndex,s="select-one"===t.type,o=s?null:[],h=s?n+1:r.length;for(i=n<0?h:s?n:0;i<h;i++)if(a=r[i],(a.selected||i===n)&&!a.disabled&&(!a.parentNode.disabled||!w(a.parentNode,"optgroup"))){if(e=y(a).val(),s)return e;o.push(e)}return o},set:function(t,e){var a,i,r=t.options,n=y.makeArray(e),s=r.length;while(s--)i=r[s],(i.selected=y.inArray(y.valHooks.option.get(i),n)>-1)&&(a=!0);return a||(t.selectedIndex=-1),n}}}}),y.each(["radio","checkbox"],(function(){y.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=y.inArray(y(t).val(),e)>-1}},v.checkOn||(y.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})})),v.focusin="onfocusin"in a;var Ae=/^(?:focusinfocus|focusoutblur)$/,Ne=function(t){t.stopPropagation()};y.extend(y.event,{trigger:function(t,e,i,r){var n,s,o,h,l,u,C,D,f=[i||p],d=c.call(t,"type")?t.type:t,m=c.call(t,"namespace")?t.namespace.split("."):[];if(s=D=o=i=i||p,3!==i.nodeType&&8!==i.nodeType&&!Ae.test(d+y.event.triggered)&&(d.indexOf(".")>-1&&(m=d.split("."),d=m.shift(),m.sort()),l=d.indexOf(":")<0&&"on"+d,t=t[y.expando]?t:new y.Event(d,"object"===typeof t&&t),t.isTrigger=r?2:3,t.namespace=m.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),e=null==e?[t]:y.makeArray(e,[t]),C=y.event.special[d]||{},r||!C.trigger||!1!==C.trigger.apply(i,e))){if(!r&&!C.noBubble&&!I(i)){for(h=C.delegateType||d,Ae.test(h+d)||(s=s.parentNode);s;s=s.parentNode)f.push(s),o=s;o===(i.ownerDocument||p)&&f.push(o.defaultView||o.parentWindow||a)}n=0;while((s=f[n++])&&!t.isPropagationStopped())D=s,t.type=n>1?h:C.bindType||d,u=(et.get(s,"events")||Object.create(null))[t.type]&&et.get(s,"handle"),u&&u.apply(s,e),u=l&&s[l],u&&u.apply&&$(s)&&(t.result=u.apply(s,e),!1===t.result&&t.preventDefault());return t.type=d,r||t.isDefaultPrevented()||C._default&&!1!==C._default.apply(f.pop(),e)||!$(i)||l&&S(i[d])&&!I(i)&&(o=i[l],o&&(i[l]=null),y.event.triggered=d,t.isPropagationStopped()&&D.addEventListener(d,Ne),i[d](),t.isPropagationStopped()&&D.removeEventListener(d,Ne),y.event.triggered=void 0,o&&(i[l]=o)),t.result}},simulate:function(t,e,a){var i=y.extend(new y.Event,a,{type:t,isSimulated:!0});y.event.trigger(i,null,e)}}),y.fn.extend({trigger:function(t,e){return this.each((function(){y.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var a=this[0];if(a)return y.event.trigger(t,e,a,!0)}}),v.focusin||y.each({focus:"focusin",blur:"focusout"},(function(t,e){var a=function(t){y.event.simulate(e,t.target,y.event.fix(t))};y.event.special[e]={setup:function(){var i=this.ownerDocument||this.document||this,r=et.access(i,e);r||i.addEventListener(t,a,!0),et.access(i,e,(r||0)+1)},teardown:function(){var i=this.ownerDocument||this.document||this,r=et.access(i,e)-1;r?et.access(i,e,r):(i.removeEventListener(t,a,!0),et.remove(i,e))}}}));var we=a.location,Oe={guid:Date.now()},Re=/\?/;y.parseXML=function(t){var e,i;if(!t||"string"!==typeof t)return null;try{e=(new a.DOMParser).parseFromString(t,"text/xml")}catch(r){}return i=e&&e.getElementsByTagName("parsererror")[0],e&&!i||y.error("Invalid XML: "+(i?y.map(i.childNodes,(function(t){return t.textContent})).join("\n"):t)),e};var Pe=/\[\]$/,be=/\r?\n/g,Be=/^(?:submit|button|image|reset|file)$/i,Ve=/^(?:input|select|textarea|keygen)/i;function Ge(t,e,a,i){var r;if(Array.isArray(e))y.each(e,(function(e,r){a||Pe.test(t)?i(t,r):Ge(t+"["+("object"===typeof r&&null!=r?e:"")+"]",r,a,i)}));else if(a||"object"!==x(e))i(t,e);else for(r in e)Ge(t+"["+r+"]",e[r],a,i)}y.param=function(t,e){var a,i=[],r=function(t,e){var a=S(e)?e():e;i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==a?"":a)};if(null==t)return"";if(Array.isArray(t)||t.jquery&&!y.isPlainObject(t))y.each(t,(function(){r(this.name,this.value)}));else for(a in t)Ge(a,t[a],e,r);return i.join("&")},y.fn.extend({serialize:function(){return y.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=y.prop(this,"elements");return t?y.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!y(this).is(":disabled")&&Ve.test(this.nodeName)&&!Be.test(t)&&(this.checked||!St.test(t))})).map((function(t,e){var a=y(this).val();return null==a?null:Array.isArray(a)?y.map(a,(function(t){return{name:e.name,value:t.replace(be,"\r\n")}})):{name:e.name,value:a.replace(be,"\r\n")}})).get()}});var He=/%20/g,Ye=/#.*$/,ke=/([?&])_=[^&]*/,_e=/^(.*?):[ \t]*([^\r\n]*)$/gm,Xe=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,We=/^(?:GET|HEAD)$/,Ue=/^\/\//,Ke={},Je={},ze="*/".concat("*"),qe=p.createElement("a");function Ze(t){return function(e,a){"string"!==typeof e&&(a=e,e="*");var i,r=0,n=e.toLowerCase().match(Y)||[];if(S(a))while(i=n[r++])"+"===i[0]?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(a)):(t[i]=t[i]||[]).push(a)}}function Qe(t,e,a,i){var r={},n=t===Je;function s(o){var h;return r[o]=!0,y.each(t[o]||[],(function(t,o){var l=o(e,a,i);return"string"!==typeof l||n||r[l]?n?!(h=l):void 0:(e.dataTypes.unshift(l),s(l),!1)})),h}return s(e.dataTypes[0])||!r["*"]&&s("*")}function je(t,e){var a,i,r=y.ajaxSettings.flatOptions||{};for(a in e)void 0!==e[a]&&((r[a]?t:i||(i={}))[a]=e[a]);return i&&y.extend(!0,t,i),t}function $e(t,e,a){var i,r,n,s,o=t.contents,h=t.dataTypes;while("*"===h[0])h.shift(),void 0===i&&(i=t.mimeType||e.getResponseHeader("Content-Type"));if(i)for(r in o)if(o[r]&&o[r].test(i)){h.unshift(r);break}if(h[0]in a)n=h[0];else{for(r in a){if(!h[0]||t.converters[r+" "+h[0]]){n=r;break}s||(s=r)}n=n||s}if(n)return n!==h[0]&&h.unshift(n),a[n]}function ta(t,e,a,i){var r,n,s,o,h,l={},u=t.dataTypes.slice();if(u[1])for(s in t.converters)l[s.toLowerCase()]=t.converters[s];n=u.shift();while(n)if(t.responseFields[n]&&(a[t.responseFields[n]]=e),!h&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),h=n,n=u.shift(),n)if("*"===n)n=h;else if("*"!==h&&h!==n){if(s=l[h+" "+n]||l["* "+n],!s)for(r in l)if(o=r.split(" "),o[1]===n&&(s=l[h+" "+o[0]]||l["* "+o[0]],s)){!0===s?s=l[r]:!0!==l[r]&&(n=o[0],u.unshift(o[1]));break}if(!0!==s)if(s&&t.throws)e=s(e);else try{e=s(e)}catch(C){return{state:"parsererror",error:s?C:"No conversion from "+h+" to "+n}}}return{state:"success",data:e}}qe.href=we.href,y.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:we.href,type:"GET",isLocal:Xe.test(we.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ze,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":y.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?je(je(t,y.ajaxSettings),e):je(y.ajaxSettings,t)},ajaxPrefilter:Ze(Ke),ajaxTransport:Ze(Je),ajax:function(t,e){"object"===typeof t&&(e=t,t=void 0),e=e||{};var i,r,n,s,o,h,l,u,C,D,f=y.ajaxSetup({},e),c=f.context||f,d=f.context&&(c.nodeType||c.jquery)?y(c):y.event,m=y.Deferred(),v=y.Callbacks("once memory"),S=f.statusCode||{},I={},T={},g="canceled",x={readyState:0,getResponseHeader:function(t){var e;if(l){if(!s){s={};while(e=_e.exec(n))s[e[1].toLowerCase()+" "]=(s[e[1].toLowerCase()+" "]||[]).concat(e[2])}e=s[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return l?n:null},setRequestHeader:function(t,e){return null==l&&(t=T[t.toLowerCase()]=T[t.toLowerCase()]||t,I[t]=e),this},overrideMimeType:function(t){return null==l&&(f.mimeType=t),this},statusCode:function(t){var e;if(t)if(l)x.always(t[x.status]);else for(e in t)S[e]=[S[e],t[e]];return this},abort:function(t){var e=t||g;return i&&i.abort(e),F(0,e),this}};if(m.promise(x),f.url=((t||f.url||we.href)+"").replace(Ue,we.protocol+"//"),f.type=e.method||e.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match(Y)||[""],null==f.crossDomain){h=p.createElement("a");try{h.href=f.url,h.href=h.href,f.crossDomain=qe.protocol+"//"+qe.host!==h.protocol+"//"+h.host}catch(L){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!==typeof f.data&&(f.data=y.param(f.data,f.traditional)),Qe(Ke,f,e,x),l)return x;for(C in u=y.event&&f.global,u&&0===y.active++&&y.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!We.test(f.type),r=f.url.replace(Ye,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(He,"+")):(D=f.url.slice(r.length),f.data&&(f.processData||"string"===typeof f.data)&&(r+=(Re.test(r)?"&":"?")+f.data,delete f.data),!1===f.cache&&(r=r.replace(ke,"$1"),D=(Re.test(r)?"&":"?")+"_="+Oe.guid+++D),f.url=r+D),f.ifModified&&(y.lastModified[r]&&x.setRequestHeader("If-Modified-Since",y.lastModified[r]),y.etag[r]&&x.setRequestHeader("If-None-Match",y.etag[r])),(f.data&&f.hasContent&&!1!==f.contentType||e.contentType)&&x.setRequestHeader("Content-Type",f.contentType),x.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+ze+"; q=0.01":""):f.accepts["*"]),f.headers)x.setRequestHeader(C,f.headers[C]);if(f.beforeSend&&(!1===f.beforeSend.call(c,x,f)||l))return x.abort();if(g="abort",v.add(f.complete),x.done(f.success),x.fail(f.error),i=Qe(Je,f,e,x),i){if(x.readyState=1,u&&d.trigger("ajaxSend",[x,f]),l)return x;f.async&&f.timeout>0&&(o=a.setTimeout((function(){x.abort("timeout")}),f.timeout));try{l=!1,i.send(I,F)}catch(L){if(l)throw L;F(-1,L)}}else F(-1,"No Transport");function F(t,e,s,h){var C,D,I,p,T,g=e;l||(l=!0,o&&a.clearTimeout(o),i=void 0,n=h||"",x.readyState=t>0?4:0,C=t>=200&&t<300||304===t,s&&(p=$e(f,x,s)),!C&&y.inArray("script",f.dataTypes)>-1&&y.inArray("json",f.dataTypes)<0&&(f.converters["text script"]=function(){}),p=ta(f,p,x,C),C?(f.ifModified&&(T=x.getResponseHeader("Last-Modified"),T&&(y.lastModified[r]=T),T=x.getResponseHeader("etag"),T&&(y.etag[r]=T)),204===t||"HEAD"===f.type?g="nocontent":304===t?g="notmodified":(g=p.state,D=p.data,I=p.error,C=!I)):(I=g,!t&&g||(g="error",t<0&&(t=0))),x.status=t,x.statusText=(e||g)+"",C?m.resolveWith(c,[D,g,x]):m.rejectWith(c,[x,g,I]),x.statusCode(S),S=void 0,u&&d.trigger(C?"ajaxSuccess":"ajaxError",[x,f,C?D:I]),v.fireWith(c,[x,g]),u&&(d.trigger("ajaxComplete",[x,f]),--y.active||y.event.trigger("ajaxStop")))}return x},getJSON:function(t,e,a){return y.get(t,e,a,"json")},getScript:function(t,e){return y.get(t,void 0,e,"script")}}),y.each(["get","post"],(function(t,e){y[e]=function(t,a,i,r){return S(a)&&(r=r||i,i=a,a=void 0),y.ajax(y.extend({url:t,type:e,dataType:r,data:a,success:i},y.isPlainObject(t)&&t))}})),y.ajaxPrefilter((function(t){var e;for(e in t.headers)"content-type"===e.toLowerCase()&&(t.contentType=t.headers[e]||"")})),y._evalUrl=function(t,e,a){return y.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){y.globalEval(t,e,a)}})},y.fn.extend({wrapAll:function(t){var e;return this[0]&&(S(t)&&(t=t.call(this[0])),e=y(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){var t=this;while(t.firstElementChild)t=t.firstElementChild;return t})).append(this)),this},wrapInner:function(t){return S(t)?this.each((function(e){y(this).wrapInner(t.call(this,e))})):this.each((function(){var e=y(this),a=e.contents();a.length?a.wrapAll(t):e.append(t)}))},wrap:function(t){var e=S(t);return this.each((function(a){y(this).wrapAll(e?t.call(this,a):t)}))},unwrap:function(t){return this.parent(t).not("body").each((function(){y(this).replaceWith(this.childNodes)})),this}}),y.expr.pseudos.hidden=function(t){return!y.expr.pseudos.visible(t)},y.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},y.ajaxSettings.xhr=function(){try{return new a.XMLHttpRequest}catch(t){}};var ea={0:200,1223:204},aa=y.ajaxSettings.xhr();v.cors=!!aa&&"withCredentials"in aa,v.ajax=aa=!!aa,y.ajaxTransport((function(t){var e,i;if(v.cors||aa&&!t.crossDomain)return{send:function(r,n){var s,o=t.xhr();if(o.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(s in t.xhrFields)o[s]=t.xhrFields[s];for(s in t.mimeType&&o.overrideMimeType&&o.overrideMimeType(t.mimeType),t.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest"),r)o.setRequestHeader(s,r[s]);e=function(t){return function(){e&&(e=i=o.onload=o.onerror=o.onabort=o.ontimeout=o.onreadystatechange=null,"abort"===t?o.abort():"error"===t?"number"!==typeof o.status?n(0,"error"):n(o.status,o.statusText):n(ea[o.status]||o.status,o.statusText,"text"!==(o.responseType||"text")||"string"!==typeof o.responseText?{binary:o.response}:{text:o.responseText},o.getAllResponseHeaders()))}},o.onload=e(),i=o.onerror=o.ontimeout=e("error"),void 0!==o.onabort?o.onabort=i:o.onreadystatechange=function(){4===o.readyState&&a.setTimeout((function(){e&&i()}))},e=e("abort");try{o.send(t.hasContent&&t.data||null)}catch(h){if(e)throw h}},abort:function(){e&&e()}}})),y.ajaxPrefilter((function(t){t.crossDomain&&(t.contents.script=!1)})),y.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return y.globalEval(t),t}}}),y.ajaxPrefilter("script",(function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")})),y.ajaxTransport("script",(function(t){var e,a;if(t.crossDomain||t.scriptAttrs)return{send:function(i,r){e=y("<script>").attr(t.scriptAttrs||{}).prop({charset:t.scriptCharset,src:t.url}).on("load error",a=function(t){e.remove(),a=null,t&&r("error"===t.type?404:200,t.type)}),p.head.appendChild(e[0])},abort:function(){a&&a()}}}));var ia=[],ra=/(=)\?(?=&|$)|\?\?/;y.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=ia.pop()||y.expando+"_"+Oe.guid++;return this[t]=!0,t}}),y.ajaxPrefilter("json jsonp",(function(t,e,i){var r,n,s,o=!1!==t.jsonp&&(ra.test(t.url)?"url":"string"===typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&ra.test(t.data)&&"data");if(o||"jsonp"===t.dataTypes[0])return r=t.jsonpCallback=S(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,o?t[o]=t[o].replace(ra,"$1"+r):!1!==t.jsonp&&(t.url+=(Re.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return s||y.error(r+" was not called"),s[0]},t.dataTypes[0]="json",n=a[r],a[r]=function(){s=arguments},i.always((function(){void 0===n?y(a).removeProp(r):a[r]=n,t[r]&&(t.jsonpCallback=e.jsonpCallback,ia.push(r)),s&&S(n)&&n(s[0]),s=n=void 0})),"script"})),v.createHTMLDocument=function(){var t=p.implementation.createHTMLDocument("").body;return t.innerHTML="<form></form><form></form>",2===t.childNodes.length}(),y.parseHTML=function(t,e,a){return"string"!==typeof t?[]:("boolean"===typeof e&&(a=e,e=!1),e||(v.createHTMLDocument?(e=p.implementation.createHTMLDocument(""),i=e.createElement("base"),i.href=p.location.href,e.head.appendChild(i)):e=p),r=O.exec(t),n=!a&&[],r?[e.createElement(r[1])]:(r=yt([t],e,n),n&&n.length&&y(n).remove(),y.merge([],r.childNodes)));var i,r,n},y.fn.load=function(t,e,a){var i,r,n,s=this,o=t.indexOf(" ");return o>-1&&(i=ye(t.slice(o)),t=t.slice(0,o)),S(e)?(a=e,e=void 0):e&&"object"===typeof e&&(r="POST"),s.length>0&&y.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done((function(t){n=arguments,s.html(i?y("<div>").append(y.parseHTML(t)).find(i):t)})).always(a&&function(t,e){s.each((function(){a.apply(this,n||[t.responseText,e,t])}))}),this},y.expr.pseudos.animated=function(t){return y.grep(y.timers,(function(e){return t===e.elem})).length},y.offset={setOffset:function(t,e,a){var i,r,n,s,o,h,l,u=y.css(t,"position"),C=y(t),D={};"static"===u&&(t.style.position="relative"),o=C.offset(),n=y.css(t,"top"),h=y.css(t,"left"),l=("absolute"===u||"fixed"===u)&&(n+h).indexOf("auto")>-1,l?(i=C.position(),s=i.top,r=i.left):(s=parseFloat(n)||0,r=parseFloat(h)||0),S(e)&&(e=e.call(t,a,y.extend({},o))),null!=e.top&&(D.top=e.top-o.top+s),null!=e.left&&(D.left=e.left-o.left+r),"using"in e?e.using.call(t,D):C.css(D)}},y.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){y.offset.setOffset(this,t,e)}));var e,a,i=this[0];return i?i.getClientRects().length?(e=i.getBoundingClientRect(),a=i.ownerDocument.defaultView,{top:e.top+a.pageYOffset,left:e.left+a.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,a,i=this[0],r={top:0,left:0};if("fixed"===y.css(i,"position"))e=i.getBoundingClientRect();else{e=this.offset(),a=i.ownerDocument,t=i.offsetParent||a.documentElement;while(t&&(t===a.body||t===a.documentElement)&&"static"===y.css(t,"position"))t=t.parentNode;t&&t!==i&&1===t.nodeType&&(r=y(t).offset(),r.top+=y.css(t,"borderTopWidth",!0),r.left+=y.css(t,"borderLeftWidth",!0))}return{top:e.top-r.top-y.css(i,"marginTop",!0),left:e.left-r.left-y.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){var t=this.offsetParent;while(t&&"static"===y.css(t,"position"))t=t.offsetParent;return t||ut}))}}),y.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,e){var a="pageYOffset"===e;y.fn[t]=function(i){return z(this,(function(t,i,r){var n;if(I(t)?n=t:9===t.nodeType&&(n=t.defaultView),void 0===r)return n?n[e]:t[i];n?n.scrollTo(a?n.pageXOffset:r,a?r:n.pageYOffset):t[i]=r}),t,i,arguments.length)}})),y.each(["top","left"],(function(t,e){y.cssHooks[e]=Qt(v.pixelPosition,(function(t,a){if(a)return a=Zt(t,e),Xt.test(a)?y(t).position()[e]+"px":a}))})),y.each({Height:"height",Width:"width"},(function(t,e){y.each({padding:"inner"+t,content:e,"":"outer"+t},(function(a,i){y.fn[i]=function(r,n){var s=arguments.length&&(a||"boolean"!==typeof r),o=a||(!0===r||!0===n?"margin":"border");return z(this,(function(e,a,r){var n;return I(e)?0===i.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(n=e.documentElement,Math.max(e.body["scroll"+t],n["scroll"+t],e.body["offset"+t],n["offset"+t],n["client"+t])):void 0===r?y.css(e,a,o):y.style(e,a,r,o)}),e,s?r:void 0,s)}}))})),y.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(t,e){y.fn[e]=function(t){return this.on(e,t)}})),y.fn.extend({bind:function(t,e,a){return this.on(t,null,e,a)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,a,i){return this.on(e,t,a,i)},undelegate:function(t,e,a){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",a)},hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),y.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(t,e){y.fn[e]=function(t,a){return arguments.length>0?this.on(e,null,t,a):this.trigger(e)}}));var na=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;y.proxy=function(t,e){var a,i,r;if("string"===typeof e&&(a=t[e],e=t,t=a),S(t))return i=h.call(arguments,2),r=function(){return t.apply(e||this,i.concat(h.call(arguments)))},r.guid=t.guid=t.guid||y.guid++,r},y.holdReady=function(t){t?y.readyWait++:y.ready(!0)},y.isArray=Array.isArray,y.parseJSON=JSON.parse,y.nodeName=w,y.isFunction=S,y.isWindow=I,y.camelCase=j,y.type=x,y.now=Date.now,y.isNumeric=function(t){var e=y.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},y.trim=function(t){return null==t?"":(t+"").replace(na,"$1")},i=[],r=function(){return y}.apply(e,i),void 0===r||(t.exports=r);var sa=a.jQuery,oa=a.$;return y.noConflict=function(t){return a.$===y&&(a.$=oa),t&&a.jQuery===y&&(a.jQuery=sa),y},"undefined"===typeof n&&(a.jQuery=a.$=y),y}))},"55a6":function(t,e,a){a("7ba0"),a("3700"),a("4682"),a("a3b7"),a("db84"),a("8713"),a("bf2f"),t.exports=a("2194").Set},"57fb":function(t,e,a){var i=a("fab1");t.exports=function(t,e){if(!i(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},"5b30":function(t,e,a){t.exports={default:a("20da"),__esModule:!0}},"5e48":function(t,e,a){var i=a("d8ed"),r=a("d922").set,n=i.MutationObserver||i.WebKitMutationObserver,s=i.process,o=i.Promise,h="process"==a("e1b6")(s);t.exports=function(){var t,e,a,l=function(){var i,r;h&&(i=s.domain)&&i.exit();while(t){r=t.fn,t=t.next;try{r()}catch(n){throw t?a():e=void 0,n}}e=void 0,i&&i.enter()};if(h)a=function(){s.nextTick(l)};else if(!n||i.navigator&&i.navigator.standalone)if(o&&o.resolve){var u=o.resolve(void 0);a=function(){u.then(l)}}else a=function(){r.call(i,l)};else{var C=!0,D=document.createTextNode("");new n(l).observe(D,{characterData:!0}),a=function(){D.data=C=!C}}return function(i){var r={fn:i,next:void 0};e&&(e.next=r),t||(t=r,a()),e=r}}},"5feb":function(t,e,a){var i=a("0999");t.exports=function(t,e){return new(i(t))(e)}},6271:function(t,e,a){var i=a("24fb");e=i(!1),e.push([t.i,".ec-canvas[data-v-505e2c95]{width:100%;height:100%}",""]),t.exports=e},6309:function(t,e,a){"use strict";var i=a("9492").f,r=a("079a"),n=a("2130"),s=a("ccbf"),o=a("919c"),h=a("23e3"),l=a("b2e7"),u=a("f7cb"),C=a("09cf"),D=a("be29"),f=a("0856").fastKey,c=a("57fb"),d=D?"_s":"size",m=function(t,e){var a,i=f(e);if("F"!==i)return t._i[i];for(a=t._f;a;a=a.n)if(a.k==e)return a};t.exports={getConstructor:function(t,e,a,l){var u=t((function(t,i){o(t,u,e,"_i"),t._t=e,t._i=r(null),t._f=void 0,t._l=void 0,t[d]=0,void 0!=i&&h(i,a,t[l],t)}));return n(u.prototype,{clear:function(){for(var t=c(this,e),a=t._i,i=t._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete a[i.i];t._f=t._l=void 0,t[d]=0},delete:function(t){var a=c(this,e),i=m(a,t);if(i){var r=i.n,n=i.p;delete a._i[i.i],i.r=!0,n&&(n.n=r),r&&(r.p=n),a._f==i&&(a._f=r),a._l==i&&(a._l=n),a[d]--}return!!i},forEach:function(t){c(this,e);var a,i=s(t,arguments.length>1?arguments[1]:void 0,3);while(a=a?a.n:this._f){i(a.v,a.k,this);while(a&&a.r)a=a.p}},has:function(t){return!!m(c(this,e),t)}}),D&&i(u.prototype,"size",{get:function(){return c(this,e)[d]}}),u},def:function(t,e,a){var i,r,n=m(t,e);return n?n.v=a:(t._l=n={i:r=f(e,!0),k:e,v:a,p:i=t._l,n:void 0,r:!1},t._f||(t._f=n),i&&(i.n=n),t[d]++,"F"!==r&&(t._i[r]=n)),t},getEntry:m,setStrong:function(t,e,a){l(t,e,(function(t,a){this._t=c(t,e),this._k=a,this._l=void 0}),(function(){var t=this,e=t._k,a=t._l;while(a&&a.r)a=a.p;return t._t&&(t._l=a=a?a.n:t._t._f)?u(0,"keys"==e?a.k:"values"==e?a.v:[a.k,a.v]):(t._t=void 0,u(1))}),a?"entries":"values",!a,!0),C(e)}}},6539:function(t,e,a){"use strict";a("a4d3"),a("e01a"),a("cb29"),a("4de4"),a("7db0"),a("4160"),a("c975"),a("baa5"),a("26e9"),a("fb6a"),a("4e82"),a("a434"),a("a9e3"),a("d3b7"),a("acd8"),a("e25e"),a("4d63"),a("ac1f"),a("25f0"),a("466d"),a("5319"),a("841c"),a("1276"),a("498a"),a("159b"),a("ddb0"),Object.defineProperty(e,"__esModule",{value:!0});var r,n=a("8a50"),s=(N(n),a("3c8c")),o=N(s),h=a("a812d"),l=N(h),u=a("1c7d"),C=N(u),D=a("8e09"),f=N(D),c=a("41d3"),d=N(c),m=a("9ae4"),v=N(m),S=a("09b7"),I=N(S),p=a("a266"),T=N(p),g=a("5b30"),F=N(g),L=a("cb17"),E=N(L),M=a("554f"),A=N(M);function N(t){return t&&t.__esModule?t:{default:t}}var w={Chart:{Log:console.log,Warn:console.warn},Complier:{Log:console.log,Warn:console.warn},JSTable:{Log:console.log,Warn:console.warn}};function O(){}O.HttpRequest=function(t){A.default.ajax({url:t.url,data:t.data,type:t.type,dataType:t.dataType,async:t.async,success:t.success,error:t.error})};var R={MINUTE_ID:101,MULTIDAY_MINUTE_ID:102,HISTORY_MINUTE_ID:103,KLINE_DAY_ID:0,KLINE_WEEK_ID:1,KLINE_TWOWEEK_ID:21,KLINE_MONTH_ID:2,KLINE_QUARTER_ID:9,KLINE_YEAR_ID:3,KLINE_MINUTE_ID:4,KLINE_5_MINUTE_ID:5,KLINE_15_MINUTE_ID:6,KLINE_30_MINUTE_ID:7,KLINE_60_MINUTE_ID:8};function P(){this.DataMap=new E.default,this.Get=function(t){return this.DataMap.has(t)?this.DataMap.get(t):null},this.Add=function(t){this.DataMap.set(t.ID,t)}}var b=new P;function B(){this.DataMap=new E.default([["MA",this.MA],["åçº¿",this.MA],["MA4",this.MA4],["MA5",this.MA5],["MA6",this.MA6],["MA7",this.MA7],["MA8",this.MA8],["BOLL",this.BOLL],["BOLLå¯å¾",this.BOLL2],["BBI",this.BBI],["DKX",this.DKX],["MIKE",this.MIKE],["PBX",this.PBX],["ENE",this.ENE],["MACD",this.MACD],["KDJ",this.KDJ],["MACD2",this.MACD2],["VOL",this.VOL],["RSI",this.RSI],["BRAR",this.BRAR],["WR",this.WR],["BIAS",this.BIAS],["OBV",this.OBV],["DMI",this.DMI],["CR",this.CR],["PSY",this.PSY],["CCI",this.CCI],["DMA",this.DMA],["TRIX",this.TRIX],["VR",this.VR],["EMV",this.EMV],["ROC",this.ROC],["MTM",this.MTM],["FSL",this.FSL],["CYR",this.CYR],["MASS",this.MASS],["WAD",this.WAD],["CHO",this.CHO],["ADTM",this.ADTM],["HSL",this.HSL],["BIAS36",this.BIAS36],["BIAS_QL",this.BIAS_QL],["DPO",this.DPO],["OSC",this.OSC],["ATR",this.ATR],["NVI",this.NVI],["PVI",this.PVI],["UOS",this.UOS],["CYW",this.CYW],["LON",this.LON],["NDB",this.NDB],["SKDJ",this.SKDJ],["KD",this.KD],["FKX",this.FKX],["DKCOL",this.DKCOL],["UDL",this.UDL],["MFI",this.MFI],["LWR",this.LWR],["MARSI",this.MARSI],["CYD",this.CYD],["CYF",this.CYF],["TAPI",this.TAPI],["VMACD",this.VMACD],["QACD",this.QACD],["VPT",this.VPT],["WVAD",this.WVAD],["DBQR",this.DBQR],["JS",this.JS],["CYE",this.CYE],["QR",this.QR],["GDX",this.GDX],["JLHB",this.JLHB],["PCNT",this.PCNT],["BTX",this.BTX],["AMO",this.AMO],["VRSI",this.VRSI],["HSCOL",this.HSCOL],["DBQRV",this.DBQRV],["DBLB",this.DBLB],["ACD",this.ACD],["EXPMA",this.EXPMA],["EXPMA_S",this.EXPMA_S],["HMA",this.HMA],["LMA",this.LMA],["VMA",this.VMA],["AMV",this.AMV],["BBIBOLL",this.BBIBOLL],["ALLIGAT",this.ALLIGAT],["ZX",this.ZX],["XS",this.XS],["XS2",this.XS2],["SG-XDT",this.SG_XDT],["SG-SMX",this.SG_SMX],["SG-LB",this.SG_LB],["SG-PF",this.SG_PF],["RAD",this.RAD],["SHT",this.SHT],["ZLJC",this.ZLJC],["ZLMM",this.ZLMM],["SLZT",this.SLZT],["ADVOL",this.ADVOL],["CYC",this.CYC],["CYS",this.CYS],["CYQKL",this.CYQKL],["SCR",this.SCR],["ASR",this.ASR],["SAR",this.SAR],["TJCJL",this.TJCJL],["éæ¯",this.VOLRate],["å¹³åKçº¿",this.HeikinAshi],["ADL",this.ADL],["SQJZ",this.SQJZ],["XT",this.XT],["CFJT",this.CFJT],["CYX",this.CYX],["WAVE",this.WAVE],["VOL-TDX",this.VOL_TDX],["EMPTY",this.EMPTY],["ç¥å¥ä¹è½¬",this.NineTurns],["EMA",this.EMA3],["EMA4",this.EMA4],["EMA5",this.EMA5],["EMA6",this.EMA6],["æ£æ·çº¿",this.ShareholderCount],["NXTS",this.NXTS],["FKX",this.FKX],["ä¸¤èèµé",this.Margin4],["ZSDB",this.ZSDB],["CJL2",this.CJL],["ASI",this.ASI],["DC",this.DC],["DEMA",this.DEMA],["VWAP",this.VWAP],["é£é¾åå¼",this.Dragon4_Main],["é£é¾åå¼-éå¾",this.Dragon4_Fig],["èµéåæ",this.FundsAnalysis],["èèµå æ¯",this.MarginProportion],["è´é¢æ°é»",this.NewsNegative],["æ¶¨è·è¶å¿",this.UpDownAnalyze],["åä¸èµé",this.HK2SHSZ],["è¡ä¸äººæ°",this.ShareHolder],["ä¸¤èä½é¢",this.Margin2],["ä¸¤èä½é¢2",this.Margin3],["Zealink-èµéå¸ç­¹",this.Zealink_Index1],["Zealink-ççåºé´",this.Zealink_Index2],["Zealink-æä»ä¿¡å·",this.Zealink_Index3],["Zealink-å¢åæ",this.Zealink_Index4],["Zealink-å¤§å®äº¤æ",this.Zealink_Index5],["Zealink-ä¿¡ææè¡",this.Zealink_Index6],["Zealink-å®ç½æ°é»",this.Zealink_Index7],["Zealink-é«ç®¡è¦é»",this.Zealink_Index8],["Zealink-è¡æè´¨æ¼",this.Zealink_Index9],["Zealink-æçBSç¹",this.Zealink_Index10],["Zealink-æçBSç¹2",this.Zealink_Index11],["æ¾å¿è¡-æçBSç¹",this.FXG_BSPoint],["æ¾å¿è¡-æ¶¨åå¤ç©ºçº¿",this.FXG_INDEX],["æ¾å¿è¡-æ¶¨åå¸ç­¹åº",this.FXG_INDEX2],["æ¾å¿è¡-éè½é»éç¹",this.FXG_INDEX3],["äºå½©Kçº¿-åå­æ",this.COLOR_KSTAR1],["äºå½©Kçº¿-æ©æ¨ä¹æ",this.COLOR_KSTAR2],["äºå½©Kçº¿-é»æä¹æ",this.COLOR_KSTAR3],["äºå½©Kçº¿-é¿åå­",this.COLOR_SHI1],["äºå½©Kçº¿-èº«æå­ç²",this.COLOR_K220],["äºå½©Kçº¿-ä¸ä¸ªç½æ­¦å£«",this.COLOR_K300],["äºå½©Kçº¿-ä¸åªä¹é¸¦",this.COLOR_K310],["äºå½©Kçº¿-åå¤´é³çº¿",this.COLOR_K380],["äºå½©Kçº¿-åèé´çº¿",this.COLOR_K390],["äºå½©Kçº¿-åæ­»åå­",this.COLOR_K134],["äºå½©Kçº¿-æ©æ¨åå­æ",this.COLOR_K140],["äºå½©Kçº¿-é»æåå­æ",this.COLOR_K150],["äºå½©Kçº¿-å°å»ä¹æ",this.COLOR_K160],["äºå½©Kçº¿-åè½¬é¤å¤´",this.COLOR_K165],["äºå½©Kçº¿-é¤å¤´",this.COLOR_K170],["äºå½©Kçº¿-åé¢",this.COLOR_K180],["äºå½©Kçº¿-ç©¿å¤´ç ´è",this.COLOR_K190],["äºå½©Kçº¿-åºæ°´èè",this.COLOR_CSFR],["äºå½©Kçº¿-ä¹äºçé¡¶",this.COLOR_WYGD],["äºå½©Kçº¿-æååç°",this.COLOR_SGCJ],["äºå½©Kçº¿-åå­è",this.COLOR_SZTAI],["äºå½©Kçº¿-å",this.COLOR_SWORD],["äºå½©Kçº¿-å¹³é¡¶",this.COLOR_PINGDING],["äºå½©Kçº¿-å¹³åº",this.COLOR_PINGDI],["äºå½©Kçº¿-å¤§é³ç",this.COLOR_DAYANZHU],["äºå½©Kçº¿-å¤§é´ç",this.COLOR_DAYINGZHU],["äºå½©Kçº¿-å¥½ååæ»",this.COLOR_HYFG],["äºå½©Kçº¿-è·³ç©ºç¼ºå£",this.COLOR_TKQK],["äºå½©Kçº¿-åé£ä¹é¸¦",this.COLOR_SFWY],["äºå½©Kçº¿-ä¸åä¸é¨æ²",this.COLOR_SSSBQ],["äºå½©Kçº¿-ä¸è·ä¸é¨æ²",this.COLOR_XDSBQ],["äºå½©Kçº¿-é¿ä¸å½±",this.COLOR_CHXY],["äºå½©Kçº¿-é¿ä¸å½±",this.COLOR_CHSY],["äºå½©Kçº¿-åç¦»",this.COLOR_FENLI],["äº¤æç³»ç»-BIAS",this.TRADE_BIAS],["äº¤æç³»ç»-CCI",this.TRADE_CCI],["äº¤æç³»ç»-DMI",this.TRADE_DMI],["äº¤æç³»ç»-KD",this.TRADE_KD],["äº¤æç³»ç»-BOLL",this.TRADE_BOLL],["äº¤æç³»ç»-KDJ",this.TRADE_KDJ],["äº¤æç³»ç»-MA",this.TRADE_MA],["äº¤æç³»ç»-MACD",this.TRADE_MACD],["äº¤æç³»ç»-MTM",this.TRADE_MTM],["äº¤æç³»ç»-PSY",this.TRADE_PSY],["äº¤æç³»ç»-ROC",this.TRADE_ROC],["äº¤æç³»ç»-RSI",this.TRADE_RSI],["äº¤æç³»ç»-VR",this.TRADE_VR],["äº¤æç³»ç»-DPSJ",this.TRADE_DPSJ],["TEST",this.TEST]])}if(B.AddIndex=function(t){for(var e in t)b.Add(t[e])},B.prototype.Get=function(t){var e=b.Get(t);if(e)return e;var a=this.DataMap.get(t);return a?a():null},B.prototype.Search=function(t){var e=[],a=new RegExp(t,"i");return this.DataMap.forEach((function(t,i){0!=i.indexOf("äº¤æç³»ç»-")&&0!=i.indexOf("äºå½©Kçº¿-")&&i.search(a)>=0&&e.push(i)})),e},B.prototype.MA=function(){var t={Name:"MA",Description:"åçº¿",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"}],Script:"MA1:MA(CLOSE,M1);\nMA2:MA(CLOSE,M2);\nMA3:MA(CLOSE,M3);"};return t},B.prototype.MA4=function(){var t={Name:"MA",Description:"åçº¿",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"}],Script:"MA1:MA(CLOSE,M1);\nMA2:MA(CLOSE,M2);\nMA3:MA(CLOSE,M3);\nMA4:MA(CLOSE,M4);"};return t},B.prototype.MA5=function(){var t={Name:"MA",Description:"åçº¿",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60},{Name:"M5",Value:0}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"},{Name:"MA5",DynamicName:"MA{M5}"}],Script:"MA1:MA(CLOSE,M1);\nMA2:MA(CLOSE,M2);\nMA3:MA(CLOSE,M3);\nMA4:MA(CLOSE,M4);\nMA5:MA(CLOSE,M5);"};return t},B.prototype.MA6=function(){var t={Name:"MA",Description:"åçº¿",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60},{Name:"M5",Value:0},{Name:"M6",Value:0}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"},{Name:"MA5",DynamicName:"MA{M5}"},{Name:"MA6",DynamicName:"MA{M6}"}],Script:"MA1:MA(CLOSE,M1);\nMA2:MA(CLOSE,M2);\nMA3:MA(CLOSE,M3);\nMA4:MA(CLOSE,M4);\nMA5:MA(CLOSE,M5);\nMA6:MA(CLOSE,M6);"};return t},B.prototype.MA7=function(){var t={Name:"MA",Description:"åçº¿",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60},{Name:"M5",Value:0},{Name:"M6",Value:0},{Name:"M7",Value:0}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"},{Name:"MA5",DynamicName:"MA{M5}"},{Name:"MA6",DynamicName:"MA{M6}"},{Name:"MA7",DynamicName:"MA{M7}"}],Script:"MA1:MA(CLOSE,M1);\nMA2:MA(CLOSE,M2);\nMA3:MA(CLOSE,M3);\nMA4:MA(CLOSE,M4);\nMA5:MA(CLOSE,M5);\nMA6:MA(CLOSE,M6);\nMA7:MA(CLOSE,M7);"};return t},B.prototype.MA8=function(){var t={Name:"MA",Description:"åçº¿",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60},{Name:"M5",Value:0},{Name:"M6",Value:0},{Name:"M7",Value:0},{Name:"M8",Value:0}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"},{Name:"MA5",DynamicName:"MA{M5}"},{Name:"MA6",DynamicName:"MA{M6}"},{Name:"MA7",DynamicName:"MA{M7}"},{Name:"MA8",DynamicName:"MA{M8}"}],Script:"MA1:MA(CLOSE,M1);\nMA2:MA(CLOSE,M2);\nMA3:MA(CLOSE,M3);\nMA4:MA(CLOSE,M4);\nMA5:MA(CLOSE,M5);\nMA6:MA(CLOSE,M6);\nMA7:MA(CLOSE,M7);\nMA8:MA(CLOSE,M8);"};return t},B.prototype.EMA3=function(){var t={Name:"EMA",Description:"ææ°ç§»å¨å¹³åå¼",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"}],Script:"MA1:EMA(CLOSE,M1);\nMA2:EMA(CLOSE,M2);\nMA3:EMA(CLOSE,M3);"};return t},B.prototype.EMA4=function(){var t={Name:"EMA",Description:"ææ°ç§»å¨å¹³åå¼",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"}],Script:"MA1:EMA(CLOSE,M1);\nMA2:EMA(CLOSE,M2);\nMA3:EMA(CLOSE,M3);\nMA4:EMA(CLOSE,M4);"};return t},B.prototype.EMA5=function(){var t={Name:"EMA",Description:"ææ°ç§»å¨å¹³åå¼",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60},{Name:"M5",Value:0}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"},{Name:"MA5",DynamicName:"MA{M5}"}],Script:"MA1:EMA(CLOSE,M1);\nMA2:EMA(CLOSE,M2);\nMA3:EMA(CLOSE,M3);\nMA4:EMA(CLOSE,M4);\nMA5:EMA(CLOSE,M5);"};return t},B.prototype.EMA6=function(){var t={Name:"EMA",Description:"ææ°ç§»å¨å¹³åå¼",IsMainIndex:!0,StringFormat:2,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20},{Name:"M4",Value:60},{Name:"M5",Value:0},{Name:"M6",Value:0}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"},{Name:"MA3",DynamicName:"MA{M3}"},{Name:"MA4",DynamicName:"MA{M4}"},{Name:"MA5",DynamicName:"MA{M5}"},{Name:"MA6",DynamicName:"MA{M6}"}],Script:"MA1:EMA(CLOSE,M1);\nMA2:EMA(CLOSE,M2);\nMA3:EMA(CLOSE,M3);\nMA4:EMA(CLOSE,M4);\nMA5:EMA(CLOSE,M5);\nMA6:EMA(CLOSE,M6);"};return t},B.prototype.BOLL=function(){var t={Name:"BOLL",Description:"å¸æçº¿",IsMainIndex:!0,Args:[{Name:"M",Value:20}],Script:"BOLL:MA(CLOSE,M);\nUB:BOLL+2*STD(CLOSE,M);\nLB:BOLL-2*STD(CLOSE,M);"};return t},B.prototype.BOLL2=function(){var t={Name:"BOLL2",Description:"å¸æçº¿",IsMainIndex:!1,KLineType:0,Args:[{Name:"M",Value:20}],Script:"BOLL:MA(CLOSE,M);\nUB:BOLL+2*STD(CLOSE,M);\nLB:BOLL-2*STD(CLOSE,M);"};return t},B.prototype.BBI=function(){var t={Name:"BBI",Description:"å¤ç©ºåçº¿",IsMainIndex:!0,Args:[{Name:"M1",Value:3},{Name:"M2",Value:6},{Name:"M3",Value:12},{Name:"M4",Value:24}],Script:"BBI:(MA(CLOSE,M1)+MA(CLOSE,M2)+MA(CLOSE,M3)+MA(CLOSE,M4))/4;"};return t},B.prototype.DKX=function(){var t={Name:"DKX",Description:"å¤ç©ºçº¿",IsMainIndex:!1,Args:[{Name:"M",Value:10}],Script:"MID:=(3*CLOSE+LOW+OPEN+HIGH)/6;\nDKX:(20*MID+19*REF(MID,1)+18*REF(MID,2)+17*REF(MID,3)+\n16*REF(MID,4)+15*REF(MID,5)+14*REF(MID,6)+\n13*REF(MID,7)+12*REF(MID,8)+11*REF(MID,9)+\n10*REF(MID,10)+9*REF(MID,11)+8*REF(MID,12)+\n7*REF(MID,13)+6*REF(MID,14)+5*REF(MID,15)+\n4*REF(MID,16)+3*REF(MID,17)+2*REF(MID,18)+REF(MID,20))/210;\nMADKX:MA(DKX,M);"};return t},B.prototype.MIKE=function(){var t={Name:"MIKE",Description:"éº¦åæ¯æåå",IsMainIndex:!0,Args:[{Name:"N",Value:10}],Script:"HLC:=REF(MA((HIGH+LOW+CLOSE)/3,N),1);\nHV:=EMA(HHV(HIGH,N),3);\nLV:=EMA(LLV(LOW,N),3);\nSTOR:EMA(2*HV-LV,3);\nMIDR:EMA(HLC+HV-LV,3);\nWEKR:EMA(HLC*2-LV,3);\nWEKS:EMA(HLC*2-HV,3);\nMIDS:EMA(HLC-HV+LV,3);\nSTOS:EMA(2*LV-HV,3);"};return t},B.prototype.PBX=function(){var t={Name:"PBX",Description:"çå¸çº¿",IsMainIndex:!0,Args:[{Name:"M1",Value:4},{Name:"M2",Value:6},{Name:"M3",Value:9},{Name:"M4",Value:13},{Name:"M5",Value:18},{Name:"M6",Value:24}],Script:"PBX1:(EMA(CLOSE,M1)+MA(CLOSE,M1*2)+MA(CLOSE,M1*4))/3;\nPBX2:(EMA(CLOSE,M2)+MA(CLOSE,M2*2)+MA(CLOSE,M2*4))/3;\nPBX3:(EMA(CLOSE,M3)+MA(CLOSE,M3*2)+MA(CLOSE,M3*4))/3;\nPBX4:(EMA(CLOSE,M4)+MA(CLOSE,M4*2)+MA(CLOSE,M4*4))/3;\nPBX5:(EMA(CLOSE,M5)+MA(CLOSE,M5*2)+MA(CLOSE,M5*4))/3;\nPBX6:(EMA(CLOSE,M6)+MA(CLOSE,M6*2)+MA(CLOSE,M6*4))/3;"};return t},B.prototype.ENE=function(){var t={Name:"ENE",Description:"è½¨éçº¿",IsMainIndex:!0,Args:[{Name:"N",Value:25},{Name:"M1",Value:6},{Name:"M2",Value:6}],Script:"UPPER:(1+M1/100)*MA(CLOSE,N);\nLOWER:(1-M2/100)*MA(CLOSE,N);\nENE:(UPPER+LOWER)/2;"};return t},B.prototype.MACD=function(){var t={Name:"MACD",Description:"å¹³æ»å¼åå¹³å",IsMainIndex:!1,Args:[{Name:"SHORT",Value:12},{Name:"LONG",Value:26},{Name:"MID",Value:9}],Script:"DIF:EMA(CLOSE,SHORT)-EMA(CLOSE,LONG);\nDEA:EMA(DIF,MID);\nMACD:(DIF-DEA)*2,COLORSTICK;"};return t},B.prototype.MACD2=function(){var t={Name:"MACD",Description:"å¹³æ»å¼åå¹³å",IsMainIndex:!1,Args:[{Name:"SHORT",Value:12},{Name:"LONG",Value:26},{Name:"MID",Value:9}],Script:"DIF2:=EMA(CLOSE,SHORT)-EMA(CLOSE,LONG);\nDEA2:=EMA(DIF2,MID);\nMACD:(DIF2-DEA2)*2,COLORSTICK,LINETHICK50;\nDIF:DIF2;\nDEA:DEA2;"};return t},B.prototype.KDJ=function(){var t={Name:"KDJ",Description:"éæºææ ",IsMainIndex:!1,Args:[{Name:"N",Value:9},{Name:"M1",Value:3},{Name:"M2",Value:3}],Script:"RSV:=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100;\nK:SMA(RSV,M1,1);\nD:SMA(K,M2,1);\nJ:3*K-2*D;"};return t},B.prototype.VOL=function(){var t={Name:"VOL",Description:"æäº¤é",IsMainIndex:!1,FloatPrecision:0,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10}],OutName:[{Name:"MA1",DynamicName:"MA{M1}"},{Name:"MA2",DynamicName:"MA{M2}"}],Script:"VOL:VOL,VOLSTICK;\nMA1:MA(VOL,M1);\nMA2:MA(VOL,M2);"};return t},B.prototype.VOL_TDX=function(){var t={Name:"VOL-TDX",Description:"æäº¤é(èæ)",IsMainIndex:!1,FloatPrecision:0,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10}],Script:"TOTAL:=IF(PERIOD=1,5,IF(PERIOD=2,15,IF(PERIOD=3,30,IF(PERIOD=4,60,IF(PERIOD=5,TOTALFZNUM,1)))));\nMTIME:=MOD(FROMOPEN,TOTAL);\nCTIME:=IF(MTIME<0.5,TOTAL,MTIME);\nVVOL:IF((CURRBARSCOUNT=1 AND DYNAINFO(8)>1),VOL*(TOTAL+3)/(CTIME+3),DRAWNULL),NODRAW;\nSTICKLINE((CURRBARSCOUNT=1 AND DYNAINFO(8)>1),VVOL,0,-1,-1),COLORYELLOW;\nVOLUME:VOL,VOLSTICK;\nMAVOL1:MA(VOLUME,M1);\nMAVOL2:MA(VOLUME,M2);"};return t},B.prototype.RSI=function(){var t={Name:"RSI",Description:"ç¸å¯¹å¼ºå¼±ææ ",IsMainIndex:!1,Args:[{Name:"N1",Value:6},{Name:"N2",Value:12},{Name:"N3",Value:24}],Script:"LC:=REF(CLOSE,1);\nRSI1:SMA(MAX(CLOSE-LC,0),N1,1)/SMA(ABS(CLOSE-LC),N1,1)*100;\nRSI2:SMA(MAX(CLOSE-LC,0),N2,1)/SMA(ABS(CLOSE-LC),N2,1)*100;\nRSI3:SMA(MAX(CLOSE-LC,0),N3,1)/SMA(ABS(CLOSE-LC),N3,1)*100;"};return t},B.prototype.BRAR=function(){var t={Name:"BRAR",Description:"æç»ªææ ",IsMainIndex:!1,Args:[{Name:"N",Value:26}],Script:"BR:SUM(MAX(0,HIGH-REF(CLOSE,1)),N)/SUM(MAX(0,REF(CLOSE,1)-LOW),N)*100;\nAR:SUM(HIGH-OPEN,N)/SUM(OPEN-LOW,N)*100;"};return t},B.prototype.WR=function(){var t={Name:"WR",Description:"å¨å»ææ ",IsMainIndex:!1,Args:[{Name:"N",Value:10},{Name:"N1",Value:6}],Script:"WR1:100*(HHV(HIGH,N)-CLOSE)/(HHV(HIGH,N)-LLV(LOW,N));\nWR2:100*(HHV(HIGH,N1)-CLOSE)/(HHV(HIGH,N1)-LLV(LOW,N1));"};return t},B.prototype.BIAS=function(){var t={Name:"BIAS",Description:"ä¹ç¦»ç",IsMainIndex:!1,Args:[{Name:"N1",Value:6},{Name:"N2",Value:12},{Name:"N3",Value:24}],Script:"BIAS1 :(CLOSE-MA(CLOSE,N1))/MA(CLOSE,N1)*100;\nBIAS2 :(CLOSE-MA(CLOSE,N2))/MA(CLOSE,N2)*100;\nBIAS3 :(CLOSE-MA(CLOSE,N3))/MA(CLOSE,N3)*100;"};return t},B.prototype.OBV=function(){var t={Name:"OBV",Description:"ç´¯ç§¯è½éçº¿",IsMainIndex:!1,Args:[{Name:"M",Value:30}],Script:"VA:=IF(CLOSE>REF(CLOSE,1),VOL,-VOL);\nOBV:SUM(IF(CLOSE==REF(CLOSE,1),0,VA),0);\nMAOBV:MA(OBV,M);"};return t},B.prototype.DMI=function(){var t={Name:"DMI",Description:"è¶åææ ",IsMainIndex:!1,Args:[{Name:"N",Value:14},{Name:"MM",Value:6}],Script:"MTR:=EXPMEMA(MAX(MAX(HIGH-LOW,ABS(HIGH-REF(CLOSE,1))),ABS(REF(CLOSE,1)-LOW)),N);\nHD :=HIGH-REF(HIGH,1);\nLD :=REF(LOW,1)-LOW;\nDMP:=EXPMEMA(IF(HD>0&&HD>LD,HD,0),N);\nDMM:=EXPMEMA(IF(LD>0&&LD>HD,LD,0),N);\nPDI: DMP*100/MTR;\nMDI: DMM*100/MTR;\nADX: EXPMEMA(ABS(MDI-PDI)/(MDI+PDI)*100,MM);\nADXR:EXPMEMA(ADX,MM);"};return t},B.prototype.CR=function(){var t={Name:"CR",Description:"å¸¦ç¶è½éçº¿",IsMainIndex:!1,Args:[{Name:"N",Value:26},{Name:"M1",Value:10},{Name:"M2",Value:20},{Name:"M3",Value:40},{Name:"M4",Value:62}],Script:"MID:=REF(HIGH+LOW,1)/2;\nCR:SUM(MAX(0,HIGH-MID),N)/SUM(MAX(0,MID-LOW),N)*100;\nMA1:REF(MA(CR,M1),M1/2.5+1);\nMA2:REF(MA(CR,M2),M2/2.5+1);\nMA3:REF(MA(CR,M3),M3/2.5+1);\nMA4:REF(MA(CR,M4),M4/2.5+1);"};return t},B.prototype.PSY=function(){var t={Name:"PSY",Description:"å¿ççº¿",IsMainIndex:!1,Args:[{Name:"N",Value:12},{Name:"M",Value:6}],Script:"PSY:COUNT(CLOSE>REF(CLOSE,1),N)/N*100;\rPSYMA:MA(PSY,M);"};return t},B.prototype.CCI=function(){var t={Name:"CCI",Description:"ååè·¯å¾ææ ",IsMainIndex:!1,Args:[{Name:"N",Value:14}],Script:"TYP:=(HIGH+LOW+CLOSE)/3;\nCCI:(TYP-MA(TYP,N))/(0.015*AVEDEV(TYP,N));"};return t},B.prototype.DMA=function(){var t={Name:"DMA",Description:"å¹³åå·®",IsMainIndex:!1,Args:[{Name:"N1",Value:10},{Name:"N2",Value:50},{Name:"M",Value:10}],Script:"DIF:MA(CLOSE,N1)-MA(CLOSE,N2);\nDIFMA:MA(DIF,M);"};return t},B.prototype.TRIX=function(){var t={Name:"TRIX",Description:"ä¸éææ°å¹³åçº¿",IsMainIndex:!1,Args:[{Name:"N",Value:12},{Name:"M",Value:9}],Script:"MTR:=EMA(EMA(EMA(CLOSE,N),N),N);\nTRIX:(MTR-REF(MTR,1))/REF(MTR,1)*100;\nMATRIX:MA(TRIX,M) ;"};return t},B.prototype.VR=function(){var t={Name:"VR",Description:"æäº¤éåå¼ç",IsMainIndex:!1,Args:[{Name:"N",Value:26},{Name:"M",Value:6}],Script:"TH:=SUM(IF(CLOSE>REF(CLOSE,1),VOL,0),N);\nTL:=SUM(IF(CLOSE<REF(CLOSE,1),VOL,0),N);\nTQ:=SUM(IF(CLOSE==REF(CLOSE,1),VOL,0),N);\nVR:100*(TH*2+TQ)/(TL*2+TQ);\nMAVR:MA(VR,M);"};return t},B.prototype.EMV=function(){var t={Name:"EMV",Description:"ç®ææ³¢å¨ææ ",IsMainIndex:!1,Args:[{Name:"N",Value:14},{Name:"M",Value:9}],Script:"VOLUME:=MA(VOL,N)/VOL;\nMID:=100*(HIGH+LOW-REF(HIGH+LOW,1))/(HIGH+LOW);\nEMV:MA(MID*VOLUME*(HIGH-LOW)/MA(HIGH-LOW,N),N);\nMAEMV:MA(EMV,M);"};return t},B.prototype.ROC=function(){var t={Name:"ROC",Description:"åå¨çææ ",IsMainIndex:!1,Args:[{Name:"N",Value:12},{Name:"M",Value:6}],Script:"ROC:100*(CLOSE-REF(CLOSE,N))/REF(CLOSE,N);\nMAROC:MA(ROC,M);"};return t},B.prototype.MTM=function(){var t={Name:"MTM",Description:"å¨éçº¿",IsMainIndex:!1,Args:[{Name:"N",Value:12},{Name:"M",Value:6}],Script:"MTM:CLOSE-REF(CLOSE,N);\nMAMTM:MA(MTM,M);"};return t},B.prototype.FSL=function(){var t={Name:"FSL",Description:"åæ°´å²­",IsMainIndex:!1,Args:[],Script:"SWL:(EMA(CLOSE,5)*7+EMA(CLOSE,10)*3)/10;\nSWS:DMA(EMA(CLOSE,12),MAX(1,100*(SUM(VOL,5)/(3*CAPITAL))));"};return t},B.prototype.CYR=function(){var t={Name:"CYR",Description:"å¸åºå¼ºå¼±",IsMainIndex:!1,Args:[{Name:"N",Value:13},{Name:"M",Value:5}],Script:"DIVE:=0.01*EMA(AMOUNT,N)/EMA(VOL,N);\nCYR:(DIVE/REF(DIVE,1)-1)*100;\nMACYR:MA(CYR,M);"};return t},B.prototype.MASS=function(){var t={Name:"MASS",Description:"å¸åºå¼ºå¼±",IsMainIndex:!1,Args:[{Name:"N1",Value:9},{Name:"N2",Value:25},{Name:"M",Value:6}],Script:"MASS:SUM(MA(HIGH-LOW,N1)/MA(MA(HIGH-LOW,N1),N1),N2);\nMAMASS:MA(MASS,M);"};return t},B.prototype.WAD=function(){var t={Name:"WAD",Description:"å¨å»å¤ç©ºååº¦çº¿",IsMainIndex:!1,Args:[{Name:"M",Value:30}],Script:"MIDA:=CLOSE-MIN(REF(CLOSE,1),LOW);\nMIDB:=IF(CLOSE<REF(CLOSE,1),CLOSE-MAX(REF(CLOSE,1),HIGH),0);\nWAD:SUM(IF(CLOSE>REF(CLOSE,1),MIDA,MIDB),0);\nMAWAD:MA(WAD,M);"};return t},B.prototype.CHO=function(){var t={Name:"CHO",Description:"ä½³åºææ ",IsMainIndex:!1,Args:[{Name:"N1",Value:10},{Name:"N2",Value:20},{Name:"M",Value:6}],Script:"MID:=SUM(VOL*(2*CLOSE-HIGH-LOW)/(HIGH+LOW),0);\nCHO:MA(MID,N1)-MA(MID,N2);\nMACHO:MA(CHO,M);"};return t},B.prototype.ADTM=function(){var t={Name:"ADTM",Description:"å¨æä¹°åæ°ææ ",IsMainIndex:!1,Args:[{Name:"N",Value:23},{Name:"M",Value:8}],Script:"DTM:=IF(OPEN<=REF(OPEN,1),0,MAX((HIGH-OPEN),(OPEN-REF(OPEN,1))));\nDBM:=IF(OPEN>=REF(OPEN,1),0,MAX((OPEN-LOW),(OPEN-REF(OPEN,1))));\nSTM:=SUM(DTM,N);\nSBM:=SUM(DBM,N);\nADTM:IF(STM>SBM,(STM-SBM)/STM,IF(STM==SBM,0,(STM-SBM)/SBM));\nMAADTM:MA(ADTM,M);"};return t},B.prototype.HSL=function(){var t={Name:"HSL",Description:"æ¢æçº¿",IsMainIndex:!1,Args:[{Name:"N",Value:5}],Script:"HSL:IF((SETCODE==0||SETCODE==1),100*VOL,VOL)/(FINANCE(7)/100);\nMAHSL:MA(HSL,N);"};return t},B.prototype.BIAS36=function(){var t={Name:"BIAS36",Description:"ä¸å­ä¹ç¦»",IsMainIndex:!1,Args:[{Name:"M",Value:6}],Script:"BIAS36:MA(CLOSE,3)-MA(CLOSE,6);\nBIAS612:MA(CLOSE,6)-MA(CLOSE,12);\nMABIAS:MA(BIAS36,M);"};return t},B.prototype.BIAS_QL=function(){var t={Name:"BIAS_QL",Description:"ä¹ç¦»ç-ä¼ ç»ç",IsMainIndex:!1,Args:[{Name:"N",Value:6},{Name:"M",Value:6}],Script:"BIAS :(CLOSE-MA(CLOSE,N))/MA(CLOSE,N)*100;\nBIASMA :MA(BIAS,M);"};return t},B.prototype.DPO=function(){var t={Name:"DPO",Description:"åºé´éè¡çº¿",IsMainIndex:!1,Args:[{Name:"N",Value:20},{Name:"M",Value:6}],Script:"DPO:CLOSE-REF(MA(CLOSE,N),N/2+1);\nMADPO:MA(DPO,M);"};return t},B.prototype.OSC=function(){var t={Name:"OSC",Description:"åå¨éççº¿",IsMainIndex:!1,Args:[{Name:"N",Value:20},{Name:"M",Value:6}],Script:"OSC:100*(CLOSE-MA(CLOSE,N));\nMAOSC:EXPMEMA(OSC,M);"};return t},B.prototype.ATR=function(){var t={Name:"ATR",Description:"çå®æ³¢å¹",IsMainIndex:!1,Args:[{Name:"N",Value:14}],Script:"MTR:MAX(MAX((HIGH-LOW),ABS(REF(CLOSE,1)-HIGH)),ABS(REF(CLOSE,1)-LOW));\nATR:MA(MTR,N);"};return t},B.prototype.NVI=function(){var t={Name:"ATR",Description:"è´æäº¤é",IsMainIndex:!1,Args:[{Name:"N",Value:72}],Script:"NVI:100*MULAR(IF(V<REF(V,1),C/REF(C,1),1),0);\nMANVI:MA(NVI,N);"};return t},B.prototype.PVI=function(){var t={Name:"PVI",Description:"æ­£æäº¤é",IsMainIndex:!1,Args:[{Name:"N",Value:72}],Script:"NVI:100*MULAR(IF(V>REF(V,1),C/REF(C,1),1),0);\nMANVI:MA(NVI,N);"};return t},B.prototype.UOS=function(){var t={Name:"UOS",Description:"ç»æææ ",IsMainIndex:!1,Args:[{Name:"N1",Value:7},{Name:"N2",Value:14},{Name:"N3",Value:28},{Name:"M",Value:6}],Script:"TH:=MAX(HIGH,REF(CLOSE,1));\nTL:=MIN(LOW,REF(CLOSE,1));\nACC1:=SUM(CLOSE-TL,N1)/SUM(TH-TL,N1);\nACC2:=SUM(CLOSE-TL,N2)/SUM(TH-TL,N2);\nACC3:=SUM(CLOSE-TL,N3)/SUM(TH-TL,N3);\nUOS:(ACC1*N2*N3+ACC2*N1*N3+ACC3*N1*N2)*100/(N1*N2+N1*N3+N2*N3);\nMAUOS:EXPMEMA(UOS,M);"};return t},B.prototype.CYW=function(){var t={Name:"CYW",Description:"ä¸»åæ§ç",IsMainIndex:!1,Args:[],Script:"VAR1:=CLOSE-LOW;\nVAR2:=HIGH-LOW;\nVAR3:=CLOSE-HIGH;\nVAR4:=IF(HIGH>LOW,(VAR1/VAR2+VAR3/VAR2)*VOL,0);\nCYW: SUM(VAR4,10)/10000, COLORSTICK;"};return t},B.prototype.LON=function(){var t={Name:"LON",Description:"é¾ç³»é¿çº¿",IsMainIndex:!1,Args:[{Name:"N",Value:10}],Script:"LC := REF(CLOSE,1);\nVID := SUM(VOL,2)/(((HHV(HIGH,2)-LLV(LOW,2)))*100);\nRC := (CLOSE-LC)*VID;\nLONG := SUM(RC,0);\nDIFF := SMA(LONG,10,1);\nDEA := SMA(LONG,20,1);\nLON : DIFF-DEA;\nLONMA : MA(LON,10);\nLONT : LON, COLORSTICK;"};return t},B.prototype.NDB=function(){var t={Name:"NDB",Description:"èçµæ³¢",IsMainIndex:!1,Args:[{Name:"P1",Value:5},{Name:"P2",Value:10}],Script:"HH:=IF(C/REF(C,1)>1.098 AND L>REF(H,1),2*C-REF(C,1)-H,2*C-H-L);\nV1:= BARSCOUNT(C) - 1;\nV2:= 2 * REF(C, V1) - REF(H, V1) - REF(L, V1);\nDK: SUM(HH, 0) + V2;\nMDK5: MA(DK, P1);\nMDK10: MA(DK, P2);"};return t},B.prototype.SKDJ=function(){var t={Name:"SKDJ",Description:"æ¢ééæºææ ",IsMainIndex:!1,Args:[{Name:"N",Value:9},{Name:"M",Value:3}],Script:"LOWV:=LLV(LOW,N);\nHIGHV:=HHV(HIGH,N);\nRSV:=EMA((CLOSE-LOWV)/(HIGHV-LOWV)*100,M);\nK:EMA(RSV,M);\nD:MA(K,M);"};return t},B.prototype.KD=function(){var t={Name:"KD",Description:"éæºææ KD",IsMainIndex:!1,Args:[{Name:"N",Value:9},{Name:"M1",Value:3},{Name:"M2",Value:3}],Script:"RSV:=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100;\nK:SMA(RSV,M1,1);\nD:SMA(K,M2,1);"};return t},B.prototype.FKX=function(){var t={Name:"FKX",Description:"åKçº¿",IsMainIndex:!0,Args:[],Script:"DRAWKLINE(-LOW, -OPEN, -HIGH, -CLOSE);"};return t},B.prototype.DKCOL=function(){var t={Name:"DKCOL",Description:"å¤ç©ºè½éæ±(éç¨äºåæ¶ä¸»å¾)",IsMainIndex:!0,Args:[{Name:"N",Value:5}],Script:"FF:=(C-REF(C,N))/REF(C,N);\nSTICKLINE(FF>0,DYNAINFO(3),DYNAINFO(3)*(1+FF),0.5,0),COLORRED;\nSTICKLINE(FF<0,DYNAINFO(3),DYNAINFO(3)*(1+FF),0.5,0),COLORGREEN;"};return t},B.prototype.UDL=function(){var t={Name:"UDL",Description:"å¼åçº¿",IsMainIndex:!1,Args:[{Name:"N1",Value:3},{Name:"N2",Value:5},{Name:"N3",Value:10},{Name:"N4",Value:20},{Name:"M",Value:6}],Script:"UDL:(MA(CLOSE,N1)+MA(CLOSE,N2)+MA(CLOSE,N3)+MA(CLOSE,N4))/4;\nMAUDL:MA(UDL,M);"};return t},B.prototype.MFI=function(){var t={Name:"MFI",Description:"èµéæµéææ ",IsMainIndex:!1,Args:[{Name:"N",Value:14},{Name:"N2",Value:6}],Script:"TYP := (HIGH + LOW + CLOSE)/3;\nV1:=SUM(IF(TYP>REF(TYP,1),TYP*VOL,0),N)/SUM(IF(TYP<REF(TYP,1),TYP*VOL,0),N);\nMFI:100-(100/(1+V1));"};return t},B.prototype.LWR=function(){var t={Name:"LWR",Description:"LWRå¨å»ææ ",IsMainIndex:!1,Args:[{Name:"N",Value:9},{Name:"M1",Value:3},{Name:"M2",Value:3}],Script:"RSV:= (HHV(HIGH,N)-CLOSE)/(HHV(HIGH,N)-LLV(LOW,N))*100;\nLWR1:SMA(RSV,M1,1);\nLWR2:SMA(LWR1,M2,1);"};return t},B.prototype.MARSI=function(){var t={Name:"MARSI",Description:"ç¸å¯¹å¼ºå¼±å¹³åçº¿",IsMainIndex:!1,Args:[{Name:"M1",Value:10},{Name:"M2",Value:6}],Script:"DIF:=CLOSE-REF(CLOSE,1);\nVU:=IF(DIF>=0,DIF,0);\nVD:=IF(DIF<0,-DIF,0);\nMAU1:=MEMA(VU,M1);\nMAD1:=MEMA(VD,M1);\nMAU2:=MEMA(VU,M2);\nMAD2:=MEMA(VD,M2);\nRSI10:MA(100*MAU1/(MAU1+MAD1),M1);\nRSI6:MA(100*MAU2/(MAU2+MAD2),M2);"};return t},B.prototype.CYD=function(){var t={Name:"CYD",Description:"æ¿æ¥å å­",IsMainIndex:!1,Args:[{Name:"N",Value:21}],Script:"CYDS:WINNER(CLOSE)/(VOL/CAPITAL);\nCYDN:WINNER(CLOSE)/MA(VOL/CAPITAL,N);"};return t},B.prototype.CYF=function(){var t={Name:"CYF",Description:"å¸åºè½é",IsMainIndex:!1,Args:[{Name:"N",Value:21}],Script:"CYF:100-100/(1+EMA(HSL,N));"};return t},B.prototype.TAPI=function(){var t={Name:"TAPI",Description:"å æææ°æäº¤å¼",IsMainIndex:!1,Args:[{Name:"M",Value:6}],Script:"TAPI:AMOUNT/INDEXC;\nMATAIP:MA(TAPI,M);"};return t},B.prototype.VMACD=function(){var t={Name:"VMACD",Description:"éå¹³æ»å¼åå¹³å",IsMainIndex:!1,Args:[{Name:"SHORT",Value:12},{Name:"LONG",Value:26},{Name:"MID",Value:9}],Script:"DIF:EMA(VOL,SHORT)-EMA(VOL,LONG);\nDEA:EMA(DIF,MID);\nMACD:DIF-DEA,COLORSTICK;"};return t},B.prototype.QACD=function(){var t={Name:"QACD",Description:"å¿«éå¼åå¹³å",IsMainIndex:!1,Args:[{Name:"N1",Value:12},{Name:"N2",Value:26},{Name:"M",Value:9}],Script:"DIF:EMA(CLOSE,N1)-EMA(CLOSE,N2);\nMACD:EMA(DIF,M);\nDDIF:DIF-MACD;"};return t},B.prototype.VPT=function(){var t={Name:"VPT",Description:"éä»·æ²çº¿",IsMainIndex:!1,Args:[{Name:"N",Value:51},{Name:"M",Value:6}],Script:"VPT:SUM(VOL*(CLOSE-REF(CLOSE,1))/REF(CLOSE,1),N);\nMAVPT:MA(VPT,M);"};return t},B.prototype.WVAD=function(){var t={Name:"WVAD",Description:"å¨å»åå¼ç¦»æ£é",IsMainIndex:!1,Args:[{Name:"N",Value:24},{Name:"M",Value:6}],Script:"WVAD:SUM((CLOSE-OPEN)/(HIGH-LOW)*VOL,N)/10000;\nMAWVAD:MA(WVAD,M);"};return t},B.prototype.DBQR=function(){var t={Name:"WVAD",Description:"å¯¹æ¯å¼ºå¼±",IsMainIndex:!1,Args:[{Name:"N",Value:5},{Name:"M1",Value:10},{Name:"M2",Value:20},{Name:"M3",Value:60}],Script:"ZS:(INDEXC-REF(INDEXC,N))/REF(INDEXC,N);\nGG:(CLOSE-REF(CLOSE,N))/REF(CLOSE,N);\nMADBQR1:MA(GG,M1);\nMADBQR2:MA(GG,M2);\nMADBQR3:MA(GG,M3);"};return t},B.prototype.JS=function(){var t={Name:"JS",Description:"å éçº¿",IsMainIndex:!1,Args:[{Name:"N",Value:5},{Name:"M1",Value:5},{Name:"M2",Value:10},{Name:"M3",Value:20}],Script:"JS:100*(CLOSE-REF(CLOSE,N))/(N*REF(CLOSE,N));\nMAJS1:MA(JS,M1);\nMAJS2:MA(JS,M2);\nMAJS3:MA(JS,M3);"};return t},B.prototype.CYE=function(){var t={Name:"CYE",Description:"å¸åºè¶å¿",IsMainIndex:!1,Args:[],Script:"MAL:=MA(CLOSE,5);\nMAS:=MA(MA(CLOSE,20),5);\nCYEL:(MAL-REF(MAL,1))/REF(MAL,1)*100;\nCYES:(MAS-REF(MAS,1))/REF(MAS,1)*100;"};return t},B.prototype.QR=function(){var t={Name:"QR",Description:"å¼ºå¼±ææ ",IsMainIndex:!1,Args:[{Name:"N",Value:21}],Script:"ä¸ªè¡: (CLOSE-REF(CLOSE,N))/REF(CLOSE,N)*100; \nå¤§ç: (INDEXC-REF(INDEXC,N))/REF(INDEXC,N)*100; \nå¼ºå¼±å¼:EMA(ä¸ªè¡-å¤§ç,2),COLORSTICK;"};return t},B.prototype.GDX=function(){var t={Name:"GDX",Description:"è½¨éçº¿",IsMainIndex:!1,Args:[{Name:"N",Value:30},{Name:"M",Value:9}],Script:"AA:=ABS((2*CLOSE+HIGH+LOW)/4-MA(CLOSE,N))/MA(CLOSE,N); \nè½¨é:DMA(CLOSE,AA);\nååçº¿:(1+M/100)*è½¨é; \næ¯æçº¿:(1-M/100)*è½¨é;"};return t},B.prototype.JLHB=function(){var t={Name:"JLHB",Description:"ç»è·¯èªæ ",IsMainIndex:!1,Args:[{Name:"N",Value:7},{Name:"M",Value:5}],Script:"VAR1:=(CLOSE-LLV(LOW,60))/(HHV(HIGH,60)-LLV(LOW,60))*80; \nB:SMA(VAR1,N,1); \nVAR2:SMA(B,M,1); \nç»è·¯èªæ :IF(CROSS(B,VAR2) AND B<40,50,0);"};return t},B.prototype.PCNT=function(){var t={Name:"PCNT",Description:"å¹åº¦æ¯",IsMainIndex:!1,Args:[{Name:"M",Value:5}],Script:"PCNT:(CLOSE-REF(CLOSE,1))/CLOSE*100;\nMAPCNT:EXPMEMA(PCNT,M);"};return t},B.prototype.BTX=function(){var t={Name:"BTX",Description:"å®å¡çº¿",IsMainIndex:!1,Args:[],Script:"B1:=REF(C,1);\nB2:= REF(C, 2);\nSS:= IF(C > REF(C, 1) AND REF(C, 1) >= REF(C, 2), 1, IF(C < REF(C, 1) AND REF(C, 1) <= REF(C, 2), -1, IF(C > REF(C, 2) AND REF(C, 2) > REF(C, 1), 2, IF(C < REF(C, 2) AND REF(C, 2) < REF(C, 1), -2, 0))));\nSM:= IF(REF(SS, 1) <> 0, REF(SS, 1), IF(REF(SS, 2) <> 0, REF(SS, 2), IF(REF(SS, 3) <> 0, REF(SS, 3), IF(REF(SS, 5) <> 0, REF(SS, 5), IF(REF(SS, 6) <> 0, REF(SS, 6), IF(REF(SS, 7) <> 0, REF(SS, 7), 0))))));\nMC:= IF(REF(SS, 1) <> 0, B2, IF(SM > 0, MIN(B1, B2), MAX(B1, B2)));\nTOW1:= IF(C > REF(C, 1), C, REF(C, 1));\nTOW2:= IF((SS == -1 OR SS == -2) AND SM > 0, B2, TOW1);\nTOWER:= IF(TOW1 > TOW2, TOW1, TOW2);\nSTICKLINE(SS == 1 OR SM >= 1 AND SS == 0, B1, C, 10, 1), COLORRED;\nSTICKLINE(SS == -1 OR SM <= -1 AND SS == 0, B1, C, 10, 0), COLORCYAN;\nSTICKLINE(SS == 2, B2, C, 10, 1), COLORRED;\nSTICKLINE(SS == -2, B2, C, 10, 0), COLORCYAN;\nSTICKLINE((SS == -1 OR SS == -2) AND SM > 0, B2, B1, 10, 1), COLORRED;\nSTICKLINE((SS == 1 OR SS == 2) AND SM < 0, B2, B1, 10, 0), COLORCYAN;"};return t},B.prototype.AMO=function(){var t={Name:"AMO",Description:"æäº¤éé¢",IsMainIndex:!1,Args:[{Name:"M1",Value:5},{Name:"M2",Value:10}],Script:"AMOW:AMOUNT/10000.0,VOLSTICK;\nAMO1:MA(AMOW,M1);\nAMO2:MA(AMOW,M2);"};return t},B.prototype.VRSI=function(){var t={Name:"VRSI",Description:"ç¸å¯¹å¼ºå¼±é",IsMainIndex:!1,Args:[{Name:"N1",Value:6},{Name:"N2",Value:12},{Name:"N3",Value:24}],Script:"LC:=REF(VOL,1);\nRSI1:SMA(MAX(VOL-LC,0),N1,1)/SMA(ABS(VOL-LC),N1,1)*100;\nRSI2:SMA(MAX(VOL-LC,0),N2,1)/SMA(ABS(VOL-LC),N2,1)*100;\nRSI3:SMA(MAX(VOL-LC,0),N3,1)/SMA(ABS(VOL-LC),N3,1)*100;"};return t},B.prototype.HSCOL=function(){var t={Name:"HSCOL",Description:"æ¢ææ±",IsMainIndex:!1,Args:[{Name:"N",Value:5}],Script:"HSCOL:IF((SETCODE==0||SETCODE==1),100*VOL,VOL)/(FINANCE(7)/100),VOLSTICK;\nMAHSL:MA(HSCOL,N);"};return t},B.prototype.DBQRV=function(){var t={Name:"DBQRV",Description:"å¯¹æ¯å¼ºå¼±é(éä¸è½½æ¥çº¿)",IsMainIndex:!1,Args:[{Name:"N",Value:5}],Script:"ZS:(INDEXV-REF(INDEXV,N))/REF(INDEXV,N);\nGG:(VOL-REF(VOL,N))/REF(VOL,N);"};return t},B.prototype.DBLB=function(){var t={Name:"DBLB",Description:"å¯¹æ¯éæ¯(éä¸è½½æ¥çº¿)",IsMainIndex:!1,Args:[{Name:"N",Value:5},{Name:"M",Value:5}],Script:"GG:=VOL/SUM(REF(VOL,1),N);\nZS:=INDEXV/SUM(REF(INDEXV,1),N);\nDBLB:GG/ZS;\nMADBLB:MA(DBLB,M);"};return t},B.prototype.ACD=function(){var t={Name:"ACD",Description:"åéçº¿",IsMainIndex:!1,Args:[{Name:"M",Value:20}],Script:"LC:=REF(CLOSE,1);\nDIF:=CLOSE-IF(CLOSE>LC,MIN(LOW,LC),MAX(HIGH,LC));\nACD:SUM(IF(CLOSE==LC,0,DIF),0);\nMAACD:EXPMEMA(ACD,M);"};return t},B.prototype.EXPMA=function(){var t={Name:"EXPMA",Description:"ææ°å¹³åçº¿",IsMainIndex:!0,Args:[{Name:"M1",Value:12},{Name:"M2",Value:50}],Script:"EXP1:EMA(CLOSE,M1);\nEXP2:EMA(CLOSE,M2);"};return t},B.prototype.EXPMA_S=function(){var t={Name:"EXPMA_S",Description:"ææ°å¹³åçº¿-å¯å¾",IsMainIndex:!1,Args:[{Name:"M1",Value:12},{Name:"M2",Value:50}],Script:"EXP1:EMA(CLOSE,M1);\nEXP2:EMA(CLOSE,M2);"};return t},B.prototype.HMA=function(){var t={Name:"HMA",Description:"é«ä»·å¹³åçº¿",IsMainIndex:!0,Args:[{Name:"M1",Value:6},{Name:"M2",Value:12},{Name:"M3",Value:30},{Name:"M4",Value:72},{Name:"M5",Value:144}],Script:"HMA1:MA(HIGH,M1);\nHMA2:MA(HIGH,M2);\nHMA3:MA(HIGH,M3);\nHMA4:MA(HIGH,M4);\nHMA5:MA(HIGH,M5);"};return t},B.prototype.LMA=function(){var t={Name:"LMA",Description:"ä½ä»·å¹³åçº¿",IsMainIndex:!0,Args:[{Name:"M1",Value:6},{Name:"M2",Value:12},{Name:"M3",Value:30},{Name:"M4",Value:72},{Name:"M5",Value:144}],Script:"LMA1:MA(LOW,M1);\nLMA2:MA(LOW,M2);\nLMA3:MA(LOW,M3);\nLMA4:MA(LOW,M4);\nLMA5:MA(LOW,M5);"};return t},B.prototype.VMA=function(){var t={Name:"VMA",Description:"åå¼å¹³åçº¿",IsMainIndex:!0,Args:[{Name:"M1",Value:6},{Name:"M2",Value:12},{Name:"M3",Value:30},{Name:"M4",Value:72},{Name:"M5",Value:144}],Script:"VV:=(HIGH+OPEN+LOW+CLOSE)/4;\nVMA1:MA(VV,M1);\nVMA2:MA(VV,M2);\nVMA3:MA(VV,M3);\nVMA4:MA(VV,M4);\nVMA5:MA(VV,M5);"};return t},B.prototype.AMV=function(){var t={Name:"AMV",Description:"ææ¬ä»·åçº¿",IsMainIndex:!1,Args:[{Name:"M1",Value:6},{Name:"M2",Value:12},{Name:"M3",Value:30},{Name:"M4",Value:72},{Name:"M5",Value:144}],Script:"AMOV:=VOL*(OPEN+CLOSE)/2;\nAMV1:SUM(AMOV,M1)/SUM(VOL,M1);\nAMV2:SUM(AMOV,M2)/SUM(VOL,M2);\nAMV3:SUM(AMOV,M3)/SUM(VOL,M3);\nAMV4:SUM(AMOV,M4)/SUM(VOL,M4);"};return t},B.prototype.BBIBOLL=function(){var t={Name:"BBIBOLL",Description:"å¤ç©ºå¸æçº¿",IsMainIndex:!0,Args:[{Name:"N",Value:11},{Name:"M",Value:6}],Script:"CV:=CLOSE;\nBBIBOLL:(MA(CV,3)+MA(CV,6)+MA(CV,12)+MA(CV,24))/4;\nUPR:BBIBOLL+M*STD(BBIBOLL,N);\nDWN:BBIBOLL-M*STD(BBIBOLL,N);"};return t},B.prototype.ALLIGAT=function(){var t={Name:"ALLIGAT",Description:"é³é±¼çº¿",IsMainIndex:!0,Args:[],Script:"NN:=(H+L)/2;\nä¸å:REF(MA(NN,5),3),COLOR40FF40;\nçé½¿:REF(MA(NN,8),5),COLOR0000C0;\nä¸é¢:REF(MA(NN,13),8),COLORFF4040;"};return t},B.prototype.ZX=function(){var t={Name:"ZX",Description:"éå¿çº¿",IsMainIndex:!1,Args:[],Script:"AV:0.01*AMOUNT/VOL;"};return t},B.prototype.XS=function(){var t={Name:"XS",Description:"èæ¯éé",IsMainIndex:!0,Args:[{Name:"N",Value:13}],Script:"VAR2:=CLOSE*VOL;\nVAR3:=EMA((EMA(VAR2,3)/EMA(VOL,3)+EMA(VAR2,6)/EMA(VOL,6)+EMA(VAR2,12)/EMA(VOL,12)+EMA(VAR2,24)/EMA(VOL,24))/4,N);\nSUP:1.06*VAR3;\nSDN:VAR3*0.94;\nVAR4:=EMA(CLOSE,9);\nLUP:EMA(VAR4*1.14,5);\nLDN:EMA(VAR4*0.86,5);"};return t},B.prototype.XS2=function(){var t={Name:"XS2",Description:"èæ¯ééII",IsMainIndex:!0,Args:[{Name:"N",Value:102},{Name:"M",Value:7}],Script:"AA:=MA((2*CLOSE+HIGH+LOW)/4,5); \néé1:AA*N/100; \néé2:AA*(200-N)/100; \nCC:=ABS((2*CLOSE+HIGH+LOW)/4-MA(CLOSE,20))/MA(CLOSE,20); \nDD:=DMA(CLOSE,CC); \néé3:(1+M/100)*DD; \néé4:(1-M/100)*DD;"};return t},B.prototype.SG_XDT=function(){var t={Name:"SG-XDT",Description:"å¿çµå¾(éä¸è½½æ¥çº¿)",IsMainIndex:!1,Args:[{Name:"P1",Value:5},{Name:"P2",Value:10}],Script:"QR:CLOSE/INDEXC*1000;\nMQR1:MA(QR,5);\nMQR2:MA(QR,10);"};return t},B.prototype.SG_SMX=function(){var t={Name:"SG-SMX",Description:"çå½çº¿(éä¸è½½æ¥çº¿)",IsMainIndex:!1,Args:[{Name:"N",Value:50}],Script:"H1:=HHV(HIGH,N);\nL1:=LLV(LOW,N);\nH2:=HHV(INDEXH,N);\nL2:=LLV(INDEXL,N);\nZY:=CLOSE/INDEXC*2000;\nZY1:EMA(ZY,3);\nZY2:EMA(ZY,17);\nZY3:EMA(ZY,34);"};return t},B.prototype.SG_LB=function(){var t={Name:"SG-LB",Description:"éæ¯(éä¸è½½æ¥çº¿)",IsMainIndex:!1,Args:[],Script:"ZY2:=VOL/INDEXV*1000;\néæ¯:ZY2;\nMA5:MA(ZY2,5);\nMA10:MA(ZY2,10);"};return t},B.prototype.SG_PF=function(){var t={Name:"SG-PF",Description:"å¼ºå¿è¡è¯å(éä¸è½½æ¥çº¿)",IsMainIndex:!1,Args:[],Script:"ZY1:=CLOSE/INDEXC*1000;\nA1:=IF(ZY1>HHV(ZY1,3),10,0);\nA2:=IF(ZY1>HHV(ZY1,5),15,0);\nA3:=IF(ZY1>HHV(ZY1,10),20,0);\nA4:=IF(ZY1>HHV(ZY1,2),10,0);\nA5:=COUNT(ZY1>REF(ZY1,1) ,9)*5;\nå¼ºå¿è¡è¯å:A1+A2+A3+A4+A5;"};return t},B.prototype.RAD=function(){var t={Name:"RAD",Description:"å¨åé·è¾¾(éä¸è½½æ¥çº¿)",IsMainIndex:!1,Args:[{Name:"D",Value:3},{Name:"S",Value:30},{Name:"M",Value:30}],Script:"SM:=(OPEN+HIGH+CLOSE+LOW)/4;\nSMID:=MA(SM,D);\nIM:=(INDEXO+INDEXH+INDEXL+INDEXC)/4;\nIMID:=MA(IM,D);\nSI1:=(SMID-REF(SMID,1))/SMID;\nII:=(IMID-REF(IMID,1))/IMID;\nRADER1:SUM((SI1-II)*2,S)*1000;\nRADERMA:SMA(RADER1,M,1);"};return t},B.prototype.SHT=function(){var t={Name:"SHT",Description:"é¾ç³»ç­çº¿",IsMainIndex:!1,Args:[{Name:"N",Value:5}],Script:"VAR1:=MA((VOL-REF(VOL,1))/REF(VOL,1),5);\nVAR2:=(CLOSE-MA(CLOSE,24))/MA(CLOSE,24)*100;\nMY: VAR2*(1+VAR1);\nSHT: MY, COLORSTICK;\nSHTMA: MA(SHT,N);"};return t},B.prototype.ZLJC=function(){var t={Name:"ZLJC",Description:"ä¸»åè¿åº",IsMainIndex:!1,Args:[],Script:"VAR1:=(CLOSE+LOW+HIGH)/3; \nVAR2:=SUM(((VAR1-REF(LOW,1))-(HIGH-VAR1))*VOL/100000/(HIGH-LOW),0); \nVAR3:=EMA(VAR2,1); \nJCS:VAR3; \nJCM:MA(VAR3,12); \nJCL:MA(VAR3,26);"};return t},B.prototype.ZLMM=function(){var t={Name:"ZLMM",Description:"ä¸»åä¹°å",IsMainIndex:!1,Args:[],Script:"LC :=REF(CLOSE,1);\nRSI2:=SMA(MAX(CLOSE-LC,0),12,1)/SMA(ABS(CLOSE-LC),12,1)*100;\nRSI3:=SMA(MAX(CLOSE-LC,0),18,1)/SMA(ABS(CLOSE-LC),18,1)*100;\nMMS:MA(3*RSI2-2*SMA(MAX(CLOSE-LC,0),16,1)/SMA(ABS(CLOSE-LC),16,1)*100,3);\nMMM:EMA(MMS,8);\nMML:MA(3*RSI3-2*SMA(MAX(CLOSE-LC,0),12,1)/SMA(ABS(CLOSE-LC),12,1)*100,5);"};return t},B.prototype.SLZT=function(){var t={Name:"SLZT",Description:"ç¥é¾å¨å¤©",IsMainIndex:!1,Args:[],Script:"ç½é¾: MA(CLOSE,125);\né»é¾: ç½é¾+2*STD(CLOSE,170);\nç´«é¾: ç½é¾-2*STD(CLOSE,145);\néé¾: SAR(125,1,7), LINESTICK;\nVAR2:=HHV(HIGH,70);\nVAR3:=HHV(HIGH,20);\nçº¢é¾: VAR2*0.83;\nèé¾: VAR3*0.91;"};return t},B.prototype.ADVOL=function(){var t={Name:"ADVOL",Description:"é¾ç³»ç¦»æ£é",IsMainIndex:!1,Args:[],Script:"A:=SUM(((CLOSE-LOW)-(HIGH-CLOSE))*VOL/10000/(HIGH-LOW),0);\nADVOL:A;\nMA1:MA(A,30);\nMA2:MA(MA1,100);"};return t},B.prototype.CYC=function(){var t={Name:"CYC",Description:"ææ¬åçº¿",IsMainIndex:!0,Args:[{Name:"P1",Value:5},{Name:"P2",Value:13},{Name:"P3",Value:34}],Script:"JJJ:=IF(DYNAINFO(8)>0.01,0.01*DYNAINFO(10)/DYNAINFO(8),DYNAINFO(3));\nDDD:=(DYNAINFO(5)<0.01 || DYNAINFO(6)<0.01);\nJJJT:=IF(DDD,1,(JJJ<(DYNAINFO(5)+0.01) && JJJ>(DYNAINFO(6)-0.01)));\nCYC1:IF(JJJT,0.01*EMA(AMOUNT,P1)/EMA(VOL,P1),EMA((HIGH+LOW+CLOSE)/3,P1));\nCYC2:IF(JJJT,0.01*EMA(AMOUNT,P2)/EMA(VOL,P2),EMA((HIGH+LOW+CLOSE)/3,P2));\nCYC3:IF(JJJT,0.01*EMA(AMOUNT,P3)/EMA(VOL,P3),EMA((HIGH+LOW+CLOSE)/3,P3));\nCYC4:IF(JJJT,DMA(AMOUNT/(100*VOL),100*VOL/FINANCE(7)),EMA((HIGH+LOW+CLOSE)/3,120));"};return t},B.prototype.CYS=function(){var t={Name:"CYS",Description:"å¸åºçäº",IsMainIndex:!1,Args:[],Script:"CYC13:EMA(AMOUNT,13)/EMA(VOL,13);\nCYS:(CLOSE-CYC13)/CYC13*100;"};return t},B.prototype.CYQKL=function(){var t={Name:"CYQKL",Description:"åå¼Kçº¿é¿åº¦",IsMainIndex:!1,Args:[],Script:"KL:100*(WINNER(CLOSE)-WINNER(OPEN));"};return t},B.prototype.SCR=function(){var t={Name:"SCR",Description:"ç­¹ç éä¸­åº¦",IsMainIndex:!1,Args:[{Name:"P1",Value:90}],Script:"A:=P1+(100-P1)/2;\nB:=(100-P1)/2;\nCC:=COST(A);\nDD:=COST(B);\nSCR:(CC-DD)/(CC+DD)*100/2;"};return t},B.prototype.ASR=function(){var t={Name:"ASR",Description:"æµ®ç­¹æ¯ä¾",IsMainIndex:!1,Args:[],Script:"ASR:(WINNER(C*1.1)-WINNER(C*0.9))/WINNER(HHV(H,0))*100;"};return t},B.prototype.SAR=function(){var t={Name:"SAR",Description:"æç©è½¬å",IsMainIndex:!0,Args:[{Name:"P",Value:10},{Name:"STEP",Value:2},{Name:"MAXP",Value:20}],Script:"S:SAR(P,STEP,MAXP),CIRCLEDOT;"};return t},B.prototype.TJCJL=function(){var t={Name:"å¤ªææäº¤é",Description:"å¤ªææäº¤é",IsMainIndex:!0,Args:[],Script:'æ»æ:VOL,NODRAW;\nDRAWTEXT_FIX(ISLASTBAR,0,0,0,"è¯´æ: çº¢è²æ±ä¸ºå¸è´§é,ç»¿è²ä¸ºåºè´§é,é»è²ä¸ºå¤©é,èè²ä¸ºå°é"),COLORGRAY;\nZZ:=IF(REF(C,1)>REF(O,1) AND O>REF(C,1)*1.014 AND C<O*1.02,1,3);\nV5:=MA(V,5);\nV12:=MA(V,12);\nV34:=MA(V,34);\nC6:=MA(C,6);\nSTICKLINE(VOL,0,VOL,3,0),COLORLIGRAY;\nSTICKLINE(CROSS(C,C6) AND V>V5*1.2 AND V>V12*1.2 AND ZZ>2 AND C>H*0.975,0,VOL,3,0),COLORRED;\nSTICKLINE(CROSS(C6,C) AND V>V5*1.2 AND V>V12*1.2,0,VOL,3,0),COLORGREEN;\nSTICKLINE(VOL>MA(VOL,5)*2 AND V>V34*3 AND C<REF(C,1)*1.05,0,VOL,3,0),COLORYELLOW;\nSTICKLINE(VOL<MA(VOL,5)/2 AND V<V12/2,0,VOL,3,0),COLORBLUE;\nSTICKLINE(VOL>MA(VOL,5)*2 AND V>V34*3 AND C<REF(C,1)*1.05 AND CROSS(C,C6) AND V>V5*1.2 AND V>V12*1.2 AND ZZ>2 AND C>H*0.975,VOL*0.5,0,3,0),COLORRED;\nSTICKLINE(VOL>MA(VOL,5)*2 AND V>V34*3 AND C<REF(C,1)*1.05 AND CROSS(C6,C) AND V>V5*1.2 AND V>V12*1.2,VOL*0.5,0,3,0),COLORRED;'};return t},B.prototype.Dragon4_Main=function(){var t={Name:"é£é¾åå¼",Description:"é£é¾åå¼",IsMainIndex:!0,Args:[{Name:"N1",Value:5},{Name:"N2",Value:10},{Name:"N3",Value:50},{Name:"N4",Value:60}],Script:"è»èç¹æ°´:=EMA(CLOSE,N1),COLORGRAY;\né­ç:=EMA(CLOSE,N2),COLORGREEN;\næ°´:=EMA(CLOSE,N3),COLORRED;\nDRAWKLINE(HIGH,OPEN,LOW,CLOSE);\nçå½çº¿:MA(CLOSE,N4),COLORBLUE,LINETHICK2;\nDRAWBAND(é­ç,'RGB(186,225,250)',æ°´,'RGB(253,194,124)');\nDRAWBAND(è»èç¹æ°´,'RGB(128,138,135)',é­ç,'RGB(0,0,255)');"};return t},B.prototype.Dragon4_Fig=function(){var t={Name:"é£é¾åå¼",Description:"é£é¾åå¼",IsMainIndex:!1,Args:[],Script:"å:VOL>=REF(V,1)*1.90 AND C>REF(C,1),COLORYELLOW;\nä½:VOL<REF(LLV(VOL,13),1),COLORGREEN;\nå°:VOL<REF(LLV(VOL,100),1),COLORMAGENTA; \nå¹³:=ABS(VOL-HHV(REF(VOL,1),5))/HHV(REF(VOL,1),5)<=0.03 OR ABS(VOL-REF(VOL,1))/REF(VOL,1)<=0.03,NODRAW,COLORWHITE;\nåç¼©:VOL<=REF(V,1)*0.5,COLORFF8000;\næ¢¯é:COUNT(V>REF(V,1),3)==3 AND COUNT(C>O,3)==3,COLORBROWN;\nç¼©éæ¶¨:COUNT(C>REF(C,1),2)==2 AND COUNT(V<REF(V,1),2)==2,COLORBLUE;\nSTICKLINE(C>=REF(C,1),V,0,2,0),COLORRED;\nSTICKLINE(C<REF(C,1),V,0,2,0),COLORGREEN;\nSTICKLINE(å,0,V,2,0),COLORYELLOW;\nSTICKLINE(ä½,0,V,2,0),COLORGREEN;\nSTICKLINE(å°,0,V,2,0),COLORLIMAGENTA;\nSTICKLINE(å¹³,0,V,2,0),COLORGRAY;\nSTICKLINE(åç¼©,0,V,2,0),COLORFF8000;\nSTICKLINE(æ¢¯é,0,V,2,0),COLORBROWN;\nSTICKLINE(ç¼©éæ¶¨,0,V,2,0),COLORBLUE;"};return t},B.prototype.FundsAnalysis=function(){var t={Name:"èµéåæ",Description:"èµéåæ",IsMainIndex:!1,Args:[{Name:"M",Value:55},{Name:"N",Value:34}],Script:"LC:=REF(CLOSE,1);\nRSI:=((SMA(MAX((CLOSE - LC),0),3,1) / SMA(ABS((CLOSE - LC)),3,1)) * 100);\nFF:=EMA(CLOSE,3);\nMA15:=EMA(CLOSE,21); DRAWTEXT(CROSS(85,RSI),75,'â¼'),COLORGREEN;\nVAR1:=IF(YEAR>=2038 AND MONTH>=1,0,1);\nVAR2:=REF(LOW,1)*VAR1;\nVAR3:=SMA(ABS(LOW-VAR2),3,1)/SMA(MAX(LOW-VAR2,0),3,1)*100*VAR1;\nVAR4:=EMA(IF(CLOSE*1.3,VAR3*10,VAR3/10),3)*VAR1;\nVAR5:=LLV(LOW,30)*VAR1;\nVAR6:=HHV(VAR4,30)*VAR1;\nVAR7:=IF(MA(CLOSE,58),1,0)*VAR1;\nVAR8:=EMA(IF(LOW<=VAR5,(VAR4+VAR6*2)/2,0),3)/618*VAR7*VAR1;\nå¸ç­¹A:IF(VAR8>100,100,VAR8)*VAR1,COLORFB2F3B;\n{å¸ç­¹B}STICKLINE(å¸ç­¹A>-150,0,å¸ç­¹A,8,0),COLORFB2F3B;\n\næ£æ·çº¿: 100*(HHV(HIGH,M)-CLOSE)/(HHV(HIGH,M)-LLV(LOW,M)),COLORAA89BD,LINETHICK2;\nRSV:=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100;\nK:=SMA(RSV,3,1);\nD:=SMA(K,3,1);\nJ:=3*K-2*D;\nä¸»åçº¿:EMA(J,5),COLORF39800,LINETHICK2;\nDRAWICON(CROSS(ä¸»åçº¿,æ£æ·çº¿),ä¸»åçº¿,1);\nDRAWICON(CROSS(æ£æ·çº¿,ä¸»åçº¿),ä¸»åçº¿,2);"};return t},B.prototype.MarginProportion=function(){var t={Name:"èèµå æ¯(%)",Description:"èèµå æ¯",IsMainIndex:!1,Condition:{Period:[R.KLINE_DAY_ID]},Args:[],Script:"å æ¯:MARGIN(2);"};return t},B.prototype.Margin2=function(){var t={Name:"ä¸¤èä½é¢",Description:"èèµèå¸ä½é¢",IsMainIndex:!1,Condition:{Period:[R.KLINE_DAY_ID]},Args:[{Name:"N",Value:5}],Script:"T1:MARGIN(1);\n        T2:MA(MARGIN(1),N);"};return t},B.prototype.Margin3=function(){var t={Name:"ä¸¤èä½é¢",Description:"èèµèå¸ä½é¢",IsMainIndex:!1,Condition:{Period:[R.KLINE_DAY_ID]},Args:[{Name:"N",Value:5}],Script:"T1:=MARGIN(1);\n        T2:=MA(MARGIN(1),N);\n        STICKLINE(T1-T2>=0,0,T1-T2,50,T1>T2),COLORRED;\n        STICKLINE(T1-T2<0,T1-T2,0,50,T1>T2),COLORGREEN;"};return t},B.prototype.FXG_BSPoint=function(){var t={Name:"æçBSç¹",Description:"æçBSç¹",IsMainIndex:!0,Args:[],Script:"MA5:MA(CLOSE,5);\n        MA13:MA(CLOSE,13);\n        MA21:MA(CLOSE,21);\n        MA34:MA(CLOSE,34);\n        {MA55:MA(CLOSE,55),COLOR0000FF;}\n        {MA120:=MA(CLOSE,120),COLORFFFF00;}\n        å¤©ä½¿:=EMA(C,2),COLOR000000;\n        é­é¬¼:=EMA(SLOPE(C,21)*20+C,42),COLOR000000;\n        ä¹°:=CROSS(å¤©ä½¿,é­é¬¼);\n        å:=CROSS(é­é¬¼,å¤©ä½¿);\n        DRAWICON(ä¹°,L*0.97,13);\n        DRAWICON(å,H*1.03,14);\n        DRAWKLINE_IF(å¤©ä½¿>=é­é¬¼,HIGH,CLOSE,LOW,OPEN),COLORRED;\n        DRAWKLINE_IF(å¤©ä½¿<é­é¬¼,HIGH,CLOSE,LOW,OPEN),COLORBLUE;\n        DRAWKLINE_IF(CROSS(å¤©ä½¿,é­é¬¼),HIGH,CLOSE,LOW,OPEN),COLORYELLOW;\n        DRAWKLINE_IF(CROSS(é­é¬¼,å¤©ä½¿),HIGH,CLOSE,LOW,OPEN),COLORBLACK;"};return t},B.prototype.FXG_INDEX=function(){var t={Name:"æ¶¨åå¤ç©ºçº¿",Description:"æ¶¨åå¤ç©ºçº¿",IsMainIndex:!1,Args:[],Script:"åå¤è½éçº¿: SMA((CLOSE-LLV(LOW,9))/(HHV(HIGH,9)-LLV(LOW,9))*100,5,1)-8,COLORRED,LINETHICK3;\nåç©ºè½éçº¿: SMA((HHV(HIGH,36)-CLOSE)/(HHV(HIGH,36)-LLV(LOW,36))*100,2,1),COLORGREEN,LINETHICK3;\n20,POINTDOT,COLORF00FF0;\n50,POINTDOT,COLORGREEN;\n80,POINTDOT,COLORLIBLUE;"};return t},B.prototype.FXG_INDEX2=function(){var t={Name:"æ¶¨åå¸ç­¹åº",Description:"æ¶¨åå¸ç­¹åº",IsMainIndex:!1,Args:[],Script:"VAR0:=EMA(HHV(HIGH,500),21); \nVAR1:=EMA(HHV(HIGH,250),21);\nVAR2:=EMA(HHV(HIGH,90),21); \nVAR3:=EMA(LLV(LOW,500),21); \nVAR4:=EMA(LLV(LOW,250),21); \nVAR5:=EMA(LLV(LOW,90),21);\n\nVAR6:=EMA((VAR3*0.96+VAR4*0.96+VAR5*0.96+VAR0*0.558+VAR1*0.558+VAR2*0.558)/6,21); \nVAR7:=EMA((VAR3*1.25+VAR4*1.23+VAR5*1.2+VAR0*0.55+VAR1*0.55+VAR2*0.65)/6,21); \nVAR8:=EMA((VAR3*1.3+VAR4*1.3+VAR5*1.3+VAR0*0.68+VAR1*0.68+VAR2*0.68)/6,21); \nVAR9:=EMA((VAR6*3+VAR7*2+VAR8)/6*1.738,21); \nVAR10:=REF(LOW,1); \nVAR11:=SMA(ABS(LOW-VAR10),3,1)/SMA(MAX(LOW-VAR10,0),3,1)*100; \nVAR12:=EMA(IFF(CLOSE*1.35<=VAR9,VAR11*10,VAR11/10),3); \nVAR13:=LLV(LOW,30); \nVAR14:=HHV(VAR12,30); \nVAR15:=IFF(MA(CLOSE,58),1,0); \nVAR16:=EMA(IFF(LOW<=VAR13,(VAR12+VAR14*2)/2,0),3)/618*VAR15;\n\nèµéå¥åº:IFF(VAR16>0,VAR16,0),LINETHICK,LINETHICK2, COLORFF0000; \n\nA1:IFF(èµéå¥åº>0,èµéå¥åº*1.2,0),STICK,LINETHICK5, COLORFF0000;\nA2:IFF(èµéå¥åº>0,èµéå¥åº*0.8,0),STICK,LINETHICK5, COLORFF6600;\nA3:IFF(èµéå¥åº>0,èµéå¥åº*0.6,0),STICK,LINETHICK5, COLORFF9900;\nA4:IFF(èµéå¥åº>0,èµéå¥åº*0.4,0) ,STICK,LINETHICK5,COLORFFCC00;\nA5:IFF(èµéå¥åº>0,èµéå¥åº*0.2,0) ,STICK,LINETHICK5,COLORFFFF00;"};return t},B.prototype.FXG_INDEX3=function(){var t={Name:"éè½é»éç¹",Description:"éè½é»éç¹",IsMainIndex:!1,FloatPrecision:0,Args:[],Script:"A:=IFF((CLOSE>126.32),VOL,VOL); \nä¸»å:=MA(A,4),COLORRED;\næ¸¸èµ:=MA(A,8),COLORYELLOW;\nå¤§æ·:=MA(A,16),COLORF0F000;\næ£æ·:=MA(A,32),COLOR00FF00;\nä¸»æ¯:=ABS(((ä¸»å)/(ä¸»å + æ¸¸èµ + å¤§æ· + æ£æ·))*(100)),LINESTICK,COLORRED;\næ¸¸æ¯:=ABS(((æ¸¸èµ)/(ä¸»å + æ¸¸èµ + å¤§æ· + æ£æ·))*(100)),LINESTICK,COLORYELLOW;\nå¤§æ¯:=ABS(((å¤§æ·)/(ä¸»å + æ¸¸èµ + å¤§æ· + æ£æ·))*(100)),LINESTICK,COLORF0F000;\næ£æ¯:=ABS(((æ£æ·)/(ä¸»å + æ¸¸èµ + å¤§æ· + æ£æ·))*(100)),LINESTICK,COLOR00FF00;\nè­¦æçº¿:MA(A,180),COLORFF66FF;\nSTICKLINE((ä¸»å > 0),0,ä¸»å,2.5,0),COLOR1020BB;\nSTICKLINE((ä¸»å > 0),0,ä¸»å,0.7,0),COLORRED;\nSTICKLINE((æ¸¸èµ > 0),0,æ¸¸èµ,2.5,0),COLOR009CFF;\nSTICKLINE((æ¸¸èµ > 0),0,æ¸¸èµ,0.7,0),COLORYELLOW;\nSTICKLINE((å¤§æ· > 0),0,å¤§æ·,2.5,0),COLORFF8800;\nSTICKLINE((å¤§æ· > 0),0,å¤§æ·,0.7,0),COLORLIBLUE;\nSTICKLINE((æ£æ· > 0),0,æ£æ·,2.5,0),COLOR00CA00;\nSTICKLINE((æ£æ· > 0),0,æ£æ·,0.7,0),COLORGREEN;"};return t},B.prototype.NewsNegative=function(){var t={Name:"è´é¢æ°é»",Description:"è´é¢æ°é»ç»è®¡",IsMainIndex:!1,FloatPrecision:0,Args:[{Name:"N",Value:5},{Name:"N2",Value:10}],Script:"è´é¢:NEWS(1);\nMA1:MA(è´é¢,N);\nMA2:MA(è´é¢,N2);"};return t},B.prototype.UpDownAnalyze=function(){var t={Name:"æ¶¨è·è¶å¿",Description:"æ¶¨è·è¶å¿",IsMainIndex:!1,FloatPrecision:0,Condition:{Period:[R.MINUTE_ID,R.MULTIDAY_MINUTE_ID,R.KLINE_DAY_ID]},Args:[],Script:"ä¸æ¶¨å®¶æ°:UPCOUNT('CNA.CI'),COLORRED;\nä¸è·å®¶æ°:DOWNCOUNT('CNA.CI'),COLORGREEN;"};return t},B.prototype.HK2SHSZ=function(){var t={Name:"åä¸èµé",Description:"åä¸èµé",IsMainIndex:!1,FloatPrecision:0,Condition:{Period:[R.MINUTE_ID,R.MULTIDAY_MINUTE_ID,R.KLINE_DAY_ID]},Args:[],Script:"åæµå¥:HK2SHSZ(1),COLORSTICK;"};return t},B.prototype.ShareHolder=function(){var t={Name:"è¡ä¸äººæ°",Description:"è¡ä¸äººæ°",IsMainIndex:!1,FloatPrecision:0,Condition:{Period:[R.KLINE_DAY_ID,R.KLINE_MONTH_ID,R.KLINE_WEEK_ID,R.KLINE_YEAR_ID]},Args:[],Script:"äººæ°:FINANCE(100);"};return t},B.prototype.VOLRate=function(){var t={Name:"éæ¯",Description:"éæ¯",IsMainIndex:!1,Condition:{Period:[R.MINUTE_ID,R.MULTIDAY_MINUTE_ID]},Args:[],Script:"LIANGBI:VOLR;"};return t},B.prototype.COLOR_KSTAR1=function(){var t={Name:"åå­æ",Description:"åå­æ",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:CLOSE==OPEN&&HIGH>LOW;"};return t},B.prototype.COLOR_KSTAR2=function(){var t={Name:"æ©æ¨ä¹æ",Description:"æ©æ¨ä¹æ",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:(REF(CLOSE,2)/REF(OPEN,2)<0.95) && (REF(OPEN,1) < REF(CLOSE,2)) && (ABS(REF(OPEN,1)-REF(CLOSE,1))/REF(CLOSE,1)<0.03) && CLOSE/OPEN>1.05 && CLOSE>REF(CLOSE,2);"};return t},B.prototype.COLOR_KSTAR3=function(){var t={Name:"é»æä¹æ",Description:"é»æä¹æ",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:REF(CLOSE,2)/REF(OPEN,2)>1.05 && REF(OPEN,1)>REF(CLOSE,2) && ABS(REF(OPEN,1)-REF(CLOSE,1))/REF(CLOSE,1)<0.03 && CLOSE/OPEN<0.95 && CLOSE<REF(CLOSE,2);"};return t},B.prototype.COLOR_SHI1=function(){var t={Name:"é¿åå­",Description:"é¿åå­",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:CLOSE==OPEN&&HIGH/LOW>1.03;"};return t},B.prototype.COLOR_K220=function(){var t={Name:"èº«æå­ç²",Description:"èº«æå­ç²",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:ABS(REF(CLOSE,1)-REF(OPEN,1))/REF(CLOSE,1)>0.04&&\n            ABS(CLOSE-OPEN)/CLOSE<0.005&&\n            MAX(CLOSE,OPEN)<MAX(REF(CLOSE,1),REF(OPEN,1))&&\n            MIN(CLOSE,OPEN)>MIN(REF(CLOSE,1),REF(OPEN,1));"};return t},B.prototype.COLOR_K300=function(){var t={Name:"ä¸ä¸ªç½æ­¦å£«",Description:"ä¸ä¸ªç½æ­¦å£«",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:UPNDAY(CLOSE,3)&&NDAY(CLOSE,OPEN,3);"};return t},B.prototype.COLOR_K310=function(){var t={Name:"ä¸åªä¹é¸¦",Description:"ä¸åªä¹é¸¦",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:DOWNNDAY(CLOSE,3)&&NDAY(OPEN,CLOSE,3);"};return t},B.prototype.COLOR_K380=function(){var t={Name:"åå¤´é³çº¿",Description:"åå¤´é³çº¿",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:HIGH==CLOSE&&HIGH>LOW;"};return t},B.prototype.COLOR_K390=function(){var t={Name:"åèé´çº¿",Description:"åèé´çº¿",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:LOW==CLOSE&&HIGH>LOW;"};return t},B.prototype.COLOR_K134=function(){var t={Name:"åæ­»åå­",Description:"åæ­»åå­",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:CLOSE==OPEN&&CLOSE==LOW&&CLOSE<HIGH;"};return t},B.prototype.COLOR_K140=function(){var t={Name:"æ©æ¨åå­æ",Description:"æ©æ¨åå­æ",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:REF(CLOSE,2)/REF(OPEN,2)<0.95&&\nREF(OPEN,1)<REF(CLOSE,2)&&\nREF(OPEN,1)==REF(CLOSE,1)&&\nCLOSE/OPEN>1.05&&CLOSE>REF(CLOSE,2);"};return t},B.prototype.COLOR_K150=function(){var t={Name:"é»æåå­æ",Description:"é»æåå­æ",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:REF(CLOSE,2)/REF(OPEN,2)>1.05&&\nREF(OPEN,1)>REF(CLOSE,2)&&\nREF(OPEN,1)=REF(CLOSE,1)&&\nCLOSE/OPEN<0.95&&CLOSE<REF(CLOSE,2);"};return t},B.prototype.COLOR_K160=function(){var t={Name:"å°å»ä¹æ",Description:"å°å»ä¹æ",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:MIN(OPEN,CLOSE)==LOW&&\nHIGH-LOW>3*(MAX(OPEN,CLOSE)-LOW)&&\nCLOSE>MA(CLOSE,5);"};return t},B.prototype.COLOR_K165=function(){var t={Name:"åè½¬é¤å¤´",Description:"åè½¬é¤å¤´",IsMainIndex:!0,InstructionType:2,Script:"KSTAR:MIN(OPEN,CLOSE)==LOW&&\nHIGH-LOW>3*(MAX(OPEN,CLOSE)-LOW)&&\nCLOSE<MA(CLOSE,5);"};return t},B.prototype.COLOR_K170=function(){var t={Name:"é¤å¤´",Description:"é¤å¤´",IsMainIndex:!0,InstructionType:2,Script:"OUT:HIGH==MAX(OPEN,CLOSE)&&\nHIGH-LOW>3*(HIGH-MIN(OPEN,CLOSE))&&\nCLOSE<MA(CLOSE,5);"};return t},B.prototype.COLOR_K180=function(){var t={Name:"åé¢",Description:"åé¢",IsMainIndex:!0,InstructionType:2,Script:"OUT:HIGH==MAX(OPEN,CLOSE)&&\nHIGH-LOW>3*(HIGH-MIN(OPEN,CLOSE))&&\nCLOSE>MA(CLOSE,5);"};return t},B.prototype.COLOR_K190=function(){var t={Name:"ç©¿å¤´ç ´è",Description:"ç©¿å¤´ç ´è",IsMainIndex:!0,InstructionType:2,Script:"OUT:(REF(CLOSE,1)/REF(OPEN,1)>1.03&&\nCLOSE/OPEN<0.96&&\nCLOSE<REF(OPEN,1)&&OPEN>REF(CLOSE,1))||\n(REF(CLOSE,1)/REF(OPEN,1)<0.97&&\nCLOSE/OPEN>1.04&&\nCLOSE>REF(OPEN,1)&&OPEN<REF(CLOSE,1));"};return t},B.prototype.COLOR_SWORD=function(){var t={Name:"å",Description:"å",IsMainIndex:!0,InstructionType:2,Script:"AA:=VOL>REF(VOL,1)||VOL>(CAPITAL*0.1);\nBB:=OPEN>=(REF(HIGH,1))&&REF(HIGH,1)>(REF(HIGH,2)*1.06);\nCC:=CLOSE>(REF(CLOSE,1))-(REF(CLOSE,1)*0.01);\nDD:=CLOSE<(HIGH*0.965) && HIGH>(OPEN*1.05);\nEE:=LOW<OPEN && LOW<CLOSE&&HIGH>(REF(CLOSE,1)*1.06);\nFF:=(HIGH-(MAX(OPEN,CLOSE)))/2>(MIN(OPEN,CLOSE))-LOW;\nGG:=(ABS(OPEN-CLOSE))/2<(MIN(OPEN,CLOSE)-LOW);\nSWORDO:AA&&BB&&CC&&DD&&EE&&FF&&GG;"};return t},B.prototype.COLOR_CSFR=function(){var t={Name:"åºæ°´èè",Description:"åºæ°´èè",IsMainIndex:!0,InstructionType:2,Script:"A:=CLOSE>OPEN;\nB:=A&&CLOSE>MA(CLOSE,S)&&CLOSE>MA(CLOSE,M)&&CLOSE>MA(CLOSE,LL);\nCC:=B&&OPEN<MA(CLOSE,M)&&OPEN<MA(CLOSE,LL);\nCSFRO:CC&&(CLOSE-OPEN)>0.0618*CLOSE;"};return t},B.prototype.COLOR_WYGD=function(){var t={Name:"ä¹äºçé¡¶",Description:"ä¹äºçé¡¶",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( \nREF(CLOSE,1)/REF(OPEN,1)>1.03 AND \nCLOSE/OPEN<0.97 AND \nOPEN>REF(CLOSE,1) AND CLOSE<REF(CLOSE,1), 3);"};return t},B.prototype.COLOR_SGCJ=function(){var t={Name:"æååç°",Description:"æååç°",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( \nREF(CLOSE,1)/REF(OPEN,1)<0.97 AND \nCLOSE/OPEN>1.03 AND \nOPEN<REF(CLOSE,1) AND CLOSE>REF(CLOSE,1), 3);"};return t},B.prototype.COLOR_SZTAI=function(){var t={Name:"åå­è",Description:"åå­è",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( ABS(REF(CLOSE,1)-REF(OPEN,1))/REF(CLOSE,1) > 0.04 AND \nCLOSE==OPEN AND CLOSE < MAX(REF(CLOSE,1),REF(OPEN,1)) AND \nCLOSE > MIN(REF(CLOSE,1),REF(OPEN,1)), 2);"};return t},B.prototype.COLOR_PINGDING=function(){var t={Name:"å¹³é¡¶",Description:"å¹³é¡¶",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET(ABS(HIGH-REF(HIGH,1))/HIGH<0.001,2);"};return t},B.prototype.COLOR_PINGDI=function(){var t={Name:"å¹³åº",Description:"å¹³åº",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET((ABS(LOW-REF(LOW,1))/LOW<0.001 AND \nABS(REF(LOW,1)-REF(LOW,2))/REF(LOW,1)<=0.001),2);"};return t},B.prototype.COLOR_DAYANZHU=function(){var t={Name:"å¤§é³ç",Description:"å¤§é³ç",IsMainIndex:!0,InstructionType:2,Script:"VAR1:CLOSE/OPEN>1.05 AND HIGH/LOW < CLOSE/OPEN+0.018;"};return t},B.prototype.COLOR_DAYINGZHU=function(){var t={Name:"å¤§é´ç",Description:"å¤§é´ç",IsMainIndex:!0,InstructionType:2,Script:"VAR1:OPEN/CLOSE > 1.05 AND HIGH/LOW < OPEN/CLOSE+0.018;"};return t},B.prototype.COLOR_HYFG=function(){var t={Name:"å¥½ååæ»",Description:"å¥½ååæ»",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( (REF(CLOSE,1)<REF(OPEN,1) AND \nCLOSE>OPEN AND ABS(CLOSE-REF(CLOSE,1))/CLOSE<0.002),2);"};return t},B.prototype.COLOR_TKQK=function(){var t={Name:"è·³ç©ºç¼ºå£",Description:"è·³ç©ºç¼ºå£",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( HIGH<REF(LOW,1) OR LOW>REF(HIGH,1),2);"};return t},B.prototype.COLOR_SFWY=function(){var t={Name:"åé£ä¹é¸¦",Description:"åé£ä¹é¸¦",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( REF(CLOSE,1)<REF(OPEN,1) AND CLOSE<OPEN AND CLOSE/OPEN<0.98,1);"};return t},B.prototype.COLOR_SSSBQ=function(){var t={Name:"ä¸åä¸é¨æ²",Description:"ä¸åä¸é¨æ²",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( \nREF(CLOSE,4)/REF(OPEN,4)>1.03 AND \nREF(CLOSE,3)<REF(OPEN,3) AND \nREF(CLOSE,2)<REF(OPEN,2) AND \nREF(CLOSE,1)<REF(OPEN,1) AND \nREF(LOW,4)<REF(LOW,3) AND \nREF(LOW,4)<REF(LOW,2) AND \nREF(LOW,4)<REF(LOW,1) AND \nREF(HIGH,4)>REF(HIGH,3) AND \nREF(HIGH,4)>REF(HIGH,2) AND \nREF(HIGH,4)>REF(HIGH,1) AND \nCLOSE/OPEN>1.03 AND \nCLOSE>REF(CLOSE,4), 5);"};return t},B.prototype.COLOR_XDSBQ=function(){var t={Name:"ä¸è·ä¸é¨æ²",Description:"ä¸è·ä¸é¨æ²",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( \nREF(CLOSE,4)/REF(OPEN,4)<0.97 AND \nREF(CLOSE,3)>REF(OPEN,3) AND \nREF(CLOSE,2)>REF(OPEN,2) AND \nREF(CLOSE,1)>REF(OPEN,1) AND \nREF(LOW,4)<REF(LOW,3) AND \nREF(LOW,4)<REF(LOW,2) AND \nREF(LOW,4)<REF(LOW,1) AND \nREF(HIGH,4)>REF(HIGH,3) AND \nREF(HIGH,4)>REF(HIGH,2) AND \nREF(HIGH,4)>REF(HIGH,1) AND \nCLOSE/OPEN<0.97 AND \nCLOSE<REF(CLOSE,4), 5);"};return t},B.prototype.COLOR_CHXY=function(){var t={Name:"é¿ä¸å½±",Description:"é¿ä¸å½±",IsMainIndex:!0,InstructionType:2,Script:"VAR2:(MIN(CLOSE,OPEN)-LOW)/(HIGH-LOW)>0.667;"};return t},B.prototype.COLOR_CHSY=function(){var t={Name:"é¿ä¸å½±",Description:"é¿ä¸å½±",IsMainIndex:!0,InstructionType:2,Script:"VAR2:(HIGH-MAX(CLOSE,OPEN))/(HIGH-LOW)>0.667,COLORBLUE;"};return t},B.prototype.COLOR_FENLI=function(){var t={Name:"åç¦»",Description:"åç¦»",IsMainIndex:!0,InstructionType:2,Script:"VAR1:BACKSET( OPEN==REF(OPEN,1) AND (CLOSE-OPEN)*(REF(CLOSE,1)-REF(OPEN,1))<0,2);"};return t},B.prototype.TRADE_BIAS=function(){var t={Name:"BIAS",Description:"ä¹ç¦»çä¸å®¶ç³»ç»",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:12},{Name:"LL",Value:6},{Name:"LH",Value:6}],Script:"BIAS:=(CLOSE-MA(CLOSE,N))/MA(CLOSE,N)*100;\nENTERLONG:CROSS(-LL,BIAS);\nEXITLONG:CROSS(BIAS,LH);"};return t},B.prototype.TRADE_CCI=function(){var t={Name:"CCI",Description:"CCIä¸å®¶ç³»ç»",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:14}],Script:"TYP:=(HIGH+LOW+CLOSE)/3;\nCCI:=(TYP-MA(TYP,N))/(0.015*AVEDEV(TYP,N));\nINDEX:=CCI;\nENTERLONG:CROSS(INDEX,-100);\nEXITLONG:CROSS(100,INDEX);"};return t},B.prototype.TRADE_DMI=function(){var t={Name:"DMI",Description:"è¶åä¸å®¶ç³»ç»",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:14}],Script:"MTR:=SUM(MAX(MAX(HIGH-LOW,ABS(HIGH-REF(CLOSE,1))),ABS(LOW-REF(CLOSE,1))),N);\nHD :=HIGH-REF(HIGH,1);\nLD :=REF(LOW,1)-LOW;\nPDM:=SUM(IF(HD>0&&HD>LD,HD,0),N);\nMDM:=SUM(IF(LD>0&&LD>HD,LD,0),N);\nPDI:=PDM*100/MTR;\nMDI:=MDM*100/MTR;\nENTERLONG:CROSS(PDI,MDI);\nEXITLONG:CROSS(MDI,PDI);"};return t},B.prototype.TRADE_KD=function(){var t={Name:"KD",Description:"KDææ ä¸å®¶ç³»ç»",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:9},{Name:"M1",Value:3},{Name:"M2",Value:3}],Script:"WRSV:=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100;\nWK:=SMA(WRSV,M1,1);\nD:=SMA(WK,M2,1);\nENTERLONG:CROSS(WK,D)&&WK<20;\nEXITLONG:CROSS(D,WK)&&WK>80;"};return t},B.prototype.TRADE_BOLL=function(){var t={Name:"BOLL",Description:"å¸æå¸¦ä¸å®¶ç³»ç»",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:20}],Script:"MID :=MA(CLOSE,N);\nUPPER:=MID+2*STD(CLOSE,N);\nLOWER:=MID-2*STD(CLOSE,N);\nENTERLONG:CROSS(CLOSE,LOWER);\nEXITLONG:CROSS(CLOSE,UPPER);"};return t},B.prototype.TRADE_KDJ=function(){var t={Name:"KDJ",Description:"KDJä¸å®¶ç³»ç»",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:9},{Name:"M1",Value:3}],Script:"RSV:=(CLOSE-LLV(LOW,N))/(HHV(HIGH,N)-LLV(LOW,N))*100;\nK:=SMA(RSV,M1,1);\nD:=SMA(K,M1,1);\nJ:=3*K-2*D;\nENTERLONG:CROSS(J,0);\nEXITLONG:CROSS(100,J);"};return t},B.prototype.TRADE_MA=function(){var t={Name:"MA",Description:"åçº¿ä¸å®¶ç³»ç»",IsMainIndex:!0,InstructionType:1,Args:[{Name:"SHORT",Value:5},{Name:"LONG",Value:20}],Script:"ENTERLONG:CROSS(MA(CLOSE,SHORT),MA(CLOSE,LONG));\nEXITLONG:CROSS(MA(CLOSE,LONG),MA(CLOSE,SHORT));"};return t},B.prototype.TRADE_MACD=function(){var t={Name:"MACD",Description:"MACDä¸å®¶ç³»ç»",IsMainIndex:!0,InstructionType:1,Args:[{Name:"LONG",Value:26},{Name:"SHORT",Value:12},{Name:"M",Value:9}],Script:"DIFF:=EMA(CLOSE,SHORT) - EMA(CLOSE,LONG);\nDEA  := EMA(DIFF,M);\nMACD := 2*(DIFF-DEA);\nENTERLONG:CROSS(MACD,0);\nEXITLONG:CROSS(0,MACD);"};return t},B.prototype.TRADE_MTM=function(){var t={Name:"MTM",Description:"å¨åææ ä¸å®¶ç³»ç»",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:6}],Script:"WMTM:=C-REF(C,N);\nENTERLONG:CROSS(WMTM,0);\nEXITLONG:CROSS(0,WMTM);"};return t},B.prototype.TRADE_PSY=function(){var t={Name:"PSY",Description:"PSYå¿ççº¿ä¸å®¶ç³»ç»",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:12},{Name:"LL",Value:10},{Name:"LH",Value:85}],Script:"MYPSY:=COUNT(CLOSE>REF(CLOSE,1),N)/N*100;\nENTERLONG:CROSS(LL,MYPSY);\nEXITLONG:CROSS(MYPSY,LH);"};return t},B.prototype.TRADE_ROC=function(){var t={Name:"ROC",Description:"åå¨éçä¸å®¶ç³»ç»",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:12},{Name:"M",Value:6}],Script:"WROC:=MA(100*(CLOSE-REF(CLOSE,N))/REF(CLOSE,N),M);\nENTERLONG:CROSS(WROC,0);\nEXITLONG:CROSS(0,WROC);"};return t},B.prototype.TRADE_RSI=function(){var t={Name:"RSI",Description:"ç¸å¯¹å¼ºå¼±ä¸å®¶ç³»ç»",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:6},{Name:"LL",Value:20},{Name:"LH",Value:80}],Script:"LC:=REF(CLOSE,1);\nWRSI:=SMA(MAX(CLOSE-LC,0),N,1)/SMA(ABS(CLOSE-LC),N,1)*100;\nENTERLONG:CROSS(WRSI,LL);\nEXITLONG:CROSS(LH,WRSI);"};return t},B.prototype.TRADE_VR=function(){var t={Name:"VR",Description:"VRå®¹éæ¯çä¸å®¶ç³»ç»",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N",Value:26},{Name:"LL",Value:70},{Name:"LH",Value:250}],Script:"WVR := SUM((IF(CLOSE>OPEN,VOL,0)+IF(CLOSE=OPEN,VOL/2,0)),N)/SUM((IF(CLOSE<OPEN,VOL,0)+IF(CLOSE=OPEN,VOL/2,0)),N)*100;\nENTERLONG:CROSS(LL,WVR);\nEXITLONG:CROSS(WVR,LH);"};return t},B.prototype.TRADE_DPSJ=function(){var t={Name:"DPSJ",Description:"å¤§çéæºä¸å®¶ç³»ç»",IsMainIndex:!0,InstructionType:1,Args:[{Name:"N1",Value:18},{Name:"N2",Value:12}],Script:"RSV:=(INDEXC-LLV(INDEXL,N1))/(HHV(INDEXH,N1)-LLV(INDEXL,N1))*100;\nK:=SMA(RSV,N2,1);\nHSL:VOL/100/(FINANCE(7));\nENTERLONG: CROSS(K,20);\nEXITLONG: (CROSS(HSL,5) OR CROSS(K,80));"};return t},B.prototype.Zealink_Index1=function(){var t={Name:"èµéå¸ç­¹",Description:"èµéå¸ç­¹",IsMainIndex:!1,Args:[],Script:"VAR1:=REF((LOW+OPEN+CLOSE+HIGH)/4,1);  \nVAR2:= SMA(ABS(LOW - VAR1), 13, 1) / SMA(MAX(LOW - VAR1, 0), 10, 1);\nVAR3:= EMA(VAR2, 10);\nVAR4:= LLV(LOW, 33);\nVAR5:= EMA(IF(LOW <= VAR4, VAR3, 0), 3) * 0.2;\nä¸»åè¿åº: IF(VAR5 > REF(VAR5, 1), VAR5,0), COLORRED, NODRAW;\næ´ç: IF(VAR5 < REF(VAR5, 1),  VAR5,0), COLORYELLOW, NODRAW;\nSTICKLINE(VAR5> REF(VAR5, 1),0, VAR5, 20, 0), COLORRED;\nSTICKLINE(VAR5 < REF(VAR5, 1), 0, VAR5, 20, 0), COLORYELLOW;"};return t},B.prototype.Zealink_Index2=function(){var t={Name:"ççåºé´",Description:"ççåºé´",IsMainIndex:!1,YSpecificMaxMin:{Max:100,Min:1,Count:4},YSplitScale:[1,50,100],Args:[],Script:"ç­é«H:=(20*H+19*REF(H,1)+18*REF(H,2)+17*REF(H,3)+16*REF(H,4)+15*REF(H,5)+14*REF(H,6)\n+ 13 * REF(H, 7) + 12 * REF(H, 8) + 11 * REF(H, 9) + 10 * REF(H, 10) + 9 * REF(H, 11) + 8 * REF(H, 12)\n+ 7 * REF(H, 13) + 6 * REF(H, 14) + 5 * REF(H, 15) + 4 * REF(H, 16) + 3 * REF(H, 17) + 2 * REF(H, 18) +\nREF(H, 20))/ 210, COLORBLUE, LINETHICK1;\nç­ä½L:= (20 * L + 19 * REF(L, 1) + 18 * REF(L, 2) + 17 * REF(L, 3) + 16 * REF(L, 4) + 15 * REF(L, 5) + 14 * REF(L, 6)\n+ 13 * REF(L, 7) + 12 * REF(L, 8) + 11 * REF(L, 9) + 10 * REF(L, 10) + 9 * REF(L, 11) + 8 * REF(L, 12)\n+ 7 * REF(L, 13) + 6 * REF(L, 14) + 5 * REF(L, 15) + 4 * REF(L, 16) + 3 * REF(L, 17) + 2 * REF(L, 18) +\nREF(L, 20)) / 210, COLORBLUE, LINETHICK1;\nD90H:= EMA(ç­é«H, 90), COLORRED, LINETHICK1;\nD90L:= EMA(ç­ä½L, 90), COLORRED, LINETHICK1;\nD90å·®:= D90H - D90L;\nD90é¡¶:= D90H + D90å·® * 2, COLORRED, LINETHICK1;\nD90åº:= D90L - D90å·® * 2, COLORRED, LINETHICK1;\né«0:= (EMA(EMA(H, 25), 25) - EMA(EMA(L, 25), 25)) * 1 + EMA(EMA(H, 25), 25), LINETHICK1, COLORWHITE;\nä½0:= EMA(EMA(L, 25), 25) - (EMA(EMA(H, 25), 25) - EMA(EMA(L, 25), 25)) * 1, LINETHICK1, COLORWHITE;\nå¤å¤´å®ä½:= ä½0 >= D90åº AND é«0 >= D90é¡¶;\nç©ºå¤´å®ä½:= é«0 <= D90é¡¶ AND ä½0 <= D90åº;\néè¡å®ä½:= ä½0 >= D90åº AND é«0 <= D90é¡¶;\nçå¸: IF(å¤å¤´å®ä½ == 1, 100, 1), COLORRED, NODRAW;\nçå¸: IF(ç©ºå¤´å®ä½ == 1, 100, 1), COLORGREEN, NODRAW;\néè¡: IF(éè¡å®ä½ == 1, 100, 1), COLORGRAY, NODRAW;\nSTICKLINE(å¤å¤´å®ä½ == 1, 100, 1, 100, 0), COLORRED;\nSTICKLINE(ç©ºå¤´å®ä½ == 1, 100, 1, 100, 0), COLORGREEN;\nSTICKLINE(éè¡å®ä½ == 1, 100, 1, 100, 0), COLORGRAY;"};return t},B.prototype.Zealink_Index3=function(){var t={Name:"æä»ä¿¡å·",Description:"æä»ä¿¡å·",IsMainIndex:!0,Args:[],Script:'ä¹°çº¿:=EMA(C,2);\nåçº¿:=EMA(SLOPE(C,30)*5+C,20); \nBU:=CROSS(ä¹°çº¿,åçº¿);\nSEL:=CROSS(åçº¿,ä¹°çº¿);\n\nSTICKLINE(ä¹°çº¿>=åçº¿ AND CLOSE>OPEN,LOW,HIGH,0,1),COLORRED;\nSTICKLINE(ä¹°çº¿>=åçº¿ AND CLOSE<OPEN,LOW,HIGH,0,1),COLORRED;\nSTICKLINE(ä¹°çº¿>=åçº¿ AND CLOSE>OPEN,CLOSE,OPEN,50,1),COLORRED;\nSTICKLINE(ä¹°çº¿>=åçº¿ AND CLOSE<OPEN,CLOSE,OPEN,50,0),COLORRED;\nSTICKLINE(ä¹°çº¿<åçº¿ AND CLOSE<OPEN,LOW,HIGH,0,1),COLORGREEN;\nSTICKLINE(ä¹°çº¿<åçº¿ AND CLOSE>OPEN,LOW,HIGH,0,1),COLORGREEN;\nSTICKLINE(ä¹°çº¿<åçº¿ AND CLOSE<OPEN,CLOSE,OPEN,50,0),COLORGREEN;\nSTICKLINE(ä¹°çº¿<åçº¿ AND CLOSE>OPEN,CLOSE,OPEN,50,1),COLORGREEN;\n\nHHJSJDA:=(3*CLOSE+OPEN+LOW+HIGH)/6;\nHHJSJDB:(19*HHJSJDA+19*REF(HHJSJDA,1)+18*REF(HHJSJDA,2)+17*REF(HHJSJDA,3)+16*REF(HHJSJDA,4)+15*REF(HHJSJDA,5)+14*REF(HHJSJDA,6)\n+13*REF(HHJSJDA,7)+12*REF(HHJSJDA,8)+11*REF(HHJSJDA,9)+10*REF(HHJSJDA,10)+9*REF(HHJSJDA,11)+8*REF(HHJSJDA,12)+7*REF(HHJSJDA,13)+6*REF(HHJSJDA,14)+5*REF(HHJSJDA,15)+4*REF(HHJSJDA,16)+3*REF(HHJSJDA,17)+2*REF\n(HHJSJDA,20)+REF(HHJSJDA,19))/210,COLORYELLOW;\nHHJSJDC:MA(HHJSJDB,5),COLORRED;\n\nSVAR11:=HHV(HIGH,34);\nSVAR14:=CLOSE-REF(CLOSE,1);\nSVAR15:=MAX(SVAR14,0);\nSVAR16:=ABS(SVAR14);\nSVAR17:=SMA(SVAR15,7,1)/SMA(SVAR16,7,1)*100;\nSVAR18:=SMA(SVAR15,13,1)/SMA(SVAR16,13,1)*100;\nSVAR19:=BARSCOUNT(CLOSE);\nSVAR20:=SMA(MAX(SVAR14,0),6,1)/SMA(ABS(SVAR14),6,1)*100;\nSVAR21:=(-200)*(HHV(HIGH,60)-CLOSE)/(HHV(HIGH,60)-LLV(LOW,60))+100;\nSVAR1A:=(CLOSE-LLV(LOW,15))/(HHV(HIGH,15)-LLV(LOW,15))*100;\nSVAR1B:=SMA((SMA(SVAR1A,4,1)-50)*2,3,1);\nSVAR1C:=(INDEXC-LLV(INDEXL,14))/(HHV(INDEXH,14)-LLV(INDEXL,14))*100;\nSVAR1D:=SMA(SVAR1C,4,1);\nSVAR1E:=SMA(SVAR1D,3,1);\nSVAR1F:=(HHV(HIGH,30)-CLOSE)/CLOSE*100;\nSVAR22:=SVAR20<=25 AND SVAR21<-95 AND SVAR1F>20 AND SVAR1B<-30 AND SVAR1E<30 AND SVAR11-CLOSE>=-0.25 AND SVAR17<22 AND SVAR18<28 AND SVAR19>50;\nBUY3:=CROSS(SVAR22,0.5) AND COUNT(SVAR22==1,10)==1;\n\nSVARF:=LOW*0.9;\nSVAR10X:=100-3*SMA((OPEN-LLV(LOW,75))/(HHV(HIGH,75)-LLV(LOW,75))*100,20,1)+2*SMA(SMA((OPEN-LLV(LOW,75))/(HHV(HIGH,75)-LLV(LOW,75))*100,20,1),15,1);\nSVAR11X:=SVARF<REF(SVAR10X,1) AND VOL>REF(VOL,1) AND CLOSE>REF(CLOSE,1);\nBUY2:=SVAR11X AND COUNT(SVAR11X,30)==1;\n\nVAR1:=(CLOSE+HIGH+LOW+OPEN)/4;\nVAR2:=SUMBARS(VOL,CAPITAL);\nVAR3:=HHV(VAR1,VAR2);\nVAR4:=LLV(VAR1,VAR2);\nVAR5:=(2*VAR1-VAR4-REF(VAR4,1))/(VAR3-VAR4);\nVAR6:=(VAR1-VAR4)/(VAR3-VAR4);\nVAR7:=IF(VAR1<=VAR4,VAR5*60,VAR6*60);\nVAR8:=600*(EMA(CLOSE,3)-EMA(LOW,30))/EMA(LOW,30);\nVAR9:=EMA(VAR8,7);\nVARC:=HHV(HIGH,9)-LLV(LOW,9);\nVARD:=HHV(HIGH,9)-CLOSE;\nVARE:=CLOSE-LLV(LOW,9);\nVARF:=VARD/VARC*100-70;\nVAR10:=(CLOSE-LLV(LOW,60))/(HHV(HIGH,60)-LLV(LOW,60))*100;\nVAR11:=(2*CLOSE+HIGH+LOW)/4;\nVAR12:=SMA(VARE/VARC*100,3,1);\nVAR13:=LLV(LOW,34);\nVAR14:=SMA(VAR12,3,1)-SMA(VARF,9,1);\nVAR15:=IF(VAR14>100,VAR14-100,0);\nVAR16:=HHV(HIGH,34);\nVAR17:=EMA((VAR11-VAR13)/(VAR16-VAR13)*100,8);\nVAR18:=EMA(VAR17,5);\nBUY:=STICKLINE(VAR17-VAR18>0,VAR17,VAR18,8,1),COLORRED;\nSELL:=STICKLINE(VAR17-VAR18<0,VAR17,VAR18,8,1),COLORGREEN;\nBUY1:=VAR17>VAR18 AND REF(VAR17,1)<REF(VAR18,1);\nSELL1:=VAR17<VAR18 AND REF(VAR17,1)>REF(VAR18,1);\n\nç­é«H:=(20*H+19*REF(H,1)+18*REF(H,2)+17*REF(H,3)+16*REF(H,4)+15*REF(H,5)+14*REF(H,6)\n+13*REF(H,7)+12*REF(H,8)+11*REF(H,9)+10*REF(H,10)+9*REF(H,11)+8*REF(H,12)\n+7*REF(H,13)+6*REF(H,14)+5*REF(H,15)+4*REF(H,16)+3*REF(H,17)+2*REF(H,18)+\nREF(H,20))/210,COLORBLUE,LINETHICK1;\nç­ä½L:=(20*L+19*REF(L,1)+18*REF(L,2)+17*REF(L,3)+16*REF(L,4)+15*REF(L,5)+14*REF(L,6)\n+13*REF(L,7)+12*REF(L,8)+11*REF(L,9)+10*REF(L,10)+9*REF(L,11)+8*REF(L,12)\n+7*REF(L,13)+6*REF(L,14)+5*REF(L,15)+4*REF(L,16)+3*REF(L,17)+2*REF(L,18)+\nREF(L,20))/210,COLORBLUE,LINETHICK1;\nD90H:=EMA(ç­é«H,90),COLORRED,LINETHICK1;\nD90L:=EMA(ç­ä½L,90),COLORRED,LINETHICK1;\nD90å·®:=D90H-D90L;\nD90é¡¶:=D90H+D90å·®*2,COLORRED,LINETHICK1;\nD90åº:=D90L-D90å·®*2,COLORRED,LINETHICK1;\né«0:=(EMA(EMA(H,25),25)-EMA(EMA(L,25),25))*1+EMA(EMA(H,25),25),LINETHICK1,COLORWHITE;\nä½0:=EMA(EMA(L,25),25)-(EMA(EMA(H,25),25)-EMA(EMA(L,25),25))*1,LINETHICK1,COLORWHITE;\nå¤å¤´å®ä½:=ä½0>=D90åº AND é«0>=D90é¡¶;\nç©ºå¤´å®ä½:=é«0<=D90é¡¶ AND ä½0<=D90åº;\néè¡å®ä½:=ä½0>=D90åº AND é«0<=D90é¡¶;\n\nçå¸:=å¤å¤´å®ä½==1;\nçå¸:=ç©ºå¤´å®ä½==1;\néè¡:=éè¡å®ä½==1;\n\néçå¸:=çå¸ OR éè¡;\néçå¸:=çå¸ OR éè¡;\n\nBUY11:=BUY1 AND éçå¸;\nSELL11:=SELL1 AND éè¡å®ä½==0;\n\nBUY111:=BUY11 AND COUNT(BUY11,10)<2;\nBUY0:=BUY111 AND COUNT(BUY111,21)==1;\nSELL111:=SELL11 AND COUNT(SELL11,10)<2;\nSELL0:=SELL111 AND COUNT(SELL111,10)==1;\n\nXK1:=EMA(100*(CLOSE-LLV(LOW,34))/(HHV(HIGH,34)-LLV(LOW,34)),3)/4;\nä¸ç©¿:=REF(XK1,1)<5 AND XK1>=5;\nBUY4:=ä¸ç©¿ AND COUNT(XK1<2,12)<1;\n\nSELL2:=REF(XK1,1)<=22.5 AND XK1>22.5 AND COUNT(REF(XK1,1)>=22.5 AND XK1<22.5,5)>0;\nSELL3:=REF(XK1,1)>=21.5 AND XK1<21.5 AND COUNT(REF(XK1,1)>=22.5 AND XK1<22.5,12)>1;\nSELL4:=SELL2 OR SELL3 AND COUNT((SELL2 OR SELL3)==1,5)==1;\n\nSUPERDRAWTEXT(BUY0,L,"æºä¼",2,10),COLORRED;\nSUPERDRAWTEXT(SELL0,H,"é£é©",1,10),COLORGREEN;\nSUPERDRAWTEXT(BUY2,L,"æºä¼",2,10),COLORRED;\nSUPERDRAWTEXT(BUY4,L,"æºä¼",2,10),COLORRED;\nSUPERDRAWTEXT(SELL4,H,"é£é©",1,10),COLORGREEN;'};return t},B.prototype.Zealink_Index4=function(){var t={Name:"è¡ä¸å®éå¢åæ",Description:"è¡ä¸å®éå¢åæ",IsMainIndex:!1,FloatPrecision:0,Args:[],Script:"å¢æ:NEWS(4),NODRAW,COLORRED;\nåæ:NEWS(5),NODRAW,COLORGREEN;\nSTICKLINE(å¢æ>0,0,å¢æ,1,0),COLORRED;\nSTICKLINE(åæ<0,0,åæ,1,0),COLORGREEN;"};return t},B.prototype.Zealink_Index5=function(){var t={Name:"å¤§å®äº¤æ",Description:"å¤§å®äº¤æ",IsMainIndex:!1,FloatPrecision:0,Args:[],Script:"äº¤ææ¬¡æ°:NEWS(7);"};return t},B.prototype.Zealink_Index6=function(){var t={Name:"ä¿¡ææè¡",Description:"ä¿¡ææè¡",IsMainIndex:!1,FloatPrecision:0,Args:[],Script:"å®¶æ°:NEWS(6);"};return t},B.prototype.Zealink_Index7=function(){var t={Name:"å®ç½æ°é»",Description:"å®ç½æ°é»",IsMainIndex:!1,FloatPrecision:0,Args:[],Script:"ä¸ªæ°:NEWS(8);"};return t},B.prototype.Zealink_Index8=function(){var t={Name:"é«ç®¡è¦é»",Description:"é«ç®¡è¦é»",IsMainIndex:!1,FloatPrecision:0,Args:[],Script:"ä¸ªæ°:NEWS(9);"};return t},B.prototype.Zealink_Index9=function(){var t={Name:"è¡æè´¨æ¼",Description:"è¡æè´¨æ¼",IsMainIndex:!1,FloatPrecision:0,Args:[],Script:"æ¬¡æ°:NEWS(10);"};return t},B.prototype.Zealink_Index10=function(){var t={Name:"æçBSç¹",Description:"æçBSç¹",IsMainIndex:!0,FloatPrecision:0,Args:[],Script:"JJ:=(CLOSE+HIGH+LOW)/3; \nA:=EMA(JJ,10); \nB:=REF(A,1);\nM1:=EMA(CLOSE,3);\nM2:=EMA(CLOSE,8); \nM3:=EMA(M2,13); \nM4:=EMA(M2,55); \nB1:=A>B AND REF(A,1)<REF(B,1);\nS1:=A<B AND REF(A,1)>REF(B,1);\nINDEXCLOSE:INDEXC,EXDATA;\nINDEXOPEN:INDEXO,EXDATA;\nDRAWICON(REF(B1,1),L*0.97,13);\nDRAWICON(REF(S1,1),H*1.03,14);"};return t},B.prototype.Zealink_Index11=function(){var t={Name:"æçBSç¹",Description:"æçBSç¹",IsMainIndex:!0,FloatPrecision:0,Args:[],Script:"JJ:=(CLOSE+HIGH+LOW)/3;\nA:=EMA(JJ,10);\nB:=REF(A,1);\nM1:=EMA(CLOSE,3);\nM2:=EMA(CLOSE,8); \nM3:=EMA(M2,13);\nM4:=EMA(M2,55);\næè¡åºå:=STICKLINE(A>B,A,B,2,0),COLORYELLOW; \næå¸åºå:=STICKLINE(A<B,A,B,2,0),COLORBLUE;\n\nVR1:=(C+O+REF(C,1))/3;\nVR3:=HHV(VR1,21);\nVR4:=LLV(VR1,21);\nVR5:=(2*VR1-VR4-REF(VR4,1))/(VR3-VR4);\nVR6:=(VR1-VR4)/(VR3-VR4);\nVR7:=IF(VR1<=VR4,VR5*60,VR6*60);\nVR8:=600*(EMA(C,3)-EMA(L,30))/EMA(L,30);\nVR9:=EMA(VR8,7);\nVRA:=(WINNER(120*C/100)-WINNER(100*C/100))*100;\nVRB:=(-100)*(WINNER(120*C/100)-WINNER(100*C/100))+5;\nVRC:=HHV(H,9)-LLV(L,9);\nVRD:=HHV(H,9)-C;\nVRE:=C-LLV(L,9);\nVRF:=VRD/VRC*100-70;\nVR10:=(C-LLV(L,60))/(HHV(H,60)-LLV(L,60))*100;\nVR11:=(2*C+H+L)/4;\nVR12:=SMA(VRE/VRC*100,3,1);\nVR13:=LLV(L,34);\nVR14:=SMA(VR12,3,1)-SMA(VRF,9,1);\nVR15:=IF(VR14>100,VR14-100,0);\nVR16:=HHV(H,34);\nVR17:=EMA((VR11-VR13)/(VR16-VR13)*100,8);\nVR18:=EMA(VR17,5);\n\nB1:=A>B AND REF(A,1)<REF(B,1);\nS1:=A<B AND REF(A,1)>REF(B,1);\n\nB9:=BARSLAST(REF(B1,1) AND (REF(VR17>VR18,1) OR MIN(VR17,VR18)>REF(MAX(VR17,VR18),1)));\nS9:=BARSLAST(REF(S1,1) AND (REF(VR17<VR18,1) OR MAX(VR17,VR18)<REF(MIN(VR17,VR18),1)));\n\nDRAWICON(REF(B1,1) AND (REF(VR17>VR18,1) OR MIN(VR17,VR18)>REF(MAX(VR17,VR18),1)) AND REF(B9,2)>=S9,L*0.97,13);\nDRAWICON(REF(S1,1) AND (REF(VR17<VR18,1) OR MAX(VR17,VR18)<REF(MIN(VR17,VR18),1)) AND REF(S9,1)>=B9,H*1.03,14);\n\nDRAWKLINE_IF(VR17>VR18,HIGH,CLOSE,LOW,OPEN),COLORRED;\nDRAWKLINE_IF(VR17<VR18,HIGH,CLOSE,LOW,OPEN),COLORBLUE;\n\nINDEXCLOSE:INDEXC,EXDATA;\t\t//åææ°çæ¶çä»· åæµçæ¶åè®¡ç®BATEç³»æ°ç¨ "};return t},B.prototype.HeikinAshi=function(){var t={Name:"å¹³åKçº¿",Description:"Heikin-Ashi å¹³åKçº¿",IsMainIndex:!0,KLineType:-1,Args:[],Script:"HCLOSE:(OPEN+HIGH+LOW+CLOSE)/4, NODRAW;\nHOPEN:(REF(OPEN,1)+REF(CLOSE,1))/2,NODRAW;\nHHIGH:MAX(HIGH,MAX(HOPEN,HCLOSE)),NODRAW;\nHLOW:MIN(LOW,MIN(HOPEN,HCLOSE)),NODRAW;\nDRAWKLINE(HHIGH,HOPEN,HLOW,HCLOSE);"};return t},B.prototype.ADL=function(){var t={Name:"è¾è½ææ ",Description:"è¾è½ææ ",IsMainIndex:!1,StringFormat:2,Condition:{Period:[R.KLINE_DAY_ID,R.KLINE_WEEK_ID,R.KLINE_TWOWEEK_ID,R.KLINE_MONTH_ID,R.KLINE_QUARTER_ID,R.KLINE_YEAR_ID],Include:["000001.SH","000003.SH","000016.SH","000300.SH","000905.SH","399001.SZ"," 399005.SZ","399006.SZ"]},Args:[{Name:"M",Value:7}],Script:"ADL:SUM(ADVANCE-DECLINE,0);\nMAADL:MA(ADL,M);"};return t},B.prototype.EMPTY=function(){var t={Name:"",Description:"ç©ºææ ",IsMainIndex:!0,Args:[],Script:"VAR2:=C;"};return t},B.prototype.CJL=function(){var t={Name:"CJL",Description:"æè´§æä»é",IsMainIndex:!1,Args:[],Script:"æäº¤é:VOL,VOLSTICK;\næä»é:VOLINSTK,LINEOVERLAY;"};return t},B.prototype.ASI=function(){var t={Name:"ASI",Description:"æ¯å¨åéææ ",IsMainIndex:!1,Args:[{Name:"N1",Value:6}],Script:"X_1:=REF(CLOSE,1);\nX_2:=ABS(HIGH-X_1);\nX_3:=ABS(LOW-X_1);\nX_4:=ABS(HIGH-REF(LOW,1));\nX_5:=ABS(X_1-REF(OPEN,1));\nX_6:=IF(X_2>X_3 AND X_2>X_4,X_2+X_3/2+X_5/4,IF(X_3>X_4 AND X_3>X_2,X_3+X_2/2+X_5/4,X_4+X_5/4));\nX_7:=CLOSE-X_1+(CLOSE-OPEN)/2+X_1-REF(OPEN,1);\nX_8:=8*X_7/X_6*MAX(X_2,X_3);\nASI:SUM(X_8,0),LINETHICK2;\nMASI:MA(ASI,N1),LINETHICK2;"};return t},B.prototype.DC=function(){var t={Name:"DC",Description:"åå¥å®éé",IsMainIndex:!0,Args:[{Name:"N1",Value:20}],Script:"UPPER:HHV(H,N1),COLORBLUE,LINETHICK2;\nLOWER:LLV(L,N1),COLORBLUE,LINETHICK2;\nMIDDLE:(UPPER+LOWER)/2,COLORRED,LINETHICK3;"};return t},B.prototype.DEMA=function(){var t={Name:"DEMA",Description:"åéææ°ç§»å¨åçº¿",IsMainIndex:!0,Args:[{Name:"N1",Value:10}],Script:"ERR:=C-EMA(C,N1);\nDEMA:EMA(C,10)+EMA(ERR,N1);"};return t},B.prototype.VWAP=function(){var t={Name:"VWAP",Description:"æäº¤éå æå¹³åä»·",IsMainIndex:!0,Args:[{Name:"N1",Value:10}],Script:"PRICE:=(H+L+C)/3;\nT2:=VOL*PRICE;\nVWAP:SUM(T2,0)/SUM(VOL,0);"};return t},B.prototype.SQJZ=function(){var t={Name:"SQJZ",Description:"ç¥å¥ä¹è½¬",IsMainIndex:!0,Script:"B:=C<REF(C,4);\nN:=CURRBARSCOUNT;\nB1:=(N=6 AND REFXV(COUNT(B,6),5)=6) OR (N=7 AND REFXV(COUNT(B,7),6)=7) OR (N=8 AND REFXV(COUNT(B,8),7)=8) OR (N>=9 AND REFXV(COUNT(B,9),8)=9);\nDRAWNUMBER(B1 AND REF(B,1)=0,L,1),COLORMAGENTA;\nB2:=(N=5 AND REFXV(COUNT(B,6),4)=6) OR (N=6 AND REFXV(COUNT(B,7),5)=7) OR (N=7 AND REFXV(COUNT(B,8),6)=8) OR (N>=8 AND REFXV(COUNT(B,9),7)=9);\nDRAWNUMBER(B2 AND REF(B,2)=0,L,2),COLORMAGENTA;\nB8:=(N=1 AND COUNT(B,8)=8) OR (N>=2 AND REFXV(COUNT(B,9),1)=9);\nDRAWNUMBER(B8 AND REF(B,8)=0,L,8),COLORMAGENTA;\nB9:=(N>=1 AND COUNT(B,9)=9);\nDRAWNUMBER(B9 AND REF(B,9)=0,L,9),COLORBROWN;\nS:=C>REF(C,4);\nS1:=(N=6 AND REFXV(COUNT(S,6),5)=6) OR (N=7 AND REFXV(COUNT(S,7),6)=7) OR (N=8 AND REFXV(COUNT(S,8),7)=8) OR (N>=9 AND REFXV(COUNT(S,9),8)=9);\nDRAWNUMBER(S1 AND REF(S,1)=0,H,1),COLORMAGENTA,DRAWABOVE;\nS2:=(N=5 AND REFXV(COUNT(S,6),4)=6) OR (N=6 AND REFXV(COUNT(S,7),5)=7) OR (N=7 AND REFXV(COUNT(S,8),6)=8) OR (N>=8 AND REFXV(COUNT(S,9),7)=9);\nDRAWNUMBER(S2 AND REF(S,2)=0,H,2),COLORMAGENTA,DRAWABOVE;\nS8:=(N=1 AND COUNT(S,8)=8) OR (N>=2 AND REFXV(COUNT(S,9),1)=9);\nDRAWNUMBER(S8 AND REF(S,8)=0,H,8),COLORMAGENTA,DRAWABOVE;\nS9:=(N>=1 AND COUNT(S,9)=9);\nDRAWNUMBER(S9 AND REF(S,9)=0,H,9),COLORGREEN,DRAWABOVE;"};return t},B.prototype.XT=function(){var t={Name:"XT",Description:"ç®±ä½",IsMainIndex:!0,Args:[{Name:"N",Value:10}],Script:"ãç®±é¡¶ã:PEAK(CLOSE,N,1)*0.98;\nãç®±åºã:TROUGH(CLOSE,N,1)*1.02;\nãç®±é«ã:100*(ãç®±é¡¶ã-ãç®±åºã)/ãç®±åºã,NODRAW;"};return t},B.prototype.CFJT=function(){var t={Name:"CFJT",Description:"è´¢å¯é¶æ¢¯",IsMainIndex:!0,Script:"çªç ´:=REF(EMA(C,14),1);\nA1X:=(EMA(C,10)-çªç ´)/çªç ´*100;\nå¤æ¹:=IF(A1X>=0,REF(EMA(C,10),BARSLAST(CROSS(A1X,0))+1),DRAWNULL);\nç©ºæ¹:=IF(A1X<0,REF(EMA(C,10),BARSLAST(CROSS(0,A1X))+1),DRAWNULL);\nSTICKLINE(A1X>=0,å¤æ¹,çªç ´,110,0),COLORRED;\nSTICKLINE(A1X<0,ç©ºæ¹,çªç ´,110,0),COLORGREEN;"};return t},B.prototype.CYX=function(){var t={Name:"CYX",Description:"æåçº¿",IsMainIndex:!0,Args:[{Name:"N",Value:7}],Script:"Z1:=STRCAT(HYBLOCK,' ');\nZ2:=STRCAT(Z1,DYBLOCK);\nZ3:=STRCAT(Z2,' ');\nDRAWTEXT_FIX(ISLASTBAR,0,0,0,STRCAT(Z3,GNBLOCK)),COLOR00C0C0;\nA1:=REF(H,N)=HHV(H,2*N+1);\nB1:=FILTER(A1,N);\nC1:=BACKSET(B1,N+1);\nD1:=FILTER(C1,N);\nA2:=REF(L,N)=LLV(L,2*N+1);\nB2:=FILTER(A2,N);\nC2:=BACKSET(B2,N+1);\nD2:=FILTER(C2,N);\nE1:=(REF(LLV(L,2*N),1)+REF(HHV(H,2*N),1))/2;\nE2:=(H+L)/2;\nH1:=(D1 AND NOT(D2 AND E1>=E2)) OR ISLASTBAR OR BARSCOUNT(C)=1;\nL1:=(D2 AND NOT(D1 AND E1<E2));\nH2:=D1 AND NOT(D2 AND E1>=E2);\nX1:=REF(BARSLAST(H1),1)+1;\nF1:=BACKSET(H1 AND COUNT(L1,X1)>0,LLVBARS(IF(L1,L,10000),X1));\nG1:=F1>REF(F1,1);\nI1:=BACKSET(G1,2);\nLD:=I1>REF(I1,1);\nL2:=LD OR ISLASTBAR OR BARSCOUNT(C)=1;\nX2:=REF(BARSLAST(L2),1)+1;\nF2:=BACKSET(L2 AND COUNT(H2,X2)>0,HHVBARS(IF(H2,H,0),X2));\nG2:=F2>REF(F2,1);\nI2:=BACKSET(G2,2);\nHD:=I2>REF(I2,1);\nR1:=BACKSET(ISLASTBAR,BARSLAST(HD)+1);\nS1:=R1>REF(R1,1);\nT1:=BACKSET(ISLASTBAR,BARSLAST(LD)+1);\nU1:=T1>REF(T1,1);\nR2:=BACKSET(S1,REF(BARSLAST(HD),1)+2);\nS2:=R2>REF(R2,1);\nT2:=BACKSET(U1,REF(BARSLAST(LD),1)+2);\nU2:=T2>REF(T2,1);\nDRAWLINE(S2,H,S1,H,1),LINETHICK2,COLORRED;\nDRAWLINE(U2,L,U1,L,1),LINETHICK2,COLORGREEN;"};return t},B.prototype.WAVE=function(){var t={Name:"WAVE",Description:"æ³¢æµªåæ",IsMainIndex:!0,Args:[{Name:"N",Value:5}],Script:"ZIG(3,N);"};return t},B.prototype.ShareholderCount=function(){var t={Name:"æ£æ·çº¿",Description:"æ£æ·çº¿",IsMainIndex:!1,Script:"GPJYVALUE(1,1,1);"};return t},B.prototype.NXTS=function(){var t={Name:"NXTS",Description:"ççå¤©æ°",IsMainIndex:!1,Args:[{Name:"N",Value:20}],Script:"Z:=ZIG(C,N);\né«ç¹:=Z>REF(Z,1) AND Z>REFX(Z,1);\nä½ç¹:=Z<REF(Z,1) AND Z<REFX(Z,1);\nNG:=BARSLAST(é«ç¹);\nND:=BARSLAST(ä½ç¹);\nD0:=DATETODAY(DATE)-DATETODAY(REF(DATE,BARSSINCE(C)));\nDG:=DATETODAY(DATE)-DATETODAY(REF(DATE,NG));\nDD:=DATETODAY(DATE)-DATETODAY(REF(DATE,ND));\nN1:=(NG>ND OR COUNT(é«ç¹,0)=0) AND ND>0 AND (HHV(C,ND)-REF(C,ND))/REF(C,ND)>(N/100);\nN2:=NG<ND AND NG>0 AND (LLV(C,NG)-REF(C,NG))/REF(C,NG)>=-(N/100);\nN3:=NG<ND AND NG=0;\nN4:=COUNT(ä½ç¹ OR é«ç¹,0)=0 AND (HHV(C,0)-REF(C,BARSSINCE(C)))/REF(C,BARSSINCE(C))>(N/100);\nN5:=COUNT(ä½ç¹,0)=0 AND NG>0 AND (LLV(C,NG)-REF(C,NG))/REF(C,NG)>=-(N/100);\nN6:=COUNT(ä½ç¹,0)=0 AND NG=0;\nX1:=(NG<ND OR COUNT(ä½ç¹,0)=0) AND NG>0 AND (LLV(C,NG)-REF(C,NG))/REF(C,NG)<-(N/100);\nX2:=NG>ND AND ND>0 AND (HHV(C,ND)-REF(C,ND))/REF(C,ND)<=(N/100);\nX3:=NG>ND AND ND=0;\nX4:=COUNT(é«ç¹ OR ä½ç¹,0)=0 AND (LLV(C,0)-REF(C,BARSSINCE(C)))/REF(C,BARSSINCE(C))<-(N/100);\nX5:=COUNT(é«ç¹,0)=0 AND ND>0 AND (HHV(C,ND)-REF(C,ND))/REF(C,ND)<=(N/100);\nX6:=COUNT(é«ç¹,0)=0 AND ND=0;\nçå¸å¤©æ°:IF(N4 OR N5 OR N6,D0,IF(N1 OR N2 OR N3,DD,0)),COLORRED;\nçå¸å¤©æ°:IF(X4 OR X5 OR X6,D0,IF(X1 OR X2 OR X3,DG,0)),COLORGREEN;"};return t},B.prototype.FKX=function(){var t={Name:"FKX",Description:"åKçº¿",IsMainIndex:!1,Script:"DRAWKLINE(-LOW, -OPEN, -HIGH, -CLOSE);"};return t},B.prototype.Margin4=function(){var t={Name:"ä¸¤èèµé",Description:"ä¸¤èèµé",IsMainIndex:!1,Script:"TMPV:=IF(FINANCE(3)==0,REF(SCJYVALUE(1,1,1),1),REF(GPJYVALUE(3,1,1),1));\nTMPV1:=IF(FINANCE(3)==0,SCJYVALUE(1,1,0),GPJYVALUE(3,1,0));\nä¸¤è:IF(TMPV==0 OR TMPV1==0,DRAWNULL,IF(FINANCE(3)==0,(SCJYVALUE(1,1,1)-REF(SCJYVALUE(1,1,1),1))/10000-(SCJYVALUE(1,2,1)-REF(SCJYVALUE(1,2,1),1))/10000,((GPJYVALUE(3,1,1)-REF(GPJYVALUE(3,1,1),1))-((GPJYVALUE(3,2,1)*C/10000-(REF(GPJYVALUE(3,2,1),1)*REF(C,1)/10000)))))),NODRAW;\nSTICKLINE(ä¸¤è>0,0,ä¸¤è,2,0),COLORRED;\nSTICKLINE(ä¸¤è<0,0,ä¸¤è,2,0),COLORCYAN;"};return t},B.prototype.ZSDB=function(){var t={Name:"ZSDB",Description:"ææ°å¯¹æ¯(å¯å¾,éä¸è½½æ¥çº¿)",IsMainIndex:!1,Script:"A:=REF(INDEXC,1);\nææ°æ¶¨å¹:IF(A>0,(INDEXC-A)*100/A,0),NODRAW;\nDRAWKLINE(INDEXH,INDEXO,INDEXL,INDEXC);"};return t},B.prototype.NineTurns=function(){var t={Name:"ç¥å¥ä¹è½¬",Description:"ä¹è½¬ææ ",IsMainIndex:!0,Script:"A1:=C>REF(C,4);\nA2:=C<REF(C,4);\nT1:=A2 AND REF(A1,1);\nT2:=A2 AND REF(T1,1);\nT3:=A2 AND REF(T2,1);\nT4:=A2 AND REF(T3,1);\nT5:=A2 AND REF(T4,1);\nT6:=A2 AND REF(T5,1);\nT7:=A2 AND REF(T6,1);\nT8:=A2 AND REF(T7,1);\nT9:=A2 AND REF(T8,1);\nT10:=A2 AND REF(T9,1);\nT11:=A2 AND REF(T10,1);\nT12:=A2 AND REF(T11,1);\nT13:=A2 AND REF(T12,1);\nT14:=A2 AND REF(T13,1);\nDRAWTEXT(T1,L*0.98,'1'),COLORGREEN;\nDRAWTEXT(T2,L*0.98,'2'),COLORGREEN;\nDRAWTEXT(T3,L*0.98,'3'),COLORGREEN;\nDRAWTEXT(T4,L*0.98,'4'),COLORGREEN;\nDRAWTEXT(T5,L*0.98,'5'),COLORGREEN;\nDRAWTEXT(T6,L*0.98,'6'),COLORGREEN;\nDRAWTEXT(T7,L*0.98,'7'),COLORGREEN;\nDRAWTEXT(T8,L*0.98,'8'),COLORGREEN;\nDRAWTEXT(T9,L*0.98,'9'),COLORBLUE;\nB1:=C<REF(C,4);\nB2:=C>REF(C,4);\nD1:=B2 AND REF(B1,1);\nD2:=B2 AND REF(D1,1);\nD3:=B2 AND REF(D2,1);\nD4:=B2 AND REF(D3,1);\nD5:=B2 AND REF(D4,1);\nD6:=B2 AND REF(D5,1);\nD7:=B2 AND REF(D6,1);\nD8:=B2 AND REF(D7,1);\nD9:=B2 AND REF(D8,1);\nD10:=B2 AND REF(D9,1);\nD11:=B2 AND REF(D10,1);\nD12:=B2 AND REF(D11,1);\nD13:=B2 AND REF(D12,1);\nD14:=B2 AND REF(D13,1);\nDRAWTEXT(D1,H*1.010,'1'),COLORBLUE;\nDRAWTEXT(D2,H*1.010,'2'),COLORBLUE;\nDRAWTEXT(D3,H*1.010,'3'),COLORBLUE;\nDRAWTEXT(D4,H*1.010,'4'),COLORBLUE;\nDRAWTEXT(D5,H*1.010,'5'),COLORBLUE;\nDRAWTEXT(D6,H*1.010,'6'),COLORBLUE;\nDRAWTEXT(D7,H*1.010,'7'),COLORBLUE;\nDRAWTEXT(D8,H*1.010,'8'),COLORBLUE;\nDRAWTEXT(D9,H*1.010,'9'),COLORGREEN;"};return t},B.prototype.TEST=function(){var t={Name:"TEST",Description:"æµè¯èæ¬",IsMainIndex:!1,Args:[{Name:"N",Value:10}],Script:"DRAWCHANNEL(OPEN>C,H,L, 'RGB(255,94,102)', 2 ,'5,5','RGBA(58,20,62,0.3)' );"};return t},!w)w={Chart:{Log:console.log,Warn:console.warn},Complier:{Log:console.log,Warn:console.warn}};function V(t,e){this.DivElement=t,this.DivToolElement=null,this.JSChartContainer,this.CanvasElement=document.createElement("canvas"),this.CanvasElement.className="jschart-drawing",this.CanvasElement.id=q(),this.CanvasElement.setAttribute("tabindex",0),this.CanvasElement.style&&(this.CanvasElement.style.outline="none"),t.hasChildNodes()&&w.Chart.Log("[JSChart::JSChart] divElement hasChildNodes",t.childNodes),t.appendChild(this.CanvasElement),this.OffscreenCanvasElement,1==e&&(this.OffscreenCanvasElement=document.createElement("canvas")),this.ModifyIndexDialog=new xr(t),this.ChangeIndexDialog=new Fr(t),this.MinuteDialog=new yr(t),this.OnSize=function(t){var e=parseInt(this.DivElement.style.height.replace("px",""));this.ToolElement&&(e-=this.ToolElement.style.height.replace("px","")),this.CanvasElement.height=e,this.CanvasElement.width=parseInt(this.DivElement.style.width.replace("px","")),this.CanvasElement.style.width=this.CanvasElement.width+"px",this.CanvasElement.style.height=this.CanvasElement.height+"px";var a=U();this.CanvasElement.height*=a,this.CanvasElement.width*=a,this.OffscreenCanvasElement&&(this.OffscreenCanvasElement.height=this.CanvasElement.height,this.OffscreenCanvasElement.width=this.CanvasElement.width),w.Chart.Log("[JSChart::OnSize] devicePixelRatio="+window.devicePixelRatio+", height="+this.CanvasElement.height+", width="+this.CanvasElement.width),t&&0==t.Redraw||this.JSChartContainer&&(t&&!0===t.XYSplit&&this.JSChartContainer.ResetFrameXYSplit(),this.JSChartContainer.OnSize&&t&&1==t.Type?this.JSChartContainer.OnSize():(this.JSChartContainer.Frame&&this.JSChartContainer.Frame.SetSizeChage(!0),this.JSChartContainer.Draw()))},this.AdjustChartBorder=function(t){var e=U();if(t.Frame.ChartBorder.Left*=e,t.Frame.ChartBorder.Right*=e,t.Frame.ChartBorder.Top*=e,t.Frame.ChartBorder.Bottom*=e,t.Frame.AutoLeftBorder){var a=t.Frame.AutoLeftBorder;ha.IsNumber(a.MinWidth)&&(a.MinWidth*=e),ha.IsNumber(a.Blank)&&(a.Blank*=e)}if(t.Frame.AutoRightBorder){a=t.Frame.AutoRightBorder;ha.IsNumber(a.MinWidth)&&(a.MinWidth*=e),ha.IsNumber(a.Blank)&&(a.Blank*=e)}},this.AdjustTitleHeight=function(t){for(var e=U(),a=0;a<t.Frame.SubFrame.length;++a)t.Frame.SubFrame[a].Frame.ChartBorder.TitleHeight*=e;t.ChartCorssCursor.TextHeight*=e},this.SetChartBorder=function(t,e){if(e.Border){var a=e.Border;ha.IsNumber(e.Border.Left)?t.Frame.ChartBorder.Left=e.Border.Left:e.Border.Left=t.Frame.ChartBorder.Left,ha.IsNumber(e.Border.Right)?t.Frame.ChartBorder.Right=e.Border.Right:e.Border.Right=t.Frame.ChartBorder.Right,ha.IsNumber(e.Border.Top)?t.Frame.ChartBorder.Top=e.Border.Top:e.Border.Top=t.Frame.ChartBorder.Top,ha.IsNumber(e.Border.Bottom)?t.Frame.ChartBorder.Bottom=e.Border.Bottom:e.Border.Bottom=t.Frame.ChartBorder.Bottom,a.AutoLeft&&(t.Frame.AutoLeftBorder={},ha.IsNumber(a.AutoLeft.Blank)&&(t.Frame.AutoLeftBorder.Blank=a.AutoLeft.Blank),ha.IsNumber(a.AutoLeft.MinWidth)&&(t.Frame.AutoLeftBorder.MinWidth=a.AutoLeft.MinWidth)),a.AutoRight&&(t.Frame.AutoRightBorder={},ha.IsNumber(a.AutoRight.Blank)&&(t.Frame.AutoRightBorder.Blank=a.AutoRight.Blank),ha.IsNumber(a.AutoRight.MinWidth)&&(t.Frame.AutoRightBorder.MinWidth=a.AutoRight.MinWidth))}},this.CreateKLineChartContainer=function(t){var e=null;if(e="åå²Kçº¿å¾æ¨ªå±"===t.Type?new Wi(this.CanvasElement):new Gi(this.CanvasElement,this.OffscreenCanvasElement),t.NetworkFilter&&(e.NetworkFilter=t.NetworkFilter),e.ModifyIndexDialog=this.ModifyIndexDialog,e.ChangeIndexDialog=this.ChangeIndexDialog,e.MinuteDialog=this.MinuteDialog,1==t.IsShowRightMenu&&(e.RightMenu=new Nr(this.DivElement)),t.ScriptError&&(e.ScriptErrorCallback=t.ScriptError),e.SelectRectRightMenu=new wr(this.DivElement),1==t.EnableScrollUpDown&&(e.EnableScrollUpDown=t.EnableScrollUpDown),1==t.DisableMouse&&(e.DisableMouse=t.DisableMouse),t.TouchMoveMinAngle&&(e.TouchMoveMinAngle=t.TouchMoveMinAngle),t.EnableZoomUpDown&&(e.EnableZoomUpDown=t.EnableZoomUpDown),ha.IsString(t.SplashTitle)&&(e.LoadDataSplashTitle=t.SplashTitle),ha.IsBool(t.EnableZoomIndexWindow)&&(e.EnableZoomIndexWindow=t.EnableZoomIndexWindow),ha.IsBool(t.IsDrawPictureXY)&&(e.IsDrawPictureXY=t.IsDrawPictureXY),ha.IsNumber(t.CtrlMoveStep)&&(e.CtrlMoveStep=t.CtrlMoveStep),ha.IsBool(t.EnableIndexChartDrag)&&(e.EnableIndexChartDrag=t.EnableIndexChartDrag),t.EnableYDrag){var a=t.EnableYDrag;ha.IsBool(a.Left)&&(e.EnableYDrag.Left=a.Left),ha.IsBool(a.Right)&&(e.EnableYDrag.Right=a.Right)}if(t.KLine&&(t.KLine.DragMode>=0&&(e.DragMode=t.KLine.DragMode),t.KLine.Right>=0&&(e.Right=t.KLine.Right),t.KLine.Period>=0&&(e.Period=t.KLine.Period),t.KLine.MaxReqeustDataCount>0&&(e.MaxRequestDataCount=t.KLine.MaxReqeustDataCount),t.KLine.MaxRequestDataCount>0&&(e.MaxRequestDataCount=t.KLine.MaxRequestDataCount),t.KLine.Info&&t.KLine.Info.length>0&&e.SetKLineInfo(t.KLine.Info,!1),t.KLine.IndexTreeApiUrl&&(e.ChangeIndexDialog.IndexTreeApiUrl=t.KLine.IndexTreeApiUrl),0==t.KLine.KLineDoubleClick&&(e.MinuteDialog=this.MinuteDialog=null),null!=t.KLine.IndexTreeApiUrl&&(e.ChangeIndexDialog.IndexTreeApiUrl=t.KLine.IndexTreeApiUrl),0==t.KLine.IsShowTooltip&&(e.IsShowTooltip=!1),t.KLine.MaxRequestMinuteDayCount>0&&(e.MaxRequestMinuteDayCount=t.KLine.MaxRequestMinuteDayCount),t.KLine.DrawType&&(e.KLineDrawType=t.KLine.DrawType),t.KLine.FirstShowDate>19910101&&(e.CustomShow={Date:t.KLine.FirstShowDate,PageSize:t.KLine.PageSize}),t.KLine.RightSpaceCount>0&&(e.RightSpaceCount=t.KLine.RightSpaceCount),t.KLine.ZoomType>0&&(e.ZoomType=t.KLine.ZoomType),t.KLine.DataWidth>=1&&(e.KLineSize={DataWidth:t.KLine.DataWidth}),ha.IsNumber(t.KLine.RightFormula)&&(e.RightFormula=t.KLine.RightFormula)),t.EnableFlowCapital){a=t.EnableFlowCapital;1==a.BIT&&(e.EnableFlowCapital.BIT=a.BIT)}if(ha.IsBool(t.EnableBorderDrag)&&(e.EnableBorderDrag=t.EnableBorderDrag),t.Page&&(t.Page.Day&&1==t.Page.Day.Enable&&(e.Page.Day.Enable=!0),t.Page.Minute&&1==t.Page.Minute.Enable&&(e.Page.Minute.Enable=!0)),t.DragDownload&&(t.DragDownload.Day&&1==t.DragDownload.Day.Enable&&(e.DragDownload.Day.Enable=!0),t.DragDownload.Minute&&1==t.DragDownload.Minute.Enable&&(e.DragDownload.Minute.Enable=!0)),t.Language){var i=bi.GetLanguageID(t.Language);ha.IsNumber(i)&&(e.LanguageID=i)}if(t.SourceDatatLimit&&e.SetSourceDatatLimit(t.SourceDatatLimit),t.DrawPicture&&t.DrawPicture.StorageKey&&e.ChartDrawStorage&&e.ChartDrawStorage.Load(t.DrawPicture.StorageKey),t.DrawTool&&t.DrawTool.StorageKey&&e.ChartDrawStorage&&e.ChartDrawStorage.Load(t.DrawTool.StorageKey),ha.IsNumber(t.StepPixel)&&(e.StepPixel=t.StepPixel),t.ZoomStepPixel>0&&(e.ZoomStepPixel=t.ZoomStepPixel),1==t.IsApiPeriod&&(e.IsApiPeriod=t.IsApiPeriod),t.SelectedChart){a=t.SelectedChart;ha.IsBool(a.EnableSelected)&&(e.SelectedChart.EnableSelected=a.EnableSelected),ha.IsBool(a.EnableMoveOn)&&(e.SelectedChart.EnableMoveOn=a.EnableMoveOn)}if(!t.Windows||t.Windows.length<=0)return null;if(e.Create(t.Windows.length,t),this.SetChartBorder(e,t),this.AdjustChartBorder(e),t.KLine&&t.KLine.PageSize>0){var r=e.GetMaxMinPageSize();r.Max>10&&r.Max<t.KLine.PageSize?e.PageSize=r.Max:r.Min>10&&r.Min>t.KLine.PageSize?e.PageSize=r.Min:e.PageSize=t.KLine.PageSize}if(!0===t.IsCorssOnlyDrawKLine&&(e.ChartCorssCursor.IsOnlyDrawKLine=t.IsCorssOnlyDrawKLine),!0===t.CorssCursorTouchEnd&&(e.CorssCursorTouchEnd=t.CorssCursorTouchEnd),1==t.IsClickShowCorssCursor&&(e.IsClickShowCorssCursor=t.IsClickShowCorssCursor),t.CorssCursorInfo){a=t.CorssCursorInfo;isNaN(t.CorssCursorInfo.Left)||(e.ChartCorssCursor.ShowTextMode.Left=t.CorssCursorInfo.Left),isNaN(t.CorssCursorInfo.Right)||(e.ChartCorssCursor.ShowTextMode.Right=t.CorssCursorInfo.Right),isNaN(t.CorssCursorInfo.Bottom)||(e.ChartCorssCursor.ShowTextMode.Bottom=t.CorssCursorInfo.Bottom),!1===t.CorssCursorInfo.IsShowCorss&&(e.ChartCorssCursor.IsShowCorss=t.CorssCursorInfo.IsShowCorss),1==t.CorssCursorInfo.IsShowClose&&(e.ChartCorssCursor.IsShowClose=t.CorssCursorInfo.IsShowClose),t.CorssCursorInfo.PressTime&&(e.PressTime=t.CorssCursorInfo.PressTime),ha.IsNumber(t.CorssCursorInfo.HPenType)&&(e.ChartCorssCursor.HPenType=t.CorssCursorInfo.HPenType),t.CorssCursorInfo.VPenType>0&&(e.ChartCorssCursor.VPenType=t.CorssCursorInfo.VPenType),ha.IsNumber(a.VLineType)&&(e.ChartCorssCursor.VLineType=a.VLineType),t.CorssCursorInfo.DateFormatType>0&&(e.ChartCorssCursor.StringFormatX.DateFormatType=t.CorssCursorInfo.DateFormatType),ha.IsBool(a.IsDrawXRangeBG)&&(e.ChartCorssCursor.IsDrawXRangeBG=a.IsDrawXRangeBG),ha.IsBool(t.CorssCursorInfo.IsFixXLastTime)&&(e.ChartCorssCursor.IsFixXLastTime=t.CorssCursorInfo.IsFixXLastTime),a.RightButton&&ha.IsBool(a.RightButton.Enable)&&(e.ChartCorssCursor.RightButton.Enable=a.RightButton.Enable),ha.IsNumber(a.PriceFormatType)&&(e.ChartCorssCursor.StringFormatY.PriceFormatType=a.PriceFormatType),ha.IsNumber(a.DataFormatType)&&(e.ChartCorssCursor.StringFormatY.DataFormatType=a.DataFormatType)}if(t.CorssCursor={},t.CorssCursor.TitleHeight=e.ChartCorssCursor.TextHeight,t.Frame)for(var n=0;n<t.Frame.length;++n){a=t.Frame[n];if(e.Frame.SubFrame[n]){var s=e.Frame.SubFrame[n].Frame;a.SplitCount&&(e.Frame.SubFrame[n].Frame.YSplitOperator.SplitCount=a.SplitCount),a.StringFormat&&(e.Frame.SubFrame[n].Frame.YSplitOperator.StringFormat=a.StringFormat),ha.IsNumber(a.FloatPrecision)&&(e.Frame.SubFrame[n].Frame.YSplitOperator.FloatPrecision=a.FloatPrecision),a.Custom&&(e.Frame.SubFrame[n].Frame.YSplitOperator.Custom=a.Custom),ha.IsNumber(a.SplitType)&&(e.Frame.SubFrame[n].Frame.YSplitOperator.SplitType=a.SplitType,e.Frame.SubFrame[n].Frame.YSplitOperator.DefaultSplitType=a.SplitType),isNaN(a.Height)||(e.Frame.SubFrame[n].Height=a.Height),!1!==a.IsShowLeftText&&!0!==a.IsShowLeftText||(e.Frame.SubFrame[n].Frame.IsShowYText[0]=a.IsShowLeftText,e.Frame.SubFrame[n].Frame.YSplitOperator.IsShowLeftText=a.IsShowLeftText),!1!==a.IsShowRightText&&!0!==a.IsShowRightText||(e.Frame.SubFrame[n].Frame.IsShowYText[1]=a.IsShowRightText,e.Frame.SubFrame[n].Frame.YSplitOperator.IsShowRightText=a.IsShowRightText),a.TopSpace>=0&&(e.Frame.SubFrame[n].Frame.ChartBorder.TopSpace=a.TopSpace),a.BottomSpace>=0&&(e.Frame.SubFrame[n].Frame.ChartBorder.BottomSpace=a.BottomSpace),a.RightTextPosition>0&&(e.Frame.SubFrame[n].Frame.YTextPosition[1]=a.RightTextPosition),a.LeftTextPosition>0&&(e.Frame.SubFrame[n].Frame.YTextPosition[0]=a.LeftTextPosition),0==a.IsShowXLine&&(e.Frame.SubFrame[n].Frame.IsShowXLine=a.IsShowXLine),0==a.IsShowYLine&&(e.Frame.SubFrame[n].Frame.IsShowYLine=a.IsShowYLine),ha.IsNumber(a.YTextBaseline)&&(e.Frame.SubFrame[n].Frame.YTextBaseline=a.YTextBaseline),a.YCoordinateType>0&&(e.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=a.YCoordinateType),1==a.IsYReverse&&(e.Frame.SubFrame[0].Frame.CoordinateType=1),ha.IsNumber(a.PercentageTextFormat)&&(s.YSplitOperator.PercentageTextFormat=a.PercentageTextFormat),a.DefaultYMaxMin&&(e.Frame.SubFrame[n].Frame.YSplitOperator.DefaultYMaxMin=a.DefaultYMaxMin),ha.IsBool(a.EnableRemoveZero)&&(e.Frame.SubFrame[n].Frame.YSplitOperator.EnableRemoveZero=a.EnableRemoveZero),ha.IsPlusNumber(a.MinYDistance)&&(e.Frame.SubFrame[n].Frame.MinYDistance=a.MinYDistance),ha.IsNumber(a.BorderLine)&&(e.Frame.SubFrame[n].Frame.BorderLine=a.BorderLine),ha.IsBool(a.IsShowIndexTitle)&&(e.Frame.SubFrame[n].Frame.IsShowIndexTitle=a.IsShowIndexTitle),ha.IsBool(a.IsDrawTitleBottomLine)&&(s.IsDrawTitleBottomLine=a.IsDrawTitleBottomLine)}}if(t.KLine&&(0==t.KLine.ShowKLine&&(e.ChartPaint[0].IsShow=!1),t.KLine.InfoPosition>0&&(e.ChartPaint[0].InfoPosition=t.KLine.InfoPosition),0==t.KLine.IsShowMaxMinPrice&&(e.ChartPaint[0].IsShowMaxMinPrice=t.KLine.IsShowMaxMinPrice)),t.KLineTitle&&(0==t.KLineTitle.IsShowName&&(e.TitlePaint[0].IsShowName=!1),0==t.KLineTitle.IsShowSettingInfo&&(e.TitlePaint[0].IsShowSettingInfo=!1),0==t.KLineTitle.IsShow&&(e.TitlePaint[0].IsShow=!1)),t.Overlay)for(n=0;n<t.Overlay.length;++n){a=t.Overlay[n];e.OverlaySymbol(a.Symbol,a)}if(t.ExtendChart)for(n=0;n<t.ExtendChart.length;++n){a=t.ExtendChart[n];e.CreateExtendChart(a.Name,a)}var o=new B;if(t.ColorIndex){a=t.ColorIndex;var h=o.Get(a.Index);h&&(h.ID=a.Index,e.ColorIndex=new wn(h.Name,h.Script,h.Args,h))}if(t.TradeIndex){a=t.TradeIndex;var l=o.Get(a.Index);l&&(l.ID=a.Index,e.TradeIndex=new wn(l.Name,l.Script,l.Args,l))}for(n=0;n<t.Windows.length;++n){a=t.Windows[n];if(a.Script)e.WindowIndex[n]=new wn(a.Name,a.Script,a.Args,a);else if(a.JsonData)e.WindowIndex[n]=new hr(a.Name,a.Script,a.Args,a);else if(a.Local&&a.Local.Data)e.WindowIndex[n]=new Pn(a.Local.Name,a.Local.Args,{JsonData:a.Local.Data});else if(a.API){var u=a.API;e.WindowIndex[n]=new Rn(u.Name,u.Script,u.Args,a)}else{var C=Bi.Get(a.Index);if(C)e.WindowIndex[n]=C.Create(a.Option),e.WindowIndex[n].SetArgs&&e.WindowIndex[n].SetArgs(a.Args),e.CreateWindowIndex(n);else{var D=o.Get(a.Index);if(!D)continue;a.Lock&&(D.Lock=a.Lock),D.ID=a.Index;var f=D.Args;a.Args&&(f=a.Args),a.IsShortTitle&&(D.IsShortTitle=a.IsShortTitle),a.TitleFont&&(D.TitleFont=a.TitleFont),e.WindowIndex[n]=new wn(D.Name,D.Script,f,D),a.StringFormat>0&&(e.WindowIndex[n].StringFormat=a.StringFormat),a.FloatPrecision>=0&&(e.WindowIndex[n].FloatPrecision=a.FloatPrecision)}}null!=a.Modify&&(e.Frame.SubFrame[n].Frame.ModifyIndex=a.Modify),null!=a.Change&&(e.Frame.SubFrame[n].Frame.ChangeIndex=a.Change),null!=a.Close&&(e.Frame.SubFrame[n].Frame.CloseIndex=a.Close),null!=a.Overlay&&(e.Frame.SubFrame[n].Frame.OverlayIndex=a.Overlay),1==a.IsDrawTitleBG&&(e.Frame.SubFrame[n].Frame.IsDrawTitleBG=a.IsDrawTitleBG),ha.IsNumber(a.TitleHeight)?e.Frame.SubFrame[n].Frame.ChartBorder.TitleHeight=a.TitleHeight:a.TitleHeight=e.Frame.SubFrame[n].Frame.ChartBorder.TitleHeight,0==a.IsShowTitleArraw&&(e.Frame.SubFrame[n].Frame.IsShowTitleArraw=!1),0==a.IsShowIndexName&&(e.Frame.SubFrame[n].Frame.IsShowIndexName=!1),0==a.IsShowOverlayIndexName&&(e.Frame.SubFrame[n].Frame.IsShowOverlayIndexName=!1),ha.IsNumber(a.IndexParamSpace)&&(e.Frame.SubFrame[n].Frame.IndexParamSpace=a.IndexParamSpace),ha.IsNumber(a.IndexTitleSpace)&&(e.Frame.SubFrame[n].Frame.IndexTitleSpace=a.IndexTitleSpace),a.OverlayIndexType&&(ha.IsNumber(a.OverlayIndexType.Position)&&(e.Frame.SubFrame[n].Frame.OverlayIndexType.Position=a.OverlayIndexType.Position),ha.IsNumber(a.OverlayIndexType.LineSpace)&&(e.Frame.SubFrame[n].Frame.OverlayIndexType.LineSpace=a.OverlayIndexType.LineSpace))}if(t.OverlayIndexFrameWidth>40&&(e.OverlayIndexFrameWidth=t.OverlayIndexFrameWidth),ha.IsNonEmptyArray(t.OverlayIndex))for(n=0;n<t.OverlayIndex.length;++n){a=t.OverlayIndex[n];if(!(a.Windows>=e.Frame.SubFrame.length)){var c=(0,F.default)(a),d=JSON.parse(c);a.Index&&(d.IndexName=a.Index),a.Windows>=0&&(d.WindowIndex=a.Windows),e.CreateOverlayWindowsIndex(d)}}return this.AdjustTitleHeight(e),e},this.CreateCustomKLineChartContainer=function(t){var e=new ki(this.CanvasElement);if(e.ModifyIndexDialog=this.ModifyIndexDialog,e.ChangeIndexDialog=this.ChangeIndexDialog,e.MinuteDialog=this.MinuteDialog,1==t.IsShowRightMenu&&(e.RightMenu=new Nr(this.DivElement)),t.KLine&&(t.KLine.DragMode>=0&&(e.DragMode=t.KLine.DragMode),t.KLine.Right>=0&&(e.Right=t.KLine.Right),t.KLine.Period>=0&&(e.Period=t.KLine.Period),t.KLine.MaxRequestDataCount>0&&(e.MaxRequestDataCount=t.KLine.MaxRequestDataCount),t.KLine.Info&&t.KLine.Info.length>0&&e.SetKLineInfo(t.KLine.Info,!1),t.KLine.IndexTreeApiUrl&&(e.ChangeIndexDialog.IndexTreeApiUrl=t.KLine.IndexTreeApiUrl),0==t.KLine.KLineDoubleClick&&(e.MinuteDialog=this.MinuteDialog=null),null!=t.KLine.IndexTreeApiUrl&&(e.ChangeIndexDialog.IndexTreeApiUrl=t.KLine.IndexTreeApiUrl),t.KLine.PageSize>0&&(e.PageSize=t.KLine.PageSize),0==t.KLine.IsShowTooltip&&(e.IsShowTooltip=!1)),t.CustomStock&&(e.CustomStock=t.CustomStock),t.QueryDate&&(e.QueryDate=t.QueryDate),!t.Windows||t.Windows.length<=0)return null;if(e.Create(t.Windows.length),t.Border&&(isNaN(t.Border.Left)||(e.Frame.ChartBorder.Left=t.Border.Left),isNaN(t.Border.Right)||(e.Frame.ChartBorder.Right=t.Border.Right),isNaN(t.Border.Top)||(e.Frame.ChartBorder.Top=t.Border.Top)),0==t.IsShowCorssCursorInfo&&(e.ChartCorssCursor.IsShowText=t.IsShowCorssCursorInfo),t.Frame)for(var a=0;a<t.Frame.length;++a){var i=t.Frame[a];i.SplitCount&&(e.Frame.SubFrame[a].Frame.YSplitOperator.SplitCount=i.SplitCount),i.StringFormat&&(e.Frame.SubFrame[a].Frame.YSplitOperator.StringFormat=i.StringFormat)}t.KLineTitle&&(0==t.KLineTitle.IsShowName&&(e.TitlePaint[0].IsShowName=!1),0==t.KLineTitle.IsShowSettingInfo&&(e.TitlePaint[0].IsShowSettingInfo=!1));var r=new B;for(a=0;a<t.Windows.length;++a){i=t.Windows[a];if(i.Script)e.WindowIndex[a]=new wn(i.Name,i.Script,i.Args,i);else{var n=Bi.Get(i.Index);if(n)e.WindowIndex[a]=n.Create(),e.CreateWindowIndex(a);else{var s=r.Get(i.Index);if(!s)continue;i.Lock&&(s.Lock=i.Lock),e.WindowIndex[a]=new wn(s.Name,s.Script,s.Args,s)}}null!=i.Modify&&(e.Frame.SubFrame[a].Frame.ModifyIndex=i.Modify),null!=i.Change&&(e.Frame.SubFrame[a].Frame.ChangeIndex=i.Change),isNaN(i.TitleHeight)||(e.Frame.SubFrame[a].Frame.ChartBorder.TitleHeight=i.TitleHeight)}return e},this.CreateMinuteChartContainer=function(t){var e=null;e="åéèµ°å¿å¾æ¨ªå±"===t.Type?new Ui(this.CanvasElement):new Hi(this.CanvasElement),t.NetworkFilter&&(e.NetworkFilter=t.NetworkFilter),e.ModifyIndexDialog=this.ModifyIndexDialog,e.ChangeIndexDialog=this.ChangeIndexDialog;var a=2;if(t.Windows&&t.Windows.length>0&&(a+=t.Windows.length),1==t.EnableScrollUpDown&&(e.EnableScrollUpDown=t.EnableScrollUpDown),1==t.DisableMouse&&(e.DisableMouse=t.DisableMouse),t.ScriptError&&(e.ScriptErrorCallback=t.ScriptError),ha.IsString(t.SplashTitle)&&(e.LoadDataSplashTitle=t.SplashTitle),ha.IsBool(t.EnableSelectRect)&&(e.EnableSelectRect=t.EnableSelectRect),ha.IsBool(t.EnableZoomIndexWindow)&&(e.EnableZoomIndexWindow=t.EnableZoomIndexWindow),ha.IsBool(t.IsDrawPictureXY)&&(e.IsDrawPictureXY=t.IsDrawPictureXY),ha.IsBool(t.EnableNewIndex)&&(e.EnableNewIndex=t.EnableNewIndex),ha.IsBool(t.EnableIndexChartDrag)&&(e.EnableIndexChartDrag=t.EnableIndexChartDrag),t.GlobalOption){var i=t.GlobalOption;ha.IsBool(i.IsValueFullRange)&&(e.GlobalOption.IsValueFullRange=i.IsValueFullRange)}if(e.SelectRectDialog=new Lr(this.DivElement),t.Minute&&(0==t.Minute.IsShowTooltip&&(e.IsShowTooltip=!1),t.Minute.DragMode>=0&&(e.DragMode=t.Minute.DragMode)),t.Language){var r=bi.GetLanguageID(t.Language);ha.IsNumber(r)&&(e.LanguageID=r)}if(t.Info&&t.Info.length>0&&e.SetMinuteInfo(t.Info,!1),t.DrawTool&&t.DrawTool.StorageKey&&e.ChartDrawStorage&&e.ChartDrawStorage.Load(t.DrawTool.StorageKey),t.BeforeOpen){i=t.BeforeOpen;ha.IsBool(i.IsShow)&&(e.IsShowBeforeData=i.IsShow),ha.IsNumber(i.Width)&&(e.ExtendWidth.Left=i.Width),ha.IsBool(i.IsShowMultiDay)&&(e.IsShowMultiDayBeforeData=i.IsShowMultiDay),ha.IsNumber(i.MulitiDayWidth)&&(e.MultiDayExtendWidth.Left=i.MulitiDayWidth)}if(t.AfterClose){i=t.AfterClose;ha.IsBool(i.IsShow)&&(e.IsShowAfterData=i.IsShow),ha.IsNumber(i.ShareVol)&&(e.ShareAfterVol=i.ShareVol),ha.IsNumber(i.Width)&&(e.ExtendWidth.Right=i.Width),ha.IsBool(i.IsShowMultiDay)&&(e.IsShowMultiDayAfterData=i.IsShowMultiDay),ha.IsNumber(i.MulitiDayWidth)&&(e.MultiDayExtendWidth.Right=i.MulitiDayWidth)}if(t.SelectedChart){i=t.SelectedChart;ha.IsBool(i.EnableSelected)&&(e.SelectedChart.EnableSelected=i.EnableSelected),ha.IsBool(i.EnableMoveOn)&&(e.SelectedChart.EnableMoveOn=i.EnableMoveOn)}if(t.PageInfo&&e.SetPageInfo(t.PageInfo),e.Create(a,t),t.CorssCursorInfo){i=t.CorssCursorInfo;isNaN(t.CorssCursorInfo.Left)||(e.ChartCorssCursor.ShowTextMode.Left=t.CorssCursorInfo.Left),isNaN(t.CorssCursorInfo.Right)||(e.ChartCorssCursor.ShowTextMode.Right=t.CorssCursorInfo.Right),isNaN(t.CorssCursorInfo.Bottom)||(e.ChartCorssCursor.ShowTextMode.Bottom=t.CorssCursorInfo.Bottom),!1===t.CorssCursorInfo.IsShowCorss&&(e.ChartCorssCursor.IsShowCorss=t.CorssCursorInfo.IsShowCorss),t.CorssCursorInfo.RightTextFormat>0&&(e.ChartCorssCursor.TextFormat.Right=t.CorssCursorInfo.RightTextFormat),1==t.CorssCursorInfo.IsOnlyDrawMinute&&(e.ChartCorssCursor.IsOnlyDrawMinute=t.CorssCursorInfo.IsOnlyDrawMinute),ha.IsBool(t.CorssCursorInfo.IsFixXLastTime)&&(e.ChartCorssCursor.IsFixXLastTime=t.CorssCursorInfo.IsFixXLastTime),i.RightButton&&ha.IsBool(i.RightButton.Enable)&&(e.ChartCorssCursor.RightButton.Enable=i.RightButton.Enable),ha.IsNumber(i.PriceFormatType)&&(e.ChartCorssCursor.StringFormatY.PriceFormatType=i.PriceFormatType),ha.IsNumber(i.DataFormatType)&&(e.ChartCorssCursor.StringFormatY.DataFormatType=i.DataFormatType)}if(t.MinuteInfo&&e.CreateMinuteInfo(t.MinuteInfo),1==t.IsShowRightMenu&&(e.RightMenu=new Or(this.DivElement)),ha.IsNumber(t.DayCount)&&(e.DayCount=t.DayCount),this.SetChartBorder(e,t),t.SplashTitle&&(e.ChartSplashPaint.SplashTitle=t.SplashTitle),ha.IsBool(t.EnableBorderDrag)&&(e.EnableBorderDrag=t.EnableBorderDrag),this.AdjustChartBorder(e),t.Frame){for(var n=0;n<t.Frame.length;++n){i=t.Frame[n];e.Frame.SubFrame[n]&&(i.SplitCount&&(e.Frame.SubFrame[n].Frame.YSplitOperator.SplitCount=i.SplitCount),i.StringFormat&&(e.Frame.SubFrame[n].Frame.YSplitOperator.StringFormat=i.StringFormat),ha.IsNumber(i.SplitType)&&(e.Frame.SubFrame[n].Frame.YSplitOperator.SplitType=i.SplitType,e.Frame.SubFrame[n].Frame.YSplitOperator.DefaultSplitType=i.SplitType),0==i.IsShowLeftText&&(e.Frame.SubFrame[n].Frame.IsShowYText[0]=i.IsShowLeftText,e.Frame.SubFrame[n].Frame.YSplitOperator.IsShowLeftText=i.IsShowLeftText),0==i.IsShowRightText&&(e.Frame.SubFrame[n].Frame.IsShowYText[1]=i.IsShowRightText,e.Frame.SubFrame[n].Frame.YSplitOperator.IsShowRightText=i.IsShowRightText),i.Height>=0&&(e.Frame.SubFrame[n].Height=i.Height),i.Custom&&(e.Frame.SubFrame[n].Frame.YSplitOperator.Custom=i.Custom),i.RightTextFormat>0&&(e.Frame.SubFrame[n].Frame.YSplitOperator.RightTextFormat=i.RightTextFormat),ha.IsNumber(i.TitleHeight)&&(e.Frame.SubFrame[n].Frame.ChartBorder.TitleHeight=i.TitleHeight),ha.IsNumber(i.BorderLine)&&(e.Frame.SubFrame[n].Frame.BorderLine=i.BorderLine),ha.IsBool(i.EnableRemoveZero)&&(e.Frame.SubFrame[n].Frame.YSplitOperator.EnableRemoveZero=i.EnableRemoveZero),ha.IsNumber(i.FloatPrecision)&&(e.Frame.SubFrame[n].Frame.YSplitOperator.FloatPrecision=i.FloatPrecision),ha.IsBool(i.IsShowXLine)&&(e.Frame.SubFrame[n].Frame.IsShowXLine=i.IsShowXLine),ha.IsBool(i.IsShowYLine)&&(e.Frame.SubFrame[n].Frame.IsShowYLine=i.IsShowYLine),ha.IsNumber(i.YTextBaseline)&&(e.Frame.SubFrame[n].Frame.YTextBaseline=i.YTextBaseline))}e.UpdateXShowText()}if(t.ExtendChart)for(n=0;n<t.ExtendChart.length;++n){i=t.ExtendChart[n];e.CreateExtendChart(i.Name,i)}if(t.Overlay)for(n=0;n<t.Overlay.length;++n){i=t.Overlay[n];e.OverlaySymbol(i.Symbol,i)}if(t.MinuteLine){if(0==t.MinuteLine.IsDrawAreaPrice&&(e.ChartPaint[0].IsDrawArea=!1),0==t.MinuteLine.IsShowLead&&(e.IsShowLead=!1),0==t.MinuteLine.IsShowAveragePrice){e.ChartPaint[1].IsShow=!1,e.TitlePaint[0].IsShowAveragePrice=!1;for(n=0;n<e.ExtendChartPaint.length;++n){i=e.ExtendChartPaint[n];"MinuteTooltipPaint"==i.ClassName&&(i.IsShowAveragePrice=!1)}}t.MinuteLine.SplitType>0&&(e.Frame.SubFrame[0].Frame.YSplitOperator.SplitType=t.MinuteLine.SplitType)}if(t.MinuteTitle){i=t.MinuteTitle;ha.IsBool(i.IsShowName)&&(e.TitlePaint[0].IsShowName=i.IsShowName),ha.IsBool(i.IsShowDate)&&(e.TitlePaint[0].IsShowDate=i.IsShowDate),ha.IsBool(i.IsShowTime)&&(e.TitlePaint[0].IsShowTime=i.IsShowTime),ha.IsBool(i.IsTitleShowLatestData)&&(e.IsTitleShowLatestData=i.IsTitleShowLatestData),ha.IsBool(i.IsAlwaysShowLastData)&&(e.TitlePaint[0].IsAlwaysShowLastData=i.IsAlwaysShowLastData),ha.IsNumber(i.ShowLastDataFormat)&&(e.TitlePaint[0].ShowLastDataFormat=i.ShowLastDataFormat)}if(!0===t.CorssCursorTouchEnd&&(e.CorssCursorTouchEnd=t.CorssCursorTouchEnd),!0===t.IsShowBeforeData&&(e.IsShowBeforeData=t.IsShowBeforeData),ha.IsNonEmptyArray(t.Windows)){var s=new B;for(n=0;n<t.Windows.length;++n){var o=2+n;i=t.Windows[n];if(i.Script)e.WindowIndex[o]=new wn(i.Name,i.Script,i.Args,i);else if(i.API){var h=i.API;e.WindowIndex[o]=new Rn(h.Name,h.Script,h.Args,i)}else{var l=Bi.Get(i.Index);if(l)e.WindowIndex[o]=l.Create(),e.CreateWindowIndex(o);else{var u=s.Get(i.Index);if(!u)continue;u.ID=i.Index;var C=u.Args;i.Args&&(C=i.Args),i.IsShortTitle&&(u.IsShortTitle=i.IsShortTitle),i.TitleFont&&(u.TitleFont=i.TitleFont),e.WindowIndex[o]=new wn(u.Name,u.Script,C,u),i.StringFormat>0&&(e.WindowIndex[o].StringFormat=i.StringFormat),i.FloatPrecision>=0&&(e.WindowIndex[o].FloatPrecision=i.FloatPrecision)}}null!=i.Modify&&(e.Frame.SubFrame[o].Frame.ModifyIndex=i.Modify),null!=i.Change&&(e.Frame.SubFrame[o].Frame.ChangeIndex=i.Change),null!=i.Close&&(e.Frame.SubFrame[o].Frame.CloseIndex=i.Close),null!=i.Overlay&&(e.Frame.SubFrame[o].Frame.OverlayIndex=i.Overlay),ha.IsNumber(i.YSplitType)&&(e.Frame.SubFrame[o].Frame.YSplitOperator.SplitType=i.YSplitType),isNaN(i.TitleHeight)||(e.Frame.SubFrame[o].Frame.ChartBorder.TitleHeight=i.TitleHeight),ha.IsBool(i.IsDrawTitleBG)&&(e.Frame.SubFrame[o].Frame.IsDrawTitleBG=i.IsDrawTitleBG)}}if(this.AdjustTitleHeight(e),ha.IsNonEmptyArray(t.OverlayIndex))for(n=0;n<t.OverlayIndex.length;++n){i=t.OverlayIndex[n];if(!(i.Windows>=e.Frame.SubFrame.length)){var D=(0,F.default)(i),f=JSON.parse(D);i.Index&&(f.IndexName=i.Index),i.Windows>=0&&(f.WindowIndex=i.Windows),e.CreateOverlayWindowsIndex(f)}}return e},this.CreateMinMinuteChartContainer=function(t){var e=null;e="è¿·ä½ åéèµ°å¿å¾æ¨ªå±"===t.Type?new Ui(this.CanvasElement):new Hi(this.CanvasElement),t.NetworkFilter&&(e.NetworkFilter=t.NetworkFilter);var a=2;if(t.BeforeOpen){var i=t.BeforeOpen;ha.IsBool(i.IsShow)&&(e.IsShowBeforeData=i.IsShow),ha.IsNumber(i.Width)&&(e.ExtendWidth.Left=i.Width),ha.IsBool(i.IsShowMultiDay)&&(e.IsShowMultiDayBeforeData=i.IsShowMultiDay),ha.IsNumber(i.MulitiDayWidth)&&(e.MultiDayExtendWidth.Left=i.MulitiDayWidth)}if(t.AfterClose){i=t.AfterClose;ha.IsBool(i.IsShow)&&(e.IsShowAfterData=i.IsShow),ha.IsNumber(i.ShareVol)&&(e.ShareAfterVol=i.ShareVol),ha.IsNumber(i.Width)&&(e.ExtendWidth.Right=i.Width),ha.IsBool(i.IsShowMultiDay)&&(e.IsShowMultiDayAfterData=i.IsShowMultiDay),ha.IsNumber(i.MulitiDayWidth)&&(e.MultiDayExtendWidth.Right=i.MulitiDayWidth)}if(t.Listener||(t.Listener={KeyDown:!1,Wheel:!1}),e.Create(a,t.Listener),t.CorssCursorInfo){i=t.CorssCursorInfo;ha.IsNumber(t.CorssCursorInfo.Left)&&(e.ChartCorssCursor.ShowTextMode.Left=t.CorssCursorInfo.Left),ha.IsNumber(t.CorssCursorInfo.Right)&&(e.ChartCorssCursor.ShowTextMode.Right=t.CorssCursorInfo.Right),ha.IsNumber(t.CorssCursorInfo.Bottom)&&(e.ChartCorssCursor.ShowTextMode.Bottom=t.CorssCursorInfo.Bottom),!1===t.CorssCursorInfo.IsShowCorss&&(e.ChartCorssCursor.IsShowCorss=t.CorssCursorInfo.IsShowCorss),t.CorssCursorInfo.RightTextFormat>0&&(e.ChartCorssCursor.TextFormat.Right=t.CorssCursorInfo.RightTextFormat),1==t.CorssCursorInfo.IsOnlyDrawMinute&&(e.ChartCorssCursor.IsOnlyDrawMinute=t.CorssCursorInfo.IsOnlyDrawMinute),ha.IsBool(t.CorssCursorInfo.IsFixXLastTime)&&(e.ChartCorssCursor.IsFixXLastTime=t.CorssCursorInfo.IsFixXLastTime),i.RightButton&&ha.IsBool(i.RightButton.Enable)&&(e.ChartCorssCursor.RightButton.Enable=i.RightButton.Enable),ha.IsNumber(i.PriceFormatType)&&(e.ChartCorssCursor.StringFormatY.PriceFormatType=i.PriceFormatType),ha.IsNumber(i.DataFormatType)&&(e.ChartCorssCursor.StringFormatY.DataFormatType=i.DataFormatType),ha.IsNumber(t.CorssCursorInfo.HPenType)&&(e.ChartCorssCursor.HPenType=t.CorssCursorInfo.HPenType),ha.IsNumber(t.CorssCursorInfo.VPenType)&&(e.ChartCorssCursor.VPenType=t.CorssCursorInfo.VPenType)}ha.IsNumber(t.DayCount)&&(e.DayCount=t.DayCount),this.SetChartBorder(e,t),t.SplashTitle&&(e.ChartSplashPaint.SplashTitle=t.SplashTitle),e.TitlePaint[0].IsShow=!1;var r=e.Frame.SubFrame[0];if(r.Frame.IsShowYText[0]=!1,r.Frame.IsShowYText[1]=!1,r.Frame.IsShowXLine=!1,r.Frame.IsShowYLine=!1,r.Frame.BorderLine=0,e.Frame.SubFrame[1].Height=0,e.EnableBorderDrag=!1,t.Frame)for(var n=0;n<t.Frame.length;++n){i=t.Frame[n];e.Frame.SubFrame[n]&&(i.SplitCount&&(e.Frame.SubFrame[n].Frame.YSplitOperator.SplitCount=i.SplitCount),i.StringFormat&&(e.Frame.SubFrame[n].Frame.YSplitOperator.StringFormat=i.StringFormat),ha.IsNumber(i.SplitType)&&(e.Frame.SubFrame[n].Frame.YSplitOperator.SplitType=i.SplitType,e.Frame.SubFrame[n].Frame.YSplitOperator.DefaultSplitType=i.SplitType),ha.IsBool(i.IsShowLeftText)&&(e.Frame.SubFrame[n].Frame.IsShowYText[0]=i.IsShowLeftText,e.Frame.SubFrame[n].Frame.YSplitOperator.IsShowLeftText=i.IsShowLeftText),ha.IsBool(i.IsShowRightText)&&(e.Frame.SubFrame[n].Frame.IsShowYText[1]=i.IsShowRightText,e.Frame.SubFrame[n].Frame.YSplitOperator.IsShowRightText=i.IsShowRightText),i.Height>=0&&(e.Frame.SubFrame[n].Height=i.Height),i.Custom&&(e.Frame.SubFrame[n].Frame.YSplitOperator.Custom=i.Custom),i.RightTextFormat>0&&(e.Frame.SubFrame[n].Frame.YSplitOperator.RightTextFormat=i.RightTextFormat),ha.IsNumber(i.TitleHeight)&&(e.Frame.SubFrame[n].Frame.ChartBorder.TitleHeight=i.TitleHeight),ha.IsNumber(i.BorderLine)&&(e.Frame.SubFrame[n].Frame.BorderLine=i.BorderLine),ha.IsBool(i.EnableRemoveZero)&&(e.Frame.SubFrame[n].Frame.YSplitOperator.EnableRemoveZero=i.EnableRemoveZero),ha.IsNumber(i.FloatPrecision)&&(e.Frame.SubFrame[n].Frame.YSplitOperator.FloatPrecision=i.FloatPrecision),ha.IsBool(i.IsShowXLine)&&(e.Frame.SubFrame[n].Frame.IsShowXLine=i.IsShowXLine),ha.IsBool(i.IsShowYLine)&&(e.Frame.SubFrame[n].Frame.IsShowYLine=i.IsShowYLine),ha.IsNumber(i.YTextBaseline)&&(e.Frame.SubFrame[n].Frame.YTextBaseline=i.YTextBaseline))}if(e.UpdateXShowText(),t.MinuteLine){if(0==t.MinuteLine.IsDrawAreaPrice&&(e.ChartPaint[0].IsDrawArea=!1),0==t.MinuteLine.IsShowLead&&(e.IsShowLead=!1),0==t.MinuteLine.IsShowAveragePrice){e.ChartPaint[1].IsShow=!1,e.TitlePaint[0].IsShowAveragePrice=!1;for(n=0;n<e.ExtendChartPaint.length;++n){i=e.ExtendChartPaint[n];"MinuteTooltipPaint"==i.ClassName&&(i.IsShowAveragePrice=!1)}}t.MinuteLine.SplitType>0&&(e.Frame.SubFrame[0].Frame.YSplitOperator.SplitType=t.MinuteLine.SplitType)}return this.AdjustTitleHeight(e),!0===t.DisableMouseEvent&&(this.CanvasElement.onmousemove=function(t){},this.CanvasElement.oncontextmenu=function(t){},this.CanvasElement.ondblclick=function(t){},this.CanvasElement.onmousedown=function(t){},this.CanvasElement.onmouseout=function(t){},this.CanvasElement.onmouseleave=function(t){}),e},this.CreateHistoryMinuteChartContainer=function(t){var e=new Yi(this.CanvasElement),a=2;t.Windows&&t.Windows.length>0&&(a+=t.Windows.length),e.Create(a),0==t.IsShowCorssCursorInfo&&(e.ChartCorssCursor.IsShowText=t.IsShowCorssCursorInfo),t.Border&&(isNaN(t.Border.Left)||(e.Frame.ChartBorder.Left=t.Border.Left),isNaN(t.Border.Right)||(e.Frame.ChartBorder.Right=t.Border.Right),isNaN(t.Border.Top)||(e.Frame.ChartBorder.Top=t.Border.Top),isNaN(t.Border.Bottom)||(e.Frame.ChartBorder.Bottom=t.Border.Bottom));var i=new B;if(t.Windows)for(var r=0;r<t.Windows.length;++r){var n=t.Windows[r];if(n.Script)e.WindowIndex[2+parseInt(r)]=new wn(n.Name,n.Script,n.Args);else{var s=Bi.Get(n.Index);if(s)e.WindowIndex[2+parseInt(r)]=s.Create(),e.CreateWindowIndex(2+parseInt(r));else{var o=i.Get(n.Index);if(!o)continue;e.WindowIndex[2+parseInt(r)]=new wn(o.Name,o.Script,o.Args)}}isNaN(n.TitleHeight)||(e.Frame.SubFrame[2+parseInt(r)].Frame.ChartBorder.TitleHeight=n.TitleHeight)}return e.TradeDate=20181009,t.HistoryMinute.TradeDate&&(e.TradeDate=t.HistoryMinute.TradeDate),null!=t.HistoryMinute.IsShowName&&(e.TitlePaint[0].IsShowName=t.HistoryMinute.IsShowName),null!=t.HistoryMinute.IsShowDate&&(e.TitlePaint[0].IsShowDate=t.HistoryMinute.IsShowDate),e},this.CreateKLineTrainChartContainer=function(t){var e=!1;if("ç®åKçº¿è®­ç»"==t.Type||"ç®åKçº¿è®­ç»æ¨ªå±"==t.Type){var a="ç®åKçº¿è®­ç»æ¨ªå±"==t.Type,i=new Xi(this.CanvasElement,a);e=!0}else a="Kçº¿è®­ç»æ¨ªå±"==t.Type,i=new _i(this.CanvasElement,a);if(t.NetworkFilter&&(i.NetworkFilter=t.NetworkFilter),1==t.IsApiPeriod&&(i.IsApiPeriod=t.IsApiPeriod),i.ModifyIndexDialog=this.ModifyIndexDialog,i.ChangeIndexDialog=this.ChangeIndexDialog,t.ScriptError&&(i.ScriptErrorCallback=t.ScriptError),t.KLine&&(t.KLine.Right>=0&&(i.Right=t.KLine.Right),t.KLine.Period>=0&&(i.Period=t.KLine.Period),t.KLine.MaxRequestDataCount>0&&(i.MaxRequestDataCount=t.KLine.MaxRequestDataCount),t.KLine.Info&&t.KLine.Info.length>0&&i.SetKLineInfo(t.KLine.Info,!1),t.KLine.PageSize>0&&(i.PageSize=t.KLine.PageSize),0==t.KLine.IsShowTooltip&&(i.IsShowTooltip=!1),t.KLine.MaxRequestMinuteDayCount>0&&(i.MaxRequestMinuteDayCount=t.KLine.MaxRequestMinuteDayCount),t.KLine.DrawType&&(i.KLineDrawType=t.KLine.DrawType),ha.IsNumber(t.KLine.RightSpaceCount)&&!e&&(i.RightSpaceCount=t.KLine.RightSpaceCount)),t.Train&&(t.Train.DataCount&&(i.TrainDataCount=t.Train.DataCount),t.Train.Callback&&(i.TrainCallback=t.Train.Callback),t.Train.StartDate&&(i.TrainStartDate=t.Train.StartDate)),!t.Windows||t.Windows.length<=0)return null;if(i.Create(t.Windows.length),this.SetChartBorder(i,t),this.AdjustChartBorder(i),0==t.IsShowCorssCursorInfo&&(i.ChartCorssCursor.IsShowText=t.IsShowCorssCursorInfo),!0===t.IsCorssOnlyDrawKLine&&(i.ChartCorssCursor.IsOnlyDrawKLine=t.IsCorssOnlyDrawKLine),!0===t.CorssCursorTouchEnd&&(i.CorssCursorTouchEnd=t.CorssCursorTouchEnd),1==t.IsClickShowCorssCursor&&(i.IsClickShowCorssCursor=t.IsClickShowCorssCursor),t.CorssCursorInfo&&(isNaN(t.CorssCursorInfo.Left)||(i.ChartCorssCursor.ShowTextMode.Left=t.CorssCursorInfo.Left),isNaN(t.CorssCursorInfo.Right)||(i.ChartCorssCursor.ShowTextMode.Right=t.CorssCursorInfo.Right),isNaN(t.CorssCursorInfo.Bottom)||(i.ChartCorssCursor.ShowTextMode.Bottom=t.CorssCursorInfo.Bottom),!1===t.CorssCursorInfo.IsShowCorss&&(i.ChartCorssCursor.IsShowCorss=t.CorssCursorInfo.IsShowCorss),1==t.CorssCursorInfo.IsShowClose&&(i.ChartCorssCursor.IsShowClose=t.CorssCursorInfo.IsShowClose),t.CorssCursorInfo.PressTime&&(i.PressTime=t.CorssCursorInfo.PressTime),t.CorssCursorInfo.HPenType>0&&(i.ChartCorssCursor.HPenType=t.CorssCursorInfo.HPenType),t.CorssCursorInfo.VPenType>0&&(i.ChartCorssCursor.VPenType=t.CorssCursorInfo.VPenType)),t.CorssCursor={},t.CorssCursor.TitleHeight=i.ChartCorssCursor.TextHeight,t.Frame)for(var r=0;r<t.Frame.length;++r){var n=t.Frame[r];i.Frame.SubFrame[r]&&(n.SplitCount&&(i.Frame.SubFrame[r].Frame.YSplitOperator.SplitCount=n.SplitCount),n.StringFormat&&(i.Frame.SubFrame[r].Frame.YSplitOperator.StringFormat=n.StringFormat),ha.IsNumber(n.FloatPrecision)&&(i.Frame.SubFrame[r].Frame.YSplitOperator.FloatPrecision=n.FloatPrecision),n.Custom&&(i.Frame.SubFrame[r].Frame.YSplitOperator.Custom=n.Custom),ha.IsNumber(n.SplitType)&&(i.Frame.SubFrame[r].Frame.YSplitOperator.SplitType=n.SplitType),n.Height>0&&(i.Frame.SubFrame[r].Height=n.Height),0==n.IsShowLeftText&&(i.Frame.SubFrame[r].Frame.YSplitOperator.IsShowLeftText=n.IsShowLeftText),0==n.IsShowRightText&&(i.Frame.SubFrame[r].Frame.YSplitOperator.IsShowRightText=n.IsShowRightText))}if(t.KLine&&(0==t.KLine.ShowKLine&&(i.ChartPaint[0].IsShow=!1),t.KLine.InfoPosition>0&&(i.ChartPaint[0].InfoPosition=t.KLine.InfoPosition),0==t.KLine.IsShowMaxMinPrice&&(i.ChartPaint[0].IsShowMaxMinPrice=t.KLine.IsShowMaxMinPrice)),t.KLineTitle&&(0==t.KLineTitle.IsShowName&&(i.TitlePaint[0].IsShowName=!1),0==t.KLineTitle.IsShowSettingInfo&&(i.TitlePaint[0].IsShowSettingInfo=!1),0==t.KLineTitle.IsShow&&(i.TitlePaint[0].IsShow=!1)),t.ExtendChart)for(r=0;r<t.ExtendChart.length;++r){n=t.ExtendChart[r];i.CreateExtendChart(n.Name,n)}if(ha.IsNonEmptyArray(t.Windows)){var s=new B;for(r=0;r<t.Windows.length;++r){n=t.Windows[r];if(n.Script)i.WindowIndex[r]=new wn(n.Name,n.Script,n.Args,n);else{var o=Bi.Get(n.Index);if(o)i.WindowIndex[r]=o.Create(),i.CreateWindowIndex(r);else{var h=s.Get(n.Index);if(!h)continue;n.Lock&&(h.Lock=n.Lock),i.WindowIndex[r]=new wn(h.Name,h.Script,h.Args,h)}}null!=n.Modify&&(i.Frame.SubFrame[r].Frame.ModifyIndex=n.Modify),null!=n.Change&&(i.Frame.SubFrame[r].Frame.ChangeIndex=n.Change),null!=n.Close&&(i.Frame.SubFrame[r].Frame.CloseIndex=n.Close),isNaN(n.TitleHeight)||(i.Frame.SubFrame[r].Frame.ChartBorder.TitleHeight=n.TitleHeight)}}return this.AdjustTitleHeight(i),i},this.CreateDepthChartContainer=function(t){var e=null;if(e=new Ki(this.CanvasElement),t.NetworkFilter&&(e.NetworkFilter=t.NetworkFilter),1==t.EnableScrollUpDown&&(e.EnableScrollUpDown=t.EnableScrollUpDown),ha.IsPlusNumber(t.MaxVolRate)&&(e.MaxVolRate=t.MaxVolRate),t.ZoomStepPixel>0&&(e.ZoomStepPixel=t.ZoomStepPixel),ha.IsString(t.SplashTitle)&&(e.LoadDataSplashTitle=t.SplashTitle),t.Language){var a=bi.GetLanguageID(t.Language);ha.IsNumber(a)&&(e.LanguageID=a)}if(e.Create(t.Listener),t.Border&&(ha.IsNumber(t.Border.Left)?e.Frame.ChartBorder.Left=t.Border.Left:t.Border.Left=e.Frame.ChartBorder.Left,ha.IsNumber(t.Border.Right)?e.Frame.ChartBorder.Right=t.Border.Right:t.Border.Right=e.Frame.ChartBorder.Right,ha.IsNumber(t.Border.Top)?e.Frame.ChartBorder.Top=t.Border.Top:t.Border.Top=e.Frame.ChartBorder.Top,ha.IsNumber(t.Border.Bottom)?e.Frame.ChartBorder.Bottom=t.Border.Bottom:t.Border.Bottom=e.Frame.ChartBorder.Bottom),this.AdjustChartBorder(e),!0===t.CorssCursorTouchEnd&&(e.CorssCursorTouchEnd=t.CorssCursorTouchEnd),t.CorssCursorInfo){var i=t.CorssCursorInfo;ha.IsNumber(i.HPenType)&&(e.ChartCorssCursor.HPenType=i.HPenType),ha.IsNumber(i.VPenType)&&(e.ChartCorssCursor.VPenType=i.VPenType),ha.IsBool(i.IsShowTooltip)&&(e.ChartCorssCursor.IsShowTooltip=i.IsShowTooltip)}if(t.Frame){i=t.Frame;i.SplitCount&&(e.Frame.YSplitOperator.SplitCount=i.SplitCount),ha.IsNumber(i.SplitType)&&(e.Frame.YSplitOperator.SplitType=i.SplitType),ha.IsNumber(i.Height)&&(e.Frame.Height=i.Height),ha.IsNumber(i.YLineType)&&(e.Frame.YSplitOperator.LineType=i.YLineType),ha.IsNumber(i.XLineType)&&(e.Frame.XSplitOperator.LineType=i.XLineType),Array.isArray(i.IgnoreYValue)&&(e.Frame.YSplitOperator.IgnoreYValue=i.IgnoreYValue),!1!==i.IsShowLeftText&&!0!==i.IsShowLeftText||(e.Frame.IsShowYText[0]=i.IsShowLeftText,e.Frame.YSplitOperator.IsShowLeftText=i.IsShowLeftText),!1!==i.IsShowRightText&&!0!==i.IsShowRightText||(e.Frame.IsShowYText[1]=i.IsShowRightText,e.Frame.YSplitOperator.IsShowRightText=i.IsShowRightText),0==i.IsShowXLine&&(e.Frame.IsShowXLine=i.IsShowXLine),0==i.IsShowYLine&&(e.Frame.IsShowYLine=i.IsShowYLine),ha.IsNumber(i.XSplitCount)&&(e.Frame.XSplitOperator.SplitCount=i.XSplitCount)}return e},this.SetOption=function(t){var e=null;switch(t.Type){case"åå²Kçº¿å¾":case"åå²Kçº¿å¾æ¨ªå±":e=this.CreateKLineChartContainer(t);break;case"èªå®ä¹ææ°åå²Kçº¿å¾":e=this.CreateCustomKLineChartContainer(t);break;case"åéèµ°å¿å¾":case"åéèµ°å¿å¾æ¨ªå±":e=this.CreateMinuteChartContainer(t);break;case"è¿·ä½ åéèµ°å¿å¾":e=this.CreateMinMinuteChartContainer(t);break;case"åå²åéèµ°å¿å¾":e=this.CreateHistoryMinuteChartContainer(t);break;case"Kçº¿è®­ç»":case"Kçº¿è®­ç»æ¨ªå±":case"ç®åKçº¿è®­ç»":case"ç®åKçº¿è®­ç»æ¨ªå±":e=this.CreateKLineTrainChartContainer(t);break;case"æ·±åº¦å¾":e=this.CreateDepthChartContainer(t);break;case"ç®åå¾å½¢":return this.CreateSimpleChart(t);case"é¥¼å¾":case"é·è¾¾å¾":return this.CreatePieChart(t);case"å°å¾":return this.CreateMapChart(t);default:return!1}if(!e)return!1;if(t.OnCreatedCallback&&t.OnCreatedCallback(e),null!=t.IsAutoUpdate&&(e.IsAutoUpdate=t.IsAutoUpdate),t.AutoUpdateFrequency>0&&(e.AutoUpdateFrequency=t.AutoUpdateFrequency),t.EventCallback)for(var a=0;a<t.EventCallback.length;++a){var i=t.EventCallback[a];e.AddEventCallback(i)}t.Symbol?(e.Draw(),e.ChangeSymbol(t.Symbol),this.JSChartContainer=e,this.DivElement.JSChart=this,this.JSChartContainer.Draw()):(e.DrawEmpty(),this.JSChartContainer=e,this.DivElement.JSChart=this),ha.IsBool(t.CheckLatestVerion)&&0==t.CheckLatestVerion||null==V.LastVersion&&e&&"function"==typeof e.GetLatestVersion&&e.GetLatestVersion()},this.CreateSimpleChart=function(t){var e=new Ji(this.CanvasElement);t.MainDataControl&&(e.MainDataControl=t.MainDataControl),e.Create(),t.Border&&(isNaN(t.Border.Left)||(e.Frame.ChartBorder.Left=t.Border.Left),isNaN(t.Border.Right)||(e.Frame.ChartBorder.Right=t.Border.Right),isNaN(t.Border.Top)||(e.Frame.ChartBorder.Top=t.Border.Top)),e.Draw(),e.RequestData(),this.JSChartContainer=e,this.DivElement.JSChart=this,this.JSChartContainer.Draw()},this.CreatePieChart=function(t){var e=new zi(this.CanvasElement);t.MainDataControl&&(e.MainDataControl=t.MainDataControl),t.Radius&&(e.Radius=t.Radius),e.Create(),t.Border&&(isNaN(t.Border.Left)||(e.Frame.ChartBorder.Left=t.Border.Left),isNaN(t.Border.Right)||(e.Frame.ChartBorder.Right=t.Border.Right),isNaN(t.Border.Top)||(e.Frame.ChartBorder.Top=t.Border.Top)),this.AdjustChartBorder(e),t.Frame&&0==t.Frame[0].IsShowBorder&&(e.Frame.IsShowBorder=t.Frame[0].IsShowBorder),e.Draw(),e.RequestData(),this.JSChartContainer=e,this.DivElement.JSChart=this,this.JSChartContainer.Draw()},this.CreateMapChart=function(t){var e=new qi(this.CanvasElement);t.MainDataControl&&(e.MainDataControl=t.MainDataControl),e.Create(),t.Border&&(isNaN(t.Border.Left)||(e.Frame.ChartBorder.Left=t.Border.Left),isNaN(t.Border.Right)||(e.Frame.ChartBorder.Right=t.Border.Right),isNaN(t.Border.Top)||(e.Frame.ChartBorder.Top=t.Border.Top)),e.Draw(),e.RequestData(),this.JSChartContainer=e,this.DivElement.JSChart=this,this.JSChartContainer.Draw()},this.CreateToolbar=function(t){},this.CreateSettingDiv=function(t){},this.Focus=function(){this.CanvasElement&&this.CanvasElement.focus()},this.ChangeSymbol=function(t,e){this.JSChartContainer&&this.JSChartContainer.ChangeSymbol(t,e)},this.ChangeIndex=function(t,e,a){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeIndex&&this.JSChartContainer.ChangeIndex(t,e,a)},this.AddIndexWindow=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddIndexWindow&&this.JSChartContainer.AddIndexWindow(t,e)},this.AddScriptIndexWindow=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddScriptIndexWindow&&this.JSChartContainer.AddScriptIndexWindow(t,e)},this.AddAPIIndexWindow=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddAPIIndexWindow&&this.JSChartContainer.AddAPIIndexWindow(t,e)},this.RemoveIndexWindow=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.RemoveIndexWindow&&this.JSChartContainer.RemoveIndexWindow(t)},this.ChangeScriptIndex=function(t,e,a){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeScriptIndex&&this.JSChartContainer.ChangeScriptIndex(t,e,a)},this.ChangePyScriptIndex=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangePyScriptIndex&&this.JSChartContainer.ChangePyScriptIndex(t,e)},this.GetIndexInfo=function(){return this.JSChartContainer&&"function"==typeof this.JSChartContainer.GetIndexInfo?this.JSChartContainer.GetIndexInfo():[]},this.ChangeInstructionIndex=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeInstructionIndex&&this.JSChartContainer.ChangeInstructionIndex(t)},this.ChangeInstructionScriptIndex=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeInstructionIndex&&this.JSChartContainer.ChangeInstructionScriptIndex(t)},this.CancelInstructionIndex=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.CancelInstructionIndex&&this.JSChartContainer.CancelInstructionIndex()},this.ChangePeriod=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangePeriod&&this.JSChartContainer.ChangePeriod(t,e)},this.ChangeRight=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeRight&&this.JSChartContainer.ChangeRight(t)},this.OverlaySymbol=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.OverlaySymbol&&this.JSChartContainer.OverlaySymbol(t,e)},this.DeleteOverlaySymbol=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.DeleteOverlaySymbol&&this.JSChartContainer.DeleteOverlaySymbol(t)},this.SetFirstShowDate=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.SetFirstShowDate&&this.JSChartContainer.SetFirstShowDate(t)},this.ChangeKLineDrawType=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeKLineDrawType&&this.JSChartContainer.ChangeKLineDrawType(t,e)},this.ChangeIndexWindowCount=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeIndexWindowCount&&this.JSChartContainer.ChangeIndexWindowCount(t,e)},this.ClearOverlaySymbol=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ClearOverlaySymbol&&this.JSChartContainer.ClearOverlaySymbol()},this.DeleteKLineInfo=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.DeleteKLineInfo&&this.JSChartContainer.DeleteKLineInfo(t)},this.ClearKLineInfo=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ClearKLineInfo&&this.JSChartContainer.ClearKLineInfo()},this.AddKLineInfo=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddKLineInfo&&this.JSChartContainer.AddKLineInfo(t,e)},this.ChangMainDataControl=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.SetMainDataConotrl&&this.JSChartContainer.SetMainDataConotrl(t)},this.AddOverlayIndex=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddOverlayIndex&&this.JSChartContainer.AddOverlayIndex(t)},this.MoveOverlayIndex=function(t,e,a){this.JSChartContainer&&"function"==typeof this.JSChartContainer.MoveOverlayIndex&&this.JSChartContainer.MoveOverlayIndex(t,e,a)},this.MoveOverlayIndexToNewWindow=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.MoveOverlayIndexToNewWindow&&this.JSChartContainer.MoveOverlayIndexToNewWindow(t,e)},this.DeleteOverlayWindowsIndex=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.DeleteOverlayWindowsIndex&&this.JSChartContainer.DeleteOverlayWindowsIndex(t)},this.StopAutoUpdate=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.StopAutoUpdate&&this.JSChartContainer.StopAutoUpdate()},this.ChartDestroy=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChartDestroy&&this.JSChartContainer.ChartDestroy()},this.ChartDestory=this.ChartDestroy,this.SetDepthMapData=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.SetDepthMapData&&this.JSChartContainer.SetDepthMapData(t,e)},this.ForceLandscape=function(t){this.JSChartContainer&&(w.Chart.Log("[JSChart::ForceLandscape] bForceLandscape="+t),this.JSChartContainer.IsForceLandscape=t)},this.LockIndex=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.LockIndex&&(w.Chart.Log("[JSChart:LockIndex] lockData",t),this.JSChartContainer.LockIndex(t))},this.ChangeTradeDate=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeTradeDate&&(w.Chart.Log("[JSChart:ChangeTradeDate] date",t),this.JSChartContainer.ChangeTradeDate(t))},this.ChangeDayCount=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeDayCount&&(w.Chart.Log("[JSChart:ChangeDayCount] count",t),this.JSChartContainer.ChangeDayCount(t,e))},this.ShowCallAuctionData=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ShowCallAuctionData&&(w.Chart.Log("[JSChart:ShowCallAuctionData] obj, option ",t,e),this.JSChartContainer.ShowCallAuctionData(t,e))},this.StartAnimation=function(t){if(this.JSChartContainer&&"function"==typeof this.JSChartContainer.StartAnimation)return w.Chart.Log("[JSChart:StartAnimation] start."),this.JSChartContainer.StartAnimation(t)},this.StopAnimation=function(){if(this.JSChartContainer&&"function"==typeof this.JSChartContainer.StopAnimation)return w.Chart.Log("[JSChart:StopAnimation] start."),this.JSChartContainer.StopAnimation()},this.SaveToImage=function(t,e){if(this.JSChartContainer&&"function"==typeof this.JSChartContainer.SaveToImage)return this.JSChartContainer.SaveToImage(t,e)},this.SaveToImageUrl=function(t,e){if(this.JSChartContainer&&"function"==typeof this.JSChartContainer.SaveToImageUrl)return this.JSChartContainer.SaveToImageUrl(t,e)},this.AddEventCallback=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddEventCallback&&(w.Chart.Log("[JSChart:AddEventCallback] ",t),this.JSChartContainer.AddEventCallback(t))},this.SetLanguage=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.SetLanguage&&(w.Chart.Log("[JSChart:SetLanguage] ",t),this.JSChartContainer.SetLanguage(t))},this.ChangeIndexTemplate=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChangeIndexTemplate&&(w.Chart.Log("[JSChart:ChangeIndexTemplate] ",t),this.JSChartContainer.ChangeIndexTemplate(t))},this.SetChartDrawOption=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.SetChartDrawOption&&(w.Chart.Log("[JSChart:SetChartDrawOption] ",t),this.JSChartContainer.SetChartDrawOption(t))},this.CreateChartDrawPicture=function(t,e){this.JSChartContainer&&"function"==typeof this.JSChartContainer.CreateChartDrawPicture&&(w.Chart.Log("[JSChart:CreateChartDrawPicture] ",t),this.JSChartContainer.CreateChartDrawPicture(t,e))},this.AddChartDrawPicture=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddChartDrawPicture&&(w.Chart.Log("[JSChart:AddChartDrawPicture] ",t),this.JSChartContainer.AddChartDrawPicture(t))},this.ClearChartDrawPicture=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ClearChartDrawPicture&&this.JSChartContainer.ClearChartDrawPicture(t)},this.ReloadResource=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ReloadResource&&(w.Chart.Log("[JSChart:ReloadResource] "),this.JSChartContainer.ReloadResource(t))},this.EnableSplashScreen=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.EnableSplashScreen&&(w.Chart.Log("[JSChart:EnableSplashScreen] "),this.JSChartContainer.EnableSplashScreen(t))},this.Draw=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.Draw&&(w.Chart.Log("[JSChart:Draw] "),this.JSChartContainer.Draw())}}V.LastVersion=null,V.Init=function(t){var e=new V(t);return e.OnSize(),e},V.SetDomain=function(t,e){t&&(Oi.Domain=t),e&&(Oi.CacheDomain=e)},V.SetPyIndexDomain=function(t){t&&(Oi.PyIndexDomain=t)},V.SetStyle=function(t){t&&Oi.SetStyle(t)},V.SetTextResource=function(t,e){bi.SetTextResource(t,e)},V.GetLocalization=function(){return bi},V.GetDevicePixelRatio=function(){return U()},V.CreateGuid=function(){return q()},V.GetResource=function(){return Oi},V.GetMinuteTimeStringData=function(){return Jr},V.GetMinuteCoordinateData=function(){return zr},V.GetKLineZoom=function(){return Wt},V.GetDivTooltipDataFormat=function(){return Ra},V.SetUSATimeType=function(t){Zr.TimeType=t,Qr.TimeType=t,jr.TimeType=t,$r.TimeType=t},V.GetChinaFuturesTimeData=function(){return qr},V.AddPeriodCallback=function(t){wt.AddPeriodCallback(t)},V.RemovePeriodCallback=function(t){wt.RemovePeriodCallback(t)},V.RegisterDrawPicture=function(t){return ka.RegisterDrawPicture(t)},V.RegisterDrawPictureIonFont=function(t){return ka.RegisterIonFont(t)},V.GetInternalTimeData=function(t){switch(t){case"NYMEXTimeData":return Zr;case"COMEXTimeData":return Qr;case"NYBOTTimeData":return jr;case"CBOTTimeData":return $r;case"LMETimeData":return tn;case"FuturesTimeData":return qr;case"TOCOMTimeData":return en;case"IPETimeData":return an;default:return null}},V.RegisterExtendChartClass=function(t,e){Ke.Add(t,e)},V.RegisterChartPaintClass=function(t,e){_t.Add(t,e)},V.RegisterScriptIndexChart=function(t,e){Nn.Add(t,e)},V.RegisterDialogClass=function(t,e){Tr.Add(t,e)};var G={RECV_KLINE_MATCH:1,RECV_INDEX_DATA:2,RECV_HISTROY_DATA:3,RECV_TRAIN_MOVE_STEP:4,CHART_STATUS:5,BARRAGE_PLAY_END:6,RECV_OVERLAY_INDEX_DATA:7,DBCLICK_KLINE:8,RECV_START_AUTOUPDATE:9,RECV_STOP_AUTOUPDATE:10,ON_CONTEXT_MENU:11,ON_TITLE_DRAW:12,ON_SELECT_RECT:13,RECV_MINUTE_DATA:14,ON_CLICK_INDEXTITLE:15,RECV_KLINE_UPDATE_DATA:16,ON_CLICK_DRAWPICTURE:17,ON_FINISH_DRAWPICTURE:18,ON_INDEXTITLE_DRAW:19,ON_CUSTOM_VERTICAL_DRAW:20,RECV_KLINE_MANUAL_UPDATE_DATA:21,ON_ENABLE_SPLASH_DRAW:22,ON_CLICK_CHART_PAINT:23,ON_DRAW_MINUTE_LAST_POINT:24,ON_DRAW_DEPTH_TOOLTIP:25,ON_CLICK:26,ON_PHONE_TOUCH:27,ON_CLICKUP_CHART_PAINT:28,ON_SPLIT_YCOORDINATE:29,ON_DBCLICK:30,ON_SPLIT_XCOORDINATE:31,ON_KEYDOWN_SELECT_RECT:32,ON_DRAG_SELECT_RECT:33,ON_DRAG_SELECT_RECT_MOUSEUP:34,ON_DRAW_KLINE_LAST_POINT:35,ON_CLICK_CROSSCURSOR_RIGHT:36,ON_PLAY_SOUND:37,ON_CALCULATE_INDEX_OX:38,ON_LOAD_DRAWPICTURE:39,ON_DRAW_COUNTDOWN:41,ON_BIND_DRAWICON:42,ON_DRAW_DEAL_VOL_COLOR:43,ON_DRAW_DEAL_TEXT:44,ON_FILTER_DEAL_DATA:45,ON_FILTER_REPORT_DATA:46,ON_CLICK_REPORT_ROW:47,ON_REPORT_MARKET_STATUS:48,ON_DBCLICK_REPORT_ROW:49,ON_RCLICK_REPORT_ROW:50,ON_CLICK_REPORT_HEADER:51,ON_RCLICK_REPORT_HEADER:52,ON_REPORT_LOCAL_SORT:53,ON_DRAW_REPORT_NAME_COLOR:54,ON_DRAW_CUSTOM_TEXT:55,ON_CLICK_REPORT_TAB:56,ON_CLICK_REPORT_TABMENU:57,ON_DRAW_REPORT_FIXEDROW_TEXT:58,ON_CLICK_REPORT_FIXEDROW:59,ON_RCLICK_REPORT_FIXEDROW:60,ON_KEYDOWN_SELECT_RECT_FIRST:61,ON_CLICK_FRAME_TOOLBAR:62,ON_REPORT_DRAG_ROW:63,ON_MOUSE_MOVE:64,ON_MINUTE_PAGE_CHANGED:65},H={OP_SCROLL_LEFT:1,OP_SCROLL_RIGHT:2,OP_ZOOM_OUT:3,OP_ZOOM_IN:4,OP_GOTO_HOME:5,OP_GOTO_END:6,OP_LEFT_ZOOM_OUT:7,OP_LEFT_ZOOM_IN:8,OP_RIGHT_ZOOM_OUT:9,OP_RIGHT_ZOOM_IN:10,OP_SCROLL_GOTO:11,OP_SET_SELECTRECT:12,OP_SET_SUB_SELECTRECT:13},Y={DISABLE_DRAG_ID:0,CLICK_TOUCH_MODE_ID:3},k={CLOSE_BEFOREOPEN_ID:1,CLOSE_OVERLAY_INDEX:2,MODIFY_INDEX_PARAM:3,CHANGE_INDEX:4,CLOSE_INDEX_WINDOW:5,OVERLAY_INDEX:6,MODIFY_OVERLAY_INDEX_PARAM:7,CHIP_DEFULT:8,CHIP_LONG:9,CHIP_RECENT:10},_={KLINE_ORDERFLOW:99,MINUTE_MULTI_DAY_EXTENDDATA:21,KLINE_COLOR_DATA:66};function X(){this.Start=[],this.Clear=function(){this.Start=[]},this.AddTouchStart=function(t,e,a){if(this.Start.length>0){var i=this.Start[this.Start.length-1],r=a-i.Time;r>0&&r<300?this.Start.push({X:t,Y:e,Time:a}):this.Start=[]}else this.Start.push({X:t,Y:e,Time:a})},this.IsVaildDBClick=function(){return 2==this.Start.length},this.AddTouchEnd=function(t){if(!(this.Start.length<=0)){var e=this.Start[this.Start.length-1],a=t-e.Time;a>=0&&a<150||(this.Start=[])}}}function W(t,e){var a=this;this.ClassName="JSChartContainer";this.Frame,this.ChartPaint=new Array,this.ChartPaintEx=[],this.ChartInfo=new Array,this.ChartInfoPaint,this.ExtendChartPaint=new Array,this.TitlePaint=new Array,this.OverlayChartPaint=new Array,this.ChartDrawPicture=new Array,this.ChartDrawStorage,this.ChartDrawOption={IsLockScreen:!1,Zoom:1},this.CurrentChartDrawPicture=null,this.SelectChartDrawPicture=null,this.MoveOnChartDrawPicture=null,this.IsDrawPictureXY=!1,this.EnableShowCorssCursor={DrawPicture:!0},this.ChartPictureMenu,this.ChartCorssCursor,this.IsClickShowCorssCursor=!1,this.ChartSplashPaint=null,this.LoadDataSplashTitle="æ°æ®å è½½ä¸­",e?(this.Canvas=e.getContext("2d"),this.OffscreenCanvasElement=e,this.ShowCanvas=t.getContext("2d")):(this.Canvas=t.getContext("2d"),this.ShowCanvas=null),this.UIElement=t,this.MouseDrag,this.PhoneTouchInfo,this.DragMode=1,this.EnableBorderDrag=!0,this.BorderDrag,this.YDrag,this.TouchStatus={CorssCursorShow:!1},this.DragTimer,this.EnableScrollUpDown=!1,this.ClickChartTimer=null,this.CursorIndex=0,this.LastPoint=new at,this.IsForceLandscape=!1,this.CorssCursorTouchEnd=!1,this.IsTitleShowLatestData=!1,this.StepPixel=4,this.ZoomStepPixel=5,this.TouchMoveMinAngle=70,this.EnableAnimation=!1,this.Tooltip=document.createElement("div"),this.Tooltip.className="jschart-tooltip",this.Tooltip.style.background=Oi.TooltipBGColor,this.Tooltip.style.opacity=Oi.TooltipAlpha,this.Tooltip.style["pointer-events"]="none",this.Tooltip.id=q(),t.parentNode.appendChild(this.Tooltip),this.IsShowTooltip=!0,this.SelectRect=document.createElement("div"),this.SelectRect.className="jschart-selectrect",this.SelectRect.style.background=Oi.SelectRectBGColor,this.SelectRect.style["pointer-events"]="none",this.SelectRect.id=q(),this.SelectRect.oncontextmenu=function(){return!1},t.parentNode.appendChild(this.SelectRect),this.SelectRectRightMenu,this.FrameSplitData=new E.default,this.FrameSplitData.set("double",new Ai),this.FrameSplitData.set("price",new Ni),this.mapEvent=new E.default,this.IsOnTouch=!1,this.TouchDrawCount=0,this.DisableMouse=!1,this.LanguageID=Ri.LANGUAGE_CHINESE_ID,this.PressTime=500,this.NetworkFilter,this.LastMouseStatus={},this.ClickDownPoint,this.IsDestroy=!1,this.EnableYDrag={Left:!1,Right:!1},this.EnableZoomIndexWindow=!1,this.PhoneDBClick=new X,this.SelectedChart={EnableSelected:!1,EnableMoveOn:!1,Selected:{Identify:null},MoveOn:{Identify:null}},this.IndexChartDrag,this.EnableIndexChartDrag=!1,this.GlobalOption={IsValueFullRange:!1},this.ChartDestroy=function(){this.IsDestroy=!0,this.StopAutoUpdate(),null!=this.GetLatestVersionTimer&&(clearTimeout(this.GetLatestVersionTimer),this.GetLatestVersionTimer=null)},this.ChartDestory=this.ChartDestroy,this.GetLatestVersionTimer=null,this.GetLatestVersion=function(){var t=this;null!=this.GetLatestVersionTimer&&(clearTimeout(this.GetLatestVersionTimer),this.GetLatestVersionTimer=null);var e=Math.floor(50*Math.random()),a=18e4+1e3*e,i="aHR0cHM6Ly9ocWNoYXJ0LnplYWxpbmsuY29tL2FwaS9HZXRWZXJzaW9u";w.Chart.Log("[JSChartContainer::GetLatestVersion] wait for get hqchart latest version. ",a),this.GetLatestVersionTimer=setTimeout((function(){var e=0,a=0;t.Frame&&t.Frame.ChartBorder&&(e=t.Frame.ChartBorder.GetChartWidth(),a=t.Frame.ChartBorder.GetChartHeight());var r=atob(i)+"?width="+e+"&height="+a+"&type=h5";null==V.LastVersion&&O.HttpRequest({url:r,type:"get",dataType:"json",async:!0,success:function(t){w.Chart.Log("[JSChartContainer::GetLatestVersion] hqchart latest version. ",t),V.LastVersion=t},error:function(t,e,a){w.Chart.Log("[JSChartContainer::GetLatestVersion] Get HQChart latest version failed.",t)}})}),a)},this.AddEventCallback=function(t){if(t&&t.event&&t.callback){var e={Callback:t.callback,Source:t};this.mapEvent.set(t.event,e)}},this.RemoveEventCallback=function(t){this.mapEvent.has(t)&&this.mapEvent.delete(t)},this.GetEventCallback=function(t){if(!this.mapEvent.has(t))return null;var e=this.mapEvent.get(t);return e},this.GetIndexEvent=function(){return this.GetEventCallback(G.RECV_INDEX_DATA)},this.GetOverlayIndexEvent=function(){return this.GetEventCallback(G.RECV_OVERLAY_INDEX_DATA)},t.onmousemove=function(t){a.UIOnMouseMove(t)},t.oncontextmenu=function(t){return a.UIOnContextMenu(t)},t.ondblclick=function(t){a.UIOnDblClick(t)},t.onmousedown=function(t){a.UIOnMouseDown(t)},t.onmouseout=function(t){a.UIOnMounseOut(t)},t.onmouseleave=function(t){a.UIOnMouseleave(t)},this.UIOnMouseMove=function(t){var e=U(),a=(t.clientX-this.UIElement.getBoundingClientRect().left)*e,i=(t.clientY-this.UIElement.getBoundingClientRect().top)*e;if(this.MoveOnChartDrawPicture=null,(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash)&&1!=this.DisableMouse&&!this.BorderDrag&&!this.YDrag&&!this.IndexChartDrag){var r={X:a,Y:i,IsInClient:this.IsMouseOnClient(a,i)};this.LastMouseStatus.OnMouseMove=r,this.LastMouseStatus.MoveOnPoint={X:a,Y:i};var n=this.GetEventCallback(G.ON_MOUSE_MOVE),s=this.TitlePaint[0];n&&s&&(s.OnMouseMoveEvent=n),this.MoveOnPoint={X:a,Y:i},this.OnMouseMove(a,i,t),this.LastMouseStatus.MoveOnPoint=null,s&&(s.OnMouseMoveEvent=null)}},this.IsMouseOnClient=function(t,e){var a=!1;return this.Canvas.beginPath(),this.Canvas.rect(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetTop(),this.Frame.ChartBorder.GetWidth(),this.Frame.ChartBorder.GetHeight()),a=this.Canvas.isPointInPath(t,e),a},this.UIOnContextMenu=function(t){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var e=t.clientX-this.UIElement.getBoundingClientRect().left,a=t.clientY-this.UIElement.getBoundingClientRect().top;return"function"==typeof this.OnRightMenu&&this.OnRightMenu(e,a,t),!1}},this.UIOnDblClick=function(t){var e=U(),a=(t.clientX-this.UIElement.getBoundingClientRect().left)*e,i=(t.clientY-this.UIElement.getBoundingClientRect().top)*e;this.OnDoubleClick(a,i,t)},this.TryYDrag=function(t,e){if(!this.EnableYDrag)return null;if(!this.EnableYDrag.Left&&!this.EnableYDrag.Right)return null;if(!this.Frame||!this.Frame.PtInFrameY)return null;var a=this.Frame.PtInFrameY(t,e);return!a||a.Index<0||1==a.IsOverlay?null:a.Left&&this.EnableYDrag.Left&&this.Frame.IsEnableDragY(a.Index)||a.Right&&this.EnableYDrag.Right&&this.Frame.IsEnableDragY(a.Index)?a:null},this.TryUpDownDrag=function(t,e){var a=this.Frame.PtInFrame(t,e);if(a<0)return null;var i=this.Frame.SubFrame[a];if(!i||!i.Frame)return null;var r=i.Frame;return r.YSplitOperator&&r.YSplitOperator.FixedYMaxMin?{Index:a,X:t,Y:e}:null},this.TryRectSelectDrag=function(t,e){var a=this.GetRectSelectPaint();if(!a)return null;if(a.GetPointCount()<=0)return null;var i=a.PtInPaint(t,e);return{Item:i,X:t,Y:e}},this.TryClickCrossCursor=function(t,e,a){if(this.ChartCorssCursor){var i=this.ChartCorssCursor.PtInButton(t,e);if(!i)return!1;var r=this.GetEventCallback(G.ON_CLICK_CROSSCURSOR_RIGHT);if(r&&r.Callback){var n={Button:i,e:a};r.Callback(r,n,this)}return!0}},this.UIOnMouseDown=function(t){var e=this;if(this.MoveOnChartDrawPicture=null,!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){this.ClickDownPoint={X:t.clientX,Y:t.clientY},this.IsOnTouch=!0,this.BorderDrag=null,this.YDrag=null,this.UpDownDrag=null,this.RectSelectDrag=null,this.IndexChartDrag=null;var a=U(),i=(t.clientX-this.UIElement.getBoundingClientRect().left)*a,r=(t.clientY-this.UIElement.getBoundingClientRect().top)*a,n=this.Frame.PtInButtons(i,r);if(n&&this.ClickFrameButton)this.ClickFrameButton(n,t);else if(n=this.PtInExtendChartButtons(i,r),n&&this.ClickExtendChartButton)this.ClickExtendChartButton(n,t);else if(!this.TryClickCrossCursor(i,r,t)&&(!this.TryClickLock||!this.TryClickLock(i,r))){this.HideSelectRect(),this.SelectRectRightMenu&&this.SelectRectRightMenu.Hide(),this.ChartPictureMenu&&this.ChartPictureMenu.Hide();var s=this.GetRectSelectPaint();if(s&&s.GetPointCount()>0){var o=s.PtInPaint(i,r);o&&(3==o.Type?(this.UIElement.style.cursor="pointer",this.RectSelectDrag={Click:{X:t.clientX,Y:t.clientY},LastMove:{X:t.clientX,Y:t.clientY}}):(this.UIElement.style.cursor="ew-resize",this.RectSelectDrag={Index:o.PointIndex}),w.Chart.Log("[JSChartContainer::UIOnMouseDown] drag rect select ",o))}if(!this.RectSelectDrag&&this.ClearRectSelect(!1)&&this.Draw(),this.EnableBorderDrag&&this.Frame){var h=this.Frame.PtInFrameBorder(i,r);h&&h.Index>=0&&(this.UIElement.style.cursor="n-resize",this.BorderDrag={Index:h.Index},w.Chart.Log("[JSChartContainer::UIOnMouseDown] DragBorder ",h))}if(!this.BorderDrag){var l=this.TryYDrag(i,r);if(l)this.UIElement.style.cursor=0==l.Position?"n-resize":"row-resize",this.YDrag=l,w.Chart.Log("[JSChartContainer::UIOnMouseDown] dragY ",l);else{var u=this.TryUpDownDrag(i,r);u&&(this.UIElement.style.cursor="pointer",this.UpDownDrag=u,w.Chart.Log("[JSChartContainer::UIOnMouseDown] dragUpDown ",u))}}if(0!=this.DragMode){var C={Click:{},LastMove:{}};C.Click.X=t.clientX,C.Click.Y=t.clientY,C.Click.IsInFrameBottom=this.Frame.PtInFrameBottom(i,r),C.LastMove.X=t.clientX,C.LastMove.Y=t.clientY,this.MouseDrag=C;var D=this.GetActiveDrawPicture(),f={Chart:this.SelectedChart.Selected.Chart,Identify:this.SelectedChart.Selected.Identify};if(this.SelectChartDrawPicture=null,this.BorderDrag);else if(this.YDrag||this.RectSelectDrag);else if(this.CurrentChartDrawPicture){this.UpDownDrag=null;var c=this.CurrentChartDrawPicture;2==c.Status?this.SetChartDrawPictureThirdPoint(C.Click.X,C.Click.Y):(this.SetChartDrawPictureFirstPoint(C.Click.X,C.Click.Y),this.FinishChartDrawPicturePoint()&&this.DrawDynamicInfo()),!D.Select.Guid||this.CurrentChartDrawPicture&&D.Select.Guid==this.CurrentChartDrawPicture.Guid||D.Select.Chart.IsDrawMain&&this.Draw()}else{var d={};if(d.X=(t.clientX-this.UIElement.getBoundingClientRect().left)*a,d.Y=(t.clientY-this.UIElement.getBoundingClientRect().top)*a,this.GetChartDrawPictureByPoint(d)){if(1==d.ChartDrawPicture.EnableMove){this.UpDownDrag=null,this.CurrentChartDrawPicture=d.ChartDrawPicture,this.SelectChartDrawPicture=d.ChartDrawPicture;var m=!1;(D.Select.Guid&&D.Select.Chart&&D.Select.Chart.IsDrawMain||d.ChartDrawPicture.IsDrawMain)&&(m=!0),m&&this.Draw(),d.ChartDrawPicture.Status=20,d.ChartDrawPicture.ValueToPoint(),d.ChartDrawPicture.MovePointIndex=d.PointIndex,this.SelectChartDrawPicture.DragInfo={Click:{X:t.clientX,Y:t.clientY}}}else this.CurrentChartDrawPicture=null,this.SelectChartDrawPicture=null;var v=this.GetEventCallback(G.ON_CLICK_DRAWPICTURE);if(v&&v.Callback){var S={DrawPicture:d.ChartDrawPicture};v.Callback(v,S,this)}else this.OnSelectChartPicture(d.ChartDrawPicture)}else{null!=this.ClickChartTimer&&(clearTimeout(this.ClickChartTimer),this.ClickChartTimer=null);var I=this,p={X:this.ClickDownPoint.X,Y:this.ClickDownPoint.Y};this.ClickChartTimer=setTimeout((function(){I.TryClickPaintEvent(G.ON_CLICK_CHART_PAINT,p,t)}),250);var T=!1;if(this.SelectedChart.EnableSelected){var g=this.PtInChart(i,r);g?(this.SelectedChart.Selected.Identify!=g.Identify&&(this.SelectedChart.Selected.Identify=g.Identify,this.SelectedChart.Selected.Chart=g.Chart,T=!0),this.EnableIndexChartDrag&&(this.IndexChartDrag={SelectedChart:g,LastMove:{X:i,Y:r},Click:{X:i,Y:r}},this.IndexChartDrag.Info=this.GetSelectedChartInfo(g),this.IndexChartDrag.Info&&(this.IndexChartDrag.Info.FrameID=this.Frame.PtInFrame(i,r)))):this.SelectedChart.Selected.Identify&&(this.SelectedChart.Selected.Identify=null,this.SelectedChart.Selected.Chart=null,T=!0)}else this.SelectedChart.Selected.Identify&&(this.SelectedChart.Selected.Identify=null,T=!0);if(null!=D.Select.Guid&&null==this.SelectChartDrawPicture||T){var x=0;if(D.Select.Guid&&D.Select.Chart&&D.Select.Chart.IsDrawMain&&(x=1),T){var F=f.Chart;F&&F.SetSelectedStatus&&(F.SetSelectedStatus(0),x=1),F=this.SelectedChart.Selected.Chart,F&&F.SetSelectedStatus&&(F.SetSelectedStatus(1),x=1)}1==x?this.Draw():this.DrawDynamicInfo()}}}document.onmousemove=function(t){e.DocOnMouseMove(t)},document.onmouseup=function(t){e.DocOnMouseUp(t)}}}}},this.DocOnMouseMove=function(e){if(!this.ChartSplashPaint||1!=this.IsEnableSplash){var a=this.MouseDrag;if(a){var i=Math.abs(a.LastMove.X-e.clientX),r=Math.abs(a.LastMove.Y-e.clientY),n=this.RectSelectDrag&&this.RectSelectDrag.Index>=0;if(this.BorderDrag&&this.BorderDrag.Index>=0){if(Math.abs(a.LastMove.Y-e.clientY)<5)return;var s=e.clientY-a.LastMove.Y;this.OnMoveFromeBorder(this.BorderDrag.Index,s),a.LastMove.X=e.clientX,a.LastMove.Y=e.clientY}else if(this.YDrag&&this.YDrag.Index>=0){if(r<5)return;s=e.clientY-a.LastMove.Y;w.Chart.Log("[JSChartContainer::DocOnMouseMove] YDrag ",this.YDrag,s),this.OnZoomUpDownFrameY(this.YDrag,s),a.LastMove.X=e.clientX,a.LastMove.Y=e.clientY}else if(this.IndexChartDrag&&this.IndexChartDrag.SelectedChart){if(Math.abs(a.LastMove.Y-e.clientY)<2&&Math.abs(a.LastMove.X-e.clientX)<2)return;var o=this.GetExtendChartByClassName("DragMovePaint");if(o&&o.Chart){var h=U(),l=(e.clientX-this.UIElement.getBoundingClientRect().left)*h,u=(e.clientY-this.UIElement.getBoundingClientRect().top)*h;o.Chart.Point={X:l,Y:u},o.Chart.IsShow=!0,o.Chart.Info=this.IndexChartDrag.Info,this.DrawDynamicInfo()}this.IndexChartDrag.LastMove.X=l,this.IndexChartDrag.LastMove.Y=u,a.LastMove.X=e.clientX,a.LastMove.Y=e.clientY}else if(this.CurrentChartDrawPicture){var C=this.CurrentChartDrawPicture;if(1==C.Status||2==C.Status){if(Math.abs(a.LastMove.X-e.clientX)<5&&Math.abs(a.LastMove.Y-e.clientY)<5)return;this.SetChartDrawPictureSecondPoint(e.clientX,e.clientY)&&this.DrawDynamicInfo()}else if(3==C.Status)this.SetChartDrawPictureThirdPoint(e.clientX,e.clientY)&&this.DrawDynamicInfo();else if(20==C.Status){if(Math.abs(a.LastMove.X-e.clientX)<5&&Math.abs(a.LastMove.Y-e.clientY)<5)return;this.SelectChartDrawPicture&&this.SelectChartDrawPicture.DragInfo&&(this.SelectChartDrawPicture.DragInfo.Move={X:e.clientX,Y:e.client}),this.MoveChartDrawPicture(e.clientX-a.LastMove.X,e.clientY-a.LastMove.Y)&&this.DrawDynamicInfo()}a.LastMove.X=e.clientX,a.LastMove.Y=e.clientY}else if(1==this.DragMode||n)this.OnDragMode_One({X:i,Y:r},e);else if(2==this.DragMode){var D=Math.abs(a.LastMove.Y-e.clientY);if(i<5&&D<5)return;this.UIElement.style.cursor="default";l=a.Click.X-t.getBoundingClientRect().left,u=a.Click.Y-t.getBoundingClientRect().top;var f=e.clientX-t.getBoundingClientRect().left,c=e.clientY-t.getBoundingClientRect().top;this.ShowSelectRect(l,u,f,c),a.LastMove.X=e.clientX,a.LastMove.Y=e.clientY}}}},this.OnDragMode_One=function(t,e){var a=t.X,i=t.Y,r=this.MouseDrag;if(!(a<5&&i<5)){var n=!1,s=!1;if(i>=5&&this.UpDownDrag&&this.UpDownDrag.Index>=0){var o=e.clientY-r.LastMove.Y;w.Chart.Log("[JSChartContainer::OnDragMode_One] UpDownDrag ",this.UpDownDrag,o),this.UIElement.style.cursor="pointer",this.OnUpDonwFrameY(this.UpDownDrag,o)&&(n=!0,s=!0),r.LastMove.Y=e.clientY}if(a>=5){var h=!0;if(r.LastMove.X<e.clientX&&(h=!1),this.RectSelectDrag&&this.RectSelectDrag.Index>=0){var l={X:e.clientX,Y:e.clientY,PointIndex:this.RectSelectDrag.Index,Name:"MoveRectSelectLine"};this.MoveRectSelectPoint(l)&&(n=!0)}else{var u="pointer";r.Click.IsInFrameBottom&&(u="ew-resize");var C=this.GetMoveOneStepWidth();if(a<C)return this.UIElement.style.cursor=u,void(n&&this.Draw());r.Click&&r.Click.IsInFrameBottom?this.XCoordinateZoom(a,h)&&(this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),n=!0):this.DataMove(a,h)?(this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),n=!0):s||this.DragDownloadData&&this.DragDownloadData(),this.UIElement.style.cursor=u}r.LastMove.X=e.clientX}n&&(this.Draw(),this.OnKLinePageChange("datamove"))}},this.DocOnMouseUp=function(e){document.onmousemove=null,document.onmouseup=null;var a="MinuteChartContainer"==this.ClassName||"MinuteChartHScreenContainer"==this.ClassName,i=this.RectSelectDrag&&this.RectSelectDrag.Index>=0,r=!0;if(this.CurrentChartDrawPicture){var n=this.CurrentChartDrawPicture;2==n.Status||1==n.Status||3==n.Status?(n.PointStatus=n.Status,this.FinishChartDrawPicturePoint()?this.DrawDynamicInfo():r=!1):20==n.Status&&this.FinishMoveChartDrawPicture()&&this.DrawDynamicInfo()}else if(this.IndexChartDrag&&this.IndexChartDrag.SelectedChart){var s=this.GetExtendChartByClassName("DragMovePaint");s&&s.Chart&&s.Chart.Clear(),this.OnDragChart(this.IndexChartDrag)||this.DrawDynamicInfo(),this.UIElement.style.cursor="default"}else if(i)this.OnDragSelectRectMouseUp&&this.OnDragSelectRectMouseUp(e);else if(a)this.OnMinuteSelectRectMouseUp&&this.OnMinuteSelectRectMouseUp(e);else if(2==this.DragMode){var o=this.MouseDrag;o.LastMove.X=e.clientX,o.LastMove.Y=e.clientY;var h=new it,l=U();if(h.XStart=(o.Click.X-t.getBoundingClientRect().left)*l,h.YStart=(o.Click.Y-t.getBoundingClientRect().top)*l,h.XEnd=(o.LastMove.X-t.getBoundingClientRect().left)*l,h.YEnd=(o.LastMove.Y-t.getBoundingClientRect().top)*l,h.JSChartContainer=this,h.Stock={Symbol:this.Symbol,Name:this.Name},!this.BorderDrag&&this.GetSelectRectData(h)){var u=this.GetEventCallback(G.ON_SELECT_RECT),C=this.GetRectSelectPaint(),D=!0;if(u&&u.Callback){var f={X:o.LastMove.X-t.getBoundingClientRect().left,Y:o.LastMove.Y-t.getBoundingClientRect().top,SelectData:h,RectSelectPaint:C,IsShowMenu:!0};u.Callback(u,f,this),D=f.IsShowMenu}a?(this.HideSelectRect(),this.UpdateSelectRect(h.Start,h.End)):D&&this.SelectRectRightMenu&&(e.data={Chart:this,X:o.LastMove.X-t.getBoundingClientRect().left,Y:o.LastMove.Y-t.getBoundingClientRect().top,SelectData:h,RectSelectPaint:C},this.SelectRectRightMenu.DoModal(e))}else this.TryClickPaintEvent(G.ON_CLICKUP_CHART_PAINT,this.ClickDownPoint,e)}else this.TryClickPaintEvent(G.ON_CLICKUP_CHART_PAINT,this.ClickDownPoint,e),this.ClickEvent(e);w.Chart.Log("[KLineChartContainer::document.onmouseup]",e),this.SelectChartDrawPicture&&(this.SelectChartDrawPicture.DragInfo=null),this.UIElement.style.cursor="default",this.MouseDrag=null,this.ClickDownPoint=null,this.IsOnTouch=!1,this.BorderDrag&&this.BorderDrag.Index>=0&&this.Frame.SaveSubFrameHeightRate(),this.BorderDrag=null,this.YDrag=null,this.UpDownDrag=null,this.RectSelectDrag=null,this.IndexChartDrag=null,!0===r&&(this.CurrentChartDrawPicture=null)},this.UIOnMounseOut=function(t){w.Chart.Log("[KLineChartContainer::UIOnMounseOut]",t),this.UIOnMouseMove(t)},this.UIOnMouseleave=function(t){w.Chart.Log("[KLineChartContainer::UIOnMouseleave]",t)},this.OnDragChart=function(t){if(!t)return!1;var e=t.Info,a=t.LastMove,i=e.FrameID,r=this.Frame.PtInFrame(a.X,a.Y);return r<0?-3==r&&this.MoveIndexToNewWindow({WindowIndex:i,IndexID:e.IndexID},{Operator:0}):i!=r&&this.MoveIndex({WindowIndex:i,IndexID:e.IndexID},{WindowIndex:r},{Operator:0})},this.GetSelectedChartInfo=function(t){if(!t)return null;var e={Type:0},a=t.Identify;if("Main-KLine"==a)e.Name=this.Name,e.Symbol=this.Symbol,e.Type=ra.MAIN_KLINE;else if(0==a.indexOf("Overlay-KLine-"))e.Name=t.Chart.Title,e.Symbol=t.Chart.Symbol,e.Type=ra.OVERLAY_KLINE;else if(0==a.indexOf("Overlay-Minute-"))e.Name=t.Chart.Title,e.Symbol=t.Chart.Symbol,e.Type=ra.OVERLAY_MINUTE;else if("Minute-Line"==a)e.Name=this.Name,e.Symbol=this.Symbol,e.Type=ra.MAIN_MINUTE;else if("Minute-Average-Line"==a)e.Name=this.Name,e.Symbol=this.Symbol,e.Type=ra.MAIN_AVERAGE_MINUTE;else if("Minute-Vol-Bar"==a)e.Name=this.Name,e.Symbol=this.Symbol,e.Type=ra.MAIN_MINUTE_VOL;else if(0==a.indexOf("guid"))for(var i=0;i<this.TitlePaint.length;++i){var r=this.TitlePaint[i];if("DynamicChartTitlePainting"==r.ClassName){if(r.Identify==a){e.IndexName=r.Title,e.IndexID=a,e.Type=ra.MAIN_INDEX;break}var n=!0,s=!1,o=void 0;try{for(var h,l=(0,T.default)(r.OverlayIndex);!(n=(h=l.next()).done);n=!0){var u=h.value;if(u[0]==a){e.IndexName=u[1].Title,e.IndexID=a,e.Type=ra.OVERLAY_INDEX;break}}}catch(C){s=!0,o=C}finally{try{!n&&l.return&&l.return()}finally{if(s)throw o}}if(e.Type>0)break}}return e},this.ClickEvent=function(e){var a=this.GetEventCallback(G.ON_CLICK);if(!a||!a.Callback)return!1;if(this.ClickDownPoint.X!=e.clientX||this.ClickDownPoint.Y!=e.clientY)return!1;var i=U(),r=(e.clientX-t.getBoundingClientRect().left)*i,n=(e.clientY-t.getBoundingClientRect().top)*i,s={X:e.clientX,Y:e.clientY,FrameID:-1},o=!1;if(this.Canvas.beginPath(),this.Canvas.rect(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetTop(),this.Frame.ChartBorder.GetWidth(),this.Frame.ChartBorder.GetHeight()),o=this.Canvas.isPointInPath(r,n),o){var h={},l=this.Frame.GetYData(n,h);if(ha.IsNumber(h.FrameID)&&h.FrameID>=0){var u=this.Frame.GetXData(r);s.FrameID=h.FrameID,s.Data={X:u,Y:l}}}return a.Callback(a,s,this),!0},this.DBClickEvent=function(e,a){var i=this.GetEventCallback(G.ON_DBCLICK);if(!i||!i.Callback)return!1;var r=U(),n=(a.clientX-t.getBoundingClientRect().left)*r,s=(a.clientY-t.getBoundingClientRect().top)*r,o={X:a.clientX,Y:a.clientY,FrameID:-1,ClientPos:-1},h=this.PtInClient(n,s);if(o.ClientPos=h,h>0){var l={},u=this.Frame.GetYData(s,l);if(ha.IsNumber(l.FrameID)&&l.FrameID>=0){var C=this.Frame.GetXData(n);o.FrameID=l.FrameID,o.Data={X:C,Y:u},this.GetDataItem&&(o.Data.Item=this.GetDataItem({ClientPos:h,Index:C,Point:{X:n,Y:s}}))}}return e&&e.SelectedChart&&(o.SelectedChart=this.GetSelectedChartInfo(e.SelectedChart)),i.Callback(i,o,this),!0},this.PtInChartPaintTooltip=function(t,e,a){for(var i=0;i<this.ChartPaint.length;++i){var r=this.ChartPaint[i];if(r.GetTooltipData(t,e,a))return r}return null},this.PtInOverlayChartPaintTooltip=function(t,e,a){for(var i=0;i<this.OverlayChartPaint.length;++i){var r=this.OverlayChartPaint[i];if(r.GetTooltipData(t,e,a))return r}return null},this.TryClickPaintEvent=function(e,a,i){var r=this.GetEventCallback(e);if(r&&r.Callback&&a.X==i.clientX&&a.Y==i.clientY){var n=U(),s=(i.clientX-t.getBoundingClientRect().left)*n,o=(i.clientY-t.getBoundingClientRect().top)*n,h=new Ht,l=null,u=this.PtInChartPaintTooltip(s,o,h);if(u&&(l={Symbol:this.Symbol,Name:this.Name}),u||(u=this.PtInOverlayChartPaintTooltip(s,o,h),u&&(l={Symbol:h.ChartPaint.Symbol,Name:h.ChartPaint.Title})),h.Data){var C={X:i.clientX,Y:i.clientY,Stock:l,Tooltip:h};return r.Callback(r,C,this),!0}}return!1},this.IsPhoneDragging=function(t){var e=t.changedTouches.length,a=t.touches.length;return 1==e&&1==a},this.IsPhonePinching=function(t){var e=t.changedTouches.length,a=t.touches.length;return(1==e||2==e)&&2==a},this.PreventTouchEvent=function(t){t.cancelable&&t.preventDefault(),t.stopPropagation()},this.GetToucheData=function(t,e){for(var a=new Array,i=U(),r=0;r<t.touches.length;++r){var n=t.touches[r];e?a.push({clientX:n.clientY*i,clientY:n.clientX*i,pageX:n.pageY*i,pageY:n.pageX*i}):a.push({clientX:n.clientX*i,clientY:n.clientY*i,pageX:n.pageX*i,pageY:n.pageY*i})}return a},this.IsSingleTouch=function(t){var e=t.touches.length;return 1==e},this.StopDragTimer=function(){ha.IsNumber(this.DragTimer)&&(clearTimeout(this.DragTimer),this.DragTimer=null)},this.GetMoveAngle=function(t,e){var a=Math.abs(t.X-e.X),i=Math.abs(t.Y-e.Y),r=180*Math.atan(a/i)/Math.PI;return r},t.ontouchstart=function(t){a.OnTouchStart(t)},t.ontouchmove=function(t){a.OnTouchMove(t)},t.ontouchend=function(t){a.OnTouchEnd(t)},this.AddPhoneDBClickInfo=function(t,e,a){var i={X:t,Y:e,Time:a};this.PhoneDBClickInfo.Start.push(i)},this.ClearPhoneDBClickInfo=function(){this.PhoneDBClickInfo.Start=[]},this.IsShortPhoneClick=function(t,e,a){},this.OnTouchStart=function(t){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){this.IsOnTouch=!0,this.TouchDrawCount=0,this.PhonePinch=null,this.StopDragTimer();var e=this.IsSingleTouch(t);if((0==this.EnableScrollUpDown||!e||this.DragMode==Y.CLICK_TOUCH_MODE_ID&&1==this.TouchStatus.CorssCursorShow)&&t.cancelable&&t.preventDefault(),this.IsPhoneDragging(t)){var a=this.GetToucheData(t,this.IsForceLandscape),i=this.PointAbsoluteToRelative(a[0].clientX,a[0].clientY,!0);if(this.TryClickLock||this.TryClickIndexTitle){var r=i.X,n=i.Y;if(this.TryClickLock&&this.TryClickLock(r,n))return;if(this.TryClickIndexTitle&&this.TryClickIndexTitle(r,n))return}if(this.ClickFrameButton){var s=this.Frame.PtInButtons(i.X,i.Y);if(s)return void this.ClickFrameButton(s,t)}var o=!0;this.ChartDrawOption.IsLockScreen?o=!1:this.DragMode==Y.CLICK_TOUCH_MODE_ID?1==this.TouchStatus.CorssCursorShow&&(o=!1):this.DragMode==Y.DISABLE_DRAG_ID?o=!1:e||(o=!1);var h={Click:{},LastMove:{}};h.Click.X=a[0].clientX,h.Click.Y=a[0].clientY,h.LastMove.X=a[0].clientX,h.LastMove.Y=a[0].clientY,this.MouseDrag=h,this.PhoneTouchInfo={Start:{X:a[0].clientX,Y:a[0].clientY},End:{X:a[0].clientX,Y:a[0].clientY}},this.SelectChartDrawPicture&&(this.SelectChartDrawPicture.IsSelected=!1),this.SelectChartDrawPicture=null;if(this.CurrentChartDrawPicture){var l=this.CurrentChartDrawPicture;return 2==l.Status?this.SetChartDrawPictureThirdPoint(h.Click.X,h.Click.Y,!0):(this.SetChartDrawPictureFirstPoint(h.Click.X,h.Click.Y,!0),this.FinishChartDrawPicturePoint()&&this.DrawDynamicInfo({Corss:!1,Tooltip:!1})),void(t.cancelable&&t.preventDefault())}i=this.PointAbsoluteToRelative(a[0].clientX,a[0].clientY,!0);var u={X:i.X,Y:i.Y};U();if(this.GetChartDrawPictureByPoint(u)){u.ChartDrawPicture.Status=20,u.ChartDrawPicture.ValueToPoint(),u.ChartDrawPicture.MovePointIndex=u.PointIndex,u.ChartDrawPicture.IsSelected=!0,this.CurrentChartDrawPicture=u.ChartDrawPicture,this.SelectChartDrawPicture=u.ChartDrawPicture;var C=this.GetEventCallback(G.ON_CLICK_DRAWPICTURE);if(C&&C.Callback){var D={DrawPicture:u.ChartDrawPicture};C.Callback(C,D,this)}return void(t.cancelable&&t.preventDefault())}if(o){var f=this;this.DragTimer=setTimeout((function(){if(h.Click.X==h.LastMove.X&&h.Click.Y==h.LastMove.Y){f.MouseDrag;f.MouseDrag=null,f.DragMode==Y.CLICK_TOUCH_MODE_ID&&(f.TouchStatus.CorssCursorShow=!0),f.MoveCorssCursor(h.Click,t)}}),f.PressTime)}this.EnableZoomIndexWindow&&(this.PhoneDBClick.AddTouchStart(a[0].clientX,a[0].clientY,Date.now()),w.Chart.Log("[JSChartContainer::OnTouchStart] PhoneDBClick ",this.PhoneDBClick)),this.ChartDrawOption.IsLockScreen?this.MouseDrag=null:this.DragMode==Y.CLICK_TOUCH_MODE_ID||(this.DragMode==Y.DISABLE_DRAG_ID?(this.MouseDrag=null,this.MoveCorssCursor(h.Click,t)):this.IsClickShowCorssCursor&&this.MoveCorssCursor(h.Click,t)),this.TouchEvent({EventID:G.ON_PHONE_TOUCH,FunctionName:"OnTouchStart"},t)}else if(this.IsPhonePinching(t)){var c={Start:{},Last:{}};a=this.GetToucheData(t,this.IsForceLandscape);c.Start={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY},c.Last={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY},this.PhonePinch=c,this.SelectChartDrawPicture=null}}},this.OnTouchMove=function(e){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var a=this.GetToucheData(e,this.IsForceLandscape);if(this.IsPhoneDragging(e)){var i=this.MouseDrag;if(null==i)this.IsForceLandscape&&(y=t.getBoundingClientRect().width-a[0].clientY),this.ChartDrawOption.IsLockScreen||this.MoveCorssCursor({X:a[0].clientX,Y:a[0].clientY},e);else{var r=this.GetMoveAngle(i.LastMove,{X:a[0].clientX,Y:a[0].clientY}),n=Math.abs(i.LastMove.X-a[0].clientX),s=Math.abs(i.LastMove.Y-a[0].clientY);n=parseInt(n);var o=this.DragMode==Y.CLICK_TOUCH_MODE_ID&&1==this.TouchStatus.CorssCursorShow;if(this.CurrentChartDrawPicture){var h=this.CurrentChartDrawPicture;if(1==h.Status||2==h.Status){if(n<5&&s<5)return;this.SetChartDrawPictureSecondPoint(a[0].clientX,a[0].clientY,!0)&&this.DrawDynamicInfo()}else if(3==h.Status)this.SetChartDrawPictureThirdPoint(a[0].clientX,a[0].clientY,!0)&&this.DrawDynamicInfo();else if(20==h.Status){if(n<5&&s<5)return;this.MoveChartDrawPicture(a[0].clientX-i.LastMove.X,a[0].clientY-i.LastMove.Y,!0)&&this.DrawDynamicInfo()}i.LastMove.X=a[0].clientX,i.LastMove.Y=a[0].clientY}else if(o){this.MouseDrag;this.MouseDrag=null,this.MoveCorssCursor(i.Click,e)}else if(1==this.DragMode||0==o){if((s>0&&n<=3||r<=this.TouchMoveMinAngle)&&1==this.EnableScrollUpDown)return void this.StopDragTimer();if(n<5||r<=this.TouchMoveMinAngle)return void this.PreventTouchEvent(e);var l=!0;i.LastMove.X<a[0].clientX&&(l=!1);var u=this.GetMoveOneStepWidth();if(n<u)return;this.DataMove(n,l)?(this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw(),this.OnKLinePageChange("OnTouchMove")):this.DragDownloadData&&this.DragDownloadData(),i.LastMove.X=a[0].clientX,i.LastMove.Y=a[0].clientY}}this.PhoneTouchInfo&&(this.PhoneTouchInfo.End.X=a[0].clientX,this.PhoneTouchInfo.End.Y=a[0].clientY)}else if(this.IsPhonePinching(e)){if(this.DragMode==Y.DISABLE_DRAG_ID)return;this.PreventTouchEvent(e);var C=this.PhonePinch;if(!C)return;if(this.EnableZoomUpDown&&!1===this.EnableZoomUpDown.Touch)return;var D=Math.abs(a[0].pageY-a[1].pageY),f=Math.abs(C.Last.Y-C.Last.Y2),c=D-f,d=Math.abs(a[0].pageX-a[1].pageX),m=Math.abs(C.Last.X-C.Last.X2),v=d-m,S=this.ZoomStepPixel;if(Math.abs(c)<S&&Math.abs(v)<S)return;var I=c;if(Math.abs(c)<S&&(I=v),I>0){var p={IsLockRight:this.IsZoomLockRight};if(p.Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),!this.Frame.ZoomUp(p))return;this.CursorIndex=p.Index,this.UpdatePointByCursorIndex(),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw(),this.ShowTooltipByKeyDown(),this.StopDragTimer()}else{p={IsLockRight:this.IsZoomLockRight};if(p.Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),!this.Frame.ZoomDown(p))return;this.CursorIndex=p.Index,this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw(),this.ShowTooltipByKeyDown(),this.StopDragTimer()}C.Last={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY}}this.PreventTouchEvent(e)}},this.OnTouchEnd=function(t){if(w.Chart.Log("[KLineChartContainer:OnTouchEnd]",t),!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var e=!0;if(this.CurrentChartDrawPicture){var a=this.CurrentChartDrawPicture;2==a.Status||1==a.Status||3==a.Status?(a.PointStatus=a.Status,this.FinishChartDrawPicturePoint()?this.DrawDynamicInfo():e=!1):20==a.Status&&this.FinishMoveChartDrawPicture()&&this.DrawDynamicInfo()}if(this.EnableZoomIndexWindow){var i=Date.now();this.PhoneDBClick.AddTouchEnd(i),this.PhoneDBClick.IsVaildDBClick()&&(this.OnTouchDBClick(this.PhoneDBClick.Start),this.PhoneDBClick.Clear())}this.IsOnTouch=!1,!0===e&&(this.CurrentChartDrawPicture=null),this.StopDragTimer(),this.TouchEvent({EventID:G.ON_PHONE_TOUCH,FunctionName:"OnTouchEnd"},t),this.OnTouchFinished(),this.TouchDrawCount=0}},this.OnTouchDBClick=function(t){var e=this.PointAbsoluteToRelative(t[0].X,t[0].Y,!0),a=e.X,i=e.Y;w.Chart.Log("[KLineChartContainer:OnTouchDBClick] Phone dbclick absolute ["+a+","+i+"], soruce ["+t[0].X+","+t[0].Y+"]");var r=this.Frame.PtInFrame(a,i);if(w.Chart.Log("[KLineChartContainer::OnTouchDBClick] frameId",r),r>=this.Frame.ZoomStartWindowIndex&&this.ZoomIndexWindow(r,{X:a,Y:i}))return this.Frame.SetSizeChage(!0),this.Draw(),!0},this.TouchEvent=function(t,e){var a=t.EventID,i=this.GetEventCallback(a);if(!i||!i.Callback)return!1;var r=this.PhoneTouchInfo;if(!r||!r.Start||!r.End)return!1;var n=U(),s=r.End.X/n,o=r.End.Y/n,h=r.End.X-this.UIElement.getBoundingClientRect().left*n,l=r.End.Y-this.UIElement.getBoundingClientRect().top*n,u={X:s,Y:o,FrameID:-1,FunctionName:t.FunctionName,Drag:{Start:{X:r.Start.X/n,Y:r.Start.Y/n},End:{X:r.End.X/n,Y:r.End.Y/n}}},C=!1;if(this.Canvas.beginPath(),this.Canvas.rect(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetTop(),this.Frame.ChartBorder.GetWidth(),this.Frame.ChartBorder.GetHeight()),C=this.Canvas.isPointInPath(h,l),C)if(this.Frame&&this.Frame.IsHScreen){var D={},f=this.Frame.GetYData(h,D);if(ha.IsNumber(D.FrameID)&&D.FrameID>=0){var c=this.Frame.GetXData(l);u.FrameID=D.FrameID,u.Data={X:c,Y:f}}}else{D={},f=this.Frame.GetYData(l,D);if(ha.IsNumber(D.FrameID)&&D.FrameID>=0){c=this.Frame.GetXData(h);u.FrameID=D.FrameID,u.Data={X:c,Y:f}}}return i.Callback(i,u,this),!0},this.MoveCorssCursor=function(t,e){var a=U(),i=t.X-this.UIElement.getBoundingClientRect().left*a,r=t.Y-this.UIElement.getBoundingClientRect().top*a;this.DragMode==Y.CLICK_TOUCH_MODE_ID&&(this.TouchStatus.CorssCursorShow=!0),this.OnMouseMove(i,r,e,!0)},this.DrawEmpty=function(){this.UIElement.width<=0||this.UIElement.height<=0||(this.Canvas.clearRect(0,0,this.UIElement.width,this.UIElement.height),this.Frame&&(this.Frame.ScreenImageData=null,this.Frame.Draw()))},this.PtInChart=function(t,e){for(var a=null,i=0;i<this.ChartPaint.length;++i){var r=this.ChartPaint[i];if(r.PtInChart&&(a=r.PtInChart(t,e),a))return a}for(i=0;i<this.OverlayChartPaint.length;++i){r=this.OverlayChartPaint[i];if(r.PtInChart&&(a=r.PtInChart(t,e),a))return a}return this.Frame.PtInOveralyChart&&(a=this.Frame.PtInOveralyChart(t,e),a)?a:null},this.DrawSelectedStatus=function(){if(this.SelectedChart.MoveOn.Identify||this.SelectedChart.Selected.Identify){for(var t=0;t<this.ChartPaint.length;++t){var e=this.ChartPaint[t];e.Identify&&(e.Identify!=this.SelectedChart.MoveOn.Identify&&e.Identify!=this.SelectedChart.Selected.Identify||e.DrawSelectedStatus&&e.DrawSelectedStatus())}for(t=0;t<this.OverlayChartPaint.length;++t){e=this.OverlayChartPaint[t];e.Identify&&(e.Identify!=this.SelectedChart.MoveOn.Identify&&e.Identify!=this.SelectedChart.Selected.Identify||e.DrawSelectedStatus&&e.DrawSelectedStatus())}for(t=0;t<this.OverlayChartPaint.length;++t){e=this.OverlayChartPaint[t];e.Identify&&(e.Identify!=this.SelectedChart.MoveOn.Identify&&e.Identify!=this.SelectedChart.Selected.Identify||e.DrawSelectedStatus&&e.DrawSelectedStatus())}this.Frame.DrawOveralySelectedStatus&&this.Frame.DrawOveralySelectedStatus(this.SelectedChart)}},this.Draw=function(){var t=this;if(this.ChartCorssCursor&&(this.ChartCorssCursor.Status=0),!(this.UIElement.width<=0||this.UIElement.height<=0)){this.Canvas.clearRect(0,0,this.UIElement.width,this.UIElement.height);var e=U();if(this.Canvas.lineWidth=e,this.ChartSplashPaint&&this.ChartSplashPaint.IsEnableSplash)return this.Frame.ClearCoordinateText(),this.Frame.Draw({IsEnableSplash:this.ChartSplashPaint.IsEnableSplash}),void this.ChartSplashPaint.Draw();if(this.Frame.SetBeforeDrawXYCallback&&this.Frame.SetBeforeDrawXYCallback((function(e){t.BeforeDrawXYCoordinate(e)})),this.Frame.Draw(),this.Frame.DrawCustomVertical){var a=this.GetEventCallback(G.ON_CUSTOM_VERTICAL_DRAW);this.Frame.DrawCustomVertical(a)}this.Frame.CalculateLock();for(var i=0;i<this.ChartDrawPicture.length;++i){var r=this.ChartDrawPicture[i];r.IsDrawMain&&(r.IsDrawMain()&&r.MainDraw())}for(i=0;i<this.ChartPaint.length;++i){r=this.ChartPaint[i];r.IsDrawFirst&&r.Draw()}for(i=0;i<this.ChartPaint.length;++i){r=this.ChartPaint[i];r.IsDrawFirst||r.Draw()}for(i=0;i<this.ChartPaintEx.length;++i){r=this.ChartPaintEx[i];r.Draw()}for(i=0;i<this.OverlayChartPaint.length;++i){r=this.OverlayChartPaint[i];r.Draw()}this.Frame.DrawOveraly&&this.Frame.DrawOveraly();for(i=0;i<this.ExtendChartPaint.length;++i){r=this.ExtendChartPaint[i];r.IsCallbackDraw||(r.IsDynamic||0!=r.IsAnimation||r.Draw())}this.Frame.DrawInsideHorizontal&&this.Frame.DrawInsideHorizontal(),this.KLineIncreaseCustomHorizontal(),this.Frame.DrawCustomHorizontal&&this.Frame.DrawCustomHorizontal(),this.Frame.DrawEx&&this.Frame.DrawEx({Symbol:this.Symbol}),this.ChartInfoPaint&&this.ChartInfoPaint.Draw(),this.Frame.DrawLock(),this.Frame.DrawLogo(),this.Frame.Snapshot(),this.Frame.DrawToolbar&&this.Frame.DrawToolbar(this.LastMouseStatus),this.DrawSelectedStatus();var n=null;this.LastMouseStatus&&this.LastMouseStatus.MoveOnPoint&&(n=this.LastMouseStatus.MoveOnPoint);for(i=0;i<this.ExtendChartPaint.length;++i){r=this.ExtendChartPaint[i];r.IsCallbackDraw||r.IsDynamic&&!1===r.DrawAfterTitle&&(r.Draw(),r.DrawToolbar&&r.DrawToolbar(n))}for(i=0;i<this.ChartDrawPicture.length;++i){r=this.ChartDrawPicture[i];r.IsDrawFirst&&r.Draw()}this.IsDrawPictureXY&&(this.CurrentChartDrawPicture?this.Frame.DrawPictureCoordinate(this.CurrentChartDrawPicture,{Symbol:this.Symbol,Period:this.Period}):this.SelectChartDrawPicture&&this.Frame.DrawPictureCoordinate(this.SelectChartDrawPicture,{Symbol:this.Symbol,Period:this.Period})),null==this.LastPoint.X&&null==this.LastPoint.Y||this.ChartCorssCursor&&(this.ChartCorssCursor.LastPoint=this.LastPoint,this.ChartCorssCursor.CursorIndex=this.CursorIndex,this.DragMode==Y.CLICK_TOUCH_MODE_ID?1==this.TouchStatus.CorssCursorShow&&this.ChartCorssCursor.Draw():!0===this.CorssCursorTouchEnd&&this.MouseDrag||1==this.CorssCursorTouchEnd&&0==this.IsOnTouch||this.ChartCorssCursor.Draw());var s=this.GetDrawStatus();s.DrawName="Draw";var o=this.GetEventCallback(G.ON_TITLE_DRAW),h=this.GetEventCallback(G.ON_INDEXTITLE_DRAW);for(i=0;i<this.TitlePaint.length;++i){r=this.TitlePaint[i];r.IsDynamic&&(r.CursorIndex=this.CursorIndex,r.LastPoint=this.LastPoint,"DynamicChartTitlePainting"==r.ClassName?r.OnDrawEvent=h:r.OnDrawEvent=o,r.OnDrawEvent&&(r.OnDrawEvent.FunctionName="Draw",r.OnDrawEvent.PointPosition=null),r.DrawStatus=s,r.Draw())}for(i=0;i<this.ExtendChartPaint.length;++i){r=this.ExtendChartPaint[i];r.IsCallbackDraw||r.IsDynamic&&!0===r.DrawAfterTitle&&0==r.IsAnimation&&r.Draw()}if(this.EnableAnimation)for(i=0;i<this.ExtendChartPaint.length;++i){r=this.ExtendChartPaint[i];!0===r.IsAnimation&&r.Draw()}for(i=0;i<this.ChartDrawPicture.length;++i){r=this.ChartDrawPicture[i];r.IsDrawFirst||(r.IsDrawMain&&r.IsDrawMain()||r.Draw())}if(this.CurrentChartDrawPicture&&10!=this.CurrentChartDrawPicture.Status&&this.CurrentChartDrawPicture.Draw(),this.OffscreenToShowCanvas(),this.mapEvent.has(G.CHART_STATUS)){var l=this.mapEvent.get(G.CHART_STATUS),u={};"function"==typeof this.GetChartStatus&&(u=this.GetChartStatus()),l.Callback(l,u,this)}++this.TouchDrawCount}},this.BeforeDrawXYCoordinate=function(t){for(var e=0;e<this.ExtendChartPaint.length;++e){var a=this.ExtendChartPaint[e];a.IsCallbackDraw&&"DepthMapPaint"==a.ClassName&&a.FrameID==t.Identify&&a.Draw()}},this.KLineIncreaseCustomHorizontal=function(){if(this.Frame&&this.Frame.SubFrame){var t=this.Frame.SubFrame[0].Frame;if(t){var e=rn(this.Symbol),a=!1;t.YSplitOperator&&1==t.YSplitOperator.CoordinateType&&(a=!0);for(var i=!1,r=0;r<t.CustomHorizontalInfo.length;++r){var n=t.CustomHorizontalInfo[r];if(4==n.Type&&(i=!0),a&&3==n.Type||2==n.Type){var s=this.ChartPaint[0];if(!s)continue;var o=s.Data;if(!o||!ha.IsNonEmptyArray(o.Data))continue;if(!ha.IsNumber(s.DrawKRange.Start)||!ha.IsNumber(s.DrawKRange.End))continue;var h=o.Data[s.DrawKRange.Start],l=o.Data[s.DrawKRange.End],u=(l.Close-h.Close)/h.Close;n.Value=l.Close,2==n.Type?(n.Message[1]=l.Close.toFixed(e),l.Close>l.Open?n.LineColor=Oi.FrameLatestPrice.UpBarColor:l.Close<l.Open?n.LineColor=Oi.FrameLatestPrice.DownBarColor:n.LineColor=Oi.FrameLatestPrice.UnchagneBarColor):n.Message[1]=u.toFixed(2)+"%",this.Name&&(n.Title=this.Name)}}if(i){var C=t.CustomHorizontalInfo.filter((function(t,e,a){return 4!=t.Type}));t.CustomHorizontalInfo=C}for(r=0;r<this.OverlayChartPaint.length;++r){s=this.OverlayChartPaint[r];if(s&&4==s.YInfoType){o=s.Data;if(o&&ha.IsNonEmptyArray(o.Data)&&ha.IsNumber(s.DrawKRange.Start)&&ha.IsNumber(s.DrawKRange.End)){h=o.Data[s.DrawKRange.Start],l=o.Data[s.DrawKRange.End],u=(l.Close-h.Close)/h.Close*100,n=new rt;n.Value=l.Close/s.ShowRange.FirstOverlayOpen*s.ShowRange.FirstOpen,n.Message[1]=u.toFixed(2)+"%",n.LineType=-1,n.Type=s.YInfoType,n.LineColor=s.Color,n.TextColor=Oi.FrameLatestPrice.OverlayTextColor,s.Title&&(n.Title=s.Title),t.CustomHorizontalInfo.push(n)}}}}}},this.OffscreenToShowCanvas=function(){this.ShowCanvas&&(this.ShowCanvas.clearRect(0,0,this.UIElement.width,this.UIElement.height),this.ShowCanvas.drawImage(this.OffscreenCanvasElement,0,0))},this.GetDrawStatus=function(){var t={Point:{X:this.LastPoint.X,Y:this.LastPoint.Y},IsOnTouch:this.IsOnTouch,CorssCursorTouchEnd:this.CorssCursorTouchEnd,IsTitleShowLatestData:this.IsTitleShowLatestData,IsMinuteChart:"MinuteChartContainer"==this.ClassName||"MinuteChartHScreenContainer"==this.ClassName};return t.FrameID=this.Frame.PtInFrame(this.LastPoint.X,this.LastPoint.Y),t},this.DrawDynamicInfo=function(t){if(null!=this.Frame.ScreenImageData){var e=!1;if(this.ChartCorssCursor&&(null==this.ChartCorssCursor.PointX&&null==this.ChartCorssCursor.PointY||(e=!0)),e=!0,0==e)for(var a=0;a<this.ExtendChartPaint.length;++a){var i=this.ExtendChartPaint[a];if(!i.IsCallbackDraw&&(i.IsDynamic&&i.IsEraseBG)){e=!0;break}}e&&this.Canvas.putImageData(this.Frame.ScreenImageData,0,0),this.Frame.DrawToolbar(this.LastMouseStatus),this.DrawSelectedStatus();var r=null;this.LastMouseStatus&&this.LastMouseStatus.MoveOnPoint&&(r=this.LastMouseStatus.MoveOnPoint);for(a=0;a<this.ExtendChartPaint.length;++a){i=this.ExtendChartPaint[a];i.IsCallbackDraw||i.IsDynamic&&!1===i.DrawAfterTitle&&0==i.IsAnimation&&(i.Draw(),i.DrawToolbar&&i.DrawToolbar(r))}for(a=0;a<this.ChartDrawPicture.length;++a){i=this.ChartDrawPicture[a];i.IsDrawFirst&&i.Draw()}this.IsDrawPictureXY&&(this.CurrentChartDrawPicture?this.Frame.DrawPictureCoordinate(this.CurrentChartDrawPicture,{Symbol:this.Symbol,Period:this.Period}):this.SelectChartDrawPicture&&this.Frame.DrawPictureCoordinate(this.SelectChartDrawPicture,{Symbol:this.Symbol,Period:this.Period})),this.ChartCorssCursor&&(this.ChartCorssCursor.LastPoint=this.LastPoint,this.ChartCorssCursor.CursorIndex=this.CursorIndex,t&&0==t.Corss||(this.DragMode==Y.CLICK_TOUCH_MODE_ID?1==this.TouchStatus.CorssCursorShow&&this.ChartCorssCursor.Draw():!1===this.IsOnTouch&&!0===this.CorssCursorTouchEnd||this.CurrentChartDrawPicture?!0===this.IsOnTouch&&this.CurrentChartDrawPicture&&this.EnableShowCorssCursor&&1==this.EnableShowCorssCursor.DrawPicture&&this.ChartCorssCursor.Draw():this.ChartCorssCursor.Draw()));var n=null;t&&"OnMouseMove"==t.ParentFunction&&t.Point&&(n=this.Frame.PtInFrame(t.Point.X,t.Point.Y));var s=this.GetDrawStatus();s.DrawName="DrawDynamicInfo";for(a=0;a<this.TitlePaint.length;++a){i=this.TitlePaint[a];i.IsDynamic&&(i.CursorIndex=this.CursorIndex,i.LastPoint=this.LastPoint,i.OnDrawEvent&&(i.OnDrawEvent.FunctionName="DrawDynamicInfo",i.OnDrawEvent.PointPosition=n),i.DrawStatus=s,"DynamicMinuteTitlePainting"==i.ClassName&&(t&&ha.IsNumber(t.ClientPos)&&t.Point?i.PointInfo={ClientPos:t.ClientPos,Point:{X:t.Point.X,Y:t.Point.Y}}:i.PointInfo=null),i.Draw())}for(a=0;a<this.ExtendChartPaint.length;++a){i=this.ExtendChartPaint[a];if(!i.IsCallbackDraw){if("KLineTooltipPaint"==i.ClassName&&t){if(0==t.Tooltip)continue;t.Point&&(i.LatestPoint=t.Point)}else"MinuteTooltipPaint"==i.ClassName&&t&&t.Point&&(i.LatestPoint=t.Point);i.IsDynamic&&!0===i.DrawAfterTitle&&i.Draw()}}if(this.EnableAnimation)for(a=0;a<this.ExtendChartPaint.length;++a){i=this.ExtendChartPaint[a];!0===i.IsAnimation&&i.Draw()}for(a=0;a<this.ChartDrawPicture.length;++a){i=this.ChartDrawPicture[a];i.IsDrawFirst||(i.IsDrawMain&&i.IsDrawMain()||i.Draw())}this.CurrentChartDrawPicture&&10!=this.CurrentChartDrawPicture.Status&&this.CurrentChartDrawPicture.Draw(),this.OffscreenToShowCanvas(),++this.TouchDrawCount}},this.DrawAnimation=function(){if(this.EnableAnimation){if(this.Frame.ScreenImageData&&!this.IsOnTouch){for(var t=0;t<this.ExtendChartPaint.length;++t){var e=this.ExtendChartPaint[t];!0===e.IsAnimation&&(e.IsMoveStep=!0)}this.DrawDynamicInfo()}var a=this;window.requestAnimationFrame((function(){a.DrawAnimation()}))}},this.StartAnimation=function(t){for(var e=!1,a=null,i=0;i<this.ExtendChartPaint.length;++i){var r=this.ExtendChartPaint[i];if("BarragePaint"===r.ClassName){e=!0,a=r.BarrageList;break}}if(!e){var n=new oa;n.Canvas=this.Canvas,n.ChartBorder=this.Frame.ChartBorder,n.ChartFrame=this.Frame,n.HQChart=this,n.SetOption(t),this.ExtendChartPaint.push(n),a=n.BarrageList}this.EnableAnimation=!0;var s=this;return window.requestAnimationFrame((function(){s.DrawAnimation()})),a},this.StopAnimation=function(){this.EnableAnimation=!1,this.DrawDynamicInfo()},this.GetChartTooltipData=function(t,e,a){var i=new Ht;if(this.ChartInfoPaint&&this.ChartInfoPaint.GetTooltipData(t,e,i))return i;if(this.PtInChartPaintTooltip(t,e,i))return i;if(ha.IsNonEmptyArray(this.Frame.SubFrame))for(var r=0;r<this.Frame.SubFrame.length;++r)for(var n=this.Frame.SubFrame[r],s=0;s<n.OverlayIndex.length;++s)for(var o=n.OverlayIndex[s],h=0;h<o.ChartPaint.length;++h){var l=o.ChartPaint[h];if(l.GetTooltipData(t,e,i))return i}return this.PtInOverlayChartPaintTooltip(t,e,i)?i:null},this.PtInExtendChartButtons=function(t,e){for(var a=0;a<this.ExtendChartPaint.length;++a){var i=this.ExtendChartPaint[a];if(i.PtInButtons){var r=i.PtInButtons(t,e);if(r)return r.Chart=i,r}}return null},this.OnMouseMove=function(t,e,a,i){this.LastPoint.X=t,this.LastPoint.Y=e;var r=null,n=this.Frame.PtInFrame(t,e);if(ha.IsNumber(n)&&n>=0&&(this.CursorIndex=this.Frame.GetXData(t)),this.EnableBorderDrag&&this.Frame&&!this.CurrentChartDrawPicture){var s=this.Frame.PtInFrameBorder(t,e);s&&s.Index>=0&&(r={Cursor:"n-resize",Name:"DragBorder"},w.Chart.Log("[JSChartContainer::OnMouseMove] drag border ",s))}if(this.EnableYDrag&&this.Frame&&!this.CurrentChartDrawPicture){var o=this.TryYDrag(t,e);o&&(r={Cursor:0==o.Position?"n-resize":"row-resize",Name:"DragY"},w.Chart.Log("[JSChartContainer::OnMouseMove] drag y ",o))}if(!this.CurrentChartDrawPicture){var h=this.Frame.PtInButtons(t,e);h?(r={Cursor:"pointer",Name:"FrameButton"},w.Chart.Log("[JSChartContainer::OnMouseMove] frame button ",h)):(h=this.PtInExtendChartButtons(t,e),h&&(r={Cursor:"pointer",Name:"ExtendChartButton"},w.Chart.Log("[JSChartContainer::OnMouseMove] extend chart button ",h)))}if(this.ChartCorssCursor){var l=this.ChartCorssCursor.PtInButton(t,e);l&&(r={Cursor:"pointer",Name:"CorssCursorButton"},w.Chart.Log("[JSChartContainer::OnMouseMove] cross cursor button ",l))}if("KLineChartContainer"==this.ClassName&&this.Frame.PtInFrameBottom(t,e)&&(r={Cursor:"ew-resize",Name:"FrameButtom"},w.Chart.Log("[JSChartContainer::OnMouseMove] frame bottom ")),this.SelectedChart.EnableMoveOn&&this.PtInChart&&!this.CurrentChartDrawPicture){var u=this.PtInChart(t,e);u&&u.Identify?(r={Cursor:"pointer",Name:"PtInChart"},this.SelectedChart.MoveOn.Identify=u.Identify,this.SelectedChart.MoveOn.Identify=null,w.Chart.Log("[JSChartContainer::OnMouseMove] Point in chart ",u)):this.SelectedChart.MoveOn.Identify=null}else this.SelectedChart.MoveOn.Identify=null;var C=this.GetRectSelectPaint();if(C&&C.GetPointCount()>0){var D=C.PtInPaint(t,e);D&&(r=3==D.Type?{Cursor:"pointer",Name:"DragRectSelect"}:{Cursor:"ew-resize",Name:"DragRectSelect"},w.Chart.Log("[JSChartContainer::OnMouseMove] drag rect select ",D))}var f=!1;if(this.CurrentChartDrawPicture){var c=this.Frame.PtInChartFrame(t,e);20!=this.CurrentChartDrawPicture.Status&&(r=c>=0?{Cursor:"crosshair",Name:"CurrentChartDrawPicture"}:{Cursor:"not-allowed",Name:"CurrentChartDrawPicture"}),this.CurrentChartDrawPicture.SetLastPoint&&this.CurrentChartDrawPicture.SetLastPoint({X:t,Y:e}),f=!0}else{var d={};d.X=t,d.Y=e,this.GetChartDrawPictureByPoint(d)&&d.ChartDrawPicture&&1==d.ChartDrawPicture.EnableMove?(100===d.PointIndex?this.UIElement.style.cursor="move":this.UIElement.style.cursor="pointer",f=!0,this.MoveOnChartDrawPicture=d.ChartDrawPicture):this.MouseDrag||(this.UIElement.style.cursor="default")}var m=this.PtInClient(t,e),v={ParentFunction:"OnMouseMove",Point:{X:t,Y:e},IsPhone:!0===i,ClientPos:m};if((a&&("mouseout"==a.type||"mouseleave"==a.type)||h)&&(v.Corss=!1),this.SetCorssCursorIndex&&this.SetCorssCursorIndex(v),this.DrawDynamicInfo(v),r&&(this.UIElement.style.cursor=r.Cursor),this.IsShowTooltip&&0==f){var S=this.GetChartTooltipData(t,e);if(S&&S.Data){if(!0===i)var I=a.touches[0],p=I.clientX-this.UIElement.getBoundingClientRect().left,T=I.clientY-this.UIElement.getBoundingClientRect().top;else p=a.clientX-this.UIElement.getBoundingClientRect().left,T=a.clientY-this.UIElement.getBoundingClientRect().top;this.ShowTooltip(p,T,S)}else this.HideTooltip()}},this.OnKeyDown=function(t){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var e=t.keyCode?t.keyCode:t.which;switch(e){case 37:if(t.ctrlKey&&this.OnCustomKeyDown&&this.OnCustomKeyDown(e,t))break;if(this.CursorIndex<=.99999){if(!this.DataMoveLeft()){this.DragDownloadData&&this.DragDownloadData();break}this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw(),this.ShowTooltipByKeyDown(),this.OnKLinePageChange("keydown")}else--this.CursorIndex,this.UpdatePointByCursorIndex(),this.DrawDynamicInfo(),this.ShowTooltipByKeyDown();break;case 39:if(t.ctrlKey&&this.OnCustomKeyDown&&this.OnCustomKeyDown(e,t))break;var a=0;if(a=this.Frame.XPointCount?this.Frame.XPointCount:this.Frame.SubFrame[0].Frame.XPointCount,this.CursorIndex+1>=a){if(!this.DataMoveRight())break;this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw(),this.ShowTooltipByKeyDown(),this.OnKLinePageChange("keydown")}else{var i=null;if(i=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data,!i)break;if(this.CursorIndex+i.DataOffset+1>=i.Data.length)break;++this.CursorIndex,this.UpdatePointByCursorIndex(),this.DrawDynamicInfo(),this.ShowTooltipByKeyDown()}break;case 38:if(this.EnableZoomUpDown&&!1===this.EnableZoomUpDown.Keyboard)break;var r={ZoomType:this.ZoomType,IsLockRight:this.IsZoomLockRight};if(r.Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),!this.Frame.ZoomUp(r))break;this.CursorIndex=r.Index,this.UpdatePointByCursorIndex(),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw(),this.ShowTooltipByKeyDown(),this.OnKLinePageChange("keydown");break;case 40:if(this.EnableZoomUpDown&&!1===this.EnableZoomUpDown.Keyboard)break;r={ZoomType:this.ZoomType,IsLockRight:this.IsZoomLockRight};if(r.Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),!this.Frame.ZoomDown(r))break;this.CursorIndex=r.Index,this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw(),this.ShowTooltipByKeyDown(),this.OnKLinePageChange("keydown");break;case 46:if(this.SelectChartDrawPicture){var n=this.SelectChartDrawPicture;w.Chart.Log("[JSChartContainer::OnKeyDown] delete draw picture."),this.SelectChartDrawPicture=null,this.ChartPictureMenu&&this.ChartPictureMenu.Hide(),this.ClearChartDrawPicture(n)}else if(this.SelectedChart&&this.SelectedChart.Selected.Identify){var s=this.GetSelectedChartInfo(this.SelectedChart.Selected);s&&(s.Type==ra.OVERLAY_INDEX?this.DeleteOverlayWindowsIndex(s.IndexID):s.Type==ra.OVERLAY_KLINE&&this.DeleteOverlaySymbol(s.Symbol))}break;case 32:this.OnMarkRectSelect(t);break;case 27:if(this.CurrentChartDrawPicture){n=this.CurrentChartDrawPicture;20!=n.Status&&(this.CurrentChartDrawPicture=null)}break;default:return}t.preventDefault?t.preventDefault():t.returnValue=!1}},this.OnDoubleClick=function(t,e,a){},this.ZoomIndexWindow=function(t,e){return!(t<0||t>=this.Frame.SubFrame.length)&&this.Frame.ZoomIndexWindow(t,e)},this.RemoveMinSizeWindows=function(){if(this.Frame.ZoomWindowsInfo){for(var t=[],e=[],a=0;a<this.Frame.SubFrame.length;++a){var i=this.Frame.SubFrame[a];i.Frame.ClearToolbar(),i.Frame.IsMinSize?t.push(a):e.push(a)}if(this.Frame.ZoomWindowsInfo=null,!(t.length<=0)){for(a=0;a<t.length;++a)this.DeleteIndexPaint(t[a]);var r=[],n=[],s=[this.TitlePaint[0]];for(a=0;a<e.length;++a){var o=e[a];r[a]=this.Frame.SubFrame[o],n[a]=this.WindowIndex[o],s[a+1]=this.TitlePaint[o+1]}this.Frame.SubFrame=r,this.WindowIndex=n,this.TitlePaint=s;for(a=0;a<this.Frame.SubFrame.length;++a){i=this.Frame.SubFrame[a].Frame;a==this.Frame.SubFrame.length-1?i.XSplitOperator.ShowText=!0:i.XSplitOperator.ShowText=!1,i.Identify=a}if(ha.IsNonEmptyArray(this.ChartDrawPicture)){var h=[];for(a=0;a<this.ChartDrawPicture.length;++a){i=this.ChartDrawPicture[a];for(var l=0;l<this.Frame.SubFrame.length;++l)if(i.Frame==this.Frame.SubFrame[l].Frame){h.push(i);break}}this.ChartDrawPicture=h}}}},this.PtInClient=function(t,e){if(this.Canvas.beginPath(),!0===this.Frame.IsHScreen){var a=this.Frame.ChartBorder.GetHScreenBorder();this.Canvas.rect(a.Left,a.TopEx,a.Right-a.Left,a.BottomEx-a.TopEx)}else{a=this.Frame.ChartBorder.GetBorder();if(a.DayBorder){for(var i=0;i<a.DayBorder.length;++i){var r=a.DayBorder[i];if(this.Canvas.beginPath(),this.Canvas.rect(r.LeftEx,a.TopEx,r.RightEx-r.LeftEx,a.BottomEx-a.TopEx),this.Canvas.isPointInPath(t,e))return 1;if(this.Canvas.beginPath(),this.Canvas.rect(r.Left,a.TopEx,r.LeftEx-r.Left,a.BottomEx-a.TopEx),this.Canvas.isPointInPath(t,e))return 200+parseInt(i);if(this.Canvas.beginPath(),this.Canvas.rect(r.RightEx,a.TopEx,r.Right-r.RightEx,a.BottomEx-a.TopEx),this.Canvas.isPointInPath(t,e))return 300+parseInt(i)}return-1}this.Canvas.rect(a.LeftEx,a.Top,a.RightEx-a.LeftEx,a.Bottom-a.Top)}return this.Canvas.isPointInPath(t,e)?1:this.Frame.ChartBorder.LeftExtendWidth>10&&(this.Canvas.beginPath(),!0===this.Frame.IsHScreen?this.Canvas.rect(a.Left,a.Top,a.Right-a.Left,a.TopEx-a.Top):this.Canvas.rect(a.Left,a.Top,a.LeftEx-a.Left,a.Bottom-a.Top),this.Canvas.isPointInPath(t,e))?2:this.Frame.ChartBorder.RightExtendWidth>10&&(this.Canvas.beginPath(),!0===this.Frame.IsHScreen?this.Canvas.rect(a.Left,a.BottomEx,a.Right-a.Left,a.Bottom-a.BottomEx):this.Canvas.rect(a.RightEx,a.Top,a.Right-a.RightEx,a.Bottom-a.Top),this.Canvas.isPointInPath(t,e))?3:-1},this.OnMoveFromeBorder=function(t,e){this.Frame&&this.Frame.OnMoveFromeBorder(t,e)&&(this.Frame.SetFrameBorderSizeChange(),this.Frame.ReDrawToolbar(),this.Draw())},this.OnZoomUpDownFrameY=function(t,e){this.Frame&&this.Frame.OnZoomUpDownFrameY(t,e)&&(this.Frame.SetSizeChage(!0),this.Draw())},this.OnUpDonwFrameY=function(t,e){return!!this.Frame&&(!!this.Frame.OnUpDonwFrameY(t,e)&&(this.Frame.SetSizeChage(!0),!0))},this.CancelZoomUpDownFrameY=function(t){this.Frame&&this.Frame.CancelZoomUpDownFrameY(t)&&(this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw())},this.IsKLineContainer=function(){return"KLineChartContainer"==this.ClassName||"KLineChartHScreenContainer"==this.ClassName||"KLineTrainChartContainer"==this.ClassName||"CustomKLineChartContainer"==this.ClassName},this.UpdatePointByCursorIndex=function(t){var e={X:null,Y:null};e.X=this.Frame.GetXFromIndex(this.CursorIndex);var a=Math.abs(this.CursorIndex-.5);this.IsKLineContainer()&&(a=this.CursorIndex);var i=this.Frame.Data;if(i.DataOffset+a<i.Data.length){var r=i.Data[i.DataOffset+a].Close;e.Y=this.Frame.GetYFromData(r)}if(1==t&&this.ChartCorssCursor)if(1==this.ChartCorssCursor.Status);else{this.LastPoint.X=this.Frame.GetXFromIndex(this.CursorIndex);a=Math.abs(this.CursorIndex-.5);a=parseInt(a.toFixed(0)),this.IsKLineContainer()&&(a=this.CursorIndex),this.LastPoint.Y=null}else 2==t&&this.ChartCorssCursor?(this.LastPoint.Y=null,this.LastPoint.X=null):(this.LastPoint.X=e.X,this.LastPoint.Y=e.Y)},this.ShowTooltipByKeyDown=function(){var t=Math.abs(this.CursorIndex-.5);t=parseInt(t.toFixed(0)),"KLineChartContainer"!=this.ClassName&&"KLineTrainChartContainer"!=this.ClassName||(t=this.CursorIndex);var e=this.Frame.Data,a=new Ht;a.Data=e.Data[e.DataOffset+t],a.ChartPaint=this.ChartPaint[0];var i=U();0===i&&(i=1),this.ShowTooltip(this.LastPoint.X/i,this.LastPoint.Y/i,a)},this.ShowTooltip=function(t,e,a){if(this.IsShowTooltip){var i=U(),r=15/i;if(0===a.Type){Z();var n=t,s=e,o=Ra.Create("HistoryDataStringFormat");if(o.Value=a,o.Symbol=this.Symbol,o.LanguageID=this.LanguageID,!o.Operator())return;var h=25*o.LineCount;o.Height>0&&(h=o.Height);var l=o.Width;this.Tooltip.style.width=l+"px",this.Tooltip.style.height=h+"px",this.Tooltip.style.position="absolute",n+l>this.UIElement.getBoundingClientRect().width?this.Tooltip.style.left=n-l+"px":this.Tooltip.style.left=n+"px",s+r+h>this.UIElement.getBoundingClientRect().height-5?this.Tooltip.style.top=s-h+"px":this.Tooltip.style.top=s+r+"px",this.Tooltip.className="jschart-tooltip",this.Tooltip.innerHTML=o.Text,this.Tooltip.style.display="block"}else if(1===a.Type){Z(),n=t,s=e,o=Ra.Create("KLineInfoDataStringFormat");if(o.Value=a,o.Symbol=this.Symbol,o.LanguageID=this.LanguageID,!o.Operator())return;l=o.Width;this.Tooltip.className="jchart-klineinfo-tooltip",this.Tooltip.style.position="absolute",n+l>this.UIElement.getBoundingClientRect().width?this.Tooltip.style.left=n-l+"px":this.Tooltip.style.left=n+"px",this.Tooltip.style.top=s+r+"px",this.Tooltip.style.width=l+"px",this.Tooltip.style.height=null,this.Tooltip.innerHTML=o.Text,this.Tooltip.style.display="block"}else if(2==a.Type){n=t,s=e,o=Ra.Create("KLineTradeDataStringFormat");if(o.Value=a,o.Symbol=this.Symbol,o.LanguageID=this.LanguageID,!o.Operator())return;l=o.Width;this.Tooltip.className="jchart-klinetrade-tooltip",this.Tooltip.style.position="absolute",this.Tooltip.style.left=n+"px",this.Tooltip.style.top=s+r+"px",this.Tooltip.style.width=l+"px",this.Tooltip.style.height=null,this.Tooltip.innerHTML=o.Text,this.Tooltip.style.display="block"}else if(3==a.Type){n=t,s=e,o=Ra.Create("MinuteInfoDataStringFormat");if(o.Value=a,o.Symbol=this.Symbol,o.LanguageID=this.LanguageID,!o.Operator())return;l=o.Width;this.Tooltip.className="jchart-minuteinfo-tooltip",this.Tooltip.style.position="absolute",this.Tooltip.style.left=n+"px",this.Tooltip.style.top=s+r+"px",this.Tooltip.style.width=l+"px",this.Tooltip.style.height=null,this.Tooltip.innerHTML=o.Text,this.Tooltip.style.display="block"}else if(4==a.Type){n=t,s=e,o=Ra.Create("IconDataStringFormat");if(o.Value=a,o.Symbol=this.Symbol,o.LanguageID=this.LanguageID,!o.Operator())return;l=o.Width;this.Tooltip.className="jchart-iconinfo-tooltip",this.Tooltip.style.position="absolute",this.Tooltip.style.left=n+"px",this.Tooltip.style.top=s+r+"px",this.Tooltip.style.width=l+"px",this.Tooltip.style.height=null,this.Tooltip.innerHTML=o.Text,this.Tooltip.style.display="block"}else if(5==a.Type){n=t,s=e,o=Ra.Create("ChartOXDataStringFormat");if(o.Value=a,o.Symbol=this.Symbol,o.Period=this.Period,o.LanguageID=this.LanguageID,!o.Operator())return;l=o.Width;this.Tooltip.className="jchart-chartox-tooltip",this.Tooltip.style.position="absolute",this.Tooltip.style.left=n+"px",this.Tooltip.style.top=s+r+"px",this.Tooltip.style.width=l+"px",this.Tooltip.style.height=null,this.Tooltip.innerHTML=o.Text,this.Tooltip.style.display="block"}}},this.HideTooltip=function(){"none"!=this.Tooltip.style.display&&(this.Tooltip.style.display="none")},this.ShowSelectRect=function(t,e,a,i){var r=t,n=e,s=this.Frame.ChartBorder.GetBorder(),o=s.Right,h=s.Left;t>o&&(t=o),a>o&&(a=o),t<h&&(t=h),a<h&&(a=h),t>a&&(r=a),e>i&&(n=i);var l=Math.abs(t-a),u=Math.abs(e-i);this.SelectRect.style.width=l+"px",this.SelectRect.style.height=u+"px",this.SelectRect.style.position="absolute",this.SelectRect.style.left=r+"px",this.SelectRect.style.top=n+"px",this.SelectRect.style.display="block"},this.UpdateSelectRect=function(t,e){if(this.ChartPaint[0].Data){var a=this.GetRectSelectPaint();if(a){var i=this.ChartPaint[0].Data,r=i.Data[t],n=i.Data[e];w.Chart.Log("[JSChartContainer::UpdateSelectRect]",r,n),a.SetPoint(r,{Index:0,DataIndex:t}),a.SetPoint(n,{Index:1,DataIndex:e}),this.Draw()}}},this.HideSelectRect=function(){this.SelectRect.style.display="none"},this.ResetFrameXYSplit=function(){"function"==typeof this.Frame.ResetXYSplit&&this.Frame.ResetXYSplit()},this.UpdateFrameMaxMin=function(){for(var t=new Array,e=new Array,a=0;a<this.ChartPaint.length;++a){var i=this.ChartPaint[a];0!=i.IsShow&&e.push(this.ChartPaint[a])}for(a=0;a<this.OverlayChartPaint.length;++a)e.push(this.OverlayChartPaint[a]);for(a=0;a<e.length;++a){var r=e[a],n=r.GetMaxMin();if(null!=n&&null!=n.Max&&null!=n.Min){var s=null;for(var o in t)if(t[o].Frame==r.ChartFrame){s=t[o];break}s?(s.Range.Max<n.Max&&(s.Range.Max=n.Max),s.Range.Min>n.Min&&(s.Range.Min=n.Min)):(s={OverlayFrame:[]},s.Frame=r.ChartFrame,s.Range=n,t.push(s))}}var h=new E.default;for(a=0;a<t.length;++a){i=t[a];h.set(i.Frame.Identify,i)}for(a=0;a<this.Frame.SubFrame.length;++a){var l=this.Frame.SubFrame[a];for(o=0;o<l.OverlayIndex.length;++o){var u=l.OverlayIndex[o],C=u.Frame;if(1==C.IsShareY&&(C.MainFrame&&h.has(C.MainFrame.Identify))){s=h.get(C.MainFrame.Identify);if(s&&(s.OverlayFrame.push(C),!1!==C.IsCalculateYMaxMin))for(var D=0;D<u.ChartPaint.length;++D){r=u.ChartPaint[D],n=r.GetMaxMin();null!=n&&null!=n.Max&&null!=n.Min&&(s.Range.Max<n.Max&&(s.Range.Max=n.Max),s.Range.Min>n.Min&&(s.Range.Min=n.Min))}}}}for(a=0;a<t.length;++a){i=t[a];if(i.Frame&&i.Range&&(null!=i.Range.Max&&null!=i.Range.Min))for(var o in i.Frame.YSpecificMaxMin?(i.Frame.HorizontalMax=i.Frame.YSpecificMaxMin.Max,i.Frame.HorizontalMin=i.Frame.YSpecificMaxMin.Min):(i.Frame.HorizontalMax=i.Range.Max,i.Frame.HorizontalMin=i.Range.Min),i.Frame.XYSplit=!0,i.OverlayFrame)i.OverlayFrame[o].XYSplit=!0}for(a=0;a<this.Frame.SubFrame.length;++a)for(l=this.Frame.SubFrame[a],o=0;o<l.OverlayIndex.length;++o){u=l.OverlayIndex[o];!0!==u.Frame.IsShareY&&u.UpdateFrameMaxMin()}},this.DataMoveLeft=function(){var t=null;return t=this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data,!!t&&(!(t.DataOffset<=0)&&(--t.DataOffset,!0))},this.DataMoveRight=function(){var t=null;if(t=this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data,!t)return!1;var e=0;return e=this.Frame.XPointCount?this.Frame.XPointCount:this.Frame.SubFrame[0].Frame.XPointCount,!!e&&(!(e+t.DataOffset>=t.Data.length)&&(++t.DataOffset,!0))},this.UpdataDataoffset=function(){var t=null;if(t=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data,t){for(var e in this.ChartPaint){var a=this.ChartPaint[e];a.Data&&(a.Data.DataOffset=t.DataOffset)}for(var e in this.OverlayChartPaint){a=this.OverlayChartPaint[e];a.Data&&(a.Data.DataOffset=t.DataOffset)}for(var e in this.Frame.SubFrame){var i=this.Frame.SubFrame[e];for(var r in i.OverlayIndex){var n=i.OverlayIndex[r];for(var s in n.ChartPaint){a=n.ChartPaint[s];a.Data&&(a.Data.DataOffset=t.DataOffset)}}}}},this.GetMoveOneStepWidth=function(){if(ha.IsPlusNumber(this.StepPixel))return this.StepPixel;var t=U(),e=this.Frame.SubFrame[0].Frame,a=e.DataWidth,i=e.DistanceWidth,r=this.StepPixel;r=(a+i)/t;return r<1&&(r=1),r},this.DataMove=function(t,e){var a=this.GetMoveOneStepWidth(),i=t;if(t=parseInt(t/a),t<=0)return!1;var r=null;if(r=this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data,!r)return!1;var n=0;if(n=this.Frame.XPointCount?this.Frame.XPointCount:this.Frame.SubFrame[0].Frame.XPointCount,!n)return!1;if(this.Frame.SubFrame&&this.Frame.SubFrame.length>0&&this.Frame.SubFrame[0].Frame){var s=this.Frame.SubFrame[0].Frame;(s.DataWidth<=1||s.DistanceWidth<=1)&&ha.IsPlusNumber(this.StepPixel)&&(t=parseInt(i)*this.StepPixel)}if(e){if(this.RightSpaceCount>0){if(n+r.DataOffset>=r.Data.length+this.RightSpaceCount-1)return!1;r.DataOffset+=t,r.DataOffset+n>=r.Data.length+this.RightSpaceCount&&(r.DataOffset=r.Data.length-(n-this.RightSpaceCount))}else{if(n+r.DataOffset>=r.Data.length)return!1;r.DataOffset+=t,r.DataOffset+n>=r.Data.length&&(r.DataOffset=r.Data.length-n)}return!0}return!(r.DataOffset<=0)&&(r.DataOffset-=t,r.DataOffset<0&&(r.DataOffset=0),!0)},this.XCoordinateZoom=function(t,e){var a=this.GetMoveOneStepWidth();return t=parseInt(t/a),!(t<=0)&&this.Frame.XCoordinateZoom(e)},this.GetSubFrameIndex=function(t,e){if(!this.Frame.SubFrame||this.Frame.SubFrame.length<=0)return-1;for(var a in this.Frame.SubFrame){var i=this.Frame.SubFrame[a].Frame,r=i.ChartBorder.GetLeft(),n=i.ChartBorder.GetTop(),s=i.ChartBorder.GetHeight(),o=i.ChartBorder.GetWidth();if(this.Canvas.beginPath(),this.Canvas.rect(r,n,o,s),this.Canvas.isPointInPath(t,e))return parseInt(a)}return 0},this.GetDataIndexByPoint=function(t){var e=this.Frame;this.Frame.SubFrame&&this.Frame.SubFrame.length>0&&(e=this.Frame.SubFrame[0].Frame);var a=null;if(a=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data,a&&e){var i=parseInt(e.GetXData(t));return a.DataOffset+i}},this.GetSelectRectData=function(t){if(Math.abs(t.XStart-t.XEnd)<5)return!1;this.PtInClient(t.XStart,t.YStart),this.PtInClient(t.XEnd,t.YEnd);var e=null;if(e=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data,!e)return!1;var a=this.GetDataIndexByPoint(t.XStart),i=this.GetDataIndexByPoint(t.XEnd);return!(Math.abs(a-i)<2)&&(t.Data=e,a>i?(t.Start=i,t.End=a):(t.Start=a,t.End=i),!0)},this.GetChartDrawPictureByPoint=function(t){for(var e=0;e<this.ChartDrawPicture.length;++e){var a=this.ChartDrawPicture[e],i=a.IsPointIn(t.X,t.Y,this.ChartDrawOption);if(!1!==i&&i>=0)return t.ChartDrawPicture=a,t.PointIndex=i,!0}return!1},this.SaveToImage=function(t,e){if(this.UIElement.width<=0||this.UIElement.height<=0)return null;if(this.ChartSplashPaint&&this.ChartSplashPaint.IsEnableSplash)return null;w.Chart.Log("[JSChartContainer::SaveToImage]",this.UIElement);var a="rgb(255,255,255)";e&&(a=e),this.Canvas.clearRect(0,0,this.UIElement.width,this.UIElement.height),this.Canvas.fillStyle=a,this.Canvas.fillRect(0,0,this.UIElement.width,this.UIElement.height);var i=U();for(var r in this.Canvas.lineWidth=i,this.Frame.Draw(),this.ChartPaint){var n=this.ChartPaint[r];n.IsDrawFirst&&n.Draw()}for(var r in this.ChartPaint){n=this.ChartPaint[r];n.IsDrawFirst||n.Draw()}for(var r in this.ChartPaintEx){n=this.ChartPaintEx[r];n.Draw()}for(var r in this.OverlayChartPaint){n=this.OverlayChartPaint[r];n.Draw()}for(var r in this.ExtendChartPaint){n=this.ExtendChartPaint[r];n.IsDynamic||0!=n.IsAnimation||n.Draw()}for(var r in this.Frame.DrawInsideHorizontal&&this.Frame.DrawInsideHorizontal(),this.Frame.DrawLock(),this.ExtendChartPaint){n=this.ExtendChartPaint[r];n.IsDynamic&&!1===n.DrawAfterTitle&&n.Draw()}for(var r in null==this.LastPoint.X&&null==this.LastPoint.Y||this.ChartCorssCursor&&(this.ChartCorssCursor.LastPoint=this.LastPoint,this.ChartCorssCursor.CursorIndex=this.CursorIndex),this.TitlePaint){n=this.TitlePaint[r];n.IsDynamic&&(n.CursorIndex=this.CursorIndex,n.Draw())}for(var r in this.ExtendChartPaint){n=this.ExtendChartPaint[r];n.IsDynamic&&!0===n.DrawAfterTitle&&0==n.IsAnimation&&n.Draw()}if(this.EnableAnimation)for(var r in this.ExtendChartPaint){n=this.ExtendChartPaint[r];!0===n.IsAnimation&&n.Draw()}for(var r in this.ChartDrawPicture){n=this.ChartDrawPicture[r];n.Draw()}this.CurrentChartDrawPicture&&10!=this.CurrentChartDrawPicture.Status&&this.CurrentChartDrawPicture.Draw();var s=this.UIElement.toDataURL(t||"image/png",1);return w.Chart.Log("[JSChartContainer::SaveToImage] data= ",s),s},this.SaveToImageUrl=function(t,e){t||(t={Format:"image/png",ColorGB:"rgb(255,255,255)"});var a=this.SaveToImage(t.Format,t.ColorGB),i={Base64:a,BucketName:"downloadcache",Path:"hqchart/hq_snapshot"},r=Oi.Domain+"/API/FileUploadForBase64";O.HttpRequest({url:r,method:"POST",dataType:"json",data:i,success:function(t){w.Chart.Log("[JSChartContainer::SaveToImageUrl] recv data",t);var a={Path:t.relativeurl,Domain:"https://opensourcedownload.zealink.com"};a.Url=a.Domain+"/"+a.Path,e&&e(!0,a,"")},error:function(t){w.Chart.Log("[JSChartContainer::SaveToImageUrl] error ",t),e&&e(!1,null,"upload failed")}})},this.SetLanguage=function(t){var e=bi.GetLanguageID(t);if(ha.IsNumber(e)){if(this.LanguageID!=e){this.LanguageID=e,this.ChartCorssCursor&&this.ChartCorssCursor.StringFormatY&&(this.ChartCorssCursor.StringFormatY.LanguageID=this.LanguageID);for(var a=0;a<this.TitlePaint.length;++a){var i=this.TitlePaint[a];i&&(i.LanguageID=this.LanguageID)}for(a=0;a<this.ExtendChartPaint.length;++a){i=this.ExtendChartPaint[a];i&&(i.LanguageID=this.LanguageID)}this.Frame&&this.Frame.SetLanguage&&this.Frame.SetLanguage(this.LanguageID),this.Frame.SetSizeChage(!0),this.Draw()}}else console.warn("[JSChartContainer::SetLanguage] language="+t+" error")},this.ReloadTiltePaintResource=function(t){for(var e in this.TitlePaint){var a=this.TitlePaint[e];a.ReloadResource&&a.ReloadResource(t)}},this.ReloadExtendChartPaintResource=function(t){for(var e in this.ExtendChartPaint){var a=this.ExtendChartPaint[e];a.ReloadResource&&a.ReloadResource(t)}},this.ReloadResource=function(t){this.ReloadBorder(t),this.ReloadTiltePaintResource(t.Resource),this.ReloadChartPaint(t.Resource),this.ReloadFrame(t.Resource),this.ReloadExtendChartPaintResource(t.Resource),this.ReloadChartCorssCursor(t,t.Resource),t.Update&&this.Update?this.Update({UpdateCursorIndexType:2}):1==t.Draw&&this.Draw()},this.ReloadBorder=function(t){if(t){var e=U();if(t.Border){var a=t.Border;ha.IsNumber(a.Left)&&(this.Frame.ChartBorder.Left=a.Left*e),ha.IsNumber(a.Right)&&(this.Frame.ChartBorder.Right=a.Right*e),ha.IsNumber(a.Top)&&(this.Frame.ChartBorder.Top=a.Top*e),ha.IsNumber(a.Bottom)&&(this.Frame.ChartBorder.Bottom=a.Bottom*e)}for(var i in t.Windows){a=t.Windows[i];if(!(i>=this.Frame.SubFrame.length)){var r=this.Frame.SubFrame[i],n=r.Frame.ChartBorder;ha.IsNumber(a.TitleHeight)&&(n.TitleHeight=a.TitleHeight*e)}}for(var i in t.Frame){a=t.Frame[i];if(!(i>=this.Frame.SubFrame.length)){r=this.Frame.SubFrame[i],n=r.Frame.ChartBorder;a.TopSpace>=0&&(n.TopSpace=a.TopSpace*e),a.BottomSpace>=0&&(n.BottomSpace=a.BottomSpace*e)}}}},this.ReloadFrame=function(t){for(var e=0;e<this.Frame.SubFrame.length;++e){var a=this.Frame.SubFrame[e],i=a.Frame;i&&i.ReloadResource&&i.ReloadResource(t);for(var r=0;r<a.OverlayIndex.length;++r){var n=a.OverlayIndex[r];n.Frame&&n.Frame.ReloadResource&&n.Frame.ReloadResource(t)}}},this.ReloadChartPaint=function(t){for(var e=0;e<this.ChartPaint.length;++e){var a=this.ChartPaint[e];a&&a.ReloadResource&&a.ReloadResource(t)}},this.ReloadChartCorssCursor=function(t,e){var a=U();if(t&&t.CorssCursor){var i=t.CorssCursor;ha.IsNumber(i.TitleHeight)&&(this.ChartCorssCursor.TextHeight=i.TitleHeight*a)}this.ChartCorssCursor.ReloadResource&&this.ChartCorssCursor.ReloadResource(e)},this.SetDepthMapData=function(t,e){for(var a=0;a<t.length;++a)for(var i=t[a],r=0;r<this.ExtendChartPaint.length;++r){var n=this.ExtendChartPaint[r];if(n.ID==i.ID){n.Data=i.Data;break}}e&&1==e.Draw&&this.Draw()},this.PointAbsoluteToRelative=function(t,e,a){var i={X:t,Y:e},r=U(),n=this.UIElement.getBoundingClientRect();return a?(i.X=t-n.left*r,i.Y=e-n.top*r):(i.X=(t-n.left)*r,i.Y=(e-n.top)*r),i},this.SetChartDrawPictureFirstPoint=function(t,e,a){var i=this.CurrentChartDrawPicture;if(!i)return!1;if(!this.Frame.SubFrame||this.Frame.SubFrame.length<=0)return!1;var r=this.PointAbsoluteToRelative(t,e,a),n=r.X,s=r.Y;for(var o in this.Frame.SubFrame){var h=this.Frame.SubFrame[o].Frame,l=h.ChartBorder.GetLeft(),u=h.ChartBorder.GetTopEx(),C=h.ChartBorder.GetHeight(),D=h.ChartBorder.GetWidth();if(this.Canvas.beginPath(),this.Canvas.rect(l,u,D,C),this.Canvas.isPointInPath(n,s)){i.Frame=h;break}}return!!i.Frame&&(i.Point[0]=new at,i.Point[0].X=n,i.Point[0].Y=s,i.Status=1,!0)},this.SetChartDrawPictureSecondPoint=function(t,e,a){var i=this.CurrentChartDrawPicture;if(!i)return!1;var r=this.PointAbsoluteToRelative(t,e,a);return i.Point[1]=new at,i.Point[1].X=r.X,i.Point[1].Y=r.Y,i.Status=2,!0},this.SetChartDrawPictureThirdPoint=function(t,e,a){var i=this.CurrentChartDrawPicture;if(!i)return!1;var r=this.PointAbsoluteToRelative(t,e,a);return i.Point[2]=new at,i.Point[2].X=r.X,i.Point[2].Y=r.Y,i.Status=3,!0},this.MoveChartDrawPicture=function(t,e,a){var i=this.CurrentChartDrawPicture;if(!i)return!1;var r=U();a&&(r=1);var n=t*r,s=e*r;return i.Move(n,s),!0},this.FinishChartDrawPicturePoint=function(){var t=this.CurrentChartDrawPicture;if(!t)return!1;if(t.PointCount!=t.Point.length)return!1;if("ChartDrawRuler"==t.ClassName)return this.CurrentChartDrawPicture=null,!0;t.Status=10,t.PointToValue(),this.ChartDrawPicture.push(t),this.CurrentChartDrawPicture=null;var e=this.GetEventCallback(G.ON_FINISH_DRAWPICTURE);if(e&&e.Callback){var a={DrawPicture:t};e.Callback(e,a,this)}else t.FinishedCallback&&t.FinishedCallback(t);return this.ChartDrawStorage&&this.ChartDrawStorage.SaveDrawData(t),t.OnFinish&&t.OnFinish(),!0},this.OnSelectChartPicture=function(t){if(w.Chart.Log("[JSChartContainer::OnSelectChartPicture",t),this.ChartPictureMenu||(this.ChartPictureMenu=Tr.Create("ChartPictureSettingMenu",this.UIElement.parentNode)),this.ChartPictureMenu){var e={data:{ChartPicture:t,HQChart:this}};this.ChartPictureMenu.DoModal(e)}},this.FinishMoveChartDrawPicture=function(){var t=this.CurrentChartDrawPicture;if(!t)return!1;if(t.PointCount!=t.Point.length)return!1;if(t.Status=10,t.PointToValue(),this.ChartDrawStorage&&this.ChartDrawStorage.SaveDrawData(t),this.CurrentChartDrawPicture=null,this.SelectChartDrawPicture&&this.SelectChartDrawPicture.DragInfo){var e=this.SelectChartDrawPicture.DragInfo;e.Click&&e.Move&&(e.Click.X==e.Move.X&&e.Click.Y==e.Move.Y||t.OnMoveFinish&&t.OnMoveFinish())}return!0},this.ClearChartDrawPicture=function(t){if(t)for(var e in this.ChartDrawPicture)this.ChartDrawPicture[e]==t&&(this.ChartDrawStorage&&this.ChartDrawStorage.DeleteDrawData(t),this.ChartDrawPicture.splice(e,1),this.Draw());else this.ChartDrawPicture=[],this.ChartDrawStorage&&this.ChartDrawStorage.Clear(),this.Draw()},this.GetActiveDrawPicture=function(){var t={Move:{Guid:null},Select:{Guid:null},MoveOn:{Guid:null}};return this.CurrentChartDrawPicture&&(t.Move={Guid:this.CurrentChartDrawPicture.Guid}),this.SelectChartDrawPicture&&(t.Select={Guid:this.SelectChartDrawPicture.Guid,Chart:this.SelectChartDrawPicture}),this.MoveOnChartDrawPicture&&(t.MoveOn={Guid:this.MoveOnChartDrawPicture.Guid}),t},this.SetChartDrawOption=function(t){ha.IsBool(t.IsLockScreen)&&(this.ChartDrawOption.IsLockScreen=t.IsLockScreen),ha.IsNumber(t.Zoom)&&t.Zoom>=0&&(this.ChartDrawOption.Zoom=t.Zoom)},this.EnableShowCorssCursorLine=function(t){this.ChartCorssCursor&&(this.ChartCorssCursor.IsShowCorss=t)},this.GetExtendChartByClassName=function(t){for(var e=0;e<this.ExtendChartPaint.length;++e){var a=this.ExtendChartPaint[e];if(a.ClassName==t)return{Index:e,Chart:a}}return null},this.GetExtendChartRightWidth=function(){for(var t=0,e=0;e<this.ExtendChartPaint.length;++e){var a=this.ExtendChartPaint[e];a&&("StockChip"!=a.ClassName&&"DrawToolsButton"!=a.ClassName||ha.IsNumber(a.Width)&&(t+=a.Width))}return t},this.DeleteExtendChart=function(t){t.Index>=this.ExtendChartPaint.length||this.ExtendChartPaint[t.Index]==t.Chart&&("function"==typeof t.Chart.Clear&&t.Chart.Clear(),this.ExtendChartPaint.splice(t.Index,1))},this.EnableSplashScreen=function(t){this.ChartSplashPaint&&t&&(ha.IsString(t.Title)&&this.ChartSplashPaint.SetTitle(t.Title),this.ChartSplashPaint.EnableSplash(!0),!1!==t.Draw&&this.Draw())},this.SetSubFrameOption=function(t,e){if(e){if(e.Window){var a=e.Window;null!=a.Modify&&(t.Frame.ModifyIndex=a.Modify),null!=a.Change&&(t.Frame.ChangeIndex=a.Change),null!=a.Close&&(t.Frame.CloseIndex=a.Close),null!=a.Overlay&&(t.Frame.OverlayIndex=a.Overlay),1==a.IsDrawTitleBG&&(t.Frame.IsDrawTitleBG=a.IsDrawTitleBG),a.OverlayIndexType&&(ha.IsNumber(a.OverlayIndexType.Position)&&(t.Frame.OverlayIndexType.Position=a.OverlayIndexType.Position),ha.IsNumber(a.OverlayIndexType.LineSpace)&&(t.Frame.OverlayIndexType.LineSpace=a.OverlayIndexType.LineSpace))}ha.IsNumber(e.SplitCount)&&(t.Frame.YSplitOperator.SplitCount=e.SplitCount),ha.IsNumber(e.TitleHeight)&&(t.Frame.ChartBorder.TitleHeight=e.TitleHeight),ha.IsBool(e.IsShowTitleArraw)&&(t.Frame.IsShowTitleArraw=e.IsShowTitleArraw),ha.IsBool(e.IsShowIndexName)&&(t.Frame.IsShowIndexName=e.IsShowIndexName),ha.IsBool(e.IsShowOverlayIndexName)&&(t.Frame.IsShowOverlayIndexName=e.IsShowOverlayIndexName),ha.IsNumber(e.IndexParamSpace)&&(t.Frame.IndexParamSpace=e.IndexParamSpace),ha.IsBool(e.IsShowXLine)&&(t.Frame.IsShowXLine=e.IsShowXLine),ha.IsBool(e.IsShowYLine)&&(t.Frame.IsShowYLine=e.IsShowYLine),ha.IsBool(e.IsShowIndexTitle)&&(t.Frame.IsShowIndexTitle=e.IsShowIndexTitle),ha.IsBool(e.IsShowLeftText)&&(t.Frame.IsShowYText[0]=e.IsShowLeftText,t.Frame.YSplitOperator.IsShowLeftText=e.IsShowLeftText),ha.IsBool(e.IsShowRightText)&&(t.Frame.IsShowYText[1]=e.IsShowRightText,t.Frame.YSplitOperator.IsShowRightText=e.IsShowRightText)}},this.AddNewSubFrame=function(t){var e=this,a=this.Frame.SubFrame.length,i=this.CreateSubFrameItem(a),r=U();i.Frame.ChartBorder.TitleHeight*=r,this.Frame.SubFrame[a]=i;var n=new Ya;n.Frame=this.Frame.SubFrame[a].Frame,n.Canvas=this.Canvas,n.LanguageID=this.LanguageID,n.GetEventCallback=function(t){return e.GetEventCallback(t)},this.TitlePaint[a+1]=n,this.SetSubFrameOption(i,t);for(var s=0;s<this.Frame.SubFrame.length;++s){var o=this.Frame.SubFrame[s].Frame;s==this.Frame.SubFrame.length-1?o.XSplitOperator.ShowText=!0:o.XSplitOperator.ShowText=!1}return this.UpdataDataoffset(),this.Frame.SetSizeChage(!0),this.UpdateXShowText&&this.UpdateXShowText(),this.ResetFrameXYSplit(),this.UpdateFrameMaxMin(),this.Draw(),a},this.AddIndexWindow=function(t,e){var a=new B,i=a.Get(t);if(i){this.RemoveMinSizeWindows();var r=this.AddNewSubFrame(e),n={Name:i.Name,Script:i.Script,Args:i.Args,ID:t,KLineType:i.KLineType,YSpecificMaxMin:i.YSpecificMaxMin,YSplitScale:i.YSplitScale,FloatPrecision:i.FloatPrecision,Condition:i.Condition,StringFormat:i.StringFormat,OutName:i.OutName};if(e&&(e.FloatPrecision>=0&&(n.FloatPrecision=e.FloatPrecision),e.StringFormat>0&&(n.StringFormat=e.StringFormat),e.Args&&(n.Args=e.Args)),this.WindowIndex[r]=new wn(n.Name,n.Script,n.Args,n),"MinuteChartContainer"==this.ClassName||"MinuteChartHScreenContainer"==this.ClassName)var s=this.SourceData;else s=this.ChartPaint[0].Data;this.BindIndexData(r,s)}},this.AddAPIIndexWindow=function(t,e){if(t.API){this.RemoveMinSizeWindows();var a=this.AddNewSubFrame(e),i=t.API;if(this.WindowIndex[a]=new Rn(i.Name,i.Script,i.Args,t),"MinuteChartContainer"==this.ClassName||"MinuteChartHScreenContainer"==this.ClassName)var r=this.SourceData;else r=this.ChartPaint[0].Data;this.BindIndexData(a,r)}},this.AddScriptIndexWindow=function(t,e){if(t&&t.Script&&t.Name){this.RemoveMinSizeWindows();var a=this.AddNewSubFrame(e),i={Name:t.Name,Script:t.Script,Args:t.Args,ID:t.Name,KLineType:t.KLineType,YSpecificMaxMin:t.YSpecificMaxMin,YSplitScale:t.YSplitScale,FloatPrecision:t.FloatPrecision,Condition:t.Condition,StringFormat:t.StringFormat,OutName:t.OutName};if(t.ID&&(i.ID=t.ID),this.WindowIndex[a]=new wn(i.Name,i.Script,i.Args,i),"MinuteChartContainer"==this.ClassName||"MinuteChartHScreenContainer"==this.ClassName)var r=this.SourceData;else r=this.ChartPaint[0].Data;this.BindIndexData(a,r)}},this.GetRectSelectPaint=function(){for(var t=0;t<this.ExtendChartPaint.length;++t){var e=this.ExtendChartPaint[t];if("RectSelectPaint"==e.ClassName)return e}return null},this.SetRectSelectData=function(t,e){var a=this.GetRectSelectPaint();if(!a)return!1;if(2==a.GetPointCount()){if(!a.SpaceReselected)return!1;var i=a.PreventClose;a.PreventClose=!1,a.ClearPoint(),a.PreventClose=i}return a.SetPoint(t,{DataIndex:e})},this.MoveRectSelectPoint=function(e){var a=this.GetRectSelectPaint();if(!a)return!1;if(!this.ChartPaint[0]||!this.ChartPaint[0].Data)return!1;var i=this.ChartPaint[0].Data;if(!this.Frame.SubFrame[0])return!1;var r=this.Frame.SubFrame[0].Frame,n=U(),s=(e.X-t.getBoundingClientRect().left)*n,o=r.GetXData(s);o=parseInt(o.toFixed(0));var h=o+i.DataOffset;h>=i.Data.length&&(h=i.Data.length-1);var l=i.Data[h];if(w.Chart.Log("[KLineChartContainer::MoveRectSelectPoint] point, item",e.PointIndex,l),!a.SetPoint(l,{Index:e.PointIndex,DataIndex:h}))return!1;var u=this.GetEventCallback(G.ON_DRAG_SELECT_RECT);if(u){var C=a.GetSelectRectData(),D={X:e.X,Y:e.Y,SelectData:C,RectSelectPaint:a};u.Callback(u,D,this)}return!0},this.ClearRectSelect=function(t){var e=this.GetRectSelectPaint();return!!e&&(t&&(e.PreventClose=!1),e.ClearPoint())},this.DeleteOverlayIndex=function(t,e){var a=null;if(ha.IsNumber(e)){if(e>=0&&e<this.Frame.SubFrame.length)for(var i=this.Frame.SubFrame[e],r=0;r<i.OverlayIndex.length;++r){var n=i.OverlayIndex[r];if(n.Identify===t){for(var s=0;s<n.ChartPaint.length;++s){var o=n.ChartPaint[s];o&&o.OnDestroy&&o.OnDestroy()}i.OverlayIndex.splice(r,1),a=e;break}}}else for(var h=0;h<this.Frame.SubFrame.length;++h)for(i=this.Frame.SubFrame[h],r=0;r<i.OverlayIndex.length;++r){n=i.OverlayIndex[r];if(n.Identify===t){for(s=0;s<n.ChartPaint.length;++s){o=n.ChartPaint[s];o&&o.OnDestroy&&o.OnDestroy()}i.OverlayIndex.splice(r,1),a=h;break}}if(null==a)return console.warn("[JSChartContainer::DeleteOverlayIndex] can't find overlay index. [identify="+t+"]"),!1;var l=a+1,u=this.TitlePaint[l];return u.OverlayIndex.has(t)&&u.OverlayIndex.delete(t),u.OverlayDynamicTitle.has(t)&&u.OverlayDynamicTitle.delete(t),!0},this.FindScriptIndex=function(t,e){if(ha.IsNumber(e)&&e>=0){if(e>=this.Frame.SubFrame.length)return null;var a=this.WindowIndex[e];if(a&&a.Guid==t)return{Type:0,Data:a,WindowIndex:e};a=this.Frame.SubFrame[e];for(var i=0;i<a.OverlayIndex.length;++i){var r=a.OverlayIndex[i];if(r.Identify===t)return{Type:1,Data:r,WindowIndex:e,OverlayIndex:i}}}else for(i=0;i<this.Frame.SubFrame.length;++i){a=this.WindowIndex[i];if(a&&a.Guid==t)return{Type:0,Data:a,WindowIndex:i};a=this.Frame.SubFrame[i];for(var n=0;n<a.OverlayIndex.length;++n){r=a.OverlayIndex[n];if(r.Identify===t)return{Type:1,Data:r,WindowIndex:i,OverlayIndex:n}}}return null},this.MoveIndex=function(t,e,a){if(!t||!e||!a)return!1;if(!ha.IsNumber(t.WindowIndex)||t.WindowIndex<0||t.WindowIndex>=this.Frame.SubFrame.length)return!1;if(!ha.IsNumber(e.WindowIndex)||e.WindowIndex<0||e.WindowIndex>=this.Frame.SubFrame.length)return!1;var i=this.FindScriptIndex(t.IndexID,t.WindowIndex);if(!i)return!1;var r=null,n=null;if(0==i.Type?r=i.Data:1==i.Type&&(n=i.Data),!n&&!r)return!1;var s=0,o="MinuteChartContainer"==this.ClassName||"MinuteChartHScreenContainer"==this.ClassName;if(o&&(s=2),e.WindowIndex>=s&&null==this.WindowIndex[e.WindowIndex]){r?this.WindowIndex[e.WindowIndex]=this.CreateMainScript(r):n&&(this.WindowIndex[e.WindowIndex]=this.CreateMainScript(n.Script)),0==a.Operator&&(n?this.DeleteOverlayIndex(n.Identify,t.WindowIndex):r&&this.DeleteMainIndex(r.Guid,t.WindowIndex));var h=this.GetMainData();this.BindIndexData(e.WindowIndex,h),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()}else{var l=this.Frame.SubFrame[e.WindowIndex];l.Interval=this.OverlayIndexFrameWidth;var u,C=new St,D=this.CreateOverlayFrame();D.Canvas=this.Canvas,D.MainFrame=l.Frame,D.ChartBorder=l.Frame.ChartBorder,n&&(D.IsShow=n.Frame.IsShow),D.YSplitOperator=new ua,D.YSplitOperator.LanguageID=this.LanguageID,D.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),D.YSplitOperator.Frame=D,D.YSplitOperator.ChartBorder=D.ChartBorder,D.YSplitOperator.SplitCount=l.Frame.YSplitOperator.SplitCount,C.Frame=D,r?(u=this.CreateOverlayScript(r),u.OverlayIndex={IsOverlay:!0,Identify:C.Identify,WindowIndex:e.WindowIndex,Frame:C}):n&&(u=this.CreateOverlayScript(n.Script),u.OverlayIndex={IsOverlay:!0,Identify:C.Identify,WindowIndex:e.WindowIndex,Frame:C}),C.Script=u,l.OverlayIndex.push(C);var f=e.WindowIndex;if(0==a.Operator)if(n)this.DeleteOverlayIndex(n.Identify,t.WindowIndex);else if(r){this.DeleteMainIndex(r.Guid,t.WindowIndex);i=this.FindScriptIndex(C.Identify);i&&(f=i.WindowIndex)}h=this.GetMainData();this.BindOverlayIndexData(C,f,h),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()}},this.MoveIndexToNewWindow=function(t,e){var a=this;if(!t||!e)return!1;if(!ha.IsNumber(t.WindowIndex)||t.WindowIndex<0||t.WindowIndex>=this.Frame.SubFrame.length)return!1;var i=this.FindScriptIndex(t.IndexID,t.WindowIndex);if(!i)return!1;var r=null,n=null;if(0==i.Type?r=i.Data:1==i.Type&&(n=i.Data),!n&&!r)return!1;if(t.WindowIndex==this.Frame.SubFrame.length-1&&this.Frame.SubFrame[t.WindowIndex].OverlayIndex<=0)return!1;this.RemoveMinSizeWindows();var s=this.Frame.SubFrame.length,o=this.CreateSubFrameItem(s),h=U();o.Frame.ChartBorder.TitleHeight*=h,this.Frame.SubFrame[s]=o;var l=new Ya;l.Frame=this.Frame.SubFrame[s].Frame,l.Canvas=this.Canvas,l.LanguageID=this.LanguageID,l.SelectedChart=this.SelectedChart,l.GetEventCallback=function(t){return a.GetEventCallback(t)},this.TitlePaint[s+1]=l,this.SetSubFrameOption(o,e);for(var u=0;u<this.Frame.SubFrame.length;++u){var C=this.Frame.SubFrame[u].Frame;u==this.Frame.SubFrame.length-1?C.XSplitOperator.ShowText=!0:C.XSplitOperator.ShowText=!1}0==e.Operator&&(n?this.DeleteOverlayIndex(n.Identify,t.WindowIndex):r&&this.DeleteMainIndex(r.Guid,t.WindowIndex)),this.UpdataDataoffset(),this.Frame.SetSizeChage(!0),this.UpdateXShowText&&this.UpdateXShowText(),this.ResetFrameXYSplit(),this.UpdateFrameMaxMin(),this.Draw();s=this.Frame.SubFrame.length-1;r?this.WindowIndex[s]=this.CreateMainScript(r):n&&(this.WindowIndex[s]=this.CreateMainScript(n.Script));var D=this.GetMainData();this.BindIndexData(s,D)},this.CreateOverlayScript=function(t){var e=null;switch(t.ClassName){case"ScriptIndex":e=new On;break;case"APIScriptIndex":e=new Rn(null,null,null,null,!0);break;case"OverlayScriptIndex":e=new On;break}return t.CopyTo(e),e},this.CreateMainScript=function(t){var e=null;switch(t.ClassName){case"ScriptIndex":case"OverlayScriptIndex":e=new wn;break;case"APIScriptIndex":e=new Rn;break}return t.CopyTo(e),e},this.DeleteMainIndex=function(t,e){var a=this.WindowIndex[e];if(!a)return!1;var i=this.Frame.SubFrame[e];if(!i)return!1;if(ha.IsNonEmptyArray(i.OverlayIndex)){var r=i.OverlayIndex[0];this.DeleteOverlayIndex(r.Identify,e),this.WindowIndex[e]=this.CreateMainScript(r.Script);var n=this.GetMainData();this.BindIndexData(e,n)}else this.RemoveIndexWindow(e,{DeleteMainIndex:!0})},this.GetMainData=function(){switch(this.ClassName){case"MinuteChartContainer":case"MinuteChartHScreenContainer":return this.SourceData;case"KLineChartContainer":case"KLineChartHScreenContainer":return this.ChartPaint[0].Data}},this.CreateOverlayFrame=function(){switch(this.ClassName){case"KLineChartContainer":return new ct;case"KLineChartHScreenContainer":return new mt;case"MinuteChartContainer":return new Ct;case"MinuteChartHScreenContainer":return new Dt}}}function U(){return"undefined"==typeof window?1:window.devicePixelRatio||1}function K(t,e,a){if(!t)return null;e&&(t.font=e);var i="æ";ha.IsString(a)&&(i=a);var r=t.measureText(i),n=r.fontBoundingBoxAscent+r.fontBoundingBoxDescent;return ha.IsNumber(n)||(n=r.width+2*U()),n}function J(t){this.JSChartContainer&&this.JSChartContainer.OnKeyDown&&this.JSChartContainer.OnKeyDown(t)}function z(t,e){var a=1;if(isNaN(t))return t;t<0&&(a=-1);var i=Math.pow(10,e),r=Math.round(Math.abs(t)*i)/i*a;if(/^(\d+(?:\.\d+)?)(e)([\-]?\d+)$/.test(r))var n=r.toFixed2(e);else n=r.toString();var s=n.indexOf(".");s<0&&e>0&&(s=n.length,n+=".");while(n.length<=s+e)n+="0";return n}function q(){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return"guid"+(t()+t())+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}function Z(){var t={},e=0,a=0;return document.documentElement&&document.documentElement.scrollTop?(e=document.documentElement.scrollTop,a=document.documentElement.scrollLeft):document.body&&(e=document.body.scrollTop,a=document.body.scrollLeft),t.Top=e,t.Left=a,t}function Q(t){return parseInt(t)+.5}function $(t,e){var a=t%2===0?Math.floor(e):Math.floor(e)+.5;return a}function tt(t){return.5+t<<0}function et(t){if(!t)return null;var e=(0,F.default)(t),a=JSON.parse(e);return a}function at(){this.X,this.Y}function it(){this.Data,this.JSChartContainer,this.Start,this.End,this.XStart,this.YStart,this.XEnd,this.YEnd}function rt(){this.Value,this.Message=[],this.TextColor=Oi.FrameSplitTextColor,this.Font=Oi.FrameSplitTextFont,this.LineColor=Oi.FrameSplitPen,this.LineDash=null,this.LineType=1,this.LineWidth,this.ExtendData}function nt(){this.UIElement,this.Left=50,this.Right=80,this.Top=50,this.Bottom=50,this.TitleHeight=24,this.TopSpace=0,this.BottomSpace=0,this.LeftExtendWidth=0,this.RightExtendWidth=0,this.MultiDayMinute={Count:1,Left:0,Right:0},this.GetBorder=function(){var t={Left:this.Left,LeftEx:this.Left+this.LeftExtendWidth,Right:this.UIElement.width-this.Right,RightEx:this.UIElement.width-this.Right-this.RightExtendWidth,Top:this.Top,TopEx:this.Top+this.TitleHeight+this.TopSpace,TopTitle:this.Top+this.TitleHeight,Bottom:this.UIElement.height-this.Bottom,BottomEx:this.UIElement.height-this.Bottom-this.BottomSpace,ChartWidth:this.UIElement.width,ChartHeight:this.UIElement.height};if(this.MultiDayMinute&&this.MultiDayMinute.Count>1&&(this.MultiDayMinute.Left>0||this.MultiDayMinute.Right>0)){for(var e=this.UIElement.width-this.Left-this.Right,a=e/this.MultiDayMinute.Count,i=[],r=0;r<this.MultiDayMinute.Count;++r){var n={Left:this.Left+a*r,Right:this.Left+a*(r+1)};n.LeftEx=n.Left+this.MultiDayMinute.Left,n.RightEx=n.Right-this.MultiDayMinute.Right,i.push(n)}t.DayBorder=i}return t},this.GetHScreenBorder=function(){var t={Left:this.Left,LeftEx:this.Left+this.BottomSpace,Right:this.UIElement.width-this.Right,RightEx:this.UIElement.width-this.Right-this.TitleHeight-this.TopSpace,RightTitle:this.UIElement.width-this.Right-this.TitleHeight,Top:this.Top,TopEx:this.Top+this.LeftExtendWidth,Bottom:this.UIElement.height-this.Bottom,BottomEx:this.UIElement.height-this.Bottom-this.RightExtendWidth,ChartWidth:this.UIElement.width,ChartHeight:this.UIElement.height};return t},this.PtInClient=function(t,e,a,i){if(i){var r=this.GetHScreenBorder();a.rect(r.Left,r.TopEx,r.Right-r.Left,r.BottomEx-r.TopEx)}else{r=this.GetBorder();if(r.DayBorder){for(var n=0;n<r.DayBorder.length;++n){var s=r.DayBorder[n];if(a.beginPath(),a.rect(s.LeftEx,r.TopEx,s.RightEx-s.LeftEx,r.BottomEx-r.TopEx),a.isPointInPath(t,e))return 1;if(a.beginPath(),a.rect(s.Left,r.TopEx,s.LeftEx-s.Left,r.BottomEx-r.TopEx),a.isPointInPath(t,e))return 200+parseInt(n);if(a.beginPath(),a.rect(s.RightEx,r.TopEx,s.Right-s.RightEx,r.BottomEx-r.TopEx),a.isPointInPath(t,e))return 300+parseInt(n)}return-1}a.rect(r.LeftEx,r.Top,r.RightEx-r.LeftEx,r.Bottom-r.Top)}return a.isPointInPath(t,e)?1:this.LeftExtendWidth>10&&(a.beginPath(),!0===i?a.rect(r.Left,r.Top,r.Right-r.Left,r.TopEx-r.Top):a.rect(r.Left,r.Top,r.LeftEx-r.Left,r.Bottom-r.Top),a.isPointInPath(t,e))?2:this.RightExtendWidth>10&&(a.beginPath(),!0===i?a.rect(r.Left,r.BottomEx,r.Right-r.Left,r.Bottom-r.BottomEx):a.rect(r.RightEx,r.Top,r.Right-r.RightEx,r.Bottom-r.Top),a.isPointInPath(t,e))?3:-1},this.GetChartWidth=function(){return this.UIElement.width},this.GetChartHeight=function(){return this.UIElement.height},this.GetLeft=function(){return this.Left+this.LeftExtendWidth},this.GetRight=function(){return this.UIElement.width-this.Right-this.RightExtendWidth},this.GetTop=function(){return this.Top},this.GetTopEx=function(){return this.Top+this.TitleHeight+this.TopSpace},this.GetTopTitle=function(){return this.Top+this.TitleHeight},this.GetBottom=function(){return this.UIElement.height-this.Bottom},this.GetBottomEx=function(){return this.UIElement.height-this.Bottom-this.BottomSpace},this.GetWidth=function(){return this.UIElement.width-this.Left-this.Right-this.LeftExtendWidth-this.RightExtendWidth},this.GetHeight=function(){return this.UIElement.height-this.Top-this.Bottom},this.GetHeightEx=function(){return this.UIElement.height-this.Top-this.Bottom-this.TitleHeight-this.TopSpace-this.BottomSpace},this.GetRightEx=function(){return this.UIElement.width-this.Right-this.TitleHeight-this.TopSpace},this.GetWidthEx=function(){return this.UIElement.width-this.Left-this.Right-this.TitleHeight-this.TopSpace-this.BottomSpace},this.GetLeftEx=function(){return this.Left+this.BottomSpace},this.GetRightTitle=function(){return this.UIElement.width-this.Right-this.TitleHeight},this.GetTitleHeight=function(){return this.TitleHeight}}function st(){this.HorizontalInfo=new Array,this.VerticalInfo=new Array,this.ClassName="IChartFramePainting",this.Canvas,this.Identify,this.ChartBorder,this.PenBorder=Oi.FrameBorderPen,this.TitleBGColor=Oi.FrameTitleBGColor,this.IsShow=!0,this.SizeChange=!0,this.XYSplit=!0,this.HorizontalMax,this.HorizontalMin,this.XPointCount=10,this.YSplitOperator,this.XSplitOperator,this.Data,this.IsLocked=!1,this.LockPaint=null,this.YSpecificMaxMin=null,this.IsShowBorder=!0,this.IsShowTitleArraw=!0,this.IsShowIndexName=!0,this.IsShowOverlayIndexName=!0,this.OverlayIndexType={Position:1,LineSpace:3},this.IndexParamSpace=2,this.IndexTitleSpace=0,this.IsShowIndexTitle=!0,this.IsDrawTitleBottomLine=!1,this.BorderLine=null,this.Buttons=[],this.IsMinSize=!1,this.LogoTextColor=Oi.FrameLogo.TextColor,this.LogoTextFont=Oi.FrameLogo.Font,this.GlobalOption,this.PtInButtons=function(t,e){for(var a=0;a<this.Buttons.length;++a){var i=this.Buttons[a];if(i.Rect){var r=i.Rect;if(this.Canvas.beginPath(),this.Canvas.rect(r.Left,r.Top,r.Width,r.Height),this.Canvas.isPointInPath(t,e))return{ID:i.ID,Rect:r}}}return null},this.GetBorder=function(){return this.IsHScreen?this.ChartBorder.GetHScreenBorder():this.ChartBorder.GetBorder()},this.Draw=function(){this.Buttons=[],this.DrawFrame(),this.DrawBorder(),this.SizeChange=!1,this.XYSplit=!1},this.DrawFrame=function(){},this.ClearCoordinateText=function(t){if(ha.IsNonEmptyArray(this.HorizontalInfo))for(var e=0;e<this.HorizontalInfo.length;++e){var a=this.HorizontalInfo[e];a&&a.Message&&Array.isArray(a.Message)&&(a.Message[0]=a.Message[1]=null)}if(ha.IsNonEmptyArray(this.VerticalInfo))for(e=0;e<this.VerticalInfo.length;++e){a=this.VerticalInfo[e];a&&a.Message&&Array.isArray(a.Message)&&(a.Message[0]=a.Message[1]=null)}},this.DrawBorder=function(){if(this.IsShowBorder&&!this.IsMinSize){var t=1==this.IsHScreen?this.ChartBorder.GetHScreenBorder():this.ChartBorder.GetBorder(),e=Q(t.Left),a=Q(t.Top),i=Q(t.Right),r=Q(t.Bottom),n=i-e,s=r-a;null==this.BorderLine?(this.Canvas.strokeStyle=this.PenBorder,this.Canvas.strokeRect(e,a,n,s)):ha.IsPlusNumber(this.BorderLine)&&(this.Canvas.strokeStyle=this.PenBorder,this.Canvas.beginPath(),(1&this.BorderLine)>0&&(this.Canvas.moveTo(e,a),this.Canvas.lineTo(i,a)),(2&this.BorderLine)>0&&(this.Canvas.moveTo(e,r),this.Canvas.lineTo(i,r)),(4&this.BorderLine)>0&&(this.Canvas.moveTo(e,a),this.Canvas.lineTo(e,r)),(8&this.BorderLine)>0&&(this.Canvas.moveTo(i,a),this.Canvas.lineTo(i,r)),this.Canvas.stroke())}},this.DrawTitleBG=function(){if(!(this.ChartBorder.TitleHeight<=0)){var t=this.GetBorder(),e=Q(t.Left),a=Q(t.Top),i=Q(t.Right),r=Q(this.ChartBorder.GetTopTitle()),n=i-e,s=r-a;this.Canvas.fillStyle=this.TitleBGColor,this.Canvas.fillRect(e,a,n,s),this.IsDrawTitleBottomLine&&(this.Canvas.strokeStyle=this.PenBorder,this.Canvas.beginPath(),this.Canvas.moveTo(e,Q(t.TopTitle)),this.Canvas.lineTo(i,Q(t.TopTitle)),this.Canvas.stroke())}},this.DrawLock=function(){this.IsLocked&&(null==this.LockPaint&&(this.LockPaint=new He),this.LockPaint.Canvas=this.Canvas,this.LockPaint.ChartBorder=this.ChartBorder,this.LockPaint.ChartFrame=this,this.LockPaint.Draw(!0))},this.DrawLogo=function(){var t=this.GetBorder(),e=Oi.FrameLogo.Text;if(ha.IsString(e))if(this.Canvas.fillStyle=this.LogoTextColor,this.Canvas.font=this.LogoTextFont,this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.IsHScreen){var a=t.Left+5,i=t.Top+5;this.Canvas.save(),this.Canvas.translate(a,i),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(e,0,0),this.Canvas.restore()}else{a=t.Left+5,i=t.Bottom-5;this.Canvas.fillText(e,a,i)}},this.CalculateLock=function(){this.IsLocked&&(null==this.LockPaint&&(this.LockPaint=new He),this.LockPaint.Canvas=this.Canvas,this.LockPaint.ChartBorder=this.ChartBorder,this.LockPaint.ChartFrame=this,this.LockPaint.Draw(!1))},this.SetLock=function(t){t?(this.IsLocked=!0,this.LockPaint||(this.LockPaint=new He),t.Callback&&(this.LockPaint.Callback=t.Callback),t.IndexName&&(this.LockPaint.IndexName=t.IndexName),t.ID&&(this.LockPaint.LockID=t.ID),t.BG&&(this.LockPaint.BGColor=t.BG),t.Text&&(this.LockPaint.Title=t.Text),t.TextColor&&(this.LockPaint.TextColor=t.TextColor),t.Font&&(this.LockPaint.Font=t.Font),t.Count&&(this.LockPaint.LockCount=t.Count),t.MinWidth>0&&(this.LockPaint.MinWidth=t.MinWidth)):this.IsLocked=!1},this.GetLockRect=function(){return this.IsLocked&&this.LockPaint?this.LockPaint.LockRect:null},this.ReloadResource=function(t){for(var e in t||(this.PenBorder=Oi.FrameBorderPen,this.TitleBGColor=Oi.FrameTitleBGColor),this.HorizontalInfo){var a=this.HorizontalInfo[e];a.Font&&(a.Font=Oi.FrameSplitTextFont),a.TextColor&&(a.TextColor=Oi.FrameSplitTextColor),a.LineColor&&(a.LineColor=Oi.FrameSplitPen)}for(var e in this.VerticalInfo){a=this.VerticalInfo[e];a.Font&&(a.Font=Oi.FrameSplitTextFont),a.TextColor&&(a.TextColor=Oi.FrameSplitTextColor),a.LineColor&&(a.LineColor=Oi.FrameSplitPen)}},this.GetFontHeight=function(t){return K(this.Canvas,t,"æ")},this.GetScaleTextWidth=function(){}}function ot(){this.newMethod=st,this.newMethod(),delete this.newMethod,this.ClassName="NoneFrame",this.Snapshot=function(){},this.SetSizeChage=function(t){this.SizeChange=t,this.Position={X:this.ChartBorder.UIElement.offsetLeft,Y:this.ChartBorder.UIElement.offsetTop,W:this.ChartBorder.UIElement.clientWidth,H:this.ChartBorder.UIElement.clientHeight}}}function ht(){this.newMethod=st,this.newMethod(),delete this.newMethod,this.ClassName="AverageWidthFrame",this.DataWidth=50*U(),this.DistanceWidth=10*U(),this.MinXDistance=30*U(),this.MinYDistance=12*U(),this.CoordinateType=0,this.IsShowYText=[!0,!0],this.XBottomOffset=Oi.Frame.XBottomOffset,this.YTextTopOffset=Oi.Frame.YTopOffset,this.YTextPosition=[0,0],this.YTextPadding=[Oi.Frame.YTextPadding[0],Oi.Frame.YTextPadding[1]],this.IsShowXLine=!0,this.IsShowYLine=!0,this.YInsideOffset=0,this.YTextBaseline=0,this.MultiTextFormat=0,this.RightTextMaxWidth=0,this.ShortYLineLength=5,this.ShortXLineLength=5,this.BeforeDrawXYCallback,this.GetEventCallback,this.ToolbarButtonStyle=Oi.ToolbarButtonStyle,this.CloseWindowButton=et(Oi.Buttons.CloseWindow),this.OverlayIndexButton=et(Oi.Buttons.OverlayIndex),this.ChangeIndexButton=et(Oi.Buttons.ChangeIndex),this.ModifyIndexParamButton=et(Oi.Buttons.ModifyIndexParam),this.DrawPicture={BGColor:Oi.DrawPicture.XYCoordinate.BGColor,TextBGColor:Oi.DrawPicture.XYCoordinate.TextBGColor,TextColor:Oi.DrawPicture.XYCoordinate.TextColor,Font:Oi.DrawPicture.XYCoordinate.Font},this.IChartFramePainting_ReloadResource=this.ReloadResource,this.ReloadResource=function(t){this.IChartFramePainting_ReloadResource(t),t||(this.ToolbarButtonStyle=Oi.ToolbarButtonStyle,this.CloseWindowButton=et(Oi.Buttons.CloseWindow),this.OverlayIndexButton=et(Oi.Buttons.OverlayIndex),this.ChangeIndexButton=et(Oi.Buttons.ChangeIndex),this.ModifyIndexParamButton=et(Oi.Buttons.ModifyIndexParam))},this.DrawFrame=function(){if(this.XPointCount>0){var t=this.ChartBorder.GetWidth()/(6*this.XPointCount);this.DistanceWidth=2*t,this.DataWidth=4*t}this.DrawHorizontal(),this.DrawVertical()},this.DrawTitleButton=function(t,e){var a=this.GetBorder();if(this.IsHScreen){var i=a.Bottom-3,r=a.RightTitle+this.ChartBorder.TitleHeight/2;this.Canvas.save(),this.Canvas.translate(r,i),this.Canvas.rotate(90*Math.PI/180);for(var n=0,s=0,o=0,h=0;h<t.length;++h){var l=t[h],u=l.Style.Size,C=(s=o-u-l.Style.MerginLeft,u+"px "+l.Style.Family),D=l.Style.Color;this.Canvas.fillStyle=D,this.Canvas.font=C,this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillText(l.Style.Text,s,0);var f={Left:r-u/2,Right:r+u/2,Bottom:i,Width:u,Height:u+l.Style.MerginLeft};f.Top=f.Bottom-u-l.Style.MerginLeft,this.Buttons.push({ID:l.ID,Rect:f}),o=s,i=f.Top}this.Canvas.restore()}else{var c=a.Right-3;for(a.Left,n=a.Top+this.ChartBorder.TitleHeight/2,h=0;h<t.length;++h){l=t[h],u=l.Style.Size;var d=c-u-l.Style.MerginLeft;C=u+"px "+l.Style.Family,f={Left:d,Top:n-u/2,Right:d+u+l.Style.MerginLeft,Bottom:n+u/2,Width:u+l.Style.MerginLeft,Height:u},D=l.Style.Color;e&&e.X>=f.Left&&e.X<f.Right&&e.Y>=f.Top&&e.Y<=f.Bottom&&(D=l.Style.MoveOnColor),this.Canvas.fillStyle=D,this.Canvas.font=C,this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillText(l.Style.Text,d,n),this.Buttons.push({ID:l.ID,Rect:f}),c=d}}},this.GetYFromData=function(t,e){if(this.Logarithmic&&this.GetYLogarithmicFromData)return this.GetYLogarithmicFromData(t,e);if(!1===e){if(1==this.CoordinateType){var a=this.ChartBorder.GetHeightEx()*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return this.ChartBorder.GetTopEx()+a}a=this.ChartBorder.GetHeightEx()*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return this.ChartBorder.GetBottomEx()-a}if(1==this.CoordinateType){if(t<=this.HorizontalMin)return this.ChartBorder.GetTopEx();if(t>=this.HorizontalMax)return this.ChartBorder.GetBottomEx();a=this.ChartBorder.GetHeightEx()*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return this.ChartBorder.GetTopEx()+a}if(t<=this.HorizontalMin)return this.ChartBorder.GetBottomEx();if(t>=this.HorizontalMax)return this.ChartBorder.GetTopEx();a=this.ChartBorder.GetHeightEx()*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return this.ChartBorder.GetBottomEx()-a},this.DrawHorizontal=function(){if(this.RightTextMaxWidth=0,ha.IsNonEmptyArray(this.HorizontalInfo)){for(var t=this.ChartBorder.GetBorder(),e=t.Left,a=t.Right,i=t.Bottom,r=this.ChartBorder.GetTopTitle(),n=this.ChartBorder.Right,s=this.ChartBorder.Left,o=s>10&&!0===this.IsShowYText[0]&&2!=this.YTextPosition[0],h=n>10&&!0===this.IsShowYText[1]&&2!=this.YTextPosition[1],l=null,u=U(),C=(t.BottomEx-t.TopEx)/this.HorizontalInfo.length,D=[],f=this.HorizontalInfo.length-1;f>=0;--f){var c=this.HorizontalInfo[f],d=this.GetYFromData(c.Value);if(!(null!=d&&null!=l&&Math.abs(d-l)<this.MinYDistance)){var m=Q(d);if(d!=i&&this.IsShowYLine){var v=!1;ha.IsPlusNumber(c.LineWidth)&&(this.Canvas.lineWidth=c.LineWidth*u,v=!0),this.Canvas.strokeStyle=c.LineColor,2==c.LineType?(c.LineDash?this.Canvas.setLineDash(c.LineDash):this.Canvas.setLineDash([5*u,5*u]),this.Canvas.beginPath(),this.Canvas.moveTo(e,m),this.Canvas.lineTo(a,m),this.Canvas.stroke(),this.Canvas.setLineDash([])):3==c.LineType||8==c.LineType||9==c.LineType||c.LineType>0&&(Oi.FrameYLineDash?(this.Canvas.setLineDash(Oi.FrameYLineDash),this.Canvas.beginPath(),this.Canvas.moveTo(e,m),this.Canvas.lineTo(a,m),this.Canvas.stroke(),this.Canvas.setLineDash([])):(this.Canvas.beginPath(),this.Canvas.moveTo(e,m),this.Canvas.lineTo(a,m),this.Canvas.stroke())),v&&(this.Canvas.lineWidth=u)}var S=d;if(d>=i-2?this.Canvas.textBaseline="bottom":d<=r+2?(this.Canvas.textBaseline="top",S+=this.YTextTopOffset):this.Canvas.textBaseline="middle",this.Canvas.strokeStyle=c.TextColor,this.Canvas.fillStyle=c.TextColor,null!=c.Message[0]&&o&&(null!=c.Font&&(this.Canvas.font=c.Font),this.Canvas.textAlign="right",this.Canvas.fillText(c.Message[0],e-this.YTextPadding[0],S)),null!=c.Message[1]&&h){null!=c.Font&&(this.Canvas.font=c.Font);var I=a;if(3==c.LineType){var p=this.ShortYLineLength*U();this.Canvas.beginPath(),this.Canvas.moveTo(I,m),this.Canvas.lineTo(I+p,m),this.Canvas.stroke(),I+=p}if(this.Canvas.textAlign="left",Array.isArray(c.Message[1]))if(1==this.MultiTextFormat){c.ExtendData&&c.ExtendData.Font&&(this.Canvas.font=c.ExtendData.Font);var T={Text:[{Text:c.Message[1][0],Width:this.Canvas.measureText(c.Message[1][0]).width},{Text:c.Message[1][1],Width:this.Canvas.measureText(c.Message[1][1]).width}],X:I+2,Y:S,TextBaseline:this.Canvas.textBaseline,Item:c};D.push(T)}else if(2==this.MultiTextFormat){this.Canvas.fillText(c.Message[1][0],I+this.YTextPadding[1],S);var g=this.Canvas.measureText("M").width;C>2*g&&this.Canvas.fillText(c.Message[1][1],I+this.YTextPadding[1],S+g)}else this.Canvas.fillText(c.Message[1][0],I+this.YTextPadding[1],S);else this.Canvas.fillText(c.Message[1],I+this.YTextPadding[1],S)}l=d}}ha.IsNonEmptyArray(D)&&1==this.MultiTextFormat&&this.DrawHorizontalMuText(D)}},this.DrawHorizontalMuText=function(t){for(var e=[null,null],a=0;a<t.length;++a){var i=t[a],r=i.Text[0].Width;ha.IsNumber(e[0])?e[0]<r&&(e[0]=r):e[0]=r,r=i.Text[1].Width,ha.IsNumber(e[1])?e[1]<r&&(e[1]=r):e[1]=r}for(a=0;a<t.length;++a){i=t[a];var n=i.Item;this.Canvas.textBaseline=n.TextBaseline,n.ExtendData&&n.ExtendData.Font?this.Canvas.font=n.ExtendData.Font:n.Font&&(this.Canvas.font=n.Font),n.ExtendData&&n.ExtendData.PriceColor?this.Canvas.fillStyle=n.ExtendData.PriceColor:this.Canvas.fillStyle=n.TextColor,this.Canvas.textAlign="right";var s=i.X+e[1];this.Canvas.fillText(i.Text[1].Text,s,i.Y),n.ExtendData&&n.ExtendData.SplitColor?this.Canvas.fillStyle=n.ExtendData.SplitColor:this.Canvas.fillStyle=n.TextColor,this.Canvas.textAlign="left";var o=this.Canvas.measureText("/").width;this.Canvas.fillText("/",s,i.Y),n.ExtendData&&n.ExtendData.PercentageColor?this.Canvas.fillStyle=n.ExtendData.PercentageColor:this.Canvas.fillStyle=n.TextColor,this.Canvas.textAlign="right";s=i.X+e[1]+e[0]+o;this.Canvas.fillText(i.Text[0].Text,s,i.Y);var h=e[1]+e[0]+4*o;this.RightTextMaxWidth<h&&(this.RightTextMaxWidth=h)}},this.DrawInsideClientHorizontal=function(){var t=this.GetBorder();if(t.DayBorder&&ha.IsNonEmptyArray(t.DayBorder))var e=t.DayBorder[0],a=e.LeftEx,i=(e=t.DayBorder[t.DayBorder.length-1],e.RightEx),r=t.Bottom,n=t.TopTitle;else a=t.LeftEx,i=t.RightEx,r=t.Bottom,n=t.TopTitle;for(var s=U(),o=null,h=null,l=this.HorizontalInfo.length-1;l>=0;--l){e=this.HorizontalInfo[l];var u=this.GetYFromData(e.Value);if(!(null!=u&&null!=o&&Math.abs(u-o)<this.MinYDistance)){if(e.Message[2]){null!=e.Font&&(this.Canvas.font=e.Font),this.Canvas.fillStyle=e.TextColor,this.Canvas.textAlign="left";var C=u;u>=r-2?this.Canvas.textBaseline="bottom":u<=n+2?(this.Canvas.textBaseline="top",C+=this.YTextTopOffset):this.Canvas.textBaseline="middle";var D={X:a,Y:C,Text:{BaseLine:this.Canvas.textBaseline,TextAlign:this.Canvas.textAlign,Font:this.Canvas.font,Value:e.Message[0]}};this.IsOverlayMaxMin&&this.IsOverlayMaxMin(D)||(this.Canvas.fillText(e.Message[2],a+1*s,C),(null==h||h>C)&&(this.YInsideOffset=this.Canvas.measureText(e.Message[2]).width+4*U(),h=C))}if(e.Message[3]){null!=e.Font&&(this.Canvas.font=e.Font),this.Canvas.fillStyle=e.TextColor,this.Canvas.textAlign="right";C=u;u>=r-2?this.Canvas.textBaseline="bottom":u<=n+2?(this.Canvas.textBaseline="top",C+=this.YTextTopOffset):this.Canvas.textBaseline="middle";var f=this.Canvas.measureText(e.Message[3]).width;D={X:i-f,Y:C,Text:{BaseLine:this.Canvas.textBaseline,TextAlign:this.Canvas.textAlign,Font:this.Canvas.font,Value:e.Message[1]}};this.IsOverlayMaxMin&&this.IsOverlayMaxMin(D)||this.Canvas.fillText(e.Message[3],i-1*s,C)}o=u}}},this.DrawInsideHorizontal=function(){if(!0!==this.IsHScreen&&!this.IsMinSize&&(!1!==this.IsShowYText[0]||!1!==this.IsShowYText[1])){this.DrawInsideClientHorizontal();var t=this.ChartBorder.GetBorder(),e=t.Left,a=t.Right,i=t.Bottom,r=t.TopTitle,n=this.ChartBorder.Right,s=this.ChartBorder.Left,o=(this.ChartBorder.TitleHeight,(s<10||2==this.YTextPosition[0])&&!0===this.IsShowYText[0]),h=(n<10||2==this.YTextPosition[1])&&!0===this.IsShowYText[1];if(o||h)for(var l=U(),u=null,C=null,D=this.HorizontalInfo.length-1;D>=0;--D){var f=this.HorizontalInfo[D],c=this.GetYFromData(f.Value);if(!(null!=c&&null!=u&&Math.abs(c-u)<this.MinYDistance)){if(null!=f.Message[0]&&o){null!=f.Font&&(this.Canvas.font=f.Font),this.Canvas.fillStyle=f.TextColor,this.Canvas.textAlign="left";var d=c;c>=i-2?this.Canvas.textBaseline="bottom":c<=r+2?(this.Canvas.textBaseline="top",d+=this.YTextTopOffset):1==this.YTextBaseline?this.Canvas.textBaseline="bottom":this.Canvas.textBaseline="middle";var m={X:e,Y:d,Text:{BaseLine:this.Canvas.textBaseline,TextAlign:this.Canvas.textAlign,Font:this.Canvas.font,Value:f.Message[0]}};this.IsOverlayMaxMin&&this.IsOverlayMaxMin(m)||(this.Canvas.fillText(f.Message[0],e+1*l,d),(null==C||C>d)&&(this.YInsideOffset=this.Canvas.measureText(f.Message[0]).width+4*U(),C=d))}if(null!=f.Message[1]&&h){null!=f.Font&&(this.Canvas.font=f.Font),this.Canvas.fillStyle=f.TextColor,this.Canvas.textAlign="right";d=c;if(c>=i-2?this.Canvas.textBaseline="bottom":c<=r+2?(this.Canvas.textBaseline="top",d+=this.YTextTopOffset):1==this.YTextBaseline?this.Canvas.textBaseline="bottom":this.Canvas.textBaseline="middle",Array.isArray(f.Message[1]))var v=f.Message[1][0];else v=f.Message[1];var S=this.Canvas.measureText(v).width;m={X:a-S,Y:d,Text:{BaseLine:this.Canvas.textBaseline,TextAlign:this.Canvas.textAlign,Font:this.Canvas.font,Value:f.Message[1]}};this.IsOverlayMaxMin&&this.IsOverlayMaxMin(m)||this.Canvas.fillText(v,a-1*l,d)}u=c}}}},this.GetXFromIndex=function(t){var e=this.XPointCount;if(1==e)return 0==t?this.ChartBorder.GetLeft():this.ChartBorder.GetRight();if(e<=0)return this.ChartBorder.GetLeft();if(t>=e)return this.ChartBorder.GetRight();var a=this.ChartBorder.GetLeft()+this.ChartBorder.GetWidth()*t/e;return a},this.DrawVertical=function(){var t=this.GetBorder(),e=t.TopTitle,a=t.Bottom,i=t.RightEx,r=U();if(!(this.ChartBorder.Bottom<=5*U()))for(var n=null,s=null,o=0;o<this.VerticalInfo.length;++o){var h=this.GetXFromIndex(this.VerticalInfo[o].Value);if(h>i)break;if(!(null!=n&&Math.abs(h-n)<this.MinXDistance)){var l=this.VerticalInfo[o],u=Q(h);if(this.IsShowXLine&&(2==l.LineType?(this.Canvas.strokeStyle=this.VerticalInfo[o].LineColor,l.LineDash?this.Canvas.setLineDash(l.LineDash):this.Canvas.setLineDash([5*r,5*r]),this.Canvas.beginPath(),this.Canvas.moveTo(u,e),this.Canvas.lineTo(u,a),this.Canvas.stroke(),this.Canvas.setLineDash([])):3==l.LineType||l.LineType>0&&(Oi.FrameXLineDash?(this.Canvas.strokeStyle=this.VerticalInfo[o].LineColor,this.Canvas.setLineDash(Oi.FrameXLineDash),this.Canvas.beginPath(),this.Canvas.moveTo(u,e),this.Canvas.lineTo(u,a),this.Canvas.stroke(),this.Canvas.setLineDash([])):(this.Canvas.strokeStyle=this.VerticalInfo[o].LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(u,e),this.Canvas.lineTo(u,a),this.Canvas.stroke()))),l.BG&&l.BG.Color){var C=l.BG;this.Canvas.fillStyle=C.Color;var D=this.GetXFromIndex(C.Index.Start),f=this.GetXFromIndex(C.Index.End),c=this.ChartBorder.Bottom;ha.IsNumber(C.Height)&&(c=C.Height);var d={Left:D,Width:f-D,Top:t.Bottom,Height:c};this.Canvas.fillRect(d.Left,d.Top,d.Width,d.Height)}if(null!=this.VerticalInfo[o].Message[0]){null!=this.VerticalInfo[o].Font&&(this.Canvas.font=this.VerticalInfo[o].Font);var m=0;this.Canvas.fillStyle=l.TextColor,this.Canvas.strokeStyle=l.TextColor;var v=this.Canvas.measureText(this.VerticalInfo[o].Message[0]).width;if(h<v/2?(this.Canvas.textAlign="left",this.Canvas.textBaseline="top",m=h):h+v/2>=this.ChartBorder.GetChartWidth()?(this.Canvas.textAlign="right",this.Canvas.textBaseline="top",m=h-v):(this.Canvas.textAlign="center",this.Canvas.textBaseline="top",m=h-v/2),null==s||m>s){var S=a;if(3==l.LineType){var I=this.ShortXLineLength*r;this.Canvas.beginPath(),this.Canvas.moveTo(u,S),this.Canvas.lineTo(u,S+I),this.Canvas.stroke(),S+=I+2*r}this.Canvas.fillText(this.VerticalInfo[o].Message[0],h,S+this.XBottomOffset),s=m+v}}n=h}}},this.GetYData=function(t,e){return this.Logarithmic&&this.GetYLogarithmicFromData?this.GetYLogarithmicData(t):1==this.CoordinateType?0==e?(t-this.ChartBorder.GetTopEx())/this.ChartBorder.GetHeightEx()*(this.HorizontalMax-this.HorizontalMin)+this.HorizontalMin:t<this.ChartBorder.GetTopEx()?this.HorizontalMin:t>this.ChartBorder.GetBottomEx()?this.HorizontalMax:(t-this.ChartBorder.GetTopEx())/this.ChartBorder.GetHeightEx()*(this.HorizontalMax-this.HorizontalMin)+this.HorizontalMin:0==e?(this.ChartBorder.GetBottomEx()-t)/this.ChartBorder.GetHeightEx()*(this.HorizontalMax-this.HorizontalMin)+this.HorizontalMin:t<this.ChartBorder.GetTopEx()?this.HorizontalMax:t>this.ChartBorder.GetBottomEx()?this.HorizontalMin:(this.ChartBorder.GetBottomEx()-t)/this.ChartBorder.GetHeightEx()*(this.HorizontalMax-this.HorizontalMin)+this.HorizontalMin},this.GetXData=function(t){return t<=this.ChartBorder.GetLeft()?0:t>=this.ChartBorder.GetRight()?this.XPointCount:(t-this.ChartBorder.GetLeft())*(1*this.XPointCount/this.ChartBorder.GetWidth())},this.DrawPictureXCoordinate=function(t,e,a){if(!this.IsHScreen&&e&&ha.IsNonEmptyArray(e.Points)){var i=this.GetBorder(),r=i.Left,n=i.Right;this.Canvas.font=this.DrawPicture.Font;var s=this.GetFontHeight();if(e.X){var o=e.X,h=o.Min.X,l=o.Max.X;h<r&&(h=r),l>n&&(l=n),this.Canvas.fillStyle=this.DrawPicture.BGColor,this.Canvas.fillRect(h,i.Bottom,l-h,s)}for(var u=0;u<e.Points.length;++u){var C=e.Points[u];if(!(C.X<r||C.X>n)){var D=this.GetXData(C.X,!1),f=(D=Math.round(D),this.GetKItem(D));if(f){var c=ha.FormatDateString(f.Date,null);Ot.IsMinutePeriod(a.Period)&&(c+=" "+ha.FormatTimeString(f.Time,"HH:MM"));var d=this.Canvas.measureText(c).width+2,m=C.X-d/2;m<r&&(m=r),this.Canvas.fillStyle=this.DrawPicture.TextBGColor,this.Canvas.fillRect(m,i.Bottom,d,s),this.Canvas.fillStyle=this.DrawPicture.TextColor;var v=i.Bottom+s;this.Canvas.fillText(c,m+1,v)}}}}},this.GetKItem=function(t){if(!this.Data)return null;if(!ha.IsNonEmptyArray(this.Data.Data))return null;var e=this.Data.DataOffset+t;return this.Data.Data[e]},this.DrawPictureYCoordinate=function(t,e,a){if(!this.IsHScreen&&e&&ha.IsNonEmptyArray(e.Points)){var i=this.GetBorder(),r=i.TopEx,n=i.BottomEx,s=i.Right;this.Canvas.font=this.DrawPicture.Font;var o=this.GetFontHeight();this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom";var h=2;a&&a.Symbol&&(h=rn(a.Symbol));for(var l=0,u=0;u<e.Points.length;++u){var C=e.Points[u],D=this.GetYData(C.Y),f=D.toFixed(h),c=this.Canvas.measureText(f).width;l<c&&(l=c),e.Points[u].Text=f}if(l+=this.YTextPadding[1]+2,e.Y){var d=e.Y,m=d.Min.Y,v=d.Max.Y;d.Min.Y<r&&(m=r),d.Max.Y>n&&(v=n),this.Canvas.fillStyle=this.DrawPicture.BGColor,this.Canvas.fillRect(s,m,l+5,v-m)}for(u=0;u<e.Points.length;++u){C=e.Points[u];if(!(C.Y<r||C.Y>n)){this.Canvas.fillStyle=this.DrawPicture.TextBGColor,this.Canvas.fillRect(s,C.Y-o/2,l,o),this.Canvas.fillStyle=this.DrawPicture.TextColor;var S=C.Y+o/2;this.Canvas.fillText(C.Text,s+this.YTextPadding[1],S)}}}},this.GetCustomItemTextInfo=function(t,e,a){var i=e?t.Message[0]:t.Message[1],r=[],n=0;if(Array.isArray(i)){for(var s=0;s<i.length;++s){t=i[s];if(1===t.Type)r.push({Type:t.Type});else{var o=this.Canvas.measureText(i[s].Text).width;o>n&&(n=o),r.push({Text:i[s].Text,Width:o+2*a})}}n>0&&(n+=2*a)}else n=this.Canvas.measureText(i).width+2*a,r.push({Text:i,Width:n});return{MaxWidth:n,Text:r}},this.DrawCustomItem=function(t){if(t.Message[1]||t.Message[0])if(t.Value>this.HorizontalMax||t.Value<this.HorizontalMin)this.SendDrawCountDownEvent({IsShow:!1});else{var e=this.GetBorder(),a=e.Left,i=e.Right,r=e.Bottom,n=e.Top,s=this.ChartBorder.Right,o=this.ChartBorder.Left;this.ChartBorder.TitleHeight;this.IsHScreen&&(o=this.ChartBorder.Top,s=this.ChartBorder.Bottom,n=e.Top,r=e.Bottom);var h=U(),l=18*h,u=l,C=this.GetYFromData(t.Value),D=0;if(t.ExtendData&&t.ExtendData.Custom){var f=t.ExtendData.Custom;ha.IsNumber(f.Position)&&(D=f.Position)}if(t.Message[0])if(o<10||1==D){null!=t.Font&&(this.Canvas.font=t.Font),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle";var c=this.GetCustomItemTextInfo(t,!0,h),d=c.MaxWidth,m=this.GetFontHeight();u=m>l?m:l;var v=t.LineColor,S=this.RGBToStruct(t.LineColor);S&&(v="rgba("+S.R+", "+S.G+", "+S.B+", "+Oi.FrameLatestPrice.BGAlpha+")");for(var I=C,p=0;p<c.Text.length;++p){var T=c.Text[p];if(this.IsHScreen){var g=n,x=I-u/2-1*h;this.Canvas.fillStyle=v,this.Canvas.fillRect(x,g,u,T.Width),this.DrawHScreenText({X:I,Y:g},{Text:T.Text,Color:t.TextColor,XOffset:1*h,YOffset:2*h}),0==p&&this.DrawLine(g+T.Width,r,I,t.LineColor,t.LineType,t),I-=u+1*h}else if(1===T.Type);else{g=I-u/2-1*h,x=a+1*h;this.Canvas.fillStyle=v,this.Canvas.fillRect(x,g,T.Width,u),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(T.Text,x+1*h,I),0==p&&this.DrawLine(x+T.Width,i,I,t.LineColor,t.LineType,t),I+=u+1*h}}}else{null!=t.Font&&(this.Canvas.font=t.Font),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle";c=this.GetCustomItemTextInfo(t,!0,h),d=c.MaxWidth,m=this.GetFontHeight();u=m>l?m:l;for(I=C,p=0;p<c.Text.length;++p){T=c.Text[p];if(this.IsHScreen){if(0==p)g=n-T.Width;else g=n-d;x=I-u/2-1*h;this.Canvas.fillStyle=t.LineColor,this.Canvas.fillRect(x,g,u,T.Width),this.DrawHScreenText({X:I,Y:g},{Text:T.Text,Color:t.TextColor,XOffset:1*h,YOffset:2*h}),0==p&&this.DrawLine(g+T.Width,r,I,t.LineColor,t.LineType,t),I-=u+1*h}else{g=I-u/2-1*h;if(0==p){var F=a-T.Width;x=a}else F=a-d,x=a-(d-T.Width);this.Canvas.fillStyle=t.LineColor,this.Canvas.fillRect(F,g,T.Width,u),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(T.Text,x-1*h,I),0==p&&this.DrawLine(a,i,I,t.LineColor,t.LineType,t),I+=u+1*h}}}else if(t.Message[1])if(s<10||1==D){null!=t.Font&&(this.Canvas.font=t.Font),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle";c=this.GetCustomItemTextInfo(t,!1,h),d=c.MaxWidth,m=this.GetFontHeight();u=m>l?m:l;v=t.LineColor,S=this.RGBToStruct(t.LineColor);S&&(v="rgba("+S.R+", "+S.G+", "+S.B+", "+Oi.FrameLatestPrice.BGAlpha+")");for(I=C,p=0;p<c.Text.length;++p){T=c.Text[p];if(this.IsHScreen){g=r-T.Width,x=I-u/2-1*h;this.Canvas.fillStyle=v,this.Canvas.fillRect(x,g,u,d),this.DrawHScreenText({X:I,Y:g},{Text:T.Text,Color:t.TextColor,XOffset:1*h,YOffset:2*h}),0==p&&this.DrawLine(n,g,I,t.LineColor,t.LineType,t),I-=u+1*h}else if(1===T.Type){if(this.GetEventCallback){g=I-u/2-1*h;var y={Top:g,Right:i,Height:null,IsShow:!0,BGColor:t.LineColor,TextColor:t.TextColor,PixelTatio:h,Position:"Right",IsInside:!0};this.SendDrawCountDownEvent(y)&&ha.IsPlusNumber(y.Height)&&(I+=u+1*h)}}else{g=I-u/2-1*h,x=i-T.Width;this.Canvas.fillStyle=v,this.Canvas.fillRect(x,g,d,u),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(T.Text,x+1*h,I),0==p&&this.DrawLine(a,x,I,t.LineColor,t.LineType,t),I+=u+1*h}}if((3==t.Type||4==t.Type)&&t.Title){var L=this.Canvas.measureText(t.Title).width+2*h;if(this.IsHScreen){g=r-T.Width-L,x=C-u/2-1*h;this.Canvas.fillStyle=v,this.Canvas.fillRect(x,g,u,L),this.DrawHScreenText({X:C,Y:g},{Text:t.Title,Color:t.TextColor,XOffset:1*h,YOffset:2*h})}else{g=C-u/2-1*h,x=i-d-L-1*h;this.Canvas.fillStyle=v,this.Canvas.fillRect(x,g,L,u),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(t.Title,x+1*h,C)}}}else{null!=t.Font&&(this.Canvas.font=t.Font),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle";c=this.GetCustomItemTextInfo(t,!1,h),d=c.MaxWidth,m=this.GetFontHeight();u=m>l?m:l;for(I=C,p=0;p<c.Text.length;++p){T=c.Text[p];if(this.IsHScreen){g=r,x=I-u/2-1*h;this.Canvas.fillStyle=t.LineColor,this.Canvas.fillRect(x,g,u,T.Width),this.DrawHScreenText({X:I,Y:g},{Text:T.Text,Color:t.TextColor,XOffset:1*h,YOffset:2*h}),0==p&&this.DrawLine(n,g,I,t.LineColor,t.LineType,t),I-=u+1*h}else if(1===T.Type){if(this.GetEventCallback){g=I-u/2-1*h,y={Top:g,Left:i,Right:this.ChartBorder.GetChartWidth(),Height:null,IsShow:!0,BGColor:t.LineColor,TextColor:t.TextColor,PixelTatio:h,Position:"Right",IsInside:!1};this.SendDrawCountDownEvent(y)&&ha.IsPlusNumber(y.Height)&&(I+=u+1*h)}}else{g=I-u/2-1*h;if(0==p)x=i;else x=i+d-T.Width;this.Canvas.fillStyle=t.LineColor,this.Canvas.fillRect(x,g,T.Width,u),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(T.Text,x+1*h,I),0==p&&this.DrawLine(a,i,I,t.LineColor,t.LineType,t),I+=u+1*h}}if((3==t.Type||4==t.Type)&&t.Title){v=t.LineColor,S=this.RGBToStruct(t.LineColor);S&&(v="rgba("+S.R+", "+S.G+", "+S.B+", "+Oi.FrameLatestPrice.BGAlpha+")");L=this.Canvas.measureText(t.Title).width+2*h;if(this.IsHScreen){g=r-L,x=C-u/2-1*h;this.Canvas.fillStyle=v,this.Canvas.fillRect(x,g,u,L),this.DrawHScreenText({X:C,Y:g},{Text:t.Title,Color:t.TextColor,XOffset:1*h,YOffset:2*h})}else{g=C-u/2-1*h,x=i-L-1*h;this.Canvas.fillStyle=v,this.Canvas.fillRect(x,g,L,u),this.Canvas.fillStyle=t.TextColor,this.Canvas.fillText(t.Title,x+1*h,C)}}}}},this.SendDrawCountDownEvent=function(t){if(!this.GetEventCallback)return!1;var e=this.GetEventCallback(G.ON_DRAW_COUNTDOWN);return!(!e||!e.Callback)&&(e.Callback(e,t,this),!0)},this.DrawDotLine=function(t,e,a,i,r){var n=U();this.Canvas.save(),this.Canvas.strokeStyle=i,r&&ha.IsPlusNumber(r.LineWidth)&&(this.Canvas.lineWidth=r.LineWidth*n),r.LineDash?this.Canvas.setLineDash(r.LineDash):this.Canvas.setLineDash([5*n,5*n]),this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(Q(a),t),this.Canvas.lineTo(Q(a),e)):(this.Canvas.moveTo(t,Q(a)),this.Canvas.lineTo(e,Q(a))),this.Canvas.stroke(),this.Canvas.restore()},this.DrawLine=function(t,e,a,i,r,n){if(-1!=r)if(0==r){var s=U();this.Canvas.strokeStyle=i;var o=!1;n&&ha.IsPlusNumber(n.LineWidth)&&(this.Canvas.lineWidth=n.LineWidth*s,o=!0),this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(Q(a),t),this.Canvas.lineTo(Q(a),e)):(this.Canvas.moveTo(t,Q(a)),this.Canvas.lineTo(e,Q(a))),this.Canvas.stroke(),o&&(this.Canvas.lineWidth=s)}else this.DrawDotLine(t,e,a,i,n)},this.DrawHScreenText=function(t,e){this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=e.Color,this.Canvas.save(),this.Canvas.translate(t.X,t.Y),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(e.Text,e.XOffset,e.YOffset),this.Canvas.restore()},this.RGBToStruct=function(t){if(/^(rgb|RGB)/.test(t)){var e=t.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),a={};return 3!=e.length?null:(a.R=Number(e[0]),a.G=Number(e[1]),a.B=Number(e[2]),a)}return null},this.GetScaleTextWidth=function(){this.ChartBorder.GetBorder();var t=U();if(this.IsHScreen)var e=this.ChartBorder.Top,a=this.ChartBorder.Bottom,i=e>10*t&&!0===this.IsShowYText[0]&&2!=this.YTextPosition[0],r=a>10*t&&!0===this.IsShowYText[1]&&2!=this.YTextPosition[1];else{var n=this.ChartBorder.Right,s=this.ChartBorder.Left;i=s>10&&!0===this.IsShowYText[0]&&2!=this.YTextPosition[0],r=n>10&&!0===this.IsShowYText[1]&&2!=this.YTextPosition[1]}if(!r&&!i)return null;var o={Left:null,Right:null},h=0,l=!1;this.YSplitOperator&&1==this.YSplitOperator.CoordinateType&&(l=!0);for(var u=0;u<this.HorizontalInfo.length;++u){var C=null,D=this.HorizontalInfo[u];if(D&&(null!=D.Font&&(this.Canvas.font=D.Font),null!=D.Message[0]&&i&&(C=this.Canvas.measureText(D.Message[0]).width,(null==o.Left||o.Left<C)&&(o.Left=C)),null!=D.Message[1]&&r)){if(null!=D.Font&&(this.Canvas.font=D.Font),Array.isArray(D.Message[1])){if(1==this.MultiTextFormat){if(D.ExtendData){D.ExtendData.Font&&(this.Canvas.font=D.ExtendData.Font);var f=this.Canvas.measureText(D.Message[1][0]).width,c=this.Canvas.measureText(D.Message[1][1]).width,d=this.Canvas.measureText("/").width;C=f+d,h<c&&(h=c)}}else if(2==this.MultiTextFormat){C=this.Canvas.measureText(D.Message[1][0]).width;var m=this.Canvas.measureText(D.Message[1][1]).width;C<m&&(C=m)}else if(C=this.Canvas.measureText(D.Message[1][0]).width,l){var v=this.Canvas.measureText("-00.00%").width;v>C&&(C=v)}}else C=this.Canvas.measureText(D.Message[1]).width;(null==o.Right||o.Right<C)&&(o.Right=C)}}return ha.IsNumber(o.Right)&&(o.Right+=h),ha.IsNumber(o.Left)&&(o.Left+=this.YTextPadding[0]),ha.IsNumber(o.Right)&&(o.Right+=this.YTextPadding[1]),{TextWidth:o}},this.ClearToolbar=function(){if(this.ToolbarID){var t=document.getElementById(this.ToolbarID);t&&(this.ChartBorder.UIElement.parentNode.removeChild(t),this.ToolbarRect=null)}},this.HideToolbar=function(){if(this.ToolbarID){this.ToolbarRect=null;var t=document.getElementById(this.ToolbarID);t&&"none"!=t.style.display&&(t.style.display="none")}}}function lt(){this.newMethod=ht,this.newMethod(),delete this.newMethod,this.ClassName="MinuteFrame",this.DataWidth=1*U(),this.DistanceWidth=1*U(),this.MinuteCount=243,this.BeforeBGColor=Oi.Minute.Before.BGColor,this.AfterBGColor=Oi.Minute.After.BGColor,this.MultiDayBorderPen=Oi.MultiDayBorderPen,this.CustomHorizontalInfo=[],this.RightFrame=null,this.ToolbarID=q(),this.ReDrawToolbar=!1,this.DayCount=1,this.ModifyIndex=!0,this.ChangeIndex=!0,this.CloseIndex=!0,this.ModifyIndexEvent,this.ChangeIndexEvent,this.ToolbarRect=null,this.IsShowPositionTitle=!1,this.LastCalculateStatus={Width:0,XPointCount:0},this.BeforeCloseIcon=et(Oi.Minute.Before.CloseIcon),this.BeforeOpenVerticalInfo=[],this.AfterCloseVerticalInfo=[],this.DrawFrame=function(){this.IsMinSize||(this.SplitXYCoordinate(),this.DrawBeforeDataBG(),this.YInsideOffset=0,this.DrawTitleBG(),this.DrawHorizontal(),this.DrawVertical()),1!=this.SizeChange&&1!=this.ReDrawToolbar||(this.DrawToolbar(),this.ReDrawToolbar=!1)},this.SuperDrawBorder=this.DrawBorder,this.DrawBorder=function(){if(this.IsShowBorder&&!this.IsMinSize&&(this.SuperDrawBorder(),1==this.Identify)){var t=this.ChartBorder.GetBorder(),e=Q(t.Left),a=Q(t.Top),i=Q(t.Right);this.Canvas.strokeStyle=this.PenBorder,this.Canvas.beginPath(),this.Canvas.moveTo(e,a),this.Canvas.lineTo(i,a),this.Canvas.save(),this.Canvas.lineWidth=2*U(),this.Canvas.stroke(),this.Canvas.restore()}},this.DrawVolTitle=function(t){if(Br.IsShowMinuteVolTitle(t)&&1==this.Identify){var e=U(),a=this.ChartBorder.GetLeft()+2*e+this.YInsideOffset,i=this.ChartBorder.GetTopEx()+2*e;if(this.Canvas.textAlign="left",this.Canvas.textBaseline="top",Oi.Minute.VolBarColor||Oi.Minute.VolTitleColor){Oi.Minute.VolBarColor?this.Canvas.fillStyle=Oi.Minute.VolBarColor:this.Canvas.fillStyle=Oi.Minute.VolTitleColor;var r=this.YSplitOperator.LanguageID,n=bi.GetText("MVol-Vol",r);this.Canvas.fillText(n,a,i),a+=this.Canvas.measureText(n).width,a+=6*U()}this.IsShowPositionTitle&&(n=bi.GetText("MVol-Position",r),this.Canvas.fillStyle=Oi.Minute.PositionColor,this.Canvas.fillText(n,a,i))}},this.DrawToolbar=function(){if(1!=this.ToolbarButtonStyle&&"undefined"!=typeof A.default&&!(this.Identify<2)&&this.ChartBorder.UIElement){var t=document.getElementById(this.ToolbarID);if(!t||0!=this.SizeChange||0!=this.ReDrawToolbar)if(t||(t=document.createElement("div"),t.className="klineframe-toolbar",t.id=this.ToolbarID,t.oncontextmenu=function(){return!1},t.setAttribute("identify",this.Identify.toString()),this.ChartBorder.UIElement.parentNode.appendChild(t)),this.ModifyIndex||this.ChangeIndex||this.OverlayIndex||this.CloseIndex){var e=U(),a=parseInt(this.ChartBorder.UIElement.parentElement.style.width.replace("px","")),i=(parseInt(this.ChartBorder.UIElement.parentElement.style.height.replace("px","")),100),r=this.ChartBorder.GetTitleHeight(),n=a-this.ChartBorder.Right/e-i,s=this.ChartBorder.GetTop()/e;if(!this.ToolbarRect||this.ToolbarRect.Left!=n||this.ToolbarRect.Top!=s||this.ToolbarRect.Width!=i||this.ToolbarRect.Height!=r/e){this.ToolbarRect={Left:n,Top:s,Width:i,Height:r/e};var o="<span class='index_param icon iconfont icon-index_param' id='modifyindex' style='cursor:pointer;margin-left:2px;margin-right:2px;' title='è°æ´ææ åæ°'></span>",h="<span class='index_change icon iconfont icon-change_index' id='changeindex' style='cursor:pointer;margin-left:2px;margin-right:2px;' title='åæ¢ææ '></span>",l="<span class='index_close icon iconfont icon-close' id='closeindex' style='cursor:pointer;margin-left:2px;margin-right:2px;' title='å³é­ææ çªå£'></span>",u=o+h;this.CloseIndex&&(u+=l),t.style.left=n+"px",t.style.top=s+"px",t.style.width=i+"px",t.style.height=r/e+"px",t.innerHTML=u;this.ChartBorder.UIElement.JSChartContainer,this.Identify;this.ModifyIndex?"function"==typeof this.ModifyIndexEvent&&(0,A.default)("#"+t.id+" .index_param").click({Chart:this.ChartBorder.UIElement.JSChartContainer,Identify:this.Identify},this.ModifyIndexEvent):(0,A.default)("#"+t.id+" .index_param").hide(),this.ChangeIndex?"function"==typeof this.ChangeIndexEvent&&(0,A.default)("#"+t.id+" .index_change").click({Chart:this.ChartBorder.UIElement.JSChartContainer,Identify:this.Identify,IsOverlay:!1},this.ChangeIndexEvent):(0,A.default)("#"+t.id+" .index_change").hide(),(0,A.default)("#"+t.id+" .index_close").click({Chart:this.ChartBorder.UIElement.JSChartContainer,Identify:this.Identify},(function(t){var e=t.data.Chart,a=t.data.Identify;e.RemoveIndexWindow(a)})),t.style.display="block"}}else"none"!=t.style.display&&(t.style.display="none")}},this.DrawToolbarV2=function(t){if(0==this.Identify&&this.DrawCloseBeforeButton(t),!(this.ChartBorder.TitleHeight<5)&&0!=this.Identify&&1!=this.Identify){var e=[];if(this.CloseIndex&&e.push({ID:k.CLOSE_INDEX_WINDOW,Style:this.CloseWindowButton}),this.OverlayIndex&&e.push({ID:k.OVERLAY_INDEX,Style:this.OverlayIndexButton}),this.ChangeIndex&&e.push({ID:k.CHANGE_INDEX,Style:this.ChangeIndexButton}),this.ModifyIndex&&e.push({ID:k.MODIFY_INDEX_PARAM,Style:this.ModifyIndexParamButton}),ha.IsNonEmptyArray(this.CustomToolbar))for(var a=0;a<this.CustomToolbar.length;++a){var i=this.CustomToolbar[a];i.ID&&i.Style&&e.push({ID:i.ID,Style:i.Style})}this.DrawTitleButton(e,t)}},this.DrawCloseBeforeButton=function(t){if(0==this.Identify){var e=this.ChartBorder.GetBorder();if(!e.DayBorder&&!(this.ChartBorder.LeftExtendWidth<10)){var a={Left:e.Left,Top:e.TopEx,Width:this.BeforeCloseIcon.Size,Height:this.BeforeCloseIcon.Size};a.Right=a.Left+this.BeforeCloseIcon.Size,a.Bottom=a.Top+this.BeforeCloseIcon.Size;var i=this.BeforeCloseIcon.Color;t&&t.X>=a.Left&&t.X<a.Right&&t.Y>=a.Top&&t.Y<=a.Bottom&&(i=this.BeforeCloseIcon.MoveOnColor);var r=this.BeforeCloseIcon.Size+"px "+this.BeforeCloseIcon.Family;this.Canvas.font=r,this.Canvas.fillStyle=i,this.Canvas.textAlign="left",this.Canvas.textBaseline="top",this.Canvas.fillText(this.BeforeCloseIcon.Text,e.Left,e.TopEx),this.Buttons.push({Rect:a,Name:"éåç«ä»·å³é­æé®",ID:k.CLOSE_BEFOREOPEN_ID})}}},this.DrawMultiDayBeforeDataBG=function(t){var e=t.DayBorder,a=Q(t.Top),i=Q(t.Bottom),r=i-a;this.Canvas.strokeStyle=this.MultiDayBorderPen;for(var n=0;n<e.length;++n){var s=0,o=e[n],h=Q(o.Left),l=Q(o.LeftEx),u=l-h;u>3&&(this.Canvas.fillStyle=this.BeforeBGColor,this.Canvas.fillRect(h,a,u,r),++s);h=Q(o.RightEx),l=Q(o.Right),u=l-h;u>3&&(this.Canvas.fillStyle=this.AfterBGColor,this.Canvas.fillRect(h,a,u,r),++s),2==s&&n!=e.length-1&&(this.Canvas.beginPath(),this.Canvas.moveTo(l,a),this.Canvas.lineTo(l,i),this.Canvas.stroke())}},this.DrawCallAuctionVertical=function(t,e,a,i){if(e){var r=a.TopTitle,n=a.Bottom,s=(a.Left,a.LeftEx),o=U(),h=null,l=null;for(var u in t){var C=t[u],D=this.GetLeftExtendXFromIndex(C.Value,e);if(D>s)break;if(!(null!=h&&Math.abs(D-h)<this.MinXDistance)){var f=Q(D);if(this.IsShowXLine&&(2==C.LineType?(this.Canvas.strokeStyle=C.LineColor,this.Canvas.setLineDash([5*o,5*o]),this.Canvas.beginPath(),this.Canvas.moveTo(f,r),this.Canvas.lineTo(f,n),this.Canvas.stroke(),this.Canvas.setLineDash([])):3==C.LineType||C.LineType>0&&(Oi.FrameXLineDash?(this.Canvas.strokeStyle=C.LineColor,this.Canvas.setLineDash(Oi.FrameXLineDash),this.Canvas.beginPath(),this.Canvas.moveTo(f,r),this.Canvas.lineTo(f,n),this.Canvas.stroke(),this.Canvas.setLineDash([])):(this.Canvas.strokeStyle=C.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(f,r),this.Canvas.lineTo(f,n),this.Canvas.stroke()))),null!=C.Message[0]&&this.ChartBorder.Bottom>5*o){null!=C.Font&&(this.Canvas.font=C.Font);var c=0;this.Canvas.fillStyle=C.TextColor,this.Canvas.strokeStyle=C.TextColor;var d=this.Canvas.measureText(C.Message[0]).width;if(D<d/2?(this.Canvas.textAlign="left",this.Canvas.textBaseline="top",c=D):D+d/2>=a.ChartWidth?(this.Canvas.textAlign="right",this.Canvas.textBaseline="top",c=D-d):(this.Canvas.textAlign="center",this.Canvas.textBaseline="top",c=D-d/2),null==l||c>l){var m=n;if(3==C.LineType){var v=this.ShortXLineLength*o;this.Canvas.beginPath(),this.Canvas.moveTo(f,m),this.Canvas.lineTo(f,m+v),this.Canvas.stroke(),m+=v+2*o}this.Canvas.fillText(C.Message[0],D,m+this.XBottomOffset),l=c+d}}h=D}}}},this.DrawBeforeDataBG=function(){var t=this.ChartBorder.GetBorder();if(t.DayBorder)this.DrawMultiDayBeforeDataBG(t);else if(!(this.ChartBorder.LeftExtendWidth<10&&this.ChartBorder.RightExtendWidth<10)){var e=Q(t.Top),a=Q(t.Bottom);if(this.Canvas.fillStyle=this.BeforeBGColor,this.ChartBorder.LeftExtendWidth>10){var i=Q(t.Left),r=Q(this.ChartBorder.GetLeft()),n=r-i,s=a-e;this.Canvas.fillRect(i,e,n,s),this.DrawCallAuctionVertical(this.BeforeOpenVerticalInfo,this.YSplitOperator.BeforeOpenData,t,!0)}if(this.ChartBorder.RightExtendWidth>10){this.Canvas.fillStyle=this.AfterBGColor;i=Q(this.ChartBorder.GetRight()),r=Q(t.Right),n=r-i,s=a-e;this.Canvas.fillRect(i,e,n,s)}}},this.DrawPictureXCoordinate=function(t,e,a){if(!this.IsHScreen&&e&&ha.IsNonEmptyArray(e.Points)){var i=this.GetBorder(),r=i.Left,n=i.Right;this.Canvas.font=this.DrawPicture.Font;var s=this.GetFontHeight();if(e.X){var o=e.X,h=o.Min.X,l=o.Max.X;h<r&&(h=r),l>n&&(l=n),this.Canvas.fillStyle=this.DrawPicture.BGColor,this.Canvas.fillRect(h,i.Bottom,l-h,s)}for(var u=0;u<e.Points.length;++u){var C=e.Points[u];if(!(C.X<r||C.X>n)){var D=parseInt(this.GetXData(C.X)),f=this.GetKItem(D,a);if(f){var c=ha.FormatTimeString(f.Time,"HH:MM"),d=this.Canvas.measureText(c).width+2,m=C.X-d/2;m<r&&(m=r),this.Canvas.fillStyle=this.DrawPicture.TextBGColor,this.Canvas.fillRect(m,i.Bottom,d,s),this.Canvas.fillStyle=this.DrawPicture.TextColor;var v=i.Bottom+s;this.Canvas.fillText(c,m+1,v)}}}}},this.GetKItem=function(t,e){if(!this.Data)return null;if(!ha.IsNonEmptyArray(this.Data.Data))return null;if(t<this.Data.Data.length)return this.Data.Data[t];var a=this.Data.Data[this.Data.Data.length-1],i=Jr.GetTimeData(e.Symbol),r=t%i.length,n=i[r];return{Date:a.Date,Time:n}},this.SplitXYCoordinate=function(){0!=this.XYSplit&&(null!=this.XSplitOperator&&this.XSplitOperator.Operator(),null!=this.YSplitOperator&&this.YSplitOperator.Operator())},this.GetMultiDayXFromIndex=function(t,e){var a=e.DayBorder,i=t%this.MinuteCount,r=parseInt(t/this.MinuteCount);r>=a.length&&(r=a.length-1);var n=a[r],s=this.MinuteCount-1;if(i>=s)return n.RightEx;var o=n.RightEx-n.LeftEx,h=n.LeftEx+o*i/s;return h},this.GetXFromIndex=function(t){var e=this.XPointCount-1,a=this.ChartBorder.GetBorder();if(a.DayBorder)return this.GetMultiDayXFromIndex(t,a);if(1==e)return 0==t?a.LeftEx:a.RightEx;if(e<=0)return a.LeftEx;if(t>=e)return a.RightEx;var i=a.RightEx-a.LeftEx,r=a.LeftEx+i*t/e;return r},this.GetMultiDayXData=function(t,e){for(var a=e.DayBorder,i=0;i<a.length;++i){var r=a[i];if(t>=r.Left&&t<=r.Right){var n=this.MinuteCount-1,s=this.MinuteCount*i;if(t<=r.LeftEx)return 0+s;if(t>=r.RightEx)return n+s;var o=r.RightEx-r.LeftEx;return(t-r.LeftEx)*(1*n/o)+s}}},this.GetXData=function(t){var e=this.XPointCount-1;e<0&&(e=0);var a=this.ChartBorder.GetBorder();if(a.DayBorder)return this.GetMultiDayXData(t,a);if(t<=a.LeftEx)return 0;if(t>=a.RightEx)return e;var i=a.RightEx-a.LeftEx;return(t-a.LeftEx)*(1*e/i)},this.DrawCustomHorizontal=function(){if(!this.IsMinSize)for(var t in this.CustomHorizontalInfo){var e=this.CustomHorizontalInfo[t];switch(e.Type){case 0:case 1:this.DrawCustomItem(e);break}}},this.GetLeftExtendXFromIndex=function(t,e){var a=e.TotalCount-1,i=this.ChartBorder.GetBorder();if(i.DayBorder)return this.GetLeftExtendMultiDayXFromIndex(t,e,i);var r=i.Left,n=this.ChartBorder.LeftExtendWidth,s=r+n*t/a;return s},this.GetLeftExtendMultiDayXFromIndex=function(t,e,a){var i=a.DayBorder,r=i[e.Index],n=e.TotalCount-1,s=r.Left,o=r.LeftEx,h=o-s,l=s+h*t/n;return l},this.GetLeftExtendMultiDayXData=function(t,e,a){for(var i=a.DayBorder,r=0;r<i.length;++r){var n=i[r];if(t>=n.Left&&t<=n.LeftEx){if(!e[r])return null;var s=e[r].TotalCount-1,o=n.Left,h=n.LeftEx,l=h-o,u=1*s/l*(t-o);return{DayIndex:parseInt(r),DataIndex:u}}}},this.GetLeftExtendXData=function(t,e){var a=this.ChartBorder.GetBorder();if(a.DayBorder)return this.GetLeftExtendMultiDayXData(t,e,a);var i=e.TotalCount-1;i<0&&(i=0);var r=a.Left,n=a.LeftEx;if(t<=r)return 0;if(t>=n)return i;var s=n-r;return 1*i/s*(t-r)},this.MoveXIndexLeft=function(t,e){if(w.Chart.Log("[MinuteFrame::MoveXIndexLeft] obj ",e),2==e.DataType){var a=e.IndexData.DayIndex,i=e.IndexData.DataIndex-t,r=-1;if(20==e.IndexData.Type)r=0;else if(10==e.IndexData.Type)r=1;else{if(30!=e.IndexData.Type)return!1;r=2}for(var n=a,s=r;n>=0;--n){for(var o=e.Data[n];s>=0;--s){var h=o[s];if(h.DayItem&&h.DayItem.Data){for(null==i&&(i=h.DayItem.Data.length-1);i>=0;--i){var l=h.DayItem.Data[i];if(l){if(10==h.Type){var u=this.MinuteCount*n+i;return e.Point.X=this.GetXFromIndex(u),e.Point.Y=this.GetYFromData(l.Close),e.IndexData.CursorIndex=u,e.IndexData.DayIndex=n,e.IndexData.DataIndex=i,e.IndexData.Type=h.Type,!0}if(20==h.Type){if(!ha.IsNumber(l.Price))continue;return e.Point.X=this.GetLeftExtendXFromIndex(i,h.DayItem),e.Point.Y=this.GetLeftExtendYFromData(l.Price),e.IndexData.CursorIndex=-1,e.IndexData.DayIndex=n,e.IndexData.DataIndex=i,e.IndexData.Type=h.Type,!0}if(30==h.Type){if(!ha.IsNumber(l.Price))continue;return e.Point.X=this.GetRightExtendXFromIndex(i,h.DayItem),e.Point.Y=this.GetRightExtendYFromData(l.Price),e.IndexData.CursorIndex=-1,e.IndexData.DayIndex=n,e.IndexData.DataIndex=i,e.IndexData.Type=h.Type,!0}}}i=null}}s=2}return!1}if(1==e.DataType){a=e.IndexData.DayIndex,i=e.IndexData.DataIndex-t,r=-1;if(2==e.IndexData.Type)r=0;else if(1==e.IndexData.Type)r=1;else{if(3!=e.IndexData.Type)return!1;r=2}for(n=r;n>=0;--n){h=e.Data[n];if(h&&h.DayItem&&h.DayItem.Data){for(null==i&&(i=h.DayItem.Data.length-1);i>=0;--i){l=h.DayItem.Data[i];if(l){if(1==h.Type){u=i;return e.Point.X=this.GetXFromIndex(u),e.Point.Y=this.GetYFromData(l.Close),e.IndexData.CursorIndex=u,e.IndexData.DayIndex=0,e.IndexData.DataIndex=i,e.IndexData.Type=h.Type,!0}if(2==h.Type){if(!ha.IsNumber(l.Price))continue;return e.Point.X=this.GetLeftExtendXFromIndex(i,h.DayItem),e.Point.Y=this.GetLeftExtendYFromData(l.Price),e.IndexData.CursorIndex=-1,e.IndexData.DayIndex=0,e.IndexData.DataIndex=i,e.IndexData.Type=h.Type,!0}if(3==h.Type){if(!ha.IsNumber(l.Price))continue;return e.Point.X=this.GetRightExtendXFromIndex(i,h.DayItem),e.Point.Y=this.GetRightExtendYFromData(l.Price),e.IndexData.CursorIndex=-1,e.IndexData.DayIndex=0,e.IndexData.DataIndex=i,e.IndexData.Type=h.Type,!0}}}i=null}}}},this.MoveXIndexRight=function(t,e){if(w.Chart.Log("[MinuteFrame::MoveXIndexRight] obj ",e),2==e.DataType){var a=e.IndexData.DayIndex,i=e.IndexData.DataIndex+t,r=-1;if(20==e.IndexData.Type)r=0;else if(10==e.IndexData.Type)r=1;else{if(30!=e.IndexData.Type)return!1;r=2}for(var n=a,s=r;n<e.Data.length;++n){for(var o=e.Data[n];s<3;++s){var h=o[s];if(h.DayItem&&h.DayItem.Data){for(null==i&&(i=0);i<h.DayItem.Data.length;++i){var l=h.DayItem.Data[i];if(l){if(10==h.Type){var u=this.MinuteCount*n+i;return e.Point.X=this.GetXFromIndex(u),e.Point.Y=this.GetYFromData(l.Close),e.IndexData.CursorIndex=u,e.IndexData.DayIndex=n,e.IndexData.DataIndex=i,e.IndexData.Type=h.Type,!0}if(20==h.Type){if(!ha.IsNumber(l.Price))continue;return e.Point.X=this.GetLeftExtendXFromIndex(i,h.DayItem),e.Point.Y=this.GetLeftExtendYFromData(l.Price),e.IndexData.CursorIndex=-1,e.IndexData.DayIndex=n,e.IndexData.DataIndex=i,e.IndexData.Type=h.Type,!0}if(30==h.Type){if(!ha.IsNumber(l.Price))continue;return e.Point.X=this.GetRightExtendXFromIndex(i,h.DayItem),e.Point.Y=this.GetRightExtendYFromData(l.Price),e.IndexData.CursorIndex=-1,e.IndexData.DayIndex=n,e.IndexData.DataIndex=i,e.IndexData.Type=h.Type,!0}}}i=null}}s=0}return!1}if(1==e.DataType){a=e.IndexData.DayIndex,i=e.IndexData.DataIndex+t,r=-1;if(2==e.IndexData.Type)r=0;else if(1==e.IndexData.Type)r=1;else{if(3!=e.IndexData.Type)return!1;r=2}for(n=r;n<e.Data.length;++n){h=e.Data[n];if(h.DayItem&&h.DayItem.Data){for(null==i&&(i=0);i<h.DayItem.Data.length;++i){l=h.DayItem.Data[i];if(l){if(1==h.Type){u=i;return e.Point.X=this.GetXFromIndex(u),e.Point.Y=this.GetYFromData(l.Close),e.IndexData.CursorIndex=u,e.IndexData.DayIndex=0,e.IndexData.DataIndex=i,e.IndexData.Type=h.Type,!0}if(2==h.Type){if(!ha.IsNumber(l.Price))continue;return e.Point.X=this.GetLeftExtendXFromIndex(i,h.DayItem),e.Point.Y=this.GetLeftExtendYFromData(l.Price),e.IndexData.CursorIndex=-1,e.IndexData.DayIndex=0,e.IndexData.DataIndex=i,e.IndexData.Type=h.Type,!0}if(3==h.Type){if(!ha.IsNumber(l.Price))continue;return e.Point.X=this.GetRightExtendXFromIndex(i,h.DayItem),e.Point.Y=this.GetRightExtendYFromData(l.Price),e.IndexData.CursorIndex=-1,e.IndexData.DayIndex=0,e.IndexData.DataIndex=i,e.IndexData.Type=h.Type,!0}}}i=null}}}},this.GetLeftExtendXValidData=function(t,e){var a=this.ChartBorder.GetBorder();if(a.DayBorder){var i=this.GetLeftExtendXData(t,e.Data);if(!i)return!1;var r=parseInt(i.DataIndex.toFixed(0)),n=e.Data[i.DayIndex];if(r>=0&&r<n.Data.length){var s=n.Data[r];if(ha.IsNumber(s.Price))return e.IndexData.DataIndex=r,!0}r<0?r=0:r>=n.Data.length&&(r=n.Data.length-1);for(var o=-1,h=r;h>=0;--h){s=n.Data[h];if(ha.IsNumber(s.Price)){o=h;break}}return!(o<0)&&(e.IndexData.DataIndex=o,e.IndexData.Point.X=this.GetLeftExtendXFromIndex(o,n),w.Chart.Log("[MinuteFrame::GetLeftExtendXValidData] DayIndex:"+e.IndexData.DayIndex+", Type:"+e.IndexData.Type+", x:"+t+"=>"+e.IndexData.Point.X+", index:"+r+"=>"+o),!0)}r=this.GetLeftExtendXData(t,e.Data);if(r=parseInt(r.toFixed(0)),r>=0&&r<e.Data.Data.length){s=e.Data.Data[r];if(ha.IsNumber(s.Price))return e.IndexData.DataIndex=r,!0}r<0?r=0:r>=e.Data.Data.length&&(r=e.Data.Data.length-1);for(o=-1,h=r;h>=0;--h){s=e.Data.Data[h];if(ha.IsNumber(s.Price)){o=h;break}}if(o<0)for(h=r+1;h<e.Data.Data.length;++h){s=e.Data.Data[h];if(ha.IsNumber(s.Price)){o=h;break}}return!(o<0)&&(e.IndexData.DataIndex=o,e.IndexData.Point.X=this.GetLeftExtendXFromIndex(o,e.Data),w.Chart.Log("[MinuteFrame::GetLeftExtendXValidData] DayIndex:"+e.IndexData.DayIndex+", Type:"+e.IndexData.Type+", x:"+t+"=>"+e.IndexData.Point.X+", index:"+r+"=>"+o),!0)},this.GetRightExtendXValidData=function(t,e){},this.GetLeftExtendYFromData=function(t,e,a){if(!a||!a.Range)return this.GetYFromData(t,e);var i=a.Range,r=this.ChartBorder.GetBorder(),n=r.BottomEx-r.TopEx,s=n*(t-i.Min)/(i.Max-i.Min);return r.BottomEx-s},this.GetLeftExtendYData=function(t,e,a){if(!a||!a.Range)return this.GetYData(t,e);var i=a.Range,r=this.ChartBorder.GetBorder(),n=r.BottomEx-r.TopEx;return(r.BottomEx-t)/n*(i.Max-i.Min)+i.Min},this.GetRightExtendMultiDayXFromIndex=function(t,e,a){var i=a.DayBorder,r=i[e.Index],n=e.TotalCount-1,s=r.RightEx,o=r.Right,h=o-s,l=s+h*t/n;return l},this.GetRightExtendXFromIndex=function(t,e){var a=e.TotalCount-1,i=this.ChartBorder.GetBorder();if(i.DayBorder)return this.GetRightExtendMultiDayXFromIndex(t,e,i);var r=i.RightEx,n=this.ChartBorder.RightExtendWidth,s=r+n*t/a;return s},this.GetRightExtendYFromData=function(t,e,a){return this.GetLeftExtendYFromData(t,e,a)},this.GetRightExtendYData=function(t,e,a){return a&&a.Range?this.GetLeftExtendYData(t,e,a):this.GetYData(t,e)},this.GetRightExtendMultiDayXData=function(t,e,a){for(var i=a.DayBorder,r=0;r<i.length;++r){var n=i[r];if(t>=n.RightEx&&t<=n.Right){if(!e[r])return null;var s=e[r].TotalCount-1,o=n.RightEx,h=n.Right,l=h-o,u=1*s/l*(t-o);return{DayIndex:parseInt(r),DataIndex:u}}}},this.GetRightExtendXData=function(t,e){var a=this.ChartBorder.GetBorder();if(a.DayBorder)return this.GetRightExtendMultiDayXData(t,e,a);var i=e.TotalCount-1;i<0&&(i=0);var r=a.RightEx,n=a.Right;if(t<=r)return 0;if(t>=n)return i;var s=n-r;return 1*i/s*(t-r)}}function ut(){this.newMethod=lt,this.newMethod(),delete this.newMethod,this.ClassName="MinuteHScreenFrame",this.IsHScreen=!0,this.DrawTitleBG=function(){if(!(this.ChartBorder.TitleHeight<=0)){var t=this.ChartBorder.GetHScreenBorder(),e=Q(t.RightEx),a=Q(t.Top),i=Q(t.Bottom),r=this.ChartBorder.TitleHeight,n=i-a;this.Canvas.fillStyle=this.TitleBGColor,this.Canvas.fillRect(e,a,r,n)}},this.DrawToolbar=function(){},this.DrawBeforeDataBG=function(){if(!(this.ChartBorder.LeftExtendWidth<10&&this.ChartBorder.RightExtendWidth<10)){var t=this.ChartBorder.GetHScreenBorder(),e=Q(t.Left),a=Q(t.Right);if(this.Canvas.fillStyle=this.BeforeBGColor,this.ChartBorder.LeftExtendWidth>10){var i=Q(t.Top),r=Q(t.TopEx),n=a-e,s=r-i;this.Canvas.fillRect(e,i,n,s)}if(this.ChartBorder.RightExtendWidth>10){i=t.BottomEx,r=t.Bottom,n=a-e,s=r-i;this.Canvas.fillRect(e,i,n,s)}}},this.GetYData=function(t){var e=this.ChartBorder.GetHScreenBorder();if(t<e.LeftEx)return this.HorizontalMin;if(t>e.RightEx)return this.HorizontalMax;var a=e.RightEx-e.LeftEx;return(t-e.LeftEx)/a*(this.HorizontalMax-this.HorizontalMin)+this.HorizontalMin},this.GetXData=function(t){var e=this.ChartBorder.GetHScreenBorder(),a=this.XPointCount-1;if(a<0&&(a=0),t<=e.TopEx)return 0;if(t>=e.BottomEx)return a;var i=e.BottomEx-e.TopEx;return(t-e.TopEx)*(1*a/i)},this.GetXFromIndex=function(t){var e=this.XPointCount-1,a=this.ChartBorder.GetHScreenBorder();if(1==e)return 0==t?a.TopEx:a.BottomEx;if(e<=0)return a.TopEx;if(t>=e)return a.BottomEx;var i=a.BottomEx-a.TopEx,r=a.TopEx+i*t/e;return r},this.GetYFromData=function(t){var e=this.ChartBorder.GetHScreenBorder();if(t<=this.HorizontalMin)return e.LeftEx;if(t>=this.HorizontalMax)return e.RightEx;var a=(e.RightEx-e.LeftEx)*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return e.LeftEx+a},this.DrawVolTitle=function(t){if(Br.IsShowMinuteVolTitle(t)&&1==this.Identify){var e=U(),a=this.ChartBorder.GetRight()-2*e,i=this.ChartBorder.GetTopEx()+2*e,r=a,n=i;this.Canvas.save(),this.Canvas.translate(r,n),this.Canvas.rotate(90*Math.PI/180);var s=this.YInsideOffset,o=0;if(this.Canvas.textAlign="left",this.Canvas.textBaseline="top",Oi.Minute.VolBarColor||Oi.Minute.VolTitleColor){Oi.Minute.VolBarColor?this.Canvas.fillStyle=Oi.Minute.VolBarColor:this.Canvas.fillStyle=Oi.Minute.VolTitleColor;var h=this.YSplitOperator.LanguageID,l=bi.GetText("MVol-Vol",h);this.Canvas.fillText(l,s,o),s+=this.Canvas.measureText(l).width,s+=6*U()}this.IsShowPositionTitle&&(l=bi.GetText("MVol-Position",h),this.Canvas.fillStyle=Oi.Minute.PositionColor,this.Canvas.fillText(l,s,o)),this.Canvas.restore()}},this.DrawHorizontal=function(){for(var t=this.ChartBorder.GetHScreenBorder(),e=t.Top,a=t.Bottom,i=t.Left,r=t.Right,n=this.ChartBorder.Top,s=this.ChartBorder.Bottom,o=null,h=this.HorizontalInfo.length-1;h>=0;--h){var l=this.HorizontalInfo[h],u=this.GetYFromData(l.Value);if(!(null!=u&&Math.abs(u-o)<this.MinYDistance)){if(this.Canvas.strokeStyle=l.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(Q(u),e),this.Canvas.lineTo(Q(u),a),this.Canvas.stroke(),u>=r-2)this.Canvas.textBaseline="top",u=r;else if(u<=i+2){if(this.Canvas.textBaseline="bottom",u=i,null!=u&&Math.abs(u-o)<2*this.MinYDistance)continue}else this.Canvas.textBaseline="middle";if(null!=l.Message[0]&&n>10){null!=l.Font&&(this.Canvas.font=l.Font),this.Canvas.fillStyle=l.TextColor,this.Canvas.textAlign="right";var C=u,D=e;this.Canvas.save(),this.Canvas.translate(C,D),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(l.Message[0],-2,0),this.Canvas.restore()}if(null!=l.Message[1]&&s>10){null!=l.Font&&(this.Canvas.font=l.Font),this.Canvas.fillStyle=l.TextColor,this.Canvas.textAlign="left";C=u,D=a;this.Canvas.save(),this.Canvas.translate(C,D),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(l.Message[1],2,0),this.Canvas.restore()}o=u}}},this.DrawInsideClientHorizontal=function(){for(var t=this.GetBorder(),e=t.Left,a=t.Right,i=t.BottomEx,r=t.TopEx,n=(U(),null),s=this.HorizontalInfo.length-1;s>=0;--s){var o=this.HorizontalInfo[s];if(o&&o.Message[2]&&o.Message[3]){var h=this.GetYFromData(o.Value);if(!(null!=h&&null!=n&&Math.abs(h-n)<this.MinYDistance)){if(h>=a-2)this.Canvas.textBaseline="top",h=a;else if(h<=e+2){if(this.Canvas.textBaseline="bottom",h=e,null!=h&&Math.abs(h-n)<2*this.MinYDistance)continue}else this.Canvas.textBaseline="middle";if(o.Message[2]){null!=o.Font&&(this.Canvas.font=o.Font),this.Canvas.fillStyle=o.TextColor,this.Canvas.textAlign="left";var l=h,u=r;this.Canvas.save(),this.Canvas.translate(l,u),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(o.Message[2],2,0),this.Canvas.restore()}if(o.Message[3]){null!=o.Font&&(this.Canvas.font=o.Font),this.Canvas.fillStyle=o.TextColor,this.Canvas.textAlign="right";l=h,u=i;this.Canvas.save(),this.Canvas.translate(l,u),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(o.Message[3],-2,0),this.Canvas.restore()}n=h}}}},this.DrawVertical=function(){var t=this.ChartBorder.GetHScreenBorder(),e=t.Left,a=t.Right,i=t.Bottom,r=null;for(var n in this.VerticalInfo){var s=this.GetXFromIndex(this.VerticalInfo[n].Value);if(s>i)break;if(!(null!=r&&Math.abs(s-r)<this.MinXDistance)){if(this.Canvas.strokeStyle=this.VerticalInfo[n].LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(e,Q(s)),this.Canvas.lineTo(a,Q(s)),this.Canvas.stroke(),null!=this.VerticalInfo[n].Message[0]){null!=this.VerticalInfo[n].Font&&(this.Canvas.font=this.VerticalInfo[n].Font),this.Canvas.fillStyle=this.VerticalInfo[n].TextColor;var o=this.Canvas.measureText(this.VerticalInfo[n].Message[0]).width;s<o/2?(this.Canvas.textAlign="left",this.Canvas.textBaseline="top"):s+o/2>=this.ChartBorder.GetChartHeight()?(this.Canvas.textAlign="right",this.Canvas.textBaseline="top"):(this.Canvas.textAlign="center",this.Canvas.textBaseline="top");var h=e,l=s;this.Canvas.save(),this.Canvas.translate(h,l),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(this.VerticalInfo[n].Message[0],0,0),this.Canvas.restore()}r=s}}},this.DrawInsideHorizontal=function(){if(!this.IsMinSize&&(!1!==this.IsShowYText[0]||!1!==this.IsShowYText[1])){this.DrawInsideClientHorizontal();var t=this.ChartBorder.GetHScreenBorder(),e=t.Left,a=t.RightEx,i=t.Top,r=t.Bottom,n=this.ChartBorder.Top,s=this.ChartBorder.Bottom,o=(this.ChartBorder.TitleHeight,U());if(n<10*o&&!0===this.IsShowYText[0]||s<10*o&&!0===this.IsShowYText[1]){o=U();for(var h=null,l=null,u=this.HorizontalInfo.length-1;u>=0;--u){var C=this.HorizontalInfo[u],D=this.GetYFromData(C.Value);if(!(null!=D&&null!=h&&Math.abs(D-h)<this.MinYDistance)){if(null!=C.Message[0]&&n<10*o&&!0===this.IsShowYText[0]){null!=C.Font&&(this.Canvas.font=C.Font),this.Canvas.fillStyle=C.TextColor,this.Canvas.textAlign="left",this.Canvas.textBaseline=D>=a-2?"top":D<=e+2?"bottom":"middle";this.Canvas.textBaseline,this.Canvas.textAlign,this.Canvas.font,C.Message[0];var f=D,c=i;this.Canvas.save(),this.Canvas.translate(f,c),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(C.Message[0],2*o,0),this.Canvas.restore(),(null==l||l<f)&&(this.YInsideOffset=this.Canvas.measureText(C.Message[0]).width+4*U(),l=f)}if(null!=C.Message[1]&&s<10*o&&!0===this.IsShowYText[1]){null!=C.Font&&(this.Canvas.font=C.Font),this.Canvas.fillStyle=C.TextColor,this.Canvas.textAlign="right",this.Canvas.textBaseline=D>=a-2?"top":D<=e+2?"bottom":"middle";var d=this.Canvas.measureText(C.Message[1]).width;this.Canvas.textBaseline,this.Canvas.textAlign,this.Canvas.font,C.Message[1],f=D,c=r;this.Canvas.save(),this.Canvas.translate(f,c),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(C.Message[1],-2*o,0),this.Canvas.restore()}h=D}}}}},this.GetLeftExtendXFromIndex=function(t,e){var a=e.TotalCount-1,i=this.ChartBorder.GetHScreenBorder(),r=i.Top,n=this.ChartBorder.LeftExtendWidth,s=r+n*t/a;return s},this.GetLeftExtendXData=function(t,e){var a=e.TotalCount-1;a<0&&(a=0);var i=this.ChartBorder.GetHScreenBorder(),r=i.Top,n=i.TopEx;if(t<=r)return 0;if(t>=n)return a;var s=n-r;return 1*a/s*(t-r)},this.GetLeftExtendYFromData=function(t,e,a){if(!a||!a.Range)return this.GetYFromData(t,e);var i=a.Range,r=this.ChartBorder.GetHScreenBorder(),n=r.RightEx-r.LeftEx,s=n*(t-i.Min)/(i.Max-i.Min);return r.LeftEx+s},this.GetLeftExtendYData=function(t,e,a){if(!a||!a.Range)return this.GetYData(y,e);var i=a.Range,r=this.ChartBorder.GetHScreenBorder(),n=r.RightEx-r.LeftEx;return(t-r.LeftEx)/n*(i.Max-i.Min)+i.Min},this.GetRightExtendXFromIndex=function(t,e){var a=e.TotalCount-1,i=this.ChartBorder.GetHScreenBorder(),r=i.BottomEx,n=this.ChartBorder.RightExtendWidth,s=r+n*t/a;return s},this.GetRightExtendXData=function(t,e){var a=e.TotalCount-1;a<0&&(a=0);var i=this.ChartBorder.GetHScreenBorder(),r=i.BottomEx,n=i.Bottom;if(t<=r)return 0;if(t>=n)return a;var s=n-r;return 1*a/s*(t-r)},this.GetRightExtendYFromData=function(t,e,a){return a&&a.Range?this.GetLeftExtendYFromData(t,e,a):this.GetYFromData(t,e)}}function Ct(){this.newMethod=lt,this.newMethod(),delete this.newMethod,this.ClassName="OverlayMinuteFrame",this.IsShow=!0,this.IsShareY=!1,this.IsCalculateYMaxMin=!0,this.Draw=function(){this.SplitXYCoordinate(),this.IsShow,this.SizeChange=!1,this.XYSplit=!1},this.DrawToolbar=function(){},this.GetScaleTextWidth=function(){return{TextWidth:0}},this.SplitXYCoordinate=function(){if(0!=this.XYSplit)if(this.IsShareY)for(var t in this.HorizontalMax=this.MainFrame.HorizontalMax,this.HorizontalMin=this.MainFrame.HorizontalMin,this.HorizontalInfo=[],this.MainFrame.HorizontalInfo){var e=this.MainFrame.HorizontalInfo[t];this.HorizontalInfo.push(e)}else null!=this.YSplitOperator&&this.YSplitOperator.Operator()}}function Dt(){this.newMethod=ut,this.newMethod(),delete this.newMethod,this.ClassName="OverlayMinuteHScreenFrame",this.IsShow=!0,this.Draw=function(){this.SplitXYCoordinate(),this.IsShow,this.SizeChange=!1,this.XYSplit=!1},this.SplitXYCoordinate=function(){if(0!=this.XYSplit)if(this.IsShareY)for(var t in this.HorizontalMax=this.MainFrame.HorizontalMax,this.HorizontalMin=this.MainFrame.HorizontalMin,this.HorizontalInfo=[],this.MainFrame.HorizontalInfo){var e=this.MainFrame.HorizontalInfo[t];this.HorizontalInfo.push(e)}else null!=this.YSplitOperator&&this.YSplitOperator.Operator()}}function ft(){this.newMethod=ht,this.newMethod(),delete this.newMethod,this.ClassName="KLineFrame",this.ToolbarID=q(),this.ModifyIndex=!0,this.ChangeIndex=!0,this.CloseIndex=!0,this.OverlayIndex=!1,this.ModifyIndexEvent,this.ChangeIndexEvent,this.ToolbarRect=null,this.ReDrawToolbar=!1,this.LastCalculateStatus={Width:0,XPointCount:0},this.CustomHorizontalInfo=[],this.IsDrawTitleBG=!1,this.CustomVerticalInfo=[],this.DrawCustomVerticalEvent,this.RightSpaceCount=0,this.Logarithmic=null,this.CustomToolbar=[],this.ToolbarType=0,this.DrawToolbar=function(){if(1!=this.ToolbarButtonStyle&&"undefined"!=typeof A.default&&this.ChartBorder.UIElement&&this.ChartBorder.UIElement.parentNode){var t=document.getElementById(this.ToolbarID);if(!t||0!=this.SizeChange||0!=this.ReDrawToolbar)if(t||(t=document.createElement("div"),t.className="klineframe-toolbar",t.id=this.ToolbarID,t.oncontextmenu=function(){return!1},t.setAttribute("identify",this.Identify.toString()),this.ChartBorder.UIElement.parentNode.appendChild(t)),this.ModifyIndex||this.ChangeIndex||this.OverlayIndex||this.CloseIndex||ha.IsNonEmptyArray(this.CustomToolbar)){var e=U(),a=parseInt(this.ChartBorder.UIElement.parentElement.style.width.replace("px","")),i=(parseInt(this.ChartBorder.UIElement.parentElement.style.height.replace("px","")),100),r=this.ChartBorder.GetTitleHeight(),n=a-this.ChartBorder.Right/e-i,s=this.ChartBorder.GetTop()/e;if(!this.ToolbarRect||this.ToolbarRect.Left!=n||this.ToolbarRect.Top!=s||this.ToolbarRect.Width!=i||this.ToolbarRect.Height!=r/e){this.ToolbarRect={Left:n,Top:s,Width:i,Height:r/e};var o="<span class='index_param icon iconfont icon-index_param' id='modifyindex' style='cursor:pointer;margin-left:2px;margin-right:2px;' title='è°æ´ææ åæ°'></span>",h="<span class='index_change icon iconfont icon-change_index' id='changeindex' style='cursor:pointer;margin-left:2px;margin-right:2px;' title='åæ¢ææ '></span>",l="<span class='index_overlay icon iconfont icon-overlay_index' id='overlayindex' style='cursor:pointer;margin-left:2px;margin-right:2px;' title='å å ææ '></span>",u="<span class='index_close icon iconfont icon-close' id='closeindex' style='cursor:pointer;margin-left:2px;margin-right:2px;' title='å³é­ææ çªå£'></span>",C=o+h+l;if(0!==this.Identify&&this.CloseIndex&&(C+=u),ha.IsNonEmptyArray(this.CustomToolbar))for(var D=0;D<this.CustomToolbar.length;++D){var f=this.CustomToolbar[D];C+=f.Html}t.style.left=n+"px",t.style.top=s+"px",t.style.width=i+"px",t.style.height=r/e+"px",t.innerHTML=C;this.ChartBorder.UIElement.JSChartContainer,this.Identify;if(this.ModifyIndex?"function"==typeof this.ModifyIndexEvent&&(0,A.default)("#"+t.id+" .index_param").click({Chart:this.ChartBorder.UIElement.JSChartContainer,Identify:this.Identify},this.ModifyIndexEvent):(0,A.default)("#"+t.id+" .index_param").hide(),this.ChangeIndex?"function"==typeof this.ChangeIndexEvent&&(0,A.default)("#"+t.id+" .index_change").click({Chart:this.ChartBorder.UIElement.JSChartContainer,Identify:this.Identify,IsOverlay:!1},this.ChangeIndexEvent):(0,A.default)("#"+t.id+" .index_change").hide(),this.OverlayIndex?(0,A.default)("#"+t.id+" .index_overlay").click({Chart:this.ChartBorder.UIElement.JSChartContainer,Identify:this.Identify,IsOverlay:!0},this.ChangeIndexEvent):(0,A.default)("#"+t.id+" .index_overlay").hide(),(0,A.default)("#"+t.id+" .index_close").click({Chart:this.ChartBorder.UIElement.JSChartContainer,Identify:this.Identify},(function(t){var e=t.data.Chart,a=t.data.Identify;e.RemoveIndexWindow(a)})),ha.IsNonEmptyArray(this.CustomToolbar))for(D=0;D<this.CustomToolbar.length;++D){f=this.CustomToolbar[D];(0,A.default)("#"+f.ID).click({Chart:this.ChartBorder.UIElement.JSChartContainer,Identify:this.Identify,ID:f.ID},f.Click)}t.style.display="block"}}else"none"!=t.style.display&&(t.style.display="none")}},this.DrawToolbarV2=function(t){if(this.Buttons=[],1!=this.IsMinSize&&!(this.ChartBorder.TitleHeight<5)){var e=[];if(this.CloseIndex&&0!==this.Identify&&e.push({ID:k.CLOSE_INDEX_WINDOW,Style:this.CloseWindowButton}),this.OverlayIndex&&e.push({ID:k.OVERLAY_INDEX,Style:this.OverlayIndexButton}),this.ChangeIndex&&e.push({ID:k.CHANGE_INDEX,Style:this.ChangeIndexButton}),this.ModifyIndex&&e.push({ID:k.MODIFY_INDEX_PARAM,Style:this.ModifyIndexParamButton}),ha.IsNonEmptyArray(this.CustomToolbar))for(var a=0;a<this.CustomToolbar.length;++a){var i=this.CustomToolbar[a];i.ID&&i.Style&&e.push({ID:i.ID,Style:i.Style})}this.DrawTitleButton(e,t)}},this.DrawFrame=function(){this.IsMinSize||(this.SplitXYCoordinate(),1==this.SizeChange&&(this.CalculateDataWidth(),this.Logarithmic&&this.SplitLogarithmicXYCoordinate()),this.BeforeDrawXYCallback&&this.BeforeDrawXYCallback(this),this.DrawTitleBG(),this.DrawHorizontal(),this.DrawVertical()),1!=this.SizeChange&&1!=this.ReDrawToolbar||(this.DrawToolbar(),this.ReDrawToolbar=!1)},this.GetXFromIndex=function(t,e){if(!1===e)if(t>=0)for(var a=this.ChartBorder.GetLeft()+Oi.FrameLeftMargin+this.DistanceWidth/2+this.DataWidth/2,i=1;i<=t;++i)a+=this.DistanceWidth+this.DataWidth;else{a=this.ChartBorder.GetLeft()-(this.DistanceWidth/2+this.DataWidth+this.DistanceWidth);var r=Math.abs(t);for(i=1;i<r;++i)a-=this.DistanceWidth+this.DataWidth}else{t<0&&(t=0),t>this.xPointCount-1&&(t=this.xPointCount-1);for(a=this.ChartBorder.GetLeft()+Oi.FrameLeftMargin+this.DistanceWidth/2+this.DataWidth/2,i=1;i<=t;++i)a+=this.DistanceWidth+this.DataWidth}return a},this.GetXData=function(t,e){var a=this.DistanceWidth,i=this.DataWidth,r=this.ChartBorder.GetLeft()+Oi.FrameLeftMargin;if(0==e){if(t<this.ChartBorder.GetLeft()){var n=-1,s=this.ChartBorder.GetLeft()-(a/2+i+a);while(n>-1e4){if(s<=t)break;s-=i+a,--n}return n}n=0,s=r+a/2+i+a;while(n<1e4){if(s>=t)break;s+=i+a,++n}return n}if(t<=this.ChartBorder.GetLeft())return 0;if(t>=this.ChartBorder.GetRight())return this.XPointCount-1;var o=this.ChartBorder.GetRight()-Oi.FrameRightMargin;n=0,s=r+a/2+i+a;while(s<o&&n<1e4&&n+1<this.XPointCount){if(s>=t)break;s+=i+a,++n}return n},this.CalculateDataWidth=function(){if(!(this.XPointCount<2)){var t=this.GetFrameWidth()-Oi.FrameMargin;if(this.ZoomIndex>=0&&this.LastCalculateStatus.Width==t&&this.LastCalculateStatus.XPointCount==this.XPointCount){var e=this.DistanceWidth/2+Oi.FrameLeftMargin+(this.DataWidth+this.DistanceWidth)*(this.XPointCount-1);this.DataWidth,this.DistanceWidth,this.XPointCount;if(e<=t)return}this.LastCalculateStatus.Width=t,this.LastCalculateStatus.XPointCount=this.XPointCount;for(var a=0;a<Wt.length;++a)if((Wt[a][0]+Wt[a][1])*this.XPointCount<t)return this.ZoomIndex=a,this.DataWidth=Wt[a][0],this.DistanceWidth=Wt[a][1],this.TrimKLineDataWidth(t),void w.Chart.Log("[KLineFrame::CalculateDataWidth] ZOOM_SEED, DataWidth, DistanceWidth, XPointCount",Wt[this.ZoomIndex],this.DataWidth,this.DistanceWidth,this.XPointCount);this.ZoomIndex=Wt.length-1,this.DataWidth=t/this.XPointCount,this.DistanceWidth=0}},this.OnSize=function(t){for(var e=this.GetFrameWidth()-Oi.FrameMargin,a=0,i=this.DistanceWidth/2+Oi.FrameLeftMargin+(this.DataWidth+this.DistanceWidth);i<e;i+=this.DataWidth+this.DistanceWidth,++a);return t.CurCount=this.XPointCount,t.CalcCount=a,t.DataWidth=this.DataWidth,t.DistanceWidth=this.DistanceWidth,t.Changed=!1,this.LastCalculateStatus.Width=e,t.CurCount==t.CalcCount||(this.XPointCount=a,this.LastCalculateStatus.XPointCount=this.XPointCount,this.Data&&(this.Data.DataOffset+=t.CurCount-t.CalcCount,this.Data.DataOffset<0&&(this.Data.DataOffset=0),t.Changed=!0)),t},this.SetDataWidth=function(t){var e=Wt.length-1;for(var a in Wt){var i=Wt[a];if(i[0]<=t){e=parseInt(a)-1;break}}this.ZoomIndex=e,this.DataWidth=Wt[this.ZoomIndex][0],this.DistanceWidth=Wt[this.ZoomIndex][1];for(var r=this.GetFrameWidth()-Oi.FrameMargin,n=0,s=this.DistanceWidth/2+Oi.FrameLeftMargin+(this.DataWidth+this.DistanceWidth);s<=r;s+=this.DataWidth+this.DistanceWidth,++n);this.XPointCount=n,this.LastCalculateStatus.XPointCount=this.XPointCount,this.LastCalculateStatus.Width=r;var o={XPointCount:this.XPointCount,DataWidth:this.DataWidth,DistanceWidth:this.DistanceWidth};return o},this.TrimKLineDataWidth=function(t){var e=Wt[this.ZoomIndex][0],a=Wt[this.ZoomIndex][1];if(1!=e||0!=a)while(1){if((this.DistanceWidth+this.DataWidth)*this.XPointCount+this.DistanceWidth>t){this.DistanceWidth-=.01;break}this.DistanceWidth+=.01}else this.DataWidth=t/this.XPointCount},this.IsOverlayMaxMin=function(t){if(!this.ChartKLine)return!1;if(!this.ChartKLine.Max||!this.ChartKLine.Min)return!1;var e=this.Canvas.measureText(t.Text.Value).width+4;"right"===t.Text.TextAlign&&(t.X-=e);var a=this.ChartKLine.Max,i=this.ChartKLine.Min,r=!1,n=!1,s=20;if(a.X>=t.X&&a.X<=t.X+e){var o=a.Y+s,h=a.Y-s;(o>=t.Y-s&&o<=t.Y+s||h>=t.Y-s&&h<=t.Y+s)&&(r=!0)}if(1==r)return!0;if(i.X>=t.X&&i.X<=t.X+e){o=i.Y+s,h=i.Y-s;(o>=t.Y-s&&o<=t.Y+s||h>=t.Y-s&&h<=t.Y+s)&&(n=!0)}return r||n},this.SplitXYCoordinate=function(){0!=this.XYSplit&&(null!=this.YSplitOperator&&this.YSplitOperator.Operator(),null!=this.XSplitOperator&&this.XSplitOperator.Operator(),this.Logarithmic&&this.SplitLogarithmicXYCoordinate())},this.SplitLogarithmicXYCoordinate=function(){for(var t=this.Logarithmic.Up,e=this.Logarithmic.Down,a=0,i=0,r=Math.max(t.length,e.length),n=[],s=0;s<r;++s)n[s]=2*s;s=0;for(var o=n.length-1;s<t.length;++s,--o){var h=t[s];h.LogHeight=n[o],a+=h.LogHeight,++i}for(s=0,o=n.length-1;s<e.length;++s,--o){h=e[s];h.LogHeight=n[o],a+=h.LogHeight,++i}var l=2*U(),u=this.ChartBorder.GetTopEx(),C=this.ChartBorder.GetBottomEx(),D=C-u,f=(D-a*l)/i;if(f<0&&(f=0,l=D/a),1==this.CoordinateType){var c=u;for(s=e.length-1;s>=0;--s){h=e[s];h.Height=f+l*h.LogHeight,h.Top=c,h.Bottom=h.Top+h.Height,c=h.Bottom}var d=C;for(s=t.length-1;s>=0;--s){h=t[s];h.Height=f+l*h.LogHeight,h.Bottom=d,h.Top=d-h.Height,d=h.Top}}else{for(c=u,s=t.length-1;s>=0;--s){h=t[s];h.Height=f+l*h.LogHeight,h.Top=c,h.Bottom=h.Top+h.Height,c=h.Bottom}for(d=C,s=e.length-1;s>=0;--s){h=e[s];h.Height=f+l*h.LogHeight,h.Bottom=d,h.Top=d-h.Height,d=h.Top}}w.Chart.Log("[KLineFrame::SplitLogarithmicXYCoordinate]",this.Logarithmic)},this.GetYLogarithmicFromData=function(t,e){if(1==this.CoordinateType){if(t<=this.HorizontalMin)return this.ChartBorder.GetTopEx();if(t>=this.HorizontalMax)return this.ChartBorder.GetBottomEx();if(t>this.Logarithmic.OpenPrice){var a=this.Logarithmic.Up;for(var i in a){var r=a[i];if(t>=r.Start&&t<=r.End){var n=r.Bottom-r.Top,s=n*(t-r.Start)/(r.End-r.Start);return r.Top+s}}}else{var o=this.Logarithmic.Down;for(var i in o){r=o[i];if(t>=r.Start&&t<=r.End){n=r.Bottom-r.Top,s=n*(t-r.Start)/(r.End-r.Start);return r.Top+s}}}}else{if(t<=this.HorizontalMin)return this.ChartBorder.GetBottomEx();if(t>=this.HorizontalMax)return this.ChartBorder.GetTopEx();if(t>this.Logarithmic.OpenPrice){a=this.Logarithmic.Up;for(var i in a){r=a[i];if(t>=r.Start&&t<=r.End){n=r.Bottom-r.Top,s=n*(t-r.Start)/(r.End-r.Start);return r.Bottom-s}}}else{o=this.Logarithmic.Down;for(var i in o){r=o[i];if(t>=r.Start&&t<=r.End){n=r.Bottom-r.Top,s=n*(t-r.Start)/(r.End-r.Start);return r.Bottom-s}}}}},this.GetYLogarithmicData=function(t){if(1==this.CoordinateType){if(t<this.ChartBorder.GetTopEx())return this.HorizontalMin;if(t>this.ChartBorder.GetBottomEx())return this.HorizontalMax;var e=this.Logarithmic.Up;for(var a in e){var i=e[a];if(t>=i.Top&&t<=i.Bottom)return(t-i.Top)/i.Height*(i.End-i.Start)+i.Start}var r=this.Logarithmic.Down;for(var a in r){i=r[a];if(t>=i.Top&&t<=i.Bottom)return(t-i.Top)/i.Height*(i.End-i.Start)+i.Start}}else{if(t<this.ChartBorder.GetTopEx())return this.HorizontalMax;if(t>this.ChartBorder.GetBottomEx())return this.HorizontalMin;e=this.Logarithmic.Up;for(var a in e){i=e[a];if(t>=i.Top&&t<=i.Bottom)return(i.Bottom-t)/i.Height*(i.End-i.Start)+i.Start}r=this.Logarithmic.Down;for(var a in r){i=r[a];if(t>=i.Top&&t<=i.Bottom)return(i.Bottom-t)/i.Height*(i.End-i.Start)+i.Start}}},this.CalculateCount=function(t){var e=this.GetFrameWidth()-Oi.FrameMargin;return parseInt(e/(Wt[t][0]+Wt[t][1]))},this.ZoomUp=function(t){if(this.ZoomIndex<=0)return!1;if(this.Data.DataOffset<0)return!1;var e=this.Data.Data.length,a=e+this.RightSpaceCount,i=0,r=this.Data.DataOffset+this.XPointCount-1,n=this.Data.DataOffset+t.Index;r>=e&&(i=r-(this.Data.Data.length-1),r=this.Data.Data.length-1,i>this.RightSpaceCount&&(i=this.RightSpaceCount));var s=this.CalculateCount(this.ZoomIndex-1);w.Chart.Log("[KLineFrame::ZoomUp] old status. XPointCount="+s+" ZoomIndex="+this.ZoomIndex+" DataCount= "+this.Data.Data.length+" rightSpaceCount="+i);var o=!1;if(--this.ZoomIndex,1==t.IsLockRight){var h=this.Data.DataOffset+this.XPointCount;if(s>h)s=h,this.XPointCount=s,this.Data.DataOffset=0;else{var l=r-(s-i)+1;this.XPointCount=s,this.Data.DataOffset=l,this.Data.DataOffset<0&&(this.Data.DataOffset=0)}}else if(s>=a)this.Data.DataOffset=0,this.XPointCount=s,o=!0,w.Chart.Log("[KLineFrame::ZoomUp] Show all data. XPointCount="+s+" ZoomIndex="+this.ZoomIndex+" DataCount= "+e);else{l=r-(s-i)+1;if(1==t.ZoomType){var u=this.XPointCount-s+1,C=parseInt(t.Index/this.XPointCount*u),D=this.Data.DataOffset+C;D<e&&(l=this.Data.DataOffset+C)}this.XPointCount=s,this.Data.DataOffset=l,this.Data.DataOffset<0&&(this.Data.DataOffset=0),w.Chart.Log("[KLineFrame::ZoomUp] calculate. XPointCount="+s+" ZoomIndex="+this.ZoomIndex+" DataCount= "+e+" DataOffset="+this.Data.DataOffset)}if(this.DataWidth=Wt[this.ZoomIndex][0],this.DistanceWidth=Wt[this.ZoomIndex][1],!o){var f=this.GetFrameWidth()-Oi.FrameMargin;this.TrimKLineDataWidth(f)}return this.LastCalculateStatus.XPointCount=this.XPointCount,t.Index=n-this.Data.DataOffset,!0},this.XCoordinateZoom=function(t){var e=this.XPointCount;if(t){if(this.ZoomIndex<=0)return!1;if(this.Data.DataOffset<0)return!1;var a=this.ZoomIndex-1,i=this.CalculateCount(a),r=this.Data.Data.length,n=e-i;if(n<=0)return!1;this.Data.DataOffset+=n,this.Data.DataOffset>r&&(this.Data.DataOffset=0)}else{if(this.ZoomIndex+1>=Wt.length)return!1;if(this.Data.DataOffset<0)return!1;a=this.ZoomIndex+1,i=this.CalculateCount(a),n=i-e;this.Data.DataOffset-=n,this.Data.DataOffset<0&&(this.Data.DataOffset=0)}this.XPointCount=i,this.ZoomIndex=a,this.DataWidth=Wt[this.ZoomIndex][0],this.DistanceWidth=Wt[this.ZoomIndex][1];var s=this.GetFrameWidth()-Oi.FrameMargin;return this.TrimKLineDataWidth(s),this.LastCalculateStatus.XPointCount=this.XPointCount,!0},this.ZoomDown=function(t){if(this.ZoomIndex+1>=Wt.length)return!1;if(this.Data.DataOffset<0)return!1;if(this.Data.DataOffset<=0&&1==t.IsLockRight)return!1;var e=this.Data.Data.length,a=e+this.RightSpaceCount,i=0,r=this.Data.DataOffset+this.XPointCount-1;r>=this.Data.Data.length&&(i=r-(this.Data.Data.length-1),r=this.Data.Data.length-1,i>this.RightSpaceCount&&(i=this.RightSpaceCount));var n=this.CalculateCount(this.ZoomIndex+1),s=this.Data.DataOffset+t.Index;w.Chart.Log("[KLineFrame::ZoomDown] old status. XPointCount="+n+" ZoomIndex="+this.ZoomIndex+" DataCount= "+this.Data.Data.length+" lastCursorIndex="+s+" rightSpaceCount="+i);var o=!1;if(++this.ZoomIndex,1==t.IsLockRight){var h=this.Data.DataOffset+this.XPointCount;if(n>h)n=h,this.XPointCount=n,this.Data.DataOffset=0;else{var l=r-(n-i)+1;this.XPointCount=n,this.Data.DataOffset=l,this.Data.DataOffset<0&&(this.Data.DataOffset=0)}}else if(n>=a)this.XPointCount=n,this.Data.DataOffset=0,o=!0,w.Chart.Log("[KLineFrame::ZoomDown] Show all data. XPointCount="+n+" ZoomIndex="+this.ZoomIndex+" DataCount= "+e);else{l=r-(n-i)+1;if(1==t.ZoomType){var u=n-this.XPointCount+1,C=parseInt(t.Index/this.XPointCount*u);l=this.Data.DataOffset-C;l+(n-this.RightSpaceCount)>=e&&(l=this.Data.DataOffset-u)}this.XPointCount=n,this.Data.DataOffset=l,this.Data.DataOffset<0&&(this.Data.DataOffset=0),w.Chart.Log("[KLineFrame::ZoomDown] calculate. XPointCount="+n+" ZoomIndex="+this.ZoomIndex+" DataCount= "+e+" DataOffset="+this.Data.DataOffset)}if(this.DataWidth=Wt[this.ZoomIndex][0],this.DistanceWidth=Wt[this.ZoomIndex][1],!o){var D=this.GetFrameWidth()-Oi.FrameMargin;this.TrimKLineDataWidth(D)}return this.LastCalculateStatus.XPointCount=this.XPointCount,t.Index=s-this.Data.DataOffset,!0},this.GetFrameWidth=function(){if(this.IsHScreen){var t=this.ChartBorder.GetHScreenBorder();return t.BottomEx-t.TopEx}t=this.ChartBorder.GetBorder();return t.RightEx-t.LeftEx},this.DrawCustomHorizontal=function(){if(!this.IsMinSize)for(var t=0;t<this.CustomHorizontalInfo.length;++t){var e=this.CustomHorizontalInfo[t];switch(e.Type){case 0:case 1:this.DrawCustomItem(e);break;case 2:case 3:case 4:this.DrawCustomItem(e);break}}},this.DrawCustomVerticalItem=function(t){this.Canvas.save(),1==t.Data.Line.Type&&this.Canvas.setLineDash([5,5]),this.Canvas.strokeStyle=t.Data.Line.Color,this.Canvas.beginPath(),t.IsHScreen?(this.Canvas.moveTo(t.Top,Q(t.X)),this.Canvas.lineTo(t.Bottom,Q(t.X))):(this.Canvas.moveTo(Q(t.X),t.Top),this.Canvas.lineTo(Q(t.X),t.Bottom)),this.Canvas.stroke(),this.Canvas.restore()},this.DrawCustomVertical=function(){if(this.CustomVerticalInfo&&!(this.CustomVerticalInfo.length<=0)&&this.Data){var t=this.IsHScreen,e=this.ChartBorder.GetTopEx(),a=this.ChartBorder.GetBottomEx(),i=this.DataWidth,r=this.DistanceWidth,n=this.ChartBorder.GetLeft()+r/2+2;t&&(n=this.ChartBorder.GetTop()+r/2+2,e=this.ChartBorder.GetLeftEx(),a=this.ChartBorder.GetRightEx());for(var s=0,o=this.Data.DataOffset;o<this.Data.Data.length&&s<this.XPointCount;++o,++s,n+=i+r){var h=this.Data.Data[o];for(var l in this.CustomVerticalInfo){var u=this.CustomVerticalInfo[l];if(0==u.Type){if(ha.IsNumber(u.Time)){if(h.Date!=u.Date||h.Time!=u.Time)continue}else if(h.Date!=u.Date)continue;var C=n,D=n+i,f=C+(D-C)/2,c={X:f,Top:e,Bottom:a,Data:u,IsHScreen:t};this.DrawCustomVerticalItem(c),this.DrawCustomVerticalEvent&&this.DrawCustomVerticalEvent.Callback(this.DrawCustomVerticalEvent,c,this);break}}}for(o=1;s<this.XPointCount;++o,++s,n+=i+r)for(var l in this.CustomVerticalInfo){u=this.CustomVerticalInfo[l];if(1==u.Type&&u.Space==o){C=n,D=n+i,f=C+(D-C)/2,c={X:f,Top:e,Bottom:a,Data:u,IsHScreen:t};this.DrawCustomVerticalItem(c),this.DrawCustomVerticalEvent&&this.DrawCustomVerticalEvent.Callback(this.DrawCustomVerticalEvent,c,this);break}}}}}function ct(){this.newMethod=ft,this.newMethod(),delete this.newMethod,this.ClassName="OverlayKLineFrame",this.MainFrame=null,this.IsShareY=!1,this.IsCalculateYMaxMin=!0,this.RightOffset=50,this.PenBorder=Oi.OverlayFrame.BolderPen,this.IsShow=!0,this.Title=null,this.TitleColor=Oi.OverlayFrame.TitleColor,this.TitleFont=Oi.OverlayFrame.TitleFont,this.Buttons=[],this.CloseButton=et(Oi.Buttons.CloseOverlayIndex),this.ModifyIndexParamButton=et(Oi.Buttons.ModifyIndexParam),this.KLineFrame_ReloadResource=this.ReloadResource,this.ReloadResource=function(t){this.KLineFrame_ReloadResource(t),t||(this.CloseButton=et(Oi.Buttons.CloseOverlayIndex),this.ModifyIndexParamButton=et(Oi.Buttons.ModifyIndexParam),this.PenBorder=Oi.OverlayFrame.BolderPen,this.TitleColor=Oi.OverlayFrame.TitleColor,this.TitleFont=Oi.OverlayFrame.TitleFont)},this.Draw=function(){this.Buttons=[],this.SplitXYCoordinate(),this.IsShow&&(this.DrawVertical(),this.DrawHorizontal(),this.DrawTitle()),this.SizeChange=!1,this.XYSplit=!1},this.DrawTitle=function(){if(this.Title){var t=this.ChartBorder.GetBorder(),e=this.ChartBorder.GetTopTitle(),a=t.Bottom,i=t.Right;i+=this.RightOffset,this.Canvas.fillStyle=this.TitleColor,this.Canvas.font=this.TitleFont,this.Canvas.textAlign="center",this.Canvas.textBaseline="top";var r=i-2,n=e+(a-e)/2;this.Canvas.save(),this.Canvas.translate(r,n),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(this.Title,0,0),this.Canvas.restore()}},this.GetScaleTextWidth=function(){if(!this.IsShow)return null;this.ChartBorder.GetBorder();var t=U();if(this.IsHScreen)var e=this.ChartBorder.Bottom,a=e>10*t&&!0===this.IsShowYText[1]&&2!=this.YTextPosition[1];else{var i=this.ChartBorder.Right;a=i>10&&!0===this.IsShowYText[1]&&2!=this.YTextPosition[1]}if(!a)return null;for(var r={Left:null,Right:0},n=0;n<this.HorizontalInfo.length;++n){var s=null,o=this.HorizontalInfo[n];o&&(null!=o.Message[1]&&a&&(null!=o.Font&&(this.Canvas.font=o.Font),s=this.Canvas.measureText(o.Message[1]).width,r.Right<s&&(r.Right=s)))}return{TextWidth:r}},this.SplitXYCoordinate=function(){if(0!=this.XYSplit)if(this.IsShareY){for(var t in this.HorizontalMax=this.MainFrame.HorizontalMax,this.HorizontalMin=this.MainFrame.HorizontalMin,this.HorizontalInfo=[],this.MainFrame.HorizontalInfo){var e=this.MainFrame.HorizontalInfo[t];this.HorizontalInfo.push(e)}this.CoordinateType=this.MainFrame.CoordinateType}else null!=this.YSplitOperator&&this.YSplitOperator.Operator()},this.DrawHorizontal=function(){var t=this.ChartBorder.GetBorder(),e=(t.Left,t.Right),a=t.Bottom,i=this.ChartBorder.GetTopTitle(),r=this.ChartBorder.Right;e+=this.RightOffset;for(var n=null,s=this.HorizontalInfo.length-1;s>=0;--s){var o=this.HorizontalInfo[s],h=this.GetYFromData(o.Value);if(!(null!=h&&Math.abs(h-n)<this.MinYDistance)){if(this.Canvas.textBaseline=h>=a-2?"bottom":h<=i+2?"top":"middle",this.Canvas.strokeStyle=this.PenBorder,this.Canvas.beginPath(),this.Canvas.moveTo(e-2,Q(h)),this.Canvas.lineTo(e,Q(h)),this.Canvas.stroke(),null!=o.Message[1]&&r>10){null!=o.Font&&(this.Canvas.font=o.Font);var l=o.Message[1];Array.isArray(o.Message[1])&&(l=o.Message[1][0]),this.Canvas.fillStyle=o.TextColor,this.Canvas.textAlign="left",this.Canvas.fillText(l,e+2,h)}n=h}}},this.DrawVertical=function(){var t=this.ChartBorder.GetBorder(),e=t.TopEx,a=t.Right,i=t.BottomEx;a+=this.RightOffset,this.Canvas.strokeStyle=this.PenBorder,this.Canvas.beginPath(),this.Canvas.moveTo(Q(a),Q(e)),this.Canvas.lineTo(Q(a),Q(i)),this.Canvas.stroke()},this.DrawToolbar=function(t,e){if(this.Buttons=[],1!=e&&!(this.ChartBorder.TitleHeight<5)){var a=this.ChartBorder.GetBorder(),i=a.Top+this.ChartBorder.TitleHeight/2,r=a.Right+this.RightOffset+this.CloseButton.MerginLeft,n=[];n.push({ID:k.MODIFY_OVERLAY_INDEX_PARAM,Style:this.ModifyIndexParamButton}),n.push({ID:k.CLOSE_OVERLAY_INDEX,Style:this.CloseWindowButton});for(var s=0;s<n.length;++s){var o=n[s],h=o.Style.Size,l=h+"px "+o.Style.Family,u={Left:r,Top:i-h/2,Right:r+h+o.Style.MerginLeft,Bottom:i+h/2,Width:h+o.Style.MerginLeft,Height:h},C=this.CloseButton.Color;t&&t.X>=u.Left&&t.X<u.Right&&t.Y>=u.Top&&t.Y<=u.Bottom&&(C=o.Style.MoveOnColor),this.Canvas.fillStyle=C,this.Canvas.font=l,this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillText(o.Style.Text,r,i),this.Buttons.push({ID:o.ID,Rect:u}),r=u.Right}}}}function dt(){this.newMethod=ft,this.newMethod(),delete this.newMethod,this.ClassName="KLineHScreenFrame",this.IsHScreen=!0,this.DrawTitleBG=function(){if(!(this.ChartBorder.TitleHeight<=0)){var t=this.ChartBorder.GetHScreenBorder(),e=Q(t.RightTitle),a=Q(t.Top),i=Q(t.Bottom),r=this.ChartBorder.TitleHeight,n=i-a;this.Canvas.fillStyle=this.TitleBGColor,this.Canvas.fillRect(e,a,r,n)}},this.DrawToolbar=function(){},this.GetYFromData=function(t,e){var a=this.ChartBorder.GetHScreenBorder();if(!1===e){var i=(a.RightEx-a.LeftEx)*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return a.LeftEx+i}if(t<=this.HorizontalMin)return a.LeftEx;if(t>=this.HorizontalMax)return a.RightEx;i=(a.RightEx-a.LeftEx)*(t-this.HorizontalMin)/(this.HorizontalMax-this.HorizontalMin);return a.LeftEx+i},this.DrawHorizontal=function(){for(var t=this.ChartBorder.GetHScreenBorder(),e=t.Top,a=t.Bottom,i=this.ChartBorder.Top,r=this.ChartBorder.Bottom,n=t.Left,s=(t.Right,null),o=U(),h=i>10*o&&!0===this.IsShowYText[0]&&2!=this.YTextPosition[0],l=r>10*o&&!0===this.IsShowYText[1]&&2!=this.YTextPosition[1],u=this.HorizontalInfo.length-1;u>=0;--u){var C=this.HorizontalInfo[u],D=this.GetYFromData(C.Value);if(!(null!=D&&Math.abs(D-s)<this.MinYDistance)){if(D!=n&&(2==C.LineType?(this.Canvas.strokeStyle=C.LineColor,this.Canvas.setLineDash([5*o,5*o]),this.Canvas.beginPath(),this.Canvas.moveTo(Q(D),e),this.Canvas.lineTo(Q(D),a),this.Canvas.stroke(),this.Canvas.setLineDash([])):C.LineType>0&&(this.Canvas.strokeStyle=C.LineColor,Oi.FrameYLineDash?(this.Canvas.setLineDash(Oi.FrameYLineDash),this.Canvas.beginPath(),this.Canvas.moveTo(Q(D),e),this.Canvas.lineTo(Q(D),a),this.Canvas.stroke(),this.Canvas.setLineDash([])):(this.Canvas.beginPath(),this.Canvas.moveTo(Q(D),e),this.Canvas.lineTo(Q(D),a),this.Canvas.stroke()))),null!=C.Message[0]&&h){null!=C.Font&&(this.Canvas.font=C.Font),this.Canvas.fillStyle=C.TextColor,this.Canvas.textAlign="right",this.Canvas.textBaseline="middle";var f=D,c=e;this.Canvas.save(),this.Canvas.translate(f,c),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(C.Message[0],-2,0),this.Canvas.restore()}if(null!=C.Message[1]&&l){var d;null!=C.Font&&(this.Canvas.font=C.Font),this.Canvas.fillStyle=C.TextColor,this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",d=Array.isArray(C.Message[1])?C.Message[1][0]:C.Message[1];f=D,c=a;this.Canvas.save(),this.Canvas.translate(f,c),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(d,2,0),this.Canvas.restore()}s=D}}},this.DrawInsideHorizontal=function(){if(!this.IsMinSize&&(!1!==this.IsShowYText[0]||!1!==this.IsShowYText[1])){var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRightEx(),a=this.ChartBorder.GetTop(),i=this.ChartBorder.GetBottom(),r=this.ChartBorder.Top,n=this.ChartBorder.Bottom,s=(this.ChartBorder.TitleHeight,U()),o=(r<10*s||2==this.YTextPosition[0])&&!0===this.IsShowYText[0],h=(n<10*s||2==this.YTextPosition[1])&&!0===this.IsShowYText[1];if(o||h){s=U();for(var l=null,u=this.HorizontalInfo.length-1;u>=0;--u){var C=this.HorizontalInfo[u],D=this.GetYFromData(C.Value);if(!(null!=D&&null!=l&&Math.abs(D-l)<this.MinYDistance)){if(null!=C.Message[0]&&o){null!=C.Font&&(this.Canvas.font=C.Font),this.Canvas.fillStyle=C.TextColor,this.Canvas.textAlign="left",this.Canvas.textBaseline=D>=e-2?"top":D<=t+2?"bottom":"middle";this.Canvas.textBaseline,this.Canvas.textAlign,this.Canvas.font,C.Message[0];var f=D,c=a;this.Canvas.save(),this.Canvas.translate(f,c),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(C.Message[0],-2,0),this.Canvas.restore()}if(null!=C.Message[1]&&h){if(null!=C.Font&&(this.Canvas.font=C.Font),this.Canvas.fillStyle=C.TextColor,this.Canvas.textAlign="right",this.Canvas.textBaseline=D>=e-2?"top":D<=t+2?"bottom":"middle",Array.isArray(C.Message[1]))var d=C.Message[1][0];else d=C.Message[1];var m=this.Canvas.measureText(d).width;this.Canvas.textBaseline,this.Canvas.textAlign,this.Canvas.font,f=D,c=i;this.Canvas.save(),this.Canvas.translate(f,c),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(d,-2,0),this.Canvas.restore()}l=D}}}}},this.GetXFromIndex=function(t,e){if(!1===e){var a=this.ChartBorder.GetHScreenBorder();if(t>=0)for(var i=a.TopEx+Oi.FrameLeftMargin+this.DistanceWidth/2+this.DataWidth/2,r=1;r<=t;++r)i+=this.DistanceWidth+this.DataWidth;else{i=a.TopEx-(this.DistanceWidth/2+this.DataWidth+this.DistanceWidth);var n=Math.abs(t);for(r=1;r<n;++r)i-=this.DistanceWidth+this.DataWidth}}else{t<0&&(t=0),t>this.xPointCount-1&&(t=this.xPointCount-1);for(a=this.ChartBorder.GetHScreenBorder(),i=a.TopEx+Oi.FrameLeftMargin+this.DistanceWidth/2+this.DataWidth/2,r=1;r<=t;++r)i+=this.DistanceWidth+this.DataWidth}return i},this.DrawVertical=function(){var t=this.ChartBorder.GetHScreenBorder(),e=t.Left,a=t.RightTitle,i=t.Bottom,r=U(),n=null;for(var s in this.VerticalInfo){var o=this.GetXFromIndex(this.VerticalInfo[s].Value);if(o>=i)break;if(!(null!=n&&Math.abs(o-n)<80)){var h=this.VerticalInfo[s];if(2==h.LineType?(this.Canvas.strokeStyle=this.VerticalInfo[s].LineColor,this.Canvas.setLineDash([5*r,5*r]),this.Canvas.beginPath(),this.Canvas.moveTo(e,Q(o)),this.Canvas.lineTo(a,Q(o)),this.Canvas.stroke(),this.Canvas.setLineDash([])):h.LineType>0&&(this.Canvas.strokeStyle=this.VerticalInfo[s].LineColor,Oi.FrameXLineDash?(this.Canvas.setLineDash(Oi.FrameXLineDash),this.Canvas.beginPath(),this.Canvas.moveTo(e,Q(o)),this.Canvas.lineTo(a,Q(o)),this.Canvas.stroke(),this.Canvas.setLineDash([])):(this.Canvas.beginPath(),this.Canvas.moveTo(e,Q(o)),this.Canvas.lineTo(a,Q(o)),this.Canvas.stroke())),null!=this.VerticalInfo[s].Message[0]){null!=this.VerticalInfo[s].Font&&(this.Canvas.font=this.VerticalInfo[s].Font),this.Canvas.fillStyle=this.VerticalInfo[s].TextColor;var l=this.Canvas.measureText(this.VerticalInfo[s].Message[0]).width;o<l/2?(this.Canvas.textAlign="left",this.Canvas.textBaseline="top"):(this.Canvas.textAlign="center",this.Canvas.textBaseline="top");var u=e,C=o;this.Canvas.save(),this.Canvas.translate(u,C),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(this.VerticalInfo[s].Message[0],0,this.XBottomOffset),this.Canvas.restore()}n=o}}},this.GetYData=function(t,e){var a=this.ChartBorder.GetHScreenBorder();if(!1===e){var i=a.RightEx-a.LeftEx;return(t-a.LeftEx)/i*(this.HorizontalMax-this.HorizontalMin)+this.HorizontalMin}if(t<a.LeftEx)return this.HorizontalMin;if(t>a.RightEx)return this.HorizontalMax;i=a.RightEx-a.LeftEx;return(t-a.LeftEx)/i*(this.HorizontalMax-this.HorizontalMin)+this.HorizontalMin},this.GetXData=function(t,e){var a=this.ChartBorder.GetHScreenBorder(),i=a.TopEx+Oi.FrameLeftMargin,r=a.BottomEx,n=this.DistanceWidth,s=this.DataWidth;if(0==e){if(t<i){var o=-1,h=i-(n/2+s+n);while(o>-1e4){if(h<=t)break;h-=s+n,--o}return o}o=0,h=i+n/2+s+n;while(o<1e4){if(h>=t)break;h+=s+n,++o}return o}if(t<=a.TopEx)return 0;if(t>=a.BottomEx)return this.XPointCount-1;o=0,h=i+n/2+s+n;while(h<r&&o<1e4&&o+1<this.XPointCount){if(h>t)break;h+=s+n,++o}return o},this.DrawBottons=function(){}}function mt(){this.newMethod=dt,this.newMethod(),delete this.newMethod,this.ClassName="OverlayKLineHScreenFrame",this.MainFrame=null,this.IsShareY=!1,this.IsCalculateYMaxMin=!0,this.RightOffset=50,this.PenBorder=Oi.OverlayFrame.BolderPen,this.IsShow=!0,this.Title=null,this.TitleColor=Oi.OverlayFrame.TitleColor,this.TitleFont=Oi.OverlayFrame.TitleFont,this.Draw=function(){this.SplitXYCoordinate(),this.IsShow&&(this.DrawVertical(),this.DrawHorizontal(),this.DrawTitle()),this.SizeChange=!1,this.XYSplit=!1},this.DrawTitle=function(){},this.SplitXYCoordinate=function(){if(0!=this.XYSplit)if(this.IsShareY)for(var t in this.HorizontalMax=this.MainFrame.HorizontalMax,this.HorizontalMin=this.MainFrame.HorizontalMin,this.HorizontalInfo=[],this.MainFrame.HorizontalInfo){var e=this.MainFrame.HorizontalInfo[t];this.HorizontalInfo.push(e)}else null!=this.YSplitOperator&&this.YSplitOperator.Operator()},this.DrawHorizontal=function(){},this.DrawVertical=function(){},this.GetScaleTextWidth=function(){return{TextWidth:0}}}function vt(){this.Frame,this.Height,this.OverlayIndex=[],this.Interval=60}function St(){this.Frame,this.ChartPaint=[],this.Identify=q(),this.Scprit,this.UpdateFrameMaxMin=function(){var t={Max:null,Min:null};if(this.Frame.IsShareY)this.Frame.XYSplit=!0;else{if(this.Frame.YSpecificMaxMin)t.Max=this.Frame.YSpecificMaxMin.Max,t.Min=this.Frame.YSpecificMaxMin.Min;else for(var e in this.ChartPaint){var a=this.ChartPaint[e],i=a.GetMaxMin();ha.IsNumber(i.Max)&&(null==t.Max||t.Max<i.Max)&&(t.Max=i.Max),ha.IsNumber(i.Min)&&(null==t.Min||t.Min>i.Min)&&(t.Min=i.Min)}null!=t.Max&&null!=t.Min&&(this.Frame.HorizontalMax=t.Max,this.Frame.HorizontalMin=t.Min,this.Frame.XYSplit=!0)}}}function It(){this.SubFrame=new Array,this.SizeChange=!0,this.ChartBorder,this.Canvas,this.ScreenImageData,this.Data,this.Position,this.SizeChange=!0,this.MinSubFrameHeight=Oi.DragSubFrameBorder.MinFrameHeight,this.DragBorderHeight=Oi.DragSubFrameBorder.TopBorderHeight,this.AutoLeftBorder=null,this.AutoRightBorder=null,this.OverlayBlankWidth=40,this.AuotRightWidth,this.ZoomWindowsInfo=null,this.ZoomStartWindowIndex=1,this.GetExtendChartByClassName,this.OnMoveFromeBorder=function(t,e){if(this.SubFrame.length<=0)return!1;for(var a=this.SubFrame[t],i=null,r=t+1;r<this.SubFrame.length;++r){var n=this.SubFrame[r];if(n.Height>0){i=n;break}}if(!a||!i)return!1;var s=a.Frame.ChartBorder.Bottom,o=i.Frame.ChartBorder.Top;a.Frame.ChartBorder.Bottom-=e,i.Frame.ChartBorder.Top+=e;var h=a.Frame.ChartBorder.GetHeightEx(),l=i.Frame.ChartBorder.GetHeightEx();return!(h<this.MinSubFrameHeight&&e<0||l<this.MinSubFrameHeight&&e>0)||(a.Frame.ChartBorder.Bottom=s,i.Frame.ChartBorder.Top=o,!1)},this.ReDrawToolbar=function(){for(var t in this.SubFrame)this.SubFrame[t].Frame.ReDrawToolbar=!0},this.SetFrameBorderSizeChange=function(){var t=this.SubFrame[0];if(t&&t.Frame){var e=t.Frame.YSplitOperator;e&&2==e.CoordinateType&&(t.Frame.XYSplit=!0)}},this.CancelZoomUpDownFrameY=function(t){var e=t.Index;if(this.SubFrame.length<=0)return!1;if(!this.SubFrame[e])return!1;var a=this.SubFrame[e],i=a.Frame,r=i.YSplitOperator;if(r.FixedYMaxMin){for(var n in r.FixedYMaxMin=null,r.EnableZoomUpDown=!1,i.XYSplit=!0,a.OverlayIndex){var s=a.OverlayIndex[n];s.Frame.IsShareY&&(s.Frame.XYSplit=!0)}return w.Chart.Log("[HQTradeFrame::CancelZoomUpDownFrameY]"),!0}return!1},this.OnZoomUpDownFrameY=function(t,e){var a=t.Index;if(this.SubFrame.length<=0)return!1;if(!this.SubFrame[a])return!1;var i=this.SubFrame[a],r=i.Frame,n=r.ChartBorder.GetTopEx(),s=r.ChartBorder.GetBottomEx(),o=r.HorizontalMax,h=r.HorizontalMin,l=(o-h)*Math.abs(e)/(s-n),u=r.YSplitOperator,C={Max:o,Min:h};if(1==t.Position){var D=e>0?-l:l;C.Max+=D}else if(2==t.Position){D=e>0?-l:l;C.Min+=D}else{if(0!=t.Position)return!1;D=e>0?l:-l;C.Max+=D,C.Min-=D}if(C.Max>C.Min){for(var f in u.FixedYMaxMin=C,u.EnableZoomUpDown=!0,r.XYSplit=!0,i.OverlayIndex){var c=i.OverlayIndex[f];c.Frame.IsShareY&&(c.Frame.XYSplit=!0)}return w.Chart.Log("[HQTradeFrame::OnZoomUpDownFrameY] Max="+C.Max+", Min="+C.Min),!0}return!1},this.OnUpDonwFrameY=function(t,e){var a=t.Index;if(this.SubFrame.length<=0)return!1;if(!this.SubFrame[a])return!1;var i=this.SubFrame[a],r=i.Frame,n=r.ChartBorder.GetTopEx(),s=r.ChartBorder.GetBottomEx(),o=r.YSplitOperator;if(!o)return!1;var h=r.HorizontalMax,l=r.HorizontalMin,u=(h-l)*Math.abs(e)/(s-n),C=e>0?-u:u,D={Max:h,Min:l};for(var f in D.Max-=C,D.Min-=C,o.FixedYMaxMin=D,o.EnableZoomUpDown=!0,r.XYSplit=!0,i.OverlayIndex){var c=i.OverlayIndex[f];c.Frame.IsShareY&&(c.Frame.XYSplit=!0)}return w.Chart.Log("[HQTradeFrame::OnUpDonwFrameY] Max="+D.Max+", Min="+D.Min+", yMove="+e+", moveStep="+u),!0},this.ClearUpDonwFrameYData=function(t){if(!(this.SubFrame.length<=0))if(t){var e=t.Index;if(e<0||e>=this.SubFrame.length)return;var a=this.SubFrame[e];if(!a||!a.Frame||!a.Frame.YSplitOperator)return;var i=a.Frame.YSplitOperator;1==i.EnableZoomUpDown&&(i.FixedYMaxMin=null)}else for(var r=0;r<this.SubFrame.length;++r){a=this.SubFrame[r];if(a&&a.Frame&&a.Frame.YSplitOperator){i=a.Frame.YSplitOperator;1==i.EnableZoomUpDown&&(i.FixedYMaxMin=null)}}},this.ClearCoordinateText=function(t){for(var e=0;e<this.SubFrame.length;++e){var a=this.SubFrame[e];a.Frame&&a.Frame.ClearCoordinateText(t)}},this.RestoreIndexWindows=function(){if(!this.ZoomWindowsInfo)return!1;this.SubFrame[this.ZoomWindowsInfo.FrameID];for(var t=this.ZoomStartWindowIndex;t<this.ZoomWindowsInfo.Data.length;++t){var e=this.ZoomWindowsInfo.Data[t],a=this.SubFrame[t];a.Height=e.Height,a.Frame.IsMinSize=!1,a.Frame.ReDrawToolbar=!0,a.Frame.XSplitOperator.ShowText=e.ShowXText,a.Frame.XYSplit=!0;for(var i=0;i<a.OverlayIndex.length;++i){var r=a.OverlayIndex[i];r.Frame.IsMinSize=!1}}return this.ZoomWindowsInfo=null,!0},this.ZoomIndexWindow=function(t,e){var a=this.SubFrame[t];if(!a)return!1;if(this.ZoomWindowsInfo)return this.RestoreIndexWindows();for(var i={FrameID:t,Data:[]},r=0;r<this.SubFrame.length;++r){var n=this.SubFrame[r];i.Data[r]={Height:n.Height,ShowXText:n.Frame.XSplitOperator.ShowText}}this.ZoomWindowsInfo=i;var s=0;for(r=this.ZoomStartWindowIndex;r<this.SubFrame.length;++r){n=this.SubFrame[r];var o=n.Frame;if(o.XYSplit=!0,s+=n.Height,r!=t){n.Height=0,o.IsMinSize=!0,o.HideToolbar(),o.XSplitOperator.ShowText=!1;for(var h=0;h<n.OverlayIndex.length;++h){var l=n.OverlayIndex[h];l.Frame.IsMinSize=!0}}}return a.Height=s,a.Frame.XSplitOperator.ShowText=!0,!0},this.SaveSubFrameHeightRate=function(){for(var t=this.ChartBorder.GetHeight(),e=0;e<this.SubFrame.length;++e){var a=this.SubFrame[e],i=a.Frame.ChartBorder.GetHeight(),r=i/t*100;a.Height=r}},this.CalculateChartBorder=function(){if(!(this.SubFrame.length<=0)){for(var t=this.ChartBorder.GetTop(),e=this.ChartBorder.GetHeight(),a=0,i=0;i<this.SubFrame.length;++i){var r=this.SubFrame[i];a+=r.Height}for(i=0;i<this.SubFrame.length;++i){r=this.SubFrame[i];r.Frame.ChartBorder.Top=t,r.Frame.ChartBorder.Left=this.ChartBorder.Left,r.Frame.ChartBorder.Right=this.ChartBorder.Right,r.Frame.ChartBorder.LeftExtendWidth=this.ChartBorder.LeftExtendWidth,r.Frame.ChartBorder.RightExtendWidth=this.ChartBorder.RightExtendWidth;var n=e*(r.Height/a)+t;r.Frame.ChartBorder.Bottom=this.ChartBorder.GetChartHeight()-n,t=n}}},this.SetExtendWidth=function(t){if(t){var e=null,a=null;for(var i in ha.IsNumber(t.Left)&&(e=t.Left,this.ChartBorder.LeftExtendWidth=e),ha.IsNumber(t.Right)&&(a=t.Right,this.ChartBorder.RightExtendWidth=a),this.SubFrame){var r=this.SubFrame[i];null!=e&&(r.Frame.ChartBorder.LeftExtendWidth=e),null!=a&&(r.Frame.ChartBorder.RightExtendWidth=a)}}},this.CalculateChartBorder2=function(){if(!(this.SubFrame.length<=0)){var t=this.ChartBorder.Top,e=this.ChartBorder.Bottom,a=this.ChartBorder.GetHeight(),i=0;for(var r in this.SubFrame){var n=this.SubFrame[r];i+=n.Height}var s=0;for(var r in this.SubFrame){n=this.SubFrame[r];n.Frame.ChartBorder.Top=t,n.Frame.ChartBorder.Left=this.ChartBorder.Left,n.Frame.ChartBorder.Right=this.ChartBorder.Right,n.Frame.ChartBorder.X=this.ChartBorder.X,n.Frame.ChartBorder.Y=this.ChartBorder.Y,n.Frame.ChartBorder.Width=this.ChartBorder.Width,n.Frame.ChartBorder.Height=this.ChartBorder.Height;var o=a*(n.Height/i);s+=o,e=this.ChartBorder.Bottom+(a-s),n.Frame.ChartBorder.Bottom=e,t+=o}}},this.GetScaleTextWidth=function(){for(var t={Left:null,Right:null,OverlayRight:0},e=[],a=0;a<this.SubFrame.length;++a){var i=this.SubFrame[a];if(!(i.Height<=0)){var r=i.Frame;if(r&&r.XSplitOperator){var n=r.HorizontalMax,s=r.HorizontalMin;r.YSplitOperator.Operator();var o=r.GetScaleTextWidth();if(r.HorizontalMax=n,r.HorizontalMin=s,o&&o.TextWidth){var h=o.TextWidth;ha.IsNumber(h.Left)&&(null==t.Left||t.Left<h.Left)&&(t.Left=h.Left),ha.IsNumber(h.Right)&&(null==t.Right||t.Right<h.Right)&&(t.Right=h.Right)}if(ha.IsNonEmptyArray(i.OverlayIndex))for(var l=0,u=0;l<i.OverlayIndex.length;++l){var C=i.OverlayIndex[l];if(C.Frame){n=C.Frame.HorizontalMax,s=C.Frame.HorizontalMin;C.Frame.YSplitOperator.Operator();o=C.Frame.GetScaleTextWidth();if(C.Frame.HorizontalMax=n,C.Frame.HorizontalMin=s,C.RightWidth={Index:-1,Width:0},o&&o.TextWidth){h=o.TextWidth;ha.IsNumber(h.Right)&&(C.RightWidth.Index=u,C.RightWidth.Width=h.Right,e[u]||(e[u]=[]),e[u][a]=C.RightWidth,++u)}}}}}}var D=[];for(a=0;a<e.length;++a){var f=e[a],c=0;for(l=0;l<f.length;++l)if(f[l]){i=f[l].Width;c<i&&(c=i)}c>0&&(c+=this.OverlayBlankWidth);for(l=0;l<f.length;++l)f[l]&&(f[l].Width=c);D[a]=c}for(a=0;a<D.length;++a){o=D[a];ha.IsNumber(o)&&(t.OverlayRight+=o)}return t},this.IsFrameXYSplit=function(){for(var t in this.SubFrame){var e=this.SubFrame[t];if(e.Frame.XYSplit)return!0;for(var a=0;a<e.OverlayIndex.length;++a){var i=e.OverlayIndex[a];if(i.Frame.XYSplit)return!0}}return!1},this.Draw=function(t){!0===this.SizeChange&&this.CalculateChartBorder();var e=!1;if(t&&!0===t.IsEnableSplash&&(e=!0),0==e&&(this.AutoLeftBorder||this.AutoRightBorder)&&this.IsFrameXYSplit()){this.AutoRightOverlayWidth=[];var a=this.GetScaleTextWidth();if(ha.IsNumber(a.Left)&&this.AutoLeftBorder){var i=0;ha.IsNumber(this.AutoLeftBorder.Blank)&&(i=this.AutoLeftBorder.Blank);var r=a.Left+i;ha.IsNumber(this.AutoLeftBorder.MinWidth)&&this.AutoLeftBorder.MinWidth>r&&(r=this.AutoLeftBorder.MinWidth),this.IsHScreen?this.ChartBorder.Top=r:this.ChartBorder.Left=r;for(var n=0;n<this.SubFrame.length;++n){var s=this.SubFrame[n];this.IsHScreen?s.Frame.ChartBorder.Top=r:s.Frame.ChartBorder.Left=r}}if(ha.IsNumber(a.Right)&&this.AutoRightBorder){i=0;ha.IsNumber(this.AutoRightBorder.Blank)&&(i=this.AutoRightBorder.Blank);r=a.Right+i;if(ha.IsNumber(this.AutoRightBorder.MinWidth)&&this.AutoRightBorder.MinWidth>r&&(r=this.AutoRightBorder.MinWidth),this.AuotRightWidth=r,ha.IsPlusNumber(a.OverlayRight)&&(r+=this.OverlayBlankWidth,this.AuotRightWidth=r,r+=a.OverlayRight),this.GetExtendChartRightWidth){var o=this.GetExtendChartRightWidth();if(this.GetExtendChartByClassName){var h=this.GetExtendChartByClassName("StockChip");h&&h.Chart&&(h.Chart.Left=r)}r+=o}this.IsHScreen?(this.ChartBorder.Bottom!=r&&!0,this.ChartBorder.Bottom=r):(this.ChartBorder.Right!=r&&!0,this.ChartBorder.Right=r);for(n=0;n<this.SubFrame.length;++n){s=this.SubFrame[n];this.IsHScreen?s.Frame.ChartBorder.Bottom=r:s.Frame.ChartBorder.Right=r,s.Frame.ReDrawToolbar=!0,s.Interval=this.AuotRightWidth}}this.SetSizeChage(!0)}for(n=0;n<this.SubFrame.length;++n){s=this.SubFrame[n];if(!(s.Height<=0))if(s.Frame.Draw(),this.AutoRightBorder)for(var l=this.AuotRightWidth,u=0;u<s.OverlayIndex.length;++u){var C=s.OverlayIndex[u];C.Frame.DataWidth=s.Frame.DataWidth,C.Frame.DistanceWidth=s.Frame.DistanceWidth,C.Frame.XPointCount=s.Frame.XPointCount,C.ChartPaint.length>0&&C.Frame&&(C.Frame.RightOffset=l,C.Frame.Draw(),l+=C.RightWidth.Width)}else{l=s.Interval;for(var u in s.Frame.RightTextMaxWidth>l&&(l=s.Frame.RightTextMaxWidth),s.OverlayIndex){C=s.OverlayIndex[u];C.Frame.DataWidth=s.Frame.DataWidth,C.Frame.DistanceWidth=s.Frame.DistanceWidth,C.Frame.XPointCount=s.Frame.XPointCount,C.ChartPaint.length>0&&C.Frame&&(C.Frame.RightOffset=l,C.Frame.Draw(),C.Frame.IsShow&&(l+=s.Interval))}}}this.SizeChange=!1},this.DrawOveraly=function(){for(var t=0;t<this.SubFrame.length;++t){var e=this.SubFrame[t];if(!(e.Height<=0))for(var a=0;a<e.OverlayIndex.length;++a)for(var i=e.OverlayIndex[a],r=0;r<i.ChartPaint.length;++r)i.ChartPaint[r].IsShow&&i.ChartPaint[r].Draw()}},this.DrawOveralySelectedStatus=function(t){if(t.MoveOn.Identify||t.Selected.Identify)for(var e in this.SubFrame){var a=this.SubFrame[e];for(var i in a.OverlayIndex){var r=a.OverlayIndex[i];for(var n in r.ChartPaint){var s=r.ChartPaint[n];s.IsShow&&(s.Identify&&(s.Identify!=t.MoveOn.Identify&&s.Identify!=t.Selected.Identify||s.DrawSelectedStatus&&s.DrawSelectedStatus()))}}}},this.PtInOveralyChart=function(t,e){var a=null;for(var i in this.SubFrame){var r=this.SubFrame[i];for(var n in r.OverlayIndex){var s=r.OverlayIndex[n];for(var o in s.ChartPaint){var h=s.ChartPaint[o];if(h.IsShow&&(h.PtInChart&&(a=h.PtInChart(t,e),a)))return a}}}return null},this.DrawPictureCoordinate=function(t,e){if(t&&t.Frame&&ha.IsNonEmptyArray(t.Point)&&t.GetXYCoordinate){var a=t.GetXYCoordinate();t.Frame.DrawPictureYCoordinate(t,a,e);for(var i=0;i<this.SubFrame.length;++i){var r=this.SubFrame[i];if(r&&r.Frame&&r.Frame.XSplitOperator.ShowText){r.Frame.DrawPictureXCoordinate(t,a,e);break}}}},this.DrawLock=function(){for(var t in this.SubFrame){var e=this.SubFrame[t];e.Frame.DrawLock()}},this.DrawLogo=function(){for(var t=0;t<this.SubFrame.length;++t){var e=this.SubFrame[t];if(e.Frame.DrawLogo){e.Frame.DrawLogo();break}}},this.CalculateLock=function(){for(var t in this.SubFrame){var e=this.SubFrame[t];e.Frame.CalculateLock()}},this.DrawInsideHorizontal=function(){for(var t in this.SubFrame){var e=this.SubFrame[t];e.Frame.DrawInsideHorizontal&&e.Frame.DrawInsideHorizontal()}},this.DrawCustomHorizontal=function(){for(var t in this.SubFrame){var e=this.SubFrame[t];e.Frame.DrawCustomHorizontal&&e.Frame.DrawCustomHorizontal()}},this.DrawEx=function(t){for(var e in this.SubFrame){var a=this.SubFrame[e];"MinuteFrame"!=a.Frame.ClassName&&"MinuteHScreenFrame"!=a.Frame.ClassName||1!=e||a.Frame.DrawVolTitle(t.Symbol)}},this.DrawCustomVertical=function(t){for(var e=0;e<this.SubFrame.length;++e){var a=this.SubFrame[e];a.Frame.DrawCustomVerticalEvent=t,a.Frame.DrawCustomVertical&&a.Frame.DrawCustomVertical()}},this.DrawToolbar=function(t){var e=null;t&&t.MoveOnPoint&&(e=t.MoveOnPoint);for(var a=0;a<this.SubFrame.length;++a){var i=this.SubFrame[a],r=i.Frame;if(r){1==r.ToolbarButtonStyle&&r.DrawToolbarV2&&r.DrawToolbarV2(e);for(var n=0;n<i.OverlayIndex.length;++n){var s=i.OverlayIndex[n],o=s.Frame;o.DrawToolbar&&o.DrawToolbar(e,r.IsMinSize)}}}},this.SetSizeChage=function(t){for(var e in this.SizeChange=t,this.SubFrame){var a=this.SubFrame[e];for(var i in a.Frame.SizeChange=t,a.OverlayIndex){var r=a.OverlayIndex[i];r.Frame&&(r.Frame.SizeChange=t)}}this.ChartBorder.UIElement&&(this.Position={X:this.ChartBorder.UIElement.offsetLeft,Y:this.ChartBorder.UIElement.offsetTop,W:this.ChartBorder.UIElement.clientWidth,H:this.ChartBorder.UIElement.clientHeight})},this.SetBeforeDrawXYCallback=function(t){for(var e=0;e<this.SubFrame.length;++e){var a=this.SubFrame[e];a.Frame.BeforeDrawXYCallback=t}},this.Snapshot=function(){this.ScreenImageData=this.Canvas.getImageData(0,0,this.ChartBorder.GetChartWidth(),this.ChartBorder.GetChartHeight())},this.GetXData=function(t){return this.SubFrame[0].Frame.GetXData(t)},this.GetYData=function(t,e){for(var a,i=0;i<this.SubFrame.length;++i){var r=this.SubFrame[i],n=r.Frame.ChartBorder.GetLeft(),s=r.Frame.ChartBorder.GetTopEx(),o=r.Frame.ChartBorder.GetWidth(),h=r.Frame.ChartBorder.GetHeightEx();if(r.Frame.Canvas.beginPath(),r.Frame.Canvas.rect(n,s,o,h),r.Frame.Canvas.isPointInPath(n,t)){a=r.Frame,e&&(e.FrameID=i);break}}if(null!=a){a.RightFrame&&(e.RightYValue=a.RightFrame.GetYData(t));var l=a.GetYData(t);if(1==a.YSplitOperator.CoordinateType){var u=a.YSplitOperator.GetFirstOpenPrice();e.RightYValue=((l-u)/u*100).toFixed(2)+"%"}return l}},this.PtInFrame=function(t,e){for(var a=0;a<this.SubFrame.length;++a){var i=this.SubFrame[a],r=i.Frame.ChartBorder.GetLeft(),n=i.Frame.ChartBorder.GetTop(),s=i.Frame.ChartBorder.GetWidth(),o=i.Frame.ChartBorder.GetHeight();if(i.Frame.Canvas.beginPath(),i.Frame.Canvas.rect(r,n,s,o),i.Frame.Canvas.isPointInPath(t,e))return a}var h=this.ChartBorder.GetBottom(),l=this.ChartBorder.GetChartHeight(),u=(r=this.ChartBorder.GetLeft(),this.ChartBorder.GetRight());return t>=r&&t<=u&&e>h&&e<l?-3:-1},this.PtInChartFrame=function(t,e){for(var a=0;a<this.SubFrame.length;++a){var i=this.SubFrame[a],r=i.Frame.ChartBorder.GetLeft(),n=i.Frame.ChartBorder.GetTopEx(),s=i.Frame.ChartBorder.GetWidth(),o=i.Frame.ChartBorder.GetHeightEx();if(i.Frame.Canvas.beginPath(),i.Frame.Canvas.rect(r,n,s,o),i.Frame.Canvas.isPointInPath(t,e))return a}return-1},this.PtInButtons=function(t,e){for(var a=0;a<this.SubFrame.length;++a){var i=this.SubFrame[a],r=i.Frame.PtInButtons(t,e);if(r)return r.Frame=i.Frame,r;for(var n=0;n<i.OverlayIndex.length;++n){var s=i.OverlayIndex[n],o=s.Frame;if(o&&o.PtInButtons){r=o.PtInButtons(t,e);if(r)return r.IndexID=s.Identify,r.FrameID=a,r.OverlayFrame=o,r.Frame=i.Frame,r}}}return null},this.PtInFrameBottom=function(t,e){var a=this.ChartBorder.GetLeft(),i=this.ChartBorder.GetBottom(),r=this.ChartBorder.GetWidth(),n=this.ChartBorder.Bottom;return this.Canvas.beginPath(),this.Canvas.rect(a,i,r,n),!!this.Canvas.isPointInPath(t,e)},this.GetXFromIndex=function(t){return this.SubFrame[0].Frame.GetXFromIndex(t)},this.GetYFromData=function(t){return this.SubFrame[0].Frame.GetYFromData(t)},this.ZoomUp=function(t){var e=this.SubFrame[0].Frame.ZoomUp(t);return this.UpdateAllFrame(),e},this.ZoomDown=function(t){var e=this.SubFrame[0].Frame.ZoomDown(t);return this.UpdateAllFrame(),e},this.XCoordinateZoom=function(t,e){var a=this.SubFrame[0].Frame.XCoordinateZoom(t,e);return this.UpdateAllFrame(),a},this.ResetXYSplit=function(){for(var t in this.SubFrame)this.SubFrame[t].Frame.XYSplit=!0},this.SetLanguage=function(t){for(var e in this.SubFrame){var a=this.SubFrame[e];a&&a.Frame&&(a.Frame.YSplitOperator&&(a.Frame.YSplitOperator.LanguageID=t),a.Frame.XSplitOperator&&(a.Frame.XSplitOperator.LanguageID=t))}},this.GetCurrentPageSize=function(){if(this.SubFrame.length<=0)return null;var t=this.SubFrame[0];return t&&t.Frame?t.Frame.XPointCount:null},this.OnSize=function(){var t={};return this.SubFrame[0].Frame.OnSize(t),this.UpdateAllFrame(),t},this.SetDataWidth=function(t){var e=this.SubFrame[0].Frame.SetDataWidth(t);return this.UpdateAllFrame(),e},this.UpdateAllFrame=function(){for(var t=this.SubFrame[0].Frame,e=0;e<this.SubFrame.length;++e){var a=this.SubFrame[e];for(var i in e>0&&(a.Frame.XPointCount=t.XPointCount,a.Frame.ZoomIndex=t.ZoomIndex,a.Frame.DataWidth=t.DataWidth,a.Frame.DistanceWidth=t.DistanceWidth,a.Frame.LastCalculateStatus.Width=t.LastCalculateStatus.Width,a.Frame.LastCalculateStatus.XPointCount=t.LastCalculateStatus.XPointCount),a.OverlayIndex){var r=this.SubFrame[e].OverlayIndex[i];r.Frame.XPointCount=t.XPointCount,r.Frame.ZoomIndex=t.ZoomIndex,r.Frame.DataWidth=t.DataWidth,r.Frame.DistanceWidth=t.DistanceWidth,r.Frame.LastCalculateStatus.Width=t.LastCalculateStatus.Width,r.Frame.LastCalculateStatus.XPointCount=t.LastCalculateStatus.XPointCount}}},this.PtInFrameBorder=function(t,e){for(var a=this.DragBorderHeight,i=0;i<this.SubFrame.length-1;++i){var r=this.SubFrame[i];if(!(r.Frame.Heigh<=0)){var n=r.Frame.ChartBorder.GetBottom(),s=r.Frame.ChartBorder.GetLeft(),o=r.Frame.ChartBorder.GetRight();if(r.Frame.Canvas.beginPath(),r.Frame.Canvas.rect(s,n-a/2,o-s,a),r.Frame.Canvas.isPointInPath(t,e))return{Index:i,Bottom:!0}}}return null},this.IsEnableDragY=function(t){if(!this.SubFrame)return!1;var e=this.SubFrame[t];if(!e||!e.Frame||!e.Frame.YSplitOperator)return!1;var a=e.Frame.YSplitOperator;return"function"==typeof a.IsEnableDragY&&a.IsEnableDragY()},this.PtInFrameY=function(t,e){var a=0;if(this.GetExtendChartByClassName){var i=this.GetExtendChartByClassName("StockChip");i&&i.Chart&&(a=i.Chart.Width)}for(var r=0;r<this.SubFrame.length;++r){var n=this.SubFrame[r];if(!(n.Frame.Heigh<=0)){var s=n.Frame.ChartBorder.Right;s-=a;var o=n.Frame.ChartBorder.GetBorder(),h=o.Bottom,l=o.TopTitle,u=(o.Left,o.Right),C=30,D=h-l;if(D/3>C)var f=l+C,c=h-C;else{var d=D/3;f=l+d,c=h-d}var m=0;if(e<f?m=1:e>c&&(m=2),s>=10)if(ha.IsNonEmptyArray(n.OverlayIndex)){var v=n.OverlayIndex[0],S=v.Frame.RightOffset;if(n.Frame.Canvas.beginPath(),n.Frame.Canvas.rect(u,l,S,h-l),n.Frame.Canvas.isPointInPath(t,e))return{Index:r,Right:!0,Left:!1,Position:m,IsOverlay:!1};for(var I=u+S,p=0;p<n.OverlayIndex.length;++p){v=n.OverlayIndex[p];var T=v.RightWidth.Width;if(n.Frame.Canvas.beginPath(),n.Frame.Canvas.rect(I,l,T,h-l),n.Frame.Canvas.isPointInPath(t,e))return{Index:r,Right:!0,Left:!1,Position:m,IsOverlay:!0,OverlayIndex:p};I+=T}}else if(n.Frame.Canvas.beginPath(),n.Frame.Canvas.rect(u,l,s,h-l),n.Frame.Canvas.isPointInPath(t,e))return{Index:r,Right:!0,Left:!1,Position:m,IsOverlay:!1};var g=n.Frame.ChartBorder.Left;if(g>=10&&(n.Frame.Canvas.beginPath(),n.Frame.Canvas.rect(0,l,g,h-l),n.Frame.Canvas.isPointInPath(t,e)))return{Index:r,Right:!1,Left:!0,Position:m,IsOverlay:!1}}}return null},this.SetDayCount=function(t){this.ChartBorder.MultiDayMinute.Count=t;for(var e=0;e<this.SubFrame.length;++e){var a=this.SubFrame[e];a.Frame&&(a.Frame.DayCount=t,a.Frame.ChartBorder.MultiDayMinute.Count=t)}},this.SetMultiDayMinuteWidth=function(t){if(t){ha.IsNumber(t.Left)&&(this.ChartBorder.MultiDayMinute.Left=t.Left),ha.IsNumber(t.Right)&&(this.ChartBorder.MultiDayMinute.Right=t.Right);for(var e=0;e<this.SubFrame.length;++e){var a=this.SubFrame[e];a.Frame&&(ha.IsNumber(t.Left)&&(a.Frame.ChartBorder.MultiDayMinute.Left=t.Left),ha.IsNumber(t.Right)&&(a.Frame.ChartBorder.MultiDayMinute.Right=t.Right))}}}}function pt(){this.newMethod=It,this.newMethod(),delete this.newMethod,this.IsHScreen=!0,this.CalculateChartBorder=function(){if(!(this.SubFrame.length<=0)){var t=this.ChartBorder.GetHScreenBorder(),e=this.ChartBorder.Right,a=t.Right,i=t.Right-t.Left,r=0;for(var n in this.SubFrame){var s=this.SubFrame[n];r+=s.Height}for(var n in this.SubFrame){s=this.SubFrame[n];s.Frame.ChartBorder.Top=this.ChartBorder.Top,s.Frame.ChartBorder.Bottom=this.ChartBorder.Bottom;var o=i*(s.Height/r);s.Frame.ChartBorder.Right=e,s.Frame.ChartBorder.Left=a-o,e+=o,a-=o}}},this.GetYData=function(t,e){for(var a,i=0;i<this.SubFrame.length;++i){var r=this.SubFrame[i],n=r.Frame.ChartBorder.GetLeftEx(),s=r.Frame.ChartBorder.GetTop(),o=r.Frame.ChartBorder.GetWidthEx(),h=r.Frame.ChartBorder.GetHeight();if(r.Frame.Canvas.beginPath(),r.Frame.Canvas.rect(n,s,o,h),r.Frame.Canvas.isPointInPath(t,s)){a=r.Frame,e&&(e.FrameID=i);break}}if(null!=a)return a.GetYData(t)}}function Tt(){this.newMethod=ht,this.newMethod(),delete this.newMethod,this.ScreenImageData,this.Position,this.ClassName="DepthChartFrame",this.VerticalRange={Max:88,Min:8,Center:null,MaxDiffer:null,Differ:null,Step:.05},this.AskPrice,this.BidPrice,this.MinZoom=.05,this.SetPriceList=function(t,e){this.AskPrice=t,this.BidPrice=e},this.DrawFrame=function(){this.SplitXYCoordinate(),this.DrawHorizontal(),this.DrawVertical()},this.GetXFromIndex=function(t){var e=this.ChartBorder.GetLeft(),a=(this.ChartBorder.GetRight(),this.ChartBorder.GetWidth()),i=a*(t-this.VerticalRange.Min)/(this.VerticalRange.Max-this.VerticalRange.Min);return e+i},this.GetXData=function(t){var e=this.ChartBorder.GetLeft(),a=(this.ChartBorder.GetRight(),this.ChartBorder.GetWidth());return(t-e)/a*(this.VerticalRange.Max-this.VerticalRange.Min)+this.VerticalRange.Min},this.GetXFromPrice=function(t){var e=!1,a=this.GetPrice(this.BidPrice,t);if(null==a&&(a=this.GetPrice(this.AskPrice,t),e=!0),null==a&&this.BidPrice&&Array.isArray(this.BidPrice)&&this.BidPrice.length>0){var i=this.BidPrice[0];t<i&&(e=!1,a=i)}if(null==a&&this.AskPrice&&Array.isArray(this.AskPrice)&&this.AskPrice.length>0){var r=this.AskPrice[this.AskPrice.length-1];t>r&&(e=!0,a=r)}if(null==a)return null;var n=this.GetXFromIndex(a);return{X:n,Price:a,IsAsk:e}},this.GetPrice=function(t,e){if(!t||!Array.isArray(t)||t.length<=0)return null;if(e<t[0]||e>t[t.length-1])return null;var a=null;for(var i in t){var r=t[i];if(e==r)return r;if(e<r)return a;a=r}},this.SplitXYCoordinate=function(){0!=this.XYSplit&&(null!=this.YSplitOperator&&this.YSplitOperator.Operator(),null!=this.XSplitOperator&&this.XSplitOperator.Operator())},this.Snapshot=function(){this.ScreenImageData=this.Canvas.getImageData(0,0,this.ChartBorder.GetChartWidth(),this.ChartBorder.GetChartHeight())},this.SetSizeChage=function(t){this.SizeChange=t,this.Position={X:this.ChartBorder.UIElement.offsetLeft,Y:this.ChartBorder.UIElement.offsetTop,W:this.ChartBorder.UIElement.clientWidth,H:this.ChartBorder.UIElement.clientHeight}},this.PtInFrame=function(t,e){var a=this.ChartBorder.GetLeft(),i=this.ChartBorder.GetTop(),r=this.ChartBorder.GetWidth(),n=this.ChartBorder.GetHeight();return this.Canvas.beginPath(),this.Canvas.rect(a,i,r,n),this.Canvas.isPointInPath(t,e)?0:-1},this.PtInFrameBorder=function(t,e){return null},this.ZoomUp=function(){var t=this.VerticalRange,e=t.Differ,a=t.MaxDiffer*this.MinZoom;if(e<a)return!1;var i=t.Differ*t.Step;return e-=i,t.Differ=e,t.Min=t.Center-t.Differ,t.Max=t.Center+t.Differ,!0},this.ZoomDown=function(){var t=this.VerticalRange,e=t.Differ;if(e==t.MaxDiffer)return!1;var a=t.Differ*t.Step;return e+=a,e>t.MaxDiffer&&(e=t.MaxDiffer),t.Differ=e,t.Min=t.Center-t.Differ,t.Max=t.Center+t.Differ,!0}}function gt(){this.newMethod=ht,this.newMethod(),delete this.newMethod,this.ScreenImageData,this.Position,this.DrawFrame=function(){if(this.XPointCount>0){var t=this.ChartBorder.GetWidth()/(6*this.XPointCount);this.DistanceWidth=2*t,this.DataWidth=4*t}this.SplitXYCoordinate(),this.DrawHorizontal(),this.DrawVertical()},this.GetXFromIndex=function(t){t<0&&(t=0),t>this.xPointCount-1&&(t=this.xPointCount-1);for(var e=this.ChartBorder.GetLeft()+2+this.DistanceWidth/2+this.DataWidth/2,a=1;a<=t;++a)e+=this.DistanceWidth+this.DataWidth;return e},this.SplitXYCoordinate=function(){0!=this.XYSplit&&(null!=this.YSplitOperator&&this.YSplitOperator.Operator(),null!=this.XSplitOperator&&this.XSplitOperator.Operator())},this.Snapshot=function(){this.ScreenImageData=this.Canvas.getImageData(0,0,this.ChartBorder.GetChartWidth(),this.ChartBorder.GetChartHeight())},this.SetSizeChage=function(t){this.SizeChange=t,this.Position={X:this.ChartBorder.UIElement.offsetLeft,Y:this.ChartBorder.UIElement.offsetTop,W:this.ChartBorder.UIElement.clientWidth,H:this.ChartBorder.UIElement.clientHeight}},this.PtInFrame=function(t,e){var a=this.ChartBorder.GetLeft(),i=this.ChartBorder.GetTop(),r=this.ChartBorder.GetWidth(),n=this.ChartBorder.GetHeight();return this.Canvas.beginPath(),this.Canvas.rect(a,i,r,n),this.Canvas.isPointInPath(t,e)?0:-1},this.PtInFrameBorder=function(t,e){return null}}function xt(){this.Date,this.YClose,this.Open,this.Close,this.High,this.Low,this.Vol,this.Amount,this.Time,this.FlowCapital=null,this.Position=null,this.YFClose=null,this.FClose=null,this.Stop,this.Up,this.Down,this.Unchanged,this.ExtendData,this.BFactor,this.AFactor,this.OrderFlow,this.ColorData}function Ft(){this.Close,this.Open,this.High,this.Low,this.Vol,this.Amount,this.DateTime,this.Increase,this.Risefall,this.AvPrice,this.Lead=null,this.Time,this.Date,this.Position=null,this.YClearing,this.ExtendData}function yt(){this.Time,this.Date,this.Price,this.AvPrice,this.Vol=[],this.ColorID}function Lt(){this.Time,this.Date,this.Price,this.AvPrice,this.Vol=[],this.ColorID}function Et(){this.Date,this.Time,this.Value}Number.prototype.toFixed2=Number.prototype.toFixed,Number.prototype.toFixed=function(t){return z(this,t)},xt.Copy=function(t){var e=new xt;return e.Date=t.Date,ha.IsNumber(t.Time)&&(e.Time=t.Time),e.YClose=t.YClose,e.Open=t.Open,e.Close=t.Close,e.High=t.High,e.Low=t.Low,e.Vol=t.Vol,e.Amount=t.Amount,ha.IsNumber(t.FlowCapital)&&(e.FlowCapital=t.FlowCapital),ha.IsNumber(t.Position)&&(e.Position=t.Position),ha.IsNumber(t.YFClose)&&(e.YFClose=t.YFClose),ha.IsNumber(t.FClose)&&(e.FClose=t.FClose),ha.IsNumber(t.Stop)&&(e.Stop=t.Stop),ha.IsNumber(t.Up)&&(e.Up=t.Up),ha.IsNumber(t.Down)&&(e.Down=t.Down),ha.IsNumber(t.Unchanged)&&(e.Unchanged=t.Unchanged),ha.IsNumber(t.BFactor)&&(e.BFactor=t.BFactor),ha.IsNumber(t.AFactor)&&(e.AFactor=t.AFactor),t.OrderFlow&&(e.OrderFlow=t.OrderFlow),t.ColorData&&(e.ColorData=t.ColorData),e},xt.CopyTo=function(t,e){t.Date=e.Date,ha.IsNumber(e.Time)&&(t.Time=e.Time),t.YClose=e.YClose,t.Open=e.Open,t.Close=e.Close,t.High=e.High,t.Low=e.Low,t.Vol=e.Vol,t.Amount=e.Amount,ha.IsNumber(e.FlowCapital)&&(t.FlowCapital=e.FlowCapital),ha.IsNumber(e.Position)&&(t.Position=e.Position),ha.IsNumber(e.YFClose)&&(t.YFClose=e.YFClose),ha.IsNumber(e.FClose)&&(t.FClose=e.FClose),ha.IsNumber(e.Stop)&&(t.Stop=e.Stop),ha.IsNumber(e.Up)&&(t.Up=e.Up),ha.IsNumber(e.Down)&&(t.Down=e.Down),ha.IsNumber(e.Unchanged)&&(t.Unchanged=e.Unchanged),ha.IsNumber(e.BFactor)&&(t.BFactor=e.BFactor),ha.IsNumber(e.AFactor)&&(t.AFactor=e.AFactor),e.OrderFlow&&(t.OrderFlow=e.OrderFlow),e.ColorData&&(t.ColorData=e.ColorData)},xt.CopyRight=function(t,e){var a=new xt;return a.Date=t.Date,a.YClose=t.YClose*e,a.Open=t.Open*e,a.Close=t.Close*e,a.High=t.High*e,a.Low=t.Low*e,a.Vol=t.Vol,a.Amount=t.Amount,a.FlowCapital=t.FlowCapital,a.Position=t.Position,a.YFClose=t.YFClose,a.FClose=t.FClose,a};var Mt={INVESTOR:1,ANNOUNCEMENT:2,PFORECAST:3,ANNOUNCEMENT_QUARTER_1:4,ANNOUNCEMENT_QUARTER_2:5,ANNOUNCEMENT_QUARTER_3:6,ANNOUNCEMENT_QUARTER_4:7,RESEARCH:8,BLOCKTRADING:9,TRADEDETAIL:10,ANNOUNCEMENT_EX_START:100,ANNOUNCEMENT_EX_END:200};function At(){this.ID,this.Date,this.Title,this.InfoType,this.ExtendData}function Nt(){this.PeriodCallback=new E.default,this.GetPeriodCallback=function(t){return this.PeriodCallback.has(t)?this.PeriodCallback.get(t):null},this.AddPeriodCallback=function(t){if(ha.IsNumber(t.Period)&&t.Callback){var e={Period:t.Period,Callback:t.Callback};this.PeriodCallback.set(t.Period,e)}},this.RemovePeriodCallback=function(t){this.PeriodCallback.has(t.ID)&&this.PeriodCallback.delete(t.ID)}}Nt.GetMinutePeriodData=null;var wt=new Nt;function Ot(){this.Data=new Array,this.DataOffset=0,this.Period=0,this.Right=0,this.Symbol,this.Data2=new Array,this.GetCloseMA=function(t){for(var e=new Array,a=0,i=this.Data.length;a<i;a++)if(a<t)e[a]=null;else{for(var r=0,n=0;n<t;n++)r+=this.Data[a-n].Close;e[a]=r/t}return e},this.GetVolMA=function(t){for(var e=new Array,a=0,i=this.Data.length;a<i;a++)if(a<t)e[a]=null;else{for(var r=0,n=0;n<t;n++)r+=this.Data[a-n].Vol;e[a]=r/t}return e},this.GetAmountMA=function(t){for(var e=new Array,a=0,i=this.Data.length;a<i;a++)if(a<t)e[a]=null;else{for(var r=0,n=0;n<t;n++)r+=this.Data[a-n].Amount;e[a]=r/t}return e},this.GetClose=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Close;return t},this.GetYClose=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].YClose;return t},this.GetHigh=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].High;return t},this.GetLow=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Low;return t},this.GetOpen=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Open;return t},this.GetVol=function(t){var e=1;ha.IsNumber(t)&&(e=t);var a=new Array;for(var i in this.Data)a[i]=this.Data[i].Vol/e;return a},this.GetAmount=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Amount;return t},this.GetPosition=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Position;return t},this.GetSettlementPrice=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].FClose;return t},this.GetIsEqual=function(){var t=[];for(var e in this.Data){var a=this.Data[e];t[e]=a.Close==a.Open?1:0}return t},this.GetIsUp=function(){var t=[];for(var e in this.Data){var a=this.Data[e];t[e]=a.Close>a.Open?1:0}return t},this.GetIsDown=function(){var t=[];for(var e in this.Data){var a=this.Data[e];t[e]=a.Close<a.Open?1:0}return t},this.GetLead=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Lead;return t},this.GetDate=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Date;return t},this.GetTime=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].Time;return t},this.GetUp=function(){var t=[];for(var e in this.Data)t[e]=this.Data[e].Up;return t},this.GetDown=function(){var t=[];for(var e in this.Data)t[e]=this.Data[e].Down;return t},this.GetYear=function(){var t=new Array;for(var e in this.Data)t[e]=parseInt(this.Data[e].Date/1e4);return t},this.GetMonth=function(){var t=new Array;for(var e in this.Data)t[e]=parseInt(this.Data[e].Date%1e4/100);return t},this.GetAvPrice=function(){var t=new Array;for(var e in this.Data){var a=this.Data[e].AvPrice;ha.IsNumber(a)?t[e]=a:t[e]=0}return t},this.GetDateRange=function(){if(!this.Data||this.Data.length<=0)return null;var t=this.Data[0],e=this.Data[this.Data.length-1],a={Start:{Date:t.Date},End:{Date:e.Date}};return ha.IsNumber(t.Time)&&(a.Start.Time=t.Time),ha.IsNumber(e.Time)&&(a.End.Time=e.Time),a},this.GetDateList=function(){if(!this.Data||this.Data.length<=0)return null;for(var t=[],e=new I.default,a=0;a<this.Data.length;++a){var i=this.Data[a];ha.IsNumber(i.Date)&&(e.has(i.Date)||(e.add(i.Date),t.push(i.Date)))}return t},this.GetMinutePeriodData=function(t){if(Nt.GetMinutePeriodData)return Nt.GetMinutePeriodData(t,this.Data,this);var e=new Array,a=5;if(5==t)a=5;else if(6==t)a=15;else if(7==t)a=30;else if(8==t)a=60;else if(11==t)a=120;else{if(12!=t)return t>bt&&t<=Bt?(a=t-bt,this.GetMinuteCustomPeriodData(a)):this.Data;a=240}for(var i=!1,r=null,n=null,s=0;s<this.Data.length;){i=!0;for(var o=0;o<a&&s<this.Data.length;++s){i&&(r=new xt,e.push(r),i=!1);var h=this.Data[s];if(null!=h){if((925!=h.Time||null!=n&&924==n)&&(930!=h.Time||null!=n&&929==n)&&(1300!=h.Time||null!=n&&1259==n)&&++o,r.Date=h.Date,r.Time=h.Time,n=r.Time,null!=h.Open&&null!=h.Close&&(null==r.Open||null==r.Close?(r.Open=h.Open,r.High=h.High,r.Low=h.Low,r.YClose=h.YClose,r.Close=h.Close,r.Vol=h.Vol,r.Amount=h.Amount,r.FlowCapital=h.FlowCapital,r.Position=h.Position,r.YFClose=h.YFClose,r.FClose=h.FClose):(r.High<h.High&&(r.High=h.High),r.Low>h.Low&&(r.Low=h.Low),r.Close=h.Close,r.Vol+=h.Vol,null!=h.Amount&&(r.Amount+=h.Amount),r.Position=h.Position,r.FlowCapital=h.FlowCapital,r.FClose=h.FClose),s+1<this.Data.length)){var l=this.Data[s+1];if(l&&l.Date!=h.Date){++s;break}}}else++o}}return e},this.GetMinuteCustomPeriodData=function(t){for(var e=new Array,a=t,i=!1,r=null,n=0;n<this.Data.length;){i=!0;for(var s=0;s<a&&n<this.Data.length;++n,++s){i&&(r=new xt,e.push(r),i=!1);var o=this.Data[n];null!=o&&(r.Date=o.Date,r.Time=o.Time,null!=o.Open&&null!=o.Close&&(null==r.Open||null==r.Close?(r.Open=o.Open,r.High=o.High,r.Low=o.Low,r.YClose=o.YClose,r.Close=o.Close,r.Vol=o.Vol,r.Amount=o.Amount,r.FlowCapital=o.FlowCapital,r.Position=o.Position,r.YFClose=o.YFClose,r.FClose=o.FClose):(r.High<o.High&&(r.High=o.High),r.Low>o.Low&&(r.Low=o.Low),r.Close=o.Close,r.Vol+=o.Vol,null!=o.Amount&&(r.Amount+=o.Amount),r.Position=o.Position,r.FlowCapital=o.FlowCapital,r.FClose=o.FClose)))}}return e},this.GetDayPeriodData=function(t){if(t>Rt&&t<=Pt)return this.GetDayCustomPeriodData(t-Rt);var e=Br.IsBIT(this.Symbol),a=new Array,i=0,r=2,n=null;for(var s in this.Data){var o=!1,h=this.Data[s];switch(t){case 1:if(e)var l=Ot.GetSunday(h.Date);else l=Ot.GetFirday(h.Date);l!=i&&(o=!0,i=l);break;case 21:if(e)l=Ot.GetSunday(h.Date);else l=Ot.GetFirday(h.Date);l!=i&&(++r,r>=2&&(o=!0,r=0),i=l);break;case 2:parseInt(h.Date/100)!=parseInt(i/100)&&(o=!0,i=h.Date);break;case 3:parseInt(h.Date/1e4)!=parseInt(i/1e4)&&(o=!0,i=h.Date);break;case 22:var u=Ot.GetHalfYear(h.Date);u!=i&&(o=!0,i=u);break;case 9:var C=Ot.GetQuarter(h.Date);C=10*parseInt(h.Date/1e4)+C;var D=Ot.GetQuarter(i);D=10*parseInt(i/1e4)+D,C!=D&&(o=!0,i=h.Date);break}if(o){if(n=new xt,n.Date=h.Date,a.push(n),null==h.Open||null==h.Close)continue;n.Open=h.Open,n.High=h.High,n.Low=h.Low,n.YClose=h.YClose,n.Close=h.Close,n.Vol=h.Vol,n.Amount=h.Amount,n.FlowCapital=h.FlowCapital,n.Position=h.Position,n.YFClose=h.YFClose,n.FClose=h.FClose}else{if(null==n)continue;if(null==h.Open||null==h.Close)continue;null==n.Open||null==n.Close?(n.Open=h.Open,n.High=h.High,n.Low=h.Low,n.YClose=h.YClose,n.Close=h.Close,n.Vol=h.Vol,n.Amount=h.Amount,n.FlowCapital=h.FlowCapital,n.Position=h.Position,n.YFClose=h.YFClose,n.FClose=h.FClose):(n.High<h.High&&(n.High=h.High),n.Low>h.Low&&(n.Low=h.Low),n.Close=h.Close,n.Vol+=h.Vol,null!=h.Amount&&(n.Amount+=h.Amount),n.Position=h.Position,n.FlowCapital=h.FlowCapital,n.Date=h.Date,n.FClose=h.FClose)}}return a},this.GetDayCustomPeriodData=function(t){for(var e=[],a=t,i=!1,r=null,n=0;n<this.Data.length;){i=!0;for(var s=0;s<a&&n<this.Data.length;++n,++s){i&&(r=new xt,e.push(r),i=!1);var o=this.Data[n];null!=o&&(r.Date=o.Date,null!=o.Open&&null!=o.Close&&(null==r.Open||null==r.Close?(r.Open=o.Open,r.High=o.High,r.Low=o.Low,r.YClose=o.YClose,r.Close=o.Close,r.Vol=o.Vol,r.Amount=o.Amount,r.FlowCapital=o.FlowCapital,r.Position=o.Position,r.YFClose=o.YFClose,r.FClose=o.FClose):(r.High<o.High&&(r.High=o.High),r.Low>o.Low&&(r.Low=o.Low),r.Close=o.Close,r.Vol+=o.Vol,null!=o.Amount&&(r.Amount+=o.Amount),r.Position=o.Position,r.FlowCapital=o.FlowCapital,r.FClose=o.FClose)))}}return e},this.GetPeriodData=function(t){var e=wt.GetPeriodCallback(t);if(e)return e.Callback(t,this.Data,this);if(Br.IsBIT(this.Symbol)&&(5==t||6==t||7==t||8==t||t>bt&&t<=Bt)){var a=5;return 5==t?a=5:6==t?a=15:7==t?a=30:8==t?a=60:11==t?a=120:12==t?a=240:t>bt&&t<=Bt&&(a=t-bt),this.GetMinuteCustomPeriodData(a)}return Ot.IsDayPeriod(t,!1)?this.GetDayPeriodData(t):Ot.IsMinutePeriod(t,!1)?this.GetMinutePeriodData(t):void 0},this.GetRightData=function(t,e){var a=[];if(this.Data.length<=0)return a;if(e&&1==e.AlgorithmType){for(var i=0;i<this.Data.length;++i){var r=this.Data[i],n=1==t?r.BFactor:r.AFactor;a[i]=xt.CopyRight(r,n)}return a}if(1==t){var s=this.Data.length-1,o=(n=1,this.Data[s].YClose);for(a[s]=xt.Copy(this.Data[s]),--s;s>=0;--s){if(o!=this.Data[s].Close)break;a[s]=xt.Copy(this.Data[s]),o=this.Data[s].YClose}for(;s>=0;--s){var h=this.Data[s].Close;o!=h&&0!=h&&(n*=o/h),a[s]=xt.CopyRight(this.Data[s],n),o=this.Data[s].YClose}}else if(2==t){s=0,n=1;var l=this.Data[s].Close;for(a[s]=xt.Copy(this.Data[s]),++s;s<this.Data.length;++s){if(l!=this.Data[s].YClose)break;a[s]=xt.Copy(this.Data[s]),l=this.Data[s].Close}for(;s<this.Data.length;++s)l!=this.Data[s].YClose&&(n*=l/this.Data[s].YClose),a[s]=xt.CopyRight(this.Data[s],n),l=this.Data[s].Close}return a},this.GetRightDate=this.GetRightData,this.GetOverlayData=function(t,e){for(var a=[],i=0,r=0;i<this.Data.length;){var n=this.Data[i].Date;if(r>=t.length)a[i]=new xt,a[i].Date=n,++i;else{var s=t[r].Date;s==n?(a[i]=new xt,a[i].Date=t[r].Date,a[i].YClose=t[r].YClose,a[i].Open=t[r].Open,a[i].High=t[r].High,a[i].Low=t[r].Low,a[i].Close=t[r].Close,a[i].Vol=t[r].Vol,a[i].Amount=t[r].Amount,a[i].Stop=t[r].Stop,a[i].Up=t[r].Up,a[i].Down=t[r].Down,a[i].Unchanged=t[r].Unchanged,++r,++i):s<n?++r:(a[i]=new xt,a[i].Date=n,++i)}}return a},this.GetOverlayMinuteData=function(t,e){for(var a=[],i=0,r=0;i<this.Data.length;){var n=this.Data[i].Date,s=this.Data[i].Time;if(r>=t.length)a[i]=new xt,a[i].Date=n,a[i].Time=s,++i;else{var o=t[r].Date,h=t[r].Time;o==n&&h==s?(a[i]=new xt,a[i].Date=t[r].Date,a[i].Time=t[r].Time,a[i].YClose=t[r].YClose,a[i].Open=t[r].Open,a[i].High=t[r].High,a[i].Low=t[r].Low,a[i].Close=t[r].Close,a[i].Vol=t[r].Vol,a[i].Amount=t[r].Amount,a[i].Stop=t[r].Stop,a[i].Up=t[r].Up,a[i].Down=t[r].Down,a[i].Unchanged=t[r].Unchanged,++r,++i):o<n||o==n&&h<s?++r:(a[i]=new xt,a[i].Date=n,a[i].Time=s,++i)}}return a},this.GetFittingData=function(t){for(var e=new Array,a=0,i=0;a<this.Data.length;){var r=this.Data[a].Date;if(i>=t.length)e[a]=null,++a;else{var n=t[i].Date;if(n==r){var s=new Et;s.Date=t[i].Date,s.Value=t[i].Value,e[a]=s,++i,++a}else n<r?++i:(e[a]=new Et,e[a].Date=r,++a)}}return e},this.GetFittingData2=function(t,e){for(var a=new Array,i=0,r=0;i<this.Data.length;){var n=this.Data[i].Date;if(r>=t.length)a[i]=new Et,a[i].Date=n,a[i].Value=e,++i;else{var s=t[r].Date;if(s==n){var o=new Et;o.Date=t[r].Date,o.Value=t[r].Value,a[i]=o,++r,++i}else s<n?++r:(a[i]=new Et,a[i].Date=n,a[i].Value=e,++i)}}return a},this.GetDateIndex=function(t){for(var e=0,a=0;e<this.Data.length;){var i=this.Data[e].Date;if(a>=t.length)break;var r=t[a];r.Date==i?(r.Index=e,++a):r.Date<i?++a:++e}},this.GetDateTimeIndex=function(t){for(var e=0,a=0;e<this.Data.length;){var i=this.Data[e].Date,r=this.Data[e].Time;if(a>=t.length)break;var n=t[a];n.Date==i&&n.Time==r?(n.Index=e,++a):n.Date<i||n.Date==i&&n.Time<r?++a:++e}},this.GetMinuteFittingData=function(t){for(var e=[],a=0,i=0;a<this.Data.length;){var r=this.Data[a].Date,n=this.Data[a].Time;if(i>=t.length)e[a]=null,++a;else{var s=t[i].Date,o=t[i].Time,h=t[i];if(s==r&&o==n){var l=new Et;l.Date=h.Date,l.Time=h.Time,l.Value=h.Value,e[a]=l,++i,++a}else if(s<r||s==r&&o<n)++i;else{l=new Et;l.Date=r,l.Time=n,e[a]=l,++a}}}return e},this.GetFittingFinanceData=function(t){for(var e=[],a=0,i=0;a<this.Data.length;){var r=this.Data[a].Date;if(i<t.length){var n=t[i].Date;if(r<n){++a;continue}}if(i+1<t.length&&t[i].Date<r&&t[i+1].Date<=r)++i;else{var s=new Et;s.Date=r,i<t.length?(s.Value=t[i].Value,s.FinanceDate=t[i].Date):(s.Value=null,s.FinanceDate=null),e[a]=s,++a}}return e},this.GetMinuteFittingFinanceData=function(t){var e=[];if(!Array.isArray(t)||t.length<=0)return e;var a=0,i=t[0];for(a=0;a<this.Data.length;++a){var r=this.Data[a].Date,n=this.Data[a].Time;if(r>i.Date||r==i.Date&&n>=i.Time)break}for(var s=0;a<this.Data.length;){r=this.Data[a].Date,n=this.Data[a].Time;if(s+1<t.length&&(t[s].Date<r&&t[s+1].Date<=r||t[s].Date==r&&t[s].Time<n&&t[s+1].Time<=n))++s;else{var o=new Et;o.Date=r,o.Time=n,s<t.length?(o.Value=t[s].Value,o.FinanceDate=t[s].Date,o.FinanceTime=t[s].Time):(o.Value=null,o.FinanceDate=null,o.FinanceTime=null),e[a]=o,++a}}return e},this.GetFittingTradeData=function(t,e,a){for(var i=[],r=!1,n=0,s=0;n<this.Data.length;){var o=this.Data[n].Date;if(s<t.length&&t[s].Date>o){var h=new Et;h.Date=o,h.Value=e,i[n]=h,++n}else if(s+1<t.length&&t[s].Date<o&&t[s+1].Date<=o)++s,r=!1;else{h=new Et;if(h.Date=o,h.Value=e,h.FinanceDate=null,s<t.length){var l=t[s];0==this.Period&&!0===a?l.Date==h.Date&&(h.Value=l.Value,h.FinanceDate=l.Date,r=!0):0==r&&(h.Value=l.Value,h.FinanceDate=l.Date,r=!0)}i[n]=h,++n}}return i},this.GetMinuteFittingTradeData=function(t,e,a){for(var i=[],r=!1,n=0,s=0;n<this.Data.length;){var o=this.Data[n].Date,h=this.Data[n].Time;if(s<t.length&&(t[s].Date>o||t[s].Date==o&&t[s].Time>h)){var l=new Et;l.Date=o,l.Time=h,l.Value=e,i[n]=l,++n}else if(s+1<t.length&&(t[s].Date<o&&t[s+1].Date<=o||t[s].Date==o&&t[s].Time<h&&t[s+1].Time<=h))++s,r=!1;else{l=new Et;if(l.Date=o,l.FinanceDate=null,l.Time=h,l.Value=e,s<t.length){var u=t[s];4==this.Period&&!0===a?u.Date==l.Date&&u.Time==l.Time&&(l.Value=u.Value,l.FinanceDate=u.Date,l.FinanceTime=u.Time,r=!0):0==r&&(l.Value=u.Value,l.FinanceDate=u.Date,l.FinanceTime=u.Time,r=!0)}i[n]=l,++n}}return i},this.GetFittingMarketValueData=function(t){for(var e=[],a=0,i=0;a<this.Data.length;){var r=this.Data[a].Date,n=this.Data[a].Close;if(i+1<t.length&&t[i].Date<r&&t[i+1].Date<=r)++i;else{var s=new Et;s.Date=r,s.Value=t[i].Value*n,s.FinanceDate=t[i].Date,e[a]=s,++a}}return e},this.GetFittingMonthData=function(t){for(var e=new Array,a=null,i=0,r=0;i<this.Data.length;){var n=this.Data[i].Date;if(r>=t.length)e[i]=null,++i;else{var s=t[r].Date;if(s==n){var o=new Et;o.Date=t[r].Date,o.Value=t[r].Value,o.Text=t[r].Text,e[i]=o,++r,++i}else if(null!=a&&a<s&&n>s){o=new Et;o.Date=n,o.OverlayDate=t[r].Date,o.Value=t[r].Value,o.Text=t[r].Text,e[i]=o,++r,++i}else s<n?++r:(e[i]=new Et,e[i].Date=n,++i);a=n}}return e},this.GetValue=function(){var t=[];for(var e in this.Data)if(this.Data[e]&&null!=this.Data[e].Value){var a=this.Data[e].Value;isNaN(a)?t[e]=a instanceof Array?a:null:t[e]=a}else t[e]=null;return t},this.GetObject=function(){var t=[];for(var e in this.Data)if(this.Data[e]&&this.Data[e].Value){var a=this.Data[e].Value;t[e]=a}else t[e]=null;return t},this.GetPeriodSingleData=function(t){var e=new Array,a=0,i=2,r=null;for(var n in this.Data){var s=!1,o=this.Data[n];if(null!=o&&null!=o.Date){switch(t){case 1:var h=Ot.GetFirday(o.Date);h!=a&&(s=!0,a=h);break;case 21:h=Ot.GetFirday(o.Date);h!=a&&(++i,i>=2&&(s=!0,i=0),a=h);break;case 2:parseInt(o.Date/100)!=parseInt(a/100)&&(s=!0,a=o.Date);break;case 3:parseInt(o.Date/1e4)!=parseInt(a/1e4)&&(s=!0,a=o.Date);break;case 9:var l=Ot.GetQuarter(o.Date);l=10*parseInt(o.Date/1e4)+l;var u=Ot.GetQuarter(a);u=10*parseInt(a/1e4)+u,l!=u&&(s=!0,a=o.Date);break}if(s)r=new Et,r.Date=o.Date,r.Value=o.Value,e.push(r);else{if(null==r)continue;if(null==o.Value||isNaN(o.Value))continue;(null==r.Value||isNaN(r.Value))&&(r.Value=o.Value)}}}return e},this.GetMinuteAvPrice=function(){var t=new Array;for(var e in this.Data)t[e]=this.Data[e].AvPrice;return t},this.MergeMinuteData=function(t){if(!this.Data||this.Data.length<=0)return this.Data=t,!0;for(var e=this.Data[0],a=0,i=null,r=0;r<t.length;++r){var n=t[r];if(n.Date>e.Date){a=r,i=n;break}if(n.Date==e.Date&&n.Time>=e.Time){a=r,i=n;break}}if(null==i)return!1;var s=null,o=!1;for(r=this.Data.length-1;r>=0;--r){var h=this.Data[r].Date,l=this.Data[r].Time;if(i.Date>h||i.Date==h&&i.Time>=l){s=r,i.Date==h&&i.Time==l&&(o=!0);break}}if(null==s)return!1;var u=s;r=a;if(1==o){n=t[r];if(u-1>0){var C=this.Data[u-1];n.YClose||(n.YClose=C.Close),!ha.IsNumber(n.FlowCapital)&&ha.IsNumber(C.FlowCapital)&&(n.FlowCapital=C.FlowCapital)}var D=xt.Copy(n);this.Data[u]=D,++u,++r}else++u;for(;r<t.length;){n=t[r];if(u>=this.Data.length-1){if(u-1>0){C=this.Data[u-1];n.YClose||(n.YClose=C.Close),!ha.IsNumber(n.FlowCapital)&&ha.IsNumber(C.FlowCapital)&&(n.FlowCapital=C.FlowCapital)}D=xt.Copy(n);this.Data[u]=D,++u,++r}else{var f=this.Data[u];f.Date==n.Date&&f.Time==n.Time?(xt.CopyTo(f,n),++u,++r):++u}}return!0},this.ConverPeriod=function(t,e,a){for(var i=[],r=null,n=Ot.IsMinutePeriod(e,!0),s=Ot.IsMinutePeriod(a,!0),o=n&&s,h=n&&!s,l=!n&&!s,u=0,C=0;u<this.Data.length;++u){for(var D=this.Data[u];C<t.length;++C){var f=t[C];if(o){if(f.Date>D.Date||f.Date==D.Date&&f.Time>=D.Time){r=f;break}}else if((h||l)&&f.Date>=D.Date){r=f;break}}var c=null;r?(c=xt.Copy(r),c.PDate=r.Date,c.PTime=r.Time):c=new xt,c.Date=D.Date,(o||h)&&(c.Time=D.Time),i.push(c)}return w.Chart.Log("[ChartData::ConverPeriod] result",i),i},this.GetRef=function(t){for(var e=[],a=0;a<this.Data.length;++a){e[a]=null;var i=this.Data[a];if(a-t<0){var r=new xt;r.Date=i.Date,r.Time=i.Time,e[a]=r}else{var n=this.Data[a-t];r=xt.Copy(n);r.Date=i.Date,r.Time=i.Time,e[a]=r}}return e},this.FitKLineIndex=function(t,e,a,i){for(var r=this.Data.length,n=t.length,s=[Ot.IsMinutePeriod(a,!0),Ot.IsMinutePeriod(i,!0)],o=[Ot.IsDayPeriod(a,!0),Ot.IsDayPeriod(i,!0)],h=Ot.GetKLineDataTime(this.Data[0]),l=[],u=n,C=0;C<n;++C){var D=Ot.GetKLineDataTime(t[C]);if(o[0]&&o[1]||s[0]&&o[1]){if(D.Date>=h.Date){u=C;break}}else if(s[0]&&s[1]){if(D.Date>h.Date){u=C;break}if(D.Date==h.Date&&D.Time>=h.Time){u=C;break}}}C=0;for(var f=u;C<r;){D=Ot.GetKLineDataTime(this.Data[C]);if(f>=n){var c={Date:D.Date,Time:D.Time,Index:-1};l[C]=c,++C}else{var d=Ot.GetKLineDataTime(t[f]);if(o[0]&&o[1]||s[0]&&o[1])if(d.Date==D.Date){c={Date:D.Date,Time:D.Time,Index:f,Data2:d.Date,Time2:d.Time};l[C]=c,++C}else if(f+1<n){var m=Ot.GetKLineDataTime(t[f+1]);if(d.Date<=D.Date&&m.Date>D.Date){c={Date:D.Date,Time:D.Time,Index:f+1,Data2:m.Date,Time2:m.Time};l[C]=c,++C}else if(m.Date<=D.Date)++f;else{c={Date:D.Date,Time:D.Time,Index:-1};l[C]=c,++C}}else++f;else if(s[0]&&s[1])if(d.Date==D.Date&&d.Time==D.Time){c={Date:D.Date,Time:D.Time,Index:f,Data2:d.Date,Time2:d.Time};l[C]=c,++C}else if(f+1<n){m=Ot.GetKLineDataTime(t[f+1]);if(d.Date<D.Date&&m.Date>D.Date||d.Date==D.Date&&d.Time<D.Time&&m.Date==D.Date&&m.Time>D.Time||d.Date==D.Date&&d.Time<D.Time&&m.Date>D.Date||d.Date<D.Date&&m.Date==D.Date&&m.Time>D.Time){c={Date:D.Date,Time:D.Time,Index:f+1,Data2:m.Date,Time2:m.Time};l[C]=c,++C}else if(m.Date<D.Date||m.Date==D.Date&&m.Time<=D.Time)++f;else{c={Date:D.Date,Time:D.Time,Index:-1};l[C]=c,++C}}else++f}}var v=[];for(var C in e){D=e[C];if(Array.isArray(D.Data)){var S=[];v[C]={Data:S,Name:D.Name};for(f=0;f<l.length;++f){var I=l[f];S[f]=null,I&&I.Index>=0&&I.Index<D.Data.length&&(S[f]=D.Data[I.Index])}}else v[C]={Data:D.Data,Name:D.Name}}return v},this.FindDataIndexByDateTime=function(t){var e=0;for(var a in t)t[a].Index=-1;for(var a in this.Data){var i=this.Data[a];for(var r in t){var n=t[r];if(!(n.Index>=0)){if(ha.IsNumber(n.Time)){if(n.Date==i.Date&&n.Time==i.Time){n.Index=parseInt(a),++e;break}}else if(n.Date==i.Date){n.Index=parseInt(a),++e;break}if(e>=t.length)break}}}},this.CloneData=function(t){var e=[];if("HistoryData"==t)for(var a in this.Data){var i=this.Data[a],r=xt.Copy(i);e.push(r)}return e},this.GetAPIDataIndex=function(t,e){var a=[];if(t&&e){for(var i=this.Data.length,r=t.length,n=Ot.GetKLineDataTime(this.Data[0]),s=r,o=(s=r,0);o<r;++o){var h=t[o],l=e[o];if(h>n.Date||h==n.Date&&l>=n.Time){s=o;break}}o=0;for(var u=s;o<i;){var C=this.Data[o];if(u>=r){var D={KDate:C.Date,KTime:C.Time,KIndex:o,Index:-1};a[o]=D,++o}else{h=t[u],l=e[u];if(h==C.Date&&l==C.Time){D={KDate:C.Date,KTime:C.Time,KIndex:o,Index:u,Data:h,Time:l};a[o]=D,++o}else if(u+1<r){var f=t[u+1],c=e[u+1];if(h<C.Date&&f>C.Date||h==C.Date&&l<C.Time&&f==C.Date&&c>C.Time||h==C.Date&&l<C.Time&&f>C.Date||h<C.Date&&f==C.Date&&c>C.Time){D={KDate:C.Date,KTime:C.Time,KIndex:o,Index:u,Data:h,Time:l};a[o]=D,++o}else if(f<C.Date||f==C.Date&&c<=C.Time)++u;else{D={KDate:C.Date,KTime:C.Time,KIndex:o,Index:-1};a[o]=D,++o}}else++u}}}else if(t){for(i=this.Data.length,r=t.length,n=Ot.GetKLineDataTime(this.Data[0]),s=r,o=0;o<r;++o){C=t[o];if(C>=n.Date){s=o;break}}for(o=0,u=s;o<i;){C=this.Data[o];if(u>=r){D={KDate:C.Date,KIndex:o,Index:-1};a[o]=D,++o}else{var d=t[u];if(d==C.Date){D={KDate:C.Date,KIndex:o,Index:u,Data:d};a[o]=D,++o}else if(u+1<r){var m=t[u+1];if(d<=C.Date&&m>C.Date){D={KDate:C.Date,KIndex:o,Index:u,Data:d};a[o]=D,++o}else if(m<=C.Date)++u;else{D={KDate:C.Date,KIndex:o,Index:-1};a[o]=D,++o}}else++u}}}return a},this.FixKData=function(t,e){return Ot.IsDayPeriod(e,!0)?this.FixKData_Day(t):Ot.IsMinutePeriod(e,!0)?this.FixKData_Minute(t):null},this.FixKData_Day=function(t){for(var e=[],a=t.length,i=0,r=0;i<this.Data.length;){var n=this.Data[i];if(r<a){var s=t[r];if(s.Date>n.Date){++i;continue}}if(r+1<a){s=t[r];var o=t[r+1];if(s.Date<n.Date&&o.Date<=n.Date){++r;continue}}var h=new xt;h.Date=n.Date;var l=r<a?r:a-1;s=t[l];h.Close=s.Close,h.High=s.High,h.Low=s.Low,h.Open=s.Open,h.YClose=s.YClose,h.Amount=s.Amount,h.Vol=s.Vol,h.ExDate=s.Date,e[i]=h,++i}return e},this.FixKData_Minute=function(t){for(var e=[],a=t.length,i=0,r=0;i<this.Data.length;){var n=this.Data[i],s=Ot.DateTimeToNumber(n);if(r<a){var o=t[r],h=Ot.DateTimeToNumber(o);if(h>s){++i;continue}}if(r+1<a){o=t[r];var l=t[r+1],u=(h=Ot.DateTimeToNumber(o),Ot.DateTimeToNumber(l));if(h<s&&u<=s){++r;continue}}var C=new xt;C.Date=n.Date,C.Time=n.Time;var D=r<a?r:a-1;o=t[D];C.Close=o.Close,C.High=o.High,C.Low=o.Low,C.Open=o.Open,C.YClose=o.YClose,C.Amount=o.Amount,C.Vol=o.Vol,C.ExDate=o.Date,C.ExTime=o.Time,e[i]=C,++i}return e}}Ot.DateTimeToNumber=function(t){return 1e4*t.Date+t.Time},Ot.GetKLineDataTime=function(t){var e={Date:t.Date,Time:0};return ha.IsNumber(t.Time)&&(e.Time=t.Time),e},Ot.GetFirday=function(t){var e=new Date(parseInt(t/1e4),t/100%100-1,t%100),a=e.getDay();if(5==a)return t;var i=e.getTime();if(a<5){var r=864e5*(5-a);i+=r}else{r=864e5*(a-5);i-=r}e.setTime(i);var n=1e4*e.getFullYear()+100*(e.getMonth()+1)+e.getDate();e.getDay();return n},Ot.GetSunday=function(t){var e=new Date(parseInt(t/1e4),t/100%100-1,t%100),a=e.getDay();if(0==a)return t;var i=e.getTime();if(a>0){var r=864e5*(7-a);i+=r}e.setTime(i);var n=1e4*e.getFullYear()+100*(e.getMonth()+1)+e.getDate();e.getDay();return n},Ot.GetQuarter=function(t){var e=parseInt(t%1e4/100);return 1==e||2==e||3==e?1:4==e||5==e||6==e?2:7==e||8==e||9==e?3:10==e||11==e||12==e?4:0},Ot.GetHalfYear=function(t){var e=parseInt(t/1e4),a=t%1e4;return a<=630?1e4*e+630:1e4*e+1231};var Rt=4e4,Pt=49999;Ot.IsDayPeriod=function(t,e){return 1==t||2==t||3==t||9==t||21==t||22==t||(t>Rt&&t<=Pt||0==t&&1==e)};var bt=2e4,Bt=29999;Ot.IsMinutePeriod=function(t,e){return 5==t||6==t||7==t||8==t||11==t||12==t||(t>bt&&t<=Bt||4==t&&1==e)};var Vt=3e4,Gt=32e3;function Ht(){this.ChartPaint,this.Data,this.Type=0}function Yt(t,e,a,i){this.X=t,this.Y=e,this.Width=a,this.Height=i}function kt(){this.DataMap=new E.default([["ChartKLine",{Create:function(t){return new Ut}}]]),this.Create=function(t,e){if(!this.DataMap.has(t))return w.Warn("[ChartPaintFactory::Create] can't find class="+t+"."),null;var a=this.DataMap.get(t);return a.Create(e)},this.Add=function(t,e){this.DataMap.set(t,{Create:e.Create})}}Ot.IsSecondPeriod=function(t){return t>Vt&&t<=Gt},Ot.IsTickPeriod=function(t){return 10==t},Ot.GetPeriodName=function(t){var e=new E.default([[0,"æ¥çº¿"],[1,"å¨çº¿"],[2,"æçº¿"],[3,"å¹´çº¿"],[9,"å­£çº¿"],[21,"åå¨"],[22,"åå¹´"],[4,"1å"],[5,"5å"],[6,"15å"],[7,"30å"],[8,"60å"],[11,"2å°æ¶"],[12,"4å°æ¶"],[10,"åç¬"]]);return e.has(t)?e.get(t):""};var _t=new kt;function Xt(){this.Canvas,this.ChartBorder,this.ChartFrame,this.Name,this.ClassName="IChartPainting",this.Data=new Ot,this.NotSupportMessage=null,this.MessageFont=Oi.Index.NotSupport.Font,this.MessageColor=Oi.Index.NotSupport.TextColor,this.IsDrawFirst=!1,this.IsShow=!0,this.GetEventCallback,this.SelectedLineWidth=Oi.SelectedChart.LineWidth,this.SelectedLineColor=Oi.SelectedChart.LineColor,this.SelectedRadius=Oi.SelectedChart.Radius,this.SelectedPointMinSpace=Oi.SelectedChart.MinSpace,this.SelectedBGColor=Oi.SelectedChart.BGColor,this.DrawSelectedStatus,this.PtInChart,this.Draw=function(){},this.GetBorder=function(){return this.ChartFrame.IsHScreen?this.ChartBorder.GetHScreenBorder():this.ChartBorder.GetBorder()},this.ClipClient=function(t){if(1==t)var e=this.ChartBorder.GetLeftEx(),a=this.ChartBorder.GetRightEx(),i=this.ChartBorder.GetTop(),r=this.ChartBorder.GetBottom();else e=this.ChartBorder.GetLeft(),a=this.ChartBorder.GetRight(),i=this.ChartBorder.GetTopEx(),r=this.ChartBorder.GetBottomEx();this.Canvas.beginPath(),this.Canvas.rect(e,i,a-e,r-i),this.Canvas.clip()},this.GetYFromData=function(t,e){return this.ChartFrame.GetYFromData(t,e)},this.IsMinuteFrame=function(){var t="MinuteFrame"==this.ChartFrame.ClassName||"MinuteHScreenFrame"==this.ChartFrame.ClassName||"OverlayMinuteFrame"==this.ChartFrame.ClassName||"OverlayMinuteHScreenFrame"==this.ChartFrame.ClassName;return t},this.DrawNotSupportmessage=function(){this.Canvas.font=this.MessageFont,this.Canvas.fillStyle=this.MessageColor;var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetWidth(),a=this.ChartBorder.GetTopEx(),i=this.ChartBorder.GetHeightEx(),r=t+e/2,n=a+i/2;this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillText(this.NotSupportMessage,r,n)},this.GetTooltipData=function(t,e,a){return!1},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e=this.Data.DataOffset;this.ChartFrame.GlobalOption&&this.ChartFrame.GlobalOption.IsValueFullRange&&(e=0,t=this.Data.Data.length);var a={Min:null,Max:null};if(!this.Data||!this.Data.Data)return a;for(var i=e,r=0;i<this.Data.Data.length&&r<t;++i,++r){var n=this.Data.Data[i];null==n||isNaN(n)||(null==a.Max&&(a.Max=n),null==a.Min&&(a.Min=n),a.Max<n&&(a.Max=n),a.Min>n&&(a.Min=n))}return a},this.GetDynamicFont=function(t,e,a,i,r,n){var s=U();if(a*=s,i*=s,a==i){var o=a.toFixed(0)+"px "+n;return o}var h=t+e;r&&(0==r.Type?r.Value>0&&(h=t*r.Value):1==r.Type?r.Value>0&&(h=(t+e)*r.Value):2==r.Type&&ha.IsNumber(r.Value)&&(h=t+e+2*r.Value*s)),h<i?h=i:h>a&&(h=a);o=h.toFixed(0)+"px "+n;return o},this.GetLockRect=function(){return this.ChartFrame.GetLockRect()},this.SetFillStyle=function(t,e,a,i,r){if(Array.isArray(t)){var n=this.Canvas.createLinearGradient(e,a,i,r),s=1/t.length;for(var o in t)n.addColorStop(o*s,t[o]);this.Canvas.fillStyle=n}else this.Canvas.fillStyle=t},this.GetDynamicIconSize=function(t,e,a,i,r){var n=U();if(a*=n,i*=n,a==i)return a;var s=t+e-2*n;return r&&(0==r.Type?r.Value>0&&(s=t*r.Value):1==r.Type?r.Value>0&&(s=(t+e)*r.Value):2==r.Type&&ha.IsNumber(r.Value)&&(s=t+e+2*r.Value*n)),s<i?s=i:s>a&&(s=a),s},this.GetFontHeight=function(t){return K(this.Canvas,t,"æ")},this.DrawLinePoint=function(t){var e=!0===this.ChartFrame.IsHScreen;if(!e&&this.IsShow){var a=this.IsMinuteFrame(),i=this.ChartFrame.DataWidth,r=this.ChartFrame.DistanceWidth,n=this.ChartFrame.XPointCount;if(e)var s=this.ChartBorder.GetHScreenBorder(),o=s.BottomEx,h=s.TopEx+r/2+Oi.FrameLeftMargin;else s=this.ChartBorder.GetBorder(),h=s.LeftEx+r/2+Oi.FrameLeftMargin,o=s.RightEx;var l=this.GetLockRect();l&&(o=e?l.Top:l.Left);var u=U();this.Canvas.save(),this.ClipClient(e),this.Canvas.lineWidth=this.SelectedLineWidth*u,this.Canvas.strokeStyle=this.SelectedLineColor,this.SelectedBGColor&&(this.Canvas.fillStyle=this.SelectedBGColor);var C=this.SelectedRadius,D=Math.ceil(this.SelectedPointMinSpace/(i+r));if(D<=0&&(D=1),a){var f=(s.Right-s.Left)/n;D=Math.ceil(this.SelectedPointMinSpace/f)}var c=0,d=null,m=null;t&&(t.KLineClose?c=1:t.MinuteVolBar?c=2:t.MinuteOverlayPrice?c=3:t.OverlayKLine?(c=4,d=this.GetFirstOpen()):t.StackedBar&&(c=5));for(var v=this.Data.DataOffset,S=0,I=0;v<this.Data.Data.length&&S<n;++v,++S,++I,h+=i+r){var p=null;if(1==c){var T=this.Data.Data[v];ha.IsNumber(T.Close)&&(p=T.Close)}else if(2==c){T=this.Data.Data[v];ha.IsNumber(T.Vol)&&(p=T.Vol)}else if(3==c){var g=this.Data.Data[v].Close;if(null==g)continue;p=g/this.YClose*this.MainYClose}else if(4==c){var x=this.Data.Data[v];null==m&&(m=x.Open),p=x.Close/m*d}else if(5==c){var F=this.Data.Data[v];if(!ha.IsNonEmptyArray(F))continue;var y=0,L=0;for(I=0;I<F.length;++I){var E=F[I];ha.IsNumber(E)&&(0!=E&&(E>0?y+=E:E<0&&(L+=E)))}p=(y+L)/2}else p=this.Data.Data[v];if(null!=p&&!(I<D)){if(I=0,a)var M=this.ChartFrame.GetXFromIndex(S);else{var A=h,N=h+i;if(N>o)break;M=A+(N-A)/2}var w=this.GetYFromData(p,!1);if(M>o)break;this.Canvas.beginPath(),this.Canvas.arc(M,w,C,0,360,!1),this.Canvas.closePath(),this.SelectedBGColor&&this.Canvas.fill(),this.Canvas.stroke()}}this.Canvas.restore()}},this.PtInLine=function(t,e,a){if(this.IsShow&&!this.ChartFrame.IsMinSize){var i=!0===this.ChartFrame.IsHScreen;if(!i){var r=this.IsMinuteFrame(),n=this.ChartFrame.DataWidth,s=this.ChartFrame.DistanceWidth,o=this.ChartFrame.XPointCount;if(i)var h=this.ChartBorder.GetHScreenBorder(),l=h.BottomEx,u=h.TopEx+s/2+Oi.FrameLeftMargin;else h=this.ChartBorder.GetBorder(),u=h.LeftEx+s/2+Oi.FrameLeftMargin,l=h.RightEx;var C=this.GetLockRect();if(C&&(l=i?C.Top:C.Left),t<u||t>l)return null;if(e>h.BottomEx||e<h.TopEx)return null;var D={},f={},c=0;a&&(a.KLineClose?c=1:a.MinuteOverlayPrice&&(c=3));for(var d=this.Data.DataOffset,m=0;d<this.Data.Data.length&&m<o;++d,++m,u+=n+s){var v=null;if(1==c){var S=this.Data.Data[d];ha.IsNumber(S.Close)&&(v=S.Close)}else if(3==c){var I=this.Data.Data[d].Close;if(null==I)continue;v=I/this.YClose*this.MainYClose}else v=this.Data.Data[d];if(null!=v){if(r)var p=this.ChartFrame.GetXFromIndex(m);else{var T=u,g=u+n;if(g>l)break;p=T+(g-T)/2}var x=this.GetYFromData(v,!1);if(!(p<t)){if(p==t){D.X=f.X=p,D.Y=f.Y=x;break}f.X=p,f.Y=x;break}if(D.X=p,D.Y=x,t>l)break}}if(!ha.IsNumber(D.X)||!ha.IsNumber(D.Y))return null;if(!ha.IsNumber(f.X)||!ha.IsNumber(f.Y))return null;if(t==D.X||e==D.Y)return{Identify:this.Identify,Chart:this};if(t==f.X||e==f.Y)return{Identify:this.Identify,Chart:this};var F=5;return this.Canvas.beginPath(),D.X==f.X?(this.Canvas.moveTo(D.X-F,D.Y),this.Canvas.lineTo(D.X+F,D.Y),this.Canvas.lineTo(f.X+F,f.Y),this.Canvas.lineTo(f.X-F,f.Y)):(this.Canvas.moveTo(D.X,D.Y+F),this.Canvas.lineTo(D.X,D.Y-F),this.Canvas.lineTo(f.X,f.Y-F),this.Canvas.lineTo(f.X,f.Y+F)),this.Canvas.closePath(),this.Canvas.isPointInPath(t,e)?{Identify:this.Identify,Chart:this}:null}}},this.PtInBar=function(t,e,a){if(!this.IsShow||this.ChartFrame.IsMinSize)return null;var i=!0===this.ChartFrame.IsHScreen;if(i)return null;var r=this.ChartFrame.DataWidth,n=this.ChartFrame.DistanceWidth,s=this.ChartBorder.GetBorder(),o=s.LeftEx+n/2+Oi.FrameLeftMargin,h=s.RightEx,l=this.ChartFrame.XPointCount,u=this.GetLockRect();if(u&&(h=u.Left),t<o||t>h)return null;if(e>s.BottomEx||e<s.TopEx)return null;var C=this.IsMinuteFrame(),D=this.ChartFrame.GetYFromData(0),f=null,c=!1,d=!1;a&&(a.BarWidth>0&&(f=a.BarWidth),1==a.MinuteVolBar?(c=!0,f=4):1==a.StackedBar&&(d=!0));for(var m=this.Data.DataOffset,v=0;m<this.Data.Data.length&&v<l;++m,++v,o+=r+n){var S=this.Data.Data[m];if(null!=S){if(C)var I=this.ChartFrame.GetXFromIndex(v),p=I-f/2,T=p+f;else{p=o,T=o+r;if(T>h)break}if(c){if(!ha.IsNumber(S.Vol))continue;var g=this.ChartFrame.GetYFromData(S.Vol),x=g,F=D}else if(d){var y=0,L=0;if(!ha.IsNonEmptyArray(S))continue;for(var E=0;E<S.length;++E){var M=S[E];ha.IsNumber(M)&&(0!=M&&(M>0?y+=M:M<0&&(L+=M)))}x=this.ChartFrame.GetYFromData(y),F=this.ChartFrame.GetYFromData(L)}else g=this.ChartFrame.GetYFromData(S),x=g,F=D;x>F&&(x=D,F=g);var A=p,N=T;if(f>0&&(A=p+(T-p)/2-f/2,N=A+f),t>=A&&t<=N&&e>=x&&e<=F)return{Identify:this.Identify,Chart:this};if(T>t)break}}return null},this.PtInKBar=function(t,e,a){if(!this.IsShow||this.ChartFrame.IsMinSize)return null;var i=!0===this.ChartFrame.IsHScreen;if(i)return null;var r=this.ChartFrame.DataWidth,n=this.ChartFrame.DistanceWidth,s=this.ChartBorder.GetBorder(),o=s.LeftEx+n/2+Oi.FrameLeftMargin,h=s.RightEx,l=this.ChartFrame.XPointCount;if(i){s=this.ChartBorder.GetHScreenBorder();o=s.TopEx+n/2+Oi.FrameLeftMargin,h=s.BottomEx}if(t<o||t>h)return null;if(e>s.BottomEx||e<s.TopEx)return null;var u=null,C=0,D=null;a&&a.OverlayKLine&&(C=1,D=this.GetFirstOpen());for(var f=this.Data.DataOffset,c=0;f<this.Data.Data.length&&c<l;++f,++c,o+=r+n){var d=this.Data.Data[f];if(null!=d.Open&&null!=d.High&&null!=d.Low&&null!=d.Close){null==u&&(u=d.Open);var m=o,v=o+r;if(v>h)break;if(t>=m&&t<=v){if(1==C)var S=this.GetYFromData(d.Low/u*D,!1),I=this.GetYFromData(d.High/u*D,!1);else S=this.GetYFromData(d.Low,!1),I=this.GetYFromData(d.High,!1);if(e<=S&&e>=I)return{Identify:this.Identify,Chart:this}}if(v>t)break}}}}var Wt=[[48,10],[44,10],[40,9],[36,9],[32,8],[28,8],[24,7],[20,7],[18,6],[16,6],[15,5],[13,5],[9,4],[7,4],[5,4],[3,3],[3,1],[2,1],[1,1],[1,0]];function Ut(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartKLine",this.Symbol,this.DrawType=0,this.CloseLineColor=Oi.CloseLineColor,this.CloseLineAreaColor=Oi.CloseLineAreaColor,this.CloseLineWidth=Oi.CloseLineWidth,this.UpColor=Oi.UpBarColor,this.DownColor=Oi.DownBarColor,this.UnchagneColor=Oi.UnchagneBarColor,this.ColorData,this.TradeData,this.TradeIcon=Oi.KLine.TradeIcon,this.TooltipRect=[],this.InfoTooltipRect=[],this.TradeIconTooltipRect=[],this.IsShowMaxMinPrice=!0,this.IsShowKTooltip=!0,this.TextFont=Oi.KLine.MaxMin.Font,this.TextColor=Oi.KLine.MaxMin.Color,this.InfoData,this.InfoPosition=0,this.PtMax,this.PtMin,this.TickSymbol="â³",this.TickFontName="arial",this.Period,this.ShowRange={},this.CustomKLine,this.DrawKRange={Start:null,End:null},this.OrderFlow={UpColor:{BG:Oi.OrderFlow.UpColor.BG,Border:Oi.OrderFlow.UpColor.Border},DownColor:{BG:Oi.OrderFlow.DownColor.BG,Border:Oi.OrderFlow.DownColor.Border},UnchagneColor:{BG:Oi.OrderFlow.UnchagneColor.BG,Border:Oi.OrderFlow.UnchagneColor.Border},Text:{Color:Oi.OrderFlow.Text.Color,Family:Oi.OrderFlow.Text.Family,FontMaxSize:Oi.OrderFlow.Text.FontMaxSize,MaxValue:Oi.OrderFlow.Text.MaxValue},Line:{UpDownColor:Oi.OrderFlow.Line.UpDownColor,MiddleColor:Oi.OrderFlow.Line.MiddleColor},POCGBColor:Oi.OrderFlow.POCGBColor,ShowType:0,AskBarColor:Oi.OrderFlow.AskBarColor,BidBarColor:Oi.OrderFlow.BidBarColor,AlwaysShowOrderText:Oi.OrderFlow.AlwaysShowOrderText,IsShowAskText:!0,IsShowAskBar:!1,IsShowBidText:!0,IsShowBidBar:!1,IsShowPOCBG:!0},this.OrderFlow_Style2={BarWidth:Oi.OrderFlow_Style2.BarWidth,UpColor:Oi.OrderFlow_Style2.UpColor,DownColor:Oi.OrderFlow_Style2.DownColor,UnchagneColor:Oi.OrderFlow_Style2.UnchagneColor},this.OrderFlow_Style3={BarWidth:Oi.OrderFlow_Style3.BarWidth,UpColor:Oi.OrderFlow_Style3.UpColor,DownColor:Oi.OrderFlow_Style3.DownColor,UnchagneColor:Oi.OrderFlow_Style3.UnchagneColor},this.IsShowOrderText=!1,this.AryOrderFlowBorder=[],this.ReloadResource=function(t){this.TextFont=Oi.KLine.MaxMin.Font,this.TextColor=Oi.KLine.MaxMin.Color,this.CloseLineColor=Oi.CloseLineColor,this.CloseLineAreaColor=Oi.CloseLineAreaColor,this.CloseLineWidth=Oi.CloseLineWidth,this.UpColor=Oi.UpBarColor,this.DownColor=Oi.DownBarColor,this.UnchagneColor=Oi.UnchagneBarColor,this.OrderFlow.UpColor={BG:Oi.OrderFlow.UpColor.BG,Border:Oi.OrderFlow.UpColor.Border},this.OrderFlow.DownColor={BG:Oi.OrderFlow.DownColor.BG,Border:Oi.OrderFlow.DownColor.Border},this.OrderFlow.UnchagneColor={BG:Oi.OrderFlow.UnchagneColor.BG,Border:Oi.OrderFlow.UnchagneColor.Border},this.OrderFlow.Text={Color:Oi.OrderFlow.Text.Color,Family:Oi.OrderFlow.Text.Family,FontMaxSize:Oi.OrderFlow.Text.FontMaxSize,MaxValue:Oi.OrderFlow.Text.MaxValue},this.OrderFlow.Line={UpDownColor:Oi.OrderFlow.Line.UpDownColor,MiddleColor:Oi.OrderFlow.Line.MiddleColor}},this.ClearCustomKLine=function(){this.CustomKLine=null},this.GetCustomKLine=function(t){if(!this.CustomKLine)return null;if(!t)return null;var e=1e6*t.Date;if(ha.IsNumber(t.Time)&&(e+=t.Time),!this.CustomKLine.has(e))return null;var a=this.CustomKLine.get(e);return a},this.DrawAKLine=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartFrame.XPointCount;if(t)var r=this.ChartBorder.GetHScreenBorder(),n=r.TopEx+a/2+Oi.FrameLeftMargin,s=r.BottomEx;else r=this.ChartBorder.GetBorder(),n=r.LeftEx+a/2+Oi.FrameLeftMargin,s=r.RightEx;this.UpColor,this.DownColor,this.UnchagneColor;var o={X:null,Y:null,Value:null,Align:"left"},h={X:null,Y:null,Value:null,Align:"left"};this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=i,this.DrawKRange.Start=this.Data.DataOffset;for(var l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<i;++l,++u,n+=e+a,++this.ShowRange.DataCount){var C=this.Data.Data[l];if(this.ShowRange.End=l,null!=C.Open&&null!=C.High&&null!=C.Low&&null!=C.Close){var D=n,f=n+e;if(f>s)break;var c=D+(f-D)/2,d=this.GetYFromData(C.Low,!1),m=this.GetYFromData(C.High,!1),v=this.GetYFromData(C.Open,!1),S=this.GetYFromData(C.Close,!1);if(this.DrawKRange.End=l,(null==o.Value||o.Value<C.High)&&(o.X=c,o.Y=m,o.Value=C.High,o.Align=u<i/2?"left":"right"),(null==h.Value||h.Value>C.Low)&&(h.X=c,h.Y=d,h.Value=C.Low,h.Align=u<i/2?"left":"right"),C.Open<C.Close?this.Canvas.strokeStyle=this.UpColor:C.Open>C.Close?this.Canvas.strokeStyle=this.DownColor:this.Canvas.strokeStyle=this.UnchagneColor,this.ColorData&&(l<this.ColorData.length&&this.ColorData[l]>0?this.UpColor:this.DownColor),this.Canvas.beginPath(),t?C.High==C.Low&&e<4?(this.Canvas.moveTo(m,Q(c)),this.Canvas.lineTo(d-1,Q(c))):(this.Canvas.moveTo(m,Q(c)),this.Canvas.lineTo(d,Q(c))):C.High==C.Low&&e<4?(this.Canvas.moveTo(Q(c),m),this.Canvas.lineTo(Q(c),d+1)):(this.Canvas.moveTo(Q(c),m),this.Canvas.lineTo(Q(c),d)),this.Canvas.stroke(),e>=4&&(this.Canvas.beginPath(),t?(this.Canvas.moveTo(Q(v),D),this.Canvas.lineTo(Q(v),c)):(this.Canvas.moveTo(D,Q(v)),this.Canvas.lineTo(c,Q(v))),this.Canvas.stroke(),this.Canvas.beginPath(),t?(this.Canvas.moveTo(Q(S),f),this.Canvas.lineTo(Q(S),c)):(this.Canvas.moveTo(f,Q(S)),this.Canvas.lineTo(c,Q(S))),this.Canvas.stroke()),0==this.Data.DataType){var I={Xleft:D,XRight:f,YMax:m,XCenter:c,YMin:d,DayData:C,Index:u};this.DrawInfo(I)}}}this.PtMax=o,this.PtMin=h},this.DrawCloseArea=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartFrame.XPointCount;if(t)var r=this.ChartBorder.GetHScreenBorder(),n=r.TopEx+a/2+Oi.FrameLeftMargin,s=r.BottomEx,o=r.TopEx;else r=this.ChartBorder.GetBorder(),n=r.LeftEx+a/2+Oi.FrameLeftMargin,s=r.RightEx,o=r.LeftEx;var h=!0,l=null;this.Canvas.beginPath(),this.Canvas.strokeStyle=this.CloseLineColor,ha.IsNumber(this.CloseLineWidth)&&(this.Canvas.lineWidth=this.CloseLineWidth);var u=null;if(this.Data.DataOffset>0){var C=this.Data.Data[this.Data.DataOffset-1];if(C&&ha.IsNumber(C.Close)){var D=o,f=this.GetYFromData(C.Close,!1);t?(this.Canvas.moveTo(f,D),l={X:f,Y:D}):(this.Canvas.moveTo(D,f),l={X:D,Y:f}),h=!1}}this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=i,this.DrawKRange.Start=this.Data.DataOffset;for(var c=this.Data.DataOffset,d=0;c<this.Data.Data.length&&d<i;++c,++d,n+=e+a,++this.ShowRange.DataCount){C=this.Data.Data[c];if(this.ShowRange.End=c,null!=C.Open&&null!=C.High&&null!=C.Low&&null!=C.Close){var m=n,v=n+e;if(v>s)break;D=m+(v-m)/2,f=this.GetYFromData(C.Close,!1);this.DrawKRange.End=c,h?(t?(this.Canvas.moveTo(f,D),l={X:f,Y:D}):(this.Canvas.moveTo(D,f),l={X:D,Y:f}),h=!1):t?this.Canvas.lineTo(f,D):this.Canvas.lineTo(D,f),c==this.Data.Data.length-1&&(u={X:D,Y:f,XLeft:m,XRight:v,KItem:C,ChartRight:s})}}if(this.DrawLastPointEvent(u),!h){if(this.Canvas.stroke(),t?(this.Canvas.lineTo(r.Left,D),this.Canvas.lineTo(r.Left,l.Y)):(this.Canvas.lineTo(D,r.Bottom),this.Canvas.lineTo(l.X,r.Bottom)),this.Canvas.closePath(),Array.isArray(this.CloseLineAreaColor))if(t){var S=this.Canvas.createLinearGradient(this.ChartBorder.GetRightEx(),this.ChartBorder.GetTop(),this.ChartBorder.GetLeft(),this.ChartBorder.GetTop());S.addColorStop(0,this.CloseLineAreaColor[0]),S.addColorStop(1,this.CloseLineAreaColor[1]),this.Canvas.fillStyle=S}else{var I=this.Canvas.createLinearGradient(l.X,this.ChartBorder.GetTopEx(),l.X,this.ChartBorder.GetBottom());I.addColorStop(0,this.CloseLineAreaColor[0]),I.addColorStop(1,this.CloseLineAreaColor[1]),this.Canvas.fillStyle=I}else this.Canvas.fillStyle=this.CloseLineAreaColor;this.Canvas.fill()}},this.DrawCloseLine=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartFrame.XPointCount;if(t)var r=this.ChartBorder.GetHScreenBorder(),n=r.TopEx+a/2+Oi.FrameLeftMargin,s=r.BottomEx;else r=this.ChartBorder.GetBorder(),n=r.LeftEx+a/2+Oi.FrameLeftMargin,s=r.RightEx;var o=!0;this.Canvas.beginPath(),this.Canvas.strokeStyle=this.CloseLineColor,ha.IsNumber(this.CloseLineWidth)&&(this.Canvas.lineWidth=this.CloseLineWidth),this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=i,this.DrawKRange.Start=this.Data.DataOffset;for(var h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<i;++h,++l,n+=e+a,++this.ShowRange.DataCount){var u=this.Data.Data[h];if(this.ShowRange.End=h,null!=u.Open&&null!=u.High&&null!=u.Low&&null!=u.Close){var C=n,D=n+e;if(D>s)break;var f=C+(D-C)/2,c=this.GetYFromData(u.Close,!1);this.DrawKRange.End=h,o?(t?this.Canvas.moveTo(c,f):this.Canvas.moveTo(f,c),o=!1):t?this.Canvas.lineTo(c,f):this.Canvas.lineTo(f,c)}}0==o&&this.Canvas.stroke()},this.DrawKBar=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetBorder(),r=i.LeftEx+a/2+Oi.FrameLeftMargin,n=i.RightEx,s=this.ChartFrame.XPointCount;if(t){i=this.ChartBorder.GetHScreenBorder();r=i.TopEx+a/2+Oi.FrameLeftMargin,n=i.BottomEx}var o={X:null,Y:null,Value:null,Align:"left"},h={X:null,Y:null,Value:null,Align:"left"},l=this.UpColor,u=this.DownColor,C=this.UnchagneColor;this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=s;var D=null;this.DrawKRange.Start=this.Data.DataOffset;for(var f=this.Data.DataOffset,c=0;f<this.Data.Data.length&&c<s;++f,++c,r+=e+a,++this.ShowRange.DataCount){var d=this.Data.Data[f];if(this.ShowRange.End=f,null!=d.Open&&null!=d.High&&null!=d.Low&&null!=d.Close){var m=r,v=r+e;if(v>n)break;var S=m+(v-m)/2,I=this.GetYFromData(d.Low,!1),p=this.GetYFromData(d.High,!1),T=this.GetYFromData(d.Open,!1),g=this.GetYFromData(d.Close,!1),x=p;this.DrawKRange.End=f,(null==o.Value||o.Value<d.High)&&(o.X=S,o.Y=p,o.Value=d.High,o.Align=c<s/2?"left":"right"),(null==h.Value||h.Value>d.Low)&&(h.X=S,h.Y=I,h.Value=d.Low,h.Align=c<s/2?"left":"right"),this.ColorData&&(l=u=C=f<this.ColorData.length&&this.ColorData[f]>0?this.UpColor:this.DownColor);var F=this.GetCustomKLine(d);if(F){var y=F.Color;y||(y=d.Open<d.Close?l:d.Open>d.Close?u:C);var L=this.DrawType;ha.IsNumber(F.DrawType)&&(L=F.DrawType),this.DrawKBar_Custom(d,e,y,L,F,S,x,m,v,I,p,T,g,i,t)}else 9==this.DrawType&&d.ColorData?this.DrawKBarV2(d,d.ColorData,e,S,x,m,v,I,p,T,g,t):d.Open<d.Close?this.DrawKBar_Up(d,e,l,this.DrawType,S,x,m,v,I,p,T,g,t):d.Open>d.Close?this.DrawKBar_Down(d,e,u,this.DrawType,S,x,m,v,I,p,T,g,t):this.DrawKBar_Unchagne(d,e,C,this.DrawType,S,x,m,v,I,p,T,g,t);if(this.IsShowKTooltip&&!t){var E=Math.min(T,g),M=Math.max(T,g);Math.abs(T-g)<5&&(E=Math.min(p,E-5),M=Math.max(I,M+5));var A=new Yt(m,E,e,M-E);this.TooltipRect.push([f,A])}if(0==this.Data.DataType){var N={Xleft:m,XRight:v,XCenter:S,YMax:p,YMin:I,DayData:d,Index:c};this.DrawInfo(N)}f==this.Data.Data.length-1&&(D={X:S,Y:g,XLeft:m,XRight:v,KItem:d,ChartRight:n})}}this.DrawLastPointEvent(D),this.PtMax=o,this.PtMin=h},this.DrawKBar_Up=function(t,e,a,i,r,n,s,o,h,l,u,C,D){var f=3==i||6==i;if(e>=4){if(f&&e%2!=0&&(e-=1),this.Canvas.strokeStyle=a,t.High>t.Close){if(this.Canvas.beginPath(),D)this.Canvas.moveTo(Q(n),Q(r)),this.Canvas.lineTo(Q(3==i?Math.max(C,u):C),Q(r));else if(f){var c=s+e/2;this.Canvas.moveTo(Q(c),Q(n)),this.Canvas.lineTo(Q(c),Q(Math.min(C,u)))}else this.Canvas.moveTo(Q(r),Q(n)),this.Canvas.lineTo(Q(r),Q(C));this.Canvas.stroke(),n=C}else n=C;if(this.Canvas.fillStyle=a,D?Math.abs(u-n)<1?this.Canvas.fillRect(tt(n),tt(s),1,tt(e)):f?(this.Canvas.beginPath(),this.Canvas.rect(Q(n),Q(s),tt(u-n),tt(e)),this.Canvas.stroke()):this.Canvas.fillRect(tt(n),tt(s),tt(u-n),tt(e)):Math.abs(u-n)<1?this.Canvas.fillRect(tt(s),tt(n),tt(e),1):f?(this.Canvas.beginPath(),this.Canvas.rect(Q(s),Q(n),tt(e),tt(u-n)),this.Canvas.stroke()):this.Canvas.fillRect(tt(s),tt(Math.min(n,u)),tt(e),tt(Math.abs(u-n))),t.Open>t.Low){if(this.Canvas.beginPath(),D)this.Canvas.moveTo(Q(3==i?Math.min(C,u):n),Q(r)),this.Canvas.lineTo(Q(h),Q(r));else if(f){c=s+e/2;this.Canvas.moveTo(Q(c),Q(Math.max(C,u))),this.Canvas.lineTo(Q(c),Q(h))}else this.Canvas.moveTo(Q(r),Q(n)),this.Canvas.lineTo(Q(r),Q(h));this.Canvas.stroke()}}else this.Canvas.beginPath(),D?(this.Canvas.moveTo(l,Q(r)),this.Canvas.lineTo(h,Q(r))):(this.Canvas.moveTo(Q(r),l),this.Canvas.lineTo(Q(r),h)),this.Canvas.strokeStyle=a,this.Canvas.stroke()},this.DrawKBar_Down=function(t,e,a,i,r,n,s,o,h,l,u,C,D){var f=6==i;if(e>=4){if(f&&e%2!=0&&(e-=1),this.Canvas.strokeStyle=a,t.High>t.Close){if(this.Canvas.beginPath(),D)this.Canvas.moveTo(Q(n),Q(r)),this.Canvas.lineTo(Q(u),Q(r));else if(f){var c=s+e/2;this.Canvas.moveTo(Q(c),Q(n)),this.Canvas.lineTo(Q(c),Q(Math.min(C,u)))}else this.Canvas.moveTo(Q(r),Q(n)),this.Canvas.lineTo(Q(r),Q(u));this.Canvas.stroke(),n=u}else n=u;if(this.Canvas.fillStyle=a,D?Math.abs(C-n)<1?this.Canvas.fillRect(tt(n),tt(s),1,tt(e)):this.Canvas.fillRect(tt(n),tt(s),tt(C-n),tt(e)):Math.abs(C-n)<1?this.Canvas.fillRect(tt(s),tt(n),tt(e),1):f?(this.Canvas.beginPath(),this.Canvas.rect(Q(s),Q(Math.min(n,C)),tt(e),tt(Math.abs(C-n))),this.Canvas.stroke()):this.Canvas.fillRect(tt(s),tt(Math.min(n,C)),tt(e),tt(Math.abs(C-n))),t.Open>t.Low){if(this.Canvas.beginPath(),D)this.Canvas.moveTo(Q(n),Q(r)),this.Canvas.lineTo(Q(h),Q(r));else if(f){c=s+e/2;this.Canvas.moveTo(Q(c),Q(Math.max(C,u))),this.Canvas.lineTo(Q(c),Q(h))}else this.Canvas.moveTo(Q(r),Q(n)),this.Canvas.lineTo(Q(r),Q(h));this.Canvas.stroke()}}else this.Canvas.beginPath(),D?(this.Canvas.moveTo(l,Q(r)),this.Canvas.lineTo(h,Q(r))):(this.Canvas.moveTo(Q(r),l),this.Canvas.lineTo(Q(r),h)),this.Canvas.strokeStyle=a,this.Canvas.stroke()},this.DrawKBar_Unchagne=function(t,e,a,i,r,n,s,o,h,l,u,C,D){if(e>=4){if(e%2!=0&&(e-=1),this.Canvas.strokeStyle=a,this.Canvas.beginPath(),t.High>t.Close){if(D)this.Canvas.moveTo(n,Q(r)),this.Canvas.lineTo(u,Q(r));else{var f=Q(s+e/2);this.Canvas.moveTo(f,n),this.Canvas.lineTo(f,u)}n=u}else n=u;if(D?(this.Canvas.moveTo(Q(n),Q(s)),this.Canvas.lineTo(Q(n),Q(o))):(this.Canvas.moveTo(Q(s),Q(n)),this.Canvas.lineTo(Q(s+e),Q(n))),t.Open>t.Low)if(D)this.Canvas.moveTo(Q(n),Q(r)),this.Canvas.lineTo(Q(h),Q(r));else{f=Q(s+e/2);this.Canvas.moveTo(f,Q(n)),this.Canvas.lineTo(f,Q(h))}this.Canvas.stroke()}else this.Canvas.beginPath(),D?t.High==t.Low?(this.Canvas.moveTo(l,Q(r)),this.Canvas.lineTo(h-1,Q(r))):(this.Canvas.moveTo(l,Q(r)),this.Canvas.lineTo(h,Q(r))):t.High==t.Low?(this.Canvas.moveTo(Q(r),l),this.Canvas.lineTo(Q(r),h+1)):(this.Canvas.moveTo(Q(r),l),this.Canvas.lineTo(Q(r),h)),this.Canvas.strokeStyle=a,this.Canvas.stroke()},this.DrawKBar_Custom=function(t,e,a,i,r,n,s,o,h,l,u,C,D,f,c){if(r.BGColor){this.Canvas.fillStyle=r.BGColor;var d=this.ChartFrame.DistanceWidth;if(c){var m=o-d/2,v=h+d/2,S=f.RightEx,I=f.LeftEx;this.Canvas.fillRect(tt(I),tt(m),tt(S-I),tt(v-m))}else{var p=o-d/2,T=h+d/2,g=f.TopEx,x=f.BottomEx;this.Canvas.fillRect(tt(p),tt(g),tt(T-p),tt(x-g))}}e>=4?(this.Canvas.strokeStyle=a,t.High>t.Close?(this.Canvas.beginPath(),c?(this.Canvas.moveTo(Q(s),Q(n)),this.Canvas.lineTo(Q(3==i?Math.max(D,C):D),Q(n))):(this.Canvas.moveTo(Q(n),Q(s)),this.Canvas.lineTo(Q(n),Q(3==i?Math.min(D,C):D))),this.Canvas.stroke(),s=D):s=D,this.Canvas.fillStyle=a,c?Math.abs(C-s)<1?this.Canvas.fillRect(tt(s),tt(o),1,tt(e)):3==i?(this.Canvas.beginPath(),this.Canvas.rect(Q(s),Q(o),tt(C-s),tt(e)),this.Canvas.stroke()):this.Canvas.fillRect(tt(s),tt(o),tt(C-s),tt(e)):Math.abs(C-s)<1?this.Canvas.fillRect(tt(o),tt(s),tt(e),1):3==i?(this.Canvas.beginPath(),this.Canvas.rect(Q(o),Q(s),tt(e),tt(C-s)),this.Canvas.stroke()):this.Canvas.fillRect(tt(o),tt(Math.min(s,C)),tt(e),tt(Math.abs(C-s))),t.Open>t.Low&&(this.Canvas.beginPath(),c?(this.Canvas.moveTo(Q(3==i?Math.min(D,C):s),Q(n)),this.Canvas.lineTo(Q(l),Q(n))):(this.Canvas.moveTo(Q(n),Q(3==i?Math.max(D,C):s)),this.Canvas.lineTo(Q(n),Q(l))),this.Canvas.stroke())):(this.Canvas.beginPath(),c?(this.Canvas.moveTo(u,Q(n)),this.Canvas.lineTo(l,Q(n))):(this.Canvas.moveTo(Q(n),u),this.Canvas.lineTo(Q(n),l)),this.Canvas.strokeStyle=a,this.Canvas.stroke())},this.DrawKBarV2=function(t,e,a,i,r,n,s,o,h,l,u,C){var D=!1,f=!1;if(e.border&&(D=!0),0===e.Type&&(f=!0),a>=4){if(D&&a%2!=0&&(a-=1),t.High>t.Close){if(e.Line){if(this.Canvas.strokeStyle=e.Line.Color,this.Canvas.beginPath(),C)this.Canvas.moveTo(Q(r),Q(i)),this.Canvas.lineTo(Q(Math.max(u,l)),Q(i));else if(D){var c=n+a/2;this.Canvas.moveTo(Q(c),Q(r)),this.Canvas.lineTo(Q(c),Q(Math.min(u,l)))}else this.Canvas.moveTo(Q(i),Q(r)),this.Canvas.lineTo(Q(i),Q(Math.min(u,l)));this.Canvas.stroke()}r=u}else r=u;if(C?(!f&&e.BarColor&&(this.Canvas.fillStyle=e.BarColor,Math.abs(l-r)<1?this.Canvas.fillRect(tt(r),tt(n),1,tt(a)):this.Canvas.fillRect(tt(r),tt(n),tt(l-r),tt(a))),e.Border&&(Math.abs(l-r)<1?(this.Canvas.fillStyle=e.Border.Color,this.Canvas.fillRect(tt(r),tt(n),1,tt(a))):(this.Canvas.strokeStyle=e.Border.Color,this.Canvas.beginPath(),this.Canvas.rect(Q(r),Q(n),tt(l-r),tt(a)),this.Canvas.stroke()))):(!f&&e.BarColor&&(this.Canvas.fillStyle=e.BarColor,Math.abs(l-r)<1?this.Canvas.fillRect(tt(n),tt(r),tt(a),1):this.Canvas.fillRect(tt(n),tt(Math.min(r,l)),tt(a),tt(Math.abs(l-r)))),e.Border&&(Math.abs(l-r)<1?(this.Canvas.fillStyle=e.Border.Color,this.Canvas.fillRect(tt(n),tt(r),tt(a),1)):(this.Canvas.strokeStyle=e.Border.Color,this.Canvas.beginPath(),this.Canvas.rect(Q(n),Q(r),tt(a),tt(l-r)),this.Canvas.stroke()))),t.Open>t.Low&&e.Line){if(this.Canvas.strokeStyle=e.Line.Color,this.Canvas.beginPath(),C)this.Canvas.moveTo(Q(Math.min(u,l)),Q(i)),this.Canvas.lineTo(Q(o),Q(i));else if(D){c=n+a/2;this.Canvas.moveTo(Q(c),Q(Math.max(u,l))),this.Canvas.lineTo(Q(c),Q(o))}else this.Canvas.moveTo(Q(i),Q(Math.max(u,l))),this.Canvas.lineTo(Q(i),Q(o));this.Canvas.stroke()}}else{var d;f&&e.Border?d=e.Border.Color:!f&&e.BarColor&&(d=e.BarColor),d&&(this.Canvas.strokeStyle=d,this.Canvas.beginPath(),C?t.High==t.Low?(this.Canvas.moveTo(h,Q(i)),this.Canvas.lineTo(o-1,Q(i))):(this.Canvas.moveTo(h,Q(i)),this.Canvas.lineTo(o,Q(i))):t.High==t.Low?(this.Canvas.moveTo(Q(i),h),this.Canvas.lineTo(Q(i),o+1)):(this.Canvas.moveTo(Q(i),h),this.Canvas.lineTo(Q(i),o)),this.Canvas.stroke())}},this.DrawTrade=function(){if(this.TradeData){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetLeft()+a/2+2,r=this.ChartBorder.GetRight(),n=this.ChartFrame.XPointCount;t&&(i=this.ChartBorder.GetTop()+a/2+2,r=this.ChartBorder.GetBottom());var s=this.TradeData.Sell,o=this.TradeData.Buy,h=e;h>10&&(h=10);for(var l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<n;++l,++u,i+=e+a){var C=this.Data.Data[l];if(null!=C.Open&&null!=C.High&&null!=C.Low&&null!=C.Close){var D=!1,f=!1;if(s&&l<s.length&&(f=s[l]>0),o&&l<o.length&&(D=o[l]>0),f||D){var c=i,d=i+e;if(d>r)break;var m=c+(d-c)/2,v=this.GetYFromData(C.Low,!1),S=this.GetYFromData(C.High,!1);this.GetYFromData(C.Open,!1),this.GetYFromData(C.Close,!1);D&&(this.Canvas.fillStyle=this.UpColor,this.Canvas.strokeStyle=this.UnchagneColor,this.Canvas.beginPath(),t?(this.Canvas.moveTo(v-1,m),this.Canvas.lineTo(v-h-1,m-h/2),this.Canvas.lineTo(v-h-1,m+h/2)):(this.Canvas.moveTo(m,v+1),this.Canvas.lineTo(m-h/2,v+h+1),this.Canvas.lineTo(m+h/2,v+h+1)),this.Canvas.closePath(),this.Canvas.fill(),this.Canvas.stroke()),f&&(this.Canvas.fillStyle=this.DownColor,this.Canvas.strokeStyle=this.UnchagneColor,this.Canvas.beginPath(),t?(this.Canvas.moveTo(S+1,m),this.Canvas.lineTo(S+h+1,m-h/2),this.Canvas.lineTo(S+h+1,m+h/2)):(this.Canvas.moveTo(m,S-1),this.Canvas.lineTo(m-h/2,S-h-1),this.Canvas.lineTo(m+h/2,S-h-1)),this.Canvas.closePath(),this.Canvas.fill(),this.Canvas.stroke())}}}}},this.DrawTick=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetLeft()+a/2+2;t&&(i=this.ChartBorder.GetTop()+a/2+2);var r=this.ChartBorder.GetRight();t&&(r=this.ChartBorder.GetBottom());var n=this.ChartFrame.XPointCount,s=parseInt(e);s<=1?s=2:s>=18&&(s=18);var o=U(),h=s*o;this.Canvas.beginPath(),this.Canvas.font=s*o+"px "+this.TickFontName,this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=n,this.DrawKRange.Start=this.Data.DataOffset;for(var l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<n;++l,++u,i+=e+a){var C=this.Data.Data[l];if(this.ShowRange.End=l,null!=C.Open&&null!=C.High&&null!=C.Low&&null!=C.Close){var D=i,f=i+e;if(f>r)break;var c=D+(f-D)/2,d=this.ChartFrame.GetYFromData(C.Close,!1);if(this.DrawKRange.End=l,0===C.Flag?this.Canvas.fillStyle=this.UpColor:1==C.Flag?this.Canvas.fillStyle=this.DownColor:this.Canvas.fillStyle=this.UnchagneColor,this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",t?this.Canvas.fillText(this.TickSymbol,d,c):this.Canvas.fillText(this.TickSymbol,c,d),this.IsShowKTooltip&&!t){var m=new Yt(c-h/2,d-h/2,h,h);this.TooltipRect.push([l,m])}}}},this.ClipTickClient=function(t){var e=this.GetBorder();if(1==t)var a=this.ChartBorder.GetLeftEx(),i=this.ChartBorder.GetRightEx(),r=this.ChartBorder.GetTop(),n=this.ChartBorder.GetBottom();else a=e.Left,i=e.Right,r=e.TopTitle,n=e.Bottom;this.Canvas.beginPath(),this.Canvas.rect(a,r,i-a,n-r),this.Canvas.clip()},this.ClipClient=function(t){if(1==t)var e=this.ChartBorder.GetLeftEx(),a=this.ChartBorder.GetRightEx(),i=this.ChartBorder.GetTop(),r=this.ChartBorder.GetBottom();else{e=this.ChartBorder.GetLeft(),a=this.ChartBorder.GetRight(),i=this.ChartBorder.GetTopEx(),r=this.ChartBorder.GetBottomEx();this.ChartBorder.BottomSpace>0&&(r+=1)}this.Canvas.beginPath(),this.Canvas.rect(e,i,a-e,r-i),this.Canvas.clip()},this.Draw=function(){if(this.IsShowOrderText=!1,this.TooltipRect=[],this.InfoTooltipRect=[],this.TradeIconTooltipRect=[],this.PtMax={X:null,Y:null,Value:null,Align:"left"},this.PtMin={X:null,Y:null,Value:null,Align:"left"},this.DrawKRange={Start:null,End:null},this.ChartFrame.ChartKLine={Max:null,Min:null},this.IsShow){if(Ot.IsTickPeriod(this.Period))return this.Canvas.save(),1==this.DrawType?(this.ClipClient(this.ChartFrame.IsHScreen),this.DrawCloseLine()):4==this.DrawType?(this.ClipClient(this.ChartFrame.IsHScreen),this.DrawCloseArea()):(this.ClipTickClient(this.ChartFrame.IsHScreen),this.DrawTick()),void this.Canvas.restore();if(this.Canvas.save(),this.ClipClient(this.ChartFrame.IsHScreen),1==this.DrawType)return this.DrawCloseLine(),void this.Canvas.restore();2==this.DrawType?this.DrawAKLine():4==this.DrawType?this.DrawCloseArea():5==this.DrawType?this.DrawOrderFlow():7==this.DrawType?this.DrawOrderFlow_Style2():8==this.DrawType?this.DrawOrderFlow_Style3():(this.DrawType,this.DrawKBar()),this.TradeIcon?this.DrawTradeIcon():this.DrawTrade(),this.Canvas.restore(),this.IsShowMaxMinPrice&&(!0===this.ChartFrame.IsHScreen?this.HScreenDrawMaxMinPrice(this.PtMax,this.PtMin):this.DrawMaxMinPrice(this.PtMax,this.PtMin))}},this.DrawMaxMinPrice=function(t,e){if(null!=t.X&&null!=t.Y&&null!=t.Value&&null!=e.X&&null!=e.Y&&null!=e.Value){var a=Oi.KLine.MaxMin.LeftArrow,i=Oi.KLine.MaxMin.RightArrow,r=Oi.KLine.MaxMin.HighYOffset,n=Oi.KLine.MaxMin.LowYOffset,s=rn(this.Symbol);this.Canvas.font=this.TextFont,this.Canvas.fillStyle=this.TextColor;var o=this.ChartBorder.GetTopEx(),h=this.ChartBorder.GetBottomEx(),l=t;1==this.ChartFrame.CoordinateType?(t.Y<e.Y&&(l=e),this.Canvas.textBaseline="top"):(t.Y>e.Y&&(l=e),this.Canvas.textBaseline="bottom"),this.Canvas.textAlign=l.Align;var u=(l.Align,l.X);ha.IsNumber(r)&&(l.Y+=r);var C=l.Value.toFixed(s);"left"==l.Align?C=a+C:C+=i,l.Y>o-2&&(this.Canvas.fillText(C,u,l.Y),this.ChartFrame.ChartKLine.Max={X:u,Y:l.Y,Text:{BaseLine:"bottom"}});var D=e;1==this.ChartFrame.CoordinateType?(e.Y>t.Y&&(D=t),this.Canvas.textBaseline="bottom"):(t.Y>e.Y&&(l=e),this.Canvas.textBaseline="top"),this.Canvas.textAlign=D.Align;u=(D.Align,D.X);ha.IsNumber(n)&&(D.Y+=n);C=e.Value.toFixed(s);"left"==D.Align?C=a+C:C+=i,D.Y<h+1&&(this.Canvas.fillText(C,u,D.Y),this.ChartFrame.ChartKLine.Min={X:u,Y:D.Y,Text:{BaseLine:"top"}})}},this.HScreenDrawMaxMinPrice=function(t,e){if(null!=t.X&&null!=t.Y&&null!=t.Value&&null!=e.X&&null!=e.Y&&null!=e.Value){var a=Oi.KLine.MaxMin.LeftArrow,i=Oi.KLine.MaxMin.RightArrow,r=Oi.KLine.MaxMin.HighYOffset,n=Oi.KLine.MaxMin.LowYOffset,s=rn(this.Symbol),o=t.Y,h=t.X;ha.IsNumber(r)&&(o+=r),this.Canvas.save(),this.Canvas.translate(o,h),this.Canvas.rotate(90*Math.PI/180),this.Canvas.font=this.TextFont,this.Canvas.fillStyle=this.TextColor,this.Canvas.textAlign=t.Align,this.Canvas.textBaseline="bottom";var l=t.Value.toFixed(s);"left"==t.Align?l=a+l:l+=i,this.Canvas.fillText(l,0,0),this.Canvas.restore();o=e.Y,h=e.X;ha.IsNumber(n)&&(o+=n),this.Canvas.save(),this.Canvas.translate(o,h),this.Canvas.rotate(90*Math.PI/180),this.Canvas.font=this.TextFont,this.Canvas.fillStyle=this.TextColor,this.Canvas.textAlign=e.Align,this.Canvas.textBaseline="top";l=e.Value.toFixed(s);"left"==e.Align?l=a+l:l+=i,this.Canvas.fillText(l,0,0),this.Canvas.restore()}},this.DrawInfo=function(t){if(this.InfoData&&!(this.InfoData.length<=0)){var e=!0===this.ChartFrame.IsHScreen,a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetBottom(),n=this.ChartBorder.GetTop(),s=this.InfoData.get(t.DayData.Date.toString());if(s&&!(s.Data.length<=0)){var o=U(),h=a+i,l=18*o,u=!0;h<=15&&(u=!1),h<l&&(h=l);var C,D="",f=new E.default,c=t.YMax+1*o,d=t.YMin+1*o+h,m=!0,v=0;for(var S in s.Data){var I=s.Data[S],p=f.get(I.InfoType);if(p)p.Data.push(I);else{var g=lr.GetIconFont(I.InfoType);if(this.Canvas.fillStyle=g.Color,this.Canvas.font=h+"px "+g.Family,e){this.Canvas.textBaseline="middle",this.Canvas.textAlign="left",this.Canvas.fillText(g.HScreenText,c,t.XCenter,h);var x=new Yt(t.XCenter-h/2,c-h,h,h),F={Data:new Array(I),Rect:x,Type:I.InfoType,TextRect:{X:c,Y:t.XCenter}};f.set(I.InfoType,F),c+=h}else if(this.Canvas.textBaseline="bottom",this.Canvas.textAlign="center",1===this.InfoPosition){var y=r+v;this.Canvas.fillText(g.Text,t.XCenter,y,h);x=new Yt(t.XCenter-h/2,y-h,h,h),F={Data:new Array(I),Rect:x,Type:I.InfoType,TextRect:{X:t.XCenter,Y:y}};f.set(I.InfoType,F),v-=h}else if(m){this.Canvas.fillText(g.Text,t.XCenter,c,h);x=new Yt(t.XCenter-h/2,c-h,h,h),F={Data:new Array(I),Rect:x,Type:I.InfoType,TextRect:{X:t.XCenter,Y:c}};f.set(I.InfoType,F),c-=h,c-h<n&&(m=!1)}else{this.Canvas.fillText(g.Text,t.XCenter,d,h);x=new Yt(t.XCenter-h/2,d-h,h,h),F={Data:new Array(I),Rect:x,Type:I.InfoType,TextRect:{X:t.XCenter,Y:d}};f.set(I.InfoType,F),d+=h}}}Oi.KLine.NumIcon&&(C=e?Oi.KLine.NumIcon.HScreenText:Oi.KLine.NumIcon.Text);var L=!0,M=!1,A=void 0;try{for(var N,w=(0,T.default)(f);!(L=(N=w.next()).done);L=!0){t=N.value;var O=t[1];if(O.Data.length>=2&&C&&u){var R=O.Data.length;R>=C.length&&(R=0),this.Canvas.fillStyle=Oi.KLine.NumIcon.Color;D=C[R];this.Canvas.fillText(D,O.TextRect.X,O.TextRect.Y,h)}e||this.InfoTooltipRect.push(O)}}catch(P){M=!0,A=P}finally{try{!L&&w.return&&w.return()}finally{if(M)throw A}}}}},this.DrawTradeIcon=function(){if(this.TradeData){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetLeft()+a/2+2,r=this.ChartBorder.GetRight(),n=this.ChartFrame.XPointCount;t&&(i=this.ChartBorder.GetTop()+a/2+2,r=this.ChartBorder.GetBottom());var s=this.TradeData.Sell,o=this.TradeData.Buy,h=e+a,l=U(),u=24*l,C=12*l;h<C?h=C:h>u&&(h=u),this.Canvas.font=h+"px "+this.TradeIcon.Family;for(var D=this.Data.DataOffset,f=0;D<this.Data.Data.length&&f<n;++D,++f,i+=e+a){var c=this.Data.Data[D];if(null!=c.Open&&null!=c.High&&null!=c.Low&&null!=c.Close){var d=!1,m=!1;if(s&&D<s.length&&(m=s[D]>0),o&&D<o.length&&(d=o[D]>0),m||d){var v=i,S=i+e;if(S>r)break;var I=v+(S-v)/2,p=this.GetYFromData(c.Low,!1),T=this.GetYFromData(c.High,!1);this.GetYFromData(c.Open,!1),this.GetYFromData(c.Close,!1);if(d)if(this.Canvas.fillStyle=this.TradeIcon.Buy.Color,t)this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillText(this.TradeIcon.Buy.HScreenText,p,I);else{this.Canvas.textAlign="center",this.Canvas.textBaseline="top",this.Canvas.fillText(this.TradeIcon.Buy.Text,I,p);var g=new Yt(I-h/2,p,h,h),x={Data:{Type:1,KData:c,Name:this.TradeData.Name,Param:this.TradeData.Param},Rect:g,TextRect:{X:I,Y:p}};this.TradeIconTooltipRect.push(x)}if(m)if(this.Canvas.fillStyle=this.TradeIcon.Sell.Color,t)this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillText(this.TradeIcon.Sell.HScreenText,T,I);else{this.Canvas.textAlign="center",this.Canvas.textBaseline="bottom",this.Canvas.fillText(this.TradeIcon.Sell.Text,I,T);g=new Yt(I-h/2,T-h,h,h),x={Data:{Type:2,KData:c,Name:this.TradeData.Name,Param:this.TradeData.Param},Rect:g,TextRect:{X:I,Y:T}};this.TradeIconTooltipRect.push(x)}}}}}},this.GetTooltipData=function(t,e,a){for(var i in this.TradeIconTooltipRect){var r=this.TradeIconTooltipRect[i];if(r.Rect){var n=r.Rect;if(this.Canvas.beginPath(),this.Canvas.rect(n.X,n.Y,n.Width,n.Height),this.Canvas.isPointInPath(t,e))return w.Chart.Log("[ChartKLine::GetTooltipData] trade icon ",r),a.Data=r,a.ChartPaint=this,a.Type=2,!0}}for(var i in this.InfoTooltipRect){r=this.InfoTooltipRect[i];if(r.Rect){n=r.Rect;if(this.Canvas.beginPath(),this.Canvas.rect(n.X,n.Y,n.Width,n.Height),this.Canvas.isPointInPath(t,e))return a.Data=r,a.ChartPaint=this,a.Type=1,!0}}for(var i in this.TooltipRect){n=this.TooltipRect[i][1];if(this.Canvas.beginPath(),this.Canvas.rect(n.X,n.Y,n.Width,n.Height),this.Canvas.isPointInPath(t,e)){var s=this.TooltipRect[i][0];return a.Data=this.Data.Data[s],a.ChartPaint=this,a.Type=0,!0}}return!1},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={Max:null,Min:null};if(1==this.DrawType||4==this.DrawType)for(var a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];ha.IsNumber(r.Close)&&(null==e.Max&&(e.Max=r.Close),null==e.Min&&(e.Min=r.Close),e.Max<r.Close&&(e.Max=r.Close),e.Min>r.Close&&(e.Min=r.Close))}else for(a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){r=this.Data.Data[a];if(null!=r.Open&&null!=r.High&&null!=r.Low&&null!=r.Close)if(5==this.DrawType&&r.OrderFlow&&ha.IsNumber(r.OrderFlow.PriceOffset)){var n=r.High,s=r.Low;if(ha.IsNonEmptyArray(r.OrderFlow.High))for(var o=0;o<r.OrderFlow.High.length;++o){var h=r.OrderFlow.High[o];n<h.Price&&(n=h.Price)}if(ha.IsNonEmptyArray(r.OrderFlow.Low))for(o=0;o<r.OrderFlow.Low.length;++o){h=r.OrderFlow.Low[o];s>h.Price&&(s=h.Price)}n+=r.OrderFlow.PriceOffset,s-=r.OrderFlow.PriceOffset,null==e.Max&&(e.Max=n),null==e.Min&&(e.Min=s),e.Max<n&&(e.Max=n),e.Min>s&&(e.Min=s)}else null==e.Max&&(e.Max=r.High),null==e.Min&&(e.Min=r.Low),e.Max<r.High&&(e.Max=r.High),e.Min>r.Low&&(e.Min=r.Low)}return e},this.GetAllPrice=function(){for(var t=this.ChartFrame.XPointCount,e=new I.default,a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];if(null!=r.Open&&null!=r.High&&null!=r.Low&&null!=r.Close){var n=r.Close;e.add(n)}}var s=[],o=!0,h=!1,l=void 0;try{for(var u,C=(0,T.default)(e);!(o=(u=C.next()).done);o=!0){var D=u.value;s.push(D)}}catch(f){h=!0,l=f}finally{try{!o&&C.return&&C.return()}finally{if(h)throw l}}return s.sort((function(t,e){return t-e})),s},this.DrawLastPointEvent=function(t){if(this.GetEventCallback){var e=this.GetEventCallback(G.ON_DRAW_KLINE_LAST_POINT);if(e){var a={Data:this.ChartFrame.DataWidth,Distance:this.ChartFrame.DistanceWidth};if(t)var i={LastPoint:{X:t.X,Y:t.Y,XLeft:t.XLeft,XRight:t.XRight},KItem:t.KItem,DrawType:this.DrawType,KWidth:a,ChartRight:t.ChartRight};else i={LastPoint:null,KItem:null,KWidth:a};e.Callback(e,i,this)}}},this.DrawOrderFlow=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetBorder(),r=i.LeftEx+a/2+Oi.FrameLeftMargin,n=i.RightEx,s=this.ChartFrame.XPointCount;if(t){i=this.ChartBorder.GetHScreenBorder();r=i.TopEx+a/2+Oi.FrameLeftMargin,n=i.BottomEx}this.UpColor,this.DownColor,this.UnchagneColor;this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=s,this.DrawKRange.Start=this.Data.DataOffset;this.DrawOrderFlowHBar();for(var o=this.Data.DataOffset,h=0;o<this.Data.Data.length&&h<s;++o,++h,r+=e+a,++this.ShowRange.DataCount){var l=this.Data.Data[o];if(this.ShowRange.End=o,null!=l.Open&&null!=l.High&&null!=l.Low&&null!=l.Close){var u=r,C=r+e;if(C>n)break;var D=u+(C-u)/2,f=this.GetYFromData(l.Low,!1),c=this.GetYFromData(l.High,!1),d=this.GetYFromData(l.Open,!1),m=this.GetYFromData(l.Close,!1);this.DrawKRange.End=o;var v={Low:f,High:c,Open:d,Close:m},S={Left:u,Center:D,Right:C,DataWidth:e};if(this.DrawOrderFlowBar(l.OrderFlow,l,S,v,t),this.IsShowKTooltip&&!t){var I=Math.min(d,m),p=Math.max(d,m);Math.abs(d-m)<5&&(I=Math.min(c,I-5),p=Math.max(f,p+5));var T=new Yt(u,I,e,p-I);this.TooltipRect.push([o,T])}if(0==this.Data.DataType){var g={Xleft:u,XRight:C,XCenter:D,YMax:c,YMin:f,DayData:l,Index:h};this.DrawInfo(g)}o==this.Data.Data.length-1&&{X:D,Y:m,XLeft:u,XRight:C,KItem:l,ChartRight:n}}}},this.DrawOrderFlowBar=function(t,e,a,i,r){var n=Math.min(i.Open,i.Close),s=Math.max(i.Open,i.Close),o=Math.abs(i.Open-i.Close),h=0;t&&ha.IsNumber(t.PriceOffset)&&(h=this.GetPriceYOffset(t.PriceOffset));var l,u=this.GetDynamicOrderFlowFont(h,a.DataWidth/2);this.IsShowOrderText=h>5&&a.DataWidth>10,this.OrderFlow.AlwaysShowOrderText&&(this.IsShowOrderText=!0),l=e.Open<e.Close?this.OrderFlow.UpColor:e.Open>e.Close?this.OrderFlow.DownColor:this.OrderFlow.UnchagneColor;var C=a.DataWidth<4;C?(this.Canvas.strokeStyle=l.Border,this.Canvas.beginPath(),this.Canvas.moveTo(Q(a.Center),n-h/2),this.Canvas.lineTo(Q(a.Center),s+h/2),this.Canvas.stroke()):(this.Canvas.fillStyle=l.BG,this.Canvas.fillRect(tt(a.Left),tt(n-h/2),tt(a.DataWidth),tt(o+h))),this.Canvas.textBaseline="middle",this.Canvas.textAlign="center",this.Canvas.font=u;var D=a.DataWidth/2,f=D/2;if(t&&ha.IsNonEmptyArray(t.Order)){var c=0,d=0,m=null;if(this.OrderFlow.IsShowAskBar||this.OrderFlow.IsShowBidBar||this.OrderFlow.IsShowPOCBG)for(var v=0,S=0,I=0;I<t.Order.length;++I){var p=t.Order[I];S=0,p.Ask&&ha.IsNumber(p.Ask.Value)&&(c+=p.Ask.Value,S+=p.Ask.Value),p.Bid&&ha.IsNumber(p.Bid.Value)&&(d+=p.Bid.Value,S+=p.Bid.Value),v<S&&(v=S,m=I)}for(I=0;I<t.Order.length;++I){p=t.Order[I];var T=this.GetYFromData(p.Price,!1),g={Left:a.Left,Right:a.Center,Bottom:T+h/2,Top:T-h/2};if(g.Width=g.Right-g.Left,g.Height=g.Bottom-g.Top,p.Ask.BG&&(this.Canvas.fillStyle=p.Ask.BG,this.Canvas.fillRect(tt(g.Left),tt(g.Top),tt(g.Width),tt(g.Height))),this.OrderFlow.IsShowPOCBG&&m==I&&(this.Canvas.fillStyle=this.OrderFlow.POCGBColor,this.Canvas.fillRect(tt(g.Left),tt(g.Top),tt(g.Width),tt(g.Height))),this.OrderFlow.IsShowAskBar&&ha.IsNumber(p.Ask.Value)&&c>0){var x=g.Width*(p.Ask.Value/c);x<1&&(x=1),this.Canvas.fillStyle=this.OrderFlow.AskBarColor,this.Canvas.fillRect(tt(g.Right),tt(g.Top),tt(-x),tt(g.Height))}var F=null;if(ha.IsString(p.Ask.Text)?F=p.Ask.Text:ha.IsNumber(p.Ask.Value)&&(F=p.Ask.Value.toString()),F&&this.IsShowOrderText&&this.OrderFlow.IsShowAskText)if(p.Ask.Color?this.Canvas.fillStyle=p.Ask.Color:this.Canvas.fillStyle=this.OrderFlow.Text.Color,p.Ask.Font){var y=this.GetDynamicOrderFlowFont(h,a.DataWidth/2,p.Ask.Font);this.Canvas.font=y,this.Canvas.fillText(F,a.Left+f,T),this.Canvas.font=u}else this.Canvas.fillText(F,a.Left+f,T);g={Left:a.Center,Right:a.Right,Bottom:T+h/2,Top:T-h/2};if(g.Width=g.Right-g.Left,g.Height=g.Bottom-g.Top,p.Bid.BG&&(this.Canvas.fillStyle=p.Bid.BG,this.Canvas.fillRect(tt(g.Left),tt(g.Top),tt(g.Width),tt(g.Height))),this.OrderFlow.IsShowPOCBG&&m==I&&(this.Canvas.fillStyle=this.OrderFlow.POCGBColor,this.Canvas.fillRect(tt(g.Left),tt(g.Top),tt(g.Width),tt(g.Height))),this.OrderFlow.IsShowBidBar&&ha.IsNumber(p.Bid.Value)&&d>0){x=g.Width*(p.Bid.Value/d);x<1&&(x=1),this.Canvas.fillStyle=this.OrderFlow.BidBarColor,this.Canvas.fillRect(tt(g.Left),tt(g.Top),tt(x),tt(g.Height))}F=null;if(ha.IsString(p.Bid.Text)?F=p.Bid.Text:ha.IsNumber(p.Bid.Value)&&(F=p.Bid.Value.toString()),F&&this.IsShowOrderText&&this.OrderFlow.IsShowBidText)if(p.Bid.Color?this.Canvas.fillStyle=p.Bid.Color:this.Canvas.fillStyle=this.OrderFlow.Text.Color,p.Bid.Font){y=this.GetDynamicOrderFlowFont(h,a.DataWidth/2,p.Bid.Font);this.Canvas.font=y,this.Canvas.fillText(F,a.Center+f,T),this.Canvas.font=u}else this.Canvas.fillText(F,a.Center+f,T)}}(i.High<n||i.Low>s)&&(this.Canvas.strokeStyle=this.OrderFlow.Line.UpDownColor,i.High<n&&(this.Canvas.beginPath(),this.Canvas.moveTo(Q(a.Center),i.High-h/2),this.Canvas.lineTo(Q(a.Center),n-h/2),this.Canvas.stroke()),i.Low>s&&(this.Canvas.beginPath(),this.Canvas.moveTo(Q(a.Center),i.Low+h/2),this.Canvas.lineTo(Q(a.Center),s+h/2),this.Canvas.stroke())),!C&&Math.abs(i.Open-i.Close)>1&&(this.Canvas.strokeStyle=this.OrderFlow.Line.MiddleColor,this.Canvas.beginPath(),this.Canvas.moveTo(Q(a.Center),n-h/2),this.Canvas.lineTo(Q(a.Center),s+h/2),this.Canvas.stroke()),C||(this.Canvas.beginPath(),this.Canvas.strokeStyle=l.Border,this.Canvas.rect(Q(a.Left),Q(n-h/2),tt(a.DataWidth),tt(o+h)),this.Canvas.stroke());u=this.GetDynamicOrderFlowFont(h,a.DataWidth);if(t&&ha.IsNonEmptyArray(t.High)&&this.IsShowOrderText)for(I=0;I<t.High.length;++I){p=t.High[I];if(ha.IsString(p.Text)?F=p.Text:ha.IsNumber(p.Value)&&(F=p.Value.toString()),F){p.Color?this.Canvas.fillStyle=p.Color:this.Canvas.fillStyle=this.OrderFlow.Text.Color;T=this.GetYFromData(p.Price,!1);if(p.Font){y=this.GetDynamicOrderFlowFont(h,a.DataWidth,p.Font);this.Canvas.font=y,this.Canvas.fillText(F,a.Center,T),this.Canvas.font=u}else this.Canvas.fillText(F,a.Center,T)}}if(t&&ha.IsNonEmptyArray(t.Low)&&this.IsShowOrderText)for(I=0;I<t.Low.length;++I){p=t.Low[I];if(ha.IsString(p.Text)?F=p.Text:ha.IsNumber(p.Value)&&(F=p.Value.toString()),F){p.Color?this.Canvas.fillStyle=p.Color:this.Canvas.fillStyle=this.OrderFlow.Text.Color;T=this.GetYFromData(p.Price,!1);if(p.Font){y=this.GetDynamicOrderFlowFont(h,a.DataWidth,p.Font);this.Canvas.font=y,this.Canvas.fillText(F,a.Center,T),this.Canvas.font=u}else this.Canvas.fillText(F,a.Center,T)}}},this.GetPriceYOffset=function(t){var e=this.ChartFrame,a=e.ChartBorder.GetHeightEx()*t/(e.HorizontalMax-e.HorizontalMin);return a},this.GetDynamicOrderFlowFont=function(t,e,a){var i=parseInt(t)-2;t<5&&(i=parseInt(t)),i>this.OrderFlow.Text.FontMaxSize?i=this.OrderFlow.Text.FontMaxSize:i<=0&&(i=1);for(var r=this.FormatFontString(i,this.OrderFlow.Text.Family,a),n=i;n>0;n-=2){r=this.FormatFontString(n,this.OrderFlow.Text.Family,a);this.Canvas.font=r;var s=this.Canvas.measureText(this.OrderFlow.Text.MaxValue).width+2;if(s<e)break}return r},this.FormatFontString=function(t,e,a){var i;return a?a.Weight&&(i=a.Weight+" "+t+"px "+e):i=t+"px "+e,i},this.DrawOrderFlowHBar=function(){for(var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartFrame.XPointCount,i=this.ChartFrame.HorizontalMax,r=this.ChartFrame.HorizontalMin,n=this.Data.DataOffset,s=this.Data.DataOffset+a,o=0;o<this.Data.Data.length;++o){var h=this.Data.Data[o];if(h&&h.OrderFlow&&ha.IsNonEmptyArray(h.OrderFlow.Order))for(var l=0;l<h.OrderFlow.Order.length;++l){var u=h.OrderFlow.Order[l];if(u.HBar&&(ha.IsNumber(u.HBar.Width)&&ha.IsNumber(u.Price)&&!(u.Price>i||u.Price<r))){var C=Math.ceil(o+u.HBar.Width),D=Math.min(o,C),f=Math.max(o,C);f<n||D>s||this.DrawOrderFlowHBarItem(o,h.OrderFlow,u,t,e)}}}},this.DrawOrderFlowHBarItem=function(t,e,a,i,r){var n=this.ShowRange.Start,s=(this.ShowRange.Start,this.ShowRange.ShowCount,this.GetYFromData(a.Price,!1)),o=parseInt(t+a.HBar.Width),h=t-n,l=o-n;if(h<0&&(h=0),l<0&&(l=0),h<=l){this.ChartBorder.GetRight(),this.ChartFrame.XPointCount;var u=n,C=this.GetPriceYOffset(e.PriceOffset),D=this.ChartFrame.GetXFromIndex(h)-i/2;if(1==a.HBar.Type)for(var f=0,c=t+1;f<a.HBar.Width&&c<this.Data.Data.length;++f,++c){var d=this.Data.Data[c];if(d.Close<a.Price){l=c-1-u;break}}else if(2==a.HBar.Type)for(f=0,c=t+1;f<a.HBar.Width&&c<this.Data.Data.length;++f,++c){d=this.Data.Data[c];if(d.Close>a.Price){l=c-1-u;break}}if(l<0)return;var m=this.ChartFrame.GetXFromIndex(l)+i/2,v=s-C/2,S=C+.5;ha.IsNumber(a.HBar.Height)&&(S=a.HBar.Height*C+.1);var I=a.HBar.Width-parseInt(a.HBar.Width);I>1e-6&&(m+=(i+r)*I),this.Canvas.fillStyle=a.HBar.Color,this.Canvas.fillRect(tt(D),tt(v),tt(m-D),tt(S))}},this.PtInChart=function(t,e){return 1==this.DrawType||4==this.DrawType?this.PtInLine(t,e,{KLineClose:!0}):this.PtInKBar(t,e)},this.DrawSelectedStatus=function(){this.DrawLinePoint({KLineClose:!0})},this.DrawOrderFlow_Style2=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetBorder(),r=i.LeftEx+a/2+Oi.FrameLeftMargin,n=i.RightEx,s=this.ChartFrame.XPointCount;if(this.AryOrderFlowBorder=[],t){i=this.ChartBorder.GetHScreenBorder();r=i.TopEx+a/2+Oi.FrameLeftMargin,n=i.BottomEx}var o=this.OrderFlow_Style2.UpColor,h=this.OrderFlow_Style2.DownColor,l=this.OrderFlow_Style2.UnchagneColor,u=tt(this.OrderFlow_Style2.BarWidth),C=e-u;C/7<u&&(u=C/7),u<=1&&(u=2),this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=s,this.DrawKRange.Start=this.Data.DataOffset,this.DrawOrderFlowHBar();for(var D=this.Data.DataOffset,f=0;D<this.Data.Data.length&&f<s;++D,++f,r+=e+a,++this.ShowRange.DataCount){var c=this.Data.Data[D];if(this.ShowRange.End=D,null!=c.Open&&null!=c.High&&null!=c.Low&&null!=c.Close){var d=r,m=r+e;if(m>n)break;var v=d+(m-d)/2,S=this.GetYFromData(c.Low,!1),I=this.GetYFromData(c.High,!1),p=this.GetYFromData(c.Open,!1),T=this.GetYFromData(c.Close,!1);this.DrawKRange.End=D;var g=Math.min(p,T),x=Math.max(p,T),F=tt(d),y=F+u;c.Open<c.Close?this.Canvas.fillStyle=o:c.Open>c.Close?this.Canvas.fillStyle=h:this.Canvas.fillStyle=l;var L=0;c.OrderFlow&&ha.IsNumber(c.OrderFlow.PriceOffset)&&(L=this.GetPriceYOffset(c.OrderFlow.PriceOffset)),this.Canvas.fillRect(F,tt(g-L/2),u,tt(x-g+L));var E={Low:S,High:I,Open:p,Close:T},M={Left:y,Center:v,Right:m,DataWidth:m-y};M.Center=M.Left+M.DataWidth/2,this.DrawOrderFlowBar_Style2(c.OrderFlow,c,M,E,t)}}if(e-u>5)for(D=0;D<this.AryOrderFlowBorder.length;++D){var A=this.AryOrderFlowBorder[D];if(A&&A.Rect&&A.Color){var N=A.Rect;this.Canvas.strokeStyle=A.Color,this.Canvas.beginPath(),this.Canvas.rect(Q(N.Left),Q(N.Top),tt(N.Width),tt(N.Height)),this.Canvas.stroke()}}this.AryOrderFlowBorder=[]},this.DrawOrderFlow_Style3=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetBorder(),r=i.LeftEx+a/2+Oi.FrameLeftMargin,n=i.RightEx,s=this.ChartFrame.XPointCount;if(this.AryOrderFlowBorder=[],t){i=this.ChartBorder.GetHScreenBorder();r=i.TopEx+a/2+Oi.FrameLeftMargin,n=i.BottomEx}var o=this.OrderFlow_Style3.UpColor,h=this.OrderFlow_Style3.DownColor,l=this.OrderFlow_Style3.UnchagneColor,u=tt(this.OrderFlow_Style3.BarWidth);e/4<u&&(u=e/4),u<=1&&(u=2),this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=s,this.DrawKRange.Start=this.Data.DataOffset,this.DrawOrderFlowHBar();for(var C=this.Data.DataOffset,D=0;C<this.Data.Data.length&&D<s;++C,++D,r+=e+a,++this.ShowRange.DataCount){var f=this.Data.Data[C];if(this.ShowRange.End=C,null!=f.Open&&null!=f.High&&null!=f.Low&&null!=f.Close){var c=r,d=r+e;if(d>n)break;var m=this.GetYFromData(f.Low,!1),v=this.GetYFromData(f.High,!1),S=this.GetYFromData(f.Open,!1),I=this.GetYFromData(f.Close,!1);this.DrawKRange.End=C;var p=Math.min(S,I),T=Math.max(S,I),g=tt(c),x=g+u;f.Open<f.Close?this.Canvas.fillStyle=o:f.Open>f.Close?this.Canvas.fillStyle=h:this.Canvas.fillStyle=l;var F=0;f.OrderFlow&&ha.IsNumber(f.OrderFlow.PriceOffset)&&(F=this.GetPriceYOffset(f.OrderFlow.PriceOffset)),this.Canvas.fillRect(g,tt(p-F/2),u,tt(T-p+F));var y={Low:m,High:v,Open:S,Close:I},L={Left:x,Right:d,DataWidth:d-x};this.DrawOrderFlowBar_Style3(f.OrderFlow,f,L,y,t)}}if(e-u>5)for(C=0;C<this.AryOrderFlowBorder.length;++C){var E=this.AryOrderFlowBorder[C];if(E&&E.Rect&&E.Color){var M=E.Rect;this.Canvas.strokeStyle=E.Color,this.Canvas.beginPath(),this.Canvas.rect(Q(M.Left),Q(M.Top),tt(M.Width),tt(M.Height)),this.Canvas.stroke()}}this.AryOrderFlowBorder=[]},this.DrawOrderFlowBar_Style2=function(t,e,a,i,r){Math.min(i.Open,i.Close),Math.max(i.Open,i.Close),Math.abs(i.Open-i.Close);var n=0;t&&ha.IsNumber(t.PriceOffset)&&(n=this.GetPriceYOffset(t.PriceOffset));var s=this.GetDynamicOrderFlowFont(n,a.DataWidth/2);this.IsShowOrderText=n>5&&a.DataWidth>10,this.OrderFlow.AlwaysShowOrderText&&(this.IsShowOrderText=!0),this.Canvas.textBaseline="middle",this.Canvas.textAlign="left",this.Canvas.font=s;a.DataWidth;var o=2;if(t&&ha.IsNonEmptyArray(t.Order))for(var h=0;h<t.Order.length;++h){var l=t.Order[h],u=this.GetYFromData(l.Price,!1),C={Left:a.Left,Right:a.Center,Bottom:u+n/2,Top:u-n/2};if(C.Width=C.Right-C.Left,C.Height=C.Bottom-C.Top,l.Ask.BG&&(this.Canvas.fillStyle=l.Ask.BG,this.Canvas.fillRect(tt(C.Left),tt(C.Top),tt(C.Width),tt(C.Height))),l.Ask.BorderColor){var D={Rect:C,Color:l.Ask.BorderColor};this.AryOrderFlowBorder.push(D)}var f=null;if(ha.IsString(l.Ask.Text)?f=l.Ask.Text:ha.IsNumber(l.Ask.Value)&&(f=l.Ask.Value.toString()),f&&this.IsShowOrderText)if(l.Ask.Color?this.Canvas.fillStyle=l.Ask.Color:this.Canvas.fillStyle=this.OrderFlow.Text.Color,l.Ask.Font){var c=this.GetDynamicOrderFlowFont(n,a.DataWidth/2,l.Ask.Font);this.Canvas.font=c,this.Canvas.fillText(f,a.Left+o,u),this.Canvas.font=s}else this.Canvas.fillText(f,a.Left+o,u);C={Left:a.Center,Right:a.Right,Bottom:u+n/2,Top:u-n/2};if(C.Width=C.Right-C.Left,C.Height=C.Bottom-C.Top,l.Bid.BG&&(this.Canvas.fillStyle=l.Bid.BG,this.Canvas.fillRect(tt(C.Left),tt(C.Top),tt(C.Width),tt(C.Height))),l.Bid.BorderColor){D={Rect:C,Color:l.Bid.BorderColor};this.AryOrderFlowBorder.push(D)}f=null;if(ha.IsString(l.Bid.Text)?f=l.Bid.Text:ha.IsNumber(l.Bid.Value)&&(f=l.Bid.Value.toString()),f&&this.IsShowOrderText)if(l.Bid.Color?this.Canvas.fillStyle=l.Bid.Color:this.Canvas.fillStyle=this.OrderFlow.Text.Color,l.Bid.Font){c=this.GetDynamicOrderFlowFont(n,a.DataWidth/2,l.Bid.Font);this.Canvas.font=c,this.Canvas.fillText(f,a.Center+o,u),this.Canvas.font=s}else this.Canvas.fillText(f,a.Center+o,u)}},this.DrawOrderFlowBar_Style3=function(t,e,a,i,r){Math.min(i.Open,i.Close),Math.max(i.Open,i.Close),Math.abs(i.Open-i.Close);var n=a.DataWidth-4,s=0;t&&ha.IsNumber(t.PriceOffset)&&(s=this.GetPriceYOffset(t.PriceOffset));var o=this.GetDynamicOrderFlowFont(s,n);this.IsShowOrderText=s>5&&a.DataWidth>10,this.OrderFlow.AlwaysShowOrderText&&(this.IsShowOrderText=!0),this.Canvas.textBaseline="middle",this.Canvas.textAlign="left",this.Canvas.font=o;var h=2;if(t&&ha.IsNonEmptyArray(t.Order))for(var l=0;l<t.Order.length;++l){var u=t.Order[l],C=this.GetYFromData(u.Price,!1),D={Left:a.Left,Right:a.Right,Bottom:C+s/2,Top:C-s/2};if(D.Width=D.Right-D.Left,D.Height=D.Bottom-D.Top,u.Item.BG&&(this.Canvas.fillStyle=u.Item.BG,this.Canvas.fillRect(tt(D.Left),tt(D.Top),tt(D.Width),tt(D.Height))),u.Item.BorderColor){var f={Rect:D,Color:u.Item.BorderColor};this.AryOrderFlowBorder.push(f)}var c=null;if(ha.IsString(u.Item.Text)?c=u.Item.Text:ha.IsNumber(u.Item.Value)&&(c=u.Item.Value.toString()),c&&this.IsShowOrderText)if(u.Item.Color?this.Canvas.fillStyle=u.Item.Color:this.Canvas.fillStyle=this.OrderFlow.Text.Color,u.Item.Font){var d=this.GetDynamicOrderFlowFont(s,n,u.Item.Font);this.Canvas.font=d,this.Canvas.fillText(c,a.Left+h,C),this.Canvas.font=o}else this.Canvas.fillText(c,a.Left+h,C)}}}function Kt(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartColorKline",this.Symbol,this.Color="rgb(0,255,44)",this.IsEmptyBar=!1,this.DrawType=0,this.KLineColor,this.DrawName,this.Draw=function(){if(this.IsShow)if("DRAWCOLORKLINE"==this.DrawName)this.DrawColorBar();else{if(!this.KLineColor)return;this.DrawBar()}},this.DrawUpBarItem=function(t,e,a,i){var r=!0===this.ChartFrame.IsHScreen,n=e,s=e+a,o=n+(s-n)/2,h=this.ChartFrame.GetYFromData(t.Low),l=this.ChartFrame.GetYFromData(t.High),u=this.ChartFrame.GetYFromData(t.Open),C=this.ChartFrame.GetYFromData(t.Close),D=l;a>=4?(t.High>t.Close?(this.Canvas.beginPath(),r?(this.Canvas.moveTo(Q(D),Q(o)),this.Canvas.lineTo(Q(3==this.DrawType?Math.max(C,u):C),Q(o))):(this.Canvas.moveTo(Q(o),Q(D)),this.Canvas.lineTo(Q(o),Q(3==this.DrawType?Math.min(C,u):C))),this.Canvas.stroke(),D=C):D=C,r?Math.abs(u-D)<1?this.Canvas.fillRect(tt(D),tt(n),1,tt(a)):3==this.DrawType?(this.Canvas.beginPath(),this.Canvas.rect(Q(D),Q(n),tt(u-D),tt(a)),this.Canvas.stroke()):this.Canvas.fillRect(tt(D),tt(n),tt(u-D),tt(a)):Math.abs(u-D)<1?this.Canvas.fillRect(tt(n),tt(D),tt(a),1):3==this.DrawType?(this.Canvas.beginPath(),this.Canvas.rect(Q(n),Q(D),tt(a),tt(u-D)),this.Canvas.stroke()):this.Canvas.fillRect(tt(n),tt(Math.min(D,u)),tt(a),tt(Math.abs(u-D))),t.Open>t.Low&&(this.Canvas.beginPath(),r?(this.Canvas.moveTo(Q(3==this.DrawType?Math.min(C,u):D),Q(o)),this.Canvas.lineTo(Q(h),Q(o))):(this.Canvas.moveTo(Q(o),Q(3==this.DrawType?Math.max(C,u):D)),this.Canvas.lineTo(Q(o),Q(h))),this.Canvas.stroke())):(this.Canvas.beginPath(),r?(this.Canvas.moveTo(l,Q(o)),this.Canvas.lineTo(h,Q(o))):(this.Canvas.moveTo(Q(o),l),this.Canvas.lineTo(Q(o),h)),this.Canvas.stroke())},this.DrawDownBarItem=function(t,e,a,i){var r=!0===this.ChartFrame.IsHScreen,n=e,s=e+a,o=n+(s-n)/2,h=this.ChartFrame.GetYFromData(t.Low),l=this.ChartFrame.GetYFromData(t.High),u=this.ChartFrame.GetYFromData(t.Open),C=this.ChartFrame.GetYFromData(t.Close),D=l;a>=4?(t.High>t.Close?(this.Canvas.beginPath(),r?(this.Canvas.moveTo(Q(D),Q(o)),this.Canvas.lineTo(Q(u),Q(o))):(this.Canvas.moveTo(Q(o),Q(D)),this.Canvas.lineTo(Q(o),Q(u))),this.Canvas.stroke(),D=u):D=u,r?Math.abs(C-D)<1?this.Canvas.fillRect(tt(D),tt(n),1,tt(a)):this.Canvas.fillRect(tt(D),tt(n),tt(C-D),tt(a)):Math.abs(C-D)<1?this.Canvas.fillRect(tt(n),tt(D),tt(a),1):this.Canvas.fillRect(tt(n),tt(Math.min(D,C)),tt(a),tt(Math.abs(C-D))),t.Open>t.Low&&(this.Canvas.beginPath(),r?(this.Canvas.moveTo(Q(D),Q(o)),this.Canvas.lineTo(Q(h),Q(o))):(this.Canvas.moveTo(Q(o),Q(D)),this.Canvas.lineTo(Q(o),Q(h))),this.Canvas.stroke())):(this.Canvas.beginPath(),r?(this.Canvas.moveTo(l,Q(o)),this.Canvas.lineTo(h,Q(o))):(this.Canvas.moveTo(Q(o),l),this.Canvas.lineTo(Q(o),h)),this.Canvas.stroke())},this.DrawUnChangeBarItem=function(t,e,a,i){var r=!0===this.ChartFrame.IsHScreen,n=e,s=e+a,o=n+(s-n)/2,h=this.ChartFrame.GetYFromData(t.Low),l=this.ChartFrame.GetYFromData(t.High),u=this.ChartFrame.GetYFromData(t.Open),C=(this.ChartFrame.GetYFromData(t.Close),l);a>=4?(this.Canvas.beginPath(),t.High>t.Close?(r?(this.Canvas.moveTo(C,Q(o)),this.Canvas.lineTo(u,Q(o))):(this.Canvas.moveTo(Q(o),C),this.Canvas.lineTo(Q(o),u)),C=u):C=u,r?(this.Canvas.moveTo(Q(C),Q(n)),this.Canvas.lineTo(Q(C),Q(s))):(this.Canvas.moveTo(Q(n),Q(C)),this.Canvas.lineTo(Q(s),Q(C))),t.Open>t.Low&&(r?(this.Canvas.moveTo(Q(C),Q(o)),this.Canvas.lineTo(Q(h),Q(o))):(this.Canvas.moveTo(Q(o),Q(C)),this.Canvas.lineTo(Q(o),Q(h)))),this.Canvas.stroke()):(this.Canvas.beginPath(),r?(this.Canvas.moveTo(l,Q(o)),this.Canvas.lineTo(h,Q(o))):(this.Canvas.moveTo(Q(o),l),this.Canvas.lineTo(Q(o),h)),this.Canvas.stroke())},this.DrawBar=function(){var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartBorder.GetLeft()+e/2+2,i=this.ChartBorder.GetRight(),r=this.ChartFrame.XPointCount;this.IsHScreen&&(a=this.ChartBorder.GetTop()+e/2+2,i=this.ChartBorder.GetBottom());for(var n=this.Data.DataOffset,s=0;n<this.Data.Data.length&&s<r;++n,++s,a+=t+e){var o=this.Data.Data[n];if(null!=o.Open&&null!=o.High&&null!=o.Low&&null!=o.Close&&this.KLineColor.has(n)){var h=this.KLineColor.get(n),l=a+t;if(l>i)break;h.Color?(this.Canvas.strokeStyle=h.Color,this.Canvas.fillStyle=h.Color):(this.Canvas.strokeStyle=this.Color,this.Canvas.fillStyle=this.Color),o.Open<o.Close?this.DrawUpBarItem(o,a,t,h):o.Open>o.Close?this.DrawDownBarItem(o,a,t,h):this.DrawUnChangeBarItem(o,a,t,h)}}},this.DrawColorBar=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetBorder(),r=i.LeftEx+a/2+Oi.FrameLeftMargin,n=i.RightEx,s=this.ChartFrame.XPointCount;if(t){i=this.ChartBorder.GetHScreenBorder();r=i.TopEx+a/2+Oi.FrameLeftMargin,n=i.BottomEx}for(var o=this.Data.DataOffset,h=0;o<this.Data.Data.length&&h<s;++o,++h,r+=e+a){var l=this.Data.Data[o];if(l&&(ha.IsNumber(l.Open)&&ha.IsNumber(l.High)&&ha.IsNumber(l.Low)&&ha.IsNumber(l.Close))){var u=r,C=r+e;if(C>n)break;var D=u+(C-u)/2,f=this.GetYFromData(l.Low,!1),c=this.GetYFromData(l.High,!1),d=this.GetYFromData(l.Open,!1),m=this.GetYFromData(l.Close,!1),v=c;l.Open==l.Close?this.DrawKBar_Unchagne(l,e,this.Color,this.IsEmptyBar,D,v,u,C,f,c,d,m,t):this.DrawKBar_Custom(l,e,this.Color,this.IsEmptyBar,D,v,u,C,f,c,d,m,t)}}},this.DrawKBar_Unchagne=function(t,e,a,i,r,n,s,o,h,l,u,C,D){if(e>=4){if(e%2!=0&&(e-=1),this.Canvas.strokeStyle=a,this.Canvas.beginPath(),t.High>t.Close){if(D)this.Canvas.moveTo(n,Q(r)),this.Canvas.lineTo(u,Q(r));else{var f=Q(s+e/2);this.Canvas.moveTo(f,n),this.Canvas.lineTo(f,u)}n=u}else n=u;if(D?(this.Canvas.moveTo(Q(n),Q(s)),this.Canvas.lineTo(Q(n),Q(o))):(this.Canvas.moveTo(Q(s),Q(n)),this.Canvas.lineTo(Q(s+e),Q(n))),t.Open>t.Low)if(D)this.Canvas.moveTo(Q(n),Q(r)),this.Canvas.lineTo(Q(h),Q(r));else{f=Q(s+e/2);this.Canvas.moveTo(f,Q(n)),this.Canvas.lineTo(f,Q(h))}this.Canvas.stroke()}else this.Canvas.beginPath(),D?(this.Canvas.moveTo(l,Q(r)),this.Canvas.lineTo(h,Q(r))):(this.Canvas.moveTo(Q(r),l),this.Canvas.lineTo(Q(r),h)),this.Canvas.strokeStyle=a,this.Canvas.stroke()},this.DrawKBar_Custom=function(t,e,a,i,r,n,s,o,h,l,u,C,D){if(i&&e%2!=0&&(e-=1),e>=4){if(this.Canvas.strokeStyle=a,t.High>t.Close){if(this.Canvas.beginPath(),D)this.Canvas.moveTo(Q(n),Q(r)),this.Canvas.lineTo(Q(i?Math.max(C,u):C),Q(r));else if(i){var f=s+e/2;this.Canvas.moveTo(Q(f),Q(n)),this.Canvas.lineTo(Q(f),Q(Math.min(C,u)))}else this.Canvas.moveTo(Q(r),Q(n)),this.Canvas.lineTo(Q(r),Q(C));this.Canvas.stroke(),n=C}else n=C;if(this.Canvas.fillStyle=a,D?Math.abs(u-n)<1?this.Canvas.fillRect(tt(n),tt(s),1,tt(e)):i?(this.Canvas.beginPath(),this.Canvas.rect(Q(n),Q(s),tt(u-n),tt(e)),this.Canvas.stroke()):this.Canvas.fillRect(tt(n),tt(s),tt(u-n),tt(e)):Math.abs(u-n)<1?this.Canvas.fillRect(tt(s),tt(n),tt(e),1):i?(this.Canvas.beginPath(),this.Canvas.rect(Q(s),Q(n),tt(e),tt(u-n)),this.Canvas.stroke()):this.Canvas.fillRect(tt(s),tt(Math.min(n,u)),tt(e),tt(Math.abs(u-n))),t.Open>t.Low){if(this.Canvas.beginPath(),D)this.Canvas.moveTo(Q(i?Math.min(C,u):n),Q(r)),this.Canvas.lineTo(Q(h),Q(r));else if(i){f=s+e/2;this.Canvas.moveTo(Q(f),Q(Math.max(C,u))),this.Canvas.lineTo(Q(f),Q(h))}else this.Canvas.moveTo(Q(r),Q(n)),this.Canvas.lineTo(Q(r),Q(h));this.Canvas.stroke()}}else this.Canvas.beginPath(),D?(this.Canvas.moveTo(l,Q(r)),this.Canvas.lineTo(h,Q(r))):(this.Canvas.moveTo(Q(r),l),this.Canvas.lineTo(Q(r),h)),this.Canvas.strokeStyle=a,this.Canvas.stroke()},this.GetMaxMin=function(){var t={Max:null,Min:null};if("DRAWCOLORKLINE"==this.DrawName)for(var e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<e;++a,++i){var r=this.Data.Data[a];r&&(null!=r.Open&&null!=r.High&&null!=r.Low&&null!=r.Close&&(null==t.Max&&(t.Max=r.High),null==t.Min&&(t.Min=r.Low),t.Max<r.High&&(t.Max=r.High),t.Min>r.Low&&(t.Min=r.Low)))}return t}}var Jt={STATUS_NONE_ID:0,STATUS_REQUESTDATA_ID:1,STATUS_RECVDATA_ID:2,STATUS_FINISHED_ID:3};function zt(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartOverlayKLine",this.Color="rgb(65,105,225)",this.MainData,this.SourceData,this.Title,this.DrawType=0,this.CustomDrawType=null,this.Status=Jt.STATUS_NONE_ID,this.IsDelete=!1,this.CloseLineWidth=Oi.CloseLineWidth,this.ShowRange={},this.DrawKRange={Start:null,End:null},this.YInfoType=4,this.SetOption=function(t){t&&(ha.IsNumber(t.DrawType)&&(this.CustomDrawType=t.DrawType),ha.IsNumber(t.YInfoType)&&(this.YInfoType=t.YInfoType))},this.DrawKBar=function(t){var e=!0===this.ChartFrame.IsHScreen,a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetLeft()+i/2+2;e&&(r=this.ChartBorder.GetTop()+i/2+2);var n=this.ChartBorder.GetRight();e&&(n=this.ChartBorder.GetBottom());var s=this.ChartFrame.XPointCount,o=this.DrawType;null!=this.CustomDrawType&&(o=this.CustomDrawType);var h=!0,l=null;this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=s,this.ShowRange.FirstOpen=t,this.DrawKRange.Start=this.Data.DataOffset;for(var u=this.Data.DataOffset,C=0;u<this.Data.Data.length&&C<s;++u,++C,r+=a+i,++this.ShowRange.DataCount){var D=this.Data.Data[u];if(D&&null!=D.Open&&null!=D.High&&null!=D.Low&&null!=D.Close){null==l&&(l=D.Open,this.ShowRange.FirstOverlayOpen=D.Open),h&&(this.Canvas.strokeStyle=this.Color,this.Canvas.fillStyle=this.Color,this.Canvas.beginPath(),h=!1);var f=r,c=r+a;if(c>n)break;var d=f+(c-f)/2,m=this.GetYFromData(D.Low/l*t,!1),v=this.GetYFromData(D.High/l*t,!1),S=this.GetYFromData(D.Open/l*t,!1),I=this.GetYFromData(D.Close/l*t,!1),p=v;this.DrawKRange.End=u,D.Open<D.Close?a>=4?(D.High>D.Close?(e?(this.Canvas.moveTo(Q(p),Q(d)),this.Canvas.lineTo(Q(3==this.DrawType?Math.max(I,S):I),Q(d))):(this.Canvas.moveTo(Q(d),Q(p)),this.Canvas.lineTo(Q(d),Q(3==this.DrawType?Math.min(I,S):I))),p=I):p=I,e?Math.abs(S-p)<1?this.Canvas.fillRect(tt(p),tt(f),1,tt(a)):3==o?this.Canvas.rect(Q(p),Q(f),tt(S-p),tt(a)):this.Canvas.fillRect(tt(p),tt(f),tt(S-p),tt(a)):Math.abs(S-p)<1?this.Canvas.fillRect(tt(f),tt(p),tt(a),1):3==o?this.Canvas.rect(Q(f),Q(p),tt(a),tt(S-p)):this.Canvas.fillRect(tt(f),tt(p),tt(a),tt(S-p)),D.Open>D.Low&&(e?(this.Canvas.moveTo(Q(3==this.DrawType?Math.min(I,S):p),Q(d)),this.Canvas.lineTo(Q(m),Q(d))):(this.Canvas.moveTo(Q(d),Q(3==this.DrawType?Math.max(I,S):p)),this.Canvas.lineTo(Q(d),Q(m))))):e?(this.Canvas.moveTo(v,Q(d)),this.Canvas.lineTo(m,Q(d))):(this.Canvas.moveTo(Q(d),v),this.Canvas.lineTo(Q(d),m)):D.Open>D.Close?a>=4?(D.High>D.Close?(e?(this.Canvas.moveTo(Q(p),Q(d)),this.Canvas.lineTo(Q(S),Q(d))):(this.Canvas.moveTo(Q(d),Q(p)),this.Canvas.lineTo(Q(d),Q(S))),p=S):p=S,e?Math.abs(I-p)<1?this.Canvas.fillRect(tt(p),tt(f),1,tt(a)):this.Canvas.fillRect(tt(p),tt(f),tt(I-p),tt(a)):Math.abs(I-p)<1?this.Canvas.fillRect(tt(f),tt(p),tt(a),1):this.Canvas.fillRect(tt(f),tt(p),tt(a),tt(I-p)),D.Open>D.Low&&(e?(this.Canvas.moveTo(Q(p),Q(d)),this.Canvas.lineTo(Q(m),Q(d))):(this.Canvas.moveTo(Q(d),Q(p)),this.Canvas.lineTo(Q(d),Q(m))))):e?(this.Canvas.moveTo(v,Q(d)),this.Canvas.lineTo(m,Q(d))):(this.Canvas.moveTo(Q(d),v),this.Canvas.lineTo(Q(d),m)):a>=4?(D.High>D.Close?(e?(this.Canvas.moveTo(p,Q(d)),this.Canvas.lineTo(S,Q(d))):(this.Canvas.moveTo(Q(d),p),this.Canvas.lineTo(Q(d),S)),p=S):p=S,e?(this.Canvas.moveTo(Q(p),Q(f)),this.Canvas.lineTo(Q(p),Q(c))):(this.Canvas.moveTo(Q(f),Q(p)),this.Canvas.lineTo(Q(c),Q(p))),D.Open>D.Low&&(e?(this.Canvas.moveTo(Q(p),Q(d)),this.Canvas.lineTo(Q(m),Q(d))):(this.Canvas.moveTo(Q(d),Q(p)),this.Canvas.lineTo(Q(d),Q(m))))):e?(this.Canvas.moveTo(v,Q(d)),this.Canvas.lineTo(m,Q(d))):(this.Canvas.moveTo(Q(d),v),this.Canvas.lineTo(Q(d),m));var T=Math.min(m,v,S,I),g=Math.max(m,v,S,I),x=new Yt(f,T,a,g-T);this.TooltipRect.push([u,x])}}0==h&&this.Canvas.stroke()},this.DrawAKLine=function(t){var e=!0===this.ChartFrame.IsHScreen,a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetLeft()+i/2+2;e&&(r=this.ChartBorder.GetTop()+i/2+2);var n=this.ChartBorder.GetRight();e&&(n=this.ChartBorder.GetBottom());var s=this.ChartFrame.XPointCount,o=null;this.Canvas.strokeStyle=this.Color;for(var h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<s;++h,++l,r+=a+i,++this.ShowRange.DataCount){var u=this.Data.Data[h];if(null!=u.Open&&null!=u.High&&null!=u.Low&&null!=u.Close){null==o&&(o=u.Open);var C=r,D=r+a;if(D>n)break;var f=C+(D-C)/2,c=this.GetYFromData(u.Low/o*t,!1),d=this.GetYFromData(u.High/o*t,!1),m=this.GetYFromData(u.Open/o*t,!1),v=this.GetYFromData(u.Close/o*t,!1);this.Canvas.beginPath(),e?(this.Canvas.moveTo(d,Q(f)),this.Canvas.lineTo(c,Q(f))):(this.Canvas.moveTo(Q(f),d),this.Canvas.lineTo(Q(f),c)),this.Canvas.stroke(),a>=4&&(this.Canvas.beginPath(),e?(this.Canvas.moveTo(Q(m),C),this.Canvas.lineTo(Q(m),f)):(this.Canvas.moveTo(C,Q(m)),this.Canvas.lineTo(f,Q(m))),this.Canvas.stroke(),this.Canvas.beginPath(),e?(this.Canvas.moveTo(Q(v),D),this.Canvas.lineTo(Q(v),f)):(this.Canvas.moveTo(D,Q(v)),this.Canvas.lineTo(f,Q(v))),this.Canvas.stroke())}}},this.DrawCloseLine=function(t){var e=!0===this.ChartFrame.IsHScreen,a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetLeft()+i/2+2;e&&(r=this.ChartBorder.GetTop()+i/2+2);var n=this.ChartBorder.GetRight();e&&(n=this.ChartBorder.GetBottom());var s=this.ChartFrame.XPointCount,o=null,h=!0;this.Canvas.strokeStyle=this.Color,ha.IsNumber(this.CloseLineWidth)&&(this.Canvas.lineWidth=this.CloseLineWidth),this.ShowRange.Start=this.Data.DataOffset,this.ShowRange.End=this.ShowRange.Start,this.ShowRange.DataCount=0,this.ShowRange.ShowCount=s,this.ShowRange.FirstOpen=t,this.DrawKRange.Start=this.Data.DataOffset,this.Canvas.beginPath();for(var l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<s;++l,++u,r+=a+i,++this.ShowRange.DataCount){var C=this.Data.Data[l];if(null!=C.Open&&null!=C.High&&null!=C.Low&&null!=C.Close){null==o&&(o=C.Open,this.ShowRange.FirstOverlayOpen=C.Open);var D=r,f=r+a;if(f>n)break;var c=D+(f-D)/2,d=this.GetYFromData(C.Close/o*t,!1);this.DrawKRange.End=l,h?(e?this.Canvas.moveTo(d,c):this.Canvas.moveTo(c,d),h=!1):e?this.Canvas.lineTo(d,c):this.Canvas.lineTo(c,d)}}0==h&&this.Canvas.stroke()},this.GetFirstOpen=function(){if(!this.MainData||!this.Data)return null;for(var t=this.ChartFrame.XPointCount,e=this.Data.DataOffset,a=0;e<this.MainData.Data.length&&a<t;++e,++a){var i=this.MainData.Data[e];if(null!=i.Open&&null!=i.High&&null!=i.Low&&null!=i.Close)return i.Open}return null},this.Draw=function(){if(this.TooltipRect=[],this.InfoTooltipRect=[],this.DrawKRange={Start:null,End:null},this.MainData&&this.Data){this.ChartFrame.XPointCount;var t=this.GetFirstOpen();if(null!=t){var e=this.DrawType;null!=this.CustomDrawType&&(e=this.CustomDrawType),this.Canvas.save(),this.ClipClient(this.ChartFrame.IsHScreen),1==e?this.DrawCloseLine(t):2==e?this.DrawAKLine(t):this.DrawKBar(t),this.Canvas.restore()}}},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={Max:null,Min:null};if(!this.MainData||!this.Data)return e;for(var a=null,i=this.Data.DataOffset,r=0;i<this.MainData.Data.length&&r<t;++i,++r){var n=this.MainData.Data[i];if(null!=n.Open&&null!=n.High&&null!=n.Low&&null!=n.Close){a=n.Close;break}}if(null==a)return e;var s,o,h=null;for(i=this.Data.DataOffset,r=0;i<this.Data.Data.length&&r<t;++i,++r){n=this.Data.Data[i];n&&null!=n.Open&&null!=n.High&&null!=n.Low&&null!=n.Close&&(null==h&&(h=n.Open),s=n.High/h*a,o=n.Low/h*a,null==e.Max&&(e.Max=s),null==e.Min&&(e.Min=o),e.Max<s&&(e.Max=s),e.Min>o&&(e.Min=o))}return e},this.GetTooltipData=function(t,e,a){for(var i in this.TooltipRect){var r=this.TooltipRect[i][1];if(this.Canvas.beginPath(),this.Canvas.rect(r.X,r.Y,r.Width,r.Height),this.Canvas.isPointInPath(t,e)){var n=this.TooltipRect[i][0];return a.Data=this.Data.Data[n],a.ChartPaint=this,!0}}return!1},this.PtInChart=function(t,e){var a=this.DrawType;return ha.IsNumber(this.CustomDrawType)&&(a=this.CustomDrawType),1==a||4==a?null:this.PtInKBar(t,e,{OverlayKLine:!0})},this.DrawSelectedStatus=function(){this.DrawLinePoint({OverlayKLine:!0})}}function qt(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartKlineTable",this.Data,this.RowName,this.IsShowRowName=!1,this.BGColor,this.RowCount=5,this.RowHeight=10,this.TextFontConfig=et(Oi.ChartKLineTable.TextFont),this.ItemMergin=et(Oi.ChartKLineTable.ItemMergin),this.TextFont,this.TextColor="rgb(0,0,0)",this.NameColor="rgb(0,0,0)",this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize)if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen;if(!t&&!(this.RowCount<=0)){var e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartFrame.XPointCount,r=this.ChartFrame.GetBorder(),n=r.Bottom-r.TopTitle;this.RowHeight=n/this.RowCount;var s=r.LeftEx+Oi.FrameLeftMargin,o=r.RightEx,h=r.TopTitle,l=r.Bottom;if(this.BGColor){this.Canvas.fillStyle=this.BGColor;var u=r.LeftEx,C=r.RightEx-r.LeftEx;n=l-h;this.Canvas.fillRect(u,h,C,n)}var D=this.RowHeight,f=e+a;D-this.ItemMergin.Top-this.ItemMergin.Bottom>0&&(D=D-this.ItemMergin.Left-this.ItemMergin.Right),f-this.ItemMergin.Left-this.ItemMergin.Right>0&&(f=f-this.ItemMergin.Left-this.ItemMergin.Right);var c=this.GetDynamicTextFont(D,f);this.TextFont=c,this.Canvas.font=this.TextFont;for(var d=this.Data.DataOffset,m=0;d<this.Data.Data.length&&m<i;++d,++m,s+=e+a){var v=this.Data.Data[d];if(v){u=s;var S=s+e+a;if(S>o)break;var I=u+(S-u)/2;if(I>o)break;0==m&&this.IsShowRowName?this.DrawRowName(h,l,u,S):this.DrawRow(v,h,l,u,S)}}}}},this.DrawRowName=function(t,e,a,i){if(ha.IsNonEmptyArray(this.RowName))for(var r=a,n=t,s=i-a,o=0;o<this.RowName.length;++o){var h=this.RowName[o],l={Left:r,Top:n,Right:i,Height:this.RowHeight,Width:s};l.Bottom=l.Top+this.RowHeight,h.Name&&l.Width>10&&(this.Canvas.fillStyle=h.Color?h.Color:this.TextColor,this.Canvas.textBaseline="middle","right"==h.TextAlign?(this.Canvas.textAlign="right",this.Canvas.fillText(h.Name,l.Right-2,l.Top+this.RowHeight/2,s-4)):"center"==h.TextAlign?(this.Canvas.textAlign="center",this.Canvas.fillText(h.Name,l.Left+l.Width/2,l.Top+this.RowHeight/2,s-4)):(this.Canvas.textAlign="left",this.Canvas.fillText(h.Name,l.Left+2,l.Top+this.RowHeight/2,s-4))),n+=this.RowHeight}},this.DrawRow=function(t,e,a,i,r){for(var n=i,s=e,o=r-i,h=0;h<t.length;++h){var l=t[h],u={Left:n,Top:s,Right:r,Height:this.RowHeight,Width:o};u.Bottom=u.Top+this.RowHeight,l.BGColor&&(this.Canvas.fillStyle=l.BGColor,this.Canvas.fillRect(u.Left,u.Top,u.Width,u.Height)),l.Color&&u.Width>10&&(this.Canvas.fillStyle=l.Color,this.Canvas.textBaseline="middle","right"==l.TextAlign?(this.Canvas.textAlign="right",this.Canvas.fillText(l.Text,u.Right-2,u.Top+this.RowHeight/2,o-4)):"center"==l.TextAlign?(this.Canvas.textAlign="center",this.Canvas.fillText(l.Text,u.Left+u.Width/2,u.Top+this.RowHeight/2,o-4)):(this.Canvas.textAlign="left",this.Canvas.fillText(l.Text,u.Left+2,u.Top+this.RowHeight/2,o-4))),s+=this.RowHeight}},this.GetDynamicTextFont=function(t,e,a){var i=parseInt(t)-2;t<5&&(i=parseInt(t)),i>this.TextFontConfig.FontMaxSize?i=this.TextFontConfig.FontMaxSize:i<=0&&(i=1);var r=this.FormatFontString(i,this.TextFontConfig.Family,a);return r},this.FormatFontString=function(t,e,a){var i;return a?a.Weight&&(i=a.Weight+" "+t+"px "+e):i=t+"px "+e,i},this.GetMaxMin=function(){return{Min:0,Max:this.RowCount}}}function Zt(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartMinuteVolumBar",this.UpColor=Oi.UpBarColor,this.DownColor=Oi.DownBarColor,this.UnchangeColor=Oi.UnchagneBarColor,this.CustomColor=Oi.Minute.VolBarColor,this.YClose,this.Symbol,this.BeforeOpenData,this.AfterCloseData,this.BeforeVolColor=Oi.Minute.Before.VolColor,this.ShareAfterVol=0,this.MultiDayBeforeOpenData,this.MultiDayAfterCloseData,this.PtInChart=function(t,e){var a={MinuteVolBar:!0};return this.PtInBar(t,e,a)},this.DrawSelectedStatus=function(){return this.DrawLinePoint({MinuteVolBar:!0})},this.Draw=function(){var t=!0===this.ChartFrame.IsHScreen;if(t)var e=this.ChartBorder.GetHScreenBorder(),a=e.BottomEx;else e=this.ChartBorder.GetBorder(),a=e.RightEx;this.DrawBeforeOpen(),this.DrawMultiDayBeforeOpen();var i=this.ChartFrame.XPointCount,r=this.ChartFrame.GetYFromData(0),n=this.YClose,s=this.Data,o=Br.IsShowMinuteColorVolBar(this.Symbol);o&&(this.Canvas.strokeStyle=this.CustomColor);for(var h=s.DataOffset,l=0;h<s.Data.length&&l<i;++h,++l){var u=s.Data[h],C=null;if(u){var D=null;if(C=u.Vol,D=u.Close,C){var f=this.ChartFrame.GetYFromData(C),c=this.ChartFrame.GetXFromIndex(l);if(c>a)break;o||(this.Canvas.strokeStyle=D>=n?this.UpColor:this.DownColor),this.Canvas.beginPath(),t?(this.Canvas.moveTo(f,Q(c)),this.Canvas.lineTo(r,Q(c))):(this.Canvas.moveTo(Q(c),f),this.Canvas.lineTo(Q(c),r)),this.Canvas.stroke(),D&&(n=D)}}}this.DrawAfterClose(),this.DrawMultiDayAfterClose()},this.DrawBeforeOpen=function(){this.ChartBorder.LeftExtendWidth<10||this.BeforeOpenData&&this.DrawCallAuction(-1,this.BeforeOpenData,!0)},this.DrawAfterClose=function(){this.ChartBorder.RightExtendWidth<10||this.AfterCloseData&&this.DrawCallAuction(-1,this.AfterCloseData,!1)},this.DrawMultiDayBeforeOpen=function(){if(!(this.ChartBorder.MultiDayMinute.Count<=1||this.ChartBorder.MultiDayMinute.Left<=0)&&this.MultiDayBeforeOpenData){var t=0,e=this.MultiDayBeforeOpenData.length;this.DayOffset&&(ha.IsNumber(this.DayOffset.Offset)&&(t=this.DayOffset.Offset),ha.IsNumber(this.DayOffset.ShowDayCount)&&(e=this.DayOffset.ShowDayCount));for(var a=t,i=0;a<this.MultiDayBeforeOpenData.length&&i<e;++a,++i){var r=this.MultiDayBeforeOpenData[a];this.DrawCallAuction(i,r,!0)}}},this.DrawMultiDayAfterClose=function(){if(!(this.ChartBorder.MultiDayMinute.Count<=1||this.ChartBorder.MultiDayMinute.Right<=0)&&this.MultiDayAfterCloseData){var t=0,e=this.MultiDayAfterCloseData.length;this.DayOffset&&(ha.IsNumber(this.DayOffset.Offset)&&(t=this.DayOffset.Offset),ha.IsNumber(this.DayOffset.ShowDayCount)&&(e=this.DayOffset.ShowDayCount));for(var a=t,i=0;a<this.MultiDayAfterCloseData.length&&i<e;++a,++i){var r=this.MultiDayAfterCloseData[a];this.DrawCallAuction(i,r,!1)}}},this.DrawCallAuction=function(t,e,a){if(e){e.Index=t;var i=this.GetBorder(),r=!0===this.ChartFrame.IsHScreen,n=this.YClose,s=this.ChartFrame.GetYFromData(0);if(1==e.Ver)for(var o in e.Data){var h=e.Data[o];if(h&&ha.IsNumber(h.Vol[0])){if(a)var l=this.ChartFrame.GetLeftExtendXFromIndex(o,e),u=this.ChartFrame.GetLeftExtendYFromData(h.Vol[0]);else l=this.ChartFrame.GetRightExtendXFromIndex(o,e),u=this.ChartFrame.GetRightExtendYFromData(h.Vol[0]);this.Canvas.strokeStyle=h.Price>=n?this.UpColor:this.DownColor,this.Canvas.beginPath(),r?(this.Canvas.moveTo(u,Q(l)),this.Canvas.lineTo(s,Q(l))):(this.Canvas.moveTo(Q(l),u),this.Canvas.lineTo(Q(l),s)),this.Canvas.stroke(),h.Price&&(n=h.Price)}}else if(2==e.Ver||3==e.Ver){var C={Max:e.VolMax,Min:e.VolMin};for(var o in e.Data){h=e.Data[o];if(h){if(ha.IsPlusNumber(h.Vol[0])){if(a)l=this.ChartFrame.GetLeftExtendXFromIndex(o,e),u=this.ChartFrame.GetLeftExtendYFromData(h.Vol[0],!1,{Range:C});else{l=this.ChartFrame.GetRightExtendXFromIndex(o,e);if(1==this.ShareAfterVol)u=this.ChartFrame.GetYFromData(h.Vol[0]);else u=this.ChartFrame.GetRightExtendYFromData(h.Vol[0],!1,{Range:C})}this.Canvas.strokeStyle=this.GetBarColor(h.ColorID),this.Canvas.beginPath(),r?(this.Canvas.moveTo(u,Q(l)),this.Canvas.lineTo(s,Q(l))):(this.Canvas.moveTo(Q(l),u),this.Canvas.lineTo(Q(l),s)),this.Canvas.stroke()}if(ha.IsPlusNumber(h.Vol[1])){if(a)l=this.ChartFrame.GetLeftExtendXFromIndex(o,e),u=this.ChartFrame.GetLeftExtendYFromData(h.Vol[1],!1,{Range:C});else{l=this.ChartFrame.GetRightExtendXFromIndex(o,e);if(1==this.ShareAfterVol)u=this.ChartFrame.GetYFromData(h.Vol[1]);else u=this.ChartFrame.GetRightExtendYFromData(h.Vol[1],!1,{Range:C})}this.Canvas.strokeStyle=this.GetBarColor(h.ColorID),this.Canvas.beginPath(),r?(u-=s,u=i.RightEx-u,this.Canvas.moveTo(u,Q(l)),this.Canvas.lineTo(i.RightEx,Q(l))):(u-=s,u=i.TopEx-u,this.Canvas.moveTo(Q(l),u),this.Canvas.lineTo(Q(l),i.TopEx)),this.Canvas.stroke()}}}}}},this.GetBarColor=function(t){switch(t){case 0:return this.UnchangeColor;case 1:return this.UpColor;case 2:return this.DownColor}if(this.BeforeVolColor&&Array.isArray(this.BeforeVolColor)){var e=t-3;if(e>=0&&e<this.BeforeVolColor.length)return this.BeforeVolColor[e]}return this.UnchangeColor},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e=this.Data.DataOffset;this.ChartFrame.GlobalOption&&!0===this.ChartFrame.GlobalOption.IsValueFullRange&&(t=this.Data.Data.length,e=0);for(var a={Min:0,Max:null},i=e,r=0;i<this.Data.Data.length&&r<t;++i,++r){var n=this.Data.Data[i];n&&n.Vol&&(null==a.Max&&(a.Max=n.Vol),a.Max<n.Vol&&(a.Max=n.Vol))}return 1==this.ShareAfterVol&&(this.GetAfterCloseMaxMin(a),this.GetMultiDayAfterCloseMaxMin(a)),a},this.GetAfterCloseMaxMin=function(t){if(!(this.ChartBorder.RightExtendWidth<10)&&this.AfterCloseData){var e=this.AfterCloseData;(null==t.Max||t.Max<e.VolMax)&&(t.Max=e.VolMax)}},this.GetMultiDayAfterCloseMaxMin=function(t){if(!(this.ChartBorder.MultiDayMinute.Count<=1||this.ChartBorder.MultiDayMinute.Right<=0)&&this.MultiDayAfterCloseData)for(var e=0;e<this.MultiDayAfterCloseData.length;++e){var a=this.MultiDayAfterCloseData[e];2!=a.Ver&&3!=a.Ver||(null==t.Max||t.Max<a.VolMax)&&(t.Max=a.VolMax)}}}function Qt(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartErrorMessage",this.Draw=function(){this.IsShow&&this.NotSupportMessage&&this.DrawNotSupportmessage()}}function jt(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartLine",this.Color="rgb(255,193,37)",this.LineWidth,this.DrawType=0,this.IsDotLine=!1,this.DrawSelectedStatus=this.DrawLinePoint,this.PtInChart=this.PtInLine,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize)if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data)switch(this.DrawType){case 0:return this.DrawLine();case 1:return this.DrawStraightLine()}},this.DrawLine=function(){var t=!0===this.ChartFrame.IsHScreen,e=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());t&&(e=this.ChartBorder.GetBottom());var a=this.ChartFrame.XPointCount;this.Canvas.save(),this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth*U()),this.IsDotLine&&this.Canvas.setLineDash(Oi.DOTLINE.LineDash);for(var i=!0,r=0,n=this.Data.DataOffset,s=0;n<this.Data.Data.length&&s<a;++n,++s){var o=this.Data.Data[n];if(null!=o){var h=this.ChartFrame.GetXFromIndex(s),l=this.GetYFromData(o);if(h>e)break;i?(this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?this.Canvas.moveTo(l,h):this.Canvas.moveTo(h,l),i=!1):t?this.Canvas.lineTo(l,h):this.Canvas.lineTo(h,l),++r}}r>0&&this.Canvas.stroke(),this.Canvas.restore()},this.DrawStraightLine=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.IsMinuteFrame(),a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartFrame.XPointCount;if(t)var n=this.ChartBorder.GetHScreenBorder(),s=n.BottomEx,o=n.TopEx+i/2+Oi.FrameLeftMargin;else n=this.ChartBorder.GetBorder(),o=n.LeftEx+i/2+Oi.FrameLeftMargin,s=n.RightEx;var h=this.GetLockRect();h&&(s=t?h.Top:h.Left),this.Canvas.save(),this.ClipClient(t),this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth*U()),this.Canvas.strokeStyle=this.Color,this.IsDotLine&&this.Canvas.setLineDash(Oi.DOTLINE.LineDash);for(var l=!0,u=0,C=this.Data.DataOffset,D=0;C<this.Data.Data.length&&D<r;++C,++D,o+=a+i){var f=this.Data.Data[C];if(null!=f){if(e)var c=this.ChartFrame.GetXFromIndex(D);else{var d=o,m=o+a;if(m>s)break;c=d+(m-d)/2}var v=this.GetYFromData(f,!1);if(c>s)break;l?(this.Canvas.beginPath(),t?this.Canvas.moveTo(v,c):this.Canvas.moveTo(c,v),l=!1):t?this.Canvas.lineTo(v,c):this.Canvas.lineTo(c,v),++u}else u>0&&this.Canvas.stroke(),l=!0,u=0}u>0&&this.Canvas.stroke(),this.Canvas.restore()}}function $t(){this.newMethod=jt,this.newMethod(),delete this.newMethod,this.ClassName="ChartSubLine",this.Color="rgb(255,193,37)",this.LineWidth,this.DrawType=0,this.IsDotLine=!1,this.SubFrame={Max:null,Min:null},this.Draw=function(){if(this.IsShow&&this.Data&&this.Data.Data)switch(this.CalculateDataMaxMin(),this.DrawType){case 0:return this.DrawLine();case 1:return this.DrawStraightLine()}},this.GetYFromData=function(t){var e=!0===this.ChartFrame.IsHScreen;if(e){if(t<=this.SubFrame.Min)return this.ChartBorder.GetLeftEx();if(t>=this.SubFrame.Max)return this.ChartBorder.GetRightEx();var a=this.ChartBorder.GetWidthEx()*(t-this.SubFrame.Min)/(this.SubFrame.Max-this.SubFrame.Min);return this.ChartBorder.GetLeftEx()+a}if(t<=this.SubFrame.Min)return this.ChartBorder.GetBottomEx();if(t>=this.SubFrame.Max)return this.ChartBorder.GetTopEx();var i=this.ChartBorder.GetHeightEx()*(t-this.SubFrame.Min)/(this.SubFrame.Max-this.SubFrame.Min);return this.ChartBorder.GetBottomEx()-i},this.CalculateDataMaxMin=function(){this.SubFrame={Max:null,Min:null};var t=!0===this.ChartFrame.IsHScreen,e=this.ChartBorder.GetRight();t&&(e=this.ChartBorder.GetBottom());for(var a=this.ChartFrame.XPointCount,i=this.Data.DataOffset,r=0;i<this.Data.Data.length&&r<a;++i,++r){var n=this.Data.Data[i];if(null!=n){var s=this.ChartFrame.GetXFromIndex(r);if(s>e)break;(null==this.SubFrame.Min||this.SubFrame.Min>n)&&(this.SubFrame.Min=n),(null==this.SubFrame.Max||this.SubFrame.Max<n)&&(this.SubFrame.Max=n)}}},this.GetMaxMin=function(){var t={Min:null,Max:null};return t}}function te(){this.newMethod=jt,this.newMethod(),delete this.newMethod,this.MainData=new Ot,this.Draw=function(){if(this.Data&&this.Data.Data&&this.MainData&&this.MainData.Data)switch(this.DrawType){case 0:return this.DrawLine();case 1:return this.DrawStraightLine()}},this.GetFirstVaildIndex=function(){for(var t=this.Data.DataOffset,e=t,a=0;e<this.MainData.Data.length&&e<this.Data.Data.length;++e,++a){var i=this.MainData.Data[e],r=this.Data.Data[e];if(ha.IsNumber(i)&&ha.IsNumber(r))return{Index:a,DataOffset:e,OverlayValue:r,MainValue:i}}return null},this.DrawStraightLine=function(){var t=this.GetFirstVaildIndex();if(t){var e=!0===this.ChartFrame.IsHScreen,a=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());e&&(a=this.ChartBorder.GetBottom());var i=this.ChartFrame.XPointCount,r=this.GetLockRect();r&&(a=e?r.Top:r.Left),this.Canvas.save(),this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth*U()),this.Canvas.strokeStyle=this.Color,this.IsDotLine&&this.Canvas.setLineDash([3,5]);for(var n=!0,s=0,o=0,h=t.DataOffset,l=t.Index;h<this.Data.Data.length&&l<i;++h,++l){var u=this.Data.Data[h];if(null!=u){var C=this.ChartFrame.GetXFromIndex(l),D=u-t.OverlayValue;o=0!=t.OverlayValue?1+D/Math.abs(t.OverlayValue):1+D;var f=t.MainValue*o,c=this.GetYFromData(f);if(C>a)break;n?(this.Canvas.beginPath(),e?this.Canvas.moveTo(c,C):this.Canvas.moveTo(C,c),n=!1):e?this.Canvas.lineTo(c,C):this.Canvas.lineTo(C,c),++s}else s>0&&this.Canvas.stroke(),n=!0,s=0}s>0&&this.Canvas.stroke(),this.Canvas.restore()}},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={Min:null,Max:null},a=this.GetFirstVaildIndex();if(!a)return e;for(var i=a.DataOffset,r=a.Index;i<this.Data.Data.length&&r<t;++i,++r){var n=this.Data.Data[i];if(ha.IsNumber(n)){var s=n-a.OverlayValue;0!=a.OverlayValue?rate=1+s/Math.abs(a.OverlayValue):rate=1+s;var o=a.MainValue*rate;null==e.Max&&(e.Max=o),null==e.Min&&(e.Min=o),e.Max<o&&(e.Max=o),e.Min>o&&(e.Min=o)}}return e}}function ee(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartPartLine",this.LineWidth,this.Draw=function(){this.IsShow&&!this.ChartFrame.IsMinSize&&(this.NotSupportMessage?this.DrawNotSupportmessage():this.Data&&this.Data.Data&&this.DrawLine())},this.DrawLine=function(){var t=!0===this.ChartFrame.IsHScreen,e=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());t&&(e=this.ChartBorder.GetBottom());var a=this.ChartFrame.XPointCount;this.Canvas.save(),this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth*U());for(var i,r=0,n={X:null,Y:null},s=!1,o=this.Data.DataOffset,h=0;o<this.Data.Data.length&&h<a;++o,++h){var l=this.Data.Data[o];if(null!=l&&null!=l.Value){var u=l.Value,C=l.RGB,D=this.ChartFrame.GetXFromIndex(h),f=this.ChartFrame.GetYFromData(u);if(D>e)break;C!=i||1==s?(i&&r>0&&this.Canvas.stroke(),r=0,i=C,this.Canvas.strokeStyle=C,this.Canvas.beginPath(),null!=n.X&&null!=n.Y?(t?this.Canvas.moveTo(n.Y,n.X):this.Canvas.moveTo(n.X,n.Y),t?this.Canvas.lineTo(f,D):this.Canvas.lineTo(D,f),++r):t?this.Canvas.moveTo(f,D):this.Canvas.moveTo(D,f)):(t?this.Canvas.lineTo(f,D):this.Canvas.lineTo(D,f),++r),n.X=D,n.Y=f,s=!1}else n.X=null,n.Y=null,s=!0}r>0&&this.Canvas.stroke(),this.Canvas.restore()},this.GetMaxMin=function(){for(var t=this.ChartFrame.XPointCount,e={Min:null,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];r&&r.Value&&((null==e.Max||e.Max<r.Value)&&(e.Max=r.Value),(null==e.Min||e.Min>r.Value)&&(e.Min=r.Value))}return e}}function ae(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartStepLine",this.LineWidth=1,this.DotLine,this.IsHScreen,this.IsDotLine=!1,this.PtInChart=function(t,e){if(this.IsShow&&!this.ChartFrame.IsMinSize){var a=!0===this.ChartFrame.IsHScreen;if(!a){var i=this.IsMinuteFrame(),r=this.ChartFrame.DataWidth,n=this.ChartFrame.DistanceWidth,s=this.ChartFrame.XPointCount,o=this.GetLockRect();if(a){var h=this.ChartBorder.GetHScreenBorder(),l=h.BottomEx,u=h.TopEx+n/2+Oi.FrameLeftMargin;o&&(l=o.Top)}else{h=this.ChartBorder.GetBorder(),u=h.LeftEx+n/2+Oi.FrameLeftMargin,l=h.RightEx;o&&(l=o.Left)}if(t<u||t>l)return null;if(e>h.BottomEx||e<h.TopEx)return null;for(var C={},D={},f=this.Data.DataOffset;f>=0;--f){var c=this.Data.Data[f];if(ha.IsNumber(c)){var d=this.GetYFromData(c,!1),m=null;m=i?this.ChartFrame.GetXFromIndex(0):u,C.Y=d,C.X=m}}f=this.Data.DataOffset;for(var v=0;f<this.Data.Data.length&&v<s;++f,++v,u+=r+n){c=this.Data.Data[f];if(ha.IsNumber(c)){if(i)var S=this.ChartFrame.GetXFromIndex(v);else{var I=u,p=u+r;if(p>l)break;S=I+(p-I)/2}var T=this.GetYFromData(c,!1);if(!(S<t)){if(S==t){C.X=D.X=S,C.Y=D.Y=T;break}D.X=S,D.Y=T;break}if(C.X=S,C.Y=T,t>l)break}}return ha.IsNumber(C.X)&&ha.IsNumber(C.Y)&&ha.IsNumber(D.X)&&ha.IsNumber(D.Y)&&(t==C.X||e==C.Y||t==D.X||e==D.Y||t>=C.X&&t<=D.X&&e>=C.Y-3&&e<=C.Y+3||t>=D.X-3&&t<=D.X+3&&e>=Math.min(C.Y,D.Y)&&e<Math.max(C.Y,D.Y))?{Identify:this.Identify,Chart:this}:null}}},this.Draw=function(){this.IsShow&&!this.ChartFrame.IsMinSize&&(this.NotSupportMessage?this.DrawNotSupportmessage():this.Data&&this.Data.Data&&(this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.Canvas.save(),this.ClipClient(this.IsHScreen),this.DrawLine(),this.Canvas.restore()))},this.DrawLine=function(){var t=this.IsMinuteFrame(),e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartFrame.XPointCount,r=this.GetLockRect();if(this.IsHScreen){var n=this.ChartBorder.GetHScreenBorder(),s=n.BottomEx,o=n.TopEx+a/2+Oi.FrameLeftMargin;r&&(s=r.Top)}else{n=this.ChartBorder.GetBorder(),o=n.LeftEx+a/2+Oi.FrameLeftMargin,s=n.RightEx;r&&(s=r.Left)}this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth*U()),this.IsDotLine&&this.Canvas.setLineDash(Oi.DOTLINE.LineDash),this.DotLine&&this.Canvas.setLineDash(this.DotLine),this.Canvas.strokeStyle=this.Color;for(var h=!0,l=0,u={X:null,Y:null},C=this.Data.DataOffset;C>=0;--C){var D=this.Data.Data[C];if(ha.IsNumber(D)){var f=this.GetYFromData(D,!1),c=null;c=t?this.ChartFrame.GetXFromIndex(0):o,this.Canvas.beginPath(),this.IsHScreen?this.Canvas.moveTo(f,c):this.Canvas.moveTo(c,f),h=!1,u.Y=f,u.X=c}}C=this.Data.DataOffset;for(var d=0;C<this.Data.Data.length&&d<i;++C,++d,o+=e+a){if(t)c=this.ChartFrame.GetXFromIndex(d);else{var m=o,v=o+e;if(v>s)break;c=m+(v-m)/2}if(c>s)break;D=this.Data.Data[C];if(ha.IsNumber(D)){f=this.GetYFromData(D,!1);h?(this.Canvas.beginPath(),this.IsHScreen?this.Canvas.moveTo(f,c):this.Canvas.moveTo(c,f),h=!1,u.X=c,u.Y=f):(this.IsHScreen?(this.Canvas.lineTo(u.Y,c),this.Canvas.lineTo(f,c)):(this.Canvas.lineTo(c,u.Y),this.Canvas.lineTo(c,f)),u.X=c,u.Y=f),++l}}l>0&&this.Canvas.stroke()},this.DrawSelectedStatus=function(){this.DrawLinePoint()}}function ie(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartSlopeLine",this.Color="rgb(255,193,37)",this.IsDotLine=!1,this.LineWidth,this.Option,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize)if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data){this.Canvas.save(),this.Canvas.strokeStyle=this.Color,this.IsDotLine&&this.Canvas.setLineDash(Oi.DOTLINE.LineDash);var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetTopEx(),a=this.ChartBorder.GetRight(),i=this.ChartBorder.GetBottom(),r=this.ChartBorder.GetRight(),n=this.ChartFrame.XPointCount;this.Canvas.beginPath(),this.Canvas.rect(t,e,a-t,i-e),this.Canvas.clip();for(var s=this.Data.DataOffset,o=0;s<this.Data.Data.length&&o<n;++s,++o){var h=this.Data.Data[s];if(ha.IsNumber(h)){var l=this.Option[s];if(l){var u=this.ChartFrame.GetXFromIndex(o),C=this.ChartFrame.GetYFromData(h),D=l.Length*Oi.DRAWSL.PixelWidth;if(u>r)break;var f=Math.sqrt(D*D/(1+l.Slope*l.Slope)),c=f*l.Slope;this.Canvas.beginPath(),2==l.Direct?(this.Canvas.moveTo(u-f,C+c),this.Canvas.lineTo(u+f,C-c)):1==l.Direct?(this.Canvas.moveTo(u,C),this.Canvas.lineTo(u-f,C+c)):(this.Canvas.moveTo(u,C),this.Canvas.lineTo(u+f,C-c)),this.Canvas.stroke()}}}this.Canvas.restore()}}}function re(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartPointDot",this.Color="rgb(255,193,37)",this.Radius=1,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize)if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());!0===t&&(e=this.ChartBorder.GetBottom());var a=this.ChartFrame.XPointCount;this.Canvas.save(),this.Canvas.fillStyle=this.Color;for(var i=this.Data.DataOffset,r=0;i<this.Data.Data.length&&r<a;++i,++r){var n=this.Data.Data[i];if(null!=n){var s=this.ChartFrame.GetXFromIndex(r),o=this.ChartFrame.GetYFromData(n);if(s>e)break;this.Canvas.beginPath(),t?this.Canvas.arc(o,s,this.Radius,0,2*Math.PI,!0):this.Canvas.arc(s,o,this.Radius,0,2*Math.PI,!0),this.Canvas.closePath(),this.Canvas.fill()}}this.Canvas.restore()}}}function ne(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.Color="rgb(255,193,37)",this.LineWidth,this.ClassName="ChartStick",this.DrawLine=function(){if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());!0===t&&(e=this.ChartBorder.GetBottom());var a=this.ChartFrame.XPointCount;this.Canvas.save(),this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth*U());for(var i=!0,r=0,n=this.Data.DataOffset,s=0;n<this.Data.Data.length&&s<a;++n,++s){var o=this.Data.Data[n];if(null!=o){var h=this.ChartFrame.GetXFromIndex(s),l=this.ChartFrame.GetYFromData(o);if(h>e)break;i?(this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?this.Canvas.moveTo(l,h):this.Canvas.moveTo(h,l),i=!1):t?this.Canvas.lineTo(l,h):this.Canvas.lineTo(h,l),++r}}r>0&&this.Canvas.stroke(),this.Canvas.restore()}},this.DrawStick=function(){if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartBorder.GetRight();t&&(e=this.ChartBorder.GetBottom());var a=this.ChartFrame.XPointCount,i=this.ChartBorder.GetBottom(),r=this.ChartBorder.GetLeft();this.Canvas.save(),this.Canvas.strokeStyle=this.Color,this.LineWidth&&(this.Canvas.lineWidth=this.LineWidth*U());for(var n=this.Canvas.lineWidth,s=this.Data.DataOffset,o=0;s<this.Data.Data.length&&o<a;++s,++o){var h=this.Data.Data[s];if(null!=h){var l=this.ChartFrame.GetXFromIndex(o),u=this.ChartFrame.GetYFromData(h);if(l>e)break;if(this.Canvas.beginPath(),t)this.Canvas.moveTo(r,l),this.Canvas.lineTo(u,l),this.Canvas.stroke();else{var C=$(n,l);this.Canvas.moveTo(C,u),this.Canvas.lineTo(C,i)}this.Canvas.stroke()}}this.Canvas.restore()}},this.Draw=function(){this.IsShow&&!this.ChartFrame.IsMinSize&&(this.NotSupportMessage?this.DrawNotSupportmessage():this.Data&&this.Data.Data&&this.DrawStick())}}function se(){this.newMethod=ne,this.newMethod(),delete this.newMethod,this.ClassName="ChartLineStick",this.Draw=function(){this.IsShow&&!this.ChartFrame.IsMinSize&&(this.NotSupportMessage?this.DrawNotSupportmessage():(this.DrawStick(),this.DrawLine()))}}function oe(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.UpColor=Oi.UpBarColor,this.DownColor=Oi.DownBarColor,this.HistoryData,this.KLineDrawType=0,this.ClassName="ChartVolStick",this.PtInChart=this.PtInBar,this.DrawSelectedStatus=this.DrawLinePoint,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize)if(!0!==this.ChartFrame.IsHScreen){var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartBorder.GetBorder(),i=a.LeftEx+e/2+Oi.FrameLeftMargin,r=a.RightEx,n=this.ChartFrame.XPointCount,s=this.GetLockRect();s&&(r=s.Left);var o=this.IsMinuteFrame(),h=this.ChartFrame.GetYFromData(0);if(t>=4){h=tt(h);for(var l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<n;++l,++u,i+=t+e){var C=this.Data.Data[l],D=this.HistoryData.Data[l];if(null!=C&&null!=D){var f=i,c=i+t;if(c>r)break;var d=this.ChartFrame.GetYFromData(C),m=this.GetBarColor(D),v=m.IsUp;this.Canvas.fillStyle=m.Color;var S=tt(Math.abs(h-d)>=1?h-d:1);d=h-S,6==this.KLineDrawType?(this.Canvas.strokeStyle=m.Color,this.Canvas.beginPath(),this.Canvas.rect(Q(f),Q(d),tt(t),S),this.Canvas.stroke()):!v||1!=this.KLineDrawType&&2!=this.KLineDrawType&&3!=this.KLineDrawType?this.Canvas.fillRect(tt(f),d,tt(t),S):(this.Canvas.strokeStyle=this.UpColor,this.Canvas.beginPath(),this.Canvas.rect(Q(f),Q(d),tt(t),S),this.Canvas.stroke())}}}else for(l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<n;++l,++u,i+=t+e){C=this.Data.Data[l],D=this.HistoryData.Data[l];if(null!=C&&null!=D){d=this.ChartFrame.GetYFromData(C);if(o)var I=this.ChartFrame.GetXFromIndex(u);else f=i,c=i+t,I=f+(c-f)/2;if(I>r)break;m=this.GetBarColor(D);this.Canvas.strokeStyle=m.Color;I=this.ChartFrame.GetXFromIndex(u);this.Canvas.beginPath(),this.Canvas.moveTo(Q(I),d),this.Canvas.lineTo(Q(I),h),this.Canvas.stroke()}}}else this.HScreenDraw()},this.HScreenDraw=function(){var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartBorder.GetHScreenBorder(),i=a.TopEx+e/2+Oi.FrameLeftMargin,r=a.BottomEx,n=this.ChartFrame.XPointCount,s=this.GetLockRect();s&&(r=s.Top);var o=this.ChartFrame.GetYFromData(0);if(t>=4){o=tt(o);for(var h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<n;++h,++l,i+=t+e){var u=this.Data.Data[h],C=this.HistoryData.Data[h];if(null!=u&&null!=C){var D=i,f=i+t;if(f>r)break;var c=this.ChartFrame.GetYFromData(u),d=!1;C.Close>=C.Open?(d=!0,this.Canvas.fillStyle=this.UpColor):this.Canvas.fillStyle=this.DownColor;var m=tt(c-o);!d||1!=this.KLineDrawType&&2!=this.KLineDrawType&&3!=this.KLineDrawType?this.Canvas.fillRect(o,tt(D),m,tt(t)):(this.Canvas.strokeStyle=this.UpColor,this.Canvas.beginPath(),this.Canvas.rect(Q(o),Q(D),m,tt(t)),this.Canvas.stroke())}}}else for(h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<n;++h,++l,i+=t+e){u=this.Data.Data[h],C=this.HistoryData.Data[h];if(null!=u&&null!=C){c=this.ChartFrame.GetYFromData(u);var v=this.ChartFrame.GetXFromIndex(l);if(v>r)break;C.Close>C.Open?this.Canvas.strokeStyle=this.UpColor:this.Canvas.strokeStyle=this.DownColor;v=this.ChartFrame.GetXFromIndex(l);this.Canvas.beginPath(),this.Canvas.moveTo(c,Q(v)),this.Canvas.lineTo(o,Q(v)),this.Canvas.stroke()}}},this.GetMaxMin=function(){for(var t=this.ChartFrame.XPointCount,e={Min:0,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];null==e.Max&&(e.Max=r),e.Max<r&&(e.Max=r)}return e},this.GetBarColor=function(t){return t.Close>=t.Open?{Color:this.UpColor,IsUp:!0}:{Color:this.DownColor,IsUp:!1}}}function he(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartVericaltLine",this.LineWidth=2,this.LineCap,this.Draw=function(){if(!this.ChartFrame.IsMinSize){var t=1==this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.GetBorder(),r=this.ChartFrame.XPointCount;if(t)var n=i.RightEx,s=i.LeftEx,o=i.TopEx+a/2+Oi.FrameLeftMargin;else n=i.TopEx,s=i.BottomEx,o=i.LeftEx+a/2+Oi.FrameLeftMargin;this.Canvas.save(),this.Canvas.strokeStyle=this.Color,this.LineType&&this.Canvas.setLineDash(this.LineType),this.LineCap&&(this.Canvas.lineCap=this.LineCap),this.Canvas.beginPath();var h=this.Canvas.lineWidth;this.LineWidth>0&&(h=this.LineWidth*U(),this.Canvas.lineWidth=h);for(var l=0,u=this.Data.DataOffset,C=0;u<this.Data.Data.length&&C<r;++u,++C,o+=e+a){var D=this.Data.Data[u];if(D){var f=o+e/2;f=$(h,f),t?(this.Canvas.moveTo(n,f),this.Canvas.lineTo(s,f)):(this.Canvas.moveTo(f,n),this.Canvas.lineTo(f,s)),++l}}l>0&&this.Canvas.stroke(),this.Canvas.restore()}},this.GetMaxMin=function(){return{Min:null,Max:null}}}function le(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartHorizontalLine",this.LineWidth=2,this.LineCap,this.ExtendType=0,this.Draw=function(){if(!this.ChartFrame.IsMinSize){var t=1==this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.GetBorder(),r=this.ChartFrame.XPointCount;if(t)var n=i.TopEx,s=i.BottomEx,o=i.TopEx+a/2+Oi.FrameLeftMargin;else n=i.LeftEx,s=i.RightEx,o=i.LeftEx+a/2+Oi.FrameLeftMargin;this.Canvas.save(),this.Canvas.strokeStyle=this.Color,this.LineType&&this.Canvas.setLineDash(this.LineType),this.LineCap&&(this.Canvas.lineCap=this.LineCap),this.Canvas.beginPath();var h=this.Canvas.lineWidth;this.LineWidth>0&&(h=this.LineWidth*U(),this.Canvas.lineWidth=h);for(var l=0,u=this.Data.DataOffset,C=0;u<this.Data.Data.length&&C<r;++u,++C,o+=e+a){var D=this.Data.Data[u];if(D&&ha.IsNumber(D)){var f=this.ChartFrame.GetYFromData(D);f=$(h,f);var c=o+e/2;c=$(h,c),3==this.ExtendType?t?(this.Canvas.moveTo(f,n),this.Canvas.lineTo(f,s)):(this.Canvas.moveTo(n,f),this.Canvas.lineTo(s,f)):1==this.ExtendType?t?(this.Canvas.moveTo(f,n),this.Canvas.lineTo(f,c)):(this.Canvas.moveTo(n,f),this.Canvas.lineTo(c,f)):t?(this.Canvas.moveTo(f,c),this.Canvas.lineTo(f,s)):(this.Canvas.moveTo(c,f),this.Canvas.lineTo(s,f)),++l}}l>0&&this.Canvas.stroke(),this.Canvas.restore()}}}function ue(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartLineMultiData",this.Color="rgb(255,193,37)",this.PointColor,this.PointRadius,this.LineWidth,this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=(this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight());t&&(e=this.ChartBorder.GetBottom());var a=this.ChartFrame.XPointCount;this.Canvas.save(),ha.IsPlusNumber(this.LineWidth)&&(this.Canvas.lineWidth=this.LineWidth*U());for(var i,r=!0,n=0,s=[],o=this.Data.DataOffset,h=0;o<this.Data.Data.length&&h<a;++o,++h){var l=this.Data.Data[o];if(l){var u=this.ChartFrame.GetXFromIndex(h);if(u>e)break;i=Array.isArray(l)?l:[l];for(var C=0;C<i.length;++C){var D=i[C];if(D){var f=D.Value,c=this.ChartFrame.GetYFromData(f);r?(this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?this.Canvas.moveTo(c,u):this.Canvas.moveTo(u,c),r=!1,1===D.Type&&s.push({X:u,Y:c})):(t?this.Canvas.lineTo(c,u):this.Canvas.lineTo(u,c),1===D.Type&&s.push({X:u,Y:c})),++n}}}}n>0&&this.Canvas.stroke(),this.DrawPoint(s),this.Canvas.restore()}},this.DrawPoint=function(t){if(this.PointColor&&ha.IsPlusNumber(this.PointRadius))for(var e=this.PointRadius*U(),a=0;a<t.length;++a){var i=t[a];this.Canvas.beginPath(),this.Canvas.arc(i.X,i.Y,e,0,360,!1),this.Canvas.fillStyle=this.PointColor,this.Canvas.fill(),this.Canvas.closePath()}},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={Min:null,Max:null};if(!this.Data||!this.Data.Data)return e;for(var a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];if(r){var n;n=Array.isArray(r)?r:[r];for(i=0;i<n.length;++i){var s=n[i].Value;ha.IsNumber(s)&&(null==e.Max&&(e.Max=s),null==e.Min&&(e.Min=s),e.Max<s&&(e.Max=s),e.Min>s&&(e.Min=s))}}}return e}}function Ce(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartStickLine",this.Color="rgb(255,193,37)",this.BarType=0,this.LineDotted=[3,3],this.Width=0,this.SetEmptyBar=function(){if(1!=this.BarType&&-1!=this.BarType)return!1;this.Canvas.lineWidth=U(),this.Canvas.strokeStyle=this.Color;var t=Oi.EmptyBarBGColor;return t&&(this.Canvas.fillStyle=t),-1==this.BarType&&this.Canvas.setLineDash(this.LineDotted),!0},this.IsEmptyBar=function(){return 1==this.BarType||-1==this.BarType},this.Draw=function(){if(!this.ChartFrame.IsMinSize)if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetRight();this.ChartFrame.ZoomIndex;t&&(i=this.ChartBorder.GetBottom());var r=this.ChartFrame.XPointCount,n=this.ChartBorder.GetLeft()+a/2+Oi.FrameLeftMargin;t&&(n=this.ChartBorder.GetTop()+a/2+Oi.FrameLeftMargin);var s=this.IsMinuteFrame();this.Canvas.save();var o=!1,h=!1,l=Oi.EmptyBarBGColor;if(s)this.Width>1?this.Canvas.lineWidth=2*U():this.Canvas.lineWidth=U(),this.Canvas.strokeStyle=this.Color;else if(0==this.Width)this.SetEmptyBar();else if(3==this.Width||50==this.Width)e>=4?(h=!0,this.SetEmptyBar(),this.IsEmptyBar()||(this.Canvas.fillStyle=this.Color),this.Canvas.strokeStyle=this.Color):(this.Canvas.lineWidth=U(),this.Canvas.strokeStyle=this.Color);else if(101==this.Width){var u=e+a+1*U();this.Canvas.lineWidth=u,this.Canvas.strokeStyle=this.Color}else if(this.Width<=3){var C=2*U(),D=e*(this.Width/3);D<C&&(D=C),this.SetEmptyBar(),this.IsEmptyBar()||(this.Canvas.fillStyle=this.Color),o=!0}else{D=this.Width*U()+e;this.SetEmptyBar(),this.IsEmptyBar()||(this.Canvas.fillStyle=this.Color),o=!0}for(var f=this.Data.DataOffset,c=0;f<this.Data.Data.length&&c<r;++f,++c,n+=e+a){var d=this.Data.Data[f];if(null!=d){var m=d.Value,v=d.Value2;if(null==v&&(v=0),s)var S=this.ChartFrame.GetXFromIndex(c);else{var I=n,p=n+e;S=I+(p-I)/2}var T=this.ChartFrame.GetYFromData(m),g=this.ChartFrame.GetYFromData(v);if(S>i)break;if(o)if(t){I=S-D/2;var x=D;this.IsEmptyBar()?(this.Canvas.beginPath(),this.Canvas.rect(Q(Math.min(T,g)),Q(I),tt(Math.abs(T-g)),tt(x)),this.Canvas.stroke()):this.Canvas.fillRect(tt(Math.min(T,g)),tt(I),tt(Math.abs(T-g)),tt(x))}else{I=S-D/2,x=D;I+x>i&&(x=i-I),this.IsEmptyBar()?(l&&this.Canvas.fillRect(tt(I),tt(Math.min(T,g)),tt(x),tt(Math.abs(T-g))),this.Canvas.beginPath(),this.Canvas.rect(Q(I),Q(Math.min(T,g)),tt(x),tt(Math.abs(T-g))),this.Canvas.stroke()):this.Canvas.fillRect(tt(I),tt(Math.min(T,g)),tt(x),tt(Math.abs(T-g)))}else if(h)this.IsEmptyBar()?t?(this.Canvas.beginPath(),this.Canvas.rect(Q(Math.min(T,g)),Q(n),tt(Math.abs(T-g)),tt(e)),this.Canvas.stroke()):(l&&this.Canvas.fillRect(tt(n),tt(Math.min(T,g)),tt(e),tt(Math.abs(T-g))),this.Canvas.beginPath(),this.Canvas.rect(Q(n),Q(Math.min(T,g)),tt(e),tt(Math.abs(T-g))),this.Canvas.stroke()):t?this.Canvas.fillRect(tt(Math.min(T,g)),tt(n),tt(Math.abs(T-g)),tt(e)):this.Canvas.fillRect(tt(n),tt(Math.min(T,g)),tt(e),tt(Math.abs(T-g)));else if(t)this.Canvas.beginPath(),this.Canvas.moveTo(T,Q(S)),this.Canvas.lineTo(g,Q(S)),this.Canvas.stroke();else{var F=parseInt(S.toString())+.5;this.Canvas.beginPath(),this.Canvas.moveTo(F,T),this.Canvas.lineTo(F,g),this.Canvas.stroke()}}}this.Canvas.restore()}},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={Min:null,Max:null};if(!this.Data||!this.Data.Data)return e;for(var a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];if(null!=r){var n=r.Value2;if(null==n&&(n=0),null!=r&&!isNaN(r.Value)&&!isNaN(n)){var s=Math.max(r.Value,n),o=Math.min(r.Value,n);null==e.Max&&(e.Max=s),null==e.Min&&(e.Min=o),e.Max<s&&(e.Max=s),e.Min>o&&(e.Min=o)}}}return e}}function De(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartSingleText",this.Color="rgb(255,193,37)",this.TextFont="14px å¾®è½¯éé»",this.Text,this.TextAlign="left",this.TextBG,this.Direction=0,this.FixedFontSize=-1,this.YOffset=0,this.Position,this.IconFont,this.IconSize={Max:Oi.DRAWICON.Icon.MaxSize,Min:Oi.DRAWICON.Icon.MinSize,Zoom:{Type:Oi.DRAWICON.Icon.Zoom.Type,Value:Oi.DRAWICON.Icon.Zoom.Value},YOffset:Oi.DRAWICON.Icon.YOffset},this.TextSize={Max:Oi.DRAWICON.Text.MaxSize,Min:Oi.DRAWICON.Text.MinSize,Zoom:{Type:Oi.DRAWICON.Text.Zoom.Type,Value:Oi.DRAWICON.Text.Zoom.Value},FontName:Oi.DRAWICON.Text.FontName,YOffset:Oi.DRAWICON.Text.YOffset},this.Font={DRAWTEXT_FIX:Oi.DRAWTEXT_FIX.Font,DRAWNUMBER_FIX:Oi.DRAWNUMBER_FIX.Font},this.ReloadResource=function(t){"DRAWTEXT"==this.Name?this.TextSize={Max:Oi.DRAWTEXT.MaxSize,Min:Oi.DRAWTEXT.MinSize,Zoom:{Type:Oi.DRAWTEXT.Zoom.Type,Value:Oi.DRAWTEXT.Zoom.Value},FontName:Oi.DRAWTEXT.FontName,YOffset:Oi.DRAWTEXT.YOffset}:"DRAWNUMBER"==this.Name?this.TextSize={Max:Oi.DRAWNUMBER.MaxSize,Min:Oi.DRAWNUMBER.MinSize,Zoom:{Type:Oi.DRAWNUMBER.Zoom.Type,Value:Oi.DRAWNUMBER.Zoom.Value},FontName:Oi.DRAWNUMBER.FontName,YOffset:Oi.DRAWNUMBER.YOffset}:"DRAWTEXT_FIX"==this.Name?this.Font.DRAWTEXT_FIX=Oi.DRAWTEXT_FIX.Font:"DRAWNUMBER_FIX"==this.Name&&(this.Font.DRAWNUMBER_FIX=Oi.DRAWNUMBER_FIX.Font)},this.SuperGetMaxMin=this.GetMaxMin,this.GetMaxMin=function(){return"DRAWTEXT_FIX"==this.Name||"DRAWNUMBER_FIX"==this.Name||"DRAWTEXTREL"==this.Name||"DRAWTEXTABS"==this.Name?{Min:null,Max:null}:this.SuperGetMaxMin()},this.DrawRectText=function(){if(this.DrawData){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.GetBorder();if("DRAWTEXTREL"==this.Name)if(t)var a=e.RightTitle-e.LeftEx,i=e.BottomEx-e.TopEx,r=this.DrawData.Point.X/1e3*i+e.TopEx,n=e.RightTitle-this.DrawData.Point.Y/1e3*i;else i=e.RightEx-e.LeftEx,a=e.BottomEx-e.TopTitle,r=this.DrawData.Point.X/1e3*i+e.LeftEx,n=this.DrawData.Point.Y/1e3*a+e.TopTitle;else{if("DRAWTEXTABS"!=this.Name)return;if(t)r=this.DrawData.Point.X+e.TopEx,n=e.RightTitle-this.DrawData.Point.Y;else r=this.DrawData.Point.X+e.LeftEx,n=this.DrawData.Point.Y+e.TopTitle}1==this.Direction?this.Canvas.textBaseline="bottom":2==this.Direction?this.Canvas.textBaseline="top":this.Canvas.textBaseline="middle",this.Canvas.textAlign="left",this.Canvas.font=this.TextFont,this.Canvas.fillStyle=this.Color,this.DrawText(this.DrawData.Text,r,n,t)}},this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize)if(this.NotSupportMessage)this.DrawNotSupportmessage();else if("DRAWTEXTREL"!=this.Name&&"DRAWTEXTABS"!=this.Name){if(this.Position)this.DrawPosition();else if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=this.IsMinuteFrame(),a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetLeft()+i/2+Oi.FrameLeftMargin,n=this.ChartBorder.GetRight(),s=this.ChartBorder.GetTopEx(),o=this.ChartBorder.GetBottomEx();t&&(n=this.ChartBorder.GetBottom(),s=this.ChartBorder.GetRightEx(),o=this.ChartBorder.GetLeftEx(),r=this.ChartBorder.GetTop()+i/2+Oi.FrameLeftMargin);var h=this.ChartFrame.XPointCount,l=Array.isArray(this.Text),u=U(),C={Text:{},Font:{}};if(1==this.Direction?(this.Canvas.textBaseline="bottom",C.Text={Baseline:"bottom"}):2==this.Direction?(this.Canvas.textBaseline="top",C.Text={Baseline:"top"}):(this.Canvas.textBaseline="middle",C.Text={Baseline:"middle"}),this.IconFont){if(this.Color=this.IconFont.Color,this.Text=this.IconFont.Text,this.FixedFontSize>0)var D=this.FixedFontSize;else D=this.GetDynamicIconSize(a,i,this.IconSize.Max,this.IconSize.Min,this.IconSize.Zoom);this.Canvas.font=D+"px "+this.IconFont.Family}else this.FixedFontSize>0?this.TextFont=this.FixedFontSize+"px "+this.TextSize.FontName:this.TextFont=this.GetDynamicFont(a,i,this.TextSize.Max,this.TextSize.Min,this.TextSize.Zoom,this.TextSize.FontName),this.Canvas.font=this.TextFont;C.Font={Height:this.GetFontHeight()};for(var f=this.Data.DataOffset,c=0;f<this.Data.Data.length&&c<h;++f,++c,r+=a+i){var d=this.Data.Data[f];if(null!=d){if(e)var m=this.ChartFrame.GetXFromIndex(c);else{var v=r,S=r+a;if(S>n)break;m=v+(S-v)/2}var I=this.ChartFrame.GetYFromData(d);if(m>n)break;if(this.Canvas.textAlign=this.TextAlign,this.Canvas.fillStyle=this.Color,C.Text.Color=this.Color,C.Text.Align=this.TextAlign,C.X=m,C.Y=I,this.YOffset>0&&this.Direction>0){var p=I;this.Canvas.setLineDash([5,10]),this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?(1==this.Direction?(I=s-this.YOffset*u,p+=5*u):(I=o+this.YOffset*u,p-=5*u),this.Canvas.moveTo(Q(p),Q(m)),this.Canvas.lineTo(Q(I),Q(m))):(1==this.Direction?(I=s+this.YOffset*u,p+=5*u):(I=o-this.YOffset*u,p-=5*u),this.Canvas.moveTo(Q(m),Q(p)),this.Canvas.lineTo(Q(m),Q(I))),this.Canvas.stroke(),this.Canvas.setLineDash([])}if(l){var T=this.Text[f];if(!T)continue;"DRAWNUMBER"==this.Name&&(1==this.Direction?I-=Oi.DRAWABOVE.YOffset*u:2==this.Direction&&(I+=this.TextSize.YOffset*u)),"DRAWTEXT"==this.Name?this.DrawTextV2(T,C,t):this.DrawText(T,m,I,t)}else"DRAWICON"==this.Name?1==this.Direction?I-=Oi.DRAWABOVE.YOffset*u:2==this.Direction&&(this.IconFont?I+=this.IconSize.YOffset*u:I+=this.TextSize.YOffset*u):"DRAWTEXT"==this.Name&&(1==this.Direction?I-=Oi.DRAWABOVE.YOffset*u:2==this.Direction&&(I+=this.TextSize.YOffset*u)),"DRAWTEXT"==this.Name?this.DrawTextV2(this.Text,C,t):this.DrawText(this.Text,m,I,t)}}}}else this.DrawRectText()},this.DrawPosition=function(){if(this.Text){var t=!0===this.ChartFrame.IsHScreen;if(t)var e=this.ChartBorder.GetRightEx()-this.ChartBorder.GetWidthEx()*this.Position.Y,a=this.ChartBorder.GetTop()+this.ChartBorder.GetHeight()*this.Position.X;else a=this.ChartBorder.GetLeft()+this.ChartBorder.GetWidth()*this.Position.X,e=this.ChartBorder.GetTopEx()+this.ChartBorder.GetHeightEx()*this.Position.Y;if(this.Canvas.fillStyle=this.Color,"DRAWTEXT_FIX"==this.Name?this.Canvas.font=this.Font.DRAWTEXT_FIX:"DRAWNUMBER_FIX"==this.Name&&(this.Canvas.font=this.Font.DRAWNUMBER_FIX),0==this.Position.Type?this.Canvas.textAlign="left":1==this.Position.Type?this.Canvas.textAlign="right":this.Canvas.textAlign="center",1==this.Direction?this.Canvas.textBaseline="bottom":2==this.Direction?this.Canvas.textBaseline="top":this.Canvas.textBaseline="middle",Array.isArray(this.Text)){if(!this.Data||!this.Data.Data)return;for(var i=this.ChartFrame.XPointCount,r=this.Data.DataOffset,n=0;r<this.Data.Data.length&&n<i;++r,++n){var s=this.Text[r];if(s){this.DrawText(s,a,e,t);break}}}else this.DrawText(this.Text,a,e,t)}},this.DrawText=function(t,e,a,i){i?(this.Canvas.save(),this.Canvas.translate(a,e),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(t,0,0),this.Canvas.restore()):this.Canvas.fillText(t,e,a)},this.DrawTextV2=function(t,e,a){var i=this.Canvas.measureText(t).width;if(a){var r=e.Y,n=e.X;if("right"==e.Text.Align?n-=i:"center"==e.Text.Align&&(n-=i/2),"top"==e.Text.Baseline?r-=e.Font.Height:"middle"==e.Text.Baseline&&(r-=e.Font.Height/2),this.TextBG&&(this.TextBG.Color||this.TextBG.Border)){var s=this.TextBG.Margin,o=r-s[0],h=n-s[2],l=i+s[2]+s[3],u=e.Font.Height+s[0]+s[1];this.TextBG.Color&&(this.Canvas.fillStyle=this.TextBG.Color,this.Canvas.fillRect(o,h,u,l)),this.TextBG.Border&&(this.Canvas.strokeStyle=this.TextBG.Border,this.Canvas.strokeRect(Q(o),Q(h),tt(u),tt(l)))}this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left",this.Canvas.fillStyle=e.Text.Color,this.Canvas.save(),this.Canvas.translate(r,n),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(t,0,0),this.Canvas.restore()}else{r=e.X,n=e.Y;if("right"==e.Text.Align?r-=i:"center"==e.Text.Align&&(r-=i/2),"top"==e.Text.Baseline?n+=e.Font.Height:"middle"==e.Text.Baseline&&(n+=e.Font.Height/2),this.TextBG&&(this.TextBG.Color||this.TextBG.Border)){s=this.TextBG.Margin,o=r-s[2],h=n-e.Font.Height-s[1],l=i+s[2]+s[3],u=e.Font.Height+s[0]+s[1];this.TextBG.Color&&(this.Canvas.fillStyle=this.TextBG.Color,this.Canvas.fillRect(o,h,l,u)),this.TextBG.Border&&(this.Canvas.strokeStyle=this.TextBG.Border,this.Canvas.strokeRect(Q(o),Q(h),tt(l),tt(u)))}this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left",this.Canvas.fillStyle=e.Text.Color,this.Canvas.fillText(t,r,n)}}}function fe(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawText",this.Color="rgb(255,193,37)",this.TextFont="14px å¾®è½¯éé»",this.TextBaseline="middle",this.TextAlign="left",this.Text,this.TextBG,this.FixedFontSize=-1,this.YOffset=0,this.FixedPosition=-1,this.VerticalLine,this.TextSize={Max:Oi.DRAWICON.Text.MaxSize,Min:Oi.DRAWICON.Text.MinSize,Zoom:{Type:Oi.DRAWICON.Text.Zoom.Type,Value:Oi.DRAWICON.Text.Zoom.Value},FontName:Oi.DRAWICON.Text.FontName,YOffset:Oi.DRAWICON.Text.YOffset},this.ReloadResource=function(t){this.TextSize={Max:Oi.DRAWTEXT.MaxSize,Min:Oi.DRAWTEXT.MinSize,Zoom:{Type:Oi.DRAWTEXT.Zoom.Type,Value:Oi.DRAWTEXT.Zoom.Value},FontName:Oi.DRAWTEXT.FontName,YOffset:Oi.DRAWTEXT.YOffset}},this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize)if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=this.IsMinuteFrame(),a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetLeft()+i/2+Oi.FrameLeftMargin,n=this.ChartBorder.GetRight(),s=this.ChartBorder.GetTopEx(),o=this.ChartBorder.GetBottomEx();t&&(n=this.ChartBorder.GetBottom(),s=this.ChartBorder.GetRightEx(),o=this.ChartBorder.GetLeftEx(),r=this.ChartBorder.GetTop()+i/2+Oi.FrameLeftMargin);var h=this.ChartFrame.XPointCount,l=Array.isArray(this.Text),u={Text:{Color:this.Color,Align:this.TextAlign,Baseline:this.TextBaseline},Font:{}};this.FixedFontSize>0?this.TextFont=this.FixedFontSize+"px "+this.TextSize.FontName:this.TextFont=this.GetDynamicFont(a,i,this.TextSize.Max,this.TextSize.Min,this.TextSize.Zoom,this.TextSize.FontName),this.Canvas.font=this.TextFont,u.Font={Height:this.GetFontHeight()};for(var C=this.Data.DataOffset,D=0;C<this.Data.Data.length&&D<h;++C,++D,r+=a+i){var f=this.Data.Data[C];if(null!=f){if(e)var c=this.ChartFrame.GetXFromIndex(D);else{var d=r,m=r+a;if(m>n)break;c=d+(m-d)/2}var v;if(v=1===this.FixedPosition?s:2===this.FixedPosition?o:this.ChartFrame.GetYFromData(f),c>n)break;if(u.X=c,u.Y=v,l){var S=this.Text[C];if(!S)continue;this.DrawText(S,u,t)}else this.DrawText(this.Text,u,t);this.DrawVerticalLine(C,u,t)}}}},this.DrawText=function(t,e,a){var i=this.Canvas.measureText(t).width;if(a){var r=e.Y,n=e.X;if("right"==e.Text.Align?n-=i:"center"==e.Text.Align&&(n-=i/2),"top"==e.Text.Baseline?r-=e.Font.Height:"middle"==e.Text.Baseline&&(r-=e.Font.Height/2),this.TextBG&&(this.TextBG.Color||this.TextBG.Border)){var s=this.TextBG.Margin,o=r-s[0],h=n-s[2],l=i+s[2]+s[3],u=e.Font.Height+s[0]+s[1];this.TextBG.Color&&(this.Canvas.fillStyle=this.TextBG.Color,this.Canvas.fillRect(o,h,u,l)),this.TextBG.Border&&(this.Canvas.strokeStyle=this.TextBG.Border,this.Canvas.strokeRect(Q(o),Q(h),tt(u),tt(l))),e.Rect={Bottom:o,Top:o+u}}else{o=r,u=e.Font.Height;e.Rect={Bottom:o,Top:o+u}}this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left",this.Canvas.fillStyle=e.Text.Color,this.Canvas.save(),this.Canvas.translate(r,n),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(t,0,0),this.Canvas.restore()}else{r=e.X,n=e.Y;if("right"==e.Text.Align?r-=i:"center"==e.Text.Align&&(r-=i/2),"top"==e.Text.Baseline?n+=e.Font.Height:"middle"==e.Text.Baseline&&(n+=e.Font.Height/2),this.TextBG&&(this.TextBG.Color||this.TextBG.Border)){s=this.TextBG.Margin,o=r-s[2],h=n-e.Font.Height-s[1],l=i+s[2]+s[3],u=e.Font.Height+s[0]+s[1];this.TextBG.Color&&(this.Canvas.fillStyle=this.TextBG.Color,this.Canvas.fillRect(o,h,l,u)),this.TextBG.Border&&(this.Canvas.strokeStyle=this.TextBG.Border,this.Canvas.strokeRect(Q(o),Q(h),tt(l),tt(u))),e.Rect={Top:h,Bottom:h+u}}else{h=n-e.Font.Height,u=e.Font.Height;e.Rect={Top:h,Bottom:h+u}}this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left",this.Canvas.fillStyle=e.Text.Color,this.Canvas.fillText(t,r,n)}},this.DrawVerticalLine=function(t,e,a){if(this.VerticalLine){var i=this.VerticalLine.Data[t];if(i&&ha.IsNumber(i.High)&&ha.IsNumber(i.Low)){var r,n,s=this.ChartFrame.GetYFromData(i.High),o=this.ChartFrame.GetYFromData(i.Low);if(a)if(e.Rect.Bottom>s)r=e.Rect.Bottom-1,n=s+1;else{if(!(e.Rect.Top<o))return;r=e.Rect.Top-1,n=o-1}else if(e.Rect.Bottom<s)r=e.Rect.Bottom+1,n=s-1;else{if(!(e.Rect.Top>o))return;r=e.Rect.Top-1,n=o+1}this.Canvas.save();var h=U(),l=e.X;1==this.VerticalLine.LineType&&(this.VerticalLine.LineDotted?this.Canvas.setLineDash(this.VerticalLine.LineDotted):this.Canvas.setLineDash([5,10])),ha.IsPlusNumber(this.VerticalLine.LineWidth)&&(this.Canvas.lineWidth=this.VerticalLine.LineWidth*h),this.Canvas.strokeStyle=this.VerticalLine.Color,this.Canvas.beginPath(),a?(this.Canvas.moveTo(Q(r),Q(l)),this.Canvas.lineTo(Q(n),Q(l))):(this.Canvas.moveTo(Q(l),Q(r)),this.Canvas.lineTo(Q(l),Q(n))),this.Canvas.stroke(),this.Canvas.restore()}}}}function ce(){this.newMethod=fe,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawNumber",this.ReloadResource=function(t){this.TextSize={Max:Oi.DRAWNUMBER.MaxSize,Min:Oi.DRAWNUMBER.MinSize,Zoom:{Type:Oi.DRAWNUMBER.Zoom.Type,Value:Oi.DRAWNUMBER.Zoom.Value},FontName:Oi.DRAWNUMBER.FontName,YOffset:Oi.DRAWNUMBER.YOffset}}}function de(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartStraightLine",this.Color="rgb(255,193,37)",this.Draw=function(){if(this.Data&&this.Data.Data&&1==this.Data.Data.length){this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight();var t=this.ChartFrame.XPointCount,e=this.Data.Data[0],a=this.ChartFrame.GetYFromData(e),i=this.ChartFrame.GetXFromIndex(0),r=this.ChartFrame.GetXFromIndex(t-1),n=parseInt(a.toString())+.5;this.Canvas.beginPath(),this.Canvas.moveTo(i,n),this.Canvas.lineTo(r,n),this.Canvas.strokeStyle=this.Color,this.Canvas.stroke()}},this.GetMaxMin=function(){this.ChartFrame.XPointCount;var t={Min:null,Max:null};return this.Data&&this.Data.Data?(1!=this.Data.Data.length||(t.Min=this.Data.Data[0],t.Max=this.Data.Data[0]),t):t}}function me(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartStraightArea",this.Color="rgb(255,193,37)",this.Font="11px å¾®è½¯éé»",this.Draw=function(){if(!this.ChartFrame.IsMinSize)if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data)if(!0!==this.ChartFrame.IsHScreen){this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight(),this.ChartBorder.GetBottom();var t=this.ChartBorder.GetLeft(),e=this.ChartFrame.XPointCount,a=this.ChartFrame.GetXFromIndex(e-1);for(var i in this.Data.Data){var r=this.Data.Data[i];if(null!=r&&!isNaN(r.Value)&&!isNaN(r.Value2)&&null!=r.Color){var n=Math.max(r.Value,r.Value2),s=Math.min(r.Value,r.Value2),o=this.ChartFrame.GetYFromData(n),h=this.ChartFrame.GetYFromData(s);if(this.Canvas.fillStyle=r.Color,this.Canvas.fillRect(tt(t),tt(o),tt(a-t),tt(h-o)),r.Title&&r.TitleColor){this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=r.TitleColor,this.Canvas.font=this.Font;var l=o+(h-o)/2;this.Canvas.fillText(r.Title,a,l)}}}}else this.HScreenDraw()},this.HScreenDraw=function(){var t=this.ChartBorder.GetBottom(),e=this.ChartBorder.GetTop(),a=this.ChartBorder.GetHeight();for(var i in this.Data.Data){var r=this.Data.Data[i];if(null!=r&&!isNaN(r.Value)&&!isNaN(r.Value2)&&null!=r.Color){var n=Math.max(r.Value,r.Value2),s=Math.min(r.Value,r.Value2),o=this.ChartFrame.GetYFromData(n),h=this.ChartFrame.GetYFromData(s);if(this.Canvas.fillStyle=r.Color,this.Canvas.fillRect(tt(h),tt(e),tt(o-h),tt(a)),r.Title&&r.TitleColor){var l=o+(h-o)/2,u=t;this.Canvas.save(),this.Canvas.translate(l,u),this.Canvas.rotate(90*Math.PI/180),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=r.TitleColor,this.Canvas.font=this.Font,this.Canvas.fillText(r.Title,0,-2),this.Canvas.restore()}}}},this.GetMaxMin=function(){this.ChartFrame.XPointCount;var t={Min:null,Max:null};if(!this.Data||!this.Data.Data)return t;for(var e in this.Data.Data){var a=this.Data.Data[e];if(null!=a&&!isNaN(a.Value)&&!isNaN(a.Value2)){var i=Math.max(a.Value,a.Value2),r=Math.min(a.Value,a.Value2);null==t.Max&&(t.Max=i),null==t.Min&&(t.Min=r),t.Max<i&&(t.Max=i),t.Min>r&&(t.Min=r)}}return t}}function ve(){this.newMethod=jt,this.newMethod(),delete this.newMethod,this.ClassName="ChartMinutePriceLine",this.YClose,this.IsDrawArea=!0,this.AreaColor="rgba(0,191,255,0.1)",this.IsShowLead=!1,this.LeadData,this.UpColor=Oi.UpBarColor,this.DownColor=Oi.DownBarColor,this.BeforeOpenData,this.BeforeLineColor=Oi.Minute.Before.LineColor,this.BeforeAvPriceColor=Oi.Minute.Before.AvPriceColor,this.BeforePoint=et(Oi.Minute.Before.Point),this.AfterCloseData,this.AfterLineColor=Oi.Minute.After.LineColor,this.AfterAvPriceColor=Oi.Minute.After.AvPriceColor,this.AfterPoint=et(Oi.Minute.After.Point),this.MultiDayBeforeOpenData,this.MultiDayAfterCloseData,this.ColorLineData,this.Source,this.PtInChart=this.PtInLine,this.DrawSelectedStatus=this.DrawLinePoint,this.PtInChart=this.PtInLine,this.DrawSelectedStatus=this.DrawLinePoint,this.DayOffset,this.Draw=function(){if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.IsShow){var t=!0===this.ChartFrame.IsHScreen;this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight();!0===t&&this.ChartBorder.GetBottom();var e=this.ChartFrame.XPointCount,a=this.ChartFrame.MinuteCount,i=this.ChartBorder.GetBottomEx(),r=this.ChartBorder.GetLeftEx(),n=this.Data;if(this.DrawBeforeOpen(),this.DrawMultiDayBeforeOpen(),this.IsShowLead&&this.DrawLead(),n){for(var s=!0,o={},h={},l=0,u=0,C=n.DataOffset,D=0;C<n.Data.length&&D<e;++C,++D){var f=null;if(f=n.Data[C],++u,null!=f){var c=this.ChartFrame.GetXFromIndex(D),d=this.ChartFrame.GetYFromData(f);s?(this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?this.Canvas.moveTo(d,c):this.Canvas.moveTo(c,d),s=!1,o={X:c,Y:d}):t?this.Canvas.lineTo(d,c):this.Canvas.lineTo(c,d),h.X=c,h.Y=d,h.Price=f,++l,u>=a&&(s=!0,this.Canvas.stroke(),this.IsDrawArea&&(t?(this.Canvas.lineTo(r,c),this.Canvas.lineTo(r,o.X),this.SetFillStyle(this.AreaColor,this.ChartBorder.GetRightEx(),i,this.ChartBorder.GetLeftEx(),i)):(this.Canvas.lineTo(c,i),this.Canvas.lineTo(o.X,i),this.SetFillStyle(this.AreaColor,r,this.ChartBorder.GetTopEx(),r,i)),this.Canvas.fill()),u=0,l=0)}}if(l>0&&(this.Canvas.stroke(),this.IsDrawArea&&(t?(this.Canvas.lineTo(r,c),this.Canvas.lineTo(r,o.X),this.SetFillStyle(this.AreaColor,this.ChartBorder.GetRightEx(),i,this.ChartBorder.GetLeftEx(),i)):(this.Canvas.lineTo(c,i),this.Canvas.lineTo(o.X,i),this.SetFillStyle(this.AreaColor,r,this.ChartBorder.GetTopEx(),r,i)),this.Canvas.fill())),this.DrawColorLine(),this.DrawAfterClose(),this.DrawMultiDayAfterClose(),this.GetEventCallback){var m=this.GetEventCallback(G.ON_DRAW_MINUTE_LAST_POINT);if(m){n={LastPoint:{X:h.X,Y:h.Y},Price:h.Price};m.Callback(m,n,this)}}}}},this.DrawLead=function(){if(this.LeadData){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.XPointCount,a=this.ChartFrame.MinuteCount,i=(this.ChartBorder.GetBottomEx(),this.ChartBorder.GetTopEx());if(!0===t&&(i=this.ChartBorder.GetRightEx()),!(e>a)){for(var r=[],n=null,s=null,o=this.ChartFrame.GetYFromData(this.YClose),h=(o-i)/3,l=this.LeadData,u=l.DataOffset,C=0;u<l.Data.length&&C<e;++u,++C){var D=l.Data[u];if(ha.IsNumber(D)&&0!=D){var f=this.ChartFrame.GetXFromIndex(C);(null==n||n<D)&&(n=D),(null==s||s>D)&&(s=D),r.push({X:f,Value:D})}}if(!(r.length<=0)){var c=Math.max(Math.abs(n),Math.abs(s));for(var u in r){var d=r[u];d.Value>0?this.Canvas.strokeStyle=this.UpColor:this.Canvas.strokeStyle=this.DownColor;var m=o-d.Value*h/c;f=Q(d.X);this.Canvas.beginPath(),!0===t?(this.Canvas.moveTo(o,f),this.Canvas.lineTo(m,f)):(this.Canvas.moveTo(f,o),this.Canvas.lineTo(f,m)),this.Canvas.stroke()}}}}},this.DrawBeforeOpen=function(){this.ChartBorder.LeftExtendWidth<10||this.BeforeOpenData&&this.DrawCallAuction(-1,this.BeforeOpenData,!0)},this.DrawAfterClose=function(){this.ChartBorder.RightExtendWidth<10||this.AfterCloseData&&this.DrawCallAuction(-1,this.AfterCloseData,!1)},this.DrawMultiDayBeforeOpen=function(){if(!(this.ChartBorder.MultiDayMinute.Count<=1||this.ChartBorder.MultiDayMinute.Left<=0)&&this.MultiDayBeforeOpenData){var t=0,e=this.MultiDayBeforeOpenData.length;this.DayOffset&&(ha.IsNumber(this.DayOffset.Offset)&&(t=this.DayOffset.Offset),ha.IsNumber(this.DayOffset.ShowDayCount)&&(e=this.DayOffset.ShowDayCount));for(var a=t,i=0;a<this.MultiDayBeforeOpenData.length&&i<e;++a,++i){var r=this.MultiDayBeforeOpenData[a];this.DrawCallAuction(i,r,!0)}}},this.DrawMultiDayAfterClose=function(){if(!(this.ChartBorder.MultiDayMinute.Count<=1||this.ChartBorder.MultiDayMinute.Right<=0)&&this.MultiDayAfterCloseData){var t=0,e=this.MultiDayAfterCloseData.length;this.DayOffset&&(ha.IsNumber(this.DayOffset.Offset)&&(t=this.DayOffset.Offset),ha.IsNumber(this.DayOffset.ShowDayCount)&&(e=this.DayOffset.ShowDayCount));for(var a=t,i=0;a<this.MultiDayAfterCloseData.length&&i<e;++a,++i){var r=this.MultiDayAfterCloseData[a];this.DrawCallAuction(i,r,!1)}}},this.DrawCallAuction=function(t,e,a){if(e){e.Index=t;var i=!0===this.ChartFrame.IsHScreen,r=!0,n=0;e.TotalCount;if(3==e.Ver){for(var s in e.Data){var o=e.Data[s];if(o&&ha.IsNumber(o.AvPrice)){if(a)var h=this.ChartFrame.GetLeftExtendXFromIndex(s,e),l=this.ChartFrame.GetLeftExtendYFromData(o.AvPrice);else h=this.ChartFrame.GetRightExtendXFromIndex(s,e),l=this.ChartFrame.GetRightExtendYFromData(o.AvPrice);r?(this.Canvas.strokeStyle=this.BeforeAvPriceColor,this.Canvas.beginPath(),i?this.Canvas.moveTo(l,h):this.Canvas.moveTo(h,l),r=!1):i?this.Canvas.lineTo(l,h):this.Canvas.lineTo(h,l),++n}}n>0&&this.Canvas.stroke()}r=!0,n=0;var u=[];for(var s in e.Data){o=e.Data[s];if(o&&ha.IsNumber(o.Price)){if(a)h=this.ChartFrame.GetLeftExtendXFromIndex(s,e),l=this.ChartFrame.GetLeftExtendYFromData(o.Price);else h=this.ChartFrame.GetRightExtendXFromIndex(s,e),l=this.ChartFrame.GetRightExtendYFromData(o.Price);r?(this.Canvas.strokeStyle=a?this.BeforeLineColor:this.AfterLineColor,this.Canvas.beginPath(),i?this.Canvas.moveTo(l,h):this.Canvas.moveTo(h,l),r=!1,u.push({X:h,Y:l})):(i?this.Canvas.lineTo(l,h):this.Canvas.lineTo(h,l),u.push({X:h,Y:l})),++n}else if(0==s&&a&&ha.IsNumber(this.YClose)){var h=this.ChartFrame.GetLeftExtendXFromIndex(s,e),l=this.ChartFrame.GetLeftExtendYFromData(this.YClose);this.Canvas.strokeStyle=this.BeforeLineColor,this.Canvas.beginPath(),i?this.Canvas.moveTo(l,h):this.Canvas.moveTo(h,l),r=!1}}if(n>0&&this.Canvas.stroke(),2==e.Ver&&this.BeforePoint.Radius>0)for(var s in this.Canvas.fillStyle=a?this.BeforePoint.Color:this.AfterPoint.Color,u){o=u[s];this.Canvas.beginPath(),i?this.Canvas.arc(o.Y,o.X,this.BeforePoint.Radius,0,2*Math.PI):this.Canvas.arc(o.X,o.Y,this.BeforePoint.Radius,0,2*Math.PI),this.Canvas.fill()}}},this.FindColorLineItem=function(t){if(!t||!this.ColorLineData)return null;for(var e in this.ColorLineData){var a=this.ColorLineData[e];if(a.Date==t.Date&&t.Time>=a.Start&&t.Time<=a.End)return a}return null},this.DrawColorLine=function(){if(this.ColorLineData&&this.Source&&this.Data){var t=!0===this.ChartFrame.IsHScreen,e=(this.ChartBorder.GetBorder(),this.ChartFrame.XPointCount),a=(this.ChartFrame.MinuteCount,this.Data),i=!0,r={},n=0,s=null;this.Canvas.save();for(var o=a.DataOffset,h=0;o<a.Data.length&&h<e;++o,++h){var l=null;l=a.Data[o];var u=this.Source.Data[o];if(l&&u){var C=this.FindColorLineItem(u);if(C){s&&s!=C.Color&&(this.Canvas.stroke(),i=!0);var D=this.ChartFrame.GetXFromIndex(h),f=this.ChartFrame.GetYFromData(l);i?(this.Canvas.strokeStyle=C.Color,ha.IsNumber(C.LineWidth)&&(this.Canvas.lineWidth=C.LineWidth),this.Canvas.beginPath(),t?this.Canvas.moveTo(f,D):this.Canvas.moveTo(D,f),i=!1,{X:D,Y:f},s=C.Color):t?this.Canvas.lineTo(f,D):this.Canvas.lineTo(D,f),r.X=D,r.Y=f,r.Price=l,++n}else n>0&&(this.Canvas.stroke(),i=!0)}}n>0&&this.Canvas.stroke(),this.Canvas.restore()}},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={};if(null==this.YClose)return e;if(!this.IsShow)return e;if(e.Min=this.YClose,e.Max=this.YClose,this.ChartBorder.LeftExtendWidth>10&&this.BeforeOpenData)for(var a in this.BeforeOpenData.Data){var i=this.BeforeOpenData.Data[a];i&&(ha.IsNumber(i.Price)&&(null==e.Max&&(e.Max=i.Price),null==e.Min&&(e.Min=i.Price),e.Max<i.Price&&(e.Max=i.Price),e.Min>i.Price&&(e.Min=i.Price)),3==this.BeforeOpenData.Ver&&ha.IsNumber(i.AvPrice)&&(null==e.Max&&(e.Max=i.AvPrice),null==e.Min&&(e.Min=i.AvPrice),e.Max<i.AvPrice&&(e.Max=i.AvPrice),e.Min>i.AvPrice&&(e.Min=i.AvPrice)))}for(var r=this.Data,n=(a=r.DataOffset,0);a<r.Data.length&&n<t;++a,++n){var s=null;s=r.Data[a],null!=s&&(null==e.Max&&(e.Max=s),null==e.Min&&(e.Min=s),e.Max<s&&(e.Max=s),e.Min>s&&(e.Min=s))}if(e.Max==this.YClose&&e.Min==this.YClose)return e.Max=this.YClose+.1*this.YClose,e.Min=this.YClose-.1*this.YClose,e;var o=Math.max(Math.abs(this.YClose-e.Max),Math.abs(this.YClose-e.Min));return e.Max=this.YClose+o,e.Min=this.YClose-o,e},this.GetTooltipData=function(t,e,a){var i=!0===this.ChartFrame.IsHScreen;if(i)return!1;if(!this.IsShow)return!1;if(!this.Data||!ha.IsNonEmptyArray(this.Data.Data))return!1;var r=this.ChartBorder.PtInClient(t,e,this.Canvas,i);if(1!=r)return!1;var n=this.Data,s=this.ChartFrame.GetXData(t),o=Math.ceil(s),h=Math.floor(s);if(o>=n.Data.length||h>=n.Data.length)return!1;var l=5;if(o==h)n.Data[h];else{var u=n.Data[h],C=n.Data[o],D={X:this.ChartFrame.GetXFromIndex(h),Y:this.ChartFrame.GetYFromData(u)},f={X:this.ChartFrame.GetXFromIndex(o),Y:this.ChartFrame.GetYFromData(C)};if(this.Canvas.beginPath(),this.Canvas.moveTo(D.X,D.Y+l),this.Canvas.lineTo(D.X,D.Y-l),this.Canvas.lineTo(f.X,f.Y-l),this.Canvas.lineTo(f.X,f.Y+l),this.Canvas.closePath(),this.Canvas.isPointInPath(t,e))return a.Data={Index:s,Start:{Index:h,Item:n.Data[h]},End:{Index:o,Value:n.Data[o]}},a.ChartPaint=this,a.Type=5,!0}return!1}}function Se(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.Color="rgb(65,105,225)",this.MainData,this.MainYClose,this.SourceData,this.ClassName="ChartOverlayMinutePriceLine",this.Title,this.Symbol,this.YClose,this.Status=Jt.STATUS_NONE_ID,this.PtInChart=function(t,e){var a={MinuteOverlayPrice:!0,YClose:this.YClose,MainYClose:this.MainYClose};return this.PtInLine(t,e,a)},this.DrawSelectedStatus=function(){var t={MinuteOverlayPrice:!0,YClose:this.YClose,MainYClose:this.MainYClose};this.DrawLinePoint(t)},this.Draw=function(){if(this.Data)if(this.NotSupportMessage)this.DrawNotSupportmessage();else{var t=!0===this.ChartFrame.IsHScreen;this.ChartFrame.DataWidth,this.ChartFrame.DistanceWidth,this.ChartBorder.GetRight();!0===t&&this.ChartBorder.GetBottom();for(var e=this.ChartFrame.XPointCount,a=this.ChartFrame.MinuteCount,i=!0,r=0,n=0,s=this.Data.DataOffset+n,o=0;s<this.Data.Data.length&&o<e;++s,++o){var h=this.Data.Data[s].Close;if(null!=h){var l=h/this.YClose*this.MainYClose,u=this.ChartFrame.GetXFromIndex(o),C=this.ChartFrame.GetYFromData(l);i?(this.Canvas.strokeStyle=this.Color,this.Canvas.beginPath(),t?this.Canvas.moveTo(C,u):this.Canvas.moveTo(u,C),i=!1):t?this.Canvas.lineTo(C,u):this.Canvas.lineTo(u,C),++r,r>=a&&(i=!0,this.Canvas.stroke(),r=0)}}r>0&&this.Canvas.stroke()}},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={};if(null==this.YClose)return e;e.Min=this.MainYClose,e.Max=this.MainYClose;for(var a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a].Close;if(null!=r){r=r/this.YClose*this.MainYClose;null==e.Max&&(e.Max=r),null==e.Min&&(e.Min=r),e.Max<r&&(e.Max=r),e.Min>r&&(e.Min=r)}}if(e.Max==this.MainYClose&&e.Min==this.MainYClose)return e.Max=this.MainYClose+.1*this.MainYClose,e.Min=this.MainYClose-.1*this.MainYClose,e;var n=Math.max(Math.abs(this.MainYClose-e.Max),Math.abs(this.MainYClose-e.Min));return e.Max=this.MainYClose+n,e.Min=this.MainYClose-n,e},this.GetTooltipData=function(t,e,a){var i=!0===this.ChartFrame.IsHScreen;if(i)return!1;if(!this.IsShow)return!1;if(!this.Data||!ha.IsNonEmptyArray(this.Data.Data))return!1;if(!ha.IsNumber(this.YClose)||!ha.IsNumber(this.MainYClose))return!1;var r=this.ChartBorder.PtInClient(t,e,this.Canvas,i);if(1!=r)return!1;var n=this.Data,s=this.ChartFrame.GetXData(t),o=Math.ceil(s),h=Math.floor(s);if(o>=n.Data.length||h>=n.Data.length)return!1;var l=5;if(o==h)n.Data[h];else{var u=n.Data[h].Close;u=u/this.YClose*this.MainYClose;var C=n.Data[o].Close;C=C/this.YClose*this.MainYClose;var D={X:this.ChartFrame.GetXFromIndex(h),Y:this.ChartFrame.GetYFromData(u)},f={X:this.ChartFrame.GetXFromIndex(o),Y:this.ChartFrame.GetYFromData(C)};if(this.Canvas.beginPath(),this.Canvas.moveTo(D.X,D.Y+l),this.Canvas.lineTo(D.X,D.Y-l),this.Canvas.lineTo(f.X,f.Y-l),this.Canvas.lineTo(f.X,f.Y+l),this.Canvas.closePath(),this.Canvas.isPointInPath(t,e))return a.Data={Index:s,Start:{Index:h,Item:n.Data[h]},End:{Index:o,Value:n.Data[o]}},a.ChartPaint=this,a.Type=6,!0}return!1}}function Ie(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartMinuteInfo",this.Data=new E.default,this.SourceData,this.ChartMinutePrice,this.YClose,this.HQChartBorder,this.TextColor=Oi.MinuteInfo.TextColor,this.Font=Oi.MinuteInfo.Font,this.PointColor=Oi.MinuteInfo.PointColor,this.LineColor=Oi.MinuteInfo.LineColor,this.TextBGColor=Oi.MinuteInfo.TextBGColor,this.PixelTatio=U(),this.TextHeight=20,this.TextRectCache=[],this.InfoDrawCache=[],this.FrameBottom,this.FrameTop,this.FrameLeft,this.FrameRight,this.YOffset=5,this.IsHScreen=!1,this.IsDrawFull=!1,this.TooltipRect=[],this.SetOption=function(t){t.TextColor&&(this.TextColor=t.TextColor),t.TextBGColor&&(this.TextBGColor=t.TextBGColor),t.Font&&(this.Font=t.Font),t.PointColor&&(this.PointColor=t.PointColor),t.LineColor&&(this.LineColor=t.LineColor),t.TextHeight>0&&(this.TextHeight=t.TextHeight),1==t.IsDrawFull&&(this.IsDrawFull=!0)},this.Draw=function(){if(this.TooltipRect=[],this.ChartMinutePrice&&this.Data&&!(this.Data.size<=0)){this.TextRectCache=[],this.InfoDrawCache=[],this.PixelTatio=U(),this.YOffset=5*this.PixelTatio,this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartFrame.XPointCount;this.ChartFrame.MinuteCount;this.FrameBottom=this.ChartBorder.GetBottom(),this.IsDrawFull&&this.HQChartBorder&&(this.FrameBottom=this.HQChartBorder.GetBottom()),this.FrameTop=this.ChartBorder.GetTop(),this.FrameLeft=this.ChartBorder.GetLeft(),this.FrameRight=this.ChartBorder.GetRight(),this.IsHScreen&&(this.FrameRight=this.ChartBorder.GetBottom(),this.FrameLeft=this.ChartBorder.GetTop(),this.FrameBottom=this.ChartBorder.GetLeft(),this.FrameTop=this.ChartBorder.GetRight()),this.YClose=this.ChartMinutePrice.YClose;for(var e=this.ChartMinutePrice.Source,a=e.DataOffset,i=0;a<e.Data.length&&i<t;++a,++i){var r=e.Data[a];if(r){var n=r.DateTime;this.Data.has(n)&&(this.IsHScreen?this.CalcuateInfoHScreenPosition(this.Data.get(n),i,r):this.CalcuateInfoPosition(this.Data.get(n),i,r))}}for(var a in this.InfoDrawCache){r=this.InfoDrawCache[a];this.DrawInfoLines(r)}for(var a in this.InfoDrawCache){r=this.InfoDrawCache[a];if(this.DrawInfoText(r),!this.IsHScreen){var s=r.Border,o=new Yt(s.X,s.Y,s.Width,s.Height),h={Data:{Item:r},Rect:o};this.TooltipRect.push(h)}}this.TextRectCache=[],this.InfoDrawCache=[]}},this.CalcuateInfoPosition=function(t,e,a){if(t&&t.Data&&!(t.Data.length<=0)){var i=t.Data[0];this.Canvas.font=this.Font;var r,n=this.Canvas.measureText(i.Title).width+4*this.PixelTatio,s=this.TextHeight*this.PixelTatio,o=this.ChartFrame.GetXFromIndex(e);r=ha.IsNumber(i.Price)?this.ChartFrame.GetYFromData(i.Price):this.ChartFrame.GetYFromData(a.Close),o=Q(o);var h=o<this.FrameLeft+Math.abs(this.FrameLeft-this.FrameRight)/2,l=[2,4,6,8,3,5,7],u=s+l[e%l.length]*this.PixelTatio,C={Y:[{Value:r+(s+this.YOffset),Offset:u},{Value:r-(2*s+this.YOffset),Offset:-u}]};a.Close<this.YClose&&(C.Y=C.Y.reverse());var D={X:o,Y:null,Width:n,Height:s};h||(D.X-=D.Width),this.FixTextRect(D,C);var f={Border:D,Start:{X:o,Y:r},IsLeft:h,Title:i.Title,Date:i.Date,Time:i.Time};i.Content&&(f.Content=i.Content),i.Link&&(f.Link=i.Link),i.Color&&(f.Color=i.Color),i.BGColor&&(f.BGColor=i.BGColor),this.InfoDrawCache.push(f),this.TextRectCache.push(D)}},this.CalcuateInfoHScreenPosition=function(t,e,a){if(t&&t.Data&&!(t.Data.length<=0)){var i=t.Data[0];this.Canvas.font=this.Font;var r,n=this.Canvas.measureText(i.Title).width+4*this.PixelTatio,s=this.TextHeight*this.PixelTatio,o=this.ChartFrame.GetXFromIndex(e);r=ha.IsNumber(i.Price)?this.ChartFrame.GetYFromData(i.Price):this.ChartFrame.GetYFromData(a.Close),o=Q(o);var h=o<this.FrameLeft+Math.abs(this.FrameLeft-this.FrameRight)/2,l=[2,4,6,8,3,5,7],u=s+l[e%l.length]*this.PixelTatio,C={X:[{Value:r+(s+this.YOffset),Offset:u},{Value:r-(2*s+this.YOffset),Offset:-u}]};a.Close>this.YClose&&(C.X=C.X.reverse());var D={X:null,Y:o,Width:s,Height:n};h||(D.Y-=D.Height),this.FixHScreenTextRect(D,C);var f={Border:D,Start:{X:r,Y:o},IsLeft:h,Title:i.Title};this.InfoDrawCache.push(f),this.TextRectCache.push(D)}},this.DrawInfoLines=function(t){var e=t.Border,a=t.IsLeft;this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(Q(t.Start.X),t.Start.Y),a?this.Canvas.lineTo(Q(t.Start.X),e.Y):this.IsHScreen?this.Canvas.lineTo(e.X,e.Y+e.Height):this.Canvas.lineTo(Q(t.Start.X),e.Y),this.Canvas.stroke(),this.Canvas.fillStyle=this.PointColor,this.Canvas.beginPath(),this.Canvas.arc(t.Start.X,t.Start.Y,5,0,2*Math.PI),this.Canvas.closePath(),this.Canvas.fill()},this.DrawInfoText=function(t){var e=t.Border,a=e.X,i=e.Y;t.BGColor?this.Canvas.fillStyle=t.BGColor:this.Canvas.fillStyle=this.TextBGColor,this.Canvas.fillRect(a,i,e.Width,e.Height),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.rect(a,i,e.Width,e.Height),this.Canvas.stroke(),this.IsHScreen&&(this.Canvas.save(),this.Canvas.translate(e.X,e.Y),this.Canvas.rotate(90*Math.PI/180),a=0,i=0),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",t.Color?this.Canvas.fillStyle=t.Color:this.Canvas.fillStyle=this.TextColor,this.Canvas.font=this.Font,this.IsHScreen?this.Canvas.fillText(t.Title,a+2*this.PixelTatio,i-e.Width/2):this.Canvas.fillText(t.Title,a+2*this.PixelTatio,i+e.Height/2),this.IsHScreen&&this.Canvas.restore()},this.FixTextRect=function(t,e){for(var a in e.Y){var i,r=e.Y[a];t.Y=r.Value;for(var n=0;n<10;++n){var s=!1;for(var o in this.TextRectCache){var h=this.TextRectCache[o];if(this.IsOverlap(h,t)){s=!0;break}}if(0==s)return;if(i=t.Y,i+=r.Offset,i+t.Height>this.FrameBottom||i<this.FrameTop)break;t.Y=i}}},this.FixHScreenTextRect=function(t,e){for(var a in e.X){var i,r=e.X[a];t.X=r.Value;for(var n=0;n<10;++n){var s=!1;for(var o in this.TextRectCache){var h=this.TextRectCache[o];if(this.IsOverlap(h,t)){s=!0;break}}if(0==s)return;if(i=t.X,i+=r.Offset,i+t.Width<this.FrameBottom||i>this.FrameTop)break;t.X=i}}},this.IsOverlap=function(t,e){return t.X+t.Width>e.X&&e.X+e.Width>t.X&&t.Y+t.Height>e.Y&&e.Y+e.Height>t.Y},this.GetMaxMin=function(){var t={Min:null,Max:null};return t},this.GetTooltipData=function(t,e,a){for(var i in this.TooltipRect){var r=this.TooltipRect[i];if(r.Rect){var n=r.Rect;if(this.Canvas.beginPath(),this.Canvas.rect(n.X,n.Y,n.Width,n.Height),this.Canvas.isPointInPath(t,e))return a.Data=r,a.ChartPaint=this,a.Type=3,!0}}return!1}}function pe(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartMACD",this.UpColor=Oi.UpBarColor,this.DownColor=Oi.DownBarColor,this.LineWidth=1,this.DrawSelectedStatus=this.DrawLinePoint,this.PtInChart=function(t,e){var a=this.ChartFrame.DataWidth,i=this.LineWidth*U();return 50==this.barWidth?i=null:i>a&&(i=a),i<4&&(i=4),this.PtInBar(t,e,{BarWidth:i})},this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize)if(this.NotSupportMessage)this.DrawNotSupportmessage();else if(!0!==this.ChartFrame.IsHScreen){var t=this.IsMinuteFrame(),e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetBorder(),r=i.LeftEx+a/2+Oi.FrameLeftMargin,n=i.RightEx,s=this.ChartFrame.XPointCount,o=this.GetLockRect();o&&(n=o.Left);var h=this.ChartFrame.GetYFromData(0),l=this.LineWidth*U();(50==this.LineWidth||l>e)&&(l=e);var u=this.Canvas.lineWidth;this.Canvas.lineWidth=l;for(var C=this.Data.DataOffset,D=0;C<this.Data.Data.length&&D<s;++C,++D,r+=e+a){var f=this.Data.Data[C];if(null!=f){if(t)var c=this.ChartFrame.GetXFromIndex(D);else{var d=r,m=r+e;if(m>n)break;c=d+(m-d)/2}var v=this.ChartFrame.GetYFromData(f);if(c>n)break;var S=$(l,c);this.Canvas.beginPath(),this.Canvas.moveTo(S,h),this.Canvas.lineTo(S,v),this.Canvas.strokeStyle=f>=0?this.UpColor:this.DownColor,this.Canvas.stroke(),this.Canvas.closePath()}}this.Canvas.lineWidth=u}else this.HScreenDraw()},this.HScreenDraw=function(){var t=this.ChartFrame.DataWidth,e=(this.ChartFrame.DistanceWidth,this.ChartBorder.GetHScreenBorder()),a=e.BottomEx,i=this.ChartFrame.XPointCount,r=this.GetLockRect();r&&(a=r.Top);var n=this.ChartFrame.GetYFromData(0),s=this.LineWidth*U();(50==this.LineWidth||s>t)&&(s=t);var o=this.Canvas.lineWidth;this.Canvas.lineWidth=s;for(var h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<i;++h,++l){var u=this.Data.Data[h];if(null!=u){var C=this.ChartFrame.GetXFromIndex(l),D=this.ChartFrame.GetYFromData(u);if(C>a)break;this.Canvas.beginPath(),this.Canvas.moveTo(n,Q(C)),this.Canvas.lineTo(D,Q(C)),this.Canvas.strokeStyle=u>=0?this.UpColor:this.DownColor,this.Canvas.stroke(),this.Canvas.closePath()}}this.Canvas.lineWidth=o}}function Te(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartBar",this.UpBarColor=Oi.UpBarColor,this.DownBarColor=Oi.DownBarColor,this.Draw=function(){if(!this.ChartFrame.IsMinSize)if(this.NotSupportMessage)this.DrawNotSupportmessage();else{var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartBorder.GetRight(),i=this.ChartFrame.XPointCount,r=this.ChartBorder.GetLeft()+e/2+2,n=this.ChartFrame.GetYFromData(0);if(t>=4){n=tt(n);for(var s=this.Data.DataOffset,o=0;s<this.Data.Data.length&&o<i;++s,++o,r+=t+e){var h=this.Data.Data[s];if(null!=h&&0!=h){var l=r,u=r+t;if(u>a)break;var C=this.ChartFrame.GetXFromIndex(o),D=this.ChartFrame.GetYFromData(h);this.Canvas.fillStyle=h>0?this.UpBarColor:this.DownBarColor;var f=tt(Math.abs(n-D));D=n-D>0?n-f:n+f,this.Canvas.fillRect(tt(l),D,tt(t),f)}}}else for(s=this.Data.DataOffset,o=0;s<this.Data.Data.length&&o<i;++s,++o,r+=t+e){h=this.Data.Data[s];if(null!=h&&0!=h){l=r,u=r+t;if(u>a)break;C=this.ChartFrame.GetXFromIndex(o),D=this.ChartFrame.GetYFromData(h);this.Canvas.strokeStyle=h>0?this.UpBarColor:this.DownBarColor,this.Canvas.beginPath(),this.Canvas.moveTo(Q(C),D),this.Canvas.lineTo(Q(C),n),this.Canvas.stroke()}}}},this.GetMaxMin=function(){for(var t=this.ChartFrame.XPointCount,e={Min:0,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];null==e.Max&&(e.Max=r),e.Max<r&&(e.Max=r)}return e}}function ge(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.IsDrawFirst=!0,this.ClassName="ChartBand",this.FirstColor=Oi.Index.LineColor[0],this.SecondColor=Oi.Index.LineColor[1],this.Draw=function(){if(!this.ChartFrame.IsMinSize)if(this.NotSupportMessage)this.DrawNotSupportmessage();else for(var t=this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartFrame.XPointCount,r=this.ChartBorder.GetLeft()+a/2+2,n=0,s=0,o=0,h=[],l=[],u=this.Data.DataOffset,C=0;u<this.Data.Data.length&&C<i;++u,++C,r+=e+a){for(h=[],l=[];u<this.Data.Data.length&&C<i;++u,++C,r+=e+a){var D=this.Data.Data[u];if(null==D||null==D.Value||null==D.Value2)break;n=this.ChartFrame.GetXFromIndex(C),s=this.ChartFrame.GetYFromData(D.Value),o=this.ChartFrame.GetYFromData(D.Value2),t?(h.push({x:s,y:n}),l.push({x:o,y:n})):(h.push({x:n,y:s}),l.push({x:n,y:o}))}h.length>1&&l.length>1&&this.DrawBand(h,l)}},this.DrawBand=function(t,e){this.Canvas.save(),this.Canvas.beginPath();for(var a=0;a<t.length;++a)0==a?this.Canvas.moveTo(t[a].x,t[a].y):this.Canvas.lineTo(t[a].x,t[a].y);for(a=e.length-1;a>=0;--a)this.Canvas.lineTo(e[a].x,e[a].y);this.Canvas.closePath(),this.Canvas.clip(),this.Canvas.moveTo(t[0].x,this.ChartBorder.GetBottom());for(a=0;a<t.length;++a)this.Canvas.lineTo(t[a].x,t[a].y);this.Canvas.lineTo(t[t.length-1].x,this.ChartBorder.GetBottom()),this.Canvas.closePath(),this.Canvas.fillStyle=this.FirstColor,this.Canvas.fill(),this.Canvas.beginPath(),this.Canvas.moveTo(e[0].x,this.ChartBorder.GetBottom());for(a=0;a<e.length;++a)this.Canvas.lineTo(e[a].x,e[a].y);this.Canvas.lineTo(e[e.length-1].x,this.ChartBorder.GetBottom()),this.Canvas.closePath(),this.Canvas.fillStyle=this.SecondColor,this.Canvas.fill(),this.Canvas.restore()},this.GetMaxMin=function(){for(var t=this.ChartFrame.XPointCount,e={Min:null,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];if(null!=r&&null!=r.Value&&null!=r.Value2){var n=r.Value>r.Value2?r.Value:r.Value2,s=r.Value<r.Value2?r.Value:r.Value2;(null==e.Max||e.Max<n)&&(e.Max=n),(null==e.Min||e.Min>s)&&(e.Min=s)}}return e}}function xe(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.IsDrawFirst=!0,this.ClassName="ChartLineArea",this.Color="rgb(56,67,99)",this.IsHScreen=!1,this.Draw=function(){if(!this.ChartFrame.IsMinSize)if(this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data){for(var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartFrame.XPointCount,i=this.ChartBorder.GetLeft()+e/2+Oi.FrameLeftMargin,r=0,n=0,s=0,o=[],h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<a;++h,++l,i+=t+e){var u=this.Data.Data[h];o[h]=null,null!=u&&null!=u.Value&&null!=u.Value2&&(r=this.ChartFrame.GetXFromIndex(l),n=this.ChartFrame.GetYFromData(u.Value),s=this.ChartFrame.GetYFromData(u.Value2),this.IsHScreen?o[h]={Line:{X:n,Y:r},Line2:{X:s,Y:r}}:o[h]={Line:{X:r,Y:n},Line2:{X:r,Y:s}})}this.Canvas.fillStyle=this.Color;var C=!0,D=0,f=[];for(var h in o){var c=o[h];if(c)C?(this.Canvas.beginPath(),this.Canvas.moveTo(c.Line.X,c.Line.Y),C=!1):this.Canvas.lineTo(c.Line.X,c.Line.Y),f.push(c),++D;else{if(D>0){for(l=f.length-1;l>=0;--l){var d=f[l];this.Canvas.lineTo(d.Line2.X,d.Line2.Y)}this.Canvas.closePath(),this.Canvas.fill()}C=!0,D=0,f=[]}}if(D>0){for(l=f.length-1;l>=0;--l){d=f[l];this.Canvas.lineTo(d.Line2.X,d.Line2.Y)}this.Canvas.closePath(),this.Canvas.fill()}}},this.GetMaxMin=function(){for(var t=this.ChartFrame.XPointCount,e={Min:null,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];if(r&&null!=r.Value&&null!=r.Value2){var n=r.Value>r.Value2?r.Value:r.Value2,s=r.Value<r.Value2?r.Value:r.Value2;(null==e.Max||e.Max<n)&&(e.Max=n),(null==e.Min||e.Min>s)&&(e.Min=s)}}return e}}function Fe(){this.newMethod=xe,this.newMethod(),delete this.newMethod,this.IsDrawFirst=!0,this.IsHScreen=!1,this.ClassName="ChartFillRGN",this.DrawRGB=function(t){var e=!0,a=0,i=[],r=null;for(var n in t){var s=t[n];if(!s||r&&s.Color!=r){if(a>0){for(var o=i.length-1;o>=0;--o){var h=i[o];this.Canvas.lineTo(h.Line2.X,h.Line2.Y)}this.Canvas.closePath(),this.Canvas.fillStyle=r,this.Canvas.fill()}e=!0,a=0,i=[],r=null}s&&(e?(this.Canvas.beginPath(),this.Canvas.moveTo(s.Line.X,s.Line.Y),e=!1,r=s.Color):this.Canvas.lineTo(s.Line.X,s.Line.Y),i.push(s),++a)}if(a>0){for(o=i.length-1;o>=0;--o){h=i[o];this.Canvas.lineTo(h.Line2.X,h.Line2.Y)}this.Canvas.closePath(),this.Canvas.fillStyle=r,this.Canvas.fill()}},this.Draw=function(){if(!this.ChartFrame.IsMinSize)if(this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data){for(var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartFrame.XPointCount,i=this.ChartBorder.GetLeft()+e/2+Oi.FrameLeftMargin,r=0,n=0,s=0,o=[],h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<a;++h,++l,i+=t+e){var u=this.Data.Data[h];o[h]=null,null!=u&&null!=u.Value&&null!=u.Value2&&u.Color&&(r=this.ChartFrame.GetXFromIndex(l),n=this.ChartFrame.GetYFromData(u.Value),s=this.ChartFrame.GetYFromData(u.Value2),this.IsHScreen?o[h]={Line:{X:n,Y:r},Line2:{X:s,Y:r},Color:u.Color}:o[h]={Line:{X:r,Y:n},Line2:{X:r,Y:s},Color:u.Color})}this.DrawRGB(o)}}}function ye(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.IsDrawFirst=!1,this.ClassName="ChartFLOATRGN",this.Color="rgb(56,67,99)",this.IsHScreen=!1,this.Draw=function(){if(!this.ChartFrame.IsMinSize)if(this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data){for(var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartFrame.XPointCount,i=this.ChartBorder.GetLeft()+e/2+Oi.FrameLeftMargin,r=0,n=0,s=0,o=[],h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<a;++h,++l,i+=t+e){var u=this.Data.Data[h];o[h]=null,u&&ha.IsNumber(u.Value)&&ha.IsNumber(u.Value2)&&u.Color&&(r=this.ChartFrame.GetXFromIndex(l),n=this.ChartFrame.GetYFromData(u.Value),this.IsHScreen?o[h]={Line:{X:n,Y:r},Line2:{X:n+u.Value2*U(),Y:r},Color:u.Color}:o[h]={Line:{X:r,Y:n},Line2:{X:r,Y:n-u.Value2*U()},Color:u.Color})}var C=null;for(var h in o){u=o[h];if(C&&u)if(this.IsHScreen){var D=u.Line.Y-C.Line.Y;r=C.Line.Y+D/2,n=C.Line.X+(u.Line.X-C.Line.X)/2,s=C.Line2.X+(u.Line2.X-C.Line2.X)/2,C.RightLine={X:n,Y:r},C.RightLine2={X:s,Y:r},u.LeftLine={X:n,Y:r},u.LeftLine2={X:s,Y:r}}else{D=u.Line.X-C.Line.X;r=C.Line.X+D/2,n=C.Line.Y+(u.Line.Y-C.Line.Y)/2,s=C.Line2.Y+(u.Line2.Y-C.Line2.Y)/2,C.RightLine={X:r,Y:n},C.RightLine2={X:r,Y:s},u.LeftLine={X:r,Y:n},u.LeftLine2={X:r,Y:s}}C=u}this.DrawRGB(o)}},this.DrawRGB=function(t){var e=!0,a=0,i=[],r=null;if(this.IsHScreen)var n=this.ChartBorder.GetLeftEx(),s=this.ChartBorder.GetRightEx(),o=this.ChartBorder.GetTop(),h=this.ChartBorder.GetBottom();else n=this.ChartBorder.GetLeft(),s=this.ChartBorder.GetRight(),o=this.ChartBorder.GetTopEx(),h=this.ChartBorder.GetBottomEx();for(var l in this.Canvas.save(),this.Canvas.beginPath(),this.Canvas.rect(n,o,s-n,h-o),this.Canvas.clip(),t){var u=t[l];if(!u||r&&u.Color!=r){if(a>0){var C=i[i.length-1],D=i[0];C.RightLine&&(this.Canvas.lineTo(C.RightLine.X,C.RightLine.Y),this.Canvas.lineTo(C.RightLine2.X,C.RightLine2.Y));for(var f=i.length-1;f>=0;--f){var c=i[f];this.Canvas.lineTo(c.Line2.X,c.Line2.Y)}D.LeftLine2&&this.Canvas.lineTo(D.LeftLine2.X,D.LeftLine2.Y),this.Canvas.closePath(),this.Canvas.fillStyle=r,this.Canvas.fill()}e=!0,a=0,i=[],r=null}u&&(e?(this.Canvas.beginPath(),u.LeftLine?(this.Canvas.moveTo(u.LeftLine.X,u.LeftLine.Y),this.Canvas.lineTo(u.Line.X,u.Line.Y)):this.Canvas.moveTo(u.Line.X,u.Line.Y),e=!1,r=u.Color):this.Canvas.lineTo(u.Line.X,u.Line.Y),i.push(u),++a)}if(a>0){C=i[i.length-1],D=i[0];C.RightLine&&(this.Canvas.lineTo(C.RightLine.X,C.RightLine.Y),this.Canvas.lineTo(C.RightLine2.X,C.RightLine2.Y));for(f=i.length-1;f>=0;--f){c=i[f];this.Canvas.lineTo(c.Line2.X,c.Line2.Y)}D.LeftLine2&&this.Canvas.lineTo(D.LeftLine2.X,D.LeftLine2.Y),this.Canvas.closePath(),this.Canvas.fillStyle=r,this.Canvas.fill()}this.Canvas.restore()},this.GetMaxMin=function(){for(var t=this.ChartFrame.XPointCount,e={Min:null,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];if(r&&ha.IsNumber(r.Value)){var n=r.Value;(null==e.Max||e.Max<n)&&(e.Max=n),(null==e.Min||e.Min>n)&&(e.Min=n)}}return e}}function Le(){this.newMethod=Fe,this.newMethod(),delete this.newMethod,this.IsDrawFirst=!0,this.IsHScreen=!1,this.ClassName="ChartFillBGRGN",this.DrawVerticalRGN=function(){for(var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartFrame.XPointCount,i=this.ChartBorder.GetLeft()+e/2+Oi.FrameLeftMargin,r=this.ChartBorder.GetTopEx(),n=this.ChartBorder.GetBottomEx(),s=r,o=n,h=[],l=this.Data.DataOffset,u=0;l<this.Data.Data.length&&u<a;++l,++u,i+=t+e){var C=this.Data.Data[l];h[l]=null,C&&C.Color&&(x=this.ChartFrame.GetXFromIndex(u),this.IsHScreen?h[l]={Line:{X:s,Y:x},Line2:{X:o,Y:x},Color:C.Color}:h[l]={Line:{X:x,Y:s},Line2:{X:x,Y:o},Color:C.Color})}this.DrawRGB(h)},this.Draw=function(){if(!this.ChartFrame.IsMinSize)if(this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.Data&&this.Data.Data)if("FILLVERTICALRGN"!=this.Name){var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartFrame.XPointCount,i=this.ChartBorder.GetLeft()+e/2+Oi.FrameLeftMargin,r=this.ChartBorder.GetTopEx(),n=this.ChartBorder.GetBottomEx(),s=0,o=0,h=r;"FILLBOTTOMRGN"==this.Name&&(h=n);for(var l=[],u=this.Data.DataOffset,C=0;u<this.Data.Data.length&&C<a;++u,++C,i+=t+e){var D=this.Data.Data[u];l[u]=null,null!=D&&null!=D.Value&&D.Color&&(s=this.ChartFrame.GetXFromIndex(C),o=this.ChartFrame.GetYFromData(D.Value),this.IsHScreen?l[u]={Line:{X:o,Y:s},Line2:{X:h,Y:s},Color:D.Color}:l[u]={Line:{X:s,Y:o},Line2:{X:s,Y:h},Color:D.Color})}this.DrawRGB(l)}else this.DrawVerticalRGN()},this.DrawRGB=function(t){var e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=(a+e)/2,r=!0,n=0,s=[],o=null;for(var h in t){var l=t[h];if(!l||o&&l.Color!=o){if(n>0){for(var u=s.length-1;u>=0;--u){var C=s[u];this.Canvas.lineTo(C.Line2.X+i,C.Line2.Y),this.Canvas.lineTo(C.Line2.X-i,C.Line2.Y)}this.Canvas.closePath(),this.Canvas.fillStyle=o,this.Canvas.fill()}r=!0,n=0,s=[],o=null}l&&(r?(this.Canvas.beginPath(),this.Canvas.moveTo(l.Line.X-i,l.Line.Y),this.Canvas.lineTo(l.Line.X+i,l.Line.Y),r=!1,o=l.Color):(this.Canvas.lineTo(l.Line.X-i,l.Line.Y),this.Canvas.lineTo(l.Line.X+i,l.Line.Y)),s.push(l),++n)}if(n>0){for(u=s.length-1;u>=0;--u){C=s[u];this.Canvas.lineTo(C.Line2.X+i,C.Line2.Y),this.Canvas.lineTo(C.Line2.X-i,C.Line2.Y)}this.Canvas.closePath(),this.Canvas.fillStyle=o,this.Canvas.fill()}},this.GetMaxMin=function(){for(var t=this.ChartFrame.XPointCount,e={Min:null,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];if(r&&null!=r.Value){r=r.Value;(null==e.Max||e.Max<r)&&(e.Max=r),(null==e.Min||e.Min>r)&&(e.Min=r)}}return e}}function Ee(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.IsDrawFirst=!0,this.ClassName="ChartChannel",this.IsHScreen=!1,this.PointCount=0,this.DataWidth=0,this.DistanceWidth=0,this.ChartRight=0,this.LineColor="RGB(255,0,0)",this.LineDotted=[3,3],this.AreaColor="RGB(255,222,173)",this.LineWidth=1,this.CalculateData=function(){for(var t=[],e=[],a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<this.PointCount;++a,++i){var r=this.Data.Data[a];if(r&&ha.IsNumber(r.Value)&&ha.IsNumber(r.Value2)){var n=this.ChartFrame.GetXFromIndex(i);if(n>this.ChartRight)break;var s=this.ChartFrame.GetYFromData(r.Value),o=this.ChartFrame.GetYFromData(r.Value2);e.push({X:n,Y:s,Y2:o})}else e.length>0&&(t.push(e),e=[])}return e.length>0&&t.push(e),t},this.DrawArea=function(t){if(!(t.length<=0)){this.Canvas.beginPath();var e=t[0];this.IsHScreen?this.Canvas.moveTo(e.Y,e.X):this.Canvas.moveTo(e.X,e.Y);for(var a=1;a<t.length;++a){var i=t[a];this.IsHScreen?this.Canvas.lineTo(i.Y,i.X):this.Canvas.lineTo(i.X,i.Y)}for(a=t.length-1;a>=0;--a){i=t[a];this.IsHScreen?this.Canvas.lineTo(i.Y2,i.X):this.Canvas.lineTo(i.X,i.Y2)}this.Canvas.closePath(),this.Canvas.fillStyle=this.AreaColor,this.Canvas.fill()}},this.DrawLine=function(t){this.Canvas.strokeStyle=this.LineColor;for(var e=0;e<2;++e){for(var a=!0,i=0,r=0;r<t.length;++r){var n=t[r];a?(this.Canvas.beginPath(),this.IsHScreen?this.Canvas.moveTo(0===e?n.Y:n.Y2,n.X):this.Canvas.moveTo(n.X,0===e?n.Y:n.Y2),a=!1):this.IsHScreen?this.Canvas.lineTo(0===e?n.Y:n.Y2,n.X):this.Canvas.lineTo(n.X,0===e?n.Y:n.Y2),++i}i>0&&this.Canvas.stroke()}},this.Draw=function(){if(!this.ChartFrame.IsMinSize)if(this.NotSupportMessage)this.DrawNotSupportmessage();else{this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.PointCount=this.ChartFrame.XPointCount,this.DataWidth=this.ChartFrame.DataWidth,this.DistanceWidth=this.ChartFrame.DistanceWidth,this.IsHScreen?this.ChartRight=this.ChartBorder.GetBottom():this.ChartRight=this.ChartBorder.GetRight();var t=this.CalculateData();if(t&&!(t.length<=0)){this.Canvas.save(),this.Canvas.lineWidth=this.LineWidth*U(),this.Canvas.setLineDash(this.LineDotted);for(var e=0;e<t.length;++e){var a=t[e];this.DrawArea(a),this.DrawLine(a)}this.Canvas.restore()}}},this.GetMaxMin=function(){for(var t=this.ChartFrame.XPointCount,e={Min:null,Max:null},a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];if(null!=r&&null!=r.Value&&null!=r.Value2){var n=r.Value>r.Value2?r.Value:r.Value2,s=r.Value<r.Value2?r.Value:r.Value2;(null==e.Max||e.Max<n)&&(e.Max=n),(null==e.Min||e.Min>s)&&(e.Min=s)}}return e}}function Me(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartBackground",this.Color=null,this.ColorAngle=0,this.IsDrawFirst=!0,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.Color&&!(this.Color.length<=0)){if(this.IsHScreen=!0===this.ChartFrame.IsHScreen,2==this.Color.length){if(this.IsHScreen)if(0==this.ColorAngle)var t={X:this.ChartBorder.GetRight(),Y:this.ChartBorder.GetTopEx()},e={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetTopEx()};else t={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetTopEx()},e={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetBottomEx()};else if(0==this.ColorAngle)t={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetTopEx()},e={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetBottomEx()};else t={X:this.ChartBorder.GetLeft(),Y:this.ChartBorder.GetTopEx()},e={X:this.ChartBorder.GetRight(),Y:this.ChartBorder.GetTopEx()};var a=this.Canvas.createLinearGradient(t.X,t.Y,e.X,e.Y);a.addColorStop(0,this.Color[0]),a.addColorStop(1,this.Color[1]),this.Canvas.fillStyle=a}else{if(1!=this.Color.length)return;this.Canvas.fillStyle=this.Color[0]}if("DRAWGBK2"!=this.Name&&"KLINE_BG"!=this.Name){if(this.IsHScreen)var i=this.ChartBorder.GetLeftEx(),r=this.ChartBorder.GetTop(),n=this.ChartBorder.GetWidthEx(),s=this.ChartBorder.GetHeight();else i=this.ChartBorder.GetLeft(),r=this.ChartBorder.GetTopEx(),n=this.ChartBorder.GetWidth(),s=this.ChartBorder.GetHeightEx();this.Canvas.fillRect(i,r,n,s)}else this.DrawRegion()}},this.DrawRegion=function(){var t=this.ChartFrame.XPointCount,e=this.ChartBorder.GetLeft()+i/2+Oi.FrameLeftMargin,a=this.ChartFrame.DataWidth,i=this.ChartFrame.DistanceWidth,r=this.ChartBorder.GetTopEx(),n=this.ChartBorder.GetBottomEx();this.IsHScreen&&(r=this.ChartBorder.GetRightEx(),n=this.ChartBorder.GetLeftEx());for(var s=[],o=this.Data.DataOffset,h=0;o<this.Data.Data.length&&h<t;++o,++h,e+=a+i){var l=this.Data.Data[o];if(s[o]=null,ha.IsNumber(l)&&!(l<=0)){var u=this.ChartFrame.GetXFromIndex(h);this.ChartFrame.GetYFromData(l.Value);this.IsHScreen?s[o]={Line:{X:n,Y:u},Line2:{X:r,Y:u}}:s[o]={Line:{X:u,Y:r},Line2:{X:u,Y:n}}}}this.DrawBG(s)},this.DrawBG=function(t){var e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=(a+e)/2,r=!0,n=0,s=[],o=null;for(var h in t){var l=t[h];if(!l||o&&l.Color!=o){if(n>0){for(var u=s.length-1;u>=0;--u){var C=s[u];this.IsHScreen?(this.Canvas.lineTo(C.Line2.X,C.Line2.Y+i),this.Canvas.lineTo(C.Line2.X,C.Line2.Y-i)):(this.Canvas.lineTo(C.Line2.X+i,C.Line2.Y),this.Canvas.lineTo(C.Line2.X-i,C.Line2.Y))}this.Canvas.closePath(),this.Canvas.fill()}r=!0,n=0,s=[],o=null}l&&(r?(this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(l.Line.X,l.Line.Y-i),this.Canvas.lineTo(l.Line.X,l.Line.Y+i)):(this.Canvas.moveTo(l.Line.X-i,l.Line.Y),this.Canvas.lineTo(l.Line.X+i,l.Line.Y)),r=!1,o=l.Color):this.IsHScreen?(this.Canvas.lineTo(l.Line.X,l.Line.Y-i),this.Canvas.lineTo(l.Line.X,l.Line.Y+i)):(this.Canvas.lineTo(l.Line.X-i,l.Line.Y),this.Canvas.lineTo(l.Line.X+i,l.Line.Y)),s.push(l),++n)}if(n>0){for(u=s.length-1;u>=0;--u){C=s[u];this.IsHScreen?(this.Canvas.lineTo(C.Line2.X,C.Line2.Y+i),this.Canvas.lineTo(C.Line2.X,C.Line2.Y-i)):(this.Canvas.lineTo(C.Line2.X+i,C.Line2.Y),this.Canvas.lineTo(C.Line2.X-i,C.Line2.Y))}this.Canvas.closePath(),this.Canvas.fill()}},this.GetMaxMin=function(){return{Min:null,Max:null}}}function Ae(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartRectangle",this.Color=[],this.Rect,this.BorderColor=Oi.FrameBorderPen,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.Color&&this.Rect&&!(this.Color.length<=0)){this.Canvas.strokeStyle=this.BorderColor;var t=!1;if(2==this.Color.length)this.Canvas.fillStyle=this.Color[0],t=!0;else{if(1!=this.Color.length)return;this.Color[0]&&(this.Canvas.fillStyle=this.Color[0],t=!0)}var e=this.ChartBorder.GetWidth(),a=this.ChartBorder.GetHeightEx(),i=this.Rect.Left/1e3*e,r=this.Rect.Top/1e3*a,n=this.Rect.Right/1e3*e,s=this.Rect.Bottom/1e3*a;i=this.ChartBorder.GetLeft()+i,r=this.ChartBorder.GetTopEx()+r,n=this.ChartBorder.GetLeft()+n,s=this.ChartBorder.GetTopEx()+s;var o=Math.abs(i-n),h=Math.abs(r-s);t&&this.Canvas.fillRect(i,r,o,h),this.Canvas.rect(Q(i),Q(r),tt(o),tt(h)),this.Canvas.stroke()}}}function Ne(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartTextLine",this.Text,this.Line,this.Price,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.Text&&this.Line&&ha.IsNumber(this.Price)){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRight(),a=this.ChartBorder.GetBottomEx(),i=this.ChartBorder.GetTopEx(),r=this.ChartFrame.GetYFromData(this.Price),n=0;if(this.Text.Title){var s=t+2*U(),o=r;this.Canvas.textAlign="left",this.Canvas.textBaseline="middle";var h=8*U();r-h<i?(this.Canvas.textBaseline="top",o=i):r+h>a&&(this.Canvas.textBaseline="bottom",o=a),this.Canvas.fillStyle=this.Text.Color,this.Canvas.font=this.Text.Font,this.Canvas.fillText(this.Text.Title,s,o),n=this.Canvas.measureText(this.Text.Title).width+4*U()}if(this.Line.Type>0){2==this.Line.Type&&(this.Canvas.save(),this.Canvas.setLineDash([3,5]));s=t+n;this.Canvas.strokeStyle=this.Line.Color,this.Canvas.beginPath(),this.Canvas.moveTo(s,Q(r)),this.Canvas.lineTo(e,Q(r)),this.Canvas.stroke(),2==this.Line.Type&&this.Canvas.restore()}}},this.GetMaxMin=function(){var t={Min:null,Max:null};return ha.IsNumber(this.Price)&&(t.Min=this.Price,t.Max=this.Price),t}}function we(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartMultiBar",this.Bars=[],this.IsHScreen=!1,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.Data&&!(this.Data.length<=0)){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartFrame.XPointCount,e=this.Data.DataOffset,a=this.ChartFrame.DataWidth,i=U(),r=[];for(var n in this.Bars){var s=this.Bars[n],o={Point:[],Color:s.Color,Width:a,Type:0};for(var h in s.Type>0&&(o.Type=s.Type),s.Width>0?(o.Width=s.Width*i,o.Width>a&&(o.Width=a)):o.Width<4&&(o.Width=1*i),s.Point){var l=s.Point[h];if(ha.IsNumber(l.Index)){var u=l.Index-e;if(u>=0&&u<t){var C=this.ChartFrame.GetXFromIndex(u),D=this.ChartFrame.GetYFromData(l.Value),f=this.ChartFrame.GetYFromData(l.Value2);o.Point.push({X:C,Y:D,Y2:f})}}}o.Point.length>0&&r.push(o)}for(var n in r){s=r[n];s.Width>=4?1==s.Type?this.DrawHollowBar(s):this.DrawFillBar(s):this.DrawLineBar(s)}}},this.DrawLineBar=function(t){this.Canvas.strokeStyle=t.Color;var e=this.Canvas.lineWidth;for(var a in this.Canvas.lineWidth=t.Width,t.Point){var i=t.Point[a];this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(Q(i.Y),Q(i.X)),this.Canvas.lineTo(Q(i.Y2),Q(i.X))):(this.Canvas.moveTo(Q(i.X),Q(i.Y)),this.Canvas.lineTo(Q(i.X),Q(i.Y2))),this.Canvas.stroke()}this.Canvas.lineWidth=e},this.DrawFillBar=function(t){for(var e in this.Canvas.fillStyle=t.Color,t.Point){var a=t.Point[e],i=a.X-t.Width/2,r=Math.min(a.Y,a.Y2),n=t.Width,s=Math.abs(a.Y-a.Y2);this.IsHScreen?this.Canvas.fillRect(tt(r),tt(i),tt(s),tt(n)):this.Canvas.fillRect(tt(i),tt(r),tt(n),tt(s))}},this.DrawHollowBar=function(t){this.Canvas.strokeStyle=t.Color;var e=1;for(var a in t.Point){var i=t.Point[a],r=i.X-t.Width/2,n=Math.min(i.Y,i.Y2),s=t.Width,o=Math.abs(i.Y-i.Y2);this.Canvas.beginPath(),this.IsHScreen?this.Canvas.rect(Q(n),Q(r),tt(o),tt(s)):this.Canvas.rect(Q(r),Q(n),tt(s),tt(o)),this.Canvas.stroke()}this.Canvas.lineWidth=e},this.GetMaxMin=function(){var t={Min:null,Max:null},e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=a+e;for(var r in this.Bars){var n=this.Bars[r];for(var s in n.Point){var o=n.Point[s];if(o.Index>=a&&o.Index<i){var h=Math.min(o.Value,o.Value2),l=Math.max(o.Value,o.Value2);(null==t.Max||t.Max<l)&&(t.Max=l),(null==t.Min||t.Min>h)&&(t.Min=h)}}}return t}}function Oe(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartMultiLine",this.Lines=[],this.LineDash,this.LineWidth=1,this.IsHScreen=!1,this.ArrawAngle=35,this.ArrawLength=10,this.ArrawLineWidth=5,this.Arrow={Start:!1,End:!1},this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.Data&&!(this.Data.length<=0)){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartFrame.XPointCount,e=this.Data.DataOffset,a=[],i=[];for(var r in this.Lines){var n=this.Lines[r],s={Point:[],Color:n.Color},o={Start:[],End:[]};n.BGColor&&(s.BGColor=n.BGColor);for(var h=0;h<n.Point.length;++h){var l=n.Point[h];if(ha.IsNumber(l.Index)){var u=l.Index-e;if(u>=0&&u<t){var C=this.ChartFrame.GetXFromIndex(u),D=this.ChartFrame.GetYFromData(l.Value,!1),f={X:C,Y:D,End:!1};s.Point.push(f),0!=h&&1!=h||o.Start.push(f),h!=n.Point.length-1&&h!=n.Point.length-2||o.End.push(f)}else s.Point.length>0&&(s.Point[s.Point.length-1].End=!0)}}s.Point.length>=2&&(a.push(s),i.push(o))}var c=U();for(var r in this.Canvas.save(),a){this.LineDash&&this.Canvas.setLineDash(this.LineDash),ha.IsPlusNumber(this.LineWidth)?this.Canvas.lineWidth=this.LineWidth*c:this.Canvas.lineWidth=1*c;var d=a[r];this.DrawLine(d,i[r])}this.Canvas.restore()}},this.DrawLine=function(t,e){if(t.BGColor){for(var a in this.Canvas.fillStyle=t.BGColor,t.Point){var i=t.Point[a];0==a?(this.Canvas.beginPath(),this.IsHScreen?this.Canvas.moveTo(i.Y,i.X):this.Canvas.moveTo(i.X,i.Y)):this.IsHScreen?this.Canvas.lineTo(i.Y,i.X):this.Canvas.lineTo(i.X,i.Y)}this.Canvas.closePath(),this.Canvas.fill()}this.Canvas.strokeStyle=t.Color;var r=0;for(var a in t.Point){i=t.Point[a];0==r?(this.Canvas.beginPath(),this.IsHScreen?this.Canvas.moveTo(i.Y,i.X):this.Canvas.moveTo(i.X,i.Y),++r):(this.IsHScreen?this.Canvas.lineTo(i.Y,i.X):this.Canvas.lineTo(i.X,i.Y),++r),1==i.End&&(r>0&&this.Canvas.stroke(),r=0)}r>0&&this.Canvas.stroke(),2==e.End.length&&1==this.Arrow.End&&this.DrawArrow(e.End[0],e.End[1]),2==e.Start.length&&1==this.Arrow.Start&&this.DrawArrow(e.Start[1],e.Start[0])},this.DrawArrow=function(t,e){var a=this.ArrawAngle,i=this.ArrawLength,r=180*Math.atan2(t.Y-e.Y,t.X-e.X)/Math.PI,n=(r+a)*Math.PI/180,s=(r-a)*Math.PI/180,o=i*Math.cos(n),h=i*Math.sin(n),l=i*Math.cos(s),u=i*Math.sin(s);this.Canvas.beginPath();var C=e.X+o,D=e.Y+h;this.Canvas.moveTo(C,D),this.Canvas.lineTo(e.X,e.Y),C=e.X+l,D=e.Y+u,this.Canvas.lineTo(C,D),this.Canvas.setLineDash([]),this.Canvas.lineWidth=this.ArrawLineWidth*U(),this.Canvas.stroke()},this.GetMaxMin=function(){var t={Min:null,Max:null},e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=a+e;for(var r in this.Lines){var n=this.Lines[r];for(var s in n.Point){var o=n.Point[s];o.Index>=a&&o.Index<i&&((null==t.Max||t.Max<o.Value)&&(t.Max=o.Value),(null==t.Min||t.Min>o.Value)&&(t.Min=o.Value))}}return t}}function Re(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartMultiText",this.Texts=[],this.Font=Oi.DefaultTextFont,this.Color=Oi.DefaultTextColor,this.IsHScreen=!1,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.Data&&!(this.Data.length<=0)&&this.Texts){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartFrame.XPointCount,e=this.Data.DataOffset,a=this.ChartBorder.GetLeft(),i=this.ChartBorder.GetRight();for(var r in this.IsHScreen&&(a=this.ChartBorder.GetTop(),i=this.ChartBorder.GetBottom()),this.Texts){var n=this.Texts[r];if(n.Text&&ha.IsNumber(n.Index)){var s=n.Index-e;if(s>=0&&s<t){var o=this.ChartFrame.GetXFromIndex(s),h=this.ChartFrame.GetYFromData(n.Value);n.Color?this.Canvas.fillStyle=n.Color:this.Canvas.fillStyle=this.Color,n.Font?this.Canvas.font=n.Font:this.Canvas.font=this.Font;var l=this.Canvas.measureText(n.Text).width;if(this.Canvas.textAlign="center",o+l/2>=i?(this.Canvas.textAlign="right",o=i):o-l/2<a&&(this.Canvas.textAlign="left",o=a),1==n.Baseline?this.Canvas.textBaseline="top":2==n.Baseline?this.Canvas.textBaseline="bottom":this.Canvas.textBaseline="middle",this.IsHScreen?(this.Canvas.save(),this.Canvas.translate(h,o),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(n.Text,0,0),this.Canvas.restore()):this.Canvas.fillText(n.Text,o,h),n.Line){var u=this.Data.Data[n.Index],C="H"==n.Line.KData?u.High:u.Low,D=this.ChartFrame.GetYFromData(C),f=h;Array.isArray(n.Line.Offset)&&2==n.Line.Offset.length&&(f>D?(f-=n.Line.Offset[1],D+=n.Line.Offset[0]):f<D&&(f+=n.Line.Offset[1],D-=n.Line.Offset[0])),this.Canvas.save(),n.Line.Dash&&this.Canvas.setLineDash(n.Line.Dash),n.Line.Width>0&&(this.Canvas.lineWidth=n.Line.Width),this.Canvas.strokeStyle=n.Line.Color,this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(f,Q(o)),this.Canvas.lineTo(D,Q(o))):(this.Canvas.moveTo(Q(o),f),this.Canvas.lineTo(Q(o),D)),this.Canvas.stroke(),this.Canvas.restore()}}}}}},this.GetMaxMin=function(){var t={Min:null,Max:null};if(!this.Texts)return t;var e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=a+e;for(var r in this.Texts){var n=this.Texts[r];n.Index>=a&&n.Index<i&&((null==t.Max||t.Max<n.Value)&&(t.Max=n.Value),(null==t.Min||t.Min>n.Value)&&(t.Min=n.Value))}return t}}function Pe(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartMultiSVGIcon",this.Icon,this.IconSize={Max:Oi.DRAWICON.Icon.MaxSize,Min:Oi.DRAWICON.Icon.MinSize,Zoom:{Type:Oi.DRAWICON.Icon.Zoom.Type,Value:Oi.DRAWICON.Icon.Zoom.Value}},this.Family,this.Color=Oi.DefaultTextColor,this.IsHScreen=!1,this.IconRect=[],this.Draw=function(){if(this.IconRect=[],this.IsShow&&!this.ChartFrame.IsMinSize&&this.Data&&!(this.Data.length<=0)&&this.Family&&this.Icon&&ha.IsNonEmptyArray(this.Icon)){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartFrame.XPointCount,e=this.Data.DataOffset;this.DataWidth=this.ChartFrame.DataWidth,this.DistanceWidth=this.ChartFrame.DistanceWidth;var a=this.GetBorder();if(this.IsHScreen)var i=a.TopEx,r=a.BottomEx;else i=a.LeftEx,r=a.RightEx;var n=this.GetDynamicIconSize(this.DataWidth,this.DistanceWidth,this.IconSize.Max,this.IconSize.Min,this.IconSize.Zoom);this.Canvas.font=n+"px "+this.Family;for(var s=0;s<this.Icon.length;++s){var o=this.Icon[s];if(ha.IsNumber(o.Index)){var h=o.Index-e;if(h>=0&&h<t){var l=this.ChartFrame.GetXFromIndex(h),u=this.ChartFrame.GetYFromData(o.Value);o.Color?this.Canvas.fillStyle=o.Color:this.Canvas.fillStyle=this.Color;var C=this.Canvas.measureText(o.Text).width;this.Canvas.textAlign="center";var D=new Yt(l-n/2,u-n/2,n,n);if(l+C/2>=r?(this.Canvas.textAlign="right",l+=this.DataWidth/2,D.X=l-n):l-C/2<i&&(this.Canvas.textAlign="left",l-=this.DataWidth/2,D.X=l),1==o.Baseline?(this.Canvas.textBaseline="top",D.Y=u):2==o.Baseline?(this.Canvas.textBaseline="bottom",D.Y=u-n):(this.Canvas.textBaseline="middle",D.Y=u-n/2),this.IsHScreen?(this.Canvas.save(),this.Canvas.translate(u,l),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(o.Symbol,0,0),this.Canvas.restore()):(this.Canvas.fillText(o.Symbol,l,u),o.Text&&this.IconRect.push({Index:s,Rect:D,Item:o})),o.Line){var f=this.Data.Data[o.Index],c="H"==o.Line.KData?f.High:f.Low,d=this.ChartFrame.GetYFromData(c),m=u;Array.isArray(o.Line.Offset)&&2==o.Line.Offset.length&&(m>d?(m-=o.Line.Offset[1],d+=o.Line.Offset[0]):m<d&&(m+=o.Line.Offset[1],d-=o.Line.Offset[0])),this.Canvas.save(),o.Line.Dash&&this.Canvas.setLineDash(o.Line.Dash),o.Line.Width>0&&(this.Canvas.lineWidth=o.Line.Width),this.Canvas.strokeStyle=o.Line.Color,this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(m,Q(l)),this.Canvas.lineTo(d,Q(l))):(this.Canvas.moveTo(Q(l),m),this.Canvas.lineTo(Q(l),d)),this.Canvas.stroke(),this.Canvas.restore()}}}}}},this.GetTooltipData=function(t,e,a){if(!ha.IsNonEmptyArray(this.IconRect))return!1;for(var i=0;i<this.IconRect.length;++i){var r=this.IconRect[i];if(r.Rect){var n=r.Rect;if(this.Canvas.beginPath(),this.Canvas.rect(n.X,n.Y,n.Width,n.Height),this.Canvas.isPointInPath(t,e))return w.Chart.Log("[ChartMultiSVGIcon::GetTooltipData] icon ",r),a.Data=r,a.ChartPaint=this,a.Type=4,!0}}return!1},this.GetMaxMin=function(){var t={Min:null,Max:null},e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=a+e;for(var r in this.Icon){var n=this.Icon[r];n.Index>=a&&n.Index<i&&((null==t.Max||t.Max<n.Value)&&(t.Max=n.Value),(null==t.Min||t.Min>n.Value)&&(t.Min=n.Value))}return t}}function be(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartMultiHtmlDom",this.Texts=[],this.IsHScreen=!1,this.DrawCallback,this.DrawItem=[],this.EnableDraw=!0,this.HQChart,this.IsDestroy=!1,this.Draw=function(){this.EnableDraw&&(this.IsDestroy||(this.DrawItem=[],this.DrawCallback&&this.DrawCallback(1,{Self:this}),this.DrawDom(),this.DrawCallback&&this.DrawCallback(2,{Self:this,DrawItem:this.DrawItem})))},this.OnDestroy=function(){this.IsDestroy=!0,this.DrawCallback&&this.DrawCallback(4,{Self:this})},this.DrawDom=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.Data&&!(this.Data.length<=0)){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartFrame.XPointCount,e=this.Data.DataOffset,a=this.ChartBorder.GetTopEx(),i=this.ChartBorder.GetBottomEx(),r=U();if(this.HQChart)var n=this.HQChart.UIElement.getBoundingClientRect().left,s=this.HQChart.UIElement.getBoundingClientRect().top;else n=null,s=null;for(var o in this.Texts){var h=this.Texts[o];if(h.Text&&ha.IsNumber(h.Index)){var l=this.IsMinuteFrame(),u=h.Index-e,C=this.Data.Data[h.Index],D={KData:C,Item:h,IsShow:!1,Self:this};if(u>=0&&u<t){var f=this.ChartFrame.GetXFromIndex(u);if("Top"==h.Value)var c=a;else if("Bottom"==h.Value)c=i;else c=this.ChartFrame.GetYFromData(h.Value);D.X=f/r,D.Y=c/r,D.UIElement={Left:n,Top:s},D.IsShow=!0}if(this.DrawItem.push(D),this.DrawCallback&&this.DrawCallback(3,D),h.Line){if(l)var d=this.Data.Data[h.Index];else C=this.Data.Data[h.Index],d="H"==h.Line.KData?C.High:C.Low;var m=this.ChartFrame.GetYFromData(d),v=c;Array.isArray(h.Line.Offset)&&2==h.Line.Offset.length&&(v>m?(v-=h.Line.Offset[1],m+=h.Line.Offset[0]):v<m&&(v+=h.Line.Offset[1],m-=h.Line.Offset[0])),this.Canvas.save(),h.Line.Dash&&this.Canvas.setLineDash(h.Line.Dash);var S=U(),I=1*S;h.Line.Width>0&&(I=h.Line.Width*S),this.Canvas.lineWidth=I,this.Canvas.strokeStyle=h.Line.Color,this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(v,Q(f)),this.Canvas.lineTo(m,Q(f))):(this.Canvas.moveTo($(I,f),v),this.Canvas.lineTo($(I,f),m)),this.Canvas.stroke(),this.Canvas.restore()}}}}},this.GetMaxMin=function(){var t={Min:null,Max:null},e=this.ChartFrame.XPointCount,a=this.Data.DataOffset,i=a+e;for(var r in this.Texts){var n=this.Texts[r];ha.IsNumber(n.Index)&&(n.Index>=a&&n.Index<i&&((null==t.Max||t.Max<n.Value)&&(t.Max=n.Value),(null==t.Min||t.Min>n.Value)&&(t.Min=n.Value)))}return t}}function Be(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartOX",this.Font,this.Family=Oi.ChartOX.Family,this.Color=[Oi.ChartOX.Up.Color,Oi.ChartOX.Down.Color],this.Text=[Oi.ChartOX.Up.Text,Oi.ChartOX.Down.Text],this.IsHScreen=!1,this.SquareSize=10,this.OXData=null,this.SquareLineColor=Oi.ChartOX.SquareLineColor,this.TooltipData=[],this.CalcualteSquare=function(){if(this.IsHScreen)var t=this.ChartBorder.GetHScreenBorder(),e=t.LeftEx,a=t.RightEx;else t=this.ChartBorder.GetBorder(),e=t.TopEx,a=t.BottomEx;this.SquareSize=(a-e)/(this.OXData.Max-this.OXData.Min)*this.OXData.BlockSize;var i=parseInt(this.SquareSize);this.Font=i+"px "+this.Family},this.DrawSquares=function(){if(this.Canvas.beginPath(),this.Canvas.strokeStyle=this.SquareLineColor,this.IsHScreen)var t=this.ChartBorder.GetHScreenBorder(),e=t.Top,a=t.Bottom;else{t=this.ChartBorder.GetBorder(),e=t.Left,a=t.Right;var i=t.TopEx,r=t.BottomEx}for(var n=this.OXData.StartPrice;n<this.OXData.Max;n+=this.OXData.BlockSize){var s=this.ChartFrame.GetYFromData(n);this.IsHScreen?(this.Canvas.moveTo(Q(s),t.Top),this.Canvas.lineTo(Q(s),t.Bottom)):(this.Canvas.moveTo(e,Q(s)),this.Canvas.lineTo(a,Q(s)))}for(n=this.OXData.StartPrice;n>this.OXData.Min;n-=this.OXData.BlockSize){s=this.ChartFrame.GetYFromData(n);this.IsHScreen?(this.Canvas.moveTo(Q(s),t.Top),this.Canvas.lineTo(Q(s),t.Bottom)):(this.Canvas.moveTo(e,Q(s)),this.Canvas.lineTo(a,Q(s)))}for(var o=e+Oi.FrameLeftMargin,h=o;h<a;h+=this.SquareSize)this.IsHScreen?(this.Canvas.moveTo(t.LeftEx,Q(h)),this.Canvas.lineTo(t.RightEx,Q(h))):(this.Canvas.moveTo(Q(h),i),this.Canvas.lineTo(Q(h),r));this.Canvas.stroke()},this.Draw=function(){if(this.TooltipData=[],!this.ChartFrame.IsMinSize)if(this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.NotSupportMessage)this.DrawNotSupportmessage();else if(this.OXData&&this.OXData.Data)if(this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.CalcualteSquare(),this.DrawSquares(),this.IsHScreen){var t=this.ChartBorder.GetTop(),e=this.ChartBorder.GetBottom(),a=t+Oi.FrameLeftMargin;this.Canvas.textBaseline="middle",this.Canvas.textAlign="center",this.Canvas.font=this.Font;for(var i=0;i<this.OXData.Data.length;++i,a+=this.SquareSize){if(a>e)break;var r=this.OXData.Data[i];this.Canvas.fillStyle=this.Color[r.Type];var n=this.Text[r.Type];if(ha.IsNonEmptyArray(r.Data))for(var s=0;s<r.Data.length;++s){var o=r.Data[s],h=this.ChartFrame.GetYFromData(o+this.OXData.BlockSize/2);this.Canvas.fillText(n,h,a+this.SquareSize/2)}}}else{t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRight(),a=t+Oi.FrameLeftMargin;this.Canvas.textBaseline="middle",this.Canvas.textAlign="center",this.Canvas.font=this.Font;for(i=0;i<this.OXData.Data.length;++i,a+=this.SquareSize){if(a>e)break;r=this.OXData.Data[i];this.Canvas.fillStyle=this.Color[r.Type];n=this.Text[r.Type];var l={X:a,Width:this.SquareSize},u=null,C=null;if(ha.IsNonEmptyArray(r.Data)){for(s=0;s<r.Data.length;++s){o=r.Data[s],h=this.ChartFrame.GetYFromData(o+this.OXData.BlockSize/2);this.Canvas.fillText(n,a+this.SquareSize/2,h),(null==u||u<o)&&(u=o),(null==C||C>o)&&(C=o)}l.Y=this.ChartFrame.GetYFromData(u+this.OXData.BlockSize),l.Height=this.ChartFrame.GetYFromData(C)-l.Y;var D={Data:r,Rect:l};this.TooltipData.push(D)}}}},this.GetTooltipData=function(t,e,a){for(var i in this.TooltipData){var r=this.TooltipData[i];if(r.Rect){var n=r.Rect;if(this.Canvas.beginPath(),this.Canvas.rect(n.X,n.Y,n.Width,n.Height),this.Canvas.isPointInPath(t,e))return w.Chart.Log("[ChartOX::GetTooltipData] item ",r),a.Data=r,a.ChartPaint=this,a.Type=5,!0}}return!1},this.GetMaxMin=function(){var t={Min:null,Max:null};return this.OXData&&(ha.IsNumber(this.OXData.Max)&&(t.Max=this.OXData.Max),ha.IsNumber(this.OXData.Min)&&(t.Min=this.OXData.Min)),t}}function Ve(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartVolProfileVisibleRange",this.IsDrawFirst=!0,this.IsShowText=!0,this.VolType=0,this.BarPosition=1,this.BarWidthRate=.3,this.VolFont,this.HQChart,this.IsDestroy=!1,this.Data=null,this.MaxVol,this.MaxVolPrice,this.VolLineColor=Oi.ChartVolProfileVisibleRange.VolLineColor,this.VolLineFont=Oi.ChartVolProfileVisibleRange.VolLineFont,this.VolLineTextColor=Oi.ChartVolProfileVisibleRange.VolLineTextColor,this.VAHLineColor=Oi.ChartVolProfileVisibleRange.VAHLineColor,this.VAHTextColor=Oi.ChartVolProfileVisibleRange.VAHTextColor,this.VALLineColor=Oi.ChartVolProfileVisibleRange.VALLineColor,this.VALTextColor=Oi.ChartVolProfileVisibleRange.VALTextColor,this.VAFont=Oi.ChartVolProfileVisibleRange.VAFont,this.TextConfig=(0,v.default)({Color:Oi.ChartVolProfileVisibleRange.Text.Color,Family:Oi.ChartVolProfileVisibleRange.Text.Family,FontMaxSize:Oi.ChartVolProfileVisibleRange.Text.FontMaxSize,FontMinSize:Oi.ChartVolProfileVisibleRange.Text.FontMinSize},"Color",Oi.ChartVolProfileVisibleRange.Text.Color),this.BarColor=[Oi.ChartVolProfileVisibleRange.UpVolColor,Oi.ChartVolProfileVisibleRange.DownVolColor,Oi.ChartVolProfileVisibleRange.AreaUpColor,Oi.ChartVolProfileVisibleRange.AreaDonwColor],this.MaxVolLine,this.OnDestroy=function(){this.IsDestroy=!0},this.SetOption=function(t){t&&(ha.IsBool(t.IsShowText)&&(this.IsShowText=t.IsShowText),ha.IsNumber(t.VolType)&&(this.IsShowText=t.VolType),ha.IsNumber(t.BarPosition)&&(this.BarPosition=t.BarPosition),ha.IsNumber(t.BarWidthRate)&&(this.IsShowText=t.BarWidthRate))},this.PtInChart=function(t,e){return this.MaxVolLine&&t>=this.MaxVolLine.Start.X&&t<=this.MaxVolLine.End.X&&e>=this.MaxVolLine.Start.Y-5&&e<this.MaxVolLine.Start.Y+5?{Identify:this.Identify,Chart:this}:null},this.SetSelectedStatus=function(t){this.IsDrawFirst=0==t},this.DrawSelectedStatus=function(){var t=this.SelectedRadius,e=U();if(this.Canvas.save(),this.MaxVolLine){this.Canvas.lineWidth=this.SelectedLineWidth*e,this.Canvas.strokeStyle=this.SelectedLineColor,this.SelectedBGColor&&(this.Canvas.fillStyle=this.SelectedBGColor);for(var a=(this.MaxVolLine.End.X-this.MaxVolLine.Start.X)/6,i=[],r=this.MaxVolLine.Start.X+a;r<this.MaxVolLine.End.X;r+=a)i.push({X:r,Y:this.MaxVolLine.Start.Y});for(var n=0;n<i.length;++n){var s=i[n];this.Canvas.beginPath(),this.Canvas.arc(s.X,s.Y,t,0,360,!1),this.Canvas.closePath(),this.SelectedBGColor&&this.Canvas.fill(),this.Canvas.stroke()}}this.Canvas.restore()},this.Draw=function(){this.VolFont=null,this.MaxVolLine=null,this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.ChartFrame.IsMinSize||(this.NotSupportMessage?this.DrawNotSupportmessage():this.Data&&this.Data.Data&&(this.Canvas.save(),this.DrawVolBar(),this.Canvas.restore()))},this.DrawPriceLine=function(){var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRight(),a=U(),i=[],r=this.MaxVolPrice;ha.IsNumber(this.Data.MaxVolPrice)&&(r=this.Data.MaxVolPrice),r>=this.ChartFrame.HorizontalMin&&r<=this.ChartFrame.HorizontalMax&&i.push({Price:r,Font:this.VolLineFont,LineColor:this.VolLineColor,LineWidth:2,TextColor:this.VolLineTextColor,Type:1}),ha.IsNumber(this.Data.VAHPrice)&&this.Data.VAHPrice>=this.ChartFrame.HorizontalMin&&this.Data.VAHPrice<=this.ChartFrame.HorizontalMax&&i.push({Price:this.Data.VAHPrice,Font:this.VAFont,LineColor:this.VAHLineColor,LineWidth:2,TextColor:this.VAHTextColor,Type:2}),ha.IsNumber(this.Data.VALPrice)&&this.Data.VALPrice>=this.ChartFrame.HorizontalMin&&this.Data.VALPrice<=this.ChartFrame.HorizontalMax&&i.push({Price:this.Data.VALPrice,Font:this.VAFont,LineColor:this.VALLineColor,LineWidth:2,TextColor:this.VALTextColor,Type:3});for(var n=0;n<i.length;++n){var s=i[n],o=$(s.LineWidth,this.ChartFrame.GetYFromData(s.Price,!1));if(this.Canvas.lineWidth=s.LineWidth,this.Canvas.strokeStyle=s.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(t,o),this.Canvas.lineTo(e,o),this.Canvas.stroke(),1==s.Type&&(this.MaxVolLine={Start:{X:t,Y:o},End:{X:e,Y:o}}),this.ChartBorder.Right>10){var h=rn(this.HQChart.Symbol),l=s.Price.toFixed(h);this.Canvas.font=s.Font,this.Canvas.textAlign="left",this.Canvas.textBaseline="middle";var u=this.GetFontHeight(),C=this.Canvas.measureText(l).width+2*a;this.Canvas.fillStyle=s.LineColor,this.Canvas.fillRect(e,o-u/2,C,u),this.Canvas.fillStyle=s.TextColor,this.Canvas.fillText(l,e+1*a,o)}}},this.DrawVolBar=function(){var t=this.GetPriceYOffset(this.Data.PriceOffset),e=this.ChartBorder.GetLeft(),a=this.ChartBorder.GetRight(),i=(this.ChartFrame.GetYFromData(this.Data.MaxPrice),this.ChartFrame.GetYFromData(this.Data.MinPrice),a-e),r=i*this.BarWidthRate;this.IsShowText&&(this.VolFont=this.GetDynamicVolTextFont(t,r),this.VolFont&&(this.Canvas.font=this.VolFont));for(var n=0;n<this.Data.Data.length;++n){var s=this.Data.Data[n];s.Price<this.ChartFrame.HorizontalMin||s.Price>this.ChartFrame.HorizontalMax||this.DrawVolBarItem(s,e,a,r,t)}this.DrawPriceLine()},this.DrawVolBarItem=function(t,e,a,i,r){var n=e,s=a,o=this.ChartFrame.GetYFromData(t.Price)-r/2,h=r-1;if(h<1&&(h=1),1==this.VolType){if(!t.TotalVol)return;if(!ha.IsNumber(t.TotalVol.Value))return;var l=t.TotalVol.Value*i/this.MaxVol;if(ha.IsNumber(t.TotalVol.ColorID)?D=this.BarColor[t.TotalVol.ColorID]:t.TotalVol.Color&&(D=t.TotalVol.Color),this.Canvas.fillStyle=D,1==this.BarPosition?this.Canvas.fillRect(s,tt(o),-l,tt(h)):this.Canvas.fillRect(n,tt(o),l,tt(h)),this.IsShowText&&this.VolFont){var u=ha.FormatVolString(t.TotalVol.Value,this.HQChart.LanguageID);this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextConfig.Color,1==this.BarPosition?(this.Canvas.textAlign="right",this.Canvas.fillText(u,a-5,o+r/2)):(this.Canvas.textAlign="left",this.Canvas.fillText(u,e+5,o+r/2))}}else{u="";for(var C=0;C<t.Vol.length;++C){var D,f=t.Vol[C];if(ha.IsNumber(f.Value))if(ha.IsNumber(f.ColorID)?D=this.BarColor[f.ColorID]:f.Color&&(D=f.Color),D){l=f.Value*i/this.MaxVol;this.Canvas.fillStyle=D,1==this.BarPosition?(this.Canvas.fillRect(s,tt(o),-l,tt(h)),s-=l):(this.Canvas.fillRect(n,tt(o),l,tt(h)),n+=l);var c=ha.FormatVolString(f.Value,this.HQChart.LanguageID);u.length>0&&(u+="x"),u+=c}}this.IsShowText&&this.VolFont&&(this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextConfig.Color,1==this.BarPosition?(this.Canvas.textAlign="right",this.Canvas.fillText(u,a-5,o+r/2)):(this.Canvas.textAlign="left",this.Canvas.fillText(u,e+5,o+r/2)))}},this.GetPriceYOffset=function(t){var e=this.ChartFrame,a=e.ChartBorder.GetHeightEx()*t/(e.HorizontalMax-e.HorizontalMin);return a},this.GetDynamicVolTextFont=function(t,e,a){var i=parseInt(t)-2;if(t<5&&(i=parseInt(t)),i>this.TextConfig.FontMaxSize?i=this.TextConfig.FontMaxSize:i<=0&&(i=1),i<this.TextConfig.FontMinSize)return null;var r=this.FormatFontString(i,this.TextConfig.Family,a);return r},this.FormatFontString=function(t,e,a){var i;return a?a.Weight&&(i=a.Weight+" "+t+"px "+e):i=t+"px "+e,i},this.GetMaxMin=function(){var t={Min:null,Max:null};return t}}function Ge(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartStackedBar",this.Data,this.BarName=[],this.BarColor=["rgb(255,165,0)","rgb(95,158,160)"],this.LineWidth=1,this.BarType=0,this.IsHScreen,this.Draw=function(){if(this.IsShow&&!this.ChartFrame.IsMinSize&&this.Data&&ha.IsNonEmptyArray(this.Data.Data)){this.IsHScreen=!0===this.ChartFrame.IsHScreen;var t=this.ChartFrame.DataWidth,e=this.ChartFrame.DistanceWidth,a=this.ChartFrame.XPointCount;if(this.IsHScreen)var i=this.ChartBorder.GetHScreenBorder(),r=i.TopEx+e/2+Oi.FrameLeftMargin,n=i.BottomEx,s=i.RightEx,o=i.LeftEx;else{i=this.ChartFrame.GetBorder(),r=i.LeftEx+e/2+Oi.FrameLeftMargin,n=i.RightEx,s=i.TopEx,o=i.BottomEx;var h=this.GetLockRect();h&&(n=h.Left)}var l=this.IsMinuteFrame();if(this.Canvas.save(),1==this.BarType);else{this.LineWidth>0&&(this.Canvas.lineWidth=this.LineWidth*U());var u=this.Canvas.lineWidth}for(var C=this.ChartFrame.GetYFromData(0),D=this.Data.DataOffset,f=0;D<this.Data.Data.length&&f<a;++D,++f,r+=t+e){var c=this.Data.Data[D];if(ha.IsNonEmptyArray(c)){if(l)var d=this.ChartFrame.GetXFromIndex(f);else{var m=r,v=r+t;if(v>n)break;d=m+(v-m)/2}if(d>n)break;1==this.BarType&&t>=4?this.DrawKBarItem(c,d,m,v,s,o,C,t):this.DrawBarItem(c,d,s,o,C,u)}}this.Canvas.restore()}},this.DrawKBarItem=function(t,e,a,i,r,n,s,o){for(var h=0,l=s,u=0,C=s,D=0;D<t.length;++D){var f=t[D];if(ha.IsNumber(f)&&0!=f){if(this.Canvas.fillStyle=this.BarColor[D],f>0){h+=f;var c=this.ChartFrame.GetYFromData(h),d={Left:a,Top:c,Width:o,Height:l-c};l=c}else{u+=f;c=this.ChartFrame.GetYFromData(u),d={Left:a,Top:c,Width:o,Height:C-c};C=c}this.IsHScreen?this.Canvas.fillRect(d.Top,d.Left,d.Height,d.Width):this.Canvas.fillRect(d.Left,d.Top,d.Width,d.Height)}}},this.DrawBarItem=function(t,e,a,i,r,n){e=$(n,e);for(var s=0,o=r,h=0,l=r,u=0;u<t.length;++u){var C=t[u];if(ha.IsNumber(C)&&0!=C){var D={};if(C>0){s+=C;var f=this.ChartFrame.GetYFromData(s);D={X:e,Y:o,X2:e,Y2:f};o=f}else{h+=C;f=this.ChartFrame.GetYFromData(h),D={X:e,Y:l,X2:e,Y2:f};l=f}this.Canvas.beginPath(),this.IsHScreen?(this.Canvas.moveTo(D.Y,D.X),this.Canvas.lineTo(D.Y2,D.X2)):(this.Canvas.moveTo(D.X,D.Y),this.Canvas.lineTo(D.X2,D.Y2)),this.Canvas.strokeStyle=this.BarColor[u],this.Canvas.stroke()}}},this.GetMaxMin=function(){var t=this.ChartFrame.XPointCount,e={Min:null,Max:null};if(!this.Data||!this.Data.Data)return e;for(var a=this.Data.DataOffset,i=0;a<this.Data.Data.length&&i<t;++a,++i){var r=this.Data.Data[a];if(r&&ha.IsNonEmptyArray(r)){for(var n=0,s=0,o=0;o<r.length;++o){var h=r[o];ha.IsNumber(h)&&(0!=h&&(h>0?n+=h:h<0&&(s+=h)))}null==e.Max&&(e.Max=n,e.Min=s),e.Max<n&&(e.Max=n),e.Min>s&&(e.Min=s)}}return e},this.PtInChart=function(t,e){var a={StackedBar:!0};return 0==this.BarType&&(a.BarWidth=4),this.PtInBar(t,e,a)},this.DrawSelectedStatus=function(){this.DrawLinePoint({StackedBar:!0})}}function He(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartLock",this.WidthDiv=.2,this.LockCount=20,this.BGColor=Oi.LockBGColor,this.TextColor=Oi.LockTextColor,this.Font=Oi.DefaultTextFont,this.Title="ðå¼éæé",this.LockRect=null,this.LockID,this.Callback,this.IndexName,this.MinWidth=null,this.Draw=function(t){if(this.LockRect=null,this.NotSupportMessage)this.DrawNotSupportmessage();else if(!0!==this.ChartFrame.IsHScreen){var e=this.ChartBorder.GetRight(),a=0;if(null!=this.ChartFrame.Data){var i=this.ChartFrame.DataWidth,r=this.ChartFrame.DistanceWidth;e=this.ChartBorder.GetLeft()+r/2+2;for(var n=this.ChartBorder.GetRight(),s=this.ChartFrame.XPointCount,o=this.ChartFrame.Data.DataOffset,h=0;o<this.ChartFrame.Data.Data.length&&h<s;++o,++h,e+=i+r){var l=this.ChartFrame.Data.Data[o];if(null!=l.Open&&null!=l.High&&null!=l.Low&&null!=l.Close){var u=e+i;if(u>n)break}}a=(i+r)*this.LockCount}0==a&&(a=(e-this.ChartBorder.GetLeft())*this.WidthDiv);var C=e-a;C<this.ChartBorder.GetLeft()&&(C=this.ChartBorder.GetLeft());var D=this.ChartBorder.GetBottom()-this.ChartBorder.GetTop(),f=this.ChartBorder.GetRight()-C;if(this.MinWidth>10&&f<this.MinWidth&&(f=this.MinWidth,C=this.ChartBorder.GetRight()-f,C<this.ChartBorder.GetLeft()&&(C=this.ChartBorder.GetLeft())),t){this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(C,this.ChartBorder.GetTop(),f,D);var c=C+f/2,d=this.ChartBorder.GetTop()+D/2;this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.font=this.Font,this.Canvas.fillText(this.Title,c,d)}this.LockRect={Left:C,Top:this.ChartBorder.GetTop(),Width:f,Heigh:D}}else this.HScreenDraw(t)},this.HScreenDraw=function(t){var e=this.ChartBorder.GetBottom(),a=0;if(null!=this.ChartFrame.Data){var i=this.ChartFrame.DataWidth,r=this.ChartFrame.DistanceWidth;e=this.ChartBorder.GetTop()+r/2+2;for(var n=this.ChartBorder.GetBottom(),s=this.ChartFrame.XPointCount,o=this.ChartFrame.Data.DataOffset,h=0;o<this.ChartFrame.Data.Data.length&&h<s;++o,++h,e+=i+r){var l=this.ChartFrame.Data.Data[o];if(null!=l.Open&&null!=l.High&&null!=l.Low&&null!=l.Close){var u=e+i;if(u>n)break}}a=(i+r)*this.LockCount}0==a&&(a=(e-this.ChartBorder.GetTop())*this.WidthDiv);var C=e-a;C<this.ChartBorder.GetTop()&&(C=this.ChartBorder.GetTop());var D=this.ChartBorder.GetRight()-this.ChartBorder.GetLeft(),f=this.ChartBorder.GetBottom()-C;this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(this.ChartBorder.GetLeft(),C,D,f);var c=this.ChartBorder.GetLeft()+D/2,d=C+f/2;this.Canvas.save(),this.Canvas.translate(c,d),this.Canvas.rotate(90*Math.PI/180),this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.font=this.Font,this.Canvas.fillText(this.Title,0,0),this.Canvas.restore(),this.LockRect={Left:this.ChartBorder.GetLeft(),Top:C,Width:D,Heigh:f}},this.GetTooltipData=function(t,e,a){return null!=this.LockRect&&(this.Canvas.beginPath(),this.Canvas.rect(this.LockRect.Left,this.LockRect.Top,this.LockRect.Width,this.LockRect.Heigh),!!this.Canvas.isPointInPath(t,e)&&(a.Data={ID:this.LockID,Callback:this.Callback,IndexName:this.IndexName},a.ChartPaint=this,!0))}}function Ye(){this.newMethod=De,this.newMethod(),delete this.newMethod,this.ClassName="ChartBuySell",this.TextFont=Oi.KLineTrain.Font,this.LastDataIcon=Oi.KLineTrain.LastDataIcon,this.BuyIcon=Oi.KLineTrain.BuyIcon,this.SellIcon=Oi.KLineTrain.SellIcon,this.BuySellData=new E.default,this.IconFont=Oi.KLineTrain.IconFont,this.LastDataDrawType=0,this.LastDataIndex=-1,this.AddTradeItem=function(t){if(this.BuySellData.has(t.Key)){var e=this.BuySellData.get(t.Key);e.Data.push(t)}else this.BuySellData.set(t.Key,{Data:[t]})},this.ClearTradeData=function(){this.BuySellData=new E.default},this.Draw=function(){if(this.Data&&this.Data.Data){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.DataWidth,a=this.ChartFrame.DistanceWidth,i=this.ChartBorder.GetRight();!0===t&&(i=this.ChartBorder.GetBottom());var r=this.ChartFrame.XPointCount;if(this.IconFont){var n=U(),s=e+a,o=18*n;s<o&&(s=o),this.Canvas.font=s+"px "+this.IconFont.Family}else this.Canvas.font=this.TextFont;for(var h=this.Data.DataOffset,l=0;h<this.Data.Data.length&&l<r;++h,++l){var u=this.Data.Data[h];if(null!=u){var C=this.ChartFrame.GetXFromIndex(l);if(C>i)break;var D=!1;if(1==this.LastDataDrawType?h==this.LastDataIndex&&(D=!0):h==this.Data.Data.length-1&&(D=!0),D){C=this.ChartFrame.GetXFromIndex(l);var f=this.ChartFrame.GetYFromData(u.High);this.Canvas.textAlign="center",this.Canvas.textBaseline="bottom",this.IconFont?(this.Canvas.fillStyle=this.IconFont.Last.Color,this.DrawText(this.IconFont.Last.Text,C,f,t)):(this.Canvas.fillStyle=this.LastDataIcon.Color,this.Canvas.font=this.TextFont,this.DrawText(this.LastDataIcon.Text,C,f,t))}var c=h;if(this.BuySellData.has(c)){var d=this.BuySellData.get(c),m=(f=this.ChartFrame.GetYFromData(u.High),this.ChartFrame.GetYFromData(u.Low)),v=[!1,!1];for(var S in d.Data){if(1==v[0]&&1==v[1])break;var I=d.Data[S];0==I.Op&&0==v[0]?(this.Canvas.textAlign="center",this.Canvas.textBaseline="top",this.IconFont?(this.Canvas.fillStyle=this.IconFont.Buy.Color,this.DrawText(this.IconFont.Buy.Text,C,m,t)):(this.Canvas.fillStyle=this.BuyIcon.Color,this.DrawText(this.BuyIcon.Text,C,m,t)),v[0]=!0):1==I.Op&&0==v[1]&&(this.Canvas.textAlign="center",this.Canvas.textBaseline="bottom",this.IconFont?(this.Canvas.fillStyle=this.IconFont.Sell.Color,this.DrawText(this.IconFont.Sell.Text,C,f,t)):(this.Canvas.fillStyle=this.SellIcon.Color,this.DrawText(this.SellIcon.Text,C,f,t)),v[1]=!0)}}}}}}}function ke(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ClassName="ChartOrderbookDepth",this.Data=null,this.AskColor={Line:Oi.DepthChart.AskColor.Line,Area:Oi.DepthChart.AskColor.Area},this.BidColor={Line:Oi.DepthChart.BidColor.Line,Area:Oi.DepthChart.BidColor.Area},this.LineWidth=Oi.DepthChart.LineWidth,this.Draw=function(){if(this.Data){var t=this.Canvas.lineWidth;this.Canvas.lineWidth=this.LineWidth*U(),this.DrawArea(this.Data.Bids,this.BidColor.Line,this.BidColor.Area,!0),this.DrawArea(this.Data.Asks,this.AskColor.Line,this.AskColor.Area,!1),this.Canvas.lineWidth=t}},this.DrawArea=function(t,e,a,i){var r=this.ChartFrame.VerticalRange,n=[];for(var s in t){var o=t[s];if(i){if(o.Price<r.Min)break}else if(o.Price>r.Max)break;var h=this.ChartFrame.GetXFromIndex(o.Price),l=this.ChartFrame.GetYFromData(o.Vol);n.push({X:h,Y:l})}if(!(n.length<=1)){var u=this.ChartBorder.GetLeft(),C=this.ChartBorder.GetBottom(),D=this.ChartBorder.GetRight();for(var s in this.Canvas.beginPath(),this.Canvas.moveTo(n[0].X,C),n){o=n[s];this.Canvas.lineTo(o.X,o.Y)}for(var s in this.Canvas.lineTo(i?u:D,n[n.length-1].Y),this.Canvas.lineTo(i?u:D,C),this.Canvas.lineTo(n[0].X,C),this.Canvas.closePath(),this.Canvas.fillStyle=a,this.Canvas.fill(),this.Canvas.beginPath(),this.Canvas.moveTo(n[0].X,C),n){o=n[s];this.Canvas.lineTo(o.X,o.Y)}this.Canvas.lineTo(i?u:D,n[n.length-1].Y),this.Canvas.strokeStyle=e,this.Canvas.stroke()}},this.GetMaxMin=function(){var t={Min:null,Max:null,XMin:null,XMax:null},e=this.ChartFrame.VerticalRange;for(var a in this.Data.Asks){var i=this.Data.Asks[a];if(i.Price>e.Max)break;(null==t.XMin||t.XMin>i.Price)&&(t.XMin=i.Price),(null==t.XMax||t.XMax<i.Price)&&(t.XMax=i.Price),(null==t.Min||t.Min>i.Vol)&&(t.Min=i.Vol),(null==t.Max||t.Max<i.Vol)&&(t.Max=i.Vol)}for(var a in this.Data.Bids){i=this.Data.Bids[a];if(i.Price<e.Min)break;(null==t.XMin||t.XMin>i.Price)&&(t.XMin=i.Price),(null==t.XMax||t.XMax<i.Price)&&(t.XMax=i.Price),(null==t.Min||t.Min>i.Vol)&&(t.Min=i.Vol),(null==t.Max||t.Max<i.Vol)&&(t.Max=i.Vol)}return t}}function _e(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.Radius=100,this.Distance=30,this.txtLine=20,this.paddingX=20/3,this.Draw=function(){if(!this.Data||!this.Data.Data||!(this.Data.Data.length>0))return this.DrawEmptyData();this.ChartBorder.GetLeft(),this.ChartBorder.GetRight(),this.ChartBorder.GetTop(),this.ChartBorder.GetBottom();var t=this.ChartBorder.GetWidth(),e=this.ChartBorder.GetHeight();if(isNaN(this.Radius)){var a=this.Radius.replace("%","");a/=100,t>=e&&(this.Radius=a*e),t<e&&(this.Radius=a*t)}this.Canvas.save(),this.Canvas.translate(t/2,e/2);var i=0;for(var r in this.Data.Data)i+=this.Data.Data[r].Value;var n=0,s=0;for(var o in this.Data.Data){var h=this.Data.Data[o],l=(h.Value/i).toFixed(2);this.Canvas.beginPath(),this.Canvas.moveTo(0,0),s+=2*l*Math.PI,this.Canvas.strokeStyle="white",this.Canvas.fillStyle=h.Color,this.Canvas.arc(0,0,this.Radius,n,s),this.Canvas.fill(),this.Canvas.closePath(),this.Canvas.stroke(),this.Canvas.beginPath(),this.Canvas.strokeStyle=h.Color,this.Canvas.moveTo(0,0);var u=(this.Radius+this.Distance)*Math.cos(s-(s-n)/2),C=(this.Radius+this.Distance)*Math.sin(s-(s-n)/2);this.Canvas.lineTo(u,C);var D=this.txtLine,f=this.paddingX;if(this.Canvas.textAlign="left",s-(s-n)/2<1.5*Math.PI&&s-(s-n)/2>.5*Math.PI&&(D=-this.txtLine,f=-this.paddingX,this.Canvas.textAlign="right"),this.Canvas.lineTo(u+D,C),this.Canvas.stroke(),h.Text)this.Canvas.fillText(h.Text,u+D+f,C);else{var c=h.Name+":"+h.Value;this.Canvas.fillText(c,u+D+f,C)}n+=2*l*Math.PI}this.Canvas.restore()},this.DrawEmptyData=function(){w.Chart.Log("[ChartPie::DrawEmptyData]")}}function Xe(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.BorderPoint=[],this.DataPoint=[],this.CenterPoint={},this.StartAngle=0,this.Color="rgb(198,198,198)",this.AreaColor="rgba(242,154,118,0.4)",this.AreaLineColor="rgb(242,154,118)",this.TitleFont=24*U()+"px å¾®è½¯éé»",this.TitleColor="rgb(102,102,102)",this.BGColor=["rgb(255,255,255)","rgb(224,224,224)"],this.DrawBorder=function(){if(!(this.BorderPoint.length<=0)){this.Canvas.font=this.TitleFont,this.Canvas.strokeStyle=this.Color;var t=[1,.8,.6,.4,.2];for(var e in t){var a=t[e],i=!0;for(var r in this.BorderPoint){var n=this.BorderPoint[r];n.X=this.CenterPoint.X+n.Radius*Math.cos(n.Angle*Math.PI/180)*a,n.Y=this.CenterPoint.Y+n.Radius*Math.sin(n.Angle*Math.PI/180)*a,i?(this.Canvas.beginPath(),this.Canvas.moveTo(n.X,n.Y),i=!1):this.Canvas.lineTo(n.X,n.Y)}this.Canvas.closePath(),this.Canvas.stroke(),this.Canvas.fillStyle=this.BGColor[e%2==0?0:1],this.Canvas.fill()}for(var s in this.Canvas.beginPath(),this.BorderPoint){n=this.BorderPoint[s];n.X=this.CenterPoint.X+n.Radius*Math.cos(n.Angle*Math.PI/180),n.Y=this.CenterPoint.Y+n.Radius*Math.sin(n.Angle*Math.PI/180),this.Canvas.moveTo(this.CenterPoint.X,this.CenterPoint.Y),this.Canvas.lineTo(n.X,n.Y),this.DrawText(n)}this.Canvas.stroke()}},this.DrawArea=function(){if(this.DataPoint&&!(this.DataPoint.length<=0)){this.Canvas.fillStyle=this.AreaColor,this.Canvas.strokeStyle=this.AreaLineColor,this.Canvas.beginPath();var t=!0;for(var e in this.DataPoint){var a=this.DataPoint[e];t?(this.Canvas.beginPath(),this.Canvas.moveTo(a.X,a.Y),t=!1):this.Canvas.lineTo(a.X,a.Y)}this.Canvas.closePath(),this.Canvas.fill(),this.Canvas.stroke()}},this.DrawText=function(t){if(t.Text){this.Canvas.fillStyle=this.TitleColor;var e=t.X,a=t.Y;t.Angle>0&&t.Angle<45?(this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",e+=2):t.Angle>=0&&t.Angle<90?(this.Canvas.textAlign="left",this.Canvas.textBaseline="top",e+=2):t.Angle>=90&&t.Angle<135||t.Angle>=135&&t.Angle<180?(this.Canvas.textAlign="right",this.Canvas.textBaseline="top",e-=2):t.Angle>=180&&t.Angle<225?(this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",e-=2):t.Angle>=225&&t.Angle<=270?(this.Canvas.textAlign="center",this.Canvas.textBaseline="bottom"):t.Angle>270&&t.Angle<315?(this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",e+=2):(this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",e+=2),this.Canvas.fillText(t.Text,e,a)}},this.Draw=function(){this.BorderPoint=[],this.DataPoint=[],this.CenterPoint={},this.Data&&this.Data.Data&&this.Data.Data.length>0?this.CalculatePoints(this.Data.Data):this.CalculatePoints(null),this.DrawBorder(),this.DrawArea()},this.CalculatePoints=function(t){for(var e=this.ChartBorder.GetLeft(),a=(this.ChartBorder.GetRight(),this.ChartBorder.GetTop()),i=(this.ChartBorder.GetBottom(),this.ChartBorder.GetWidth()),r=this.ChartBorder.GetHeight(),n={X:e+i/2,Y:a+r/2},s=Math.min(i/2,r/2)-2,o=Math.max(5,t?t.length:0),h=360/o,l=0;l<o;++l){var u={Index:l,Radius:s,Angle:l*h+this.StartAngle},C=u.Angle;if(t&&l<t.length){var D=t[l],f={Index:l,Text:D.Text};if(u.Text=D.Name,D.Value){var c=D.Value;c>=1&&(c=1);var d=s*c;f.X=n.X+d*Math.cos(C*Math.PI/180),f.Y=n.Y+d*Math.sin(C*Math.PI/180)}else f.X=n.X,f.Y=n.Y;this.DataPoint.push(f)}this.BorderPoint.push(u)}this.CenterPoint=n},this.DrawEmptyData=function(){w.Chart.Log("[ChartPie::DrawEmptyData]")}}function We(){this.newMethod=Xt,this.newMethod(),delete this.newMethod,this.ImageData=null,this.Left,this.Top,this.Width,this.Height,this.ImageWidth,this.ImageHeight,this.DefaultColor=[217,222,239],this.Color=[{Name:"æµ·å",Color:"rgb(217,222,223)"},{Name:"åèå¤",Color:"rgb(217,222,225)"},{Name:"æ°ç",Color:"rgb(217,222,226)"},{Name:"éæµ·",Color:"rgb(217,222,227)"},{Name:"è¥¿è",Color:"rgb(217,222,228)"},{Name:"äºå",Color:"rgb(217,222,229)"},{Name:"é»é¾æ±",Color:"rgb(217,222,230)"},{Name:"åæ",Color:"rgb(217,222,231)"},{Name:"è¾½å®",Color:"rgb(217,222,232)"},{Name:"æ²³å",Color:"rgb(217,222,233)"},{Name:"å±±ä¸",Color:"rgb(217,222,234)"},{Name:"æ±è",Color:"rgb(217,222,235)"},{Name:"æµæ±",Color:"rgb(217,222,236)"},{Name:"ç¦å»º",Color:"rgb(217,222,237)"},{Name:"å¹¿ä¸",Color:"rgb(217,222,238)"},{Name:"å¹¿è¥¿",Color:"rgb(217,222,239)"},{Name:"è´µå·",Color:"rgb(217,222,240)"},{Name:"æ¹å",Color:"rgb(217,222,241)"},{Name:"æ±è¥¿",Color:"rgb(217,222,242)"},{Name:"å®å¾½",Color:"rgb(217,222,243)"},{Name:"æ¹å",Color:"rgb(217,222,244)"},{Name:"éåº",Color:"rgb(217,222,245)"},{Name:"åå·",Color:"rgb(217,222,246)"},{Name:"çè",Color:"rgb(217,222,247)"},{Name:"éè¥¿",Color:"rgb(217,222,248)"},{Name:"å±±è¥¿",Color:"rgb(217,222,249)"},{Name:"æ²³å",Color:"rgb(217,222,250)"}],this.Draw=function(){var t=this.ChartBorder.GetLeft()+1,e=(this.ChartBorder.GetRight(),this.ChartBorder.GetTop()+1),a=(this.ChartBorder.GetBottom(),this.ChartBorder.GetWidth()-2),i=this.ChartBorder.GetHeight()-2,r=CHINA_MAP_IMAGE.width,n=CHINA_MAP_IMAGE.height,s=r,o=n;if(i<o||a<s)this.ImageData=null;else if(this.Left==t&&this.Top==e&&this.Width==a&&this.Height==i&&this.ImageWidth==r&&this.ImageHeight==n||(this.ImageData=null,this.ImageWidth=r,this.ImageHeight=n,this.Left=t,this.Top=e,this.Width=a,this.Height=i,w.Chart.Log(r,n)),null==this.ImageData){this.Canvas.drawImage(CHINA_MAP_IMAGE,0,0,r,n,t,e,s,o),this.ImageData=this.Canvas.getImageData(t,e,s,o);var h,l=new I.default,u=new E.default,C=new E.default;if(this.Data.length>0)for(var D in this.Data){var f=this.Data[D];C.set(f.Name,f.Color)}for(var c in w.Chart.Log(this.Data),this.Color){var d=this.Color[c];C.has(d.Name)?u.set(d.Color,C.get(d.Name)):l.add(d.Color)}for(var m=0;m<this.ImageData.data.length;m+=4)if(h="rgb("+this.ImageData.data[m]+","+this.ImageData.data[m+1]+","+this.ImageData.data[m+2]+")",l.has(h))this.ImageData.data[m]=this.DefaultColor[0],this.ImageData.data[m+1]=this.DefaultColor[1],this.ImageData.data[m+2]=this.DefaultColor[2];else if(u.has(h)){var v=u.get(h);this.ImageData.data[m]=v[0],this.ImageData.data[m+1]=v[1],this.ImageData.data[m+2]=v[2]}this.Canvas.clearRect(t,e,s,o),this.Canvas.putImageData(this.ImageData,t,e,0,0,s,o)}else this.Canvas.putImageData(this.ImageData,t,e,0,0,s,o)}}function Ue(){this.DataMap=new E.default([["FrameSplitPaint",{Create:function(){return new $e}}],["RectSelectPaint",{Create:function(){return new ta}}],["DragMovePaint",{Create:function(){return new na}}]]),this.Create=function(t){if(!this.DataMap.has(t))return null;var e=this.DataMap.get(t);return e.Create()},this.Add=function(t,e){this.DataMap.set(t,{Create:e.Create})}}var Ke=new Ue;function Je(){this.Canvas,this.ChartBorder,this.ChartFrame,this.Name,this.Data,this.IsDynamic=!1,this.IsAnimation=!1,this.ClassName="IExtendChartPainting",this.SizeChange=!0,this.IsEraseBG=!1,this.DrawAfterTitle=!1,this.IsCallbackDraw=!1,this.Left=5,this.Right=5,this.Top=5,this.Bottom=5,this.Draw=function(){},this.SetOption=function(t){},this.GetFontHeight=function(t){return K(this.Canvas,t,"æ")}}function ze(){this.newMethod=Je,this.newMethod(),delete this.newMethod,this.IsDynamic=!0,this.IsEraseBG=!0,this.DrawAfterTitle=!0,this.ClassName="KLineTooltipPaint",this.BorderColor=Oi.TooltipPaint.BorderColor,this.BGColor=Oi.TooltipPaint.BGColor,this.TitleColor=Oi.TooltipPaint.TitleColor,this.DateTimeColor=Oi.TooltipPaint.DateTimeColor,this.VolColor=Oi.TooltipPaint.VolColor,this.AmountColor=Oi.TooltipPaint.AmountColor,this.LatestPoint,this.ShowPosition=0,this.Left=1*U(),this.Top=5*U(),this.Width=50,this.Height=100,this.LineHeight=15*U(),this.Font=[Oi.TooltipPaint.TitleFont],this.HQChart,this.KLineTitlePaint,this.IsHScreen=!1,this.LanguageID=Ri.LANGUAGE_CHINESE_ID,this.ReloadResource=function(t){this.BorderColor=Oi.TooltipPaint.BorderColor,this.BGColor=Oi.TooltipPaint.BGColor,this.TitleColor=Oi.TooltipPaint.TitleColor,this.DateTimeColor=Oi.TooltipPaint.DateTimeColor,this.VolColor=Oi.TooltipPaint.VolColor,this.AmountColor=Oi.TooltipPaint.AmountColor},this.GetLeft=function(){return this.IsHScreen?this.ChartBorder.GetRightEx()-this.Height-this.Top:0==this.ShowPosition?this.ChartBorder.GetLeft()+this.Left:this.ChartBorder.GetRight()-this.Width-this.Left},this.GetTop=function(){return this.IsHScreen?0==this.ShowPosition?this.ChartBorder.GetTop()+this.Left:this.ChartBorder.GetBottom()-this.Width-this.Left:this.ChartBorder.GetTopEx()+this.Top},this.IsEnableDraw=function(){if(!this.HQChart||!this.HQChart.TitlePaint||!this.HQChart.TitlePaint[0])return!1;if(this.HQChart.DragMode==Y.CLICK_TOUCH_MODE_ID){if(0==this.HQChart.TouchStatus.CorssCursorShow)return!1}else if(!this.HQChart.IsOnTouch)return!1;return!this.HQChart.CurrentChartDrawPicture},this.Draw=function(){if(this.IsEnableDraw()){this.KLineTitlePaint=this.HQChart.TitlePaint[0];var t=this.KLineTitlePaint.GetCurrentKLineData();if(t){var e,a=8;this.HQChart.Symbol&&(e=this.HQChart.Symbol.toUpperCase()),"MinuteTooltipPaint"===this.ClassName?(a=7,Br.IsFutures(e)&&++a):(ha.IsNumber(t.Time)&&++a,Br.IsSHSZStockA(this.HQChart.Symbol)&&t.FlowCapital>0&&++a,Br.IsFutures(e)&&ha.IsNumber(t.Position)&&++a),this.IsHScreen=!0===this.ChartFrame.IsHScreen,this.Canvas.font=this.Font[0];var i=rn(this.HQChart.Symbol),r=" æ: 9999.99äº¿ ";i>=5&&(r=" æ: "+99.99.toFixed(i)+" "),this.Width=this.Canvas.measureText(r).width;var n=this.GetFontHeight();if(n>this.LineHeight&&(this.LineHeight=n),this.Height=this.LineHeight*a+2*U()*2,t&&t.High>0){r=" æ: "+t.High.toFixed(i)+" ";var s=this.Canvas.measureText(r).width;s>this.Width&&(this.Width=s)}this.CalculateShowPosition(),this.DrawBG(),this.DrawTooltipData(t),this.DrawBorder()}}},this.CalculateShowPosition=function(){if(this.ShowPosition=0,this.LatestPoint)if(this.IsHScreen){var t=this.ChartBorder.GetTop(),e=this.ChartBorder.GetHeight(),a=t+e/2;this.LatestPoint.Y<a&&(this.ShowPosition=1)}else{var i=this.ChartBorder.GetLeft(),r=this.ChartBorder.GetWidth(),n=i+r/2;this.LatestPoint.X<n&&(this.ShowPosition=1)}},this.DrawTooltipData=function(t){this.HQChart.Symbol&&(D=this.HQChart.Symbol.toUpperCase());var e=rn(this.HQChart.Symbol),a=this.GetLeft()+2*U(),i=this.GetTop()+3*U();if(this.IsHScreen){this.Canvas.save();var r=this.GetLeft()+this.Height,n=this.GetTop();this.Canvas.translate(r,n),this.Canvas.rotate(90*Math.PI/180),a=2*U(),i=3*U()}this.Canvas.textBaseline="top",this.Canvas.textAlign="left",this.Canvas.font=this.Font[0];var s=this.Canvas.measureText("æ: ").width,o=ha.FormatDateString(t.Date);this.Canvas.fillStyle=this.DateTimeColor,this.Canvas.fillText(o,a,i);var h=this.HQChart.Period;Ot.IsMinutePeriod(h,!0)&&ha.IsNumber(t.Time)?(i+=this.LineHeight,o=ha.FormatTimeString(t.Time),this.Canvas.fillText(o,a,i)):Ot.IsSecondPeriod(h)&&ha.IsNumber(t.Time)&&(i+=this.LineHeight,o=ha.FormatTimeString(t.Time,"HH:MM:SS"),this.Canvas.fillText(o,a,i)),i+=this.LineHeight,this.Canvas.fillStyle=this.TitleColor,o=bi.GetText("Tooltip-Open",this.LanguageID),this.Canvas.fillText(o,a,i);var l=this.KLineTitlePaint.GetColor(t.Open,t.YClose);o=t.Open.toFixed(e),this.Canvas.fillStyle=l,this.Canvas.fillText(o,a+s,i),i+=this.LineHeight,this.Canvas.fillStyle=this.TitleColor,o=bi.GetText("Tooltip-High",this.LanguageID),this.Canvas.fillText(o,a,i);l=this.KLineTitlePaint.GetColor(t.High,t.YClose),o=t.High.toFixed(e);this.Canvas.fillStyle=l,this.Canvas.fillText(o,a+s,i),i+=this.LineHeight,this.Canvas.fillStyle=this.TitleColor,o=bi.GetText("Tooltip-Low",this.LanguageID),this.Canvas.fillText(o,a,i);l=this.KLineTitlePaint.GetColor(t.Low,t.YClose),o=t.Low.toFixed(e);this.Canvas.fillStyle=l,this.Canvas.fillText(o,a+s,i),i+=this.LineHeight,this.Canvas.fillStyle=this.TitleColor,o=bi.GetText("Tooltip-Close",this.LanguageID),this.Canvas.fillText(o,a,i);l=this.KLineTitlePaint.GetColor(t.Close,t.YClose),o=t.Close.toFixed(e);if(this.Canvas.fillStyle=l,this.Canvas.fillText(o,a+s,i),i+=this.LineHeight,this.Canvas.fillStyle=this.TitleColor,o=bi.GetText("Tooltip-Increase",this.LanguageID),this.Canvas.fillText(o,a,i),t.YFClose>0&&Br.IsChinaFutures(D)){var u=(t.Close-t.YFClose)/t.YFClose*100;l=this.KLineTitlePaint.GetColor(u,0),o=u.toFixed(2)+"%"}else if(t.YClose>0)u=(t.Close-t.YClose)/t.YClose*100,l=this.KLineTitlePaint.GetColor(u,0),o=u.toFixed(2)+"%";else o="--.--",l=this.KLineTitlePaint.GetColor(0,0);this.Canvas.fillStyle=l,this.Canvas.fillText(o,a+s,i),i+=this.LineHeight,o=bi.GetText("Tooltip-Vol",this.LanguageID),this.Canvas.fillStyle=this.TitleColor,this.Canvas.fillText(o,a,i);var C=t.Vol;D&&Br.IsSHSZ(D)&&(C/=100);o=ha.FromatIntegerString(C,2,this.LanguageID);if(this.Canvas.fillStyle=this.VolColor,this.Canvas.fillText(o,a+s,i),ha.IsNumber(t.Amount)){i+=this.LineHeight,o=bi.GetText("Tooltip-Amount",this.LanguageID),this.Canvas.fillStyle=this.TitleColor,this.Canvas.fillText(o,a,i);o=ha.FormatValueString(t.Amount,2,this.LanguageID);this.Canvas.fillStyle=this.AmountColor,this.Canvas.fillText(o,a+s,i)}if(Br.IsSHSZStockA(this.HQChart.Symbol)&&t.FlowCapital>0){i+=this.LineHeight,o=bi.GetText("Tooltip-Exchange",this.LanguageID),this.Canvas.fillStyle=this.TitleColor,this.Canvas.fillText(o,a,i);u=t.Vol/t.FlowCapital*100,o=u.toFixed(2)+"%";this.Canvas.fillText(o,a+s,i)}var D=this.HQChart.Symbol.toUpperCase();if(Br.IsFutures(D)&&ha.IsNumber(t.Position)){this.Canvas.fillStyle=this.TitleColor,i+=this.LineHeight,o=bi.GetText("Tooltip-Position",this.LanguageID),this.Canvas.fillText(o,a,i);o=ha.FromatIntegerString(t.Position,2,this.LanguageID);this.Canvas.fillText(o,a+s,i)}this.IsHScreen&&this.Canvas.restore()},this.DrawBorder=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.GetLeft(),a=this.GetTop();this.Canvas.strokeStyle=this.BorderColor,t?this.Canvas.strokeRect(Q(e),Q(a),this.Height,this.Width):this.Canvas.strokeRect(Q(e),Q(a),tt(this.Width),tt(this.Height))},this.DrawBG=function(){var t=!0===this.ChartFrame.IsHScreen,e=this.GetLeft(),a=this.GetTop();this.Canvas.fillStyle=this.BGColor,t?this.Canvas.fillRect(e,a,this.Height,this.Width):this.Canvas.fillRect(e,a,this.Width,this.Height)},this.SetOption=function(t){t.LineHeight>0&&(this.LineHeight=t.LineHeight*U()),t.BGColor&&(this.BGColor=t.BGColor),t.LanguageID>0&&(this.LanguageID=t.LanguageID)}}function qe(){this.newMethod=ze,this.newMethod(),delete this.newMethod,this.ClassName="MinuteTooltipPaint",this.Left=1*U(),this.Top=1*U(),this.YClose,this.IsShowAveragePrice=!0,this.GetTop=function(){if(this.IsHScreen){var t=this.ChartBorder.GetHScreenBorder();return 0==this.ShowPosition?t.TopEx+this.Left:t.BottomEx-this.Width-this.Left}t=this.ChartBorder.GetBorder();return t.Top+this.Top},this.GetLeft=function(){if(this.IsHScreen){var t=this.ChartBorder.GetHScreenBorder();return t.Right-this.Height-this.Top}t=this.ChartBorder.GetBorder();return 0==this.ShowPosition?t.LeftEx+this.Left:t.RightEx-this.Width-this.Left},this.DrawTooltipData=function(t){if(this.HQChart.Symbol){var e=rn(this.HQChart.Symbol),a=this.GetLeft()+2*U(),i=this.GetTop()+3*U();this.YClose=this.KLineTitlePaint.YClose;var r=this.HQChart.Symbol.toUpperCase();if(this.IsHScreen){this.Canvas.save();var n=this.GetLeft()+this.Height,s=this.GetTop();this.Canvas.translate(n,s),this.Canvas.rotate(90*Math.PI/180),a=2*U(),i=3*U()}this.Canvas.textBaseline="top",this.Canvas.textAlign="left",this.Canvas.font=this.Font[0];var o=this.Canvas.measureText("æ: ").width,h=t.DateTime.split(" ");if(h&&2==h.length){var l=ha.FormatDateString(h[0]);this.Canvas.fillStyle=this.TitleColor,this.Canvas.fillText(l,a,i),i+=this.LineHeight,l=ha.FormatTimeString(h[1]),this.Canvas.fillText(l,a,i)}var u=t.Close,C=(t.Increase,t.Vol),D=t.Amount;t.Before&&(u=t.Before.Close,t.Before.Increase,C=t.Before.Vol,D=t.Before.Amount),i+=this.LineHeight,this.Canvas.fillStyle=this.TitleColor,l=bi.GetText("Tooltip-Price",this.LanguageID),this.Canvas.fillText(l,a,i);var f=this.KLineTitlePaint.GetColor(u,this.YClose);l=u.toFixed(e);this.Canvas.fillStyle=f,this.Canvas.fillText(l,a+o,i);var c=!0;if((t.Before||Br.IsForeignExchange(r)||Br.IsET(r)&&!Br.IsETShowAvPrice(r)||Br.IsShowAvPrice&&!Br.IsShowAvPrice(r))&&(c=!1),c&&ha.IsNumber(t.AvPrice)&&this.IsShowAveragePrice){i+=this.LineHeight,this.Canvas.fillStyle=this.TitleColor,l=bi.GetText("Tooltip-AvPrice",this.LanguageID),this.Canvas.fillText(l,a,i);f=this.KLineTitlePaint.GetColor(t.AvPrice,this.YClose),l=t.AvPrice.toFixed(e);this.Canvas.fillStyle=f,this.Canvas.fillText(l,a+o,i)}i+=this.LineHeight,this.Canvas.fillStyle=this.TitleColor,l=bi.GetText("Tooltip-Increase",this.LanguageID),this.Canvas.fillText(l,a,i);var d=(u-this.YClose)/this.YClose*100;f=this.KLineTitlePaint.GetColor(d,0),l=d.toFixed(2)+"%";if(this.Canvas.fillStyle=f,this.Canvas.fillText(l,a+o,i),ha.IsNumber(C)){this.Canvas.fillStyle=this.TitleColor,i+=this.LineHeight,l=bi.GetText("Tooltip-Vol",this.LanguageID),this.Canvas.fillText(l,a,i);l=ha.FromatIntegerString(C,2,this.LanguageID);this.Canvas.fillText(l,a+o,i)}if(ha.IsNumber(D)){i+=this.LineHeight,l=bi.GetText("Tooltip-Amount",this.LanguageID),this.Canvas.fillText(l,a,i);l=ha.FormatValueString(D,2,this.LanguageID);this.Canvas.fillText(l,a+o,i)}if(ha.IsNumber(t.Position)){i+=this.LineHeight,l=bi.GetText("Tooltip-Position",this.LanguageID),this.Canvas.fillText(l,a,i);l=ha.FormatValueString(t.Position,2,this.LanguageID);this.Canvas.fillText(l,a+o,i)}this.IsHScreen&&this.Canvas.restore()}}}function Ze(){this.newMethod=Je,this.newMethod(),delete this.newMethod,this.Left=80,this.Right=1,this.Top=1,this.Bottom=1,this.BorderColor=Oi.FrameBorderPen,this.Symbol,this.Name,this.TitleFont=["14px å¾®è½¯éé»"],this.Draw=function(){var t=this.ChartBorder.GetRight()+this.Left,e=this.ChartBorder.GetChartWidth()-this.Right,a=this.Top+18,i=t+(e-t)/2;this.Symbol&&this.Name&&(this.Canvas.font=this.TitleFont[0],this.Canvas.textAlign="right",this.Canvas.textBaseline="bottom",this.Canvas.fillText(this.Symbol,i-2,a),this.Canvas.textAlign="left",this.Canvas.fillText(this.Name,i+2,a)),this.Canvas.strokeStyle=this.BorderColor,this.Canvas.moveTo(t,a),this.Canvas.lineTo(e,a),this.Canvas.stroke(),a+=30,this.DrawBorder()},this.DrawBorder=function(){var t=this.ChartBorder.GetRight()+this.Left,e=this.ChartBorder.GetChartWidth()-this.Right,a=this.Top,i=this.ChartBorder.GetChartHeight()-this.Bottom;this.Canvas.strokeStyle=this.BorderColor,this.Canvas.strokeRect(t,a,e-t,i-a)}}function Qe(){this.newMethod=Je,this.newMethod(),delete this.newMethod,this.Name="ç­¹ç åå¸",this.ClassName="StockChip",this.HQChart,this.PenBorder=Oi.FrameBorderPen,this.ColorProfit="rgb(255,0,0)",this.ColorNoProfit="rgb(90,141,248)",this.ColorAveragePrice="rgb(0,139,0)",this.ColorBG="rgb(190,190,190)",this.PixelRatio=U(),this.ShowType=0,this.IsDynamic=!0,this.ClientRect={},this.Font=Oi.TitleFont,this.InfoColor=Oi.StockChip.InfoColor,this.DayInfoColor=Oi.StockChip.DayInfoColor,this.LineHeight=16,this.Left=50*this.PixelRatio,this.IsShowX=!1,this.ShowXCount=3,this.Width=150*this.PixelRatio,this.CalculateType=0,this.PriceZoom=100,this.NotSupportMessage="ä¸æ¯æç­¹ç å¾",this.Buttons=[],this.DefaultButton=et(Oi.StockChip.DefaultButton),this.LongButton=et(Oi.StockChip.LongButton),this.RecentButton=et(Oi.StockChip.RecentButton),this.DAY_COLOR=[["rgb(255,0,0)","rgb(255,128,128)","rgb(255,0,128)","rgb(255,100,0)","rgb(192,128,0)","rgb(255,192,0)"],["rgb(120,80,225)","rgb(160,160,225)","rgb(80,80,255)","rgb(120,120,255)","rgb(32,64,192)","rgb(0,64,128)"]],this.SetOption=function(t){t&&(t.ShowType>0&&(this.ShowType=t.ShowType),t.IsShowX&&(this.IsShowX=t.IsShowX),t.ShowXCount>0&&(this.ShowXCount=t.ShowXCount),t.Width>100&&(this.Width=t.Width*U()),t.CalculateType>0&&(this.CalculateType=t.CalculateType),ha.IsNumber(t.PriceZoom)&&(this.PriceZoom=t.PriceZoom))},this.ReloadResource=function(t){this.PenBorder=Oi.FrameBorderPen,this.Font=Oi.TitleFont,this.InfoColor=Oi.StockChip.InfoColor,this.DayInfoColor=Oi.StockChip.DayInfoColor,this.DefaultButton=et(Oi.StockChip.DefaultButton),this.LongButton=et(Oi.StockChip.LongButton),this.RecentButton=et(Oi.StockChip.RecentButton)},this.Draw=function(){this.PixelRatio=U();var t=Q(this.ChartBorder.GetRight()+this.Left),e=Q(this.ChartBorder.GetTop()),a=Q(t+this.Width-1*this.PixelRatio),i=Q(this.ChartBorder.GetBottom()),r=a-t,n=i-e;if(this.ClientRect={Left:t,Top:e,Width:r,Height:n},Ot.IsTickPeriod(this.HQChart.Period)){this.Canvas.font=this.Font,this.Canvas.fillStyle=this.InfoColor;var s=t+r/2,o=e+n/2;return this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillText(this.NotSupportMessage,s,o),void this.DrawBorder()}this.CalculateChip()?(this.DrawFrame(),this.DrawAllChip(),1!=this.ShowType&&2!=this.ShowType||this.DrawDayChip(),this.CalculateCast(),this.DrawChipInfo()):w.Chart.Log("[StockChip::Draw] no data"),this.DrawBorder(),this.SizeChange=!1},this.DrawChipInfo=function(){var t=this.ClientRect.Top+this.ClientRect.Height-1,e=this.ClientRect.Left+2,a=this.ClientRect.Left+this.ClientRect.Width;this.Canvas.font=this.Font,this.Canvas.fillStyle=this.InfoColor,this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left";var i=this.LineHeight*U(),r="70%ææ¬ä»· --.--";ha.IsNonEmptyArray(this.Data.Cast)&&(r="70%ææ¬ä»·"+this.Data.Cast[1].MinPrice.toFixed(2)+"-"+this.Data.Cast[1].MaxPrice.toFixed(2)+"éä¸­"+this.Data.Cast[1].Rate.toFixed(2)+"%"),this.Canvas.fillText(r,e,t),t-=i,r="90%ææ¬ä»· --.--",ha.IsNonEmptyArray(this.Data.Cast)&&(r="90%ææ¬ä»·"+this.Data.Cast[0].MinPrice.toFixed(2)+"-"+this.Data.Cast[0].MaxPrice.toFixed(2)+"éä¸­"+this.Data.Cast[0].Rate.toFixed(2)+"%"),this.Canvas.fillText(r,e,t),t-=i,r="å¹³åææ¬ï¼"+this.Data.ChipInfo.AveragePrice.toFixed(2)+"å",this.Canvas.fillText(r,e,t),t-=i,r=+this.Data.YPrice.toFixed(2)+"å¤è·å©çï¼"+this.Data.ChipInfo.YProfitRate.toFixed(2)+"%",this.Canvas.fillText(r,e,t),t-=i,r="è·å©æ¯ä¾ï¼",this.Canvas.fillText(r,e,t);var n=this.Canvas.measureText(r).width+2,s=e+n,o=a-5-s;if(this.Canvas.strokeStyle=this.ColorNoProfit,this.Canvas.strokeRect(s,t-i,o,i),this.Canvas.strokeStyle=this.ColorProfit,this.Canvas.strokeRect(s,t-i,o*(this.Data.ChipInfo.ProfitRate/100),i),r=this.Data.ChipInfo.ProfitRate.toFixed(2)+"%",this.Canvas.textAlign="center",this.Canvas.fillText(r,s+o/2,t),t-=i,this.Canvas.textAlign="left",r="ææ¬åå¸,æ¥æï¼"+ha.FormatDateString(this.Data.SelectData.Date),this.Data.SelectData.Time&&(r+=" "+ha.FormatTimeString(this.Data.SelectData.Time)),this.Canvas.fillText(r,e,t),t-=i,1==this.ShowType||2==this.ShowType){a=this.ClientRect.Left+this.ClientRect.Width-1;this.Canvas.textAlign="right";n=50;for(var h in this.Data.DayChip.sort((function(t,e){return e.Day-t.Day})),this.Data.DayChip){var l=this.Data.DayChip[h],u=0;this.Data.ChipInfo&&this.Data.ChipInfo.Vol>0&&(u=l.Vol/this.Data.ChipInfo.Vol*100),r=l.Day+"å¨æ"+(1==this.ShowType?"å":"å")+"ææ¬"+(ha.IsNumber(u)?u.toFixed(2)+"%":"--.--%"),0==h&&(n=this.Canvas.measureText(r).width+8),this.Canvas.fillStyle=l.Color,this.Canvas.fillRect(a-n,t-i,n,i),this.Canvas.fillStyle=this.DayInfoColor,this.Canvas.fillText(r,a,t),t-=i}}},this.DrawDayChip=function(){var t=this.HQChart.Frame.SubFrame[0].Frame;for(var e in this.Data.DayChip){var a=[],i=this.Data.DayChip[e].Chip;if(i){for(var r=0,n=0;n<i.length;++n){var s=i[n];if(s){r+=s;var o=(n+this.Data.MinPrice)/100,h=t.GetYFromData(o),l=s/this.Data.MaxVol*this.ClientRect.Width+this.ClientRect.Left;a.push({X:l,Y:h})}}this.Data.DayChip[e].Vol=r,this.DrawArea(a,this.Data.DayChip[e].Color)}}},this.DrawToolbar=function(t){this.Buttons=[];this.ClientRect.Left;for(var e=this.ClientRect.Left+this.ClientRect.Width,a=this.ClientRect.Top+this.ChartBorder.TitleHeight/2,i=[{ID:k.CHIP_RECENT,Style:this.RecentButton,ShowType:2},{ID:k.CHIP_LONG,Style:this.LongButton,ShowType:1},{ID:k.CHIP_DEFULT,Style:this.DefaultButton,ShowType:0}],r=0;r<i.length;++r){var n=i[r],s=n.Style.Size,o=e-s-n.Style.MerginLeft,h=s+"px "+n.Style.Family,l={Left:o,Top:a-s/2,Right:o+s+n.Style.MerginLeft,Bottom:a+s/2,Width:s+n.Style.MerginLeft,Height:s},u=n.Style.Color;this.ShowType==n.ShowType?u=n.Style.SelectedColor:t&&t.X>=l.Left&&t.X<l.Right&&t.Y>=l.Top&&t.Y<=l.Bottom&&(u=n.Style.MoveOnColor),this.Canvas.fillStyle=u,this.Canvas.font=h,this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillText(n.Style.Text,o,a),this.Buttons.push({ID:n.ID,Rect:l}),e=o}},this.PtInButtons=function(t,e){for(var a=0;a<this.Buttons.length;++a){var i=this.Buttons[a];if(i.Rect){var r=i.Rect;if(this.Canvas.beginPath(),this.Canvas.rect(r.Left,r.Top,r.Width,r.Height),this.Canvas.isPointInPath(t,e))return{ID:i.ID,Rect:r}}}return null},this.DrawAllChip=function(){for(var t=this.HQChart.Frame.SubFrame[0].Frame,e=this.Data.SelectData.Close,a=[],i=[],r=0,n=0,s=0,o=0,h=this.Data.YPrice,l=t.HorizontalMax,u=t.HorizontalMin,C=1,D=0;D<this.Data.AllChip.length;++D){var f=this.Data.AllChip[D];if(f){var c=(D+this.Data.MinPrice)/this.PriceZoom;r+=f,n+=c*f,c<h&&(o+=f),c<e&&(s+=f),c<=l&&c>=u&&C<f&&(C=f)}}this.Data.MaxVol=C;for(D=0;D<this.Data.AllChip.length;++D){f=this.Data.AllChip[D];if(f){c=(D+this.Data.MinPrice)/this.PriceZoom;if(!(c>l||c<u)){var d=t.GetYFromData(c),m=f/this.Data.MaxVol*this.ClientRect.Width+this.ClientRect.Left;c<e?a.push({X:m,Y:d}):i.push({X:m,Y:d})}}}if(this.Data.ChipInfo={Vol:r,AveragePrice:n/r,ProfitVol:s,ProfitRate:r>0?s/r*100:0,YProfitRate:r>0?o/r*100:0},0==this.ShowType){this.DrawLines(a,this.ColorProfit),this.DrawLines(i,this.ColorNoProfit);var v=this.Data.ChipInfo.AveragePrice;v>0&&v<=l&&v>=u&&(v=v.toFixed(2),this.DrawAveragePriceLine(a,i,t.GetYFromData(v),this.ColorAveragePrice))}else this.DrawLines(a,this.ColorBG),this.DrawLines(i,this.ColorBG)},this.CalculateCast=function(){if(this.Data.ChipInfo&&this.Data.ChipInfo.Vol){for(var t=[{Start:.05,End:.95,MaxPrice:0,MinPrice:0,Rate:0},{Start:.15,End:.85,MaxPrice:0,MinPrice:0,Rate:0}],e=(this.Data.ChipInfo.AveragePrice,this.Data.ChipInfo.ProfitVol),a=0,i=0,r=0;i<this.Data.AllChip.length;++i){if(4==r)break;var n=this.Data.AllChip[i];if(!(n<=0)){var s=(i+this.Data.MinPrice)/this.PriceZoom;a+=n;var o=a/e;for(var h in t){var l=t[h];l.MinPrice<=0&&o>l.Start&&(l.MinPrice=s,++r),l.MaxPrice<=0&&o>l.End&&(l.MaxPrice=s,++r)}}}for(var i in t){var u=t[i],C=u.MaxPrice+u.MinPrice;C&&(u.Rate=Math.abs(u.MaxPrice-u.MinPrice)/C*100)}this.Data.Cast=t}},this.DrawArea=function(t,e){if(!(t.length<=0)){for(var a in this.Canvas.fillStyle=e,this.Canvas.beginPath(),this.Canvas.moveTo(this.ClientRect.Left,t[0].Y),t){var i=t[a];this.Canvas.lineTo(i.X,i.Y)}this.Canvas.lineTo(this.ClientRect.Left,t[t.length-1].Y),this.Canvas.fill()}},this.DrawLines=function(t,e){if(!(t.length<=0)){for(var a in this.Canvas.strokeStyle=e,this.Canvas.beginPath(),t){var i=t[a];this.Canvas.moveTo(this.ClientRect.Left,i.Y),this.Canvas.lineTo(i.X,i.Y)}this.Canvas.stroke()}},this.DrawAveragePriceLine=function(t,e,a,i){for(var r in t){var n=t[r];if(n.Y==a)return this.Canvas.strokeStyle=i,this.Canvas.beginPath(),this.Canvas.moveTo(this.ClientRect.Left,n.Y),this.Canvas.lineTo(n.X,n.Y),void this.Canvas.stroke()}for(var r in e){n=e[r];if(n.Y==a)return this.Canvas.strokeStyle=i,this.Canvas.beginPath(),this.Canvas.moveTo(this.ClientRect.Left,n.Y),this.Canvas.lineTo(n.X,n.Y),void this.Canvas.stroke()}},this.DrawBorder=function(){this.Canvas.strokeStyle=this.PenBorder,this.Canvas.strokeRect(this.ClientRect.Left,this.ClientRect.Top,this.ClientRect.Width,this.ClientRect.Height)},this.EvenlyDistribute=function(t,e){var a=e.Low,i=e.High,r=e.MaxPrice,n=e.MinPrice,s=1;if(i-a!=0){for(var o=e.Vol/(i-a),h=a;h<=i&&h<=r;++h){var l=h-n;t[l]+=o,s<t[l]&&(s=t[l])}e.MaxVol=s}},this.TriangleDistribute=function(t,e){for(var a=e.Low,i=e.High,r=(e.MaxPrice,e.MinPrice),n=1,s=45,o=3.1415926535,h=(i-a)/2+a,l=0,u=[],C=a+1,D=1;C<=h;++C,++D){var f=Math.tan(s*o/180)*D;l+=f,u.push({Index:C-r,Value:f})}for(C=i-1,D=1;C>h;--C,++D){f=Math.tan(s*o/180)*D;l+=f,u.push({Index:C-r,Value:f})}if(l>0){for(C=0;C<u.length;++C){var c=u[C];t[c.Index]+=c.Value*e.Vol/l,n<t[c.Index]&&(n=t[c.Index])}e.MaxVol=n}},this.CalculateDistribute=function(t,e){1==this.CalculateType?this.TriangleDistribute(t,e):this.EvenlyDistribute(t,e)},this.CalculateChip=function(){if(!this.HQChart)return!1;if(!this.HQChart.FlowCapitalReady)return!1;var t=this.HQChart.Symbol;if(!t)return!1;if(Br.IsSHSZIndex(t))return!1;var e=this.HQChart.ChartPaint[0].Data,a=e.DataOffset+parseInt(this.HQChart.CursorIndex);a>=e.Data.length&&(a=e.Data.length-1);var i=e.Data[a],r=i.Close,n=this.HQChart.LastPoint.Y;n&&(r=this.HQChart.Frame.SubFrame[0].Frame.GetYData(n));for(var s,o,h,l=1,u=[],C=1,D=a;D>=0;--D){var f=e.Data[D],c=1;f.FlowCapital>0&&(c=f.Vol/f.FlowCapital),s=D==a?f.Vol*c:f.Vol*C;var d={Vol:s,High:f.High,Low:f.Low};u.push(d),C*=1-c*l,(!o||o<f.High)&&(o=f.High),(!h||h>f.Low)&&(h=f.Low)}if(!o||!h)return!0;var m=this.PriceZoom;o=parseInt(o*m),h=parseInt(h*m);for(var v=o-h,S=new Array,I=0;I<=v;++I)S.push(0);var p,T=[];if(2==this.ShowType){T=[{Day:100,Color:this.DAY_COLOR[1][5]},{Day:60,Color:this.DAY_COLOR[1][4]},{Day:30,Color:this.DAY_COLOR[1][3]},{Day:20,Color:this.DAY_COLOR[1][2]},{Day:10,Color:this.DAY_COLOR[1][1]},{Day:5,Color:this.DAY_COLOR[1][0]}];for(var g in u){f=u[g];var x=parseInt(f.High*m),F=parseInt(f.Low*m),y=f.Vol;if(x-F>0&&(y=f.Vol/(x-F)),!(y<=1e-9)){for(var L=0;L<T.length;++L)if(g==T[L].Day){T[L].Chip=S.slice(0);break}p={Low:F,High:x,Vol:f.Vol,MaxPrice:o,MinPrice:h},this.CalculateDistribute(S,p)}}}else if(1==this.ShowType){T=[{Day:5,Color:this.DAY_COLOR[0][0]},{Day:10,Color:this.DAY_COLOR[0][1]},{Day:20,Color:this.DAY_COLOR[0][2]},{Day:30,Color:this.DAY_COLOR[0][3]},{Day:60,Color:this.DAY_COLOR[0][4]},{Day:100,Color:this.DAY_COLOR[0][5]}];for(var E=u.length-1;E>=0;--E){f=u[E],x=parseInt(f.High*m),F=parseInt(f.Low*m),y=f.Vol;if(x-F>0&&(y=f.Vol/(x-F)),!(y<=1e-9)){for(L=0;L<T.length;++L)if(E==T[L].Day){T[L].Chip=S.slice(0);break}p={Low:F,High:x,Vol:f.Vol,MaxPrice:o,MinPrice:h},this.CalculateDistribute(S,p)}}}else for(var M in u){f=u[M],x=parseInt(f.High*m),F=parseInt(f.Low*m),y=f.Vol;x-F>0&&(y=f.Vol/(x-F)),y<=1e-9||(p={Low:F,High:x,Vol:f.Vol,MaxPrice:o,MinPrice:h},this.CalculateDistribute(S,p))}return!!p&&(this.Data={AllChip:S,MaxVol:p.MaxVol,MaxPrice:o,MinPrice:h,SelectData:i,DayChip:T,YPrice:r},!0)},this.DrawFrame=function(){if(0!=this.IsShowX&&!(this.Data.MaxVol<=0)){var t=1!==this.HQChart.Frame.SubFrame.length,e=this.HQChart.Frame.SubFrame[0].Frame,a=e.ChartBorder,i=Q(a.GetBottomEx()+1);t||(i=this.ClientRect.Top+this.ClientRect.Height);var r=this.ClientRect.Left,n=r+this.ClientRect.Width;this.Canvas.strokeStyle=this.PenBorder,this.Canvas.beginPath(),t&&(this.Canvas.moveTo(r,i),this.Canvas.lineTo(n,i));var s=this.ShowXCount,o=this.Data.MaxVol,h=Math.floor(o/s);this.Canvas.font=this.Font,this.Canvas.textBaseline="top",this.Canvas.fillStyle=this.InfoColor;U();for(var l=1;l<=s;++l){var u=h*l,C=u/this.Data.MaxVol*this.ClientRect.Width+this.ClientRect.Left;if(C=Q(C),l==s){this.Canvas.textAlign="right";var D=ha.FormatValueString(o,1);this.Canvas.fillText(D,C,i+2)}else{this.Canvas.moveTo(C,this.ClientRect.Top),this.Canvas.lineTo(C,i),this.Canvas.textAlign="center";D=ha.FormatValueString(u,1);var f=this.Canvas.measureText(D).width;this.Canvas.fillText(D,Math.floor(C-.25*f),i+2)}}this.Canvas.stroke()}}}function je(){this.newMethod=Je,this.newMethod(),delete this.newMethod,this.ClassName="DrawToolsButton",this.HQChart,this.ID=q(),this.ToolsDiv,this.Color="#696969",this.Top=5*U(),this.Width=45*U(),this.SetOption=function(t){var e=U();t&&t.Width>10&&(this.Width=t.Width*e)},this.Clear=function(){this.ToolsDiv&&this.ChartBorder.UIElement.parentNode.removeChild(this.ToolsDiv)},this.Draw=function(){var t=this;if(0!=this.SizeChange){var e=[[{HTML:{Title:"çº¿æ®µ",IClass:"iconfont icon-draw_line",ID:"icon-segment"},Name:"çº¿æ®µ"},{HTML:{Title:"å°ºå­",IClass:"iconfont icon-ruler",ID:"icon_ruler"},Name:"å°ºå­"},{HTML:{Title:"å°çº¿",IClass:"iconfont icon-draw_rays",ID:"icon-beam"},Name:"å°çº¿"},{HTML:{Title:"æ ä»·çº¿",IClass:"iconfont icon-price_line",ID:"icon-price-line"},Name:"æ ä»·çº¿"},{HTML:{Title:"åç´çº¿",IClass:"iconfont icon-vertical_line",ID:"icon-vertical-line"},Name:"åç´çº¿"},{HTML:{Title:"ç®­å¤´",IClass:"iconfont icon-draw_rays",ID:"icon-beam2"},Name:"ç®­å¤´"},{HTML:{Title:"è¶å¿çº¿",IClass:"iconfont icon-draw_trendline",ID:"icon-trendline"},Name:"è¶å¿çº¿"},{HTML:{Title:"æ°´å¹³çº¿",IClass:"iconfont icon-draw_hline",ID:"icon-hline"},Name:"æ°´å¹³çº¿"},{HTML:{Title:"æ°´å¹³çº¿æ®µ",IClass:"iconfont icon-draw_hlinesegment",ID:"icon-hlineseg"},Name:"æ°´å¹³çº¿æ®µ"},{HTML:{Title:"å¹³è¡å°çº¿",IClass:"iconfont icon-draw_p_rays_lines",ID:"icon-rayslineseg"},Name:"å¹³è¡å°çº¿"},{HTML:{Title:"å¹³è¡çº¿",IClass:"iconfont icon-draw_parallel_lines",ID:"icon-parallellines"},Name:"å¹³è¡çº¿"},{HTML:{Title:"å¹³è¡éé",IClass:"iconfont icon-draw_parallelchannel",ID:"icon-parallelchannel"},Name:"å¹³è¡éé"},{HTML:{Title:"ä»·æ ¼ééçº¿",IClass:"iconfont icon-draw_pricechannel",ID:"icon-pricechannel"},Name:"ä»·æ ¼ééçº¿"},{HTML:{Title:"Må¤´Wåº",IClass:"iconfont icon-draw_wavemw",ID:"icon-wavemw"},Name:"Må¤´Wåº"},{HTML:{Title:"å¤´è©å",IClass:"iconfont icon-draw_head_shoulders_bt",ID:"icon-Head-Shoulders"},Name:"å¤´è©å"},{HTML:{Title:"æ³¢æµªå°º",IClass:"iconfont icon-waveruler",ID:"icon-wave-ruler"},Name:"æ³¢æµªå°º"},{HTML:{Title:"ABæ³¢æµªå°º",IClass:"iconfont icon-waveruler",ID:"icon-wave-ruler"},Name:"ABæ³¢æµªå°º"},{HTML:{Title:"ç®±åçº¿",IClass:"iconfont icon-draw_box",ID:"icon-drawbox"},Name:"ç®±åçº¿"},{HTML:{Title:"æ¶é¸¦çº¿æ®µ",IClass:"iconfont icon-draw_line",ID:"icon-segment2"},Name:"æ¶é¸¦çº¿æ®µ"}],[{HTML:{Title:"åå¼§",IClass:"iconfont icon-draw_arc",ID:"icon-arc"},Name:"åå¼§çº¿"},{HTML:{Title:"ç©å½¢",IClass:"iconfont icon-rectangle",ID:"icon-rect"},Name:"ç©å½¢"},{HTML:{Title:"å¹³è¡åè¾¹å½¢",IClass:"iconfont icon-draw_quadrangle",ID:"icon-quad"},Name:"å¹³è¡åè¾¹å½¢"},{HTML:{Title:"ä¸è§å½¢",IClass:"iconfont icon-draw_triangle",ID:"icon-triangle"},Name:"ä¸è§å½¢"},{HTML:{Title:"å",IClass:"iconfont icon-draw_circle",ID:"icon-circle"},Name:"å"},{HTML:{Title:"å¯¹ç§°è§åº¦",IClass:"iconfont icon-draw_symangle",ID:"icon-symangle"},Name:"å¯¹ç§°è§åº¦"}],[{HTML:{Title:"ææ¬",IClass:"iconfont icon-draw_text",ID:"icon-text"},Name:"ææ¬"},{HTML:{Title:"åä¸ç®­å¤´",IClass:"iconfont icon-arrow_up",ID:"icon-arrowup"},Name:"icon-arrow_up"},{HTML:{Title:"åä¸ç®­å¤´",IClass:"iconfont icon-arrow_down",ID:"icon-arrowdown"},Name:"icon-arrow_down"},{HTML:{Title:"åå·¦ç®­å¤´",IClass:"iconfont icon-arrow_left",ID:"icon-arrowleft"},Name:"icon-arrow_left"},{HTML:{Title:"åå³ç®­å¤´",IClass:"iconfont icon-arrow_right",ID:"icon-arrowright"},Name:"icon-arrow_right"}],[{HTML:{Title:"æ±æ©è§åº¦çº¿",IClass:"iconfont icon-draw_gannfan",ID:"icon-gannfan"},Name:"æ±æ©è§åº¦çº¿"},{HTML:{Title:"ææ³¢é£å¥å¨æçº¿",IClass:"iconfont icon-draw_fibonacci",ID:"icon-fibonacci"},Name:"ææ³¢é£å¥å¨æçº¿"},{HTML:{Title:"é»éçº¿",IClass:"iconfont icon-draw_resline",ID:"icon-resline"},Name:"é»éçº¿"},{HTML:{Title:"é»éåå²",IClass:"iconfont icon-draw_goldensection",ID:"icon-goldensection"},Name:"é»éåå²"},{HTML:{Title:"ç¾åæ¯çº¿",IClass:"iconfont icon-draw_percentage",ID:"icon-percentage"},Name:"ç¾åæ¯çº¿"},{HTML:{Title:"æ³¢æ®µçº¿",IClass:"iconfont icon-draw_waveband",ID:"icon-waveband"},Name:"æ³¢æ®µçº¿"},{HTML:{Title:"çº¿å½¢åå½çº¿",IClass:"iconfont icon-linear_3",ID:"icon-waveband2"},Name:"çº¿å½¢åå½çº¿"},{HTML:{Title:"çº¿å½¢åå½å¸¦",IClass:"iconfont icon-linear_1",ID:"icon-waveband3"},Name:"çº¿å½¢åå½å¸¦"},{HTML:{Title:"å»¶é¿çº¿å½¢åå½å¸¦",IClass:"iconfont icon-linear_2",ID:"icon-waveband5"},Name:"å»¶é¿çº¿å½¢åå½å¸¦"}],[{HTML:{Title:"å¨é¨å é¤",IClass:"iconfont icon-recycle_bin",ID:"icon-delete"},Name:"å¨é¨å é¤"}]],a=this.HQChart;if(!this.ToolsDiv){var i=document.createElement("div");i.className="drawtools",i.id=this.ID;var r="",n="",s=new Array;e.forEach((function(t,e){s.push(t[0])}));for(var o=0;o<e.length;o++){for(var h=s[o],l=e[o],u="",C="",D=0;D<l.length;D++){var f=l[D],c=f.Name;c.indexOf("up")>-1?c="åä¸ç®­å¤´":c.indexOf("down")>-1?c="åä¸ç®­å¤´":c.indexOf("left")>-1?c="åå·¦ç®­å¤´":c.indexOf("right")>-1&&(c="åå³ç®­å¤´"),u+='<p class="menuTwoItem '+f.HTML.ID+'">'+c+'<i class="'+f.HTML.IClass+'" title="'+f.HTML.Title+'"></i></p>'}o!==e.length-1?(n='<div class="menuTwo">'+u+"</div>",C='<i class="contentArrow iconfont icon-menu_arraw_left"></i>'):(n="",C="");var d='<div class="icon-image first-'+h.HTML.ID+'"><i class="'+h.HTML.IClass+'" title="'+h.HTML.Title+'"></i>'+n+C+"</div>";r+=d}for(var o in this.ChartBorder.UIElement.parentNode.appendChild(i),i.innerHTML=r,this.ToolsDiv=i,e){var m=e[o][0];if((0,A.default)("#"+this.ID+" .first-"+m.HTML.ID).hover((function(){(0,A.default)(".drawtools").find(".contentArrow").hide(),(0,A.default)(this).find(".contentArrow").removeClass("trans").show()})),(0,A.default)("#"+this.ID+" .first-"+m.HTML.ID+" .contentArrow").click((function(t){t.stopPropagation(),(0,A.default)(".drawtools").find(".menuTwo").hide(),(0,A.default)(this).siblings(".menuTwo").show()})),(0,A.default)("#"+this.ID+" .first-"+m.HTML.ID+" .trans").click((function(){event.stopPropagation(),(0,A.default)(this).siblings(".menuTwo").hide()})),"å¨é¨å é¤"==m.Name)(0,A.default)("#"+this.ID+" .first-icon-delete").click((function(){(0,A.default)(".drawtools").find(".menuTwo").hide(),(0,A.default)(this).siblings().removeClass("active"),(0,A.default)(this).addClass("active"),a.ClearChartDrawPicture(),(0,A.default)(".subTolls").css("display","none")}));else{(0,A.default)("#"+this.ID+" .first-"+s[o].HTML.ID).click({CurrentIndex:o},(function(t){(0,A.default)(".drawtools").find(".menuTwo").hide(),(0,A.default)(this).siblings().removeClass("active"),(0,A.default)(this).addClass("active"),a.CreateChartDrawPicture(s[t.data.CurrentIndex].Name)}));var v=function(){S=e[o][D];var i=S.HTML.IClass;(0,A.default)("#"+t.ID+" ."+S.HTML.ID).hover((function(t){t.stopPropagation(),(0,A.default)(this).closest(".icon-image").find(".contentArrow").addClass("trans")})),(0,A.default)("#"+t.ID+" ."+S.HTML.ID).click({DrawName:S.Name,CurrentIndex:o,CurrentData:S},(function(t){t.stopPropagation(),(0,A.default)(this).closest(".icon-image").find(".contentArrow").hide(),(0,A.default)(this).siblings().removeClass("current"),(0,A.default)(this).addClass("current"),(0,A.default)(this).closest(".icon-image").children("i").eq(0).removeClass().addClass(i,"active").attr("title",t.data.CurrentData.HTML.Title),s.splice(t.data.CurrentIndex,1,t.data.CurrentData),(0,A.default)(this).parent().hide(),a.CreateChartDrawPicture(t.data.DrawName)}))};for(var D in e[o]){var S;v()}}}}var I=this.ID;(0,A.default)(document).click((function(t){(0,A.default)("#"+I).is(t.target)||0!==(0,A.default)("#"+I).has(t.target).length||((0,A.default)("#"+I+" .menuTwo").hide(),(0,A.default)("#"+I+" .contentArrow").hide())}));Z();var p=U(),T=Q(this.ChartBorder.GetRight()+this.Left),g=this.ChartBorder.GetTop();this.ToolsDiv.style.left=T/p+"px",this.ToolsDiv.style.top=g/p+"px",this.ToolsDiv.style.width=(this.Width-5)/p+"px",this.ToolsDiv.style.height="auto",this.ToolsDiv.style.position="absolute",this.ToolsDiv.style.display="block",this.SizeChange}}}function $e(){this.newMethod=Je,this.newMethod(),delete this.newMethod,this.ClassName="FrameSplitPaint",this.LineColor="rgb(255,0,0)",this.TextColor="rgb(255,0,0)",this.LineWidth=2,this.Font="bold "+18*U()+"px å¾®è½¯éé»",this.TextTopOffset=10*U(),this.SetOption=function(t){t&&(t.LineColor&&(this.LineColor=t.LineColor),t.TextColor&&(this.TextColor=t.TextColor),t.Font&&(this.Font=t.Font),ha.IsNumber(t.LineWidth)&&(this.LineWidth=t.LineWidth),ha.IsNumber(t.TextTopOffset)&&(this.TextTopOffset=t.TextTopOffset))},this.Draw=function(){if(this.HQChart&&(0==this.HQChart.Period||1==this.HQChart.Period)&&this.HQChart.ChartPaint[0]){var t=this.HQChart.ChartPaint[0].Data;if(t&&(this.Data=t,this.ChartFrame&&this.ChartFrame.SubFrame)){var e=this.ChartFrame.SubFrame[0].Frame;if(e){var a=!0===e.IsHScreen,i=e.DataWidth,r=e.DistanceWidth,n=e.XPointCount,s=this.LineWidth*U();if(a)var o=this.ChartBorder.GetHScreenBorder(),h=o.TopEx+r/2+Oi.FrameLeftMargin,l=o.BottomEx;else{o=this.ChartBorder.GetBorder(),h=o.LeftEx+r/2+Oi.FrameLeftMargin,l=o.RightEx;var u=o.ChartHeight-o.TopTitle-5*U()}this.Canvas.save(),this.Canvas.lineWidth=s,this.Canvas.font=this.Font,this.Canvas.textAlign="center",this.Canvas.textBaseline="top";for(var C={Left:o.LeftEx,Top:$(s,o.TopTitle),Height:u,LineWidth:s},D=this.Data.DataOffset,f=0;D<this.Data.Data.length&&f<n;++D,++f,h+=i+r){var c=this.Data.Data[D];if(c){var d=this.GetQuarter(c.Date);if(d){var m=h,v=h+i;if(v>l)break;var S=m+(v-m)/2;if(C.DateInfo){var I=C.DateInfo;I.Year!=d.Year||I.Quarter!=d.Quarter?(C.Right=S,this.DrawQuarter(C),C.Left=S,C.Right=null,C.DateInfo=d):C.Right=S}else C.DateInfo=d,C.Right=S}}}this.DrawQuarter(C),this.Canvas.restore()}}}},this.DrawQuarter=function(t){if(ha.IsNumber(t.Left)&&ha.IsNumber(t.Right)){var e=$(t.LineWidth,t.Left),a=$(t.LineWidth,t.Right),i=a-e;this.Canvas.strokeStyle=this.LineColor,this.Canvas.strokeRect(e,t.Top,i,t.Height);var r=t.DateInfo,n=r.Year%100;if(n<10)var s="0"+n;else s=n.toString();var o=s+"å¹´"+r.Quarter+"å­£åº¦",h=this.Canvas.measureText(o).width;if(h<i+5){var l=e+i/2,u=t.Top+this.TextTopOffset;this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(o,l,u)}}},this.GetQuarter=function(t){if(!ha.IsNumber(t))return null;var e=parseInt(t/1e4),a=parseInt(t%1e4/100);switch(a){case 1:case 2:case 3:var i=1;break;case 4:case 5:case 6:i=2;break;case 7:case 8:case 9:i=3;break;case 10:case 11:case 12:i=4;break;default:return null}return{Year:e,Month:a,Quarter:i}}}function ta(){this.newMethod=Je,this.newMethod(),delete this.newMethod,this.ClassName="RectSelectPaint",this.LineColor=Oi.RectSelect.LineColor,this.LineWidth=Oi.RectSelect.LineWidth,this.LineDotted=Oi.RectSelect.LineDotted,this.AreaColor=Oi.RectSelect.AreaColor,this.SubAreaColor=Oi.RectSelect.SubAreaColor,this.FirstPoint,this.SecondPoint,this.CenterPoint,this.PreventClose=!1,this.SpaceReselected=!1,this.SubClient={FirstPoint:null,SecondPoint:null,Start:null,End:null},this.StartDate,this.EndDate,this.CenterDate,this.HQChart,this.DragRect,this.DragClientRect,this.ShowRangeText={Enable:!1,Position:0,Font:Oi.RectSelect.RangeTextFont,Color:Oi.RectSelect.RangeTextColor,BGColor:Oi.RectSelect.RangeTextBGColor,SubPosition:0,SubFont:Oi.RectSelect.RangeTextSubFont,SubColor:Oi.RectSelect.RangeTextSubColor,SubBGColor:Oi.RectSelect.RangeTextSubBGColor},this.BorderCache,this.SetOption=function(t){if(t&&(t.LineColor&&(this.LineColor=t.LineColor),t.AreaColor&&(this.AreaColor=t.AreaColor),ha.IsBool(t.SpaceReselected)&&(this.SpaceReselected=t.SpaceReselected),t.ShowRangeText)){var e=t.ShowRangeText;ha.IsBool(e.Enable)&&(this.ShowRangeText.Enable=e.Enable),ha.IsNumber(e.Position)&&(this.ShowRangeText.Position=e.Position),ha.IsNumber(e.SubPosition)&&(this.ShowRangeText.SubPosition=e.SubPosition)}},this.ReloadResource=function(t){this.LineColor=Oi.RectSelect.LineColor,this.LineWidth=Oi.RectSelect.LineWidth,this.LineDotted=Oi.RectSelect.LineDotted,this.AreaColor=Oi.RectSelect.AreaColor,this.ShowRangeText.Font=Oi.RectSelect.RangeTextFont,this.ShowRangeText.Color=Oi.RectSelect.RangeTextColor,this.ShowRangeText.BGColor=Oi.RectSelect.RangeTextBGColor},this.IsMinuteChart=function(){var t=this.HQChart.ClassName,e="MinuteChartContainer"==t||"MinuteChartHScreenContainer"==t;return e},this.GetKData=function(){if(!this.HQChart)return null;var t=this.IsMinuteChart(),e=null;if(t){if(!this.HQChart.SourceData)return null;e=this.HQChart.SourceData}else{if(!this.HQChart.ChartPaint[0])return null;if(e=this.HQChart.ChartPaint[0].Data,!e)return null}return e},this.GetPointCount=function(){var t=0;return this.FirstPoint&&++t,this.SecondPoint&&++t,t},this.DateToNumber=function(t,e){if(e)return ha.IsNumber(t.Date)?1e4*t.Date+t.Time:t.Time;var a=this.HQChart.Period;return Ot.IsDayPeriod(a,!0)?t.Date:Ot.IsMinutePeriod(a,!0)?1e4*t.Date+t.Time:Ot.IsSecondPeriod(a)||Ot.IsTickPeriod(a)?1e6*t.Date+t.Time:null},this.GetSelectRectData=function(){if(!this.FirstPoint&&!this.SecondPoint)return null;var t=this.GetKData();if(!t)return null;for(var e=this.IsMinuteChart(),a=this.DateToNumber(this.FirstPoint,e),i=this.DateToNumber(this.SecondPoint,e),r={Start:null,End:null,Data:t},n=0;n<t.Data.length;++n){var s=t.Data[n];if(s){var o=this.DateToNumber(s,e);if(a==o&&(r.Start=n),i==o&&(r.End=n),ha.IsNumber(r.Start)&&ha.IsNumber(r.End)){if(r.Start>r.End){var h=r.Start;r.Start=r.End,r.End=h}return r}}}return null},this.SortPoint=function(){var t=this.IsMinuteChart();if(this.CenterData=null,this.FirstPoint&&!this.SecondPoint)this.StartDate={Date:this.DateToNumber(this.FirstPoint,t),Index:0};else if(this.FirstPoint&&this.SecondPoint){var e=this.DateToNumber(this.FirstPoint,t),a=this.DateToNumber(this.SecondPoint,t);if(e<a?(this.StartDate={Date:e,Index:0},this.EndDate={Date:a,Index:1}):(this.StartDate={Date:a,Index:1},this.EndDate={Date:e,Index:0}),this.CenterPoint){var i=this.DateToNumber(this.CenterPoint,t);this.CenterDate={Date:i,Index:2}}if(this.SubClient.FirstPoint&&this.SubClient.SecondPoint){e=this.DateToNumber(this.SubClient.FirstPoint,t),a=this.DateToNumber(this.SubClient.SecondPoint,t);e<a?(this.SubClient.Start={Date:e,Index:3},this.SubClient.End={Date:a,Index:4}):(this.SubClient.Start={Date:a,Index:4},this.SubClient.End={Date:e,Index:3}),this.SubClient.End.Date<=this.StartDate.Date||this.SubClient.Start.Date>=this.EndDate.Date?(this.SubClient.Start=null,this.SubClient.End=null):(this.SubClient.Start.Date<this.StartDate.Date&&(this.SubClient.Start.Date=this.StartDate.Date),this.SubClient.End.Date>this.EndDate.Date&&(this.SubClient.End.Date=this.EndDate.Date))}}},this.GetCenterPoint=function(){if(!this.FirstPoint||!this.SecondPoint)return null;if(!ha.IsNumber(this.FirstPoint.DataIndex))return null;if(!ha.IsNumber(this.SecondPoint.DataIndex))return null;var t=this.FirstPoint.DataIndex-this.SecondPoint.DataIndex;if(Math.abs(t)<3)return null;var e=parseInt(this.FirstPoint.DataIndex+(this.SecondPoint.DataIndex-this.FirstPoint.DataIndex)/2);if(e<0)return null;var a=this.GetKData();if(!a||!a.Data)return null;var i=a.Data[e];return i?{Date:i.Date,Time:i.Time,DataIndex:e}:null},this.MovePoint=function(t){if(!this.FirstPoint||!this.SecondPoint)return!1;var e=this.GetKData();if(!e||!e.Data)return!1;var a=this.FirstPoint.DataIndex+t,i=e.Data[a];if(!i)return!1;var r={Date:i.Date,Time:i.Time,DataIndex:a};a=this.SecondPoint.DataIndex+t,i=e.Data[a];if(!i)return!1;var n={Date:i.Date,Time:i.Time,DataIndex:a};a=this.CenterPoint.DataIndex+t,i=e.Data[a];if(!i)return!1;var s={Date:i.Date,Time:i.Time,DataIndex:a};return this.FirstPoint=r,this.SecondPoint=n,this.CenterPoint=s,!0},this.SetPoint=function(t,e){var a=null;if(e&&ha.IsNumber(e.DataIndex)&&(a=e.DataIndex),!e||!ha.IsNumber(e.Index))return this.FirstPoint?!this.SecondPoint&&(this.SecondPoint={Date:t.Date,Time:t.Time,DataIndex:a},this.CenterPoint=this.GetCenterPoint(),!0):(this.FirstPoint={Date:t.Date,Time:t.Time,DataIndex:a},!0);switch(e.Index){case 0:return this.FirstPoint={Date:t.Date,Time:t.Time,DataIndex:a},this.CenterPoint=this.GetCenterPoint(),!0;case 1:return this.SecondPoint={Date:t.Date,Time:t.Time,DataIndex:a},this.CenterPoint=this.GetCenterPoint(),!0;case 2:var i=a-this.CenterPoint.DataIndex;return Math.abs(i)>0&&this.MovePoint(i);case 3:return this.SubClient.FirstPoint={Date:t.Date,Time:t.Time,DataIndex:a},!0;case 4:return this.SubClient.SecondPoint={Date:t.Date,Time:t.Time,DataIndex:a},!0;default:return!1}},this.ClearPoint=function(){if(this.PreventClose)return!1;var t=!1;return this.FirstPoint&&(this.FirstPoint=null,t=!0),this.SecondPoint&&(this.SecondPoint=null,t=!0),this.SubClient.FirstPoint=null,this.SubClient.SecondPoint=null,t},this.Draw=function(){if(this.BorderCache=null,this.StartDate=null,this.EndDate=null,this.CenterDate=null,this.DragRect=[],this.DragClientRect=null,this.SubClient.Start=null,this.SubClient.End=null,this.FirstPoint||this.SecondPoint){this.SortPoint();var t=this.GetKData();if(t&&(this.Data=t,this.ChartFrame&&this.ChartFrame.SubFrame)){var e=this.ChartFrame.SubFrame[0].Frame;if(e){var a=!0===e.IsHScreen,i=e.DataWidth,r=e.DistanceWidth,n=e.XPointCount;if(a){var s=e.GetBorder(),o=s.TopEx+r/2+Oi.FrameLeftMargin;s.BottomEx;this.BorderCache=s}else{s=e.GetBorder(),o=s.LeftEx+r/2+Oi.FrameLeftMargin,s.RightEx,s.ChartHeight,s.TopTitle,U();var h=s.TopEx,l=s.BottomEx;this.BorderCache=s}this.Canvas.save();Ot.IsDayPeriod(this.HQChart.Period,!0);for(var u=this.IsMinuteChart(),C=null,D=null,f=null,c=null,d=[],m=this.Data.DataOffset,v=0;m<this.Data.Data.length&&v<n;++m,++v,o+=i+r){var S=this.Data.Data[m];if(S){var I=o,p=o+i;if(u)var T=e.GetXFromIndex(v);else T=I+(p-I)/2;var g=this.DateToNumber(S,u);if(this.StartDate&&g==this.StartDate.Date&&(C={XIndex:m,X:T,Top:h,Bottom:l,PointIndex:this.StartDate.Index,Type:0,Item:S},d.push(C)),this.EndDate&&g==this.EndDate.Date&&(D={XIndex:m,X:T,Top:h,Bottom:l,PointIndex:this.EndDate.Index,Type:1,Item:S},d.push(D)),this.CenterDate&&g==this.CenterDate.Date){var x={XIndex:m,X:T,Top:h,Bottom:l,PointIndex:this.CenterDate.Index,Type:2,Item:S};d.push(x)}if(this.SubClient&&this.SubClient.Start&&this.SubClient.End&&(g==this.SubClient.Start.Date&&(this.SubClient.Start.Point={Date:g,X:T,Top:h,Bottom:l,KItem:S}),g==this.SubClient.End.Date&&(this.SubClient.End.Point={Date:g,X:T,Top:h,Bottom:l,kItem:S})),f?(c.Date=g,c.X=T):(f={Date:g,X:T,Top:h,Bottom:l},c={Date:g,X:T,Top:h,Bottom:l}),C&&D)break}}if(this.DrawLines(d),this.DrawArea(C,D,f,c,this.AreaColor),this.SubClient&&this.SubClient.Start&&this.SubClient.End&&(this.DrawArea(this.SubClient.Start.Point,this.SubClient.End.Point,f,c,this.SubAreaColor),this.SubClient.Start.Point)){S=this.SubClient.Start.Point;var F={X:S.X,Top:S.Top,Bottom:S.Bottom,PointIndex:S.DataIndex,Type:3,Item:S.KItem};d.push(F)}this.DrawRangeText(d),this.Canvas.restore()}}}},this.DrawRangeText=function(t){if(this.ShowRangeText&&0!=this.ShowRangeText.Enable)for(var e,a,i,r=this.BorderCache,n=this.IsMinuteChart(),s=this.HQChart.Period,o=0;o<t.length;++o){var h=t[o];if(0===h.Type||1==h.Type||3==h.Type){if(n){var l=ha.FormatDateString(h.Item.Date,"YYYY-MM-DD"),u=ha.FormatTimeString(h.Item.Time,"HH:MM");i=l+" "+u}else{l=ha.FormatDateString(h.Item.Date,"YYYY-MM-DD"),u=null;Ot.IsMinutePeriod(s,!0)?u=ha.FormatTimeString(h.Item.Time,"HH:MM"):(Ot.IsSecondPeriod(s)||Ot.IsTickPeriod(s))&&(u=ha.FormatTimeString(h.Item.Time,"HH:MM:SS")),i=u?l+" "+u:l}if(3==h.Type){var C=this.ShowRangeText.SubPosition,D=this.ShowRangeText.SubBGColor,f=this.ShowRangeText.SubColor;this.Canvas.font=this.ShowRangeText.SubFont;var c=this.GetFontHeight()}else{C=this.ShowRangeText.Position,D=this.ShowRangeText.BGColor,f=this.ShowRangeText.Color;this.Canvas.font=this.ShowRangeText.Font;c=this.GetFontHeight()}var d=this.Canvas.measureText(i).width+4,m={Height:c,Width:d};0==h.Type||3==h.Type?d>h.X?(this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",e=h.X+2,m.X=h.X):(this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",e=h.X-2,m.X=h.X-d):1==h.Type&&(d>r.Right-h.X?(this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",e=h.X-2,m.X=h.X-d):(this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",e=h.X+2,m.X=h.X)),1==C?(a=h.Top+(h.Bottom-h.Top)/2,3==h.Type&&(a+=c),m.Y=a-c/2):2==C?(a=h.Bottom,m.Y=a-c/2):(a=h.Top,m.Y=a-c/2),D&&(this.Canvas.fillStyle=D,this.Canvas.fillRect(Q(m.X),Q(m.Y),tt(m.Width),tt(m.Height))),f&&(this.Canvas.fillStyle=f,this.Canvas.fillText(i,e,a,d))}}},this.DrawLines=function(t){if(ha.IsNonEmptyArray(t)){var e=this.LineWidth*U();this.Canvas.strokeStyle=this.LineColor,this.Canvas.lineWidth=e;for(var a=0;a<t.length;++a){var i=t[a],r=$(e,i.X);0==i.Type||1==i.Type?(this.LineDotted&&this.Canvas.setLineDash(this.LineDotted),this.Canvas.beginPath(),this.Canvas.moveTo(r,i.Top),this.Canvas.lineTo(r,i.Bottom),this.Canvas.stroke(),this.LineDotted&&this.Canvas.setLineDash([])):(this.Canvas.beginPath(),this.Canvas.moveTo(r,i.Top),this.Canvas.lineTo(r,i.Bottom),this.Canvas.stroke());var n=new Yt(r-3,i.Top,10,i.Bottom-i.Top);this.DragRect[a]={Rect:n,PointIndex:i.PointIndex,Type:i.Type}}}},this.PtInPaint=function(t,e){if(!ha.IsNonEmptyArray(this.DragRect))return null;for(var a=0;a<this.DragRect.length;++a){var i=this.DragRect[a],r=i.Rect;if(this.Canvas.beginPath(),this.Canvas.rect(r.X,r.Y,r.Width,r.Height),this.Canvas.isPointInPath(t,e))return{Index:a,PointIndex:i.PointIndex,Type:i.Type,Self:this}}return null},this.DrawArea=function(t,e,a,i,r){var n;if(a&&i&&this.StartDate&&this.EndDate&&(t&&e?n=[t,e]:!t&&e?n=[a,e]:t&&!e?n=[t,i]:a.Date>this.StartDate.Date&&i.Date<this.EndDate.Date&&(n=[a,i]),n&&2==n.length)){var s=n[0],o=n[1],h=Q(s.X),l=Q(o.X),u=l-h,C=s.Bottom-s.Top;this.Canvas.fillStyle=r,this.Canvas.fillRect(h,s.Top,u,C),this.DragClientRect={Left:h,Top:s.Top,Right:l,Bottom:s.Top+C,Width:u,Height:C}}}}function ea(){this.newMethod=Je,this.newMethod(),delete this.newMethod,this.ClassName="DepthMapPaint",this.LineColor=Oi.DepthMapPaint.LineColor,this.AreaColor=et(Oi.DepthMapPaint.AreaColor),this.TextColor=Oi.DepthMapPaint.TextColor,this.TextBGColor=Oi.DepthMapPaint.TextBGColor,this.FrameID=0,this.ID=q(),this.IsDynamic=!1,this.IsCallbackDraw=!0,this.YRange,this.WidthRate=.8,this.IsShow=!0,this.SetOption=function(t){t.FrameID>0&&(this.FrameID=t.FrameID),ha.IsObjectExist(t.ID)&&(this.ID=t.ID),t.IsShowCorssCursor&&(this.IsShowCorssCursor=t.IsShowCorssCursor),ha.IsNumber(t.WidthRate)&&(this.WidthRate=t.WidthRate)},this.Draw=function(){if(this.Data&&ha.IsNonEmptyArray(this.Data)&&this.ChartFrame&&this.ChartFrame.SubFrame&&!(this.ChartFrame.SubFrame.length<=this.FrameID)){var t=!0===this.ChartFrame.IsHScreen,e=this.ChartFrame.SubFrame[this.FrameID].Frame,a=e.ChartBorder,i=a.GetHeightEx(),r=a.GetRight(),n=a.GetTopEx(),s=a.GetBottomEx(),o=this.ChartBorder.Right*this.WidthRate;if(t){r=a.GetBottom(),n=a.GetRight(),s=a.GetLeft();o=this.Width;o>this.ChartBorder.Bottom&&(o=this.ChartBorder.Bottom)}var h={Left:r,Top:n,Right:r+o,Bottom:s,Height:i,Width:o};this.YRange={Max:null,Min:0};for(var l=0;l<this.Data.length;++l){var u=this.Data[l];this.CalculateYRange(u,this.YRange)}for(l=0;l<this.Data.length;++l){u=this.Data[l];u.Height>0&&u.Height<=1?h.Height=i*u.Height:h.Height=i,1==u.Type?(h.Top=n,h.Bottom=n+h.Height,this.DrawUpArea(u,h)):2==u.Type?(h.Bottom=s,h.Top=h.Bottom-h.Height,this.DrawDownArea(u,h)):(h.Top=n,h.Bottom=s,this.DrawDefaultArea(u,h))}}},this.CalculateYRange=function(t,e){for(var a in t.Data){var i=t.Data[a];(null==e.Max||e.Max<i.Y)&&(e.Max=i.Y),(null==e.Min||e.Min>i.Y)&&(e.Min=i.Y)}},this.GetXFromData=function(t,e,a){var i=e.Width*(t-a.Min)/(a.Max-a.Min);return e.Left+i},this.GetYFromData=function(t,e,a,i){if(i){var r=e.Height*(t-a.Min)/(a.Max-a.Min);return e.Bottom-r}r=e.Height*(t-a.Min)/(a.Max-a.Min);return e.Top+r},this.DrawDefaultArea=function(t,e){for(var a=this.ChartFrame.SubFrame[this.FrameID].Frame,i=t.Range&&t.Range.Y?t.Range.Y:this.YRange,r=[],n=0;n<t.Data.length;++n){var s=t.Data[n],o=this.GetXFromData(s.Y,e,i);if(!(s.X>a.HorizontalMax||s.X<a.HorizontalMin)){var h=a.GetYFromData(s.X);r.push({X:o,Y:h})}}var l=t.LineColor?t.LineColor:this.LineColor,u=t.AreaColor?t.AreaColor:this.AreaColor;r.length>0&&(1==t.DrawType?this.DrawHLine(r,l,e):this.DrawLine(r,l,u,e))},this.DrawUpArea=function(t,e){var a=[];for(var i in t.Data){var r=t.Data[i],n=this.GetXFromData(r.Y,e,t.Range.Y),s=this.GetYFromData(r.X,e,t.Range.X,t.IsASC);a.push({X:n,Y:s})}var o=t.LineColor?t.LineColor:this.LineColor,h=t.AreaColor?t.AreaColor:this.AreaColor;a.length>0&&this.DrawLine(a,o,h,e)},this.DrawDownArea=function(t,e){var a=[];for(var i in t.Data){var r=t.Data[i],n=this.GetXFromData(r.Y,e,t.Range.Y),s=this.GetYFromData(r.X,e,t.Range.X,t.IsASC);a.push({X:n,Y:s})}var o=t.LineColor?t.LineColor:this.LineColor,h=t.AreaColor?t.AreaColor:this.AreaColor;a.length>0&&this.DrawLine(a,o,h,e)},this.DrawHLine=function(t,e,a){var i=!0===this.ChartFrame.IsHScreen;this.Canvas.strokeStyle=e,this.Canvas.beginPath();for(var r=0,n=0;n<t.length;++n){var s=t[n];i||(this.Canvas.moveTo(a.Left,s.Y),this.Canvas.lineTo(s.X,s.Y)),++r}r>0&&this.Canvas.stroke()},this.DrawLine=function(t,e,a,i){var r=!0===this.ChartFrame.IsHScreen,n=!0,s=0;for(var o in this.Canvas.strokeStyle=e,t){var h=t[o];n?(this.Canvas.beginPath(),r?this.Canvas.moveTo(h.Y,h.X):this.Canvas.moveTo(h.X,h.Y),n=!1):r?this.Canvas.lineTo(h.Y,h.X):this.Canvas.lineTo(h.X,h.Y),++s}s>0&&this.Canvas.stroke();var l=t[0],u=t[t.length-1];if(r?(this.Canvas.lineTo(u.Y,i.Left),this.Canvas.lineTo(l.Y,i.Left)):(this.Canvas.lineTo(i.Left,u.Y),this.Canvas.lineTo(i.Left,l.Y)),this.Canvas.closePath(),Array.isArray(a))if(r){var C=this.Canvas.createLinearGradient(this.ChartBorder.GetRightEx(),this.ChartBorder.GetTop(),this.ChartBorder.GetLeft(),this.ChartBorder.GetTop());C.addColorStop(0,a[0]),C.addColorStop(1,a[1]),this.Canvas.fillStyle=C}else{var D=this.Canvas.createLinearGradient(i.Right,i.Top,i.Left,i.Top),f=1/a.length;for(o=0;o<a.length;++o)D.addColorStop(o*f,a[o]);this.Canvas.fillStyle=D}else this.Canvas.fillStyle=a;this.Canvas.fill()},this.GetYValueByXValue=function(t,e){for(var a=[],i=0,r=Ta[e],n=0;n<this.Data.length;++n){var s=this.Data[n];if(0==s.Type&&s.Data&&!(s.Data.length<0)&&0!=s.IsShowCorssCursor){for(var o=!1,h=0;h<s.Data.length;++h){var l=s.Data[h];if(i=parseInt(l.X*r),i==t){o=!0;var u={X:l.X,Y:l.Y,TextColor:s.TextColor?s.TextColor:this.TextColor,TextBGColor:s.TextBGColor?s.TextBGColor:this.TextBGColor};l.YText&&(u.YText=l.YText),a.push(u);break}}if(!o){var C=s.Data[0],D=s.Data[s.Data.length-1];t>C.X*r&&t<D.X*r&&a.push({X:null,Y:null,TextColor:s.TextColor?s.TextColor:this.TextColor,TextBGColor:s.TextBGColor?s.TextBGColor:this.TextBGColor})}}}return a}}function aa(){this.newMethod=Je,this.newMethod(),delete this.newMethod,this.ClassName="BackgroundPaint",this.IsDynamic=!1,this.IsCallbackDraw=!0,this.FrameID=0,this.Data,this.ID=q(),this.ChartSubFrame,this.ChartBorder,this.KData,this.Period,this.XPointCount=0,this.SetOption=function(t){t.FrameID>0&&(this.FrameID=t.FrameID),ha.IsObjectExist(t.ID)&&(this.ID=t.ID)},this.Draw=function(){if(this.Data&&this.HQChart&&this.ChartFrame&&this.ChartFrame.SubFrame&&!(this.ChartFrame.SubFrame.length<=this.FrameID)){var t=this.HQChart.ChartPaint[0];if(t&&t.Data&&(this.ChartSubFrame=this.ChartFrame.SubFrame[this.FrameID].Frame,this.ChartBorder=this.ChartSubFrame.ChartBorder,this.KData=t.Data,this.Period=this.HQChart.Period,this.KData&&!(this.KData.Data.length<=0))){var e=!0===this.ChartSubFrame.IsHScreen;this.XPointCount=this.ChartSubFrame.XPointCount;var a=this.ChartSubFrame.XPointCount,i=this.KData.Data[this.KData.DataOffset],r=this.KData.DataOffset+a-1;r>=this.KData.Data.length&&(r=this.KData.Data.length-1);var n=this.KData.Data[r],s=this.GetShowData(i,n);if(s&&!(s.length<=0)){var o=this.BuildKLineMap(),h=this.ChartBorder.GetBottomEx(),l=this.ChartBorder.GetTopEx(),u=this.ChartBorder.GetHeightEx();for(var C in e&&(l=this.ChartBorder.GetRightEx(),h=this.ChartBorder.GetLeftEx(),u=this.ChartBorder.GetWidthEx()),s){var D=s[C],f=this.GetBGCoordinate(D,o);if(f){if(Array.isArray(D.Color)){var c;c=e?this.Canvas.createLinearGradient(h,f.Left,l,f.Left):this.Canvas.createLinearGradient(f.Left,l,f.Left,h);var d=1/D.Color.length;for(var C in D.Color)c.addColorStop(C*d,D.Color[C]);this.Canvas.fillStyle=c}else this.Canvas.fillStyle=D.Color;e?this.Canvas.fillRect(tt(h),tt(f.Left),tt(u),tt(f.Width)):this.Canvas.fillRect(tt(f.Left),tt(l),tt(f.Width),tt(u))}}}}}},this.GetShowData=function(t,e){var a=[];for(var i in this.Data){var r=this.Data[i],n={};r.Start.Date>=t.Date&&r.Start.Date<=e.Date&&(n.Start=r.Start),r.End.Date>=t.Date&&r.End.Date<=e.Date&&(n.End=r.End),(n.Start||n.End)&&(n.Color=r.Color,a.push(n))}return a},this.BuildKLineMap=function(){var t=!0===this.ChartSubFrame.IsHScreen,e=this.ChartSubFrame.DataWidth,a=this.ChartSubFrame.DistanceWidth,i=this.ChartBorder.GetLeft()+a/2+Oi.FrameLeftMargin;t&&(i=this.ChartBorder.GetTop()+a/2+Oi.FrameLeftMargin);var r=this.ChartBorder.GetRight();t&&(r=this.ChartBorder.GetBottom());for(var n={Data:new E.default,Start:null,End:null},s=this.KData.DataOffset,o=0;s<this.KData.Data.length&&o<this.XPointCount;++s,++o,i+=e+a){var h=this.KData.Data[s],l=i,u=i+e;if(u>r)break;var C=l+(u-l)/2;0==o&&(n.XLeft=l),n.XRight=u;var D={Index:s,ShowIndex:o,X:C,Right:u,Left:l,Date:h.Date};if(Ot.IsMinutePeriod(this.Period,!0)){var f="Date:"+h.Date+" Time:"+h.Time;D.Time=h.Time}else f="Date:"+h.Date;n.Data.set(f,D),0==o&&(n.Start=D),n.End=D}return n},this.GetBGCoordinate=function(t,e){var a=null,i=null,r=Ot.IsMinutePeriod(this.Period,!0),n=!1;if(r?t.Start&&t.End&&t.Start.Date==t.End.Date&&t.Start.Time==t.End.Time&&(n=!0):t.Start&&t.End&&t.Start.Date==t.End.Date&&(n=!0),n){if(r)var s="Date:"+t.Start.Date+" Time:"+t.Start.Time;else s="Date:"+t.Start.Date;if(!e.Data.has(s))return null;var o=e.Data.get(s);return a=o.Left,i=o.Right,{Left:a,Right:i,Width:i-a}}if(t.Start){if(r)s="Date:"+t.Start.Date+" Time:"+t.Start.Time;else s="Date:"+t.Start.Date;if(e.Data.has(s)){o=e.Data.get(s);a=o.Left}else if(r)if(t.Start.Date<e.Start.Date||t.Start.Date==e.Start.Date&&t.Start.Time<=e.Start.Time)a=e.Start.Left;else{var h=!0,l=!1,u=void 0;try{for(var C,D=(0,T.default)(e.Data);!(h=(C=D.next()).done);h=!0){var f=C.value,c=f[1];if(c.Date>t.Start.Date||c.Date==t.Start.Date&&c.Time>t.Start.Time){a=c.Left;break}}}catch(O){l=!0,u=O}finally{try{!h&&D.return&&D.return()}finally{if(l)throw u}}}else if(t.Start.Date<=e.Start.Date)a=e.Start.Left;else{var d=!0,m=!1,v=void 0;try{for(var S,I=(0,T.default)(e.Data);!(d=(S=I.next()).done);d=!0){f=S.value,c=f[1];if(c.Date>t.Start.Date){a=c.Left;break}}}catch(O){m=!0,v=O}finally{try{!d&&I.return&&I.return()}finally{if(m)throw v}}}}else a=e.XLeft;if(t.End){if(r)s="Date:"+t.End.Date+" Time:"+t.End.Time;else s="Date:"+t.End.Date;if(e.Data.has(s)){o=e.Data.get(s);i=o.Right}else if(r)if(t.End.Date<e.End.Date||t.End.Date==e.End.Date&&t.End.Time>=e.End.Time)i=e.End.Right;else{var p=null,g=!0,x=!1,F=void 0;try{for(var y,L=(0,T.default)(e.Data);!(g=(y=L.next()).done);g=!0){f=y.value,c=f[1];if(c.Date>t.End.Date||c.Date==t.End.Date&&c.Time>t.End.Time){i=p;break}p=c.Right}}catch(O){x=!0,F=O}finally{try{!g&&L.return&&L.return()}finally{if(x)throw F}}}else if(t.End.Date<=e.End.Date)i=e.End.Right;else{p=null;var E=!0,M=!1,A=void 0;try{for(var N,w=(0,T.default)(e.Data);!(E=(N=w.next()).done);E=!0){f=N.value,c=f[1];if(c.Date>t.End.Date){i=p;break}p=c.Right}}catch(O){M=!0,A=O}finally{try{!E&&w.return&&w.return()}finally{if(M)throw A}}}}else i=e.XRight;return null==a||null==i?null:{Left:a,Right:i,Width:i-a}}}function ia(){this.newMethod=Je,this.newMethod(),delete this.newMethod,this.ClassName="MinuteBackgroundPaint",this.IsDynamic=!0,this.IsCallbackDraw=!1,this.HQChart,this.Data,this.Font=Oi.DefaultTextFont,this.TextColor=Oi.DefaultTextColor,this.MerginTop=20,this.ID=q(),this.FrameID=0,this.SetOption=function(t){t&&(t.Font&&(this.Font=t.Font),ha.IsObjectExist(t.ID)&&(this.ID=t.ID),t.FrameID>0&&(this.FrameID=t.FrameID),t.MerginTop>0&&(this.MerginTop=t.MerginTop))},this.Draw=function(){if(this.Data&&this.HQChart&&this.ChartFrame&&this.ChartFrame.SubFrame&&!(this.ChartFrame.SubFrame.length<=this.FrameID)){var t=this.ChartFrame.SubFrame[this.FrameID];if(t&&t.Frame){var e=t.Frame,a=this.HQChart.SourceData;if(a){for(var i=e.XPointCount,r=0,n=null,s=new E.default,o=a.DataOffset,h=0;o<a.Data.length&&h<i;++o,++h){var l=a.Data[o];l&&(l.Date!=r&&(r=l.Date,n?(n.Right=this.ChartFrame.GetXFromIndex(h-1),s.set(n.Date,n),n={Left:this.ChartFrame.GetXFromIndex(h),Date:l.Date}):n={Left:this.ChartFrame.GetXFromIndex(h),Date:l.Date}))}n&&!n.Right&&(n.Right=this.ChartFrame.GetXFromIndex(i-1),s.set(n.Date,n)),this.Canvas.textAlign="center",this.Canvas.textBaseline="top";var u=e.ChartBorder.GetTopEx()+this.MerginTop;for(o=0;o<this.Data.length;++o){l=this.Data[o];if(s.has(l.Date)){n=s.get(l.Date);var C=n.Left+(n.Right-n.Left)/2;l.Font?this.Canvas.font=l.Font:this.Canvas.font=this.Font,l.TextColor?this.Canvas.fillStyle=l.TextColor:this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(l.Text,C,u)}}}}}}}var ra={MAIN_KLINE:1,OVERLAY_KLINE:2,MAIN_INDEX:3,OVERLAY_INDEX:4,OVERLAY_MINUTE:5,MAIN_MINUTE:6,MAIN_AVERAGE_MINUTE:7,MAIN_MINUTE_VOL:8};function na(){this.newMethod=Je,this.newMethod(),delete this.newMethod,this.ClassName="DragMovePaint",this.DrawAfterTitle=!0,this.IsDynamic=!0,this.Info,this.IsShow=!1,this.Point,this.TextColor=Oi.DragMovePaint.TextColor,this.Font=Oi.DragMovePaint.Font,this.ReloadResource=function(t){this.TextColor=Oi.DragMovePaint.TextColor,this.Font=Oi.DragMovePaint.Font},this.Clear=function(){this.Info=null,this.IsShow=!1,this.Point=null},this.Draw=function(){if(this.Info&&this.IsShow&&this.Point){var t,e=this.Info.FrameID+1;this.Info.Type==ra.MAIN_KLINE?t="Kçº¿:"+this.Info.Name+", çªå£:"+e:this.Info.Type==ra.OVERLAY_KLINE?t="å å Kçº¿:"+this.Info.Name+", çªå£:"+e:this.Info.Type==ra.MAIN_INDEX?t="ææ :"+this.Info.IndexName+", çªå£:"+e:this.Info.Type==ra.OVERLAY_INDEX?t="å å ææ :"+this.Info.IndexName+", çªå£:"+e:this.Info.Type==ra.OVERLAY_MINUTE?t="èµ°å¿å¾, å å ä»·æ ¼çº¿:"+this.Info.Name+", çªå£:"+e:this.Info.Type==ra.MAIN_MINUTE?t="èµ°å¿å¾, ä»·æ ¼çº¿:"+this.Info.Name+", çªå£:"+e:this.Info.Type==ra.MAIN_AVERAGE_MINUTE?t="èµ°å¿å¾, åçº¿:"+this.Info.Name+", çªå£:"+e:this.Info.Type==ra.MAIN_MINUTE_VOL&&(t="èµ°å¿å¾, æäº¤é:"+this.Info.Name+", çªå£:"+e),t&&(this.Canvas.font=this.Font,this.Canvas.fillStyle=this.TextColor,this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.Canvas.fillText(t,this.Point.X,this.Point.Y))}}}function sa(){this.PlayList=[],this.Cache=[],this.MinLineHeight=40*U(),this.Height,this.Step=1,this.GetPlayList=function(t){for(var e=t.Canves,a=t.Right,i=t.Left,r=a-i,n=t.IsMoveStep,s=[],o=0,h=0;h<this.PlayList.length;++h){var l=this.PlayList[h],u=this.MinLineHeight;l.Height>this.MinLineHeight&&(u=l.Height);for(var C=!0,D=!1,f=0;f<l.Data.length;++f){var c=l.Data[f],d={X:c.X,Y:o,Text:c.Text,Color:c.Color,Height:u,Font:c.Font,Info:c.Info};s.push(d),n&&(f==l.Data.length-1&&this.Cache.length>0?(C=!1,c.TextWidth||(c.Font&&c.Font.Name?e.font=c.Font.Name:e.font=t.Font,c.TextWidth=e.measureText(d.Text+"ææ").width),c.X>=c.TextWidth&&(C=!0)):0==f&&(D=!1,c.TextWidth||(c.Font&&c.Font.Name?e.font=c.Font.Name:e.font=t.Font,c.TextWidth=e.measureText(d.Text+"ææ").width),c.X>r+c.TextWidth&&(D=!0)),c.X+=this.Step)}if(n&&C&&this.Cache.length>0){var m=this.Cache.shift(),v={X:0,Text:m.Text,Color:m.Color,Font:m.Font,Info:m.Info};l.Data.push(v)}if(n&&D&&l.Data.length>0){var S=l.Data.shift();this.OnItemPlayEnd(t.HQChart,S)}o+=u}return s},this.CacluatePlayLine=function(t){this.Height=t;var e=parseInt(t/this.MinLineHeight);if(this.PlayList.length<e)for(var a=e-this.PlayList.length,i=0;i<a;++i)this.PlayList.push({Data:[]});else if(this.PlayList.length>e){var r=this.PlayList.length-e;for(i=0;i<r;++i)for(var n=this.PlayList.pop(),s=0;s<n.Data.length;++s){var o=n.Data[s],h={Text:o.Text,Color:o.Color,Font:o.Font,Info:o.Info};this.Cache.unshift(h)}}w.Chart.Log("[BarrageList::CacluatePlayLine] LineCount="+this.PlayList.length+" Height="+this.Height)},this.AddBarrage=function(t){for(var e in t){var a=t[e];this.Cache.push(a)}},this.OnItemPlayEnd=function(t,e){if(t.mapEvent.has(G.BARRAGE_PLAY_END)){var a=t.mapEvent.get(G.BARRAGE_PLAY_END);a.Callback&&a.Callback(a,e,this)}},this.Count=function(){return this.Cache.length}}function oa(){this.newMethod=Je,this.newMethod(),delete this.newMethod,this.ClassName="BarragePaint",this.IsAnimation=!0,this.IsEraseBG=!0,this.HQChart,this.Font=Oi.Barrage.Font,this.TextColor=Oi.Barrage.Color,this.FontHeight=Oi.Barrage.Height,this.BarrageList=new sa,this.IsMoveStep=!1,this.SetOption=function(t){t&&(t.Step>0&&(this.BarrageList.Step=t.Step),t.MinLineHeight&&(this.Barrage.MinLineHeight=t.MinLineHeight))},this.DrawHScreen=function(){var t=this.ChartBorder.GetWidth(),e=this.ChartBorder.GetTop(),a=this.ChartBorder.GetBottom(),i=this.ChartBorder.GetRightEx();this.ChartBorder.GetChartWidth();t!=this.BarrageList.Height&&this.BarrageList.CacluatePlayLine(t),this.Canvas.textBaseline="middle",this.Canvas.textAlign="left";var r=this.BarrageList.GetPlayList({Canves:this.Canvas,Right:a,Left:e,Font:this.Font,IsMoveStep:this.IsMoveStep,HQChart:this.HQChart});if(this.IsMoveStep=!1,r){this.Canvas.save(),this.Canvas.translate(this.ChartBorder.GetChartHeight(),0),this.Canvas.rotate(90*Math.PI/180);for(var n=0;n<r.length;++n){var s=r[n];s.Color?this.Canvas.fillStyle=s.Color:this.Canvas.fillStyle=this.TextColor,s.Font?this.Canvas.font=s.Font.Name:this.Canvas.font=this.Font;var o=this.FontHeight;s.Font&&s.Font.Height>0&&(o=s.Font.Height);var h=s.Y+parseInt((s.Height-o)/2);this.Canvas.fillText(s.Text,a-s.X,i+h)}this.Canvas.restore()}},this.Draw=function(){if(this.ChartFrame.IsHScreen)this.DrawHScreen();else{var t=this.ChartBorder.GetLeft(),e=this.ChartBorder.GetRight(),a=this.ChartBorder.GetTopEx(),i=this.ChartBorder.GetHeight();i!=this.BarrageList.Height&&this.BarrageList.CacluatePlayLine(i),this.Canvas.textBaseline="middle",this.Canvas.textAlign="left";var r=this.BarrageList.GetPlayList({Canves:this.Canvas,Right:e,Left:t,Font:this.Font,IsMoveStep:this.IsMoveStep,HQChart:this.HQChart});if(this.IsMoveStep=!1,r)for(var n=0;n<r.length;++n){var s=r[n];s.Color?this.Canvas.fillStyle=s.Color:this.Canvas.fillStyle=this.TextColor,s.Font?this.Canvas.font=s.Font.Name:this.Canvas.font=this.Font;var o=this.FontHeight;s.Font&&s.Font.Height>0&&(o=s.Font.Height);var h=s.Y+parseInt((s.Height-o)/2);this.Canvas.fillText(s.Text,e-s.X,a+h)}}}}function ha(){this.ChartBorder,this.Frame,this.FrameSplitData,this.SplitCount=5,this.StringFormat=0,this.IsShowLeftText=!0,this.IsShowRightText=!0,this.LanguageID=Ri.LANGUAGE_CHINESE_ID,this.GetEventCallback,this.IntegerCoordinateSplit=function(t){var e=this.FrameSplitData.Find(t.Interval);if(!e)return!1;if(t.Interval==e.FixInterval)return!0;var a=t.Max,i=t.Min,r=t.Max/e.FixInterval,n=t.Min/e.FixInterval;ha.IsFloat(r)&&(a=parseInt((r+.5).toFixed(0))*e.FixInterval),ha.IsFloat(n)&&(i=parseInt((n-.5).toFixed(0))*e.FixInterval),0==t.Min&&(i=0),i<0&&t.Min>0&&(i=0);for(var s=0,o=i;o-a<1e-8;o+=e.FixInterval)++s;return t.Interval=e.FixInterval,t.Max=a,t.Min=i,t.Count=s,!0},this.Filter=function(t,e){if(this.SplitCount<=0||t.length<=0||t.length<=this.SplitCount)return t;var a=parseInt(t.length/this.SplitCount);a<=1&&(a=2);for(var i=[],r=0;r<t.length;r+=a)r+a>=t.length&&r!=t.length-1?i.push(t[t.length-1]):i.push(t[r]);if(2==this.SplitCount&&i.length>2)for(r=1;r<i.length-1;++r){var n=i[r];n.Message[0]=null,n.Message[1]=null}if(e){var s=!1;for(r=0;r<i.length;++r){n=i[r];if(Math.abs(n.Value)<1e-8){s=!0;break}}if(0==s){var o=new rt;o.Value=0,o.Message[0]=null,o.Message[1]=null,i.push(o)}}return i},this.RemoveZero=function(t){for(var e=[!0,!0,!0,!0],a=0;a<t.length;++a){var i=t[a],r=i.Message[0];this.IsDecimalZeroEnd(r)||(e[0]=!1);r=i.Message[1];this.IsDecimalZeroEnd(r)||(e[1]=!1);r=i.Message[2];this.IsDecimalZeroEnd(r)||(e[2]=!1);r=i.Message[3];this.IsDecimalZeroEnd(r)||(e[3]=!1)}if(0!=e[0]||0!=e[1]||0!=e[2]||0!=e[3])for(a=0;a<t.length;++a){i=t[a];if(e[0]){r=i.Message[0];null!=r&&("number"==typeof r&&(r=r.toString()),i.Message[0]=r.replace(/[.][0]+/g,""))}if(e[1]){r=i.Message[1];null!=r&&("number"==typeof r&&(r=r.toString()),i.Message[1]=r.replace(/[.][0]+/g,""))}if(e[2]){r=i.Message[2];null!=r&&("number"==typeof r&&(r=r.toString()),i.Message[2]=r.replace(/[.][0]+/g,""))}if(e[3]){r=i.Message[3];null!=r&&("number"==typeof r&&(r=r.toString()),i.Message[3]=r.replace(/[.][0]+/g,""))}}},this.IsDecimalZeroEnd=function(t){if(null==t)return!0;if("number"==typeof t&&(t=t.toString()),"0"==t)return!0;var e=t.search(/[.]/);if(e<0)return!1;for(var a=e+1;a<t.length;++a){var i=t.charAt(a);if(i>="1"&&i<="9")return!1}return!0}}function la(){this.newMethod=ha,this.newMethod(),delete this.newMethod,this.CoordinateType=0,this.Symbol,this.Data,this.FrameSplitData2,this.FloatPrecision=null,this.Period,this.KLineChart,this.Custom=[],this.SplitType=0,this.DefaultSplitType=0,this.DefaultYMaxMin,this.FixedYMaxMin,this.EnableZoomUpDown=!1,this.LastMaxMin,this.PercentageTextFormat=0,this.IsEnableDragY=function(){return 0==this.CoordinateType||1==this.CoordinateType},this.Operator=function(){var t={};t.Max=this.Frame.HorizontalMax,t.Min=this.Frame.HorizontalMin,t.Count=this.SplitCount,t.Max==t.Min&&(t.Max+=.01*t.Max,t.Min-=.01*t.Min);var e=this.FixedYMaxMin&&ha.IsNumber(this.FixedYMaxMin.Max)&&ha.IsNumber(this.FixedYMaxMin.Min);if(e)t.Max=this.FixedYMaxMin.Max,t.Min=this.FixedYMaxMin.Min;else if(this.DefaultYMaxMin){var a=this.DefaultYMaxMin;ha.IsNumber(a.Max)&&(t.Min>a.Max?t.Min=a.Max:t.Max<a.Max&&(t.Max=a.Max)),ha.IsNumber(a.Min)&&(t.Max<a.Min?t.Max=a.Min:t.Min>a.Min&&(t.Min=a.Min))}t.Interval=(t.Max-t.Min)/(t.Count-1);var i=U(),r=this.Frame.ChartBorder.GetChartWidth(),n=r<450*i,s=rn(this.Symbol);n&&Br.IsSHSZIndex(this.Symbol)&&(s=0),null!=this.FloatPrecision&&(s=this.FloatPrecision),w.Chart.Log("[FrameSplitKLinePriceY::Operator] Max="+t.Max+" Min="+t.Min+" Count="+t.Count+" isPhoneModel="+n+" defaultfloatPrecision="+s+" "),this.Frame.Logarithmic=null,this.Frame.MultiTextFormat=0;var o=!0;if(t.IsFixedMaxMin=e,t.IsFilter=o,Ot.IsTickPeriod(this.Period))this.SplitTickData(t,s),o=t.IsFilter;else if(la.SplitCustom)la.SplitCustom(this,t,s),o=!1;else switch(this.CoordinateType){case 1:this.SplitPercentage(t,s,e)?(this.Frame.MultiTextFormat=this.PercentageTextFormat,o=!1):this.SplitDefault(t,s,e);break;case 3:this.SplitIncrease(t,s)?o=!1:this.SplitDefault(t,s);break;case 4:this.SplitAverage(t,s),o=!1;break;case 5:this.SplitGoldenSection(t,s),o=!1;break;case 2:this.SplitLogarithmic(t,s)?o=!1:this.SplitDefault(t,s);break;default:1==this.SplitType?(this.SplitFixed(t,s),o=!1):2==this.SplitType?(this.SplitFixedV2(t,s),o=!1):this.SplitDefault(t,s,e);break}if(this.CustomCoordinate(s),o&&(this.Frame.HorizontalInfo=this.Filter(this.Frame.HorizontalInfo,!1)),this.Frame.HorizontalMax=t.Max,this.Frame.HorizontalMin=t.Min,1!=this.EnableZoomUpDown||this.FixedYMaxMin||(this.FixedYMaxMin={Max:t.Max,Min:t.Min}),w.Chart.Log("[FrameSplitKLinePriceY::Operator] fixed . Max="+t.Max+" Min="+t.Min+" Count="+t.Count),this.GetEventCallback){var h=this.GetEventCallback(G.ON_SPLIT_YCOORDINATE);if(h&&h.Callback){var l={ID:this.Frame.Identify,Frame:this.Frame};h.Callback(h,l,this)}}},this.SplitTickData=function(t,e){switch(this.CoordinateType){case 1:this.SplitPercentage(t,e,t.IsFixedMaxMin)?(this.Frame.MultiTextFormat=this.PercentageTextFormat,t.IsFilter=!1):this.SplitDefault(t,e,t.IsFixedMaxMin);break;default:3==this.SplitType?this.SplitTickPrice(t,e):this.SplitDefault(t,e,t.IsFixedMaxMin)}},this.SplitTickPrice=function(t,e){var a=this.KLineChart.GetAllPrice();for(var i in this.Frame.HorizontalInfo=[],a){var r=a[i];this.Frame.HorizontalInfo[i]=new rt,this.Frame.HorizontalInfo[i].Value=r,this.IsShowLeftText&&(this.Frame.HorizontalInfo[i].Message[0]=r.toFixed(e)),this.IsShowRightText&&(this.Frame.HorizontalInfo[i].Message[1]=r.toFixed(e))}},this.SplitPercentage=function(t,e,a){var i=this.GetFirstOpenPrice();if(!ha.IsNumber(i))return!1;t.Max=(t.Max-i)/i,t.Min=(t.Min-i)/i,t.Interval=(t.Max-t.Min)/(t.Count-1),a||this.IntegerCoordinateSplit2(t);var r,n=(1+t.Min)*i,s=(1+t.Max)*i;if(Oi.Frame&&Oi.Frame.PercentageText){var o=Oi.Frame.PercentageText;r={PriceColor:o.PriceColor,PercentageColor:o.PercentageColor,SplitColor:o.SplitColor,Font:o.Font}}for(var h=[],l=0;l<=t.Max;l+=t.Interval){var u=(l+1)*i;o=new rt;if(o.Value=u,this.IsShowLeftText&&(o.Message[0]=u.toFixed(e)),this.IsShowRightText){var C=u.toFixed(e),D=(100*l).toFixed(2);D=ha.RemoveZero(D),D+="%",o.Message[1]=[D,C],o.ExtendData=r}h.push(o)}for(l=-t.Interval;l>=t.Min;l-=t.Interval){u=(l+1)*i;if(!(u<n||u>s)){o=new rt;if(o.Value=u,this.IsShowLeftText&&(o.Message[0]=u.toFixed(e)),this.IsShowRightText){C=u.toFixed(e),D=(100*l).toFixed(2);D=ha.RemoveZero(D),D+="%",o.Message[1]=[D,C],o.ExtendData=r}h.push(o)}}return h.sort((function(t,e){return t.Value-e.Value})),this.Frame.HorizontalInfo=h,t.Min=n,t.Max=s,!0},this.SplitIncrease=function(t,e){var a=this.GetLast2ndClose();if(!ha.IsNumber(a))return!1;this.IntegerCoordinateSplit(t),this.Frame.HorizontalInfo=[];for(var i=Oi.FrameSplitIncrease.Increase,r=[],n=a;n<t.Max;n*=1+i){var s=new rt;s.Value=n;var o=n.toFixed(e);this.IsShowLeftText&&(s.Message[0]=o),this.IsShowRightText&&(s.Message[1]=o),r.push(s)}for(n=.9*a;n>t.Min;n*=1-i){s=new rt;s.Value=n;o=n.toFixed(e);this.IsShowLeftText&&(s.Message[0]=o),this.IsShowRightText&&(s.Message[1]=o),r.push(s)}return this.Frame.HorizontalInfo=r,!0},this.SplitAverage=function(t,e){var a=t.Max,i=t.Min;this.Frame.HorizontalInfo=[];for(var r=Oi.FrameSplitAverage.Count,n=(a-i)/r,s=0;s<=r;++s){var o=new rt;o.Value=i+n*s;var h=o.Value.toFixed(e);this.IsShowLeftText&&(o.Message[0]=h),this.IsShowRightText&&(o.Message[1]=h),this.Frame.HorizontalInfo[s]=o}},this.SplitGoldenSection=function(t,e){var a=t.Max,i=t.Min;this.Frame.HorizontalInfo=[];var r=[],n=Oi.FrameGoldenSection.Golden;for(var s in n){var o=(a-i)*n[s]+i;item=new rt,item.Value=o;var h=o.toFixed(e);this.IsShowLeftText&&(item.Message[0]=h),this.IsShowRightText&&(item.Message[1]=h),r.push(item)}this.Frame.HorizontalInfo=r},this.SplitLogarithmic=function(t,e){var a=Oi.FrameLogarithmic.MinInterval,i=this.GetFirstOpenPrice();if(!ha.IsNumber(i))return!1;for(var r=this.ChartBorder.GetHeightEx(),n=[.01,.02,.04,.08,.1,.2],s=n[n.length-1],o=0;o<n.length;++o){var h=n[o],l=i*h*(r/(t.Max-t.Min));if(l>a){s=h;break}}var u=[],C=i;o=s;do{var D={Start:C};C=i*(1+o),D.End=C,u.push(D),o+=s}while(C<t.Max);var f=C,c=[];C=i,o=s;do{D={End:C};C=i*(1-o),D.Start=C,c.push(D),o+=s}while(C>t.Min);var d=C;t.Max=f,t.Min=d,w.Chart.Log("[FrameSplitKLinePriceY::SplitLogarithmic] up, down",u,c),this.Frame.HorizontalInfo=[];D=new rt;D.Value=i,D.Font=Oi.FrameLogarithmic.OpenPriceFont;var m=D.Value.toFixed(e);for(var o in this.IsShowLeftText&&(D.Message[0]=m),this.IsShowRightText&&(D.Message[1]=m),this.Frame.HorizontalInfo.push(D),u){D=new rt;D.Value=u[o].End;m=D.Value.toFixed(e);this.IsShowLeftText&&(D.Message[0]=m),this.IsShowRightText&&(D.Message[1]=m),this.Frame.HorizontalInfo.push(D)}for(var o in c){D=new rt;D.Value=c[o].End;m=D.Value.toFixed(e);this.IsShowLeftText&&(D.Message[0]=m),this.IsShowRightText&&(D.Message[1]=m),this.Frame.HorizontalInfo.splice(0,0,D)}return this.Frame.Logarithmic={Up:u,Down:c,OpenPrice:i},!0},this.SplitDefault=function(t,e,a){a||this.IntegerCoordinateSplit(t),this.Frame.HorizontalInfo=[];for(var i=0,r=t.Min;i<t.Count;++i,r+=t.Interval)this.Frame.HorizontalInfo[i]=new rt,this.Frame.HorizontalInfo[i].Value=r,this.IsShowLeftText&&(this.Frame.HorizontalInfo[i].Message[0]=r.toFixed(e)),this.IsShowRightText&&(this.Frame.HorizontalInfo[i].Message[1]=r.toFixed(e))},this.SplitFixed=function(t,e){this.Frame.HorizontalInfo=[];for(var a=0,i=t.Min;a<t.Count;++a,i+=t.Interval)this.Frame.HorizontalInfo[a]=new rt,this.Frame.HorizontalInfo[a].Value=i,this.IsShowLeftText&&(this.Frame.HorizontalInfo[a].Message[0]=i.toFixed(e)),this.IsShowRightText&&(this.Frame.HorizontalInfo[a].Message[1]=i.toFixed(e))},this.SplitFixedV2=function(t,e){this.Frame.HorizontalInfo=[];for(var a=0,i=t.Min;a<t.Count;++a,i+=t.Interval)this.Frame.HorizontalInfo[a]=new rt,this.Frame.HorizontalInfo[a].Value=i,this.IsShowLeftText&&(this.Frame.HorizontalInfo[a].Message[0]=i.toFixed(e)),this.IsShowRightText&&(this.Frame.HorizontalInfo[a].Message[1]=i.toFixed(e));t.IsFixedMaxMin||(0==e?(t.Max+=1,t.Min-=1):1==e?(t.Max+=.1,t.Min-=.1):2==e&&(t.Max+=.01,t.Min-=.01))},this.CustomCoordinate=function(t){this.Frame.CustomHorizontalInfo=[];for(var e=0;e<this.Custom.length;++e){var a=this.Custom[e];if(0==a.Type||3==a.Type||2==a.Type){var i=t;ha.IsNumber(a.FloatPrecision)&&a.FloatPrecision>=0&&(i=a.FloatPrecision);var r=this.GetLatestPrice(i,a);r&&this.Frame.CustomHorizontalInfo.push(r)}else 1==a.Type&&this.CustomFixedCoordinate(a)}},this.GetLatestPrice=function(t,e){if(!this.Data||!this.Data.Data)return null;if(this.Data.Data.length<=0)return null;var a=this.Data.Data[this.Data.Data.length-1],i=new rt;i.Type=0,e&&ha.IsNumber(e.Type)&&(i.Type=e.Type),i.Value=a.Close,i.TextColor=Oi.FrameLatestPrice.TextColor,i.LineType=2;var r=a.Close.toFixed(t);if("HH:MM"==e.DateTime&&Ot.IsMinutePeriod(this.Period,!0)){var n=ha.FormatTimeString(a.Time,e.DateTime),s=[{Text:r},{Text:n}];"left"==e.Position?i.Message[0]=s:i.Message[1]=s}else if(ha.IsBool(e.CountDown)){s=[{Text:r},{Type:1}];"left"==e.Position?i.Message[0]=s:i.Message[1]=s}else"left"==e.Position?i.Message[0]=r:i.Message[1]=r;return a.Close>a.Open?i.LineColor=Oi.FrameLatestPrice.UpBarColor:a.Close<a.Open?i.LineColor=Oi.FrameLatestPrice.DownBarColor:i.LineColor=Oi.FrameLatestPrice.UnchagneBarColor,ha.IsNumber(e.LineType)&&(i.LineType=e.LineType),ha.IsPlusNumber(e.LineWidth)&&(i.LineWidth=e.LineWidth),e.LineDash&&(i.LineDash=e.LineDash),0==e.IsShowLine&&(i.LineType=-1),1===e.PositionEx&&(i.ExtendData={Custom:{Position:1}}),i},this.GetFirstOpenPrice=function(){if(!this.Data)return null;for(var t=this.Frame.XPointCount,e=this.Data.DataOffset,a=0;e<this.Data.Data.length&&a<t;++e,++a){var i=this.Data.Data[e];if(null!=i.Open&&null!=i.High&&null!=i.Low&&null!=i.Close)return Ot.IsTickPeriod(this.Period)?i.YClose:i.Open}return null},this.GetLast2ndClose=function(){if(!this.Data)return null;if(this.Data.Data.length<=0)return null;var t=this.Frame.XPointCount,e=this.Data.DataOffset+t-1;e>=this.Data.Data.length&&(e=this.Data.Data.length-1);for(var a=null,i=e,r=0;i>=0&&i<this.Data.Data.length;--i){var n=this.Data.Data[i];if(null!=n.Open&&null!=n.High&&null!=n.Low&&null!=n.Close&&(0==r?a=n.Open:1==r&&(a=n.Close),++r,r>=2))break}return a},this.CustomFixedCoordinate=function(t){var e=rn(this.Symbol);for(var a in t.Data){var i,r=t.Data[a],n=new rt;n.Type=1,n.TextColor=r.TextColor,n.LineColor=r.Color,n.LineType=2,ha.IsNumber(t.LineType)&&(n.LineType=t.LineType),ha.IsPlusNumber(t.LineWidth)&&(n.LineWidth=t.LineWidth),t.LineDash&&(n.LineDash=t.LineDash),0==t.IsShowLine&&(n.LineType=-1),n.Value=r.Value,i=r.Text?r.Text:n.Value.toFixed(e),"left"==t.Position?n.Message[0]=i:n.Message[1]=i,1===t.PositionEx&&(n.ExtendData={Custom:{Position:1}}),this.Frame.CustomHorizontalInfo.push(n)}},this.IntegerCoordinateSplit2=function(t){var e=this.FrameSplitData2.Find(t.Interval);if(!e)return!1;if(t.Interval==e.FixInterval)return!0;var a=parseInt((t.Max/e.FixInterval+.5).toFixed(0))*e.FixInterval,i=parseInt((t.Min/e.FixInterval-.5).toFixed(0))*e.FixInterval;0==t.Min&&(i=0),i<0&&t.Min>0&&(i=0);for(var r=0,n=i;n-a<1e-8;n+=e.FixInterval)++r;return t.Interval=e.FixInterval,t.Max=a,t.Min=i,t.Count=r,!0}}function ua(){this.newMethod=ha,this.newMethod(),delete this.newMethod,this.SplitCount=3,this.FloatPrecision=2,this.FLOATPRECISION_RANGE=[1,.1,.01,.001,1e-4],this.SplitType=0,this.DefaultSplitType=0,this.Custom=[],this.DefaultYMaxMin,this.EnableRemoveZero=!0,this.LineType=null,this.IgnoreYValue=null,this.FixedYMaxMin,this.EnableZoomUpDown=!1,this.IsBeforeData=!1,this.BeforeOpenData,this.IsAfterData=!1,this.AfterCloseData,this.ShareAfterVol=0,this.MultiDayBeforeOpenData,this.MultiDayAfterCloseData,this.IsEnableDragY=function(){return!0},this.GetFloatPrecision=function(t,e){if(t>this.FLOATPRECISION_RANGE[0])return e;if(e<0)return 2;for(;e<this.FLOATPRECISION_RANGE.length;++e)if(t>this.FLOATPRECISION_RANGE[e])break;return e},this.Operator=function(){var t={};t.Max=this.Frame.HorizontalMax,t.Min=this.Frame.HorizontalMin,t.Max==t.Min&&(0==t.Max?(t.Max=1,t.Min=-1):(t.Max+=.01*t.Max,t.Min-=.01*t.Min));var e=!1;if(this.FixedYMaxMin&&ha.IsNumber(this.FixedYMaxMin.Max)&&ha.IsNumber(this.FixedYMaxMin.Min)&&(e=!0),e)t.Max=this.FixedYMaxMin.Max,t.Min=this.FixedYMaxMin.Min;else if(this.DefaultYMaxMin){var a=this.DefaultYMaxMin;ha.IsNumber(a.Max)&&(t.Min>a.Max?t.Min=a.Max:t.Max<a.Max&&(t.Max=a.Max)),ha.IsNumber(a.Min)&&(t.Max<a.Min?t.Max=a.Min:t.Min>a.Min&&(t.Min=a.Min))}if(this.Frame.YSpecificMaxMin?(t.Count=this.Frame.YSpecificMaxMin.Count,t.Interval=(t.Max-t.Min)/(t.Count-1)):1==this.SplitType||e?(t.Count=this.SplitCount,t.Interval=(t.Max-t.Min)/(t.Count-1)):2==this.SplitType?(t.Max=100,t.Min=0,t.Count=this.SplitCount,t.Interval=(t.Max-t.Min)/(t.Count-1)):(t.Count=this.SplitCount,t.Interval=(t.Max-t.Min)/(t.Count-1),this.IntegerCoordinateSplit(t)),this.Frame.HorizontalInfo=[],this.Frame.YSplitScale)for(var i in this.Frame.YSplitScale){var r=this.Frame.YSplitScale[i],n=new rt;n.Value=r,ha.IsNumber(this.LineType)&&(n.LineType=this.LineType);var s=Math.abs(r);if(s<1e-10)n.Message[1]=0;else if(s<this.FLOATPRECISION_RANGE[this.FLOATPRECISION_RANGE.length-1])n.Message[1]=r.toExponential(2).toString();else{var o=this.GetFloatPrecision(s,this.FloatPrecision);n.Message[1]=ha.FormatValueString(r,o,this.LanguageID)}n.Message[0]=n.Message[1],0==this.IsShowLeftText&&(this.Frame.HorizontalInfo[i].Message[0]=null),0==this.IsShowRightText&&(this.Frame.HorizontalInfo[i].Message[1]=null),this.Frame.HorizontalInfo.push(n)}else for(i=0,r=t.Min;i<t.Count;++i,r+=t.Interval){n=new rt;this.Frame.HorizontalInfo[i]=n,n.Value=r,ha.IsNumber(this.LineType)&&(n.LineType=this.LineType);var h=this.FormatValueString(r);this.Frame.HorizontalInfo[i].Message[0]=this.Frame.HorizontalInfo[i].Message[1]=h,0==this.IsShowLeftText&&(this.Frame.HorizontalInfo[i].Message[0]=null),0==this.IsShowRightText&&(this.Frame.HorizontalInfo[i].Message[1]=null)}if(this.FilterIgnoreYValue(),this.CustomCoordinate(),1!=this.SplitType&&(this.Frame.HorizontalInfo=this.Filter(this.Frame.HorizontalInfo,t.Max>0&&t.Min<0)),this.RightFrameSplitY(),this.CallAcutionSplitY(this.SplitCount,t),this.EnableRemoveZero&&this.RemoveZero(this.Frame.HorizontalInfo),this.DynamicMessageText(),this.Frame.HorizontalMax=t.Max,this.Frame.HorizontalMin=t.Min,1!=this.EnableZoomUpDown||this.FixedYMaxMin||(this.FixedYMaxMin={Max:t.Max,Min:t.Min}),this.GetEventCallback){var l=this.GetEventCallback(G.ON_SPLIT_YCOORDINATE);if(l&&l.Callback){var u={ID:this.Frame.Identify,Frame:this.Frame};l.Callback(l,u,this)}}},this.FormatValueString=function(t){var e;if(1==this.StringFormat){var a=this.FloatPrecision;ha.IsNumber(t)&&Math.abs(t)>1e3&&(a=0),e=ha.FormatValueString(t,a,this.LanguageID)}else{var i=Math.abs(t);if(i<1e-10)e=0;else if(i<this.FLOATPRECISION_RANGE[this.FLOATPRECISION_RANGE.length-1])e=t.toExponential(2).toString();else{a=this.GetFloatPrecision(i,this.FloatPrecision);e=ha.FormatValueString(t,a,this.LanguageID)}}return e},this.FilterIgnoreYValue=function(){if(this.IgnoreYValue&&!(this.IgnoreYValue.length<=0)){var t=new I.default(this.IgnoreYValue);this.Frame.HorizontalInfo=this.Frame.HorizontalInfo.filter((function(e){return!t.has(e.Value)}))}},this.DynamicMessageText=function(){if(2==this.SplitType)for(var t=0;t<this.Frame.HorizontalInfo.length;++t){var e=this.Frame.HorizontalInfo[t];e.Message[0]&&(e.Message[0]+="%"),e.Message[1]&&(e.Message[1]+="%")}},this.CallAcutionSplitY=function(t,e){if(1!=this.Frame.Identify)return null;var a=this.GetCallAcutionSplitY(t,e);if(a){for(var i=0;i<this.Frame.HorizontalInfo.length;++i){var r=this.Frame.HorizontalInfo[i];a.IsBeforeData&&(r.Message[2]=r.Message[0],r.Message[0]=null),!a.IsAfterData||0!=this.ShareAfterVol&&2!=this.ShareAfterVol||(r.Message[3]=r.Message[1],r.Message[1]=null)}for(i=0;i<a.HorizontalInfo.length;++i){r=a.HorizontalInfo[i];this.Frame.HorizontalInfo.push(r)}}},this.GetCallAcutionSplitY=function(t,e){if(1!=this.Frame.Identify)return null;var a=1==this.IsBeforeData&&this.BeforeOpenData&&(2==this.BeforeOpenData.Ver||3==this.BeforeOpenData.Ver),i=1==this.IsAfterData&&this.AfterCloseData&&(2==this.AfterCloseData.Ver||3==this.AfterCloseData.Ver);if(a||i){var r=(e.Max-e.Min)/(t-1);if(a)var n=(this.BeforeOpenData.VolMax-this.BeforeOpenData.VolMin)/(t-1);if(i)var s=(this.AfterCloseData.VolMax-this.AfterCloseData.VolMin)/(t-1);for(var o=[],h=0;h<t;++h){var l=new rt,u=r*h;if(l.Value=u,l.LineType=8,a){var C=n*h;l.Message[0]=this.FormatValueString(C)}if(i&&(0==this.ShareAfterVol||2==this.ShareAfterVol)){var D=s*h;l.Message[1]=this.FormatValueString(D)}o.push(l)}return{HorizontalInfo:o,IsBeforeData:a,IsAfterData:i}}var f=!1;n=null;if(this.MultiDayBeforeOpenData&&ha.IsNonEmptyArray(this.MultiDayBeforeOpenData)){f=!0;var c=this.MultiDayBeforeOpenData[0];if(2==c.Ver||3==c.Ver)n=(c.VolMax-c.VolMin)/(t-1)}var d=!1;s=null;if(this.MultiDayAfterCloseData&&ha.IsNonEmptyArray(this.MultiDayAfterCloseData)){d=!0;c=this.MultiDayAfterCloseData[0];if(2==c.Ver||3==c.Ver)s=(c.VolMax-c.VolMin)/(t-1)}if(f||d){for(r=(e.Max-e.Min)/(t-1),o=[],h=0;h<t;++h){l=new rt,u=r*h;if(l.Value=u,l.LineType=9,null!=n){C=n*h;l.Message[0]=this.FormatValueString(C)}if(null!=s&&(0==this.ShareAfterVol||2==this.ShareAfterVol)){D=s*h;l.Message[1]=this.FormatValueString(D)}o.push(l)}return{HorizontalInfo:o,IsBeforeData:f,IsAfterData:d}}return null},this.RightFrameSplitY=function(){if(this.Frame.RightFrame){var t=this.Frame.RightFrame;for(var e in this.Frame.HorizontalInfo){var a=this.Frame.HorizontalInfo[e],i=this.Frame.GetYFromData(a.Value),r=t.GetYData(i);a.Message[1]=ha.FormatValueString(r,this.FloatPrecision,this.LanguageID)}}},this.CustomCoordinate=function(){for(var t in this.Frame.CustomHorizontalInfo=[],this.Custom){var e=this.Custom[t];0==e.Type||1==e.Type&&this.CustomFixedCoordinate(e)}},this.CustomFixedCoordinate=function(t){var e=2;for(var a in t.Data){var i,r=t.Data[a],n=new rt;n.Type=1,n.TextColor=r.TextColor,n.LineColor=r.Color,n.LineType=2,ha.IsNumber(t.LineType)&&(n.LineType=t.LineType),0==t.IsShowLine&&(n.LineType=-1),n.Value=r.Value,i=r.Text?r.Text:n.Value.toFixed(e),"left"==t.Position?n.Message[0]=i:n.Message[1]=i,this.Frame.CustomHorizontalInfo.push(n)}}}function Ca(){this.newMethod=ha,this.newMethod(),delete this.newMethod,this.ShowText=!0,this.Period,this.Symbol,this.MinTextDistance=50*U(),this.MinBarDistance=5,this.SplitDateTime=function(){this.Frame.VerticalInfo=[];for(var t=this.Frame.DistanceWidth+this.Frame.DataWidth,e=this.Frame.Data.DataOffset,a=this.Frame.XPointCount,i=0,r=0,n=0,s=e;n<a&&s<this.Frame.Data.Data.length;++n,++s){i+=t,++r;var o=null;if(0==n){var h=ha.FormatDateString(this.Frame.Data.Data[s].Date,"MM-DD");o={Value:s-e,Text:h}}else if(i>this.MinTextDistance&&r>=this.MinBarDistance){var l=ha.FormatTimeString(this.Frame.Data.Data[s].Time);o={Value:s-e,Text:l}}if(o){var u=new rt;u.Value=o.Value,this.ShowText&&(u.Message[0]=o.Text),0==u.Value&&(u.LineType=-1),this.Frame.VerticalInfo.push(u),i=0,r=0,0==n&&(i=-this.MinTextDistance/2)}}},this.SplitSecond=function(){this.Frame.VerticalInfo=[];for(var t=this.Frame.DistanceWidth+this.Frame.DataWidth,e=this.Frame.Data.DataOffset,a=this.Frame.XPointCount,i=0,r=0,n=0,s=e;n<a&&s<this.Frame.Data.Data.length;++n,++s){i+=t,++r;var o=null;if(0==n){var h=ha.FormatDateString(this.Frame.Data.Data[s].Date,"MM-DD");o={Value:s-e,Text:h}}else if(i>this.MinTextDistance&&r>=this.MinBarDistance){var l=ha.FormatTimeString(this.Frame.Data.Data[s].Time,"HH:MM:SS");o={Value:s-e,Text:l}}if(o){var u=new rt;u.Value=o.Value,this.ShowText&&(u.Message[0]=o.Text),this.Frame.VerticalInfo.push(u),i=0,r=0,0==n&&(i=-this.MinTextDistance/2)}}},this.SplitDate=function(){this.Frame.VerticalInfo=[];for(var t=this.Frame.Data.DataOffset,e=this.Frame.XPointCount,a=null,i=null,r=12,n=0,s=0,o=t,h=r;s<e&&o<this.Frame.Data.Data.length;++s,++o){var l=parseInt(this.Frame.Data.Data[o].Date/1e4),u=parseInt(this.Frame.Data.Data[o].Date/100)%100;if(i!=u&&++n,h<r||null!=a&&a==l&&null!=i&&i==u)i=u,++h;else{var C,D=new rt;D.Value=o-t,null==a||a!=l?C=l.toString():null!=i&&i==u||(C=u.toString()+"æ",C=bi.GetText(C,this.LanguageID)),a=l,i=u,this.ShowText&&(D.Message[0]=C),0==D.Value&&(D.LineType=-1),this.Frame.VerticalInfo.push(D),h=0}}0==this.Period&&n<=2&&this.SplitShortDate()},this.SplitShortDate=function(){this.Frame.VerticalInfo=[];for(var t=this.Frame.Data.DataOffset,e=this.Frame.XPointCount,a=12,i=!0,r=0,n=t,s=a;r<e&&n<this.Frame.Data.Data.length;++r,++n){var o=parseInt(this.Frame.Data.Data[n].Date/1e4);if(s<a)++s;else{var h=new rt;h.Value=n-t,i?(C=o.toString(),i=!1):C=ha.FormatDateString(this.Frame.Data.Data[n].Date,"MM-DD"),this.ShowText&&(h.Message[0]=C),0==h.Value&&(h.LineType=-1),this.Frame.VerticalInfo.push(h),s=0}}if(1==this.Frame.VerticalInfo.length){var l=this.Frame.VerticalInfo[0],u=(n=l.Value+t,this.Frame.Data.Data[n]),C=ha.FormatDateString(u.Date,"YYYY-MM");this.ShowText&&(l.Message[0]=C)}},this.Operator=function(){if(null!=this.Frame.Data&&(Ca.SplitCustom?Ca.SplitCustom(this):Ot.IsMinutePeriod(this.Period,!0)?this.SplitDateTime():Ot.IsSecondPeriod(this.Period)||Ot.IsTickPeriod(this.Period)?this.SplitSecond():this.SplitDate(),this.GetEventCallback)){var t=this.GetEventCallback(G.ON_SPLIT_XCOORDINATE);if(t&&t.Callback){var e={ID:this.Frame.Identify,Frame:this.Frame};t.Callback(t,e,this)}}},this.CreateCoordinateInfo=function(){return new rt}}function Da(){this.newMethod=ha,this.newMethod(),delete this.newMethod,this.High=null,this.Low=null,this.YClose,this.Data,this.SourceData,this.OverlayChartPaint,this.SplitCount=7,this.Symbol,this.SplitType=0,this.DefaultSplitType=0,this.LimitPrice,this.Custom,this.RightTextFormat=0,this.BeforeOpenData,this.IsBeforeData=!1,this.AfterCloseData,this.IsAfterData=!1,this.MultiDayBeforeOpenData,this.MultiDayAfterCloseData,this.DayOffset,this.AverageData,this.DayCount=1,this.GlobalOption,this.IsEnableDragY=function(){return!1},this.Operator=function(){if(this.Frame.HorizontalInfo=[],this.Frame.CustomHorizontalInfo=[],this.Data){var t=this.GetMaxMin();if(this.Symbol&&Br.IsUSA(this.Symbol.toUpperCase())||2==this.SplitType?this.USASplit(t):this.DefaultSplit(t),this.CustomCoordinate(),this.GetEventCallback){var e=this.GetEventCallback(G.ON_SPLIT_YCOORDINATE);if(e&&e.Callback){var a={ID:this.Frame.Identify,Frame:this.Frame};e.Callback(e,a,this)}}}},this.CustomCoordinate=function(){if(this.Custom){var t=rn(this.Symbol);for(var e in this.Custom){var a=this.Custom[e];if(1==a.Type)this.CustomFixedCoordinate(a);else if(0==a.Type){var i=this.GetLatestPrice(t,a);i&&this.Frame.CustomHorizontalInfo.push(i)}}}},this.GetLatestPrice=function(t,e){if(!this.Data||!this.Data.Data)return null;if(this.Data.Data.length<=0)return null;var a=this.Data.Data[this.Data.Data.length-1];if(!ha.IsNumber(a)||!ha.IsNumber(this.YClose))return null;var i=new rt;i.Type=0,i.Value=a,i.TextColor=Oi.FrameLatestPrice.TextColor,i.LineType=2;var r=a.toFixed(t);if("HH:MM"==e.DateTime){var n=this.Frame.Data.Data[this.Frame.Data.Data.length-1],s=ha.FormatTimeString(n.Time,e.DateTime),o=[{Text:r},{Text:s}];"left"==e.Position?i.Message[0]=o:i.Message[1]=o}else"left"==e.Position?i.Message[0]=r:i.Message[1]=r;return a>this.YClose?i.LineColor=Oi.FrameLatestPrice.UpBarColor:a<this.YClose?i.LineColor=Oi.FrameLatestPrice.DownBarColor:i.LineColor=Oi.FrameLatestPrice.UnchagneBarColor,ha.IsNumber(e.LineType)&&(i.LineType=e.LineType),ha.IsPlusNumber(e.LineWidth)&&(i.LineWidth=e.LineWidth),e.LineDash&&(i.LineDash=e.LineDash),0==e.IsShowLine&&(i.LineType=-1),1===e.PositionEx&&(i.ExtendData={Custom:{Position:1}}),i},this.CustomFixedCoordinate=function(t){for(var e=rn(this.Symbol),a=0;a<t.Data.length;++a){var i,r=t.Data[a],n=new rt;if(n.Type=1,n.TextColor=r.TextColor,n.LineColor=r.Color,n.LineType=2,ha.IsNumber(t.LineType)&&(n.LineType=t.LineType),ha.IsPlusNumber(t.LineWidth)&&(n.LineWidth=t.LineWidth),t.LineDash&&(n.LineDash=t.LineDash),0==t.IsShowLine&&(n.LineType=-1),1===t.PositionEx&&(n.ExtendData={Custom:{Position:1}}),ha.IsNumber(r.Increase)){if(!ha.IsNumber(this.YClose))continue;n.Value=this.YClose*(1+r.Increase)}else n.Value=r.Value;i=r.Text?r.Text:n.Value.toFixed(e),"left"==t.Position?n.Message[0]=i:n.Message[1]=i,this.Frame.CustomHorizontalInfo.push(n)}},this.GetCallAuctionMaxMin=function(t,e){for(var a in t.Data){var i=t.Data[a];i&&(ha.IsNumber(i.Price)&&(null==e.Max&&(e.Max=i.Price),null==e.Min&&(e.Min=i.Price),e.Max<i.Price&&(e.Max=i.Price),e.Min>i.Price&&(e.Min=i.Price)),3==t.Ver&&ha.IsNumber(i.AvPrice)&&(null==e.Max&&(e.Max=i.AvPrice),null==e.Min&&(e.Min=i.AvPrice),e.Max<i.AvPrice&&(e.Max=i.AvPrice),e.Min>i.AvPrice&&(e.Min=i.AvPrice)))}},this.GetMultiDayBeforeOpenData=function(){if(!this.MultiDayBeforeOpenData||!ha.IsNonEmptyArray(this.MultiDayBeforeOpenData))return null;if(!this.DayOffset)return this.MultiDayBeforeOpenData;if(!ha.IsNumber(this.DayOffset.Offset)||!ha.IsNumber(this.DayOffset.ShowDayCount))return null;if(this.GlobalOption&&!0===this.GlobalOption.IsValueFullRange)return this.MultiDayBeforeOpenData;var t=this.DayOffset.ShowDayCount,e=this.DayOffset.Offset,a=this.MultiDayBeforeOpenData.slice(e,e+t);return a},this.GetMultiDayAfterCloseData=function(){if(!this.MultiDayAfterCloseData||!ha.IsNonEmptyArray(this.MultiDayAfterCloseData))return null;if(!this.DayOffset)return this.MultiDayAfterCloseData;if(!ha.IsNumber(this.DayOffset.Offset)||!ha.IsNumber(this.DayOffset.ShowDayCount))return null;if(this.GlobalOption&&!0===this.GlobalOption.IsValueFullRange)return this.MultiDayAfterCloseData;var t=this.DayOffset.ShowDayCount,e=this.DayOffset.Offset,a=this.MultiDayAfterCloseData.slice(e,e+t);return a},this.GetMaxMin=function(){var t=this.YClose,e=this.YClose,a=this.Data,i=!1;if(this.SourceData&&(a=this.SourceData,i=!0),this.DayCount>1){var r=this.DayOffset.DataOffset,n=this.DayOffset.ShowDataCount;this.GlobalOption&&!0===this.GlobalOption.IsValueFullRange&&(r=0,n=a.Data.length);for(var s=r,o=0;s<a.Data.length&&o<n;++s,++o){var h=null;if(i){var l=a.Data[s];h=l.Before?l.Before.Close:l.Close}else h=a.Data[s];null!=h&&(t<h&&(t=h),e>h&&(e=h))}if(this.AverageData)for(s=r,o=0;s<this.AverageData.Data.length&&o<n;++s,++o)null!=this.AverageData.Data[s]&&(t<this.AverageData.Data[s]&&(t=this.AverageData.Data[s]),e>this.AverageData.Data[s]&&(e=this.AverageData.Data[s]))}else{for(s=0;s<a.Data.length;++s){h=null;if(i){l=a.Data[s];h=l.Before?l.Before.Close:l.Close}else h=a.Data[s];null!=h&&(t<h&&(t=h),e>h&&(e=h))}if(this.AverageData)for(s=0;s<this.AverageData.Data.length;++s)null!=this.AverageData.Data[s]&&(t<this.AverageData.Data[s]&&(t=this.AverageData.Data[s]),e>this.AverageData.Data[s]&&(e=this.AverageData.Data[s]))}for(var s in this.OverlayChartPaint){l=this.OverlayChartPaint[s];var u=l.GetMaxMin();u.Max&&u.Max>t&&(t=u.Max),u.Min&&u.Min<e&&(e=u.Min)}1==this.SplitType&&this.LimitPrice&&(t<this.LimitPrice.Max&&(t=this.LimitPrice.Max),e>this.LimitPrice.Min&&(e=this.LimitPrice.Min)),ha.IsNumber(this.High)&&ha.IsNumber(this.Low)&&(t<this.High&&(t=this.High),e>this.Low&&(e=this.Low));u={Max:null,Min:null};this.IsAfterData&&this.AfterCloseData&&this.GetCallAuctionMaxMin(this.AfterCloseData,u),this.IsBeforeData&&this.BeforeOpenData&&this.GetCallAuctionMaxMin(this.BeforeOpenData,u);var C=this.GetMultiDayBeforeOpenData();if(C&&this.ChartBorder.MultiDayMinute.Count>1&&this.ChartBorder.MultiDayMinute.Left>0)for(s=0;s<C.length;++s){var D=C[s];this.GetCallAuctionMaxMin(D,u)}var f=this.GetMultiDayAfterCloseData();if(f&&this.ChartBorder.MultiDayMinute.Count>1&&this.ChartBorder.MultiDayMinute.Right>0)for(s=0;s<f.length;++s){D=f[s];this.GetCallAuctionMaxMin(D,u)}return ha.IsNumber(u.Max)&&t<u.Max&&(t=u.Max),ha.IsNumber(u.Min)&&e>u.Min&&(e=u.Min),{Max:t,Min:e}},this.USASplit=function(t){var e=t.Max,a=t.Min;if(e==a)e+=.1*e,a-=.1*a;else{var i=U(),r=this.Frame.ChartBorder.GetHeight(),n=5*i*(e-a)/r;e+=n,a-=n,a<0&&(a=t.Min)}var s=this.SplitCount,o=(e-a)/(s-1),h=[1,.1,.01,.001,1e-4],l=rn(this.Symbol);o<h[l]&&(o=h[l],e=a+o*s);for(var u=0;u<s;++u){var C=a+o*u;if(!this.YClose||C!=this.YClose){var D=new rt;D.Value=C;var f=C.toFixed(l);if(this.IsShowLeftText&&(D.Message[0]=f),this.YClose){var c=100*(C/this.YClose-1);c>0?D.TextColor=Oi.UpTextColor:c<0&&(D.TextColor=Oi.DownTextColor),this.IsShowRightText&&(1==this.RightTextFormat?D.Message[1]=f:D.Message[1]=ha.FormatValueString(c,2)+"%")}this.Frame.HorizontalInfo.push(D)}}if(this.YClose>a&&this.YClose<e){D=new rt;D.Value=this.YClose,D.LineType=2,Oi.FrameDotSplitPen&&(D.LineColor=Oi.FrameDotSplitPen);f=this.YClose.toFixed(l);this.IsShowLeftText&&(D.Message[0]=f),this.IsShowRightText&&(1==this.RightTextFormat?D.Message[1]=f:D.Message[1]="0.00%"),this.Frame.HorizontalInfo.push(D)}this.Frame.HorizontalInfo.sort((function(t,e){return t.Value-e.Value})),this.Frame.HorizontalMax=e,this.Frame.HorizontalMin=a},this.DefaultSplit=function(t){var e=t.Max,a=t.Min;if(this.YClose==e&&this.YClose==a)e=this.YClose+.1*this.YClose,a=this.YClose-.1*this.YClose;else{var i=Math.max(Math.abs(this.YClose-e),Math.abs(this.YClose-a));e=this.YClose+i,a=this.YClose-i,a<0&&(a=t.Min)}var r=U(),n=this.Frame.ChartBorder.GetChartWidth(),s=n<450*r;w.Chart.Log("[FrameSplitMinutePriceY]max="+e+" min="+a+" isPhoneModel="+s);var o=this.SplitCount,h=(e-a)/(o-1),l=[1,.1,.01,.001,1e-4],u=rn(this.Symbol);s&&Br.IsSHSZIndex(this.Symbol)&&(u=0),h<l[u]&&(h=l[u],e=this.YClose+h*(o-1)/2,a=this.YClose-h*(o-1)/2);for(var C=0;C<o;++C){var D=a+h*C,f=new rt;this.Frame.HorizontalInfo[C]=f,f.Value=D;var c=D.toFixed(u);if(this.IsShowLeftText&&(f.Message[0]=c),D==this.YClose&&(f.LineType=2,Oi.FrameDotSplitPen&&(f.LineColor=Oi.FrameDotSplitPen)),this.YClose){var d=100*(D/this.YClose-1);d>0?f.TextColor=Oi.UpTextColor:d<0&&(f.TextColor=Oi.DownTextColor),this.IsShowRightText&&(1==this.RightTextFormat?f.Message[1]=c:f.Message[1]=ha.FormatValueString(d,2)+"%")}}this.Frame.HorizontalMax=e,this.Frame.HorizontalMin=a}}function fa(){this.newMethod=ha,this.newMethod(),delete this.newMethod,this.ShowText=!0,this.Symbol=null,this.DayCount=1,this.ShowDateFormate=1,this.Operator=function(){this.Frame.VerticalInfo=[];this.Frame.XPointCount;var t=this.Frame.ChartBorder.GetWidth(),e=!0===this.Frame.IsHScreen;e&&(t=this.Frame.ChartBorder.GetHeight()),t/=U();var a=zr,i=a.GetCoordinateData(this.Symbol,t),r=i.Count,n=i.MiddleCount>0?i.MiddleCount:parseInt(r/2),s=i.Data;if(this.Frame.XPointCount=r*this.DayCount,this.Frame.MinuteCount=r,this.Frame.VerticalInfo=[],this.DayCount<=1){this.DayOffset.DataOffset=0,this.DayOffset.ShowDataCount=r,this.DayOffset.PageInfo=null;for(var o=0;o<s.length;++o){var h=new rt;Oi.Minute.FrameSplitTextColor&&(h.TextColor=Oi.Minute.FrameSplitTextColor),h.Value=s[o][0],this.ShowText&&(h.Message[0]=s[o][3]),this.Frame.VerticalInfo[o]=h}}else{var l=0,u=this.DayData.length;this.DayOffset&&(ha.IsNumber(this.DayOffset.Offset)&&(l=this.DayOffset.Offset),ha.IsNumber(this.DayOffset.ShowDayCount)&&(u=this.DayOffset.ShowDayCount)),this.DayOffset.DataOffset=l*r,this.DayOffset.ShowDataCount=this.DayOffset.ShowDayCount*r,this.DayOffset.PageInfo={Day:[]};o=this.DayData.length-1-l;for(var C=0;o>=0&&C<u;--o,++C){h=new rt;h.Value=C*r+n,h.LineType=-1,this.ShowText&&(h.Message[0]=ha.FormatDateString(this.DayData[o].Date,0==this.ShowFormate?"YYYY-MM-DD":"MM-DD"),h.BG={Index:{Start:C*r+1,End:(C+1)*r-1},Date:this.DayData[o].Date}),this.Frame.VerticalInfo.push(h);h=new rt;h.Value=(C+1)*r,this.Frame.VerticalInfo.push(h),this.DayOffset.PageInfo.Day.push({Date:this.DayData[o].Date,Index:o})}}if(this.GetEventCallback){var D=this.GetEventCallback(G.ON_SPLIT_XCOORDINATE);if(D&&D.Callback){var f={ID:this.Frame.Identify,Frame:this.Frame};D.Callback(D,f,this)}}}}function ca(){this.newMethod=ha,this.newMethod(),delete this.newMethod,this.ShowText=!0,this.Symbol,this.MinTextDistance=50*U(),this.MinBarDistance=5,this.Operator=function(){if(null!=this.Frame.Data&&null!=this.Frame.XData){this.Frame.VerticalInfo=[];for(var t=this.Frame.Data.DataOffset,e=this.Frame.XPointCount,a=0,i=t;a<e&&i<this.Frame.Data.Data.length;++a,++i){var r=new rt;r.Value=i-t,this.ShowText&&(r.Message[0]=this.Frame.XData[a]),this.Frame.VerticalInfo.push(r),distance=0}}}}function da(){this.newMethod=ha,this.newMethod(),delete this.newMethod,this.ShowText=!0,this.SplitCount=3,this.Symbol,this.LineType=3,this.Operator=function(){var t=this.Frame.VerticalRange;if(t){this.Frame.VerticalInfo=[];var e=2;this.Symbol&&(e=rn(this.Symbol));var a=t.Max,i=t.Min;if(t.Bid)for(var r=(t.Bid.Max-i)/this.SplitCount,n=0;n<this.SplitCount;++n){var s=new rt;s.Value=i+r*n,s.Value<=0||(ha.IsNumber(this.LineType)&&(s.LineType=this.LineType),this.ShowText&&(s.Message[0]=s.Value.toFixed(e)),this.Frame.VerticalInfo.push(s))}s=new rt;if(s.Value=t.Center,this.Frame.VerticalInfo.push(s),t.Ask)for(r=(a-t.Ask.Min)/this.SplitCount,n=1;n<=this.SplitCount;++n){s=new rt;s.Value=t.Ask.Min+r*n,ha.IsNumber(this.LineType)&&(s.LineType=this.LineType),this.ShowText&&(s.Message[0]=s.Value.toFixed(e)),this.Frame.VerticalInfo.push(s)}}}}function ma(){this.Frame,this.Value,this.Point,this.ClientPos,this.BeforOpeneData,this.AfterCloseData,this.X,this.Item,this.DataIndex,this.DayIndex,this.MultiDayBeforeOpenData,this.MultiDayAfterCloseData,this.DayOffset,this.Operator=function(){return this.Item=null,this.DataIndex=null,this.DayIndex=null,2==this.ClientPos?this.GetBeforeOpenXIndex():3==this.ClientPos?this.GetAfterCloseXIndex():this.ClientPos>=200&&this.ClientPos<=299?this.GetMultiDayBeforeOpenXIndex():this.ClientPos>=300&&this.ClientPos<=399&&this.GetMultiDayAfterCloseXIndex()},this.GetBeforeOpenXIndex=function(){if(!ha.IsNumber(this.Value))return!1;if(!this.BeforeOpenData||!this.BeforeOpenData.Data)return!1;var t=this.Frame.GetLeftExtendXData(this.Value,this.BeforeOpenData);if(t=parseInt(t.toFixed(0)),t>=0&&t<this.BeforeOpenData.Data.length){var e=this.BeforeOpenData.Data[t];if(ha.IsNumber(e.Price))return this.Item=e,this.X=this.Value,this.DataIndex=t,!0}t<0?t=0:t>=this.BeforeOpenData.Data.length&&(t=this.BeforeOpenData.Data.length-1);for(var a=-1,i=t;i>=0;--i){e=this.BeforeOpenData.Data[i];if(ha.IsNumber(e.Price)){a=i;break}}if(a<0)for(i=t+1;i<this.BeforeOpenData.Data.length;++i){e=this.BeforeOpenData.Data[i];if(ha.IsNumber(e.Price)){a=i;break}}return!(a<0)&&(this.Item=e,this.DataIndex=a,this.X=this.Frame.GetLeftExtendXFromIndex(a,this.BeforeOpenData),!0)},this.GetMultiDayBeforeOpenData=function(){if(!this.MultiDayBeforeOpenData||!ha.IsNonEmptyArray(this.MultiDayBeforeOpenData))return null;if(this.DayOffset||this.MultiDayBeforeOpenData,!ha.IsNumber(this.DayOffset.Offset)||!ha.IsNumber(this.DayOffset.ShowDayCount))return null;var t=this.DayOffset.ShowDayCount,e=this.DayOffset.Offset,a=this.MultiDayBeforeOpenData.slice(e,e+t);return a},this.GetMultiDayBeforeOpenXIndex=function(){var t=this.GetMultiDayBeforeOpenData();if(!t||!ha.IsNonEmptyArray(t))return!1;var e=this.ClientPos-200;if(e<0||e>=t.length)return!1;var a=t[e],i=this.Frame.GetLeftExtendXData(this.Value,t);if(!i||!ha.IsNumber(i.DataIndex))return!1;var r=parseInt(i.DataIndex.toFixed(0));e=i.DayIndex;if(r>=0&&r<a.Data.length){var n=a.Data[r];if(ha.IsNumber(n.Price))return this.Item=n,this.X=this.Value,this.DataIndex=r,this.DayIndex=e,!0}r<0?r=0:r>=a.Data.length&&(r=a.Data.length-1);for(var s=-1,o=r;o>=0;--o){n=a.Data[o];if(ha.IsNumber(n.Price)){s=o;break}}return!(s<0)&&(this.Item=n,this.DataIndex=s,this.DayIndex=e,this.X=this.Frame.GetLeftExtendXFromIndex(s,a),!0)},this.GetAfterCloseXIndex=function(){if(!ha.IsNumber(this.Value))return!1;if(!this.AfterCloseData||!this.AfterCloseData.Data)return!1;var t=this.Frame.GetRightExtendXData(this.Value,this.AfterCloseData);if(t=parseInt(t.toFixed(0)),t>=0&&t<this.AfterCloseData.Data.length){var e=this.AfterCloseData.Data[t];if(ha.IsNumber(e.Price))return this.Item=e,this.X=this.Value,this.DataIndex=t,!0}t<0?t=0:t>=this.AfterCloseData.Data.length&&(t=this.AfterCloseData.Data.length-1);for(var a=-1,i=t;i>=0;--i){e=this.AfterCloseData.Data[i];if(ha.IsNumber(e.Price)){a=i;break}}if(a<0)for(i=t+1;i<this.AfterCloseData.Data.length;++i){e=this.AfterCloseData.Data[i];if(ha.IsNumber(e.Price)){a=i;break}}return!(a<0)&&(this.Item=e,this.DataIndex=a,this.X=this.Frame.GetRightExtendXFromIndex(a,this.AfterCloseData),!0)},this.GetMultiDayAfterCloseData=function(){if(!this.MultiDayAfterCloseData||!ha.IsNonEmptyArray(this.MultiDayAfterCloseData))return null;if(this.DayOffset||this.MultiDayAfterCloseData,!ha.IsNumber(this.DayOffset.Offset)||!ha.IsNumber(this.DayOffset.ShowDayCount))return null;var t=this.DayOffset.ShowDayCount,e=this.DayOffset.Offset,a=this.MultiDayAfterCloseData.slice(e,e+t);return a},this.GetMultiDayAfterCloseXIndex=function(){var t=this.GetMultiDayAfterCloseData();if(t&&ha.IsNonEmptyArray(t)){var e=this.ClientPos-300;if(!(e<0||e>=t.length)){var a=t[e],i=this.Frame.GetRightExtendXData(this.Value,t),r=parseInt(i.DataIndex.toFixed(0));e=i.DayIndex;if(r>=0&&r<a.Data.length){var n=a.Data[r];if(ha.IsNumber(n.Price))return this.Item=n,this.X=this.Value,this.DataIndex=r,this.DayIndex=e,!0}r<0?r=0:r>=a.Data.length&&(r=a.Data.length-1);for(var s=-1,o=r;o>=0;--o){n=a.Data[o];if(ha.IsNumber(n.Price)){s=o;break}}return!(s<0)&&(this.Item=n,this.DataIndex=s,this.DayIndex=e,this.X=this.Frame.GetRightExtendXFromIndex(s,a),!0)}}}}function va(){this.ClassName="ChartCorssCursor",this.Frame,this.Canvas,this.HPenColor=Oi.CorssCursorHPenColor,this.HPenType=0,this.VPenColor=Oi.CorssCursorVPenColor,this.VPenType=0,this.VLineType=0,this.Font=Oi.CorssCursorTextFont,this.TextColor=Oi.CorssCursorTextColor,this.TextBGColor=Oi.CorssCursorBGColor,this.BorderColor=Oi.CorssCursorBorderColor,this.XRangeBGColor=Oi.CorssCursorXRangeBGColor,this.TextHeight=20,this.LastPoint,this.CursorIndex,this.IsOnlyDrawKLine=!1,this.IsOnlyDrawMinute=!1,this.IsFixXLastTime=!1,this.IsDrawXRangeBG=!1,this.PointX,this.PointY,this.StringFormatX,this.StringFormatY,this.ShowTextMode={Left:1,Right:1,Bottom:1},this.TextFormat={Right:0},this.IsShowCorss=!0,this.IsShow=!0,this.IsShowClose=!1,this.ClientPos=-1,this.CallAcutionXOperator,this.RightButton={Enable:!1,Rect:null,BGColor:Oi.CorssCursor.RightButton.BGColor,PenColor:Oi.CorssCursor.RightButton.PenColor,Icon:Oi.CorssCursor.RightButton.Icon},this.Close=null,this.Status=0,this.ReloadResource=function(t){this.Font=Oi.CorssCursorTextFont,this.HPenColor=Oi.CorssCursorHPenColor,this.VPenColor=Oi.CorssCursorVPenColor,this.TextColor=Oi.CorssCursorTextColor,this.TextBGColor=Oi.CorssCursorBGColor,this.BorderColor=Oi.CorssCursorBorderColor,this.XRangeBGColor=Oi.CorssCursorXRangeBGColor},this.GetCloseYPoint=function(t){if(!this.StringFormatX.Data)return null;var e=this.StringFormatX.Data;if(!e.Data||e.Data.length<=0)return null;var a=e.DataOffset+t;if(a>=e.Data.length&&(a=e.Data.length-1),a<0)return null;var i=e.Data[a];if(!i)return null;this.Close=i.Close;var r=this.Frame.GetYFromData(this.Close);return r},this.GetMinuteCloseYPoint=function(t){if(!ha.IsNumber(t))return null;if(t=parseInt(t),!this.StringFormatX.Data)return null;var e=this.StringFormatX.Data;if(!e.Data||e.Data.length<=0)return null;var a=e.DataOffset+t;if(a>=e.Data.length&&(a=e.Data.length-1),a<0)return null;var i=e.Data[a];if(!ha.IsNumber(t))return null;this.Close=i;var r=this.Frame.GetYFromData(this.Close);return r},this.GetDateTimeRange=function(t,e){if(!ha.IsNumber(t))return null;t=parseInt(t);var a=this.StringFormatX.Data;if(!a.Data||a.Data.length<=0)return null;var i=a.DataOffset+t;if(i>=a.Data.length||i<0)return null;if(!this.Frame||!this.Frame.SubFrame[0]||!this.Frame.SubFrame[0].Frame)return null;var r=this.Frame.SubFrame[0].Frame,n=r.DataWidth,s=r.DistanceWidth,o=r.XPointCount,h=a.Data[i];if(!h)return null;for(var l=1e6*h.Date,u=100*parseInt(h.Time/100),C=l+u,D=l+u+59,f=i,c=i;c<a.Data.length;++c){var d=a.Data[c],m=1e6*d.Date+d.Time;if(m>D)break;if(c-a.DataOffset>=o)break;f=c}var v=i;for(c=i;c>=0&&c>=a.DataOffset;--c){d=a.Data[c],m=1e6*d.Date+d.Time;if(m<C)break;v=c}var S={StartIndex:v,EndIndex:f};return S.XStart=this.Frame.GetXFromIndex(v-a.DataOffset),S.XEnd=this.Frame.GetXFromIndex(f-a.DataOffset),S.XStart-=(s+n)/2,S.XEnd+=(s+n)/2,S},this.FixMinuteLastTimeXPoint=function(t){if(!ha.IsNumber(t))return null;if(t=parseInt(t),!this.StringFormatX.Data)return null;var e=this.StringFormatX.Data;if(!e.Data||e.Data.length<=0)return null;var a=e.DataOffset+t;if(a<e.Data.length)return null;a=e.Data.length-1,a-=e.DataOffset;var i=this.Frame.GetXFromIndex(a);return{X:i,Index:a}},this.PtInClient=function(t,e){if(this.Canvas.beginPath(),!0===this.Frame.IsHScreen){var a=this.Frame.ChartBorder.GetHScreenBorder();this.Canvas.rect(a.Left,a.TopEx,a.Right-a.Left,a.BottomEx-a.TopEx)}else{a=this.Frame.ChartBorder.GetBorder();this.Canvas.rect(a.LeftEx,a.Top,a.RightEx-a.LeftEx,a.Bottom-a.Top)}return this.Canvas.isPointInPath(t,e)?1:this.Frame.ChartBorder.LeftExtendWidth>10&&(this.Canvas.beginPath(),!0===this.Frame.IsHScreen?this.Canvas.rect(a.Left,a.Top,a.Right-a.Left,a.TopEx-a.Top):this.Canvas.rect(a.Left,a.Top,a.LeftEx-a.Left,a.Bottom-a.Top),this.Canvas.isPointInPath(t,e))?2:this.Frame.ChartBorder.RightExtendWidth>10&&(this.Canvas.beginPath(),!0===this.Frame.IsHScreen?this.Canvas.rect(a.Left,a.BottomEx,a.Right-a.Left,a.Bottom-a.BottomEx):this.Canvas.rect(a.RightEx,a.Top,a.Right-a.RightEx,a.Bottom-a.Top),this.Canvas.isPointInPath(t,e))?3:-1},this.GetFontHeight=function(t){return K(this.Canvas,t,"æ")},this.Draw=function(){if(this.Status=0,this.RightButton.Rect=null,this.LastPoint){this.Close=null;var t=this.LastPoint.X,e=this.LastPoint.Y,a=this.PtInClient(t,e);if(this.PointY=null,this.PointY,this.ClientPos=a,!(a<=0))if(!0!==this.Frame.IsHScreen){var i=this.Frame.ChartBorder.GetBorder(),r=i.Left,n=i.Right,s=i.TopTitle,o=i.Bottom,h=this.Frame.ChartBorder.Right,l=i.ChartWidth;if(this.IsOnlyDrawKLine){if(t=this.Frame.GetXFromIndex(this.CursorIndex),this.IsShowClose){var u=this.GetCloseYPoint(this.CursorIndex);null!=u&&(e=u)}}else if(this.IsOnlyDrawMinute){u=this.GetMinuteCloseYPoint(this.CursorIndex);null!=u&&(e=u)}if(this.CallAcutionXOperator&&(this.CallAcutionXOperator.Value=t,this.CallAcutionXOperator.Point={X:t,Y:e},this.CallAcutionXOperator.ClientPos=a,this.CallAcutionXOperator.Operator()&&(t=this.CallAcutionXOperator.X)),this.IsFixXLastTime){var C=this.FixMinuteLastTimeXPoint(this.CursorIndex);C&&(t=C.X,this.CursorIndex=C.Index)}if(this.PointY=[[r,e],[n,e]],this.PointX=[[t,s],[t,o]],this.IsShowCorss){var D=null;this.IsDrawXRangeBG&&(D=this.GetDateTimeRange(this.CursorIndex));var f=U();if(1!=this.HPenType&&0!=this.HPenType||(this.Canvas.strokeStyle=this.HPenColor,0==this.HPenType&&this.Canvas.setLineDash([3*f,2*f]),this.Canvas.beginPath(),this.Canvas.moveTo(r,Q(e)),this.Canvas.lineTo(n,Q(e)),this.Canvas.stroke(),0==this.HPenType&&this.Canvas.setLineDash([])),this.Canvas.save(),this.Canvas.strokeStyle=this.VPenColor,0==this.VPenType)this.Canvas.setLineDash([3*f,2*f]);else if(2==this.VPenType){var c=this.Frame.SubFrame[0].Frame.DataWidth;c>2*f&&(this.Canvas.lineWidth=c)}if(this.Canvas.beginPath(),1==this.VLineType)D&&(this.Canvas.fillStyle=this.XRangeBGColor,this.Canvas.fillRect(D.XStart,i.Top,D.XEnd-D.XStart,i.Bottom-i.Top)),this.Canvas.moveTo(Q(t),i.Top),this.Canvas.lineTo(Q(t),i.Bottom);else if(this.Frame.SubFrame.length>0)for(var d in this.Frame.SubFrame){var m=this.Frame.SubFrame[d].Frame,v=m.ChartBorder.GetBorder();s=v.TopTitle,o=v.Bottom,D&&(this.Canvas.fillStyle=this.XRangeBGColor,this.Canvas.fillRect(D.XStart,s,D.XEnd-D.XStart,o-s)),this.Canvas.moveTo(Q(t),s),this.Canvas.lineTo(Q(t),o)}else this.Canvas.moveTo(Q(t),s),this.Canvas.lineTo(Q(t),o);this.Canvas.stroke(),this.Canvas.restore()}this.Frame.GetXData(t);var S={},I=this.Frame.GetYData(e,S);(this.IsOnlyDrawMinute||this.IsShowClose)&&null!=this.Close&&(I=this.Close),this.StringFormatX.Value=this.CursorIndex,this.StringFormatX.Point={X:t,Y:e},this.StringFormatX.ClientPos=a,this.StringFormatY.Value=I,this.StringFormatY.RValue=S.RightYValue,this.StringFormatY.FrameID=S.FrameID,this.StringFormatY.Point={X:t,Y:e},this.StringFormatY.ClientPos=a,this.Canvas.font=this.Font;var p=this.GetFontHeight();if(p>this.TextHeight&&(this.TextHeight=p),(1==this.ShowTextMode.Left&&this.Frame.ChartBorder.Left>=30||2==this.ShowTextMode.Left||1==this.ShowTextMode.Right&&this.Frame.ChartBorder.Right>=30||2==this.ShowTextMode.Right)&&this.StringFormatY.Operator()){var T=this.StringFormatY.Text;this.Canvas.font=this.Font;var g=this.Canvas.measureText(T).width+4,x={Y:e,YValue:I,FrameID:S.FrameID};if(this.Frame.ChartBorder.Left>=30&&1==this.ShowTextMode.Left?r<g?(this.DrawTextBGRect(Q(2),Q(e-this.TextHeight/2),tt(g),tt(this.TextHeight)),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(T,4,e,g)):(this.DrawTextBGRect(r-2,e-this.TextHeight/2,-g,this.TextHeight),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(T,r-4,e,g)):2==this.ShowTextMode.Left&&(this.DrawTextBGRect(r,e-this.TextHeight/2,g,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(T,r+2,e,g)),this.StringFormatY.PercentageText&&0==this.TextFormat.Right&&(T=this.StringFormatY.PercentageText+"%",g=this.Canvas.measureText(T).width+4),this.StringFormatY.RText){T=this.StringFormatY.RText;g=this.Canvas.measureText(T).width+4}if(this.Frame.ChartBorder.Right>=30&&1==this.ShowTextMode.Right){var F=!1,y=null;if(S.FrameID>=0){m=this.Frame.SubFrame[S.FrameID];F=m.OverlayIndex.length>0,y=m.Interval}if(F&&g>y){var L=n+y;L>l&&(L=l),this.DrawTextBGRect(L-2-g,e-this.TextHeight/2,g,this.TextHeight),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(T,L-4,e,g)}else h<g?(this.DrawTextBGRect(l-2-g,e-this.TextHeight/2,g,this.TextHeight),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(T,l-4,e,g),this.RightButton.Enable&&this.DrawRightButton(e-this.TextHeight/2,l-2-g,this.TextHeight,this.TextHeight,x)):(this.DrawTextBGRect(n+2,e-this.TextHeight/2,g,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(T,n+4,e,g),this.RightButton.Enable&&this.DrawRightButton(e-this.TextHeight/2,n+2,this.TextHeight,this.TextHeight,x));if(this.StringFormatY.RExtendText&&this.StringFormatY.RExtendText.length>0){var E=0;for(var d in this.StringFormatY.RExtendText){var M=this.StringFormatY.RExtendText[d],A="--.--";M.YText?A=M.YText:ha.IsNumber(M.Y)&&(A=M.Y.toFixed(0));var N=this.Canvas.measureText(A).width+4;h<N?(this.DrawTextBGRect(l-2-N,e+E+this.TextHeight/2,N,this.TextHeight),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=M.TextColor,this.Canvas.fillText(A,l-4,e+E+this.TextHeight,N)):(this.DrawTextBGRect(n+2,e+E+this.TextHeight/2,N,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=M.TextColor,this.Canvas.fillText(A,n+4,e+E+this.TextHeight,N)),E+=this.TextHeight}}}else if(2==this.ShowTextMode.Right){this.Canvas.fillStyle=this.TextBGColor;var w=n-g;this.DrawTextBGRect(w,e-this.TextHeight/2,g,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(T,w+2,e,g),this.RightButton.Enable&&this.DrawRightButton(e-this.TextHeight/2,w,this.TextHeight,this.TextHeight,x)}}if((1==this.ShowTextMode.Bottom||2==this.ShowTextMode.Bottom)&&this.StringFormatX.Operator()){T=this.StringFormatX.Text;this.Canvas.font=this.Font,this.Canvas.fillStyle=this.TextBGColor;g=this.Canvas.measureText(T).width+4;var O=o+2+this.TextHeight/2,R=o+2;2==this.ShowTextMode.Bottom&&(O=o-this.TextHeight/2-2,R=o-this.TextHeight-2),t-g/2<3?(this.DrawTextBGRect(t-1,R,g,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(T,t+1,O,g)):t+g/2>=n?(this.DrawTextBGRect(n-g,R,g,this.TextHeight),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(T,n-2,O,g)):(this.DrawTextBGRect(t-g/2,R,g,this.TextHeight),this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(T,t,O,g))}if(S.FrameID>=0){m=this.Frame.SubFrame[S.FrameID];var P=!1;this.Frame.AutoRightBorder&&(P=!0);var b=n;for(var d in P&&(b=n+this.Frame.AuotRightWidth),this.Canvas.font=this.Font,m.OverlayIndex){M=m.OverlayIndex[d];if(!1!==M.Frame.IsShow){if(P||(b+=m.Interval),b+30>l)break;for(I=M.Frame.GetYData(e),d=2;d>=0;--d){T=ha.FormatValueString(I,d),g=this.Canvas.measureText(T).width+4;if(g<m.Interval)break}this.Canvas.fillStyle=this.TextBGColor,this.Canvas.fillRect(b+2,e-this.TextHeight/2,g,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(T,b+4,e,g),P&&(b+=M.RightWidth.Width)}}}this.Status=1}else this.HScreenDraw()}},this.DrawRightButton=function(t,e,a,i,r){this.Canvas.fillStyle=this.RightButton.BGColor;var n={Left:e-a,Top:t,Width:a,Height:i};this.RightButton.Rect=n,this.RightButton.Data=r,this.Canvas.fillRect(Q(n.Left+1),Q(n.Top),tt(n.Width),tt(n.Height));var s=U(),o=3,h=n.Top+o+(n.Height-2*o)/2,l=n.Left+o+(n.Width-2*o)/2;if(this.RightButton.Icon){var u=this.RightButton.Icon;this.Canvas.font=u.Size*s+"px "+u.Family,this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=u.Color,this.Canvas.fillText("î£",l,h)}else{this.Canvas.strokeStyle=this.RightButton.PenColor;var C=n.Left+o,D=n.Top+o;this.Canvas.save(),this.Canvas.linewidth=1*s,this.Canvas.beginPath(),this.Canvas.moveTo(Q(C),Q(h)),this.Canvas.lineTo(Q(C+n.Width-2*o),Q(h)),this.Canvas.moveTo(Q(l),Q(D)),this.Canvas.lineTo(Q(l),Q(D+n.Height-2*o)),this.Canvas.stroke(),this.Canvas.restore()}},this.PtInButton=function(t,e){if(!this.RightButton.Enable)return null;if(!this.RightButton.Rect)return null;var a=this.RightButton.Rect;return this.Canvas.beginPath(),this.Canvas.rect(a.Left,a.Top,a.Width,a.Height),this.Canvas.isPointInPath(t,e)?{Data:this.RightButton.Data,Rect:a}:void 0},this.DrawTextBGRect=function(t,e,a,i){this.Canvas.fillStyle=this.TextBGColor,this.Canvas.fillRect(Q(t),Q(e),tt(a),tt(i)),this.BorderColor&&(this.Canvas.strokeStyle=this.BorderColor,this.Canvas.strokeRect(Q(t),Q(e),tt(a),tt(i)))},this.HScreenDraw=function(){var t=this.LastPoint.X,e=this.LastPoint.Y;this.IsOnlyDrawKLine&&(e=this.Frame.GetXFromIndex(this.CursorIndex));var a=this.Frame.ChartBorder.GetHScreenBorder(),i=a.Left,r=a.Right,n=a.Top,s=a.Bottom,o=this.Frame.ChartBorder.Bottom;if(this.CallAcutionXOperator&&(this.CallAcutionXOperator.Value=e,this.CallAcutionXOperator.Point={X:t,Y:e},this.CallAcutionXOperator.ClientPos=this.ClientPos,this.CallAcutionXOperator.Operator()&&(e=this.CallAcutionXOperator.X)),this.PointY=[[i,e],[r,e]],this.PointX=[[t,n],[t,s]],this.IsShowCorss){var h=U();if(this.Canvas.save(),this.Canvas.strokeStyle=this.HPenColor,0==this.HPenType&&this.Canvas.setLineDash([3*h,2*h]),this.Canvas.beginPath(),this.Canvas.moveTo(Q(t),n),this.Canvas.lineTo(Q(t),s),this.Canvas.stroke(),this.Canvas.restore(),this.Canvas.save(),this.Canvas.strokeStyle=this.VPenColor,0==this.VPenType)this.Canvas.setLineDash([3*h,2*h]);else if(2==this.VPenType){var l=this.Frame.SubFrame[0].Frame.DataWidth;l>2*h&&(this.Canvas.lineWidth=l)}if(this.Canvas.beginPath(),1==this.VLineType)this.Canvas.moveTo(i,Q(e)),this.Canvas.lineTo(r,Q(e));else if(this.Frame.SubFrame.length>0)for(var u in this.Frame.SubFrame){var C=this.Frame.SubFrame[u].Frame,D=C.ChartBorder.GetHScreenBorder();this.Canvas.moveTo(D.Left,Q(e)),this.Canvas.lineTo(D.RightEx,Q(e))}else this.Canvas.moveTo(i,Q(e)),this.Canvas.lineTo(r,Q(e));this.Canvas.stroke(),this.Canvas.restore()}var f=this.Frame.GetXData(e),c={},d=this.Frame.GetYData(t,c);if(this.StringFormatX.Value=f,this.StringFormatX.Point={X:t,Y:e},this.StringFormatX.ClientPos=this.ClientPos,this.StringFormatY.Value=d,this.StringFormatY.FrameID=c.FrameID,this.StringFormatY.Point={X:t,Y:e},this.StringFormatY.ClientPos=this.ClientPos,(1==this.ShowTextMode.Left&&this.Frame.ChartBorder.Top>=30||2==this.ShowTextMode.Left||1==this.ShowTextMode.Right&&this.Frame.ChartBorder.Bottom>=30||2==this.ShowTextMode.Right)&&this.StringFormatY.Operator()){var m=this.StringFormatY.Text;this.Canvas.font=this.Font;var v=this.Canvas.measureText(m).width+4;if(this.Frame.ChartBorder.Top>=30&&1==this.ShowTextMode.Left){var S=t,I=n;this.Canvas.save(),this.Canvas.translate(S,I),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillStyle=this.TextBGColor,n>=v?(this.Canvas.fillRect(0,-this.TextHeight/2,-v,this.TextHeight),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,-2,0,v)):(this.Canvas.fillRect(v-n,-this.TextHeight/2,-v,this.TextHeight),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,v-n-2,0,v)),this.Canvas.restore()}else if(2==this.ShowTextMode.Left){S=t,I=n;this.Canvas.save(),this.Canvas.translate(S,I),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillStyle=this.TextBGColor,this.Canvas.fillRect(0,-this.TextHeight/2,v,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,2,0,v),this.Canvas.restore()}if(this.StringFormatY.RText){m=this.StringFormatY.RText;v=this.Canvas.measureText(m).width+4}if(this.Frame.ChartBorder.Bottom>=30&&1==this.ShowTextMode.Right){S=t,I=s;if(this.Canvas.save(),this.Canvas.translate(S,I),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillStyle=this.TextBGColor,o>v?(this.Canvas.fillRect(0,-this.TextHeight/2,v,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,2,0,v)):(this.Canvas.fillRect(o-v,-this.TextHeight/2,v,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,o-v+2,0,v)),this.StringFormatY.RExtendText&&this.StringFormatY.RExtendText.length>0){var p=0;for(var u in this.StringFormatY.RExtendText){var T=this.StringFormatY.RExtendText[u],g="--.--";T.YText?g=T.YText:ha.IsNumber(T.Y)&&(g=T.Y.toFixed(0));var x=this.Canvas.measureText(g).width+4;if(this.Canvas.fillStyle=T.TextBGColor,o>x)this.Canvas.fillRect(0,p+this.TextHeight/2,x,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=T.TextColor,this.Canvas.fillText(g,2,p+this.TextHeight,x);else{var F=o-x;this.Canvas.fillRect(F,p+this.TextHeight/2,x,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=T.TextColor,this.Canvas.fillText(g,F+2,p+this.TextHeight,x)}p+=this.TextHeight}}this.Canvas.restore()}else if(2==this.ShowTextMode.Right){S=t,I=s;this.Canvas.save(),this.Canvas.translate(S,I),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillStyle=this.TextBGColor,this.Canvas.fillRect(0,-this.TextHeight/2,-v,this.TextHeight),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,-2,0,v),this.Canvas.restore()}}if(1===this.ShowTextMode.Bottom&&this.StringFormatX.Operator()){m=this.StringFormatX.Text;this.Canvas.font=this.Font,this.Canvas.fillStyle=this.TextBGColor;v=this.Canvas.measureText(m).width+4;if(e-v/2<3){S=i,I=e;this.Canvas.save(),this.Canvas.translate(S,I),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillRect(0,0,v,this.TextHeight),this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,2,this.TextHeight/2,v),this.Canvas.restore()}else if(e+v/2>=s){S=i,I=e;this.Canvas.save(),this.Canvas.translate(S,I),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillRect(-v,0,v,this.TextHeight),this.Canvas.textAlign="right",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,-2,this.TextHeight/2,v),this.Canvas.restore()}else{S=i,I=e;this.Canvas.save(),this.Canvas.translate(S,I),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillRect(-v/2,0,v,this.TextHeight),this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,0,this.TextHeight/2,v),this.Canvas.restore()}}this.Status=1}}function Sa(){this.Frame,this.HQChart,this.Canvas,this.Data,this.Symbol,this.HPenType=0,this.VPenType=0,this.LineDash=Oi.DepthCorss.LineDash,this.IsShowTooltip=!0,this.AskColor=Oi.DepthCorss.AskColor.Line,this.BidColor=Oi.DepthCorss.BidColor.Line,this.LineWidth=Oi.DepthCorss.LineWidth,this.ClassName="DepthChartCorssCursor",this.Tooltip={LineHeight:Oi.DepthCorss.Tooltip.LineHeight,Border:{Top:Oi.DepthCorss.Tooltip.Border.Top,Left:Oi.DepthCorss.Tooltip.Border.Left,Bottom:Oi.DepthCorss.Tooltip.Border.Bottom,Center:Oi.DepthCorss.Tooltip.Border.Center},Font:Oi.DepthCorss.Tooltip.Font,TextColor:Oi.DepthCorss.Tooltip.TextColor,BGColor:Oi.DepthCorss.Tooltip.BGColor},this.Font=Oi.CorssCursorTextFont,this.TextColor=Oi.CorssCursorTextColor,this.TextBGColor=Oi.CorssCursorBGColor,this.TextHeight=20,this.LastPoint,this.PointX,this.PointY,this.StringFormatX,this.StringFormatY,this.IsShowCorss=!0,this.IsShow=!0,this.GetVol=function(t,e){if(!this.Data)return null;var a=e?this.Data.Asks:this.Data.Bids;if(!a||!Array.isArray(a)||a.length<=0)return null;for(var i in a){var r=a[i];if(r.Price==t)return r.Vol}return null},this.Draw=function(){if(this.Status=0,this.LastPoint&&this.Data&&this.IsShow){var t=this.LastPoint.X,e=this.LastPoint.Y,a=!1;if(this.Canvas.beginPath(),this.Canvas.rect(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetTop(),this.Frame.ChartBorder.GetWidth(),this.Frame.ChartBorder.GetHeight()),a=this.Canvas.isPointInPath(t,e),this.PointY=null,this.PointY,a&&!0!==this.Frame.IsHScreen){var i=this.Frame.ChartBorder.GetLeft(),r=this.Frame.ChartBorder.GetRight(),n=this.Frame.ChartBorder.GetTopTitle(),s=this.Frame.ChartBorder.GetBottom(),o=(this.Frame.ChartBorder.Right,this.Frame.ChartBorder.GetChartWidth(),this.Frame.GetXData(t)),h=this.Frame.GetXFromPrice(o);if(h){var l=this.GetVol(h.Price,h.IsAsk);if(e=this.Frame.GetYFromData(l),h.Vol=l,h.Y=e,this.PointY=[[i,e],[r,e]],this.PointX=[[t,n],[t,s]],this.IsShowCorss){h.IsAsk?this.Canvas.strokeStyle=this.AskColor:this.Canvas.strokeStyle=this.BidColor;var u=this.Canvas.lineWidth,C=U();this.Canvas.lineWidth=this.LineWidth*C;var D=this.Canvas.lineWidth;if(1==this.HPenType||0==this.HPenType){0==this.HPenType&&this.Canvas.setLineDash(this.LineDash);var f=$(D,e);this.Canvas.beginPath(),this.Canvas.moveTo(i,f),this.Canvas.lineTo(r,f),this.Canvas.stroke(),0==this.HPenType&&this.Canvas.setLineDash([])}0==this.VPenType&&this.Canvas.setLineDash(this.LineDash);var c=$(D,h.X);this.Canvas.beginPath(),this.Canvas.moveTo(c,n),this.Canvas.lineTo(c,s),this.Canvas.stroke(),0==this.VPenType&&this.Canvas.setLineDash([]),this.Canvas.lineWidth=u}if(this.HQChart){var d=this.HQChart.GetEventCallback(G.ON_DRAW_DEPTH_TOOLTIP);d&&d.Callback(d,h,this)}this.IsShowTooltip&&this.DrawTooltip(h)}}}},this.DrawTooltip=function(t){t.Price,t.Vol;var e=U(),a=this.Tooltip.Border;this.Canvas.font=this.Tooltip.Font;var i=2;this.Symbol&&(i=rn(this.Symbol));var r="ææ: 9999.99äº¿ ";i>=5&&(r="ææ: "+99.99.toFixed(i)+" "),this.Tooltip.Width=this.Canvas.measureText(r).width+a.Left*e,this.Tooltip.Height=this.Tooltip.LineHeight*e*4+a.Top*e+a.Bottom*e+a.Center*e;var n=this.Frame.ChartBorder.GetRight(),s=this.Frame.ChartBorder.GetTop(),o=t.X+2*e,h=t.Y-this.Tooltip.Height-2*e;o+this.Tooltip.Width>=n&&(o=t.X-this.Tooltip.Width-2*e),h<s&&(h=t.Y+2*e),this.Canvas.fillStyle=this.Tooltip.BGColor,this.Canvas.fillRect(o,h,this.Tooltip.Width,this.Tooltip.Height);var l=a.Left*e+o,u=a.Top*e+h;this.Canvas.textBaseline="top",this.Canvas.textAlign="left",this.Canvas.fillStyle=this.Tooltip.TextColor;var C=bi.GetText("Depth-Price",this.HQChart.LanguageID);this.Canvas.fillText(C,l,u),u+=this.Tooltip.LineHeight*e,this.Canvas.fillText(t.Price.toFixed(i),l,u),u+=this.Tooltip.LineHeight*e,u+=a.Center*e;C=bi.GetText("Depth-Sum",this.HQChart.LanguageID);this.Canvas.fillText(C,l,u),u+=this.Tooltip.LineHeight*e,this.Canvas.fillText(t.Vol.toFixed(4),l,u)},this.PtInButton=function(t,e){return null}}function Ia(){this.Frame,this.Canvas,this.Font=Oi.DefaultTextFont,this.TextColor=Oi.DefaultTextColor,this.IsEnableSplash=!1,this.SplashTitle="æ°æ®å è½½ä¸­",this.HQChart,this.EnableSplash=function(t){if(this.IsEnableSplash=t,this.HQChart){var e=this.HQChart.GetEventCallback(G.ON_ENABLE_SPLASH_DRAW);if(e){var a={Enable:t};e.Callback(e,a,this)}}},this.SetTitle=function(t){this.SplashTitle=t},this.Draw=function(){if(this.IsEnableSplash)if(!0!==this.Frame.IsHScreen){var t=(this.Frame.ChartBorder.GetLeft()+this.Frame.ChartBorder.GetRight())/2,e=(this.Frame.ChartBorder.GetTop()+this.Frame.ChartBorder.GetBottom())/2;this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.font=this.Font,this.Canvas.fillText(this.SplashTitle,t,e)}else this.HScreenDraw()},this.HScreenDraw=function(){var t=(this.Frame.ChartBorder.GetLeft()+this.Frame.ChartBorder.GetRight())/2,e=(this.Frame.ChartBorder.GetTop()+this.Frame.ChartBorder.GetBottom())/2;this.Canvas.save(),this.Canvas.translate(t,e),this.Canvas.rotate(90*Math.PI/180),this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextColor,this.Canvas.font=this.Font,this.Canvas.fillText(this.SplashTitle,0,0),this.Canvas.restore()}}function pa(){this.Data,this.Value,this.Text,this.Operator=function(){return!1},this.GetMultiDayBeforeOpenData=function(){if(!this.MultiDayBeforeOpenData||!ha.IsNonEmptyArray(this.MultiDayBeforeOpenData))return null;if(this.DayOffset||this.MultiDayBeforeOpenData,!ha.IsNumber(this.DayOffset.Offset)||!ha.IsNumber(this.DayOffset.ShowDayCount))return null;var t=this.DayOffset.ShowDayCount,e=this.DayOffset.Offset,a=this.MultiDayBeforeOpenData.slice(e,e+t);return a},this.GetMultiDayAfterCloseData=function(){if(!this.MultiDayAfterCloseData||!ha.IsNonEmptyArray(this.MultiDayAfterCloseData))return null;if(this.DayOffset||this.MultiDayAfterCloseData,!ha.IsNumber(this.DayOffset.Offset)||!ha.IsNumber(this.DayOffset.ShowDayCount))return null;var t=this.DayOffset.ShowDayCount,e=this.DayOffset.Offset,a=this.MultiDayAfterCloseData.slice(e,e+t);return a}}ha.FormatValueThousandsString=function(t,e){if(null==t||isNaN(t)){if(e>0){for(var a="-.",i=0;i<e;++i)a+="-";return a}return"--"}var r="",n=t.toFixed(e);if(e>0){var s=n.split(".")[1],o=n.split(".")[0];while(o.length>3)r=","+o.slice(-3)+r,o=o.slice(0,o.length-3);o&&(r=o+r+"."+s)}else{while(n.length>3)r=","+n.slice(-3)+r,n=n.slice(0,n.length-3);n&&(r=n+r)}return r},ha.FormatValueString=function(t,e,a){if(null==t||isNaN(t)){if(e>0){for(var i="-.",r=0;r<e;++r)i+="-";return i}return"--"}if(t<1e-11&&t>-1e-11)return"0";var n=Math.abs(t);return a===Ri.LANGUAGE_ENGLISH_ID?n<1e4?t.toFixed(e):n<1e6?(t/1e3).toFixed(e)+"K":n<1e9?(t/1e6).toFixed(e)+"M":n<1e12?(t/1e9).toFixed(e)+"B":(t/1e12).toFixed(e)+"T":a===Ri.LANGUAGE_TRADITIONAL_CHINESE_ID?n<1e4?t.toFixed(e):n<1e8?(t/1e4).toFixed(e)+"è¬":n<1e12?(t/1e8).toFixed(e)+"å":(t/1e12).toFixed(e)+"è¬å":n<1e4?t.toFixed(e):n<1e6||n<1e8?(t/1e4).toFixed(e)+"ä¸":n<1e12?(t/1e8).toFixed(e)+"äº¿":(t/1e12).toFixed(e)+"ä¸äº¿"},ha.FormatVolString=function(t,e){var a=Math.abs(t);return a<1e5?a.toFixed(0):a<1e7?(t/1e4).toFixed(1)+"ä¸":a<1e8?(t/1e4).toFixed(0)+"ä¸":a<1e9?(t/1e8).toFixed(2)+"äº¿":a<1e12?(t/1e8).toFixed(1)+"äº¿":(t/1e12).toFixed(1)+"ä¸äº¿"},ha.FromatIntegerString=function(t,e,a){return t<1e4&&ha.IsInteger(t)&&(e=0),ha.FormatValueString(t,e,a)},ha.NumberToString=function(t){return t<10?"0"+t.toString():t.toString()},ha.FormatDateString=function(t,e,a){var i=parseInt(t/1e4),r=parseInt(t/100)%100,n=t%100;switch(e){case"MM-DD":return ha.NumberToString(r)+"-"+ha.NumberToString(n);case"YYYY-MM":return i+"-"+ha.NumberToString(r);case"YYYY/MM/DD":return i.toString()+"/"+ha.NumberToString(r)+"/"+ha.NumberToString(n);case"YYYY/MM/DD/W":var s=new Date(i,r-1,n),o=bi.GetText(ya[s.getDay()],a);return i.toString()+"/"+ha.NumberToString(r)+"/"+ha.NumberToString(n)+"/"+o.toString();case"DD/MM/YYYY":return ha.NumberToString(n)+"/"+ha.NumberToString(r)+"/"+i.toString();default:return i.toString()+"-"+ha.NumberToString(r)+"-"+ha.NumberToString(n)}},ha.FormatTimeString=function(t,e){if("HH:MM:SS"==e){var a=parseInt(t/1e4),i=parseInt(t%1e4/100),r=t%100;return ha.NumberToString(a)+":"+ha.NumberToString(i)+":"+ha.NumberToString(r)}if("hh:mm"==e){a=parseInt(t/1e4),i=parseInt(t%1e4/100),r=t%100;return ha.NumberToString(a)+":"+ha.NumberToString(i)}if("HH:MM"==e){a=parseInt(t/100),i=t%100;return ha.NumberToString(a)+":"+ha.NumberToString(i)}if(t<1e4){a=parseInt(t/100),i=t%100;return ha.NumberToString(a)+":"+ha.NumberToString(i)}a=parseInt(t/1e4),i=parseInt(t%1e4/100),r=t%100;return ha.NumberToString(a)+":"+ha.NumberToString(i)+":"+ha.NumberToString(r)},ha.FormatReportDateString=function(t){var e,a=parseInt(t/1e4),i=parseInt(t/100)%100;switch(i){case 3:e="ä¸å­£åº¦æ¥";break;case 6:e="åå¹´æ¥";break;case 9:e="ä¸å­£åº¦æ¥";break;case 12:e="å¹´æ¥";break}return a.toString()+e},ha.FormatDateTimeString=function(t,e,a){var i=t.split(" ");if(i.length<2)return"";var r="";if(e){var n=parseInt(i[0]),s=parseInt(n/1e4),o=parseInt(n%1e4/100),h=n%100,l=s.toString()+"-"+(o<10?"0"+o.toString():o.toString())+"-"+(h<10?"0"+h.toString():h.toString());r+=l}if(a){var u=parseInt(i[1]),C=u%100,D=parseInt(u/100);l=(D<10?"0"+D.toString():D.toString())+":"+(C<10?"0"+C.toString():C.toString());r.length>0&&(r+=" "),r+=l}return r},ha.FormatValueColor=function(t,e){return null!=t&&null==e?0==t?"PriceNull":t>0?"PriceUp":"PriceDown":null==t||null==e||t==e?"PriceNull":t>e?"PriceUp":"PriceDown"},ha.IsNumber=function(t){return null!=t&&!isNaN(t)},ha.IsPlusNumber=function(t){return null!=t&&(!isNaN(t)&&t>0)},ha.IsInteger=function(t){return"number"===typeof t&&t%1===0},ha.IsObjectExist=function(t){return void 0!==t&&null!=t},ha.IsBool=function(t){return!0===t||!1===t},ha.IsString=function(t){var e="undefined"===typeof t?"undefined":(0,d.default)(t);return"string"==e},ha.IsNonEmptyArray=function(t){return!!t&&(!!Array.isArray(t)&&t.length>0)},ha.IsFloat=function(t){return void 0!==t&&(null!=t&&(!isNaN(t)&&t!=parseInt(t)))},ha.RemoveZero=function(t){while(t.length>0){var e=t.length-1,a=t[e];if("0"!=a){if("."==a){t=t.substr(0,e);break}break}t=t.substr(0,e)}return t};var Ta=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10];function ga(){this.newMethod=pa,this.newMethod(),delete this.newMethod,this.Symbol,this.FrameID,this.Frame,this.LanguageID=Ri.LANGUAGE_CHINESE_ID,this.YClose,this.PercentageText,this.RValue,this.RText,this.Point,this.ClientPos=-1,this.ExtendChartPaint,this.RExtendText=[],this.BeforeOpenData,this.AfterCloseData,this.MultiDayBeforeOpenData,this.MultiDayAfterCloseData,this.ShareAfterVol=0,this.PriceFormatType=0,this.DataFormatType=0,this.GetBeforeOpen=function(){if(!this.Frame)return!1;var t=this.Frame.SubFrame[this.FrameID];if(!t||!t.Frame)return!1;var e={Max:this.BeforeOpenData.VolMax,Min:this.BeforeOpenData.VolMin},a=this.Frame.IsHScreen?this.Point.X:this.Point.Y,i=t.Frame.GetLeftExtendYData(a,!1,{Range:e}),r=2;ha.IsNumber(i)&&(this.RText=this.Text=ha.FormatValueString(i,r,this.LanguageID))},this.GetAfterClose=function(){if(!this.Frame)return!1;var t=this.Frame.SubFrame[this.FrameID];if(!t||!t.Frame)return!1;var e={Max:this.AfterCloseData.VolMax,Min:this.AfterCloseData.VolMin},a=this.Frame.IsHScreen?this.Point.X:this.Point.Y,i=t.Frame.GetRightExtendYData(a,!1,{Range:e}),r=2;ha.IsNumber(i)&&(this.RText=this.Text=ha.FormatValueString(i,r,this.LanguageID))},this.GetMultiDayBeforeOpen=function(){if(!this.Frame)return!1;var t=this.Frame.SubFrame[this.FrameID];if(!t||!t.Frame)return!1;var e=this.GetMultiDayBeforeOpenData();if(e&&ha.IsNonEmptyArray(e)){var a=this.ClientPos-200;if(a<0||a>=e.length)return!1;var i=e[a],r={Max:i.VolMax,Min:i.VolMin},n=this.Frame.IsHScreen?this.Point.X:this.Point.Y,s=t.Frame.GetLeftExtendYData(n,!1,{Range:r}),o=2;ha.IsNumber(s)&&(this.RText=this.Text=ha.FormatValueString(s,o,this.LanguageID))}},this.GetMultiDayAfterClose=function(){if(!this.Frame)return!1;var t=this.Frame.SubFrame[this.FrameID];if(!t||!t.Frame)return!1;var e=this.GetMultiDayAfterCloseData();if(e&&ha.IsNonEmptyArray(e)){var a=this.ClientPos-300;if(a<0||a>=e.length)return!1;var i=e[a],r={Max:i.VolMax,Min:i.VolMin},n=this.Frame.IsHScreen?this.Point.X:this.Point.Y,s=t.Frame.GetRightExtendYData(n,!1,{Range:r}),o=2;ha.IsNumber(s)&&(this.RText=this.Text=ha.FormatValueString(s,o,this.LanguageID))}},this.Operator=function(){if(this.RText=null,this.RExtendText=[],ha.IsString(this.RValue)&&(this.RText=this.RValue),!this.Value)return!1;this.PercentageText=null;var t=2;if(0==this.FrameID){t=rn(this.Symbol);1==this.PriceFormatType?this.Text=ha.FormatValueThousandsString(this.Value,t):this.Text=this.Value.toFixed(t),this.YClose>0&&(this.PercentageText=(100*(this.Value-this.YClose)/this.YClose).toFixed(2)),this.GetExtendPaintData(t)}else 1==this.FrameID?(1==this.DataFormatType?(this.Text=ha.FormatValueThousandsString(this.Value,t),ha.IsNumber(this.RValue)&&(this.RText=ha.FormatValueString(this.RValue,t,this.LanguageID))):(this.Text=ha.FormatValueString(this.Value,t,this.LanguageID),ha.IsNumber(this.RValue)&&(this.RText=ha.FormatValueString(this.RValue,t,this.LanguageID))),2==this.ClientPos?this.GetBeforeOpen():3==this.ClientPos?0!=this.ShareAfterVol&&2!=this.ShareAfterVol||this.GetAfterClose():this.ClientPos>=200&&this.ClientPos<=299?this.GetMultiDayBeforeOpen():this.ClientPos>=300&&this.ClientPos<=399&&(0!=this.ShareAfterVol&&2!=this.ShareAfterVol||this.GetMultiDayAfterClose())):1==this.DataFormatType?this.Text=ha.FormatValueThousandsString(this.Value,t):this.Text=ha.FormatValueString(this.Value,t,this.LanguageID);return!0},this.GetExtendPaintData=function(t){var e=parseInt(this.Value*Ta[t]);for(var a in this.ExtendChartPaint){var i=this.ExtendChartPaint[a];if("DepthMapPaint"==i.ClassName&&i.FrameID==this.FrameID){var r=i.GetYValueByXValue(e,t);for(var n in r)this.RExtendText.push(r[n])}}}}function xa(){this.newMethod=pa,this.newMethod(),delete this.newMethod,this.DateFormatType=0,this.LanguageID=0,this.Operator=function(){if(!ha.IsNumber(this.Value))return!1;if(!this.Data)return!1;var t=this.Value;if(t=parseInt(t.toFixed(0)),this.Data.DataOffset+t>=this.Data.Data.length)return!1;var e=this.Data.Data[this.Data.DataOffset+t],a="YYYY-MM-DD";if(1==this.DateFormatType?a="YYYY/MM/DD":2==this.DateFormatType?a="YYYY/MM/DD/W":3==this.DateFormatType&&(a="DD/MM/YYYY"),this.Text=ha.FormatDateString(e.Date,a,this.LanguageID),Ot.IsMinutePeriod(this.Data.Period,!0)){var i=ha.FormatTimeString(e.Time);this.Text=this.Text+"  "+i}else if(Ot.IsSecondPeriod(this.Data.Period)){i=ha.FormatTimeString(e.Time,"HH:MM:SS");this.Text=this.Text+"  "+i}else if(Ot.IsTickPeriod(this.Data.Period)){i=ha.FormatTimeString(e.Time);this.Text=this.Text+"  "+i}return!0}}function Fa(){this.newMethod=pa,this.newMethod(),delete this.newMethod,this.Frame,this.Symbol,this.Point,this.ClientPos=-1,this.BeforeOpenData,this.AfterCloseData,this.MultiDayBeforeOpenData,this.MultiDayAfterCloseData,this.GetBeforeOpen=function(){if(!this.BeforeOpenData||!this.BeforeOpenData.Data)return!1;var t=1==this.Frame.IsHScreen?this.Point.Y:this.Point.X,e=this.Frame.GetLeftExtendXData(t,this.BeforeOpenData);if(e=parseInt(e.toFixed(0)),e>=this.BeforeOpenData.Data.length)return!1;var a=this.BeforeOpenData.Data[e];return this.Text=this.FormatCallAcutionDateTime(a,this.BeforeOpenData),!0},this.GetAfterClose=function(){if(!this.AfterCloseData||!this.AfterCloseData.Data)return!1;var t=1==this.Frame.IsHScreen?this.Point.Y:this.Point.X,e=this.Frame.GetRightExtendXData(t,this.AfterCloseData);if(e=parseInt(e.toFixed(0)),e>=this.AfterCloseData.Data.length)return!1;var a=this.AfterCloseData.Data[e];return this.Text=this.FormatCallAcutionDateTime(a,this.AfterCloseData),!0},this.GetMultiDayBeforeOpen=function(){var t=this.GetMultiDayBeforeOpenData();if(!t)return!1;if(this.Frame.ChartBorder.MultiDayMinute.Count<=1||this.Frame.ChartBorder.MultiDayMinute.Left<=0)return!1;var e=1==this.Frame.IsHScreen?this.Point.Y:this.Point.X,a=this.Frame.GetLeftExtendXData(e,t);if(!a)return!1;if(a.DayIndex>=t.length)return!1;var i=t[a.DayIndex];if(a.DataIndex=parseInt(a.DataIndex.toFixed(0)),a.DataIndex>=i.Data.length)return!1;var r=i.Data[a.DataIndex];return this.Text=this.FormatCallAcutionDateTime(r,i),!0},this.GetMultiDayAfterClose=function(){var t=this.GetMultiDayAfterCloseData();if(!t)return!1;if(this.Frame.ChartBorder.MultiDayMinute.Count<=1||this.Frame.ChartBorder.MultiDayMinute.Right<=0)return!1;var e=1==this.Frame.IsHScreen?this.Point.Y:this.Point.X,a=this.Frame.GetRightExtendXData(e,t);if(!a)return!1;if(a.DayIndex>=t.length)return!1;var i=t[a.DayIndex];if(a.DataIndex=parseInt(a.DataIndex.toFixed(0)),a.DataIndex>=i.Data.length)return!1;var r=i.Data[a.DataIndex];return this.Text=this.FormatCallAcutionDateTime(r,i),!0},this.FormatCallAcutionDateTime=function(t,e){var a=t.Time;return 1==e.Ver?ha.FormatTimeString(a,"HH:MM"):ha.FormatTimeString(a,"HH:MM:SS")},this.Operator=function(){if(2==this.ClientPos)return this.GetBeforeOpen();if(3==this.ClientPos)return this.GetAfterClose();if(this.ClientPos>=200&&this.ClientPos<=299)return this.GetMultiDayBeforeOpen();if(this.ClientPos>=300&&this.ClientPos<=399)return this.GetMultiDayAfterClose();if(!ha.IsNumber(this.Value))return!1;var t=Math.abs(this.Value);t=parseInt(t.toFixed(0));var e=t;this.Frame&&this.Frame.MinuteCount&&(e=t%this.Frame.MinuteCount);var a=Jr,i=a.GetTimeData(this.Symbol);if(!i)return!1;e<0?e=0:e>i.length&&(e=i.length-1),this.Frame&&t>=this.Frame.XPointCount&&(e=i.length-1);var r=i[e];return this.Text=ha.FormatTimeString(r),!0}}var ya=["æ¥","ä¸","äº","ä¸","å","äº","å­"];function La(){this.newMethod=pa,this.newMethod(),delete this.newMethod,this.Symbol,this.UpColor=Oi.UpTextColor,this.DownColor=Oi.DownTextColor,this.UnchagneColor=Oi.UnchagneTextColor,this.VolColor=Oi.Title.VolColor,this.AmountColor=Oi.Title.AmountColor,this.TurnoverRateColor=Oi.Title.TurnoverRateColor,this.PositionColor=Oi.Title.PositionColor,this.LanguageID=Ri.LANGUAGE_CHINESE_ID,this.LineCount=0,this.LineHeight=Oi.PCTooltip.LineHeight,this.Width=157,this.Height=5*this.LineHeight,this.Operator=function(){var t=this.Value.Data;if(!t)return!1;this.Width=157,this.LanguageID==Ri.LANGUAGE_ENGLISH_ID&&(this.Width=180);var e=new Date(parseInt(t.Date/1e4),t.Date/100%100-1,t.Date%100),a=ha.FormatDateString(t.Date),i=bi.GetText(ya[e.getDay()],this.LanguageID),r=Ot.IsTickPeriod(this.Value.ChartPaint.Data.Period);Ot.IsMinutePeriod(this.Value.ChartPaint.Data.Period,!0)?i=ha.FormatTimeString(t.Time):(Ot.IsSecondPeriod(this.Value.ChartPaint.Data.Period)||r)&&(i=ha.FormatTimeString(t.Time,"HH:MM:SS"));var n=this.Symbol.toUpperCase(),s=rn(this.Symbol),o=null;if(t.YClose>0&&(o=(t.Close-t.YClose)/t.YClose*100),r){var h="<span class='tooltip-title'>"+a+"&nbsp&nbsp"+i+"</span><span class='tooltip-con'>"+bi.GetText("DivTooltip-Price",this.LanguageID)+"</span><span class='tooltip-num' style='color:"+this.GetColor(t.Open,t.YClose)+";'>"+t.Open.toFixed(s)+"</span><br/><span class='tooltip-con'>"+bi.GetText("DivTooltip-Increase",this.LanguageID)+"</span>"+(null==o?"<span class='tooltip-num' style='color:"+this.GetColor(0,0)+";'>--</span><br/>":"<span class='tooltip-num' style='color:"+this.GetColor(o,0)+";'>"+o.toFixed(2)+"%</span><br/>");this.LineCount=4}else{var l=t.Vol;n&&Br.IsSHSZ(n)&&(l/=100);h="<span class='tooltip-title'>"+a+"&nbsp&nbsp"+i+"</span><span class='tooltip-con'>"+bi.GetText("DivTooltip-Open",this.LanguageID)+"</span><span class='tooltip-num' style='color:"+this.GetColor(t.Open,t.YClose)+";'>"+t.Open.toFixed(s)+"</span><br/><span class='tooltip-con'>"+bi.GetText("DivTooltip-High",this.LanguageID)+"</span><span class='tooltip-num' style='color:"+this.GetColor(t.High,t.YClose)+";'>"+t.High.toFixed(s)+"</span><br/><span class='tooltip-con'>"+bi.GetText("DivTooltip-Low",this.LanguageID)+"</span><span class='tooltip-num' style='color:"+this.GetColor(t.Low,t.YClose)+";'>"+t.Low.toFixed(s)+"</span><br/><span class='tooltip-con'>"+bi.GetText("DivTooltip-Close",this.LanguageID)+"</span><span class='tooltip-num' style='color:"+this.GetColor(t.Close,t.YClose)+";'>"+t.Close.toFixed(s)+"</span><br/><span class='tooltip-con'>"+bi.GetText("DivTooltip-Vol",this.LanguageID)+"</span><span class='tooltip-num' style='color:"+this.VolColor+";'>"+ha.FormatValueString(l,2,this.LanguageID)+"</span><br/><span class='tooltip-con'>"+bi.GetText("DivTooltip-Amount",this.LanguageID)+"</span><span class='tooltip-num' style='color:"+this.AmountColor+";'>"+ha.FormatValueString(t.Amount,2,this.LanguageID)+"</span><br/><span class='tooltip-con'>"+bi.GetText("DivTooltip-Increase",this.LanguageID)+"</span>"+(null==o?"<span class='tooltip-num' style='color:"+this.GetColor(0,0)+";'>--</span><br/>":"<span class='tooltip-num' style='color:"+this.GetColor(o,0)+";'>"+o.toFixed(2)+"%</span><br/>");if(this.LineCount=8,Br.IsSHSZStockA(this.Symbol)&&t.FlowCapital>0){var u=t.Vol/t.FlowCapital*100;h+="<span class='tooltip-con'>"+bi.GetText("DivTooltip-Exchange",this.LanguageID)+"</span><span class='tooltip-num' style='color:"+this.TurnoverRateColor+";'>"+u.toFixed(2)+"%</span><br/>",++this.LineCount}if(Br.IsFutures(n)&&ha.IsNumber(t.Position)&&(h+="<span class='tooltip-con'>"+bi.GetText("DivTooltip-Position",this.LanguageID)+"</span><span class='tooltip-num' style='color:"+this.PositionColor+";'>"+t.Position+"</span><br/>",++this.LineCount),"Overlay-KLine"==this.Value.ChartPaint.Name){var C="<span style='color:rgb(0,0,0);font:å¾®è½¯éé»;font-size:12px;text-align:center;display: block;'>"+this.Value.ChartPaint.Title+"</span>";h=C+h,++this.LineCount}}return this.Text=h,this.Height=this.LineCount*this.LineHeight,!0},this.GetColor=function(t,e){return t>e?this.UpColor:t<e?this.DownColor:this.UnchagneColor}}function Ea(){this.newMethod=pa,this.newMethod(),delete this.newMethod,this.UpColor=Oi.UpTextColor,this.DownColor=Oi.DownTextColor,this.UnchagneColor=Oi.UnchagneTextColor,this.Width=500,this.Operator=function(){if(!this.Value)return!1;var t=this.Value.Data.Data,e=this.Value.Data.Type,a="";for(var i in t){var r=t[i],n="";switch(e){case Mt.BLOCKTRADING:n=this.BlockTradingFormat(r);break;case Mt.TRADEDETAIL:n=this.TradeDetailFormat(r);break;case Mt.RESEARCH:n=this.ResearchFormat(r);break;case Mt.PFORECAST:n=this.PerformanceForecastFormat(r);break;default:n=this.DefaultFormat(r);break}a+=n}var s="<div class='title-length'>"+a+"</div>";if(t.length>8){var o="<div class='total-list'>å±"+t.length+"æ¡</div>";s+=o}return this.Text=s,!0},this.DefaultFormat=function(t){var e=ha.FormatDateString(t.Date),a="<span>"+e+"&nbsp;&nbsp;&nbsp;"+t.Title+"</span>";return a},this.BlockTradingFormat=function(t){var e=t.ExtendData,a=ha.FormatDateString(t.Date),i="<span><i class='date-tipbox'>"+a+"</i>&nbsp;&nbsp;<i class='tipBoxTitle'>æäº¤ä»·:&nbsp;"+e.Price.toFixed(2)+"</i><i class='tipBoxTitle'>æ¶çä»·:&nbsp;"+e.ClosePrice.toFixed(2)+"</i><br/><i class='rate-discount tipBoxTitle'>æº¢æä»·ç:&nbsp;<strong style='color:"+this.GetColor(e.Premium.toFixed(2))+"'>"+e.Premium.toFixed(2)+"%</strong></i><i class='tipBoxTitle'>æäº¤é(ä¸è¡):&nbsp;"+e.Vol.toFixed(2)+"</i></span>";return i},this.TradeDetailFormat=function(t){var e=t.ExtendData.Detail,a=ha.FormatDateString(t.Date),i=[];for(var r in e)i+="<i>"+e[r].TypeExplain+"</i><br/>";var n="<span><i class='trade-time'>"+a+"&nbsp;&nbsp;&nbsp;ä¸æ¦åå :&nbsp;&nbsp;</i><i class='reason-list'>"+i+"</i><br/><i class='trade-detall'>ä¸å¨åæ¶¨å¹:&nbsp;<strong style='color:"+this.GetColor(t.ExtendData.FWeek.Week1.toFixed(2))+"'>"+t.ExtendData.FWeek.Week1.toFixed(2)+"%</strong>&nbsp;&nbsp;&nbsp;åå¨åæ¶¨å¹:&nbsp;<strong style='color:"+this.GetColor(t.ExtendData.FWeek.Week4.toFixed(2))+";'>"+t.ExtendData.FWeek.Week4.toFixed(2)+"%</strong></i></span>";return n},this.ResearchFormat=function(t){var e=t.ExtendData.Level,a="";if(0==e.length)a="<i>ä¸è¬è°ç </i>";else{for(var i in e)0==e[i]?a+="<i style='color:#00a0e9'>è¯å¸ä»£è¡¨&nbsp;&nbsp;&nbsp;</i>":1==e[i]?a+="<i>è£ç§&nbsp;&nbsp;&nbsp;</i>":2==e[i]?a+="<i style='color:#00a0e9'>æ»ç»ç&nbsp;&nbsp;&nbsp;</i>":3==e[i]&&(a+="<i style='color:#00a0e9'>è£äºé¿&nbsp;&nbsp;&nbsp;</i>");a="æ¥å¾:&nbsp;&nbsp;&nbsp;"+a}var r="";t.ExtendData.Type&&"å¶ä»"!=t.ExtendData.Type&&(r="&nbsp;&nbsp;&nbsp;<i>"+t.ExtendData.Type+"</i>",0==e.length&&(a=""));var n=ha.FormatDateString(t.Date),s="<span>"+n+"&nbsp;&nbsp;&nbsp;"+r+a+"</span>";return s},this.PerformanceForecastFormat=function(t){var e,a=t.ExtendData.ReportDate,i=parseInt(a/1e4),r=a%1e4;1231==r?e="å¹´æ¥":331==r?e="ä¸å­£åº¦æ¥":630==r?e="åå¹´åº¦æ¥":930==r&&(e="ä¸å­£åº¦æ¥");var n="";t.ExtendData.FWeek&&(null!=t.ExtendData.FWeek.Week1&&(n+="ä¸å¨åæ¶¨å¹:<i class='increase' style='color:"+this.GetColor(t.ExtendData.FWeek.Week1.toFixed(2))+"'>"+t.ExtendData.FWeek.Week1.toFixed(2)+"%</i>"),null!=t.ExtendData.FWeek.Week4&&(n+="&nbsp;åå¨åæ¶¨å¹:<i class='increase' style='color:"+this.GetColor(t.ExtendData.FWeek.Week4.toFixed(2))+"'>"+t.ExtendData.FWeek.Week4.toFixed(2)+"%</i>"),n.length>0&&(n="<br/>&nbsp;&nbsp;<i class='prorecast-week'>"+n+"</i>"));var s=ha.FormatDateString(t.Date),o="<span>"+s+"&nbsp;&nbsp;"+i+e+t.Title+"&nbsp;"+n+"</span>";return o},this.GetColor=function(t){return t>0?this.UpColor:t<0?this.DownColor:this.UnchagneColor}}function Ma(){this.newMethod=pa,this.newMethod(),delete this.newMethod,this.Width=120,this.Operator=function(){var t=this.Value.Data;if(!t)return!1;var e,a=t.Data,i="<span class='tooltip-index-name'>"+a.Name+a.Param+":</span>";return e=1==a.Type?"<span class='tooltip-index-buy'>ä¹°å¥</span>":"<span class='tooltip-index-sell'>ååº</span>",this.Text=i+e,!0}}function Aa(){this.newMethod=pa,this.newMethod(),delete this.newMethod,this.Width=200,this.Operator=function(){var t=this.Value.Data;if(!t)return!1;var e=t.Data.Item,a=ha.FormatTimeString(e.Time),i="<span class='tooltip-minuteinfo-time'>"+a+" </span>",r="<span class='tooltip-minuteinfo-content'>"+e.Title+"</span>";return e.Content&&(r="<span class='tooltip-minuteinfo-content'>"+e.Content+"</span>"),this.Text=i+r,!0}}function Na(){this.newMethod=pa,this.newMethod(),delete this.newMethod,this.Width=200,this.Operator=function(){if(!this.Value||!this.Value.Data)return!1;var t=this.Value.Data;return!!t.Item&&(!!t.Item.Text&&(this.Text=t.Item.Text,!0))}}function wa(){this.newMethod=pa,this.newMethod(),delete this.newMethod,this.Width=200,this.Period=0,this.Operator=function(){var t=this.Value.Data;if(!t||!t.Data)return!1;if(Ot.IsDayPeriod(this.Period,!0)){var e=ha.FormatDateString(t.Data.Start.Date),a=ha.FormatDateString(t.Data.End.Date);if(e==a)return this.Text="<span class='tooltip-minuteinfo-content'>"+e+"</span>",!0;var i="<span class='tooltip-minuteinfo-content'>èµ·å§æ¶é´:"+e+"</span>",r="<span class='tooltip-minuteinfo-content'>ç»ææ¶é´:"+a+"</span>";return this.Text=i+"<br>"+r,!0}if(Ot.IsMinutePeriod(this.Period,!0)){e=ha.FormatDateString(t.Data.Start.Date);var n=ha.FormatTimeString(t.Data.Start.Time,"HH:MM"),s=(a=ha.FormatDateString(t.Data.End.Date),ha.FormatTimeString(t.Data.End.Time,"HH:MM"));i="<span class='tooltip-minuteinfo-content'>èµ·å§æ¶é´:"+e+" "+n+"</span>",r="<span class='tooltip-minuteinfo-content'>ç»ææ¶é´:"+a+" "+s+"</span>";return this.Text=i+"<br>"+r,!0}return!1}}function Oa(){this.DataMap=new E.default([["KLineTradeDataStringFormat",{Create:function(){return new Ma}}],["MinuteInfoDataStringFormat",{Create:function(){return new Aa}}],["HistoryDataStringFormat",{Create:function(){return new La}}],["KLineInfoDataStringFormat",{Create:function(){return new Ea}}],["IconDataStringFormat",{Create:function(){return new Na}}],["ChartOXDataStringFormat",{Create:function(){return new wa}}],["CorssCursor_XStringFormat",{Create:function(){return new xa}}],["CorssCursor_YStringFormat",{Create:function(){return new ga}}]]),this.Create=function(t){if(!this.DataMap.has(t))return null;var e=this.DataMap.get(t);return e.Create()}}var Ra=new Oa;function Pa(){this.Frame,this.Data=new Array,this.Canvas,this.IsDynamic=!1,this.Position=0,this.CursorIndex,this.LastPoint,this.Font=Oi.TitleFont,this.Title,this.TitleColor=Oi.DefaultTextColor,this.ClassName="IChartTitlePainting",this.DrawStatus,this.GetEventCallback,this.ReloadResource=function(){this.Font=Oi.TitleFont,this.TitleColor=Oi.DefaultTextColor}}var ba=["ä¸å¤æ","åå¤æ","åå¤æ"];function Ba(){this.newMethod=Pa,this.newMethod(),delete this.newMethod,this.ClassName="DynamicKLineTitlePainting",this.IsDynamic=!0,this.IsShow=!0,this.Period,this.UpColor=Oi.UpTextColor,this.DownColor=Oi.DownTextColor,this.UnchagneColor=Oi.UnchagneTextColor,this.VolColor=Oi.Title.VolColor,this.AmountColor=Oi.Title.AmountColor,this.DateTimeColor=Oi.Title.DateTimeColor,this.NameColor=Oi.Title.NameColor,this.SettingColor=Oi.Title.SettingColor,this.TurnoverRateColor=Oi.Title.TurnoverRateColor,this.PositionColor=Oi.Title.PositionColor,this.Symbol,this.Name,this.SpaceWidth=2*U(),this.OverlayChartPaint,this.IsShowName=!0,this.IsShowSettingInfo=!0,this.IsShowDateTime=!0,this.LanguageID=Ri.LANGUAGE_CHINESE_ID,this.OnDrawEvent,this.OnMouseMoveEvent,this.ReloadResource=function(){this.Font=Oi.TitleFont,this.TitleColor=Oi.DefaultTextColor,this.UpColor=Oi.UpTextColor,this.DownColor=Oi.DownTextColor,this.UnchagneColor=Oi.UnchagneTextColor,this.VolColor=Oi.Title.VolColor,this.AmountColor=Oi.Title.AmountColor,this.DateTimeColor=Oi.Title.DateTimeColor,this.NameColor=Oi.Title.NameColor,this.SettingColor=Oi.Title.SettingColor,this.TurnoverRateColor=Oi.Title.TurnoverRateColor,this.PositionColor=Oi.Title.PositionColor},this.GetCurrentKLineData=function(){if(null==this.CursorIndex||!this.Data)return null;if(this.Data.length<=0)return null;var t=this.CursorIndex;t=parseInt(t.toFixed(0));var e=this.Data.DataOffset+t;if(e>=this.Data.Data.length&&(e=this.Data.Data.length-1),e<0)return null;var a=this.Data.Data[e];return a},this.DrawItem=function(t){var e=!0===this.Frame.IsHScreen,a=this.Frame.ChartBorder.GetLeft(),i=this.Frame.ChartBorder.GetTop()-this.Frame.ChartBorder.Top/2,r=(this.Frame.ChartBorder.GetRight(),rn(this.Symbol)),n=this.Symbol.toUpperCase();if(e){if(this.Frame.ChartBorder.Right<5)return;a=2,i=this.Frame.ChartBorder.Right/2,this.Frame.ChartBorder.GetHeight();var s=this.Frame.ChartBorder.GetChartWidth(),o=this.Frame.ChartBorder.GetTop();this.Canvas.translate(s,o),this.Canvas.rotate(90*Math.PI/180)}else if(this.Frame.ChartBorder.Top<5*U())return;this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.font=this.Font;var h={Left:a,Bottom:i,IsHScreen:e};if(!this.IsShowName||this.DrawText(this.Name,this.NameColor,h)){if(this.IsShowSettingInfo){var l="";l=this.Data.Period>bt&&this.Data.Period<=Bt?this.Data.Period-bt+bi.GetText("èªå®ä¹åé",this.LanguageID):this.Data.Period>Rt&&this.Data.Period<=Pt?this.Data.Period-Rt+bi.GetText("èªå®ä¹æ¥çº¿",this.LanguageID):this.Data.Period>Vt&&this.Data.Period<=Gt?this.Data.Period-Vt+bi.GetText("èªå®ä¹ç§",this.LanguageID):bi.GetText(Ot.GetPeriodName(this.Data.Period),this.LanguageID);var u=bi.GetText(ba[this.Data.Right],this.LanguageID),C="("+l+" "+u+")";if(Br.IsEnableRight(this.Data.Period,this.Symbol)||(C="("+l+")"),!this.DrawText(C,this.SettingColor,h))return}if(this.IsShowDateTime){C=ha.FormatDateString(t.Date);if(!this.DrawText(C,this.DateTimeColor,h))return}var D=Ot.IsTickPeriod(this.Period);if(Ot.IsMinutePeriod(this.Period,!0)&&ha.IsNumber(t.Time)){C=ha.FormatTimeString(t.Time);if(!this.DrawText(C,this.DateTimeColor,h))return}else if(Ot.IsSecondPeriod(this.Period)&&ha.IsNumber(t.Time)){C=ha.FormatTimeString(t.Time,"HH:MM:SS");if(!this.DrawText(C,this.DateTimeColor,h))return}else if(D){C=ha.FormatTimeString(t.Time,"HH:MM:SS");if(!this.DrawText(C,this.DateTimeColor,h))return}if(D){var f=this.GetColor(t.Open,t.YClose);C=bi.GetText("KTitle-Price",this.LanguageID)+t.Open.toFixed(r);if(!this.DrawText(C,f,h))return;if(t.YClose>0){var c=(t.Close-t.YClose)/t.YClose*100;f=this.GetColor(c,0),C=bi.GetText("KTitle-Increase",this.LanguageID)+c.toFixed(2)+"%";if(!this.DrawText(C,f,h))return}}else{f=this.GetColor(t.Open,t.YClose),C=bi.GetText("KTitle-Open",this.LanguageID)+t.Open.toFixed(r);if(this.DrawText(C,f,h)){f=this.GetColor(t.High,t.YClose),C=bi.GetText("KTitle-High",this.LanguageID)+t.High.toFixed(r);if(this.DrawText(C,f,h)){f=this.GetColor(t.Low,t.YClose),C=bi.GetText("KTitle-Low",this.LanguageID)+t.Low.toFixed(r);if(this.DrawText(C,f,h)){f=this.GetColor(t.Close,t.YClose),C=bi.GetText("KTitle-Close",this.LanguageID)+t.Close.toFixed(r);if(this.DrawText(C,f,h)){if(t.YFClose>0&&Br.IsChinaFutures(n)){c=(t.Close-t.YFClose)/t.YFClose*100,f=this.GetColor(c,0),C=bi.GetText("KTitle-Increase",this.LanguageID)+c.toFixed(2)+"%";if(!this.DrawText(C,f,h))return}else if(t.YClose>0){c=(t.Close-t.YClose)/t.YClose*100,f=this.GetColor(c,0),C=bi.GetText("KTitle-Increase",this.LanguageID)+c.toFixed(2)+"%";if(!this.DrawText(C,f,h))return}var d=t.Vol;n&&Br.IsSHSZ(n)&&(d/=100);C=bi.GetText("KTitle-Vol",this.LanguageID)+ha.FromatIntegerString(d,2,this.LanguageID);if(this.DrawText(C,this.VolColor,h)){if(ha.IsNumber(t.Amount)){C=bi.GetText("KTitle-Amount",this.LanguageID)+ha.FormatValueString(t.Amount,2,this.LanguageID);if(!this.DrawText(C,this.AmountColor,h))return}if(Br.IsSHSZStockA(this.Symbol)&&t.FlowCapital>0){c=t.Vol/t.FlowCapital*100,C=bi.GetText("KTitle-Exchange",this.LanguageID)+ha.FormatValueString(c,2,this.LanguageID)+"%";if(!this.DrawText(C,this.TurnoverRateColor,h))return}if(Br.IsFutures(n)&&ha.IsNumber(t.Position)){C=bi.GetText("KTitle-Position",this.LanguageID)+t.Position;if(!this.DrawText(C,this.PositionColor,h))return}for(var m in this.OverlayChartPaint){t=this.OverlayChartPaint[m];if(t.Symbol&&t.Title){var v=t.Title,S=t.Color;C="["+v+"]";if(!this.DrawText(C,S,h))return}}}}}}}}}},this.Draw=function(){if(this.IsShow)if(null==this.CursorIndex||!this.Data||this.Data.length<=0)this.OnDrawEventCallback(null);else{this.Canvas.font=this.Font,this.SpaceWidth=this.Canvas.measureText("0").width;var t=this.CursorIndex;t=parseInt(t.toFixed(0));var e=this.Data.DataOffset+t;if(e>=this.Data.Data.length&&(e=this.Data.Data.length-1),e<0)this.OnDrawEventCallback(null);else{var a=this.Data.Data[e];this.OnDrawEventCallback(a),this.Canvas.save(),this.DrawItem(a),this.Canvas.restore()}}},this.OnDrawEventCallback=function(t){var e=this.OnDrawEvent&&this.OnDrawEvent.Callback,a=this.OnMouseMoveEvent&&this.OnMouseMoveEvent.Callback;if(e||a){var i={Draw:t,Name:this.ClassName};if(this.Data&&this.Data.Data){var r=Math.abs(this.CursorIndex);r=parseInt(r.toFixed(0));var n=this.Data.DataOffset+r,s=this.Data.Data.length;i.DataIndex=n,i.DataCount=s}if(ha.IsNonEmptyArray(this.OverlayChartPaint)){i.OverlayStock=[];for(var o=0;o<this.OverlayChartPaint.length;++o){var h=this.OverlayChartPaint[o];h.Symbol&&h.Title&&i.OverlayStock.push({Symbol:h.Symbol,Name:h.Title})}}e&&this.OnDrawEvent.Callback(this.OnDrawEvent,i,this),a&&this.OnMouseMoveEvent.Callback(this.OnMouseMoveEvent,i,this)}},this.GetColor=function(t,e){return t>e?this.UpColor:t<e?this.DownColor:this.UnchagneColor},this.DrawText=function(t,e,a){if(!t)return!0;var i=!0===this.Frame.IsHScreen,r=this.Frame.ChartBorder.GetRight();i&&(r=this.Frame.ChartBorder.GetHeight()),this.Canvas.fillStyle=e;var n=this.Canvas.measureText(t).width;return!(a.Left+n>r)&&(this.IsShow&&this.Canvas.fillText(t,a.Left,a.Bottom,n),a.Left+=n+this.SpaceWidth,!0)}}function Va(){this.newMethod=Ba,this.newMethod(),delete this.newMethod,this.ClassName="DynamicMinuteTitlePainting",this.SpaceWidth=1*U(),this.YClose,this.IsShowDate=!1,this.IsShowTime=!0,this.IsShowName=!0,this.IsShowAveragePrice=!0,this.OverlayChartPaint,this.LanguageID=Ri.LANGUAGE_CHINESE_ID,this.LastShowData,this.OnDrawEvent,this.PointInfo=null,this.IsAlwaysShowLastData=!1,this.ShowLastDataFormat=0,this.MultiDayBeforeOpenData,this.MultiDayAfterCloseData,this.GetCurrentKLineData=function(){if(this.LastShowData)return this.LastShowData;if(null==this.CursorIndex||!this.Data)return null;if(this.Data.length<=0)return null;var t=Math.abs(this.CursorIndex);t=parseInt(t.toFixed(0));var e=this.Data.DataOffset+t;if(e>=this.Data.Data.length&&(e=this.Data.Data.length-1),e<0)return null;var a=this.Data.Data[e];return a},this.GetLatestKLineData=function(t){var e=null,a=1;if(ha.IsNonEmptyArray(this.MultiDayBeforeOpenData)){var i=this.MultiDayBeforeOpenData[this.MultiDayBeforeOpenData.length-1];i&&ha.IsNonEmptyArray(i.Data)&&(a=i.Ver,e=i.Data[i.Data.length-1])}else this.BeforeOpenData&&ha.IsNonEmptyArray(this.BeforeOpenData.Data)&&(e=this.BeforeOpenData.Data[this.BeforeOpenData.Data.length-1],a=this.BeforeOpenData.Ver);var r=null,n=1;if(ha.IsNonEmptyArray(this.MultiDayAfterCloseData)){i=this.MultiDayAfterCloseData[this.MultiDayAfterCloseData.length-1];i&&ha.IsNonEmptyArray(i.Data)&&(n=i.Ver,r=i.Data[i.Data.length-1])}else this.AfterOpenData&&ha.IsNonEmptyArray(this.AfterOpenData.Data)&&(r=this.AfterOpenData.Data[this.AfterOpenData.Data.length-1],n=this.AfterOpenData.Ver);var s=null;if(this.Data&&ha.IsNonEmptyArray(this.Data.Data)){var o=this.Data.Data.length;s=this.Data.Data[o-1]}return e||r||s?t?s?e&&s&&e.Date>s.Date?{Type:2,Data:e,Ver:a}:r&&s&&r.Date>=s.Date?{Type:1,Data:r,Ver:n}:{Type:0,Data:s}:{Type:1,Data:e,Ver:a}:s:null},this.DrawItem=function(t,e){if(t){var a=!0===this.Frame.IsHScreen,i=this.Frame.GetBorder(),r=i.Left,n=i.Top-this.Frame.ChartBorder.Top/2,s=rn(this.Symbol);if(a){if(this.Frame.ChartBorder.Right<5)return;r=2,n=this.Frame.ChartBorder.Right/2;var o=i.ChartWidth,h=i.Top;this.Canvas.translate(o,h),this.Canvas.rotate(90*Math.PI/180)}else if(this.Frame.ChartBorder.Top<5)return;this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.font=this.Font;var l={Left:r,Bottom:n,IsHScreen:a};if(!this.IsShowName||this.DrawText(this.Name,this.NameColor,l)){if(this.IsShowDate||this.IsShowTime){var u=!1;if(e&&1==this.ShowLastDataFormat&&this.Data&&this.Data.UpdateTime&&ha.IsNumber(this.Data.UpdateTime.Date)&&ha.IsNumber(this.Data.UpdateTime.Time)){var C=ha.FormatTimeString(this.Data.UpdateTime.Time,"HH:MM:SS");if(!this.DrawText(C,this.DateTimeColor,l))return;u=!0}if(!u){C=ha.FormatDateTimeString(t.DateTime,this.IsShowDate,this.IsShowTime);if(!this.DrawText(C,this.DateTimeColor,l))return}}var D=t.Close,f=t.Increase,c=t.Vol,d=t.Amount;if(t.Before&&(D=t.Before.Close,f=t.Before.Increase,c=t.Before.Vol,d=t.Before.Amount),D){var m=this.GetColor(D,this.YClose);C=bi.GetText("MTitle-Close",this.LanguageID)+D.toFixed(s);if(!this.DrawText(C,m,l))return}if(null!=f){m=this.GetColor(f,0),C=bi.GetText("MTitle-Increase",this.LanguageID)+f.toFixed(2)+"%";if(!this.DrawText(C,m,l))return}var v=!0,S=this.Symbol.toUpperCase();if((Br.IsET(S)&&!Br.IsETShowAvPrice(S)||Br.IsShowAvPrice&&!Br.IsShowAvPrice(S))&&(v=!1),t.AvPrice&&v&&this.IsShowAveragePrice){m=this.GetColor(t.AvPrice,this.YClose),C=bi.GetText("MTitle-AvPrice",this.LanguageID)+t.AvPrice.toFixed(s);if(!this.DrawText(C,m,l))return}C=bi.GetText("MTitle-Vol",this.LanguageID)+ha.FromatIntegerString(c,2,this.LanguageID);if(this.DrawText(C,this.VolColor,l)){if(ha.IsNumber(d)){C=bi.GetText("MTitle-Amount",this.LanguageID)+ha.FormatValueString(d,2,this.LanguageID);if(!this.DrawText(C,this.AmountColor,l))return}if(ha.IsNumber(t.Position)){C=bi.GetText("MTitle-Position",this.LanguageID)+ha.FromatIntegerString(t.Position,2,this.LanguageID);if(!this.DrawText(C,this.VolColor,l))return}if(e&&0==this.ShowLastDataFormat&&this.Data&&this.Data.UpdateTime&&ha.IsNumber(this.Data.UpdateTime.Date)&&ha.IsNumber(this.Data.UpdateTime.Time)){C=bi.GetText("MTitle-UpdateTime",this.LanguageID)+ha.FormatTimeString(this.Data.UpdateTime.Time,"HH:MM:SS");if(!this.DrawText(C,this.DateTimeColor,l))return}for(var I in this.OverlayChartPaint){t=this.OverlayChartPaint[I];if(t.Symbol&&t.Title){var p=t.Title,T=t.Color;C="["+p+"]";if(!this.DrawText(C,T,l))return}}}}}},this.DrawCallAuction=function(){var t=!0===this.Frame.IsHScreen,e=this.Frame.GetBorder(),a=e.Left,i=e.Top-this.Frame.ChartBorder.Top/2,r=rn(this.Symbol),n=!0;if(t){a=2,i=this.Frame.ChartBorder.Right/2;var s=e.ChartWidth,o=e.Top;this.Canvas.translate(s,o),this.Canvas.rotate(90*Math.PI/180)}else this.Frame.ChartBorder.Top<5&&(n=!1);this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.font=this.Font;var h={Left:a,Bottom:i,IsHScreen:t};if(!n||!this.IsShowName||this.DrawText(this.Name,this.NameColor,h)){var l,u=1;if(2==this.PointInfo.ClientPos){if(!this.BeforeOpenData)return;if(!this.CallAcutionXOperator)return;this.CallAcutionXOperator.Value=t?this.PointInfo.Point.Y:this.PointInfo.Point.X,this.CallAcutionXOperator.Point={X:this.PointInfo.Point.X,Y:this.PointInfo.Point.Y},this.CallAcutionXOperator.ClientPos=this.PointInfo.ClientPos;var C={Explain:"BeforeOpen",Data:null,DataIndex:null,DataTotalCount:this.BeforeOpenData.TotalCount};if(!this.CallAcutionXOperator.Operator())return this.OnDrawCallAuctionEventCallback(C),!1;C.DataIndex=this.CallAcutionXOperator.DataIndex;var D=this.CallAcutionXOperator.Item,f=D.Time;l=1==this.BeforeOpenData.Ver?ha.FormatTimeString(f,"HH:MM"):ha.FormatTimeString(f,"HH:MM:SS"),u=this.BeforeOpenData.Ver,C.Data=D}else if(3==this.PointInfo.ClientPos){if(!this.AfterCloseData)return;if(!this.CallAcutionXOperator)return;this.CallAcutionXOperator.Value=t?this.PointInfo.Point.Y:this.PointInfo.Point.X,this.CallAcutionXOperator.Point={X:this.PointInfo.Point.X,Y:this.PointInfo.Point.Y},this.CallAcutionXOperator.ClientPos=this.PointInfo.ClientPos;C={Explain:"AfterClose",Data:null,DataIndex:null,DataTotalCount:this.AfterCloseData.TotalCount};if(!this.CallAcutionXOperator.Operator())return this.OnDrawCallAuctionEventCallback(C),!1;C.DataIndex=this.CallAcutionXOperator.DataIndex;D=this.CallAcutionXOperator.Item,f=D.Time;l=1==this.AfterCloseData.Ver?ha.FormatTimeString(f,"HH:MM"):ha.FormatTimeString(f,"HH:MM:SS"),u=this.AfterCloseData.Ver,C.Data=D}else if(this.PointInfo.ClientPos>=200&&this.PointInfo.ClientPos<=299){if(!this.MultiDayBeforeOpenData||!ha.IsNonEmptyArray(this.MultiDayBeforeOpenData))return;var c=1==this.Frame.IsHScreen?this.PointInfo.Point.Y:this.PointInfo.Point.X;this.CallAcutionXOperator.Value=c,this.CallAcutionXOperator.Point={X:this.PointInfo.Point.X,Y:this.PointInfo.Point.Y},this.CallAcutionXOperator.ClientPos=this.PointInfo.ClientPos;C={Explain:"MultiDayBeforeOpen",Data:null,DataIndex:null};if(!this.CallAcutionXOperator.Operator())return this.OnDrawCallAuctionEventCallback(C),!1;C.DataIndex=this.CallAcutionXOperator.DataIndex,C.DayIndex=this.CallAcutionXOperator.DayIndex;var d=this.MultiDayBeforeOpenData[this.CallAcutionXOperator.DayIndex];D=this.CallAcutionXOperator.Item,f=D.Time;l=1==d.Ver?ha.FormatTimeString(f,"HH:MM"):ha.FormatTimeString(f,"HH:MM:SS");var m=ha.FormatDateString(D.Date);l=m+" "+l,u=d.Ver,C.Data=D}else{if(!(this.PointInfo.ClientPos>=300&&this.PointInfo.ClientPos<=399))return;if(!this.MultiDayAfterCloseData||!ha.IsNonEmptyArray(this.MultiDayAfterCloseData))return;c=1==this.Frame.IsHScreen?this.PointInfo.Point.Y:this.PointInfo.Point.X;this.CallAcutionXOperator.Value=c,this.CallAcutionXOperator.Point={X:this.PointInfo.Point.X,Y:this.PointInfo.Point.Y},this.CallAcutionXOperator.ClientPos=this.PointInfo.ClientPos;C={Explain:"MultiDayAfterClose",Data:null,DataIndex:null};if(!this.CallAcutionXOperator.Operator())return this.OnDrawCallAuctionEventCallback(C),!1;C.DataIndex=this.CallAcutionXOperator.DataIndex,C.DayIndex=this.CallAcutionXOperator.DayIndex;d=this.MultiDayAfterCloseData[this.CallAcutionXOperator.DayIndex],D=this.CallAcutionXOperator.Item,f=D.Time;l=1==d.Ver?ha.FormatTimeString(f,"HH:MM"):ha.FormatTimeString(f,"HH:MM:SS");m=ha.FormatDateString(D.Date);l=m+" "+l,u=d.Ver,C.Data=D}if(!(n&&this.IsShowTime&&l)||this.DrawText(l,this.DateTimeColor,h)){if(n&&D&&ha.IsNumber(D.Price)){var v=this.GetColor(D.Price,this.YClose),S="MTitle-AC-Price";this.BeforeOpenData&&1==this.BeforeOpenData.Ver&&(S="MTitle-Close");var I=bi.GetText(S,this.LanguageID)+D.Price.toFixed(r);if(!this.DrawText(I,v,h))return}if(n&&D&&ha.IsPlusNumber(this.YClose)&&ha.IsNumber(D.Price)){var p=(D.Price-this.YClose)/this.YClose*100;v=this.GetColor(p,0),S="MTitle-AC-Increase";this.BeforeOpenData&&1==this.BeforeOpenData.Ver&&(S="MTitle-Increase");I=bi.GetText(S,this.LanguageID)+p.toFixed(2)+"%";if(!this.DrawText(I,v,h))return}if(3==u&&n&&D&&ha.IsNumber(D.AvPrice)){v=this.GetColor(D.Price,this.YClose),I=bi.GetText("MTitle-AC-AvPrice",this.LanguageID)+D.AvPrice.toFixed(r);if(!this.DrawText(I,v,h))return}if(n&&ha.IsNumber(D.Vol[0])){S="MTitle-AC-Vol";this.BeforeOpenData&&1==this.BeforeOpenData.Ver&&(S="MTitle-Vol");I=bi.GetText(S,this.LanguageID)+ha.FromatIntegerString(D.Vol[0],2);if(!this.DrawText(I,this.VolColor,h))return}if(n&&ha.IsNumber(D.Vol[1])){I=bi.GetText("MTitle-AC-NotMatchVol",this.LanguageID)+ha.FromatIntegerString(D.Vol[1],2);if(!this.DrawText(I,this.VolColor,h))return}this.OnDrawCallAuctionEventCallback(C)}}},this.OnDrawCallAuctionEventCallback=function(t){if(this.OnDrawEvent&&this.OnDrawEvent.Callback){var e={Draw:t,Name:this.ClassName};this.OnDrawEvent.Callback(this.OnDrawEvent,e,this)}if(this.OnMouseMoveEvent&&this.OnMouseMoveEvent.Callback){e={Draw:t,Name:this.ClassName};this.OnMouseMoveEvent.Callback(this.OnDrawEvent,e,this)}},this.Draw=function(){if(this.LastShowData=null,!this.IsShow){var t=this.OnDrawEvent&&this.OnDrawEvent.Callback||this.OnMouseMoveEvent&&this.OnMouseMoveEvent.Callback;if(!t)return}if(this.PointInfo&&(2==this.PointInfo.ClientPos||3==this.PointInfo.ClientPos||this.PointInfo.ClientPos>=200&&this.PointInfo.ClientPos<=299||this.PointInfo.ClientPos>=300&&this.PointInfo.ClientPos<=399))return this.Canvas.save(),this.DrawCallAuction(),void this.Canvas.restore();if(null==this.CursorIndex||!this.Data||!this.Data.Data||this.Data.Data.length<=0)return this.OnDrawEventCallback(null),void(this.IsAlwaysShowLastData&&(this.Canvas.save(),this.DrawLastDataItem(),this.Canvas.restore()));this.Canvas.font=this.Font,this.SpaceWidth=this.Canvas.measureText("0").width;var e=!1;if(this.DrawStatus&&this.DrawStatus.IsTitleShowLatestData){var a=this.DrawStatus;(!ha.IsNumber(a.FrameID)||a.FrameID<0||a.CorssCursorTouchEnd&&0==a.IsOnTouch)&&(e=!0)}var i=!1;if(e){var r=null,n=this.GetLatestKLineData(!1);n&&0==n.Type&&(r=n.Data),i=!0}else{var s=this.CursorIndex;s=parseInt(s.toFixed(0));var o=s+this.Data.DataOffset;o>=this.Data.Data.length&&(o=this.Data.Data.length-1);r=this.Data.Data[o];o==this.Data.Data.length-1&&(i=!0)}this.LastShowData=r,this.Canvas.save(),this.OnDrawEventCallback(r),this.IsAlwaysShowLastData?this.DrawLastDataItem():this.DrawItem(r,i),this.Canvas.restore()},this.DrawCallAuctionItem=function(t,e){if(t){var a=t.Data,i=t.Ver,r=!0===this.Frame.IsHScreen,n=this.Frame.GetBorder(),s=n.Left,o=n.Top-this.Frame.ChartBorder.Top/2,h=rn(this.Symbol),l=!0;if(r){s=2,o=this.Frame.ChartBorder.Right/2;var u=n.ChartWidth,C=n.Top;this.Canvas.translate(u,C),this.Canvas.rotate(90*Math.PI/180)}else this.Frame.ChartBorder.Top<5&&(l=!1);this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.font=this.Font;var D={Left:s,Bottom:o,IsHScreen:r};if(!l||!this.IsShowName||this.DrawText(this.Name,this.NameColor,D)){var f,c=a.Time;f=1==i?ha.FormatTimeString(c,"HH:MM"):ha.FormatTimeString(c,"HH:MM:SS");var d=ha.FormatDateString(a.Date);if(f=d+" "+f,!(l&&this.IsShowTime&&f)||this.DrawText(f,this.DateTimeColor,D)){if(l&&a&&ha.IsNumber(a.Price)){var m=this.GetColor(a.Price,this.YClose),v="MTitle-AC-Price";this.BeforeOpenData&&1==this.BeforeOpenData.Ver&&(v="MTitle-Close");var S=bi.GetText(v,this.LanguageID)+a.Price.toFixed(h);if(!this.DrawText(S,m,D))return}if(l&&a&&ha.IsPlusNumber(this.YClose)&&ha.IsNumber(a.Price)){var I=(a.Price-this.YClose)/this.YClose*100;m=this.GetColor(I,0),v="MTitle-AC-Increase";this.BeforeOpenData&&1==this.BeforeOpenData.Ver&&(v="MTitle-Increase");S=bi.GetText(v,this.LanguageID)+I.toFixed(2)+"%";if(!this.DrawText(S,m,D))return}if(3==i&&l&&a&&ha.IsNumber(a.AvPrice)){m=this.GetColor(a.Price,this.YClose),S=bi.GetText("MTitle-AC-AvPrice",this.LanguageID)+a.AvPrice.toFixed(h);if(!this.DrawText(S,m,D))return}if(l&&ha.IsNumber(a.Vol[0])){v="MTitle-AC-Vol";this.BeforeOpenData&&1==this.BeforeOpenData.Ver&&(v="MTitle-Vol");S=bi.GetText(v,this.LanguageID)+ha.FromatIntegerString(a.Vol[0],2);if(!this.DrawText(S,this.VolColor,D))return}if(l&&ha.IsNumber(a.Vol[1])){S=bi.GetText("MTitle-AC-NotMatchVol",this.LanguageID)+ha.FromatIntegerString(a.Vol[1],2);if(!this.DrawText(S,this.VolColor,D))return}}}}},this.DrawLastDataItem=function(){var t=this.GetLatestKLineData(!0);t&&(0==t.Type?this.DrawItem(t.Data,!0):1!=t.Type&&2!=t.Type||this.DrawCallAuctionItem(t,!0))}}var Ga={DEFAULT:1,ORIGINAL:2,INTEGER:3,THOUSANDS:21};function Ha(t,e,a){this.Data=t,this.Name=e,this.Color=a,this.DataType,this.ChartClassName,this.StringFormat=Ga.DEFAULT,this.FloatPrecision=2,this.IsShow=!0,this.Callback}function Ya(){this.newMethod=Pa,this.newMethod(),delete this.newMethod,this.ClassName="DynamicChartTitlePainting",this.IsDynamic=!0,this.Data=[],this.Explain,this.ColorIndex,this.IsShowColorIndexTitle=!0,this.IsShowUpDownArrow=!0,this.IsShowIndexName=!0,this.IsShowIndexTitle=!0,this.TradeIndex,this.IsShowTradeIndexTitle=!0,this.OverlayIndex=new E.default,this.IsShowOverlayIndexName=!0,this.OverlayIndexType={Position:0,LineSpace:5,BGColor:Oi.OverlayIndexTitleBGColor},this.LanguageID=Ri.LANGUAGE_CHINESE_ID,this.TitleRect,this.IsDrawTitleBG=!1,this.BGColor=Oi.IndexTitleBGColor,this.OnDrawEvent,this.ParamSpace=2,this.TitleSpace=2,this.TitleColor=Oi.IndexTitleColor,this.SelectedColor=Oi.IndexTitleSelectedColor,this.IsKLineFrame=!1,this.Identify,this.SelectedChart,this.DynamicTitle={OutName:null,OutValue:null},this.OverlayDynamicTitle=new E.default,this.ReloadResource=function(){this.Font=Oi.TitleFont,this.TitleColor=Oi.DefaultTextColor,this.OverlayIndexType.BGColor=Oi.OverlayIndexTitleBGColor},this.SetDynamicTitleData=function(t,e,a){a.OutName?a.OutName.clear():a.OutName=new E.default,a.OutValue?a.OutValue.clear():a.OutValue=new E.default;var i=new E.default;for(var r in e){var n=e[r];i.set("{"+n.Name+"}",n)}for(var r in t){n=t[r];if(n.DynamicName){var s=n.DynamicName.match(/{\w*}/i);if(!s||s.length<=0)a.OutName.set(n.Name,n.DynamicName);else{for(var o=n.DynamicName,h=!0,l=0;l<s.length;++l){var u=s[l];if(!i.has(u)){h=!1;break}var C=i.get(u).Value;o=o.replace(u,C.toString())}h&&a.OutName.set(n.Name,o)}}n.DynamicValue&&a.OutValue.set(n.Name,n.DynamicValue)}},this.SetDynamicTitle=function(t,e,a){if(ha.IsString(a)){var i=null;this.OverlayDynamicTitle.has(a)?i=this.OverlayDynamicTitle.get(a):(i={OutName:null,OutValue:null},this.OverlayDynamicTitle.set(a,i)),this.SetDynamicTitleData(t,e,i)}else this.SetDynamicTitleData(t,e,this.DynamicTitle)},this.GetDynamicOutName=function(t,e){if(ha.IsString(e)){if(!this.OverlayDynamicTitle.has(e))return null;var a=this.OverlayDynamicTitle.get(e),i=a.OutName}else i=this.DynamicTitle.OutName;return!i||i.size<=0?null:i.has(t)?i.get(t):null},this.GetDynamicOutValue=function(t,e){var a=this.DynamicTitle.OutValue;if(!a||a.size<=0)return null;if(!a.has(t))return null;var i=a.get(t);return i=i.replace("{Value}",e),i},this.IsClickTitle=function(t,e){return!!this.TitleRect&&(t>this.TitleRect.Left&&t<this.TitleRect.Left+this.TitleRect.Width&&e>this.TitleRect.Top&&e<this.TitleRect.Top+this.TitleRect.Height)},this.FormatValue=function(t,e){return e.StringFormat==Ga.DEFAULT?ha.FormatValueString(t,e.FloatPrecision,this.LanguageID):e.StringFormat==Ga.THOUSANDS?ha.FormatValueThousandsString(t,e.FloatPrecision):e.StringFormat==Ga.ORIGINAL?t.toFixed(e.FloatPrecision).toString():e.StringFormat==Ga.INTEGER?ha.FromatIntegerString(t,e.FloatPrecision,this.LanguageID):void 0},this.FormatMultiReport=function(t,e){var a="";for(var i in t){var r=t[i],n=r.Quarter,s=r.Year,o=r.Value;switch(a.length>0&&(a+=","),a+=s.toString(),n){case 1:a+="ä¸å­£æ¥ ";break;case 2:a+="åå¹´æ¥ ";break;case 3:a+="ä¸å­£æ¥ ";break;case 4:a+="å¹´æ¥ ";break}a+=this.FormatValue(o,e)}return a},this.FromatMultiDataLine=function(t,e){var a="";if(Array.isArray(t))for(var i=0;i<t.length;++i){var r=t[i];if(0!=r.Type&&ha.IsNumber(r.Value)){var n=this.FormatValue(r.Value,e);a.length>0&&(a+=","),a+=n}}else 0!=t.Type&&ha.IsNumber(t.Value)&&(a=this.FormatValue(t.Value,e));return a.length<=0?null:a},this.FromatStackedBarTitle=function(t,e){if(!ha.IsNonEmptyArray(t))return null;if(!ha.IsNonEmptyArray(e.Color))return null;for(var a=[],i=0;i<t.length;++i){var r=t[i];if(ha.IsNumber(r)){var n={Text:r.toFixed(2)};e.Name&&e.Name[i]&&(n.Name=e.Name[i]),n.Color=e.Color[i],a.push(n)}}return a.length<=0?null:a},this.ForamtMultiLineTitle=function(t,e){if(!ha.IsNonEmptyArray(e.Lines))return null;for(var a=[],i=0;i<e.Lines.length;++i)for(var r=e.Lines[i],n=0;n<r.Point.length;++n){var s=r.Point[n];if(s.Index==t){s={Text:s.Value.toFixed(2)};0==a.length&&(s.Name=e.Name),s.Color=r.Color,a.push(s);break}}return ha.IsNonEmptyArray(a)?a:null},this.FormatVPVRTitle=function(t,e){var a=e.Chart,i=[];if(0==a.VolType){var r={Text:" Up/Down ",Color:this.TitleColor};i.push(r)}else{r={Text:" Total ",Color:this.TitleColor};i.push(r)}if(!ha.IsNumber(t.Y))return i;var n=this.Frame.ChartBorder.GetTopEx(),s=this.Frame.ChartBorder.GetBottomEx();if(t.Y<n||t.Y>s)return i;for(var o=this.Frame.GetYData(t.Y),h=null,l=0;l<e.Data.Data.length;++l){r=e.Data.Data[l];if(o>=r.Price-e.Data.PriceOffset/2&&o<r.Price+e.Data.PriceOffset/2){h=r;break}}if(!h)return null;if(0==a.VolType){var u=0;for(l=0;l<h.Vol.length;++l){var C=h.Vol[l];if(ha.IsNumber(C.Value)){r={Text:ha.FormatVolString(C.Value,this.LanguageID)};u+=C.Value,ha.IsNumber(C.ColorID)?r.Color=a.BarColor[C.ColorID]:C.Color&&(r.Color=C.Color),i.push(r)}}r={Text:ha.FormatVolString(u,this.LanguageID),Color:this.TitleColor};i.push(r)}else if(h.TotalVol&&ha.IsNumber(h.TotalVol.Value)){r={Text:ha.FormatVolString(h.TotalVol.Value,this.LanguageID)};ha.IsNumber(h.TotalVol.ColorID)?r.Color=a.BarColor[h.TotalVol.ColorID]:h.TotalVol.Color&&(r.Color=h.TotalVol.Color),i.push(r)}return i},this.IsShowLastData=function(){var t=!1;if(this.DrawStatus&&this.DrawStatus.IsTitleShowLatestData){var e=this.DrawStatus;(!ha.IsNumber(e.FrameID)||e.FrameID<0||e.CorssCursorTouchEnd&&0==e.IsOnTouch)&&(t=!0)}return t},this.OnDrawTitleEvent=function(){var t=this.GetEventCallback(G.ON_INDEXTITLE_DRAW);if(t){var e={Index:null,Data:this.Data,Title:this.Title,FrameID:this.Frame.Identify,OverlayIndex:this.OverlayIndex};if(ha.IsNumber(this.CursorIndex)){var a=Math.abs(this.CursorIndex);a=parseInt(a.toFixed(0)),e.Index=a}var i=U(),r=this.Frame.GetBorder();e.Left=r.LeftEx/i,e.Top=r.Top/i,e.Right=r.RightEx/i,t.Callback(t,e,this)}},this.IsSelectedChart=function(t){return!!t&&(!!this.SelectedChart&&(!!this.SelectedChart.Selected&&this.SelectedChart.Selected.Identify==t))},this.Draw=function(){if(!this.Frame.IsMinSize&&(this.IsKLineFrame="KLineFrame"==this.Frame.ClassName||"KLineHScreenFrame"==this.Frame.ClassName,this.IsDrawTitleBG=this.Frame.IsDrawTitleBG,this.IsShowUpDownArrow=this.Frame.IsShowTitleArraw,this.IsShowIndexName=this.Frame.IsShowIndexName,this.IsShowOverlayIndexName=this.Frame.IsShowOverlayIndexName,this.OverlayIndexType.Position=this.Frame.OverlayIndexType.Position,this.OverlayIndexType.LineSpace=this.Frame.OverlayIndexType.LineSpace,this.ParamSpace=this.Frame.IndexParamSpace,this.TitleSpace=this.Frame.IndexTitleSpace,this.TitleRect=null,this.OnDrawTitleEvent(),0!=this.Frame.IsShowIndexTitle&&null!=this.CursorIndex&&this.Data&&!(this.Frame.ChartBorder.TitleHeight<5))){if(!0===this.Frame.IsHScreen)return this.Canvas.save(),this.HScreenDraw(),void this.Canvas.restore();var t=this.Frame.ChartBorder.GetLeft()+1,e=this.Frame.ChartBorder.GetTop()+this.Frame.ChartBorder.TitleHeight/2,a=this.Frame.ChartBorder.GetRight();if(this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.font=this.Font,this.Title&&this.IsShowIndexName){var i=this.Canvas.measureText(this.Title).width+2;if(this.IsDrawTitleBG){var r=2*U();this.Canvas.fillStyle=this.BGColor,this.TitleRect={Left:t,Top:this.Frame.ChartBorder.GetTop()+r,Width:i,Height:this.Frame.ChartBorder.TitleHeight-2*r},this.Canvas.fillRect(this.TitleRect.Left,this.TitleRect.Top,this.TitleRect.Width,this.TitleRect.Height)}this.Canvas.fillStyle=this.TitleColor,this.Canvas.fillText(this.Title,t,e,i),this.IsSelectedChart(this.Identify)&&this.DrawSelectedLine(t,e,i),t+=i,t+=this.TitleSpace}var n=this.IsShowLastData(),s=this.Frame.GetLockRect();if(s){var o=Math.abs(this.CursorIndex);this.IsKLineFrame&&(o=this.CursorIndex);var h=this.Frame.GetXFromIndex(o.toFixed(0));if(h>=s.Left)return;if(n)return}for(var l=0;l<this.Data.length;++l){var u=this.Data[l],C=this.GetTitleItem(u,n);if(C){var D=C.Text,f=C.ArrayText;if(f)for(var c=0;c<f.length;++c){var d=f[c];v=d.Name?d.Name+":"+d.Text:d.Text;var m=this.ParamSpace*U();i=this.Canvas.measureText(v).width+m;if(t+i>a)break;this.Canvas.fillStyle=d.Color,this.Canvas.fillText(v,t,e,i),t+=i}else{this.Canvas.fillStyle=u.Color;var v=D;if(u.Name){var S=this.GetDynamicOutName(u.Name);v=S?S+":"+D:u.Name+":"+D}m=this.ParamSpace*U(),i=this.Canvas.measureText(v).width+m;if(t+i>a)break;this.Canvas.fillText(v,t,e,i),t+=i}}}if(this.Explain){this.Canvas.fillStyle=this.TitleColor;v="è¯´æ:"+this.Explain,i=this.Canvas.measureText(v).width+2;t+i<a&&(this.Canvas.fillText(v,t,e,i),t+=i)}if(this.ColorIndex&&this.IsShowColorIndexTitle){this.Canvas.fillStyle=Oi.Title.ColorIndexColor;var I=this.ColorIndex.Name+this.ColorIndex.Param;i=this.Canvas.measureText(I).width+2;this.Canvas.fillText(I,t,e,i),t+=i}if(this.TradeIndex&&this.IsShowTradeIndexTitle){this.Canvas.fillStyle=Oi.Title.TradeIndexColor;I=this.TradeIndex.Name+this.TradeIndex.Param,i=this.Canvas.measureText(I).width+2;this.Canvas.fillText(I,t,e,i),t+=i}1==this.OverlayIndexType.Position?this.DrawOverlayIndexSingleLine():this.DrawOverlayIndex(t+10*U())}},this.GetTitleItem=function(t,e){if(!t||!t.Data||!t.Data.Data)return null;if(t.Data.Data.length<=0)return null;if(!1===t.IsShow)return null;var a=null,i=null,r=null,n=null;if("StraightLine"==t.DataType)r=t.Data.Data[0],a=this.FormatValue(r,t);else{if("ChartVolProfileVisibleRange"==t.ChartClassName)return i=this.FormatVPVRTitle(this.LastPoint,t),i?{Text:null,ArrayText:i}:null;if(e)var s=t.Data.Data.length-1;else{var o=Math.abs(this.CursorIndex);o=parseInt(o.toFixed(0)),this.IsKLineFrame&&(o=this.CursorIndex);s=t.Data.DataOffset+o;if(s>=t.Data.Data.length&&(s=t.Data.Data.length-1),s<0)return null}if("ChartMultiLine"==t.DataType)return i=this.ForamtMultiLineTitle(s,t),i?{Text:null,ArrayText:i}:null;if(r=t.Data.Data[s],null==r&&"ChartStepLine"==t.ChartClassName){if(n=this.GetPreVaildItem(t.Data.Data,s),!n)return null;if(preText=this.FormatValue(n.Item,t),t.Name){var h=this.GetDynamicOutValue(t.Name,preText);h&&(preText=h)}return a="--("+preText+")",{Text:a,ArrayText:i}}if(null==r)return null;if("HistoryData-Vol"==t.DataType)r=r.Vol,a=this.FormatValue(r,t);else if("MultiReport"==t.DataType)a=this.FormatMultiReport(r,t);else if("MULTI_POINT_LINE"==t.DataType){if(a=this.FromatMultiDataLine(r,t),!a)return null}else{if("ChartStackedBar"==t.DataType)return i=this.FromatStackedBarTitle(r,t),i?{Text:null,ArrayText:i}:null;var l=null;if(this.IsShowUpDownArrow){var u=null;s-1>=0&&(u=t.Data.Data[s-1]),ha.IsNumber(u)&&(l=u>r?"â":u<r?"â":"â")}if(a=this.FormatValue(r,t),t.Name){h=this.GetDynamicOutValue(t.Name,a);h&&(a=h)}l&&(a+=l)}}return{Text:a,ArrayText:i}},this.GetPreVaildItem=function(t,e){for(var a=e;a>=0;--a){var i=t[a];if(i)return{Item:i,Index:a}}return null},this.DrawSelectedLine=function(t,e,a){this.Canvas.save();var i=this.GetFontHeight();this.Canvas.strokeStyle=this.SelectedColor;var r=4,n=$(r,e+i/2);this.Canvas.lineWidth=r,this.Canvas.beginPath(),this.Canvas.moveTo(t,n),this.Canvas.lineTo(t+a,n),this.Canvas.stroke(),this.Canvas.restore()},this.DrawOverlayIndexSingleLine=function(){var t=U(),e=this.Frame.GetBorder();if(!0===this.Frame.IsHScreen)var a=1,i=2*t,r=this.Frame.ChartBorder.GetHeight(),n=this.Frame.ChartBorder.GetWidthEx();else i=e.TopTitle+2*t,a=e.Left+1,r=e.Right,n=e.Bottom;var s=this.OverlayIndexType.LineSpace*t,o=a,h=i;this.Canvas.textAlign="left",this.Canvas.textBaseline="middle";var l=K(this.Canvas,this.Font,"æ");h=i+l/2;var u=!0,C=!1,D=void 0;try{for(var f,c=(0,T.default)(this.OverlayIndex);!(u=(f=c.next()).done);u=!0){p=f.value;var d=p[1],m=p[0];if(o=a,d.Title&&this.IsShowOverlayIndexName){var v=this.Canvas.measureText(d.Title).width+2;if(o+v<r){if(this.OverlayIndexType.BGColor){this.Canvas.fillStyle=this.OverlayIndexType.BGColor;var S={Left:o,Top:h-l/2,Width:v,Height:l+s};this.Canvas.fillRect(S.Left,S.Top,S.Width,S.Height)}this.IsSelectedChart(m)&&this.DrawSelectedLine(o,h,v,d.Title),this.Canvas.fillStyle=this.TitleColor,this.Canvas.fillText(d.Title,o,h,v)}o+=v}for(var I=0;I<d.Data.length;++I){var p=d.Data[I];if(p&&p.Data&&p.Data.Data&&p.Name&&!(p.Data.Data.length<=0)){var g=null,x=null,F=null;if("StraightLine"==p.DataType)g=p.Data.Data[0],x=this.FormatValue(g,p);else{var y=Math.abs(this.CursorIndex-.5);y=parseInt(y.toFixed(0)),this.IsKLineFrame&&(y=this.CursorIndex);var L=p.Data.DataOffset+y;if(L>=p.Data.Data.length&&(L=p.Data.Data.length-1),L<0)continue;if(g=p.Data.Data[L],null==g)continue;if("HistoryData-Vol"==p.DataType)g=g.Vol,x=this.FormatValue(g,p);else if("MultiReport"==p.DataType)x=this.FormatMultiReport(g,p);else if("ChartStackedBar"==p.DataType){if(F=this.FromatStackedBarTitle(g,p),!F)continue}else x=this.FormatValue(g,p)}if(F)for(var E=0;E<F.length;++E){var M=F[E];A=M.Name?M.Name+":"+M.Text:M.Text;v=this.Canvas.measureText(A).width+2;if(o+v>r)break;if(this.OverlayIndexType.BGColor){this.Canvas.fillStyle=this.OverlayIndexType.BGColor;S={Left:o,Top:h-l/2,Width:v,Height:l+s};this.Canvas.fillRect(S.Left,S.Top,S.Width,S.Height)}this.Canvas.fillStyle=M.Color,this.Canvas.fillText(A,o,h,v),o+=v}else{var A=x;if(p.Name){var N=this.GetDynamicOutName(p.Name,m);A=N?N+":"+x:p.Name+":"+x}v=this.Canvas.measureText(A).width+2;if(o+v>r)break;if(this.OverlayIndexType.BGColor){this.Canvas.fillStyle=this.OverlayIndexType.BGColor;S={Left:o,Top:h-l/2,Width:v,Height:l+s};this.Canvas.fillRect(S.Left,S.Top,S.Width,S.Height)}this.Canvas.fillStyle=p.Color,this.Canvas.fillText(A,o,h,v),o+=v}}}if(h+=l+s,h+l+s>=n)break}}catch(w){C=!0,D=w}finally{try{!u&&c.return&&c.return()}finally{if(C)throw D}}},this.DrawOverlayIndex=function(t){var e=this.Frame.ChartBorder.GetTop()+this.Frame.ChartBorder.TitleHeight/2,a=this.Frame.ChartBorder.GetRight();if(!0===this.Frame.IsHScreen&&(e=-this.Frame.ChartBorder.TitleHeight/2,a=this.Frame.ChartBorder.GetHeight()),!(t>a)){var i=5*U(),r=t,n=!0,s=!1,o=void 0;try{for(var h,l=(0,T.default)(this.OverlayIndex);!(n=(h=l.next()).done);n=!0){c=h.value,t+=i;var u=c[1],C=c[0];if(u.Title&&this.IsShowOverlayIndexName){this.Canvas.fillStyle=this.TitleColor;var D=this.Canvas.measureText(u.Title).width+2;if(r=t,t+=D,t>a)break;this.Canvas.fillText(u.Title,r,e,D),this.IsSelectedChart(C)&&this.DrawSelectedLine(r,e,D)}for(var f in u.Data){var c=u.Data[f];if(c&&c.Data&&c.Data.Data&&c.Name&&!(c.Data.Data.length<=0)){var d=null,m=null;if("StraightLine"==c.DataType)d=c.Data.Data[0],m=this.FormatValue(d,c);else{var v=Math.abs(this.CursorIndex-.5);v=parseInt(v.toFixed(0)),this.IsKLineFrame&&(v=this.CursorIndex);var S=c.Data.DataOffset+v;if(S>=c.Data.Data.length&&(S=c.Data.Data.length-1),S<0)continue;if(d=c.Data.Data[S],null==d)continue;"HistoryData-Vol"==c.DataType?(d=d.Vol,m=this.FormatValue(d,c)):m="MultiReport"==c.DataType?this.FormatMultiReport(d,c):this.FormatValue(d,c)}this.Canvas.fillStyle=c.Color;var I=c.Name+":"+m;D=this.Canvas.measureText(I).width+2;if(r=t,t+=D,t>a)break;this.Canvas.fillText(I,r,e,D)}}if(t>a)break}}catch(p){s=!0,o=p}finally{try{!n&&l.return&&l.return()}finally{if(s)throw o}}}},this.HScreenDraw=function(){var t=this.Frame.ChartBorder.GetHScreenBorder(),e=this.Frame.ChartBorder.GetRightTitle(),a=t.TopEx;this.Canvas.translate(e,a),this.Canvas.rotate(90*Math.PI/180);var i=1,r=-this.Frame.ChartBorder.TitleHeight/2,n=this.Frame.ChartBorder.GetHeight();if(this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.font=this.Font,this.Title&&this.IsShowIndexName){var s=this.Canvas.measureText(this.Title).width+2;if(this.IsDrawTitleBG){var o=2*U();this.Canvas.fillStyle=this.BGColor,this.TitleRect={Left:this.Frame.ChartBorder.GetRightTitle(),Top:t.TopEx,Width:this.Frame.ChartBorder.TitleHeight,Height:s};var h={Left:i,Top:-this.Frame.ChartBorder.TitleHeight+o,Width:s,Height:this.Frame.ChartBorder.TitleHeight-2*o};this.Canvas.fillRect(h.Left,h.Top,h.Width,h.Height)}this.Canvas.fillStyle=this.TitleColor,this.Canvas.fillText(this.Title,i,r,s),i+=s,i+=this.TitleSpace}var l=this.IsShowLastData(),u=this.Frame.GetLockRect();if(u){var C=Math.abs(this.CursorIndex-.5);this.IsKLineFrame&&(C=this.CursorIndex);var D=this.Frame.GetXFromIndex(C.toFixed(0));if(D>=u.Top)return;if(l)return}for(var f in this.Data){var c=this.Data[f],d=this.GetTitleItem(c,l);if(d){var m=d.Text,v=d.ArrayText;if(v)for(var S=0;S<v.length;++S){var I=v[S];T=I.Name?I.Name+":"+I.Text:I.Text;var p=this.ParamSpace*U();s=this.Canvas.measureText(T).width+p;if(i+s>n)break;this.Canvas.fillStyle=I.Color,this.Canvas.fillText(T,i,r,s),i+=s}else{this.Canvas.fillStyle=c.Color;var T=m;if(c.Name){var g=this.GetDynamicOutName(c.Name);T=g?g+":"+m:c.Name+":"+m}p=this.ParamSpace*U(),s=this.Canvas.measureText(T).width+p;if(i+s>n)break;this.Canvas.fillText(T,i,r,s),i+=s}}}if(this.Explain){this.Canvas.fillStyle=this.TitleColor;T="è¯´æ:"+this.Explain,s=this.Canvas.measureText(T).width+2;i+s<n&&(this.Canvas.fillText(T,i,r,s),i+=s)}1==this.OverlayIndexType.Position?this.DrawOverlayIndexSingleLine():this.DrawOverlayIndex(i+5*U())},this.OnDrawEventCallback=function(t){if(this.OnDrawEvent&&this.OnDrawEvent.Callback){var e={Draw:t,Name:"DynamicChartTitlePainting"};this.OnDrawEvent.Callback(this.OnDrawEvent,e,this)}},this.GetFontHeight=function(t){return K(this.Canvas,t,"æ")}}function ka(){this.Frame,this.Canvas,this.Point=new Array,this.Value=new Array,this.LinePoint=[],this.PointCount=2,this.Status=0,this.PointStatus=0,this.MovePointIndex=null,this.ClassName="IChartDrawPicture",this.FinishedCallback,this.Guid=q(),this.Symbol,this.Period,this.Right,this.IsSelected=!1,this.Option,this.EnableMove=!0,this.EnableSave=!0,this.IsDrawFirst=!1,this.LineColor=Oi.DrawPicture.LineColor[0],this.LineWidth=2,this.BackupLineWidth=null,this.AreaColor="rgba(25,25,25,0.4)",this.PointColor=Oi.DrawPicture.PointColor[0],this.MoveOnPointColor=Oi.DrawPicture.PointColor[1],this.PointRadius=5,this.SquareSize=8,this.PointType=Oi.DrawPicture.PointType,this.IsShowPoint=Oi.DrawPicture.IsShowPoint,this.SetLastPoint=null,this.Update=null,this.GetActiveDrawPicture=null,this.Draw=function(){},this.SetOption=function(t){t&&(t.LineColor&&(this.LineColor=t.LineColor),t.LineWidth>0&&(this.LineWidth=t.LineWidth),t.AreaColor&&(this.AreaColor=t.AreaColor),t.PointColor&&(this.PointColor=t.PointColor),t.MoveOnPointColor&&(this.SelectPointColor=t.PointColor),t.PointRadius&&(this.PointRadius=t.PointRadius),ha.IsNumber(t.SquareSize)&&(this.SquareSize=t.SquareSize),ha.IsBool(t.IsShowPoint)&&(this.IsShowPoint=t.IsShowPoint))},this.SetLineWidth=function(){this.BackupLineWidth=null,this.LineWidth>0&&(this.BackupLineWidth=this.Canvas.lineWidth,this.Canvas.lineWidth=this.LineWidth*U())},this.GetFontHeight=function(t){return K(this.Canvas,t,"æ")},this.RestoreLineWidth=function(){null!=this.BackupLineWidth&&(this.Canvas.lineWidth=this.BackupLineWidth)},this.PointToValue=function(){return!!this.Frame&&("MinuteFrame"==this.Frame.ClassName||"MinuteHScreenFrame"==this.Frame.Class?this.PointToValue_Minute():this.PointToValue_KLine())},this.PointToKLine=function(t){if(!this.Frame)return null;var e=this.Frame.Data;if(!e)return null;var a=[],i=this.Frame.IsHScreen;if(i)for(var r in t){var n=t[r],s=parseInt(this.Frame.GetXData(n.Y))+e.DataOffset,o=this.Frame.GetYData(n.X),h={XValue:s,YValue:o},l=e.Data[s];h.DateTime={Date:l.Date},ha.IsNumber(l.Time)&&(h.DateTime.Time=l.Time),a[r]=h}else for(var r in t){n=t[r];var u=parseInt(this.Frame.GetXData(n.X,!1));s=u+e.DataOffset;s<0?s=0:s>=e.Data.length&&(s=e.Data.length-1,u=s-e.DataOffset);o=this.Frame.GetYData(n.Y,!1),h={XValue:s,YValue:o,XIndex:u},l=e.Data[s];h.DateTime={Date:l.Date},ha.IsNumber(l.Time)&&(h.DateTime.Time=l.Time),a[r]=h}return a},this.PointToValue_KLine=function(){if(!this.Frame)return!1;var t=this.Frame.Data;if(!t)return!1;var e=this.Frame.IsHScreen;if(e)for(var a in this.Point){var i=this.Point[a],r=parseInt(this.Frame.GetXData(i.Y,!1))+t.DataOffset,n=this.Frame.GetYData(i.X,!1),s={XValue:r,YValue:n},o=t.Data[r];s.DateTime={Date:o.Date},ha.IsNumber(o.Time)&&(s.DateTime.Time=o.Time),this.Value[a]=s}else for(var a in this.Point){i=this.Point[a],r=parseInt(this.Frame.GetXData(i.X,!1))+t.DataOffset;r<0?r=0:r>=t.Data.length&&(r=t.Data.length-1);n=this.Frame.GetYData(i.Y,!1),s={XValue:r,YValue:n},o=t.Data[r];s.DateTime={Date:o.Date},ha.IsNumber(o.Time)&&(s.DateTime.Time=o.Time),this.Value[a]=s}return!0},this.PointToValue_Minute=function(){if(!this.Frame)return!1;var t=this.Frame.Data;if(!t)return!1;var e=this.Frame.IsHScreen;if(e)for(var a=0;a<this.Point.length;++a){var i=this.Point[a],r=parseInt(this.Frame.GetXData(i.Y)),n=this.Frame.GetYData(i.X),s={XValue:r,YValue:n},o=t.Data[r];s.DateTime={Date:o.Date,Time:o.Time},this.Value[a]=s}else{var h=Jr.GetTimeData(this.Symbol);for(a=0;a<this.Point.length;++a){i=this.Point[a],r=parseInt(this.Frame.GetXData(i.X)),n=this.Frame.GetYData(i.Y);if(r>=t.Data.length){var l=r%h.length,u=t.Data.length-1,C=(s={XValue:r,YValue:n},o=t.Data[u],h[l]);s.DateTime={Date:o.Date,Time:C},this.Value[a]=s}else{s={XValue:r,YValue:n},o=t.Data[r];s.DateTime={Date:o.Date,Time:o.Time},this.Value[a]=s}}}return!0},this.IsPointIn=function(t,e,a){return!1},this.ValueToPoint=function(){if(!this.Frame)return!1;var t=this.Frame.Data;if(!t)return!1;var e=this.Frame.IsHScreen;for(var a in this.Point=[],this.Value){var i=this.Value[a],r=new at;e?(r.Y=this.Frame.GetXFromIndex(i.XValue-t.DataOffset,!1),r.X=this.Frame.GetYFromData(i.YValue,!1)):(r.X=this.Frame.GetXFromIndex(i.XValue-t.DataOffset,!1),r.Y=this.Frame.GetYFromData(i.YValue,!1)),this.Point[a]=r}},this.UpdateXValue=function(){if(!this.Frame)return!1;var t=this.Frame.Data;if(!t)return!1;var e=[];for(var a in this.Value){var i=this.Value[a],r={Date:i.DateTime.Date};ha.IsNumber(i.DateTime.Time)&&(r.Time=i.DateTime.Time),e[a]=r}for(var a in t.FindDataIndexByDateTime(e),e){var n=e[a],s=this.Value[a];n.Index>=0&&(s.XValue=n.Index)}},this.Move=function(t,e){if(20!=this.Status)return fasle;if(!this.Frame)return!1;var a=this.Frame.Data;if(!a)return!1;if(null==this.MovePointIndex)return!1;var i=parseInt(this.MovePointIndex);if(100===i)for(var r in this.Point)this.Point[r].X+=t,this.Point[r].Y+=e;else{if(0!==i&&1!==i&&2!==i&&3!==i&&4!==i&&5!==i)return!1;i<this.Point.length&&(this.Point[i].X+=t,this.Point[i].Y+=e)}},this.ClipFrame=function(){if(this.Frame.IsHScreen)var t=this.Frame.ChartBorder.GetLeftEx(),e=this.Frame.ChartBorder.GetTop(),a=this.Frame.ChartBorder.GetWidthEx(),i=this.Frame.ChartBorder.GetHeight();else t=this.Frame.ChartBorder.GetLeft(),e=this.Frame.ChartBorder.GetTopEx(),a=this.Frame.ChartBorder.GetWidth(),i=this.Frame.ChartBorder.GetHeightEx();this.Canvas.save(),this.Canvas.beginPath(),this.Canvas.rect(t,e,a,i),this.Canvas.clip()},this.CalculateDrawPoint=function(t){if(this.Status<2)return null;if(!this.Point.length||!this.Frame)return null;var e=new Array;if(10==this.Status){var a=this.Frame.Data;if(!a)return null;for(var i=this.Frame.XPointCount,r=0,n=this.Frame.IsHScreen,s=0;s<this.Value.length;++s){var o=this.Value[s],h=o.XValue-a.DataOffset;(h<0||h>=i)&&++r;var l=new at;n?(l.Y=this.Frame.GetXFromIndex(o.XValue-a.DataOffset,!1),l.X=this.Frame.GetYFromData(o.YValue,!1)):(l.X=this.Frame.GetXFromIndex(o.XValue-a.DataOffset,!1),l.Y=this.Frame.GetYFromData(o.YValue,!1)),e.push(l)}if(t&&!0===t.IsCheckX&&r==this.Value.length)return null}else e=this.Point;return e},this.IsYValueInFrame=function(t){return!!this.Frame&&!(t>this.Frame.HorizontalMax||t<this.Frame.HorizontalMin)},this.DrawPoint=function(t){if(t&&!(t.length<=0)){var e=this.PointColor;if(this.IsShowPoint);else if(this.GetActiveDrawPicture){var a=this.GetActiveDrawPicture();if(a.Move.Guid!=this.Guid&&a.Select.Guid!=this.Guid&&a.MoveOn.Guid!=this.Guid)return;a.Select.Guid!=this.Guid&&a.MoveOn.Guid==this.Guid&&(e=this.MoveOnPointColor)}this.ClipFrame();var i=U();for(var r in this.Canvas.fillStyle=e,t){var n=t[r];if(1==this.PointType){var s=this.SquareSize*i,o=n.X-s/2,h=n.Y-s/2;this.Canvas.fillRect(o,h,s,s)}else this.Canvas.beginPath(),this.Canvas.arc(n.X,n.Y,this.PointRadius*i,0,360,!1),this.Canvas.fill(),this.Canvas.closePath()}this.Canvas.restore()}},this.CalculateExtendLinePoint=function(t,e){var a={},i=(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetRight(),this.Frame.ChartBorder.GetTopEx()),r=this.Frame.ChartBorder.GetBottom(),n=e.X-t.X,s=e.Y-t.Y;if(n>0){var o=r-t.Y,h=n*o/s,l=new at;l.X=t.X+h,l.Y=r,a.End=l;o=e.Y-i,h=n*o/s;var u=new at;u.Y=i,u.X=e.X-h,a.Start=u}else{o=r-t.Y,h=Math.abs(n)*o/s,l=new at;l.X=t.X-h,l.Y=r,a.End=l;o=e.Y-i,h=Math.abs(n)*o/s,u=new at;u.Y=i,u.X=e.X+h,a.Start=u}return a},this.CalculateExtendLineEndPoint=function(t){var e=this.Frame.ChartBorder.GetLeft(),a=this.Frame.ChartBorder.GetRight(),i=t[1].X-t[0].X,r=t[1].Y-t[0].Y;if(i>0){var n=a-t[0].X,s=n*r/i,o=s+t[0].Y,h=new at;return h.X=a,h.Y=o,h}n=t[0].X-e,s=n*r/Math.abs(i),o=s+t[0].Y,h=new at;return h.X=e,h.Y=o,h},this.IsPointInXYValue=function(t,e,a){if(!this.Frame)return-1;var i=this.Frame.Data;if(!i)return-1;if(!this.Value)return-1;var r=5;a&&ha.IsNumber(a.Zoom)?r+=a.Zoom:this.Option&&ha.IsNumber(this.Option.Zoom)&&(r+=this.Option.Zoom);var n=this.Frame.IsHScreen;r*=U();for(var s=0;s<this.Value.length;++s){var o=this.Value[s],h=new at;if(n?(h.Y=this.Frame.GetXFromIndex(o.XValue-i.DataOffset),h.X=this.Frame.GetYFromData(o.YValue)):(h.X=this.Frame.GetXFromIndex(o.XValue-i.DataOffset),h.Y=this.Frame.GetYFromData(o.YValue)),this.Canvas.beginPath(),this.Canvas.arc(h.X,h.Y,r,0,360),this.Canvas.isPointInPath(t,e))return s}return-1},this.IsPointInLine=function(t,e,a){if(!this.LinePoint)return-1;var i=5;a&&ha.IsNumber(a.Zoom)?i+=a.Zoom:this.Option&&ha.IsNumber(this.Option.Zoom)&&(i+=this.Option.Zoom);var r=U();i*=r;for(var n=0;n<this.LinePoint.length;++n){var s=this.LinePoint[n],o=s.Start,h=s.End;if(this.Canvas.beginPath(),o.X==h.X?(this.Canvas.moveTo(o.X-i,o.Y),this.Canvas.lineTo(o.X+i,o.Y),this.Canvas.lineTo(h.X+i,h.Y),this.Canvas.lineTo(h.X-i,h.Y)):(this.Canvas.moveTo(o.X,o.Y+i),this.Canvas.lineTo(o.X,o.Y-i),this.Canvas.lineTo(h.X,h.Y-i),this.Canvas.lineTo(h.X,h.Y+i)),this.Canvas.closePath(),this.Canvas.isPointInPath(t,e))return n}return-1},this.IsPointIn_XYValue_Line=function(t,e,a){if(10!=this.Status)return-1;var i=this.IsPointInXYValue(t,e,a);return i>=0?i:(i=this.IsPointInLine(t,e,a),i>=0?100:-1)},this.DrawLine=function(t,e,a){a&&this.Canvas.setLineDash([5,10]),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(t.X,t.Y),this.Canvas.lineTo(e.X,e.Y),this.Canvas.stroke(),a&&this.Canvas.setLineDash([])},this.CreateLineData=function(t,e){var a={Start:new at,End:new at};return a.Start.Y=t.Y,a.Start.X=t.X,a.End.Y=e.Y,a.End.X=e.X,a},this.ExportStorageData=function(){for(var t={ClassName:this.ClassName,Symbol:this.Symbol,Guid:this.Guid,Period:this.Period,Value:[],FrameID:this.Frame.Identify,LineColor:this.LineColor,AreaColor:this.AreaColor,LineWidth:this.LineWidth,Right:this.Right,EnableSave:this.EnableSave},e=0;e<this.Value.length;++e){var a=this.Value[e];t.Value.push({XValue:a.XValue,YValue:a.YValue,DateTime:a.DateTime})}return this.Text&&(t.Text=this.Text),this.FontOption&&(t.FontOption=this.FontOption),t},this.IsFrameMinSize=function(){return this.Frame&&this.Frame.IsMinSize},this.PointRange=function(t){if(!ha.IsNonEmptyArray(t))return null;if(1==t.length){var e={Points:[{X:t[0].X,Y:t[0].Y}]};return e}for(var a=t[0].X,i=a,r=t[0].Y,n=r,s=[{X:t[0].X,Y:t[0].Y}],o=1;o<t.length;++o)a<t[o].X&&(a=t[o].X),i>t[o].X&&(i=t[o].X),r<t[o].Y&&(r=t[o].Y),n>t[o].Y&&(n=t[o].Y),s.push({X:t[o].X,Y:t[o].Y});e={X:{Max:{X:a},Min:{X:i}},Y:{Max:{Y:r},Min:{Y:n}},Points:s};return e},this.GetXYCoordinate_default=function(){if(this.IsFrameMinSize())return null;var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});return this.PointRange(t)},this.GetXYCoordinate=function(){return null}}function _a(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureLine",this.IsPointIn=this.IsPointIn_XYValue_Line,this.GetXYCoordinate=this.GetXYCoordinate_default,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){this.ClipFrame();var e=t[0],a=t[1];this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(e.X,e.Y),this.Canvas.lineTo(a.X,a.Y),this.Canvas.stroke(),this.RestoreLineWidth();var i={Start:e,End:a};this.LinePoint.push(i),this.DrawPoint(t),this.Canvas.restore()}}}}function Xa(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawGraffitiLine",this.IsPointIn=this.IsPointIn_XYValue_Line,this.GetXYCoordinate=null,this.PointCount=2,this.PointToValue=function(){if(!this.Frame)return!1;var t=this.Frame.IsHScreen;if(t)for(var e=0;e<this.Point.length;++e){var a=this.Point[e],i=this.Frame.GetYData(a.X),r={XValue:a.Y,YValue:i};this.Value[e]=r}else for(e=0;e<this.Point.length;++e){a=this.Point[e],i=this.Frame.GetYData(a.Y),r={XValue:a.X,YValue:i};this.Value[e]=r}return!0},this.ValueToPoint=function(){if(!this.Frame)return!1;var t=this.Frame.IsHScreen;for(var e in this.Point=[],this.Value){var a=this.Value[e],i=new at;t?(i.Y=a.XValue,i.X=this.Frame.GetYFromData(a.YValue)):(i.X=a.XValue,i.Y=this.Frame.GetYFromData(a.YValue,!1)),this.Point[e]=i}},this.UpdateXValue=function(){},this.CalculateDrawPoint=function(t){if(this.Status<2)return null;if(!this.Point.length||!this.Frame)return null;var e=[];if(10==this.Status){var a=this.Frame.IsHScreen;for(var i in this.Value){var r=this.Value[i],n=new at;a?(n.Y=r.XValue,n.X=this.Frame.GetYFromData(r.YValue,!1)):(n.X=r.XValue,n.Y=this.Frame.GetYFromData(r.YValue,!1)),e.push(n)}}else e=this.Point;return e},this.IsPointInXYValue=function(t,e,a){if(!this.Frame)return-1;if(!this.Value)return-1;var i=5;a&&ha.IsNumber(a.Zoom)?i+=a.Zoom:this.Option&&ha.IsNumber(this.Option.Zoom)&&(i+=this.Option.Zoom);var r=this.Frame.IsHScreen;i*=U();for(var n=0;n<this.Value.length;++n){var s=this.Value[n],o=new at;if(r?(o.Y=s.XValue,o.X,this.Frame.GetYFromData(s.YValue)):(o.X=s.XValue,o.Y=this.Frame.GetYFromData(s.YValue)),this.Canvas.beginPath(),this.Canvas.arc(o.X,o.Y,i,0,360),this.Canvas.isPointInPath(t,e))return n}return-1},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){this.ClipFrame();var e=t[0],a=t[1];this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(e.X,e.Y),this.Canvas.lineTo(a.X,a.Y),this.Canvas.stroke(),this.RestoreLineWidth();var i={Start:e,End:a};this.LinePoint.push(i),this.DrawPoint(t),this.Canvas.restore()}}}}function Wa(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawArrowLine",this.IsPointIn=this.IsPointIn_XYValue_Line,this.ArrawLineWidth=5,this.ArrawLength=15,this.ArrawAngle=35,this.GetXYCoordinate=this.GetXYCoordinate_default,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){this.ClipFrame();var e=t[0],a=t[1],i=this.ArrawAngle,r=this.ArrawLength,n=180*Math.atan2(e.Y-a.Y,e.X-a.X)/Math.PI,s=(n+i)*Math.PI/180,o=(n-i)*Math.PI/180,h=r*Math.cos(s),l=r*Math.sin(s),u=r*Math.cos(o),C=r*Math.sin(o);this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(e.X,e.Y),this.Canvas.lineTo(a.X,a.Y),this.Canvas.stroke(),this.Canvas.beginPath();var D=a.X+h,f=a.Y+l;this.Canvas.moveTo(D,f),this.Canvas.lineTo(a.X,a.Y),D=a.X+u,f=a.Y+C,this.Canvas.lineTo(D,f),this.Canvas.lineWidth=this.ArrawLineWidth*U(),this.Canvas.stroke(),this.RestoreLineWidth();var c={Start:e,End:a};this.LinePoint.push(c),this.DrawPoint([t[0]]),this.Canvas.restore()}}}}function Ua(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureHaflLine",this.IsPointIn=this.IsPointIn_XYValue_Line,this.GetXYCoordinate=this.GetXYCoordinate_default,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){var e=t[0],a=t[1];this.ClipFrame(),this.Canvas.strokeStyle=this.LineColor,this.SetLineWidth(),this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y),this.Canvas.lineTo(t[1].X,t[1].Y);var i=this.CalculateExtendLineEndPoint(t);this.Canvas.lineTo(i.X,i.Y),this.Canvas.stroke(),this.RestoreLineWidth();var r={Start:e,End:a};this.LinePoint.push(r),this.DrawPoint(t),this.Canvas.restore()}}}}function Ka(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.Super_SetOption=this.SetOption,this.Super_ExportStorageData=this.ExportStorageData,this.Label,this.SetOption=function(t){this.Super_SetOption&&this.Super_SetOption(t),t&&t.Label&&(this.Label=t.Label)},this.ExportStorageData=function(){var t;return this.Super_ExportStorageData&&(t=this.Super_ExportStorageData(),this.Label&&(t.Label=this.Label)),t},this.PointCount=1,this.ClassName="ChartDrawPictureHorizontalLine",this.IsPointIn=this.IsPointIn_XYValue_Line,this.Font=16*U()+"px å¾®è½¯éé»",this.GetXYCoordinate=function(){if(this.IsFrameMinSize())return null;var t=this.CalculateDrawPoint();return this.PointRange(t)},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()){var t=this.CalculateDrawPoint();if(t&&1==t.length&&this.Frame&&1==this.Value.length){if(!this.IsYValueInFrame(this.Value[0].YValue))return null;var e=this.Frame.IsHScreen,a=this.Frame.ChartBorder.GetLeft(),i=this.Frame.ChartBorder.GetRight();e&&(a=this.Frame.ChartBorder.GetTop(),i=this.Frame.ChartBorder.GetBottom()),this.ClipFrame(),this.Canvas.strokeStyle=this.LineColor,this.SetLineWidth(),this.Canvas.beginPath(),e?(this.Canvas.moveTo(t[0].X,a),this.Canvas.lineTo(t[0].X,i)):(this.Canvas.moveTo(a,t[0].Y),this.Canvas.lineTo(i,t[0].Y)),this.Canvas.stroke(),this.RestoreLineWidth();var r={Start:new at,End:new at};if(e?(r.Start.X=t[0].X,r.Start.Y=a,r.End.X=t[0].X,r.End.Y=i):(r.Start.X=a,r.Start.Y=t[0].Y,r.End.X=i,r.End.Y=t[0].Y),this.LinePoint.push(r),this.DrawPoint(t),this.Canvas.fillStyle=this.LineColor,this.Canvas.font=this.Font,e){this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom";var n=t[0].X,s=a;this.Canvas.translate(n,s),this.Canvas.rotate(90*Math.PI/180);var o=this.Frame.GetYData(t[0].X),h=o.toFixed(2);this.Label&&(0==this.Label.Position?h=this.Label.Text+o.toFixed(2):1==this.Label.Position&&(h=o.toFixed(2)+this.Label.Text)),this.Canvas.fillText(h,0,0)}else{this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom";o=this.Frame.GetYData(t[0].Y),h=o.toFixed(2);this.Label&&(0==this.Label.Position?h=this.Label.Text+o.toFixed(2):1==this.Label.Position&&(h=o.toFixed(2)+this.Label.Text)),this.Canvas.fillText(h,a,t[0].Y)}this.Canvas.restore()}}}}function Ja(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureTrendLine",this.IsPointIn=this.IsPointIn_XYValue_Line,this.GetXYCoordinate=this.GetXYCoordinate_default,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){var e=t[0],a=t[1],i=this.CalculateExtendLinePoint(e,a);this.ClipFrame(),this.Canvas.strokeStyle=this.LineColor,this.SetLineWidth(),this.Canvas.beginPath(),this.Canvas.moveTo(i.Start.X,i.Start.Y),this.Canvas.lineTo(i.End.X,i.End.Y),this.Canvas.stroke(),this.RestoreLineWidth();var r={Start:e,End:a};this.LinePoint.push(r),this.DrawPoint(t),this.Canvas.restore()}}}}function za(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureRect",this.GetXYCoordinate=this.GetXYCoordinate_default,this.Draw=function(){if(!this.IsFrameMinSize()){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});t&&2==t.length&&(this.AreaColor=ka.ColorToRGBA(this.LineColor,.3),this.ClipFrame(),this.Canvas.strokeStyle=this.LineColor,this.SetLineWidth(),this.Canvas.beginPath(),this.Canvas.rect(t[0].X,t[0].Y,t[1].X-t[0].X,t[1].Y-t[0].Y),this.Canvas.stroke(),this.RestoreLineWidth(),this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.fillRect(t[0].X,t[0].Y,t[1].X-t[0].X,t[1].Y-t[0].Y),this.Canvas.restore(),this.DrawPoint(t))}},this.IsPointIn=function(t,e,a){if(this.IsFrameMinSize())return-1;if(!this.Frame||10!=this.Status)return-1;var i=this.Frame.Data;if(!i)return-1;var r=this.IsPointInXYValue(t,e,a);if(r>=0)return r;var n=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(!n||2!=n.length)return-1;var s=[{X:n[0].X,Y:n[0].Y},{X:n[1].X,Y:n[0].Y}];return this.IsPointInLine(s,t,e,a)?100:(s=[{X:n[1].X,Y:n[0].Y},{X:n[1].X,Y:n[1].Y}],this.IsPointInLine2(s,t,e,a)?100:(s=[{X:n[1].X,Y:n[1].Y},{X:n[0].X,Y:n[1].Y}],this.IsPointInLine(s,t,e,a)?100:(s=[{X:n[0].X,Y:n[1].Y},{X:n[0].X,Y:n[0].Y}],this.IsPointInLine2(s,t,e,a)?100:-1)))},this.IsPointInLine=function(t,e,a,i){var r=5;i&&ha.IsNumber(i.Zoom)?r+=i.Zoom:this.Option&&ha.IsNumber(this.Option.Zoom)&&(r+=this.Option.Zoom);var n=U();if(r*=n,this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y+r),this.Canvas.lineTo(t[0].X,t[0].Y-r),this.Canvas.lineTo(t[1].X,t[1].Y-r),this.Canvas.lineTo(t[1].X,t[1].Y+r),this.Canvas.closePath(),this.Canvas.isPointInPath(e,a))return!0},this.IsPointInLine2=function(t,e,a,i){var r=5;i&&ha.IsNumber(i.Zoom)?r+=i.Zoom:this.Option&&ha.IsNumber(this.Option.Zoom)&&(r+=this.Option.Zoom);var n=U();if(r*=n,this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X-r,t[0].Y),this.Canvas.lineTo(t[0].X+r,t[0].Y),this.Canvas.lineTo(t[1].X+r,t[1].Y),this.Canvas.lineTo(t[1].X-r,t[1].Y),this.Canvas.closePath(),this.Canvas.isPointInPath(e,a))return!0}}function qa(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureArc",this.Draw=function(){if(!this.IsFrameMinSize()){var t=this.CalculateDrawPoint();if(t&&2==t.length){if(this.ClipFrame(),this.SetLineWidth(),t[0].X<t[1].X&&t[0].Y>t[1].Y){var e=t[1].X-t[0].X,a=t[0].Y-t[1].Y,i=e>a?1/e:1/a,r=t[0].X,n=t[1].Y;this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y);for(var s=1.5*Math.PI;s<2*Math.PI;s+=i)this.Canvas.lineTo(r+e*Math.cos(s),n+a*Math.sin(s)*-1);for(var o=0;o<=.5*Math.PI;o+=i)this.Canvas.lineTo(r+e*Math.cos(o),n+a*Math.sin(o)*-1)}else if(t[0].X>t[1].X&&t[0].Y>t[1].Y){e=t[0].X-t[1].X,a=t[0].Y-t[1].Y,i=e>a?1/e:1/a,r=t[1].X,n=t[0].Y;this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y);for(s=0;s<=Math.PI;s+=i)this.Canvas.lineTo(r+e*Math.cos(s),n+a*Math.sin(s)*-1)}else if(t[0].X>t[1].X&&t[0].Y<t[1].Y){e=t[0].X-t[1].X,a=t[1].Y-t[0].Y,i=e>a?1/e:1/a,r=t[0].X,n=t[1].Y;this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y);for(s=.5*Math.PI;s<=1.5*Math.PI;s+=i)this.Canvas.lineTo(r+e*Math.cos(s),n+a*Math.sin(s)*-1)}else if(t[0].X<t[1].X&&t[0].Y<t[1].Y){e=t[1].X-t[0].X,a=t[1].Y-t[0].Y,i=e>a?1/e:1/a,r=t[1].X,n=t[0].Y;this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y);for(s=Math.PI;s<=2*Math.PI;s+=i)this.Canvas.lineTo(r+e*Math.cos(s),n+a*Math.sin(s)*-1)}this.Canvas.strokeStyle=this.LineColor,this.Canvas.stroke(),this.RestoreLineWidth(),this.Canvas.restore(),this.DrawPoint(t)}}},this.IsPointIn=function(t,e,a){if(this.IsFrameMinSize())return-1;if(!this.Frame||10!=this.Status)return-1;var i=this.Frame.Data;if(!i)return-1;var r=this.IsPointInXYValue(t,e,a);if(r>=0)return r;var n=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(!n||2!=n.length)return-1;var s=[{X:n[0].X,Y:n[0].Y},{X:n[1].X,Y:n[1].Y}];return this.IsPointInArc(s,t,e)?100:-1},this.IsPointInArc=function(t,e,a){if(2!=t.length)return!1;if(t[0].X<t[1].X&&t[0].Y>t[1].Y){var i=t[1].X-t[0].X,r=t[0].Y-t[1].Y,n=i>r?1/i:1/r,s=.8*i,o=.8*r,h=s>o?1/s:1/o,l=t[0].X,u=t[1].Y;this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y);for(var C=1.5*Math.PI;C<2*Math.PI;C+=n)this.Canvas.lineTo(l+i*Math.cos(C),u+r*Math.sin(C)*-1);for(var D=0;D<=.5*Math.PI;D+=n)this.Canvas.lineTo(l+i*Math.cos(D),u+r*Math.sin(D)*-1);for(var f=.5*Math.PI;f>=0;f-=h)this.Canvas.lineTo(l+s*Math.cos(f),u+o*Math.sin(D)*-1);for(var c=2*Math.PI;c>=1.5*Math.PI;c-=h)this.Canvas.lineTo(l+s*Math.cos(c),u+o*Math.sin(c)*-1);this.Canvas.closePath()}else if(t[0].X>t[1].X&&t[0].Y>t[1].Y){i=t[0].X-t[1].X,r=t[0].Y-t[1].Y,n=i>r?1/i:1/r,s=.8*i,o=.8*r,h=s>o?1/s:1/o,l=t[1].X,u=t[0].Y;this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y);for(C=0;C<=Math.PI;C+=n)this.Canvas.lineTo(l+i*Math.cos(C),u+r*Math.sin(C)*-1);for(D=Math.PI;D>=0;D-=h)this.Canvas.lineTo(l+s*Math.cos(D),u+o*Math.sin(D)*-1);this.Canvas.closePath()}else if(t[0].X>t[1].X&&t[0].Y<t[1].Y){i=t[0].X-t[1].X,r=t[1].Y-t[0].Y,n=i>r?1/i:1/r,s=.8*i,o=.8*r,h=s>o?1/s:1/o,l=t[0].X,u=t[1].Y;this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y);for(C=.5*Math.PI;C<=1.5*Math.PI;C+=n)this.Canvas.lineTo(l+i*Math.cos(C),u+r*Math.sin(C)*-1);for(D=1.5*Math.PI;D>=.5*Math.PI;D-=h)this.Canvas.lineTo(l+s*Math.cos(D),u+o*Math.sin(D)*-1);this.Canvas.closePath()}else if(t[0].X<t[1].X&&t[0].Y<t[1].Y){i=t[1].X-t[0].X,r=t[1].Y-t[0].Y,n=i>r?1/i:1/r,s=.8*i,o=.8*r,h=s>o?1/s:1/o,l=t[1].X,u=t[0].Y;this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y);for(C=Math.PI;C<=2*Math.PI;C+=n)this.Canvas.lineTo(l+i*Math.cos(C),u+r*Math.sin(C)*-1);for(D=2*Math.PI;D>=Math.PI;D-=h)this.Canvas.lineTo(l+s*Math.cos(D),u+o*Math.sin(D)*-1);this.Canvas.closePath()}return!!this.Canvas.isPointInPath(e,a)}}function Za(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureWaveMW",this.PointCount=5,this.IsPointIn=this.IsPointIn_XYValue_Line,this.GetXYCoordinate=this.GetXYCoordinate_default,this.IsHScreen=!1,this.Draw=function(){if(this.IsHScreen=this.Frame.IsHScreen,this.LinePoint=[],!this.IsFrameMinSize()){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t){for(var e in this.AreaColor=ka.ColorToRGBA(this.LineColor,.3),this.ClipFrame(),this.CalculateLines(t),this.SetLineWidth(),this.LinePoint){var a=this.LinePoint[e];this.DrawLine(a.Start,a.End)}this.RestoreLineWidth(),this.DrawPoint(t),this.Canvas.restore()}}},this.CalculateLines=function(t){if(this.Frame&&!(t.length<2))if(2==this.Status){var e={Start:new at,End:new at};e.Start.Y=t[0].Y,e.Start.X=t[0].X,e.End.Y=t[1].Y,e.End.X=t[1].X,this.LinePoint.push(e);var a=t[1].X-t[0].X,i=t[1].Y-t[0].Y;e={Start:new at,End:new at},this.IsHScreen?(e.Start.Y=t[1].Y,e.Start.X=t[1].X,e.End.Y=t[1].Y+i,e.End.X=t[0].X):(e.Start.Y=t[1].Y,e.Start.X=t[1].X,e.End.Y=t[0].Y,e.End.X=t[1].X+a),this.LinePoint.push(e);var r=e.End,n=new at;n.X=r.X,n.Y=r.Y,this.Point[2]=n,e={Start:new at,End:new at},this.IsHScreen?(e.Start.Y=r.Y,e.Start.X=r.X,e.End.Y=r.Y+i,e.End.X=t[1].X):(e.Start.Y=r.Y,e.Start.X=r.X,e.End.Y=t[1].Y,e.End.X=r.X+a),this.LinePoint.push(e);r=e.End,n=new at;n.X=r.X,n.Y=r.Y,this.Point[3]=n,e={Start:new at,End:new at},this.IsHScreen?(e.Start.Y=r.Y,e.Start.X=r.X,e.End.Y=r.Y+i,e.End.X=t[0].X):(e.Start.Y=r.Y,e.Start.X=r.X,e.End.Y=t[0].Y,e.End.X=r.X+a),this.LinePoint.push(e);r=e.End,n=new at;n.X=r.X,n.Y=r.Y,this.Point[4]=n,this.PointCount=this.Point.length}else if(5==t.length){e={Start:new at,End:new at};e.Start.Y=t[0].Y,e.Start.X=t[0].X,e.End.Y=t[1].Y,e.End.X=t[1].X,this.LinePoint.push(e);e={Start:new at,End:new at};e.Start.Y=t[1].Y,e.Start.X=t[1].X,e.End.Y=t[2].Y,e.End.X=t[2].X,this.LinePoint.push(e);e={Start:new at,End:new at};e.Start.Y=t[2].Y,e.Start.X=t[2].X,e.End.Y=t[3].Y,e.End.X=t[3].X,this.LinePoint.push(e);e={Start:new at,End:new at};e.Start.Y=t[3].Y,e.Start.X=t[3].X,e.End.Y=t[4].Y,e.End.X=t[4].X,this.LinePoint.push(e)}}}function Qa(){this.newMethod=Za,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawHeadShouldersBT",this.CalculateLines_Backup=this.CalculateLines,this.CalculateLines=function(t){if(this.Frame&&!(t.length<2)){if(2!=this.Status)return this.CalculateLines_Backup(t);var e={Start:new at,End:new at};e.Start.Y=t[0].Y,e.Start.X=t[0].X,e.End.Y=t[1].Y,e.End.X=t[1].X,this.LinePoint.push(e);var a=t[1].X-t[0].X,i=t[1].Y-t[0].Y;e={Start:new at,End:new at},this.IsHScreen?(e.Start.Y=t[1].Y,e.Start.X=t[1].X,e.End.Y=t[1].Y+i,e.End.X=t[0].X-a):(e.Start.Y=t[1].Y,e.Start.X=t[1].X,e.End.Y=t[0].Y-i,e.End.X=t[1].X+a),this.LinePoint.push(e);var r=e.End,n=new at;n.X=r.X,n.Y=r.Y,this.Point[2]=n,e={Start:new at,End:new at},this.IsHScreen?(e.Start.Y=r.Y,e.Start.X=r.X,e.End.Y=r.Y+i,e.End.X=t[1].X):(e.Start.Y=r.Y,e.Start.X=r.X,e.End.Y=t[1].Y,e.End.X=r.X+a),this.LinePoint.push(e);r=e.End,n=new at;n.X=r.X,n.Y=r.Y,this.Point[3]=n,e={Start:new at,End:new at},this.IsHScreen?(e.Start.Y=r.Y,e.Start.X=r.X,e.End.Y=r.Y+i,e.End.X=t[0].X):(e.Start.Y=r.Y,e.Start.X=r.X,e.End.Y=t[0].Y,e.End.X=r.X+a),this.LinePoint.push(e);r=e.End,n=new at;n.X=r.X,n.Y=r.Y,this.Point[4]=n,this.PointCount=this.Point.length}}}function ja(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureParallelLines",this.IsPointIn=this.IsPointIn_XYValue_Line,this.PointCount=3,this.LastPoint,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t){this.AreaColor=ka.ColorToRGBA(this.LineColor,.3);var e=t.slice(0);for(var a in this.CalculateLines(e),this.ClipFrame(),this.LinePoint){var i=this.LinePoint[a];this.DrawLine(i.Start,i.End)}this.DrawArea(),this.DrawPoint(e),this.Canvas.restore()}}},this.SetLastPoint=function(t){this.LastPoint={X:t.X,Y:t.Y}},this.DrawArea=function(){2==this.LinePoint.length&&(this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.moveTo(this.LinePoint[0].Start.X,this.LinePoint[0].Start.Y),this.Canvas.lineTo(this.LinePoint[0].End.X,this.LinePoint[0].End.Y),this.Canvas.lineTo(this.LinePoint[1].End.X,this.LinePoint[1].End.Y),this.Canvas.lineTo(this.LinePoint[1].Start.X,this.LinePoint[1].Start.Y),this.Canvas.closePath(),this.Canvas.fill())},this.CalculateLines=function(t){if(2==this.PointStatus&&this.LastPoint){var e=new at;e.X=this.LastPoint.X,e.Y=this.LastPoint.Y,t[2]=e}if(2==t.length){var a=this.CalculateExtendLinePoint(t[0],t[1]);this.LinePoint.push(a)}else if(3==t.length){a=this.CalculateExtendLinePoint(t[0],t[1]);this.LinePoint.push(a);var i=t[2].X-t[1].X,r=t[2].Y-t[1].Y,n=new at,s=new at;n.X=t[0].X+i,n.Y=t[0].Y+r,s.X=t[1].X+i,s.Y=t[1].Y+r,a=this.CalculateExtendLinePoint(n,s),this.LinePoint.push(a)}}}function $a(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawFlatTop",this.IsPointIn=this.IsPointIn_XYValue_Line,this.PointCount=3,this.LastPoint,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t){this.AreaColor=ka.ColorToRGBA(this.LineColor,.3);var e=t.slice(0);this.CalculateLines(e),this.ClipFrame();for(var a=0;a<this.LinePoint.length;++a){var i=this.LinePoint[a];this.DrawLine(i.Start,i.End)}this.DrawArea(),this.DrawPoint(e),this.Canvas.restore()}}},this.SetLastPoint=function(t){this.LastPoint={X:t.X,Y:t.Y}},this.DrawArea=function(){2==this.LinePoint.length&&(this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.moveTo(this.LinePoint[0].Start.X,this.LinePoint[0].Start.Y),this.Canvas.lineTo(this.LinePoint[0].End.X,this.LinePoint[0].End.Y),this.Canvas.lineTo(this.LinePoint[1].End.X,this.LinePoint[1].End.Y),this.Canvas.lineTo(this.LinePoint[1].Start.X,this.LinePoint[1].Start.Y),this.Canvas.closePath(),this.Canvas.fill())},this.CalculateLines=function(t){if(2==this.PointStatus&&this.LastPoint){var e=t[1],a=new at;a.X=e.X,a.Y=this.LastPoint.Y,t[2]=a}if(2==t.length)this.LinePoint.push({Start:t[0],End:t[1]});else if(3==t.length){this.LinePoint.push({Start:t[0],End:t[1]});var i=t[2];i.X=t[1].X;var r={X:t[0].X,Y:i.Y},n={X:t[1].X,Y:i.Y};this.LinePoint.push({Start:r,End:n})}}}function ti(){this.newMethod=$a,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawDisjontChannel",this.IsPointIn=this.IsPointIn_XYValue_Line,this.PointCount=3,this.LastPoint}function ei(){this.newMethod=ja,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawParallelRaysLines",this.DrawArea=function(){},this.CalculateLines=function(t){if(2==this.PointStatus&&this.LastPoint){var e=new at;e.X=this.LastPoint.X,e.Y=this.LastPoint.Y,t[2]=e}if(2==t.length){var a=this.CalculateExtendLineEndPoint([t[0],t[1]]);this.LinePoint.push({Start:t[0],End:a})}else if(3==t.length){a=this.CalculateExtendLineEndPoint([t[0],t[1]]);this.LinePoint.push({Start:t[0],End:a});var i=t[2].X-t[1].X,r=t[2].Y-t[1].Y,n=new at,s=new at;n.X=t[0].X+i,n.Y=t[0].Y+r,s.X=t[1].X+i,s.Y=t[1].Y+r,a=this.CalculateExtendLineEndPoint([n,s]),this.LinePoint.push({Start:t[2],End:a})}}}function ai(){this.newMethod=ja,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPicturePriceChannel",this.CalculateLines=function(t){if(2==this.PointStatus&&this.LastPoint){var e=new at;e.X=this.LastPoint.X,e.Y=this.LastPoint.Y,t[2]=e}if(2==t.length){var a=this.CalculateExtendLinePoint(t[0],t[1]);this.LinePoint.push(a)}else if(3==t.length){a=this.CalculateExtendLinePoint(t[0],t[1]);this.LinePoint.push(a);var i=t[2].X-t[1].X,r=t[2].Y-t[1].Y,n=new at,s=new at;n.X=t[0].X+i,n.Y=t[0].Y+r,s.X=t[1].X+i,s.Y=t[1].Y+r,a=this.CalculateExtendLinePoint(n,s),this.LinePoint.push(a);n=new at,s=new at;n.X=t[0].X-i,n.Y=t[0].Y-r,s.X=t[1].X-i,s.Y=t[1].Y-r,a=this.CalculateExtendLinePoint(n,s),this.LinePoint.push(a)}},this.DrawArea=function(){3==this.LinePoint.length&&(this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.moveTo(this.LinePoint[1].Start.X,this.LinePoint[1].Start.Y),this.Canvas.lineTo(this.LinePoint[1].End.X,this.LinePoint[1].End.Y),this.Canvas.lineTo(this.LinePoint[2].End.X,this.LinePoint[2].End.Y),this.Canvas.lineTo(this.LinePoint[2].Start.X,this.LinePoint[2].Start.Y),this.Canvas.closePath(),this.Canvas.fill())}}function ii(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureParallelChannel",this.ChannelWidth=50,this.AreaColor="rgba(25,25,25,0.4)",this.LinePoint=[],this.CalculateDrawPoint=function(){if(this.Status<2)return null;if(!this.Point.length||!this.Frame)return null;var t=this.Frame.Data;if(!t)return null;var e=[];if(10==this.Status)for(var a=0;a<2;++a){var i=this.Value[a],r=new at;r.X=this.Frame.GetXFromIndex(i.XValue-t.DataOffset),r.Y=this.Frame.GetYFromData(i.YValue),e.push(r)}else for(a=0;a<this.Point.length;++a){i=this.Point[a],r=new at;r.X=i.X,r.Y=i.Y,e.push(r)}if(e.length>=2){var n={Start:new at,End:new at};if(n.Start.X=e[0].X,n.Start.Y=e[0].Y,n.End.X=e[1].X,n.End.Y=e[1].Y,this.LinePoint.push(n),3==e.length||10==this.Status){var s=n.End.X-n.Start.X,o=n.End.Y-n.Start.Y,h=Math.atan(Math.abs(s/o)),l=this.ChannelWidth/Math.sin(h);n={Start:new at,End:new at},n.Start.X=e[0].X,n.Start.Y=e[0].Y-l,n.End.X=e[1].X,n.End.Y=e[1].Y-l,this.LinePoint.push(n);var u=new at;u.X=n.Start.X+(n.End.X-n.Start.X)/2,u.Y=n.Start.Y+(n.End.Y-n.Start.Y)/2,e[3]=u,this.Point[2]=u;var C=parseInt(this.Frame.GetXData(u.X))+t.DataOffset,D=this.Frame.GetYData(u.Y);this.Value[2]={XValue:C,YValue:D},this.PointCount=this.Point.length}}return e},this.DrawLine=function(t,e){this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(t.X,t.Y),this.Canvas.lineTo(e.X,e.Y),this.Canvas.stroke()},this.DrawArea=function(t,e,a,i){this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.moveTo(t.X,t.Y),this.Canvas.lineTo(e.X,e.Y),this.Canvas.lineTo(a.X,a.Y),this.Canvas.lineTo(i.X,i.Y),this.Canvas.closePath(),this.Canvas.fill()},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()){var t=this.CalculateDrawPoint();if(t){for(var e in this.AreaColor=ka.ColorToRGBA(this.LineColor,.3),this.ClipFrame(),this.LinePoint){var a=this.LinePoint[e];this.DrawLine(a.Start,a.End)}2==this.LinePoint.length&&this.DrawArea(this.LinePoint[0].Start,this.LinePoint[0].End,this.LinePoint[1].End,this.LinePoint[1].Start),this.Canvas.restore(),this.DrawPoint(t)}}},this.Move=function(t,e){if(20!=this.Status)return fasle;if(!this.Frame)return!1;var a=this.Frame.Data;if(!a)return!1;if(100==this.MovePointIndex)for(var i in this.Point)this.Point[i].X+=t,this.Point[i].Y+=e;else if(0==this.MovePointIndex||1==this.MovePointIndex)this.MovePointIndex<this.Point.length&&(this.Point[this.MovePointIndex].X+=t,this.Point[this.MovePointIndex].Y+=e);else if(2==this.MovePointIndex){this.Point[this.MovePointIndex].X+=t,this.Point[this.MovePointIndex].Y+=e;var r=this.Point[1].X-this.Point[0].X,n=this.Point[1].Y-this.Point[0].Y,s=Math.atan(Math.abs(r/n)),o=this.ChannelWidth/Math.sin(s)-e;this.ChannelWidth=Math.sin(s)*o}},this.IsPointIn=function(t,e){if(!this.Frame||10!=this.Status)return-1;var a=this.Frame.Data;if(!a)return-1;for(var i=0;i<this.Value.length;++i){var r=this.Value[i],n=new at;if(i<2)n.X=this.Frame.GetXFromIndex(r.XValue-a.DataOffset),n.Y=this.Frame.GetYFromData(r.YValue);else{if(i>=this.Point.length)continue;n.X=this.Point[i].X,n.Y=this.Point[i].Y}if(this.Canvas.beginPath(),this.Canvas.arc(n.X,n.Y,5,0,360),this.Canvas.isPointInPath(t,e))return i}for(var i in this.LinePoint){r=this.LinePoint[i];var s=r.Start,o=r.End;if(this.Canvas.beginPath(),this.Canvas.moveTo(s.X,s.Y+5),this.Canvas.lineTo(s.X,s.Y-5),this.Canvas.lineTo(o.X,o.Y-5),this.Canvas.lineTo(o.X,o.Y+5),this.Canvas.closePath(),this.Canvas.isPointInPath(t,e))return 100}return-1}}function ri(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureText",this.Text="ææ¬",this.PointCount=1,this.FontOption={Family:"å¾®è½¯éé»",Size:20,Weight:null,Style:null},this.TextRect=null,this.IsInitialized=!1,this.SettingMenu,this.HQChart,this.SetOption=function(t){t&&(t.LineColor&&(this.LineColor=t.LineColor),t.Text&&(this.Text=t.Text),t.FontOption&&(this.FontOption=t.FontOption))},this.Draw=function(t){if(this.TextRect=null,!this.IsFrameMinSize()){var e=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(e&&1==e.length){this.ClipFrame(),this.Canvas.fillStyle=this.LineColor,this.Canvas.textAlign="center",this.Canvas.textBaseline="bottom",this.Canvas.font=this.GetTextFont(),this.Canvas.fillText(this.Text,e[0].X,e[0].Y);var a=this.Canvas.measureText(this.Text).width,i=this.FontOption.Size*U();this.TextRect={},this.TextRect.Left=e[0].X-a/2,this.TextRect.Top=e[0].Y-i,this.TextRect.Width=a,this.TextRect.Height=i,this.Canvas.restore(),!1===this.IsInitialized&&(this.SetTextOption(),this.IsInitialized=!0)}}},this.GetTextFont=function(){var t=16*U()+"px å¾®è½¯éé»";if(!this.FontOption||!this.FontOption.Family||this.FontOption.Size<=0)return t;var e="";return this.FontOption.Color&&(e+=this.FontOption.Color+" "),this.FontOption.Style&&(e+=this.FontOption.Style+" "),this.FontOption.Weight&&(e+=this.FontOption.Weight+" "),this.FontOption.Size>=0&&(e+=this.FontOption.Size*U()+"px "),e+=this.FontOption.Family,e},this.SetTextOption=function(){w.Chart.Log("[ChartDrawPictureText::SetTextOption]"),this.SettingMenu||(this.SettingMenu=new Pr(this.Frame.ChartBorder.UIElement.parentNode)),this.SettingMenu.ChartPicture=this,this.SettingMenu.HQChart=this.HQChart,this.SettingMenu.Position={Left:this.TextRect.Left+this.TextRect.Width,Top:this.TextRect.Top},this.SettingMenu.DoModal()},this.IsPointIn=function(t,e){if(!this.Frame||10!=this.Status)return-1;var a=this.Frame.Data;return a&&this.TextRect?(this.Canvas.beginPath(),this.Canvas.rect(this.TextRect.Left,this.TextRect.Top,this.TextRect.Width,this.TextRect.Height),this.Canvas.isPointInPath(t,e)?100:-1):-1}}function ni(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureIconFont",this.PointCount=1,this.Text="î",this.FontOption={Family:"iconfont",Size:24},this.TextRect=null,this.SettingMenu,this.Angle=0,this.SetOption=function(t){t&&(t.LineColor&&(this.LineColor=t.LineColor),t.FontOption&&t.FontOption.Size>0&&(this.FontOption.Size=t.FontOption.Size),ha.IsNumber(t.Angle)&&(this.Angle=t.Angle))},this.Draw=function(){if(this.TextRect=null,!this.IsFrameMinSize()){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&1==t.length){var e=this.GetTextFont();if(e){this.ClipFrame();var a=this.Frame.IsHScreen,i=U();this.Canvas.fillStyle=this.LineColor,this.Canvas.textAlign="center",this.Canvas.textBaseline="middle",this.Canvas.font=e,a?(this.Canvas.translate(t[0].X,t[0].Y),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(this.Text,0,0)):0!=this.Angle?(this.Canvas.translate(t[0].X,t[0].Y),this.Canvas.rotate(this.Angle*(Math.PI/180)),this.Canvas.fillText(this.Text,0,0)):this.Canvas.fillText(this.Text,t[0].X,t[0].Y);var r=this.Canvas.measureText(this.Text).width;this.TextRect={},this.TextRect.Left=t[0].X-r/2,this.TextRect.Top=t[0].Y-this.FontOption.Size*i,this.TextRect.Width=r,this.TextRect.Height=this.FontOption.Size*i,this.Canvas.restore()}}}},this.GetTextFont=function(){if(!this.FontOption||!this.FontOption.Family||this.FontOption.Size<=0)return null;var t="";return this.FontOption.Size>=0&&(t+=this.FontOption.Size*U()+"px "),t+=this.FontOption.Family,t},this.IsPointIn=function(t,e){if(!this.Frame||10!=this.Status)return-1;var a=this.Frame.Data;if(!a)return-1;if(!this.TextRect)return-1;var i=0;return this.Option&&this.Option.Zoom>=1&&(i=this.Option.Zoom*U()),this.Canvas.beginPath(),this.Canvas.rect(this.TextRect.Left-i,this.TextRect.Top-i,this.TextRect.Width+2*i,this.TextRect.Height+2*i),this.Canvas.isPointInPath(t,e)?100:-1}}function si(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureGannFan",this.IsPointIn=this.IsPointIn_XYValue_Line,this.LinePoint=[],this.Font=16*U()+"px å¾®è½¯éé»",this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){this.AreaColor=ka.ColorToRGBA(this.LineColor,.3),this.ClipFrame();var e=this.GetQuadrant(t[0],t[1]);if(this.SetLineWidth(),1===e||4===e){for(var a in this.CalculateLines(t[0],t[1],e),this.DrawArea(),this.LinePoint){var i=this.LinePoint[a];this.DrawLine(i.Start,i.End,i.IsDottedLine)}for(var a in this.LinePoint){i=this.LinePoint[a];i.Text&&i.PtEnd&&this.DrawTitle(i.PtEnd,i.Text)}}else this.DrawLine(t[0],t[1],!1);this.RestoreLineWidth(),this.Canvas.restore(),this.DrawPoint(t)}}},this.GetQuadrant=function(t,e){return t.X<e.X&&t.Y>e.Y?1:t.X<e.X&&t.Y>e.Y?2:t.X<e.X&&t.Y<e.Y?4:3},this.DrawLine=function(t,e,a){a&&this.Canvas.setLineDash([5,10]),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(t.X,t.Y),this.Canvas.lineTo(e.X,e.Y),this.Canvas.stroke(),a&&this.Canvas.setLineDash([])},this.DrawTitle=function(t,e){this.Canvas.fillStyle=this.LineColor,this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.Canvas.font=this.Font,this.Canvas.fillText(e,t.X,t.Y)},this.DrawArea=function(){var t=null,e=null;for(var a in this.LinePoint){var i=this.LinePoint[a];"1:8"==i.Text?t=this.LinePoint[a]:"8:1"==i.Text&&(e=this.LinePoint[a])}t&&e&&(this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.moveTo(t.End.X,t.End.Y),this.Canvas.lineTo(t.Start.X,t.Start.Y),this.Canvas.lineTo(e.End.X,e.End.Y),this.Canvas.closePath(),this.Canvas.fill())},this.CalculateLines=function(t,e,a){if(!this.Frame)return!1;this.Frame.ChartBorder.GetTopEx(),this.Frame.ChartBorder.GetRight(),this.Frame.ChartBorder.GetBottom();var i=[.5,1/3,.25,.125,2/3],r=["1:2","1:3","1:4","1:8","2:3"],n=["2:1","3:1","4:1","8:1","3:2"],s=new at,o=new at;s.X=t.X,s.Y=t.Y,o.X=e.X,o.Y=e.Y;var h=Math.abs(t.X-e.X),l=Math.abs(t.Y-e.Y);if(1===a){var u=this.CalculateExtendLinePoint(t,e),C={Start:s,End:u.Start,IsDottedLine:!1,PtEnd:o,Text:"1:1"};for(var D in this.LinePoint.push(C),i){if(h>5){C={Start:s,End:null,IsDottedLine:!1,PtEnd:new at,Text:r[D]},C.PtEnd.Y=e.Y,C.PtEnd.X=t.X+h*i[D];u=this.CalculateExtendLinePoint(C.Start,C.PtEnd);C.End=u.Start,this.LinePoint.push(C)}if(l>5){C={Start:s,End:null,IsDottedLine:!1,PtEnd:new at,Text:n[D]},C.PtEnd.Y=t.Y-l*i[D],C.PtEnd.X=e.X;u=this.CalculateExtendLinePoint(C.Start,C.PtEnd);C.End=u.Start,this.LinePoint.push(C)}}}else{if(4!=a)return!1;u=this.CalculateExtendLinePoint(t,e),C={Start:s,End:u.End,IsDottedLine:!1,PtEnd:o,Text:"1:1"};for(var D in this.LinePoint.push(C),i){if(h>5){C={Start:s,End:null,IsDottedLine:!1,PtEnd:new at,Text:r[D]},C.PtEnd.Y=e.Y,C.PtEnd.X=t.X+h*i[D];u=this.CalculateExtendLinePoint(C.Start,C.PtEnd);C.End=u.End,this.LinePoint.push(C)}if(l>5){C={Start:s,End:null,IsDottedLine:!1,PtEnd:new at,Text:n[D]},C.PtEnd.Y=t.Y+l*i[D],C.PtEnd.X=e.X;u=this.CalculateExtendLinePoint(C.Start,C.PtEnd);C.End=u.End,this.LinePoint.push(C)}}}return!0}}function oi(){this.newMethod=si,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureResistanceLine",this.CalculateLines=function(t,e,a){if(!this.Frame)return!1;this.Frame.ChartBorder.GetTopEx(),this.Frame.ChartBorder.GetRight(),this.Frame.ChartBorder.GetBottom();var i=[1/3,2/3],r=["3:1","3:2"],n=new at,s=new at;n.X=t.X,n.Y=t.Y,s.X=e.X,s.Y=e.Y;Math.abs(t.X-e.X);var o=Math.abs(t.Y-e.Y);if(1===a){var h=this.CalculateExtendLinePoint(t,e),l={Start:n,End:h.Start,IsDottedLine:!1,PtEnd:s,Text:"1:1"};for(var u in this.LinePoint.push(l),i)if(o>5){l={Start:n,End:null,IsDottedLine:!1,PtEnd:new at,Text:r[u]},l.PtEnd.Y=t.Y-o*i[u],l.PtEnd.X=e.X;h=this.CalculateExtendLinePoint(l.Start,l.PtEnd);l.End=h.Start,this.LinePoint.push(l)}}else{if(4!=a)return!1;h=this.CalculateExtendLinePoint(t,e),l={Start:n,End:h.End,IsDottedLine:!1,PtEnd:s,Text:"1:1"};for(var u in this.LinePoint.push(l),i)if(o>5){l={Start:n,End:null,IsDottedLine:!1,PtEnd:new at,Text:r[u]},l.PtEnd.Y=t.Y+o*i[u],l.PtEnd.X=e.X;h=this.CalculateExtendLinePoint(l.Start,l.PtEnd);l.End=h.End,this.LinePoint.push(l)}}return!0},this.DrawArea=function(){var t=null,e=null;for(var a in this.LinePoint){var i=this.LinePoint[a];"1:1"==i.Text?t=this.LinePoint[a]:"3:1"==i.Text&&(e=this.LinePoint[a])}t&&e&&(this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.moveTo(t.End.X,t.End.Y),this.Canvas.lineTo(t.Start.X,t.Start.Y),this.Canvas.lineTo(e.End.X,e.End.Y),this.Canvas.closePath(),this.Canvas.fill())}}function hi(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureGoldenSectionLine",this.IsPointIn=this.IsPointIn_XYValue_Line,this.Font=14*U()+"px å¾®è½¯éé»",this.GetSectionData=function(){var t=[0,.236,.382,.5,.618,.8,1,1.236,1.382,1.5,1.618,1.8,2];return t},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()){var t=this.CalculateDrawPoint();if(t&&2==t.length){for(var e in this.AreaColor=ka.ColorToRGBA(this.LineColor,.3),this.CalculateLines(t[0],t[1]),this.ClipFrame(),this.SetLineWidth(),this.LinePoint){var a=this.LinePoint[e];this.DrawLine(a.Start,a.End,a.IsDottedLine)}for(var e in this.RestoreLineWidth(),this.LinePoint){a=this.LinePoint[e];a.Text&&this.DrawTitle(a.Start,a.Text)}this.DrawPoint(t),this.Canvas.restore()}}},this.CalculateHSCreenLines=function(t,e){for(var a=this.GetSectionData(),i=this.Frame.ChartBorder.GetTop(),r=this.Frame.ChartBorder.GetBottom(),n=t.X-e.X,s=0;s<a.length;++s){var o=n*a[s],h={Start:new at,End:new at};h.Start.X=t.X-o,h.Start.Y=i,h.End.X=t.X-o,h.End.Y=r;var l="";l=0==s?"Base ":(100*a[s]).toFixed(2)+"% ";var u=this.Frame.GetYData(h.Start.X);l+=u.toFixed(2),h.Text=l,this.LinePoint.push(h)}},this.CalculateLines=function(t,e){if(this.Frame.IsHScreen)this.CalculateHSCreenLines(t,e);else for(var a=this.GetSectionData(),i=this.Frame.ChartBorder.GetLeft(),r=this.Frame.ChartBorder.GetRight(),n=t.Y-e.Y,s=0;s<a.length;++s){var o=n*a[s],h={Start:new at,End:new at};h.Start.Y=t.Y-o,h.Start.X=i,h.End.Y=t.Y-o,h.End.X=r;var l="";l=0==s?"Base ":(100*a[s]).toFixed(2)+"% ";var u=this.Frame.GetYData(h.Start.Y);l+=u.toFixed(2),h.Text=l,this.LinePoint.push(h)}},this.DrawLine=function(t,e){this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(t.X,t.Y),this.Canvas.lineTo(e.X,e.Y),this.Canvas.stroke()},this.DrawTitle=function(t,e){this.Canvas.fillStyle=this.LineColor,this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom",this.Canvas.font=this.Font,this.Frame.IsHScreen?(this.Canvas.save(),this.Canvas.translate(t.X,t.Y),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(e,0,0),this.Canvas.restore()):this.Canvas.fillText(e,t.X,t.Y)}}function li(){this.newMethod=hi,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPicturePercentage",this.GetSectionData=function(){var t=[0,.25,.333,.5,1];return t}}function ui(){this.newMethod=hi,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureWaveBand",this.GetSectionData=function(){var t=[0,.125,.25,.375,.5,.625,.75,.875,1];return t}}function Ci(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureTriangle",this.PointCount=3,this.Font=16*U()+"px å¾®è½¯éé»",this.IsPointIn=this.IsPointIn_XYValue_Line,this.GetXYCoordinate=this.GetXYCoordinate_default,this.LastPoint,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t){var e=t.slice(0);for(var a in this.AreaColor=ka.ColorToRGBA(this.LineColor,.3),this.ClipFrame(),this.CalculateLines(e),this.LinePoint){var i=this.LinePoint[a];this.DrawLine(i.Start,i.End)}this.DrawArea(e),this.DrawPoint(e),this.DrawTitle(e),this.Canvas.restore()}}},this.DrawArea=function(t){3==t.length&&(this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.moveTo(t[0].X,t[0].Y),this.Canvas.lineTo(t[1].X,t[1].Y),this.Canvas.lineTo(t[2].X,t[2].Y),this.Canvas.lineTo(t[0].X,t[0].Y),this.Canvas.closePath(),this.Canvas.fill())},this.DrawTitle=function(t){this.Status},this.SetLastPoint=function(t){this.LastPoint={X:t.X,Y:t.Y}},this.CalculateLines=function(t){if(2==this.PointStatus&&this.LastPoint){var e=new at;e.X=this.LastPoint.X,e.Y=this.LastPoint.Y,t[2]=e}if(2===t.length){var a={Start:new at,End:new at};a.Start.Y=t[0].Y,a.Start.X=t[0].X,a.End.Y=t[1].Y,a.End.X=t[1].X,this.LinePoint.push(a)}else if(3===t.length){a={Start:new at,End:new at};a.Start.Y=t[0].Y,a.Start.X=t[0].X,a.End.Y=t[1].Y,a.End.X=t[1].X,this.LinePoint.push(a),a={Start:new at,End:new at},a.Start.Y=t[1].Y,a.Start.X=t[1].X,a.End.Y=t[2].Y,a.End.X=t[2].X,this.LinePoint.push(a),a={Start:new at,End:new at},a.Start.Y=t[2].Y,a.Start.X=t[2].X,a.End.Y=t[0].Y,a.End.X=t[0].X,this.LinePoint.push(a)}}}function Di(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureSymmetryAngle",this.PointCount=2,this.Font=16*U()+"px å¾®è½¯éé»",this.IsPointIn=this.IsPointIn_XYValue_Line,this.GetXYCoordinate=this.GetXYCoordinate_default,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t){for(var e in this.AreaColor=ka.ColorToRGBA(this.LineColor,.3),this.ClipFrame(),this.CalculateLines(t),this.LinePoint){var a=this.LinePoint[e];this.DrawLine(a.Start,a.End)}this.DrawArea(),this.DrawPoint(t),this.DrawTitle(t),this.Canvas.restore()}}},this.CalculateLines=function(t){if(2==t.length&&this.Frame){var e={Start:new at,End:new at};e.Start.Y=t[0].Y,e.Start.X=t[0].X,e.End.Y=t[1].Y,e.End.X=t[1].X,this.LinePoint.push(e),e={Start:new at,End:new at},e.Start.Y=t[0].Y,e.Start.X=t[0].X,e.End.Y=t[1].Y,e.End.X=t[0].X,this.LinePoint.push(e);var a=t[0].X-t[1].X;e={Start:new at,End:new at},e.Start.Y=t[0].Y,e.Start.X=t[0].X,e.End.Y=t[1].Y,e.End.X=t[0].X+a,this.LinePoint.push(e)}},this.DrawArea=function(){3==this.LinePoint.length&&(this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.moveTo(this.LinePoint[0].Start.X,this.LinePoint[0].Start.Y),this.Canvas.lineTo(this.LinePoint[0].End.X,this.LinePoint[0].End.Y),this.Canvas.lineTo(this.LinePoint[2].End.X,this.LinePoint[2].End.Y),this.Canvas.moveTo(this.LinePoint[0].Start.X,this.LinePoint[0].Start.Y),this.Canvas.closePath(),this.Canvas.fill())},this.DrawTitle=function(t){this.Status}}function fi(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureCircle",this.PointCount=2,this.CircleData,this.GetXYCoordinate=this.GetXYCoordinate_default,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){this.AreaColor=ka.ColorToRGBA(this.LineColor,.3),this.ClipFrame();var e=t[0].X-t[1].X,a=t[0].Y-t[1].Y,i=Math.sqrt(e*e+a*a);this.Canvas.fillStyle=this.AreaColor,this.Canvas.strokeStyle=this.LineColor,this.DrawLine(t[0],t[1]),this.Canvas.beginPath(),this.Canvas.arc(t[0].X,t[0].Y,i,0,2*Math.PI),this.Canvas.stroke(),this.Canvas.fill(),this.CircleData={X:t[0].X,Y:t[0].Y,R:i},this.DrawPoint(t),this.Canvas.restore()}}},this.IsPointIn=function(t,e,a){if(this.IsFrameMinSize())return-1;if(10!=this.Status)return-1;var i=this.IsPointInXYValue(t,e,a);if(i>=0)return i;if(this.CircleData&&this.CircleData.R>8){var r=this.CircleData.X-t,n=this.CircleData.Y-e,s=Math.sqrt(r*r+n*n);if(s<this.CircleData.R&&s>this.CircleData.R-8)return 100}return-1}}function ci(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureQuadrangle",this.IsPointIn=this.IsPointIn_XYValue_Line,this.GetXYCoordinate=this.GetXYCoordinate_default,this.PointCount=3,this.LastPoint,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t){this.AreaColor=ka.ColorToRGBA(this.LineColor,.3);var e=t.slice(0);for(var a in this.CalculateLines(e),this.ClipFrame(),this.LinePoint){var i=this.LinePoint[a];this.DrawLine(i.Start,i.End)}this.DrawArea(),this.DrawPoint(e),this.Canvas.restore()}}},this.SetLastPoint=function(t){this.LastPoint={X:t.X,Y:t.Y}},this.DrawArea=function(){4==this.LinePoint.length&&(this.Canvas.fillStyle=this.AreaColor,this.Canvas.beginPath(),this.Canvas.moveTo(this.LinePoint[0].Start.X,this.LinePoint[0].Start.Y),this.Canvas.lineTo(this.LinePoint[0].End.X,this.LinePoint[0].End.Y),this.Canvas.lineTo(this.LinePoint[1].End.X,this.LinePoint[1].End.Y),this.Canvas.lineTo(this.LinePoint[2].End.X,this.LinePoint[2].End.Y),this.Canvas.closePath(),this.Canvas.fill())},this.CalculateLines=function(t){if(2==this.PointStatus&&this.LastPoint){var e=new at;e.X=this.LastPoint.X,e.Y=this.LastPoint.Y,t[2]=e}if(2==t.length){var a=this.CreateLineData(t[0],t[1]);this.LinePoint.push(a)}else if(3==t.length){a=this.CreateLineData(t[0],t[1]);this.LinePoint.push(a);a=this.CreateLineData(t[1],t[2]);this.LinePoint.push(a);var i=t[2].X-t[1].X,r=t[2].Y-t[1].Y,n=new at;n.X=t[0].X+i,n.Y=t[0].Y+r;a=this.CreateLineData(t[2],n);this.LinePoint.push(a);a=this.CreateLineData(n,t[0]);this.LinePoint.push(a)}}}function di(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPictureFibonacci",this.PointCount=1,this.Font=14*U()+"px å¾®è½¯éé»",this.IsPointIn=this.IsPointIn_XYValue_Line,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()){var t=this.CalculateDrawPoint();if(t&&(this.CalculateLines(),!(this.LinePoint.length<=0))){for(var e in this.ClipFrame(),this.SetLineWidth(),this.LinePoint){var a=this.LinePoint[e];this.DrawLine(a.Start,a.End),this.DrawTitle(a.Start,a.Title)}this.RestoreLineWidth(),this.DrawPoint(t),this.Canvas.restore()}}},this.DrawTitle=function(t,e){this.Canvas.fillStyle=this.LineColor,this.Canvas.textAlign="left",this.Canvas.textBaseline="top",this.Canvas.font=this.Font,this.Frame.IsHScreen?(this.Canvas.save(),this.Canvas.translate(t.X,t.Y),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(e,2,10),this.Canvas.restore()):this.Canvas.fillText(e,t.X+2,t.Y+10)},this.CalculateHSCreenLines=function(){var t=this.Frame.Data;if(t){var e=null;if(10==this.Status){if(1!=this.Value.length)return;e=this.Value[0].XValue}else{if(1!=this.Point.length)return;e=parseInt(this.Frame.GetXData(this.Point[0].Y))+t.DataOffset}for(var a=this.Frame.ChartBorder.GetRightEx(),i=this.Frame.ChartBorder.GetLeftEx(),r=this.Frame.XPointCount,n=[1,2,3,5,8,13,21,34,55,89,144,233],s=0;s<n.length;++s){var o=e+n[s],h=o-t.DataOffset;if(!(h<0||h>=r)){var l=this.Frame.GetXFromIndex(o-t.DataOffset,!1),u={Start:new at,End:new at,Title:n[s]};u.Start.X=a,u.Start.Y=l,u.End.X=i,u.End.Y=l,this.LinePoint.push(u)}}}},this.CalculateLines=function(){if(!(this.Status<2)&&this.Frame){var t=this.Frame.Data;if(t)if(this.Frame.IsHScreen)this.CalculateHSCreenLines();else{var e=null;if(10==this.Status){if(1!=this.Value.length)return;e=this.Value[0].XValue}else{if(1!=this.Point.length)return;e=parseInt(this.Frame.GetXData(this.Point[0].X))+t.DataOffset}for(var a=this.Frame.ChartBorder.GetTopEx(),i=this.Frame.ChartBorder.GetBottom(),r=this.Frame.XPointCount,n=[1,2,3,5,8,13,21,34,55,89,144,233],s=0;s<n.length;++s){var o=e+n[s],h=o-t.DataOffset;if(!(h<0||h>=r)){var l=this.Frame.GetXFromIndex(o-t.DataOffset,!1),u={Start:new at,End:new at,Title:n[s]};u.Start.Y=a,u.Start.X=l,u.End.Y=i,u.End.X=l,this.LinePoint.push(u)}}}}}}function mi(t){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawLinearRegression",this.PointCount=2,this.IsPointIn=this.IsPointIn_XYValue_Line,this.ChartBorder,this.Lines=[],this.IsShowMaxMinLine=!1,this.IsShowExtendLine=!1,this.ExtendLineDash=[5,5],this.MaxPoint,this.MinPoint,t&&(1==t.IsShowMaxMinLine&&(this.IsShowMaxMinLine=!0),1==t.IsShowExtendLine&&(this.IsShowExtendLine=!0)),this.ImportStorageData=function(t){1==t.IsShowMaxMinLine&&(this.IsShowMaxMinLine=!0),1==t.IsShowExtendLine&&(this.IsShowExtendLine=!0),t.Lines&&(this.Lines=t.Lines),t.MaxPoint&&t.MinPoint&&(this.MaxPoint=t.MaxPoint,this.MinPoint=t.MinPoint)},this.Super_ExportStorageData=this.ExportStorageData,this.ExportStorageData=function(){var t;return this.Super_ExportStorageData&&(t=this.Super_ExportStorageData(),t.IsShowMaxMinLine=this.IsShowMaxMinLine,t.IsShowExtendLine=this.IsShowExtendLine,t.Lines=this.Lines,this.IsShowMaxMinLine&&(t.MaxPoint=this.MaxPoint,t.MinPoint=this.MinPoint)),t},this.PointToValue_Backup=this.PointToValue,this.PointToValue=function(){this.Point[0]={X:this.Lines[0].X,Y:this.Lines[0].Y},this.Point[1]={X:this.Lines[this.Lines.length-1].X,Y:this.Lines[this.Lines.length-1].Y},this.PointToValue_Backup()},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){this.ClipFrame(),this.ChartBorder=this.Frame.ChartBorder,this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor;var e=t[0],a=t[1];if(10==this.Status)this.DrawLinearLines();else{var i=this.ChartBorder.GetTopEx(),r=this.ChartBorder.GetBottomEx(),n=this.PointToKLine([e,a]),s=this.Calculate(n);this.Lines=s.Points,this.MaxPoint=s.Max,this.MinPoint=s.Min,this.DrawLinearLines(),this.Canvas.beginPath(),this.Canvas.moveTo(e.X,i),this.Canvas.lineTo(e.X,r),this.Canvas.moveTo(a.X,i),this.Canvas.lineTo(a.X,r),this.Canvas.stroke()}this.RestoreLineWidth();var o={Start:e,End:a};this.LinePoint.push(o),this.DrawPoint(t),this.Canvas.restore()}else 10==this.Status&&(this.ClipFrame(),this.ChartBorder=this.Frame.ChartBorder,this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor,this.DrawLinearLines(),this.RestoreLineWidth(),this.Canvas.restore())}},this.Calculate=function(t){var e=t[0],a=t[1];e.XValue>a.XValue&&(e=t[1],a=t[0]);var i,r,n,s,o=a.XValue-e.XValue+1,h=this.Frame.Data.Data,l=a.XValue,u=0,C=0,D=0,f=0;for(n=0,I=o;n<o&&n<=l;++n,--I)u+=I,C+=h[l-n].Close;for(u/=o,C/=o,n=0,I=o;n<o&&n<=l;++n,--I)D+=(I-u)*(h[l-n].Close-C),f+=(I-u)*(I-u);r=D/f,i=C-u*r;var c=[],d=null,m=null;for(n=0,s=o;n<o&&n<=l;++n,--s){var v=a.XIndex-n,S=a.XValue-n,I=this.Frame.GetXFromIndex(v),p=r*s+i,T=this.Frame.GetYFromData(p,!1),g={X:I,Y:T,XValue:S,YValue:p};c.push(g),(null==d||d.High<h[S].High)&&(d={X:I,Y:T,XValue:S,YValue:p,High:h[S].High}),(null==m||m.Low>h[S].Low)&&(m={X:I,Y:T,XValue:S,YValue:p,Low:h[S].Low})}return{Points:c,Slope:r,Const:i,Max:d,Min:m}},this.DrawLinearLines=function(){if(!this.Frame)return null;var t=this.Frame.Data;if(!t)return null;var e=this.Frame.XPointCount,a=t.DataOffset,i=this.Frame.IsHScreen,r=[];for(var n in this.Lines){var s=this.Lines[n],o=s.XValue-a;if(!(o<0||o>=e)){var h={};i||(h.X=this.Frame.GetXFromIndex(o,!1),h.Y=this.Frame.GetYFromData(s.YValue,!1),h.YValue=s.YValue),r.push(h)}}if(r.length>1){for(var n in r){s=r[n];0==n?(this.Canvas.beginPath(),this.Canvas.moveTo(s.X,s.Y)):(this.Canvas.lineTo(s.X,s.Y),n==r.length-1&&this.Canvas.stroke())}this.DrawExtendLine(r)}if(this.IsShowMaxMinLine&&r.length>1&&this.MaxPoint&&this.MinPoint){var l=this.MaxPoint.High-this.MaxPoint.YValue;for(var n in r){s=r[n];s.Y=this.Frame.GetYFromData(s.YValue+l,!1),0==n?(this.Canvas.beginPath(),this.Canvas.moveTo(s.X,s.Y)):(this.Canvas.lineTo(s.X,s.Y),n==r.length-1&&this.Canvas.stroke())}this.DrawExtendLine(r);var u=this.MinPoint.Low-this.MinPoint.YValue;for(var n in r){s=r[n];s.Y=this.Frame.GetYFromData(s.YValue+u,!1),0==n?(this.Canvas.beginPath(),this.Canvas.moveTo(s.X,s.Y)):(this.Canvas.lineTo(s.X,s.Y),n==r.length-1&&this.Canvas.stroke())}this.DrawExtendLine(r)}},this.DrawExtendLine=function(t){if(this.IsShowExtendLine){var e,a=t[0],i=t[t.length-1];e=i.X>a.X?[a,i]:[i,a];var r=this.CalculateExtendLineEndPoint(e);this.Canvas.beginPath(),this.Canvas.moveTo(i.X,i.Y),this.Canvas.lineTo(r.X,r.Y),this.Canvas.setLineDash(this.ExtendLineDash),this.Canvas.stroke(),this.Canvas.setLineDash([])}}}function vi(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawRuler",this.PointCount=2,this.Font=16*U()+"px å¾®è½¯éé»",this.IsPointIn=this.IsPointIn_XYValue_Line,this.TitleColor=Oi.ChartDrawRuler.TitleColor,this.IsHScreen=!1,this.Draw=function(){this.LinePoint=[];var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){this.IsHScreen=this.Frame.IsHScreen,this.ClipFrame();var e=t[0],a=t[1],i=this.PointToKLine([e,a]),r=this.Calculate(i),n=ha.IsNumber(r.Increase)?r.Increase.toFixed(2)+"%":"--",s=ha.IsNumber(r.Risefall)?r.Risefall.toFixed(2):"--",o="é´è·:"+r.Count+" æ¶¨è·:"+s+" æ¶¨å¹:"+n;this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(e.X,e.Y),this.Canvas.lineTo(a.X,a.Y),this.Canvas.stroke(),this.RestoreLineWidth();var h={Start:e,End:a};this.LinePoint.push(h),this.DrawPoint(t),this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left",this.Canvas.font=this.Font,this.TitleColor?this.Canvas.fillStyle=this.TitleColor:ha.IsNumber(r.Increase)?r.Increase>0?this.Canvas.fillStyle=Oi.UpTextColor:r.Increase<0?this.Canvas.fillStyle=Oi.DownTextColor:this.Canvas.fillStyle=Oi.UnchagneTextColor:this.Canvas.fillStyle=Oi.UnchagneTextColor;var l=3*U(),u=e.X,C=e.Y;this.IsHScreen?(this.Canvas.translate(u+l,C+l),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(o,0,0)):this.Canvas.fillText(o,u+l,C-l),this.Canvas.restore()}},this.Calculate=function(t){var e=t[0],a=t[1];e.XValue>a.XValue&&(e=t[1],a=t[0]);for(var i,r,n,s,o,h=this.Frame.Data.Data,l=0,u=e.XValue;u<=a.XValue;++u,++l){var C=h[u];0==l?(s=C.YClose,i=C.Open,o=C.Close,n=C.Low,r=C.High):(o=C.Close,n>C.Low&&(n=C.Low),r<C.High&&(r=C.High))}if(!ha.IsPlusNumber(s)){var D=e.XValue-1;D>=0&&D<h.length&&(s=h[D].Close)}var f={YClose:s,Open:i,High:r,Low:n,Close:o,Count:l};return ha.IsPlusNumber(s)&&(f.Increase=(o-s)/s*100,f.Risefall=o-s),f}}function Si(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPriceLine",this.Font=16*U()+"px å¾®è½¯éé»",this.PointCount=1,this.IsPointIn=this.IsPointIn_XYValue_Line,this.IsHScreen=!1,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()){var t=this.CalculateDrawPoint({IsCheckX:!1,IsCheckY:!0});if(t&&1==t.length){this.IsHScreen=this.Frame.IsHScreen;var e=t[0],a=this.Frame.ChartBorder;if(this.IsHScreen){var i=a.GetLeftEx(),r=a.GetRightEx();if(e.X<i||e.X>r)return;var n=a.GetBottom(),s={X:e.X,Y:n},o=this.Frame.GetYData(e.X,!1)}else{n=a.GetBottomEx();var h=a.GetTopEx();if(e.Y<h||e.Y>n)return;r=a.GetRight(),s={X:r,Y:e.Y},o=this.Frame.GetYData(e.Y,!1)}this.ClipFrame(),this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(e.X,e.Y),this.Canvas.lineTo(s.X,s.Y),this.Canvas.stroke(),this.RestoreLineWidth();var l={Start:e,End:s};this.LinePoint.push(l),this.DrawPoint(t),this.Canvas.textBaseline="bottom",this.Canvas.textAlign="left",this.Canvas.fillStyle=this.LineColor,this.Canvas.font=this.Font;var u=2*U(),C=e.X,D=e.Y;this.IsHScreen?(this.Canvas.translate(C+u,D+u),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(o.toFixed(2),0,0)):this.Canvas.fillText(o.toFixed(2),C+u,D-u),this.Canvas.restore()}}}}function Ii(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawPriceLineV2",this.Font=12*U()+"px å¾®è½¯éé»",this.PointCount=1,this.IsPointIn=this.IsPointIn_XYValue_Line,this.IsHScreen=!1,this.LineWidth=1,this.IsDrawFirst=!0,this.TextColor="rgb(255,255,255)",this.Title,this.Super_SetOption=this.SetOption,this.SetOption=function(t){this.Super_SetOption&&this.Super_SetOption(t),t&&(t.TextColor&&(this.TextColor=t.TextColor),t.Title&&(this.Title=t.Title))},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()){var t=this.CalculateDrawPoint({IsCheckX:!1,IsCheckY:!0});if(t&&1==t.length&&this.IsYValueInFrame(this.Value[0].YValue)){this.IsHScreen=this.Frame.IsHScreen;var e=this.Frame.ChartBorder,a=this.Frame.GetBorder();if(this.IsHScreen){var i=a.LeftEx,r=a.RightEx,n=a.Bottom,s=a.Top,o={X:t[0].X,Y:s};if(o.X<i||o.X>r)return;var h={X:t[0].X,Y:n},l=this.Frame.GetYData(o.X,!1)}else{n=a.BottomEx,s=a.TopTitle,i=a.Left,r=a.Right,o={X:i,Y:t[0].Y};if(o.Y<s||o.Y>n)return;h={X:r,Y:t[0].Y},l=this.Frame.GetYData(o.Y,!1)}this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(Q(o.X),Q(o.Y)),this.Canvas.lineTo(Q(h.X),Q(h.Y)),this.Canvas.stroke(),this.RestoreLineWidth();var u={Start:o,End:h};this.LinePoint.push(u);var C=U();this.Canvas.font=this.Font;var D=2*C,f=h.X,c=h.Y;this.Canvas.textBaseline="middle",this.Canvas.textAlign="left";var d=this.GetFontHeight(),m=l.toFixed(2),v=this.Canvas.measureText(m).width+2*D;if(this.IsHScreen){if(e.Bottom>10)var S={Left:f-d/2,Top:c,Width:d,Height:v};else{c-=v;S={Left:f-d/2,Top:c,Width:d,Height:v}}if(this.Canvas.fillStyle=this.LineColor,this.Canvas.fillRect(S.Left,S.Top,S.Width,S.Height),this.Canvas.save(),this.Canvas.translate(f,c+1*C),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,0,0),this.Canvas.restore(),this.Title){v=this.Canvas.measureText(this.Title).width+2*C;if(e.Bottom>10)var I={Left:S.Left,Top:n-v-1*C,Width:d,Height:v};else I={Left:S.Left,Top:S.Top-v-1*C,Width:d,Height:v};this.Canvas.fillStyle=this.LineColor,this.Canvas.fillRect(I.Left,I.Top,I.Width,I.Height),this.Canvas.save(),this.Canvas.translate(f,I.Top+1*C),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(this.Title,0,0),this.Canvas.restore()}}else{if(e.Right>10){S={Left:f,Top:c-d/2-1*C,Width:v,Height:d};S.Left+S.Width>a.ChartWidth&&(S.Left=a.ChartWidth-S.Width-2*C)}else S={Left:f-v,Top:c-d/2-1*C,Width:v,Height:d};if(this.Canvas.fillStyle=this.LineColor,this.Canvas.fillRect(S.Left,S.Top,S.Width,S.Height),this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(m,S.Left+D,c),this.Title){v=this.Canvas.measureText(this.Title).width+2*C;if(e.Right>10){I={Left:r-v-1*C,Top:S.Top,Width:v,Height:d};S.Left!=r&&(I.Left=S.Left-v-1*C)}else I={Left:S.Left-v,Top:S.Top,Width:v,Height:d};this.Canvas.fillStyle=this.LineColor,this.Canvas.fillRect(I.Left,I.Top,I.Width,I.Height),this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(this.Title,I.Left+1*C,c)}}}}},this.DrawPrice=function(){}}function pi(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawVerticalLine",this.PointCount=1,this.IsPointIn=this.IsPointIn_XYValue_Line,this.IsHScreen=!1,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&this.Frame&&this.Frame.Data){var t=this.Frame.Data,e=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(e&&1==e.length){this.IsHScreen=this.Frame.IsHScreen;var a=e[0],i=this.Frame.ChartBorder;if(this.IsHScreen){var r=Math.round(this.Frame.GetXData(a.Y,!1))+t.DataOffset;r<0?r=0:r>=t.Data.length&&(r=t.Data.length-1);var n=this.Frame.GetXFromIndex(r-t.DataOffset,!1);n=$(this.LineWidth,n);var s=i.GetLeftEx(),o=i.GetRightEx(),h={X:s,Y:n},l={X:o,Y:n}}else{r=Math.round(this.Frame.GetXData(a.X,!1))+t.DataOffset;r<0?r=0:r>=t.Data.length&&(r=t.Data.length-1);var u=this.Frame.GetXFromIndex(r-t.DataOffset,!1);u=$(this.LineWidth,u);var C=i.GetTopEx(),D=i.GetBottomEx();h={X:u,Y:C},l={X:u,Y:D}}this.ClipFrame(),this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor,this.Canvas.beginPath(),this.Canvas.moveTo(h.X,h.Y),this.Canvas.lineTo(l.X,l.Y),this.Canvas.stroke(),this.RestoreLineWidth();var f={Start:h,End:l};this.LinePoint.push(f),10==this.Status&&this.DrawPoint(e),this.Canvas.restore()}}}}function Ti(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawWaveRuler",this.PointCount=3,this.Font=16*U()+"px å¾®è½¯éé»",this.IsPointIn=this.IsPointIn_XYValue_Line,this.LastPoint,this.LinePoint,this.ScaleRuler=Oi.ChartDrawWaveRuler.ScaleRuler,this.RulerWidth=Oi.ChartDrawWaveRuler.RulerWidth,this.RulerLineWidth=Oi.ChartDrawWaveRuler.RulerLineWidth,this.MaxScaleRuler=Oi.ChartDrawWaveRuler.MaxScaleRuler,this.Font=Oi.ChartDrawWaveRuler.MaxScaleRuler,this.IsHScreen=!1,this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t){for(var e in this.IsHScreen=this.Frame.IsHScreen,this.CalculateLines(t),this.ClipFrame(),this.SetLineWidth(),this.LinePoint){var a=this.LinePoint[e];this.DrawLine(a.Start,a.End)}3==t.length&&this.DrawWaveRuler(t),this.RestoreLineWidth(),this.DrawPoint(t),this.Canvas.restore()}}},this.SetLastPoint=function(t){this.LastPoint={X:t.X,Y:t.Y}},this.CalculateLines=function(t){if(2==this.PointStatus&&this.LastPoint){var e=new at;e.X=this.LastPoint.X,e.Y=this.LastPoint.Y,t[2]=e}if(2==t.length){var a={Start:{X:t[0].X,Y:t[0].Y},End:{X:t[1].X,Y:t[1].Y}};this.LinePoint.push(a)}else if(3==t.length){a={Start:{X:t[0].X,Y:t[0].Y},End:{X:t[1].X,Y:t[1].Y}};this.LinePoint.push(a),a={Start:{X:t[1].X,Y:t[1].Y},End:{X:t[2].X,Y:t[2].Y}},this.LinePoint.push(a)}},this.DrawWaveRuler=function(t){var e=t[1],a=t[0],i=t[2],r=this.RulerLineWidth*U();this.Canvas.lineWidth=r,this.Canvas.textBaseline="middle",this.Canvas.textAlign="left",this.Canvas.fillStyle=this.LineColor,this.Canvas.font=this.Font;var n=this.RulerWidth*U();if(this.IsHScreen){var s=a.X-e.X,o={X:i.X-this.MaxScaleRuler*s,Y:i.Y};this.DrawLine(i,o),this.LinePoint.push({Start:i,End:o});var h=i.Y-n/2,l=i.Y+n/2}else{s=a.Y-e.Y,o={X:$(r,i.X),Y:i.Y-this.MaxScaleRuler*s};this.DrawLine({X:$(r,i.X),Y:i.Y},o),this.LinePoint.push({Start:i,End:o});var u=i.X-n/2,C=i.X+n/2}var D=4*U();for(var f in this.ScaleRuler){var c=this.ScaleRuler[f];if(this.IsHScreen){u=i.X-c.Value*s;var d=this.Frame.GetYData(u,!1);this.DrawLine({X:u,Y:h},{X:u,Y:l});var m=d.toFixed(2)+"  "+(c.Text?c.Text:c.Value.toFixed(3));this.Canvas.save(),this.Canvas.translate(u,i.Y),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(m,D,0),this.Canvas.restore()}else{h=i.Y-c.Value*s,d=this.Frame.GetYData(h,!1);this.DrawLine({X:u,Y:$(r,h)},{X:C,Y:$(r,h)});m=d.toFixed(2)+"  "+(c.Text?c.Text:c.Value.toFixed(3));this.Canvas.fillText(m,C+D,h)}}}}function gi(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawWaveRuler2Point",this.PointCount=2,this.Font=14*U()+"px å¾®è½¯éé»",this.IsPointIn=this.IsPointIn_XYValue_Line,this.PointRate=[510,517,511.4],this.LinePoint,this.CPoint,this.ScaleRuler=Oi.ChartDrawWaveRuler2Point.ScaleRuler,this.RulerWidth=Oi.ChartDrawWaveRuler2Point.RulerWidth,this.RulerLineWidth=Oi.ChartDrawWaveRuler2Point.RulerLineWidth,this.MaxScaleRuler=Oi.ChartDrawWaveRuler2Point.MaxScaleRuler,this.Font=Oi.ChartDrawWaveRuler2Point.MaxScaleRuler,this.IsHScreen=!1,this.Super_SetOption=this.SetOption,this.SetOption=function(t){this.Super_SetOption&&this.Super_SetOption(t),t&&t.PointRate&&(this.PointRate=t.PointRate)},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t){for(var e in this.IsHScreen=this.Frame.IsHScreen,this.CalculateLines(t),this.ClipFrame(),this.SetLineWidth(),this.LinePoint){var a=this.LinePoint[e];this.DrawLine(a.Start,a.End)}var i=[t[0],t[1],this.CPoint];this.DrawWaveRuler(i),this.RestoreLineWidth(),this.DrawPoint(t),this.Canvas.restore()}}},this.CalculateLines=function(t){var e={Start:{X:t[0].X,Y:t[0].Y},End:{X:t[1].X,Y:t[1].Y}};this.LinePoint.push(e);var a=t[0].Y,i=t[1].Y,r=this.PointRate[1]-this.PointRate[0],n=this.PointRate[2]-this.PointRate[0],s=a-(a-i)*n/r;this.CPoint={X:t[1].X,Y:s}},this.DrawWaveRuler=function(t){var e=t[1],a=t[0],i=t[2],r=this.RulerLineWidth*U();this.Canvas.lineWidth=r,this.Canvas.textBaseline="middle",this.Canvas.textAlign="left",this.Canvas.fillStyle=this.LineColor,this.Canvas.font=this.Font;var n=this.RulerWidth*U();if(this.IsHScreen){var s=a.X-e.X,o={X:i.X-this.MaxScaleRuler*s,Y:i.Y};this.DrawLine(i,o),this.LinePoint.push({Start:i,End:o});var h=i.Y-n/2,l=i.Y+n/2}else{s=a.Y-e.Y,o={X:$(r,i.X),Y:i.Y-this.MaxScaleRuler*s};this.DrawLine({X:$(r,i.X),Y:i.Y},o),this.LinePoint.push({Start:i,End:o});var u=i.X,C=i.X+n}var D=4*U();for(var f in this.ScaleRuler){var c=this.ScaleRuler[f];if(this.IsHScreen){u=i.X-c.Value*s;var d=this.Frame.GetYData(u,!1);this.DrawLine({X:u,Y:h},{X:u,Y:l});var m=d.toFixed(2)+"  "+(c.Text?c.Text:c.Value.toFixed(3));this.Canvas.save(),this.Canvas.translate(u,i.Y),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(m,D,0),this.Canvas.restore()}else{h=i.Y-c.Value*s,d=this.Frame.GetYData(h,!1);this.DrawLine({X:u,Y:$(r,h)},{X:C,Y:$(r,h)});m=d.toFixed(2)+"  "+(c.Text?c.Text:c.Value.toFixed(3));this.Canvas.fillText(m,C+D,h)}}}}function xi(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawBox",this.PointCount=2,this.Font=16*U()+"px å¾®è½¯éé»",this.IsPointIn=this.IsPointIn_XYValue_Line,this.IsHScreen=!1,this.AvPriceLineDash=[5*U(),5*U()],this.KLineBorder,this.PointToValue_Backup=this.PointToValue,this.PointToValue=function(){this.Point[0]={X:this.KLineBorder.Left,Y:this.KLineBorder.Top},this.Point[1]={X:this.KLineBorder.Right,Y:this.KLineBorder.Bottom},this.PointToValue_Backup()},this.Draw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){this.IsHScreen=this.Frame.IsHScreen,this.ClipFrame();var e=t[0],a=t[1],i=this.PointToKLine([e,a]);w.Chart.Log("[ChartDrawBox::Draw] kPoint",i);var r=this.Calculate(i);w.Chart.Log("[ChartDrawBox::Draw] kDataInfo",r);var n,s=this.GetKLineBorder(t,r);if(this.KLineBorder=s,this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor,this.Canvas.strokeRect(tt(s.Left),tt(s.Top),tt(s.Right-s.Left),tt(s.Bottom-s.Top)),r.Amount>0&&r.Vol>0){var o=r.Amount/r.Vol;if(n="åä»·"+o.toFixed(2),this.Canvas.beginPath(),this.IsHScreen){var h=this.Frame.GetYFromData(o,!1);this.Canvas.moveTo($(this.Canvas.lineWidth,h),s.Top),this.Canvas.lineTo($(this.Canvas.lineWidth,h),s.Bottom)}else{var l=this.Frame.GetYFromData(o,!1);this.Canvas.moveTo(s.Left,$(this.Canvas.lineWidth,l)),this.Canvas.lineTo(s.Right,$(this.Canvas.lineWidth,l))}this.Canvas.setLineDash(this.AvPriceLineDash),this.Canvas.stroke(),this.Canvas.setLineDash([])}this.RestoreLineWidth(),this.DrawPoint(t),this.Canvas.textBaseline="top",this.Canvas.textAlign="left",this.Canvas.font=this.Font,this.Canvas.fillStyle=this.LineColor;var u=2*U(),C="Kçº¿æ°"+r.Count;this.IsHScreen?this.DrawText(C,s.Right,s.Top,u,u):this.DrawText(C,s.Left,s.Top,u,u),n&&(this.IsHScreen?this.DrawText(n,h,s.Top,u,u):this.DrawText(n,s.Left,l,u,u));var D=ha.IsNumber(r.YClose)?r.YClose:r.Open,f=(r.Close-D)/D*100;C=f.toFixed(2)+"%",this.IsHScreen?this.DrawText(C,s.Right,s.Bottom,u,u):this.DrawText(C,s.Right,s.Top,u,u),f=r.Close-D,C=""+f.toFixed(2),this.Canvas.textBaseline="bottom",this.IsHScreen?this.DrawText(C,s.Left,s.Bottom,u,0):this.DrawText(C,s.Right,s.Bottom,u,0),this.Canvas.restore()}}},this.Calculate=function(t){var e=t[0],a=t[1];e.XValue>a.XValue&&(e=t[1],a=t[0]);for(var i,r,n,s,o,h=this.Frame.Data.Data,l=0,u=0,C=0,D=e.XValue;D<=a.XValue;++D,++C){var f=h[D];0==C?(s=f.YClose,i=f.Open,o=f.Close,n=f.Low,r=f.High):(o=f.Close,n>f.Low&&(n=f.Low),r<f.High&&(r=f.High)),l+=f.Vol,u+=f.Amount}var c={YClose:s,Open:i,High:r,Low:n,Close:o,Count:C,Vol:l,Amount:u};return c},this.GetKLineBorder=function(t,e){var a=t[0],i=t[1],r=this.Frame.Data;if(this.IsHScreen){var n=Math.round(this.Frame.GetXData(a.Y,!1))+r.DataOffset;n<0?n=0:n>=r.Data.length&&(n=r.Data.length-1);var s=this.Frame.GetXFromIndex(n-r.DataOffset,!1);n=Math.round(this.Frame.GetXData(i.Y,!1))+r.DataOffset,n<0?n=0:n>=r.Data.length&&(n=r.Data.length-1);var o=this.Frame.GetXFromIndex(n-r.DataOffset,!1),h=this.Frame.GetYFromData(e.High,!1),l=this.Frame.GetYFromData(e.Low,!1),u={Left:l,Top:s,Right:h,Bottom:o};return this.LinePoint.push({Start:{X:l,Y:s},End:{X:o,Y:s}}),this.LinePoint.push({Start:{X:l,Y:o},End:{X:o,Y:o}}),this.LinePoint.push({Start:{X:l,Y:s},End:{X:l,Y:o}}),this.LinePoint.push({Start:{X:h,Y:s},End:{X:h,Y:o}}),u}n=Math.round(this.Frame.GetXData(a.X,!1))+r.DataOffset;n<0?n=0:n>=r.Data.length&&(n=r.Data.length-1);var C=this.Frame.GetXFromIndex(n-r.DataOffset,!1);n=Math.round(this.Frame.GetXData(i.X,!1))+r.DataOffset,n<0?n=0:n>=r.Data.length&&(n=r.Data.length-1);var D=this.Frame.GetXFromIndex(n-r.DataOffset,!1),f=this.Frame.GetYFromData(e.High,!1),c=this.Frame.GetYFromData(e.Low,!1);u={Left:C,Top:f,Right:D,Bottom:c};return this.LinePoint.push({Start:{X:C,Y:f},End:{X:D,Y:f}}),this.LinePoint.push({Start:{X:C,Y:c},End:{X:D,Y:c}}),this.LinePoint.push({Start:{X:C,Y:f},End:{X:C,Y:c}}),this.LinePoint.push({Start:{X:D,Y:f},End:{X:D,Y:c}}),u},this.DrawText=function(t,e,a,i,r){this.IsHScreen?(this.Canvas.save(),this.Canvas.translate(e,a),this.Canvas.rotate(90*Math.PI/180),this.Canvas.fillText(t,i,r),this.Canvas.restore()):this.Canvas.fillText(t,e+i,a+r)}}function Fi(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawTwoPointDemo",this.PointCount=2,this.Font=16*U()+"px å¾®è½¯éé»",this.IsPointIn=this.IsPointIn_XYValue_Line,this.IsHScreen=!1,this.PointInfo=[],this.PointToValue_Backup=this.PointToValue,this.PointToValue=function(){this.OnFinish(),this.PointToValue_Backup()},this.OnFinish=function(){for(var t in this.PointInfo){var e=this.PointInfo[t];e&&e.Point&&ha.IsNumber(e.Point.Y2)&&(this.Point[t].Y=this.PointInfo[t].Point.Y2)}},this.Draw=function(){if(this.LinePoint=[],this.PointInfo=[],!this.IsFrameMinSize()){var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t){this.IsHScreen=this.Frame.IsHScreen,this.ClipFrame(),this.SetLineWidth();t[0],t[1];if(this.CalculatePointInfo(t),10==this.Status)this.DrawEx();else for(var e=1;e<t.length;++e)this.DrawLine(t[e-1],t[e]);this.RestoreLineWidth(),this.DrawPoint(t),this.Canvas.restore()}}},this.CalculatePointInfo=function(t){if(this.Frame&&this.Frame.Data){var e=this.PointToKLine(t);if(3==this.PointCount&&2==this.PointStatus&&this.LastPoint){var a=new at;a.X=this.LastPoint.X,a.Y=this.LastPoint.Y,t[2]=a}var i=this.Frame.Data;for(var r in e){var n=e[r],s=(a=t[r],i.Data[n.XValue]),o={KItem:s,Data:n,Point:{X:a.X,Y:a.Y}};this.PointInfo.push(o)}this.CalculateYPoint(),w.Chart.Log("[ChartDrawTwoPointDemo::CalculateLines] kPoint",this.PointInfo)}},this.CalculateYPoint=function(){var t=this.PointInfo[0],e=this.Frame.GetYFromData(t.KItem.Low,!1);t.Point.Y2=e;var a=this.PointInfo[1],i=this.Frame.GetYFromData(a.KItem.High,!1);a.Point.Y2=i},this.DrawEx=function(){var t=this.PointInfo[0],e=this.PointInfo[1],a=this.Frame.ChartBorder,i=(a.GetRight(),{X:t.Point.X,Y:t.Point.Y2}),r={X:e.Point.X,Y:e.Point.Y2};this.DrawLine(i,r),this.LinePoint.push({Start:i,End:r}),this.Canvas.setLineDash([5,5]);var n=.09*e.KItem.YClose+e.KItem.High,s=this.Frame.GetYFromData(n,!1);this.DrawLine({X:this.ToFixedPoint(r.X),Y:r.Y},{X:this.ToFixedPoint(r.X),Y:s}),this.Canvas.textAlign="right",this.Canvas.textBaseline="center",this.Canvas.fillStyle="rgb(33,45,100)";for(var o=3;o>0;--o){var h=e.KItem.YClose*(.03*o)+e.KItem.High;s=this.Frame.GetYFromData(h,!1);s=this.ToFixedPoint(s),this.DrawLine({X:r.X,Y:s},{X:r.X+100,Y:s}),this.Canvas.fillText(h.toFixed(2),r.X-5,s)}this.Canvas.setLineDash([])},this.ToFixedPoint=function(t,e){return ha.IsNumber(e)||(e=this.LineWidth),$(e,t)}}function yi(){this.newMethod=Fi,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawThreePointDemo",this.PointCount=3,this.SetLastPoint=function(t){this.LastPoint={X:t.X,Y:t.Y}},this.CalculateYPoint=function(){var t;for(var e in this.PointInfo){var a=this.PointInfo[e];t=0==e||2==e?this.Frame.GetYFromData(a.KItem.Low,!1):this.Frame.GetYFromData(a.KItem.High,!1),a.Point.Y2=t}},this.DrawEx=function(){var t=this.PointInfo[0],e=this.PointInfo[1],a=this.PointInfo[2],i=this.Frame.ChartBorder,r=(i.GetRight(),i.GetLeft(),{X:t.Point.X,Y:t.Point.Y2}),n={X:e.Point.X,Y:e.Point.Y2},s={X:a.Point.X,Y:a.Point.Y2};this.DrawLine(r,n),this.DrawLine(n,s),this.LinePoint.push({Start:r,End:n}),this.LinePoint.push({Start:n,End:s}),this.Canvas.setLineDash([5,5]);var o=.09*a.KItem.YClose+a.KItem.High,h=this.Frame.GetYFromData(o,!1);this.DrawLine({X:this.ToFixedPoint(s.X),Y:s.Y},{X:this.ToFixedPoint(s.X),Y:h}),this.Canvas.textAlign="right",this.Canvas.textBaseline="center",this.Canvas.fillStyle="rgb(33,45,100)";for(var l=3;l>0;--l){var u=a.KItem.YClose*(.03*l)+a.KItem.High;h=this.Frame.GetYFromData(u,!1);h=this.ToFixedPoint(h),this.DrawLine({X:s.X,Y:h},{X:s.X+100,Y:h}),this.Canvas.fillText(u.toFixed(2),s.X-5,h)}this.Canvas.setLineDash([])}}function Li(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawHLineSegment",this.PointCount=2,this.IsPointIn=this.IsPointIn_XYValue_Line,this.ChartBorder,this.PointToValue_Backup=this.PointToValue,this.PointToValue=function(){this.Frame.IsHScreen?this.Point[1].X=this.Point[0].X:this.Point[1].Y=this.Point[0].Y,this.PointToValue_Backup()},this.GetXYCoordinate=function(){if(this.IsFrameMinSize())return null;var t=this.CalculateDrawPoint({IsCheckX:!1,IsCheckY:!0});return this.PointRange(t)},this.Draw=function(){if(this.Frame&&(this.IsHScreen=this.Frame.IsHScreen,this.LinePoint=[],!this.IsFrameMinSize())){var t=this.CalculateDrawPoint({IsCheckX:!1,IsCheckY:!0});if(t&&2==t.length){this.ClipFrame(),this.ChartBorder=this.Frame.ChartBorder,this.SetLineWidth(),this.Canvas.strokeStyle=this.LineColor;var e=t[0],a=t[1];10==this.Status?this.DrawLine(e,a,!1):this.DrawVerticalLine(e,a),this.RestoreLineWidth();var i={Start:e,End:a};this.LinePoint.push(i),this.DrawPoint(t),this.Canvas.restore()}}},this.DrawVerticalLine=function(t,e){var a=this.Frame.Data;if(this.IsHScreen){var i=this.ChartBorder.GetLeft(),r=this.ChartBorder.GetRight(),n=Math.round(this.Frame.GetXData(t.Y,!1))+a.DataOffset;n<0?n=0:n>=a.Data.length&&(n=a.Data.length-1);var s=this.Frame.GetXFromIndex(n-a.DataOffset,!1);n=Math.round(this.Frame.GetXData(e.Y,!1))+a.DataOffset,n<0?n=0:n>=a.Data.length&&(n=a.Data.length-1);var o=this.Frame.GetXFromIndex(n-a.DataOffset,!1);this.Canvas.beginPath(),this.Canvas.moveTo(i,s),this.Canvas.lineTo(r,s),this.Canvas.moveTo(i,o),this.Canvas.lineTo(r,o),this.Canvas.stroke(),this.Canvas.beginPath(),this.Canvas.moveTo(t.X,s),this.Canvas.lineTo(t.X,o),this.Canvas.stroke()}else{var h=this.ChartBorder.GetTopEx(),l=this.ChartBorder.GetBottomEx();n=Math.round(this.Frame.GetXData(t.X,!1))+a.DataOffset;n<0?n=0:n>=a.Data.length&&(n=a.Data.length-1);var u=this.Frame.GetXFromIndex(n-a.DataOffset,!1);n=Math.round(this.Frame.GetXData(e.X,!1))+a.DataOffset,n<0?n=0:n>=a.Data.length&&(n=a.Data.length-1);var C=this.Frame.GetXFromIndex(n-a.DataOffset,!1);this.Canvas.beginPath(),this.Canvas.moveTo(u,h),this.Canvas.lineTo(u,l),this.Canvas.moveTo(C,h),this.Canvas.lineTo(C,l),this.Canvas.stroke(),this.Canvas.beginPath(),this.Canvas.moveTo(u,t.Y),this.Canvas.lineTo(C,t.Y),this.Canvas.stroke()}}}function Ei(){this.newMethod=ka,this.newMethod(),delete this.newMethod,this.ClassName="ChartDrawVolProfile",this.PointCount=2,this.IsPointIn=this.IsPointIn_XYValue_Line,this.ChartBorder,this.GetXYCoordinate=this.GetXYCoordinate_default,this.IsShowText=!0,this.VolType=0,this.BarPosition=0,this.VolFont,this.VAVol=60,this.BarWidthRate=.3,this.Data,this.MaxVol,this.MaxVolPrice,this.DataStatus=0,this.BGColor=Oi.ChartDrawVolProfile.BGColor,this.BorderColor=Oi.ChartDrawVolProfile.BorderColor,this.VolLineColor=Oi.ChartDrawVolProfile.VolLineColor,this.TextConfig=(0,v.default)({Color:Oi.ChartDrawVolProfile.Text.Color,Family:Oi.ChartDrawVolProfile.Text.Family,FontMaxSize:Oi.ChartDrawVolProfile.Text.FontMaxSize,FontMinSize:Oi.ChartDrawVolProfile.Text.FontMinSize},"Color",Oi.ChartDrawVolProfile.Text.Color),this.BarColor=[Oi.ChartDrawVolProfile.UpVolColor,Oi.ChartDrawVolProfile.DownVolColor,Oi.ChartDrawVolProfile.AreaUpColor,Oi.ChartDrawVolProfile.AreaDonwColor],this.Super_SetOption=this.SetOption,this.SetOption=function(t){this.Super_SetOption&&this.Super_SetOption(t),t&&(t.BGColor&&(this.BGColor=t.BGColor),t.BorderColor&&(this.BGColor=t.BorderColor),t.VolLineColor&&(this.BGColor=t.VolLineColor),t.UpVolColor&&(this.BarColor[0]=t.UpVolColor),t.DownVolColor&&(this.BarColor[1]=t.DownVolColor),t.AreaUpColor&&(this.BarColor[2]=t.AreaUpColor),t.AreaDonwColor&&(this.BarColor[3]=t.AreaDonwColor),ha.IsNumber(t.BarWidthRate)&&(this.BarWidthRate=t.BarWidthRate),ha.IsBool(t.IsShowText)&&(this.IsShowText=t.IsShowText),ha.IsNumber(t.VolType)&&(this.VolType=t.VolType),ha.IsNumber(t.BarPosition)&&(this.BarPosition=t.BarPosition),ha.IsNumber(t.VAVol)&&(this.VAVol=t.VAVol))},this.OnFinish=function(){this.RequestVolumeProfileData()},this.OnMoveFinish=function(){this.RequestVolumeProfileData()},this.IsDrawMain=function(){if(!this.GetActiveDrawPicture)return!0;var t=this.GetActiveDrawPicture();return t.Select.Guid!=this.Guid},this.RequestVolumeProfileData=function(){var t=this.Value[0],e=this.Value[1];t.XValue>e.XValue&&(t=this.Value[1],e=this.Value[0]);var a={Start:{Date:t.DateTime.Date,DataIndex:t.XValue},End:{Date:e.DateTime.Date,DataIndex:e.XValue},Chart:this};ha.IsNumber(t.DateTime.Time)&&(a.Start.Time=t.DateTime.Time),ha.IsNumber(e.DateTime.Time)&&(a.End.Time=e.DateTime.Time),a.ValueAreaVol=this.VAVol,this.DataStatus=0,this.HQChart&&this.HQChart.RequestVolumeProfileData&&this.HQChart.RequestVolumeProfileData(a)},this.OnRecvVolumeProfileData=function(t){if(t&&ha.IsNonEmptyArray(t.Data)){for(var e=0,a=0,i=null,r=0,n=0;r<t.Data.length;++r){var s=t.Data[r];for(a=0,n=0;n<s.Vol.length;++n){var o=s.Vol[n];ha.IsNumber(o.Value)&&(a+=o.Value)}e<a&&(e=a,i=s.Price)}if(this.MaxVolPrice=i,this.MaxVol=e,!(this.MaxVolPrice<=0||this.MaxVol<=0)&&ha.IsNumber(t.MaxPrice)&&ha.IsNumber(t.MinPrice)){var h=this.Frame.GetYFromData(t.MaxPrice,!1),l=this.Frame.GetYFromData(t.MinPrice,!1);this.Point[0].Y=h,this.Point[1].Y=l,this.PointToValue(),this.Data=t,this.DataStatus=1}}},this.Draw=function(){if(this.VolFont=null,this.IsDrawMain()||this.MainDraw(),!this.IsFrameMinSize()){this.Frame&&(this.ChartBorder=this.Frame.ChartBorder);var t=this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});if(t&&2==t.length){this.ClipFrame(),this.SetLineWidth();var e=t[0],a=t[1];10==this.Status?0==this.DataStatus&&this.DrawLineBorder(e,a):this.DrawLineBorder(e,a),this.RestoreLineWidth(),this.DrawPoint(t),this.Canvas.restore()}}},this.MainDraw=function(){if(this.LinePoint=[],!this.IsFrameMinSize()&&1==this.DataStatus&&10==this.Status){this.ClipFrame();this.CalculateDrawPoint({IsCheckX:!0,IsCheckY:!0});this.DrawVolBar(),this.Canvas.restore()}},this.DrawLineBorder=function(t,e){this.Canvas.strokeStyle=this.LineColor;var a=this.ChartBorder.GetTopEx(),i=this.ChartBorder.GetBottomEx();this.Canvas.beginPath(),this.Canvas.moveTo(t.X,t.Y),this.Canvas.lineTo(e.X,e.Y),this.Canvas.moveTo(t.X,a),this.Canvas.lineTo(t.X,i),this.Canvas.moveTo(e.X,a),this.Canvas.lineTo(e.X,i),this.Canvas.stroke()},this.DrawVolBar=function(){var t=this.Value[0],e=this.Value[1];t.XValue>e.XValue&&(t=this.Value[1],e=this.Value[0]);var a=this.GetKDataOffset(),i=this.GetPriceYOffset(this.Data.PriceOffset),r=this.Frame.GetXFromIndex(t.XValue-a,!1),n=this.Frame.GetXFromIndex(e.XValue-a,!1),s=this.Frame.GetYFromData(this.Data.MaxPrice)-i/2,o=this.Frame.GetYFromData(this.Data.MinPrice)+i/2,h=n-r,l=o-s,u=h*this.BarWidthRate;if(this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(r,s,h,l),this.MaxVolPrice>=this.Frame.HorizontalMin&&this.MaxVolPrice<=this.Frame.HorizontalMax){var C=2,D=$(C,this.Frame.GetYFromData(this.MaxVolPrice,!1));this.Canvas.lineWidth=C,this.Canvas.strokeStyle=this.VolLineColor,this.Canvas.beginPath(),this.Canvas.moveTo(r,D),this.Canvas.lineTo(n,D),this.Canvas.stroke();var f={Start:{X:r,Y:D},End:{X:n,Y:D}};this.LinePoint.push(f)}this.IsShowText&&(this.VolFont=this.GetDynamicVolTextFont(i,u),this.VolFont&&(this.Canvas.font=this.VolFont));for(var c=0;c<this.Data.Data.length;++c){var d=this.Data.Data[c];d.Price<this.Frame.HorizontalMin||d.Price>this.Frame.HorizontalMax||this.DrawVolBarItem(d,r,n,u,i)}},this.DrawVolBarItem=function(t,e,a,i,r){var n=e,s=a,o=this.Frame.GetYFromData(t.Price)-r/2,h=r-1;if(h<1&&(h=1),1==this.VolType){if(!t.TotalVol)return;if(!ha.IsNumber(t.TotalVol.Value))return;var l=t.TotalVol.Value*i/this.MaxVol;if(ha.IsNumber(t.TotalVol.ColorID)?D=this.BarColor[t.TotalVol.ColorID]:t.TotalVol.Color&&(D=t.TotalVol.Color),this.Canvas.fillStyle=D,1==this.BarPosition?this.Canvas.fillRect(s,tt(o),-l,tt(h)):this.Canvas.fillRect(n,tt(o),l,tt(h)),this.IsShowText&&this.VolFont){var u=ha.FormatVolString(t.TotalVol.Value,this.HQChart.LanguageID);this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextConfig.Color,1==this.BarPosition?(this.Canvas.textAlign="right",this.Canvas.fillText(u,a-5,o+r/2)):(this.Canvas.textAlign="left",this.Canvas.fillText(u,e+5,o+r/2))}}else{u="";for(var C=0;C<t.Vol.length;++C){var D,f=t.Vol[C];if(ha.IsNumber(f.Value))if(ha.IsNumber(f.ColorID)?D=this.BarColor[f.ColorID]:f.Color&&(D=f.Color),D){l=f.Value*i/this.MaxVol;this.Canvas.fillStyle=D,1==this.BarPosition?(this.Canvas.fillRect(s,tt(o),-l,tt(h)),s-=l):(this.Canvas.fillRect(n,tt(o),l,tt(h)),n+=l);var c=ha.FormatVolString(f.Value,this.HQChart.LanguageID);u.length>0&&(u+="x"),u+=c}}this.IsShowText&&this.VolFont&&(this.Canvas.textBaseline="middle",this.Canvas.fillStyle=this.TextConfig.Color,1==this.BarPosition?(this.Canvas.textAlign="right",this.Canvas.fillText(u,a-5,o+r/2)):(this.Canvas.textAlign="left",this.Canvas.fillText(u,e+5,o+r/2)))}},this.GetKDataOffset=function(){var t=this.HQChart.ChartPaint[0].Data;return t.DataOffset},this.GetPriceYOffset=function(t){var e=this.Frame,a=e.ChartBorder.GetHeightEx()*t/(e.HorizontalMax-e.HorizontalMin);return a},this.GetDynamicVolTextFont=function(t,e,a){var i=parseInt(t)-2;if(t<5&&(i=parseInt(t)),i>this.TextConfig.FontMaxSize?i=this.TextConfig.FontMaxSize:i<=0&&(i=1),i<this.TextConfig.FontMinSize)return null;var r=this.FormatFontString(i,this.TextConfig.Family,a);return r},this.FormatFontString=function(t,e,a){var i;return a?a.Weight&&(i=a.Weight+" "+t+"px "+e):i=t+"px "+e,i}}function Mi(){this.DrawData=new E.default,this.StorageKey,this.GetEventCallback,this.Load=function(t){if(t){this.StorageKey=t;var e=localStorage[this.StorageKey];if(w.Chart.Log("[ChartDrawStorage::Save] Load to localStorage, key="+this.StorageKey+", cache="+e),e&&"string"==typeof e){var a=JSON.parse(e);for(var i in a){var r=a[i],n=new E.default;for(var s in r.Value){var o=r.Value[s];n.set(o.Key,o.Value)}this.DrawData.set(r.Key,n)}}}},this.Save=function(){if(this.StorageKey){var t=[],e=!0,a=!1,i=void 0;try{for(var r,n=(0,T.default)(this.DrawData);!(e=(r=n.next()).done);e=!0){var s=r.value,o=s[0],h=s[1],l={Key:o,Value:[]},u=!0,C=!1,D=void 0;try{for(var f,c=(0,T.default)(h);!(u=(f=c.next()).done);u=!0){var d=f.value;d[1]&&!1===d[1].EnableSave||l.Value.push({Key:d[0],Value:d[1]})}}catch(v){C=!0,D=v}finally{try{!u&&c.return&&c.return()}finally{if(C)throw D}}ha.IsNonEmptyArray(l.Value)&&t.push(l)}}catch(v){a=!0,i=v}finally{try{!e&&n.return&&n.return()}finally{if(a)throw i}}w.Chart.Log("[ChartDrawStorage::Save] save to localStorage, key="+this.StorageKey);var m=(0,F.default)(t);localStorage[this.StorageKey]=m}},this.GetItemKey=function(t){var e=t.Symbol+"-"+t.Period;return e},this.SaveDrawData=function(t){var e=this.GetItemKey(t),a=t.ExportStorageData();if(a){if(this.DrawData.has(e))w.Chart.Log("[ChartDrawStorage::SaveDrawData] Upate: key, drawPicture, data",e,t,a),this.DrawData.get(e).set(a.Guid,a);else{w.Chart.Log("[ChartDrawStorage::SaveDrawData] Insert: key, drawPicture, data",e,t,a);var i=new E.default;i.set(a.Guid,a),this.DrawData.set(e,i)}w.Chart.Log("[ChartDrawStorage::SaveDrawData] All draw dataï¼ ",this.DrawData),this.Save()}},this.DeleteDrawData=function(t){var e=this.GetItemKey(t);if(this.DrawData.has(e)){var a=this.DrawData.get(e);a.has(t.Guid)&&(a.delete(t.Guid),this.Save())}},this.Clear=function(){this.DrawData=new E.default,this.Save()},this.GetDrawData=function(t){var e=[],a=this.GetItemKey(t);if(!this.DrawData.has(a))return e;var i=this.DrawData.get(a),r=!0,n=!1,s=void 0;try{for(var o,h=(0,T.default)(i);!(r=(o=h.next()).done);r=!0){var l=o.value;e.push(l[1])}}catch(u){n=!0,s=u}finally{try{!r&&h.return&&h.return()}finally{if(n)throw s}}return e}}function Ai(){this.Data=[[1e-6,2e-6,1e-6,1e-7],[2e-6,4e-6,2e-6,2e-7],[4e-6,5e-6,4e-6,1e-7],[5e-6,1e-5,5e-6,5e-7],[1e-5,2e-5,1e-5,1e-6],[2e-5,4e-5,2e-5,2e-6],[4e-5,5e-5,4e-5,1e-6],[5e-5,1e-4,5e-5,5e-6],[1e-4,2e-4,1e-4,1e-5],[2e-4,4e-4,2e-4,2e-5],[4e-4,5e-4,4e-4,1e-5],[5e-4,.001,5e-4,5e-5],[.001,.002,.001,1e-4],[.002,.004,.002,2e-4],[.004,.005,.004,1e-4],[.005,.01,.005,5e-4],[.01,.02,.01,.001],[.02,.04,.02,.002],[.04,.05,.04,.001],[.05,.1,.05,.005],[.1,.2,.1,.01],[.2,.4,.2,.02],[.4,.5,.4,.01],[.5,1,.5,.05],[1,2,.5,.05],[2,4,.5,.05],[4,5,.5,.05],[5,10,.5,.05],[10,20,10,2],[20,40,20,5],[40,50,40,2],[50,100,50,10],[100,200,100,10],[200,400,200,20],[400,500,400,10],[500,1e3,500,50],[1e3,2e3,1e3,50],[2e3,4e3,2e3,50],[4e3,5e3,4e3,50],[5e3,1e4,5e3,100],[1e4,2e4,1e4,1e3],[2e4,4e4,1e4,1e3],[4e4,5e4,1e4,1e3],[5e4,1e5,1e4,1e3],[1e5,2e5,1e5,1e4],[2e5,4e5,1e5,1e4],[4e5,5e5,1e5,1e4],[5e5,1e6,1e5,1e4],[1e6,2e6,1e6,1e5],[2e6,4e6,1e6,1e5],[4e6,5e6,1e6,1e5],[5e6,1e7,1e6,1e5],[1e7,2e7,1e7,1e6],[2e7,4e7,1e7,1e6],[4e7,5e7,1e7,1e6],[5e7,1e8,1e7,1e6],[1e8,2e8,1e8,1e7],[2e8,4e8,1e8,1e7],[4e8,5e8,1e8,1e7],[5e8,1e9,1e8,1e7],[1e9,2e9,1e9,1e8],[2e9,4e9,1e9,1e8],[4e9,5e9,1e9,1e8],[5e9,1e10,1e9,1e8]],this.Find=function(t){for(var e in this.Data){var a=this.Data[e];if(t>a[0]&&t<=a[1]){var i={};return i.FixInterval=a[2],i.Increase=a[3],i}}return null}}function Ni(){this.newMethod=Ai,this.newMethod(),delete this.newMethod,this.Data=[[1e-6,2e-6,1e-6,1e-7],[2e-6,4e-6,2e-6,2e-7],[4e-6,5e-6,4e-6,1e-7],[5e-6,1e-5,5e-6,5e-7],[1e-5,2e-5,1e-5,1e-6],[2e-5,4e-5,2e-5,2e-6],[4e-5,5e-5,4e-5,1e-6],[5e-5,1e-4,5e-5,5e-6],[1e-4,2e-4,1e-4,1e-5],[2e-4,4e-4,2e-4,2e-5],[4e-4,5e-4,4e-4,1e-5],[5e-4,.001,5e-4,5e-5],[.001,.002,.001,1e-4],[.002,.004,.002,1e-4],[.004,.005,.004,1e-4],[.005,.01,.005,5e-4],[.01,.02,.01,.001],[.02,.04,.02,.001],[.04,.05,.04,.001],[.05,.1,.05,.001],[.1,.2,.1,.01],[.2,.4,.2,.01],[.4,.5,.2,.01],[.5,.8,.2,.01],[.8,1,.5,.01],[1,2,.5,.05],[2,4,.5,.05],[4,5,.5,.05],[5,10,.5,.05],[10,12,10,2],[20,40,20,5],[40,50,40,2],[50,100,50,10],[100,200,100,10],[200,400,200,20],[400,500,400,10],[500,1e3,500,50],[1e3,2e3,1e3,50],[2e3,4e3,2e3,50],[4e3,5e3,4e3,50],[5e3,1e4,5e3,100],[1e4,2e4,1e4,1e3],[2e4,4e4,2e4,2e3],[4e4,5e4,4e4,1e3],[5e4,1e5,5e4,5e3],[1e5,2e5,1e5,1e4],[2e5,4e5,2e5,2e4],[4e5,5e5,4e5,1e4],[5e5,1e6,5e5,5e4],[1e6,2e6,1e6,1e5],[2e6,4e6,2e6,2e5],[4e6,5e6,4e6,1e5],[5e6,1e7,5e6,5e5],[1e7,2e7,1e7,1e6],[2e7,4e7,2e7,2e6],[4e7,5e7,4e7,1e6],[5e7,1e8,5e7,5e6],[1e8,2e8,1e8,1e7],[2e8,4e8,2e8,2e7],[4e8,5e8,4e8,1e7],[5e8,1e9,5e8,5e7],[1e9,2e9,1e9,1e8],[2e9,4e9,2e9,2e8],[4e9,5e9,4e9,1e8],[5e9,1e10,5e9,5e8]]}function wi(){this.TooltipBGColor="rgb(255, 255, 255)",this.TooltipAlpha=.92,this.SelectRectBGColor="rgba(1,130,212,0.06)",this.UpBarColor="rgb(238,21,21)",this.DownBarColor="rgb(25,158,0)",this.UnchagneBarColor="rgb(0,0,0)",this.EmptyBarBGColor="rgb(255,255,255)",this.Minute={},this.Minute.VolBarColor=null,this.Minute.VolTitleColor="rgb(105,105,105)",this.Minute.PriceColor="rgb(50,171,205)",this.Minute.AreaPriceColor="rgba(50,171,205,0.1)",this.Minute.AvPriceColor="rgb(238,127,9)",this.Minute.PositionColor="rgb(218,165,32)",this.Minute.FrameSplitTextColor=null,this.Minute.Before={BGColor:"rgba(240,240,240,0.7)",LineColor:"rgb(50,171,205)",VolColor:["rgb(192,192,0)"],AvPriceColor:"rgb(190,190,190)",Point:{Color:"rgb(65,105,225)",Radius:2*U()},CloseIcon:{Family:"iconfont",Text:"î",Color:"rgb(0,0,0)",MoveOnColor:"rgb(30,144,255)",Size:12*U()}},this.Minute.After={BGColor:"rgba(240,240,240,0.7)",LineColor:"rgb(50,171,205)",VolColor:["rgb(192,192,0)"],AvPriceColor:"rgb(190,190,190)",Point:{Color:"rgb(65,105,225)",Radius:2*U()}},this.DefaultTextColor="rgb(43,54,69)",this.DefaultTextFont=14*U()+"px å¾®è½¯éé»",this.TitleFont=13*U()+"px å¾®è½¯éé»",this.IndexTitleBGColor="rgb(217,219,220)",this.IndexTitleColor="rgb(43,54,69)",this.IndexTitleSelectedColor="rgb(65,105,225)",this.OverlayIndexTitleBGColor="rgba(255,255,255,0.7)",this.Title={TradeIndexColor:"rgb(105,105,105)",ColorIndexColor:"rgb(112,128,144)",VolColor:"rgb(43,54,69)",AmountColor:"rgb(43,54,69)",DateTimeColor:"rgb(43,54,69)",SettingColor:"rgb(43,54,69)",NameColor:"rgb(43,54,69)",TurnoverRateColor:"rgb(43,54,69)",PositionColor:"rgb(43,54,69)"},this.UpTextColor="rgb(238,21,21)",this.DownTextColor="rgb(25,158,0)",this.UnchagneTextColor="rgb(0,0,0)",this.CloseLineColor="rgb(0,191,255)",this.CloseLineAreaColor=["rgba(0,191,255,0.8)","rgba(0,191,255,0.2)"],this.CloseLineWidth=2,this.FrameBorderPen="rgb(225,236,242)",this.MultiDayBorderPen="rgb(225,236,242)",this.FrameSplitPen="rgb(225,236,242)",this.FrameDotSplitPen="rgb(105,105,105)",this.FrameYLineDash=null,this.FrameXLineDash=null,this.FrameSplitTextColor="rgb(117,125,129)",this.FrameSplitTextFont=14*U()+"px å¾®è½¯éé»",this.FrameTitleBGColor="rgb(246,251,253)",this.Frame={XBottomOffset:1*U(),YTopOffset:2*U(),YTextPadding:[2,2]},this.ToolbarButtonStyle=0,this.FrameLogo={TextColor:"rgb(178,34,34)",Font:"bold "+16*U()+"px å¾®è½¯éé»",Text:""},this.Frame.PercentageText={PriceColor:"rgb(117,125,129)",PercentageColor:"rgb(117,125,129)",SplitColor:"rgb(117,125,129)",Font:14*U()+"px å¾®è½¯éé»"},this.FrameLogarithmic={OpenPriceFont:"bold "+14*U()+"px å¾®è½¯éé»",MinInterval:45*U()},this.FrameSplitIncrease={Increase:.1},this.FrameSplitAverage={Count:4},this.FrameGoldenSection={Golden:[0,.191,.382,.5,.618,.809,1]},this.FrameLatestPrice={TextColor:"rgb(255,255,255)",UpBarColor:"rgb(238,21,21)",DownBarColor:"rgb(25,158,0)",UnchagneBarColor:"rgb(0,0,0)",BGAlpha:.6,OverlayTextColor:"rgb(255,255,255)"},this.FrameMargin=4,this.FrameLeftMargin=2,this.FrameRightMargin=2,this.DragSubFrameBorder={TopBorderHeight:6*U(),MinFrameHeight:50*U()},this.OverlayFrame={BolderPen:"rgb(190,190,190)",TitleColor:"rgb(105,105,105)",TitleFont:11*U()+"px arial"},this.CorssCursorBGColor="rgb(43,54,69)",this.CorssCursorTextColor="rgb(255,255,255)",this.CorssCursorTextFont=14*U()+"px å¾®è½¯éé»",this.CorssCursorHPenColor="rgb(130,130,130)",this.CorssCursorVPenColor="rgb(130,130,130)",this.CorssCursorXRangeBGColor="rgba(100,149,237,0.3)",this.CorssCursor={RightButton:{BGColor:"rgb(43,54,69)",PenColor:"rgb(255,255,255)",Icon:{Text:"î£",Color:"rgb(255,255,255)",Family:"iconfont",Size:18}}},this.LockBGColor="rgb(220, 220, 220)",this.LockTextColor="rgb(210, 34, 34)",this.Domain="https://opensource.zealink.com",this.CacheDomain="https://opensourcecache.zealink.com",this.PyIndexDomain="https://py.zealink.com",this.KLine={MaxMin:{Font:12*U()+"px å¾®è½¯éé»",Color:"rgb(43,54,69)",RightArrow:"â",LeftArrow:"â",HighYOffset:0,LowYOffset:0},Info:{Investor:{ApiUrl:"/API/NewsInteract",IconFont:{Family:"iconfont",Text:"î±",HScreenText:"î",Color:"#1c65db"}},Announcement:{ApiUrl:"/API/ReportList",IconFont:{Family:"iconfont",Text:"î³",HScreenText:"î",Color:"#f5a521"},IconFont2:{Family:"iconfont",Text:"î´",HScreenText:"î",Color:"#ed7520"}},Pforecast:{ApiUrl:"/API/StockHistoryDay",IconFont:{Family:"iconfont",Text:"î®",HScreenText:"î",Color:"#986cad"}},Research:{ApiUrl:"/API/InvestorRelationsList",IconFont:{Family:"iconfont",Text:"î²",HScreenText:"î",Color:"#19b1b7"}},BlockTrading:{ApiUrl:"/API/StockHistoryDay",IconFont:{Family:"iconfont",Text:"î°",HScreenText:"î",Color:"#f39f7c"}},TradeDetail:{ApiUrl:"/API/StockHistoryDay",IconFont:{Family:"iconfont",Text:"î¯",HScreenText:"î",Color:"#b22626"}},IconLibrary:{Family:"iconfont",Icon:[{Text:"î°",HScreenText:"î",Color:"#f39f7c"},{Text:"î²",HScreenText:"î",Color:"#19b1b7"},{Text:"î¯",HScreenText:"î",Color:"#b22626"},{Text:"î´",HScreenText:"î",Color:"#ed7520"}]}},NumIcon:{Color:"rgb(251,80,80)",Family:"iconfont",Text:["î","î»","î","î½","î¿","î","î","î","î","î","î¶","îµ","î·","î¸","î¹","îº","î¼","î¾","î","î","î"]},TradeIcon:{Family:"iconfont",Buy:{Color:"rgb(255,15,4)",Text:"î",HScreenText:"î"},Sell:{Color:"rgb(64,122,22)",Text:"î",HScreenText:"î"}}},this.OrderFlow={UpColor:{BG:"rgb(223,191,180)",Border:"rgb(196,84,86)"},DownColor:{BG:"rgb(176,212,184)",Border:"rgb(66,94,74)"},UnchagneColor:{BG:"rgb(216,221,177)",Border:"rgb(209,172,129)"},Text:{Color:"rgb(92,96,89)",Family:"Arial",FontMaxSize:18,MaxValue:"8888"},Line:{UpDownColor:"rgb(0,0,0)",MiddleColor:"rgb(211,211,211)"},AlwaysShowOrderText:!0,POCGBColor:"rgba(178,34,34,0.8)",AskBarColor:"rgb(14,209,69)",BidBarColor:"rgb(236,28,36)"},this.OrderFlow_Style2={BarWidth:10,UpColor:"rgb(241,55,63)",DownColor:"rgb(75,105,150)",UnchagneColor:"rgb(79,79,79)"},this.OrderFlow_Style3={BarWidth:20,UpColor:"rgb(241,55,63)",DownColor:"rgb(75,105,150)",UnchagneColor:"rgb(79,79,79)"},this.Index={},this.Index.LineColor=["rgb(255,174,0)","rgb(25,199,255)","rgb(175,95,162)","rgb(236,105,65)","rgb(68,114,196)","rgb(229,0,79)","rgb(0,128,255)","rgb(252,96,154)","rgb(42,230,215)","rgb(24,71,178)"],this.OverlaySymbol={Random:0},this.OverlaySymbol.Color=["rgb(38,198,218)","rgb(103,58,183)","rgb(0,191,165)","rgb(130,177,255)"],this.Index.StockHistoryDayApiUrl="https://opensource.zealink.com/API/StockHistoryDay",this.Index.MarketLongShortApiUrl="https://opensource.zealink.com/API/FactorTiming",this.Index.MarketAttentionApiUrl="https://opensource.zealink.com/API/MarketAttention",this.Index.MarketHeatApiUrl="https://opensource.zealink.com/API/MarketHeat",this.Index.CustomIndexHeatApiUrl="https://opensource.zealink.com/API/QuadrantCalculate",this.Index.NotSupport={Font:"14px å¾®è½¯éé»",TextColor:"rgb(52,52,52)"},this.Buttons={CloseOverlayIndex:{Color:"rgb(0,0,0)",MoveOnColor:"rgb(30,144,255)",Family:"iconfont",Text:"î",Size:12*U(),MerginLeft:3},CloseWindow:{Color:"rgb(0,0,0)",MoveOnColor:"rgb(30,144,255)",Family:"iconfont",Text:"î",Size:13*U(),MerginLeft:4},ChangeIndex:{Color:"rgb(0,0,0)",MoveOnColor:"rgb(30,144,255)",Family:"iconfont",Text:"î",Size:13*U(),MerginLeft:4},OverlayIndex:{Color:"rgb(0,0,0)",MoveOnColor:"rgb(30,144,255)",Family:"iconfont",Text:"î",Size:13*U(),MerginLeft:4},ModifyIndexParam:{Color:"rgb(0,0,0)",MoveOnColor:"rgb(30,144,255)",Family:"iconfont",Text:"î",Size:13*U(),MerginLeft:4}},this.DrawPicture={LineColor:["rgb(30,144,255)"],PointColor:["rgb(128,128,128)","rgb(192,192,192)"],XYCoordinate:{BGColor:"rgba(203,216,255,0.5)",TextBGColor:"rgb(52,101,255)",TextColor:"rgb(255,255,255)",Font:14*U()+"px å¾®è½¯éé»"},PointType:0,IsShowPoint:!1},this.ChartOX={Family:"iconfont",Up:{Color:"rgb(178,34,34)",Text:"î"},Down:{Color:"rgb(0,206,209)",Text:"î"},SquareLineColor:"rgb(119,136,153)"},this.KLineTrain={Font:"bold 14px arial",LastDataIcon:{Color:"rgb(0,0,205)",Text:"â¬"},BuyIcon:{Color:"rgb(0,205,102 )",Text:"B"},SellIcon:{Color:"rgb(255,127,36 )",Text:"S"},IconFont:{Family:"iconfont",Buy:{Text:"î",HScreenText:"î",Color:"rgb(255,140,0)"},Sell:{Text:"î",HScreenText:"î",Color:"rgb(6,79,18)"},Last:{Text:"î",HScreenText:"î",Color:"rgb(55,0,255)"}}},this.ChartKLineTable={TextFont:{Family:"Arial",FontMaxSize:25},ItemMergin:{Left:5,Right:5,Top:4,Bottom:2}},this.TooltipPaint={BGColor:"rgba(250,250,250,0.8)",BorderColor:"rgb(120,120,120)",TitleColor:"rgb(120,120,120)",TitleFont:13*U()+"px å¾®è½¯éé»",DateTimeColor:"rgb(210,210,210)",VolColor:"rgb(210,210,210)",AmountColor:"rgb(210,210,210)"},this.PCTooltip={LineHeight:25},this.Barrage={Font:16*U()+"px å¾®è½¯éé»",Height:20,Color:"RGB(109,109,109)"},this.MinuteInfo={TextColor:"rgb(84,143,255)",Font:14*U()+"px å¾®è½¯éé»",PointColor:"rgb(38,113,254)",LineColor:"rgb(120,167,255)",TextBGColor:"rgba(255,255,255,0.8)"},this.ChartDrawRuler={TitleColor:null},this.ChartDrawWaveRuler={RulerWidth:10,RulerLineWidth:1,MaxScaleRuler:2,Font:14*U()+"px å¾®è½¯éé»",ScaleRuler:[{Value:0,Text:"0.0%"},{Value:.382,Text:"38.2%"},{Value:.618,Text:"61.8%"},{Value:1,Text:"100%"},{Value:1.618,Text:"161.8%"},{Value:2,Text:"200%"}]},this.ChartDrawWaveRuler2Point={RulerWidth:20,RulerLineWidth:1,MaxScaleRuler:2,Font:14*U()+"px å¾®è½¯éé»",ScaleRuler:[{Value:0,Text:"base"},{Value:.618,Text:"61.8%"},{Value:1,Text:"100%"},{Value:1.618,Text:"161.8%"}]},this.ChartDrawVolProfile={BGColor:"rgba(244,250,254,0.8)",BorderColor:"rgba(255,255,255)",VolLineColor:"rgb(232,5,9)",UpVolColor:"rgba(103,179,238, 0.24)",DownVolColor:"rgba(237,208,105,0.24)",AreaUpColor:"rgb(103,179,238,0.7)",AreaDonwColor:"rgba(237,208,105,0.7)",Text:{Color:"rgb(0,0,0)",Family:"Arial",FontMaxSize:18,FontMinSize:6}},this.ChartVolProfileVisibleRange={VolLineColor:"rgb(232,5,9)",VolLineFont:14*U()+"px å¾®è½¯éé»",VolLineTextColor:"rgb(255,255,255)",UpVolColor:"rgba(103,179,238, 0.24)",DownVolColor:"rgba(237,208,105,0.24)",AreaUpColor:"rgb(103,179,238,0.7)",AreaDonwColor:"rgba(237,208,105,0.7)",Text:{Color:"rgb(0,0,0)",Family:"Arial",FontMaxSize:18,FontMinSize:6},VAHLineColor:"rgb(0,0,255)",VAHTextColor:"rgb(255,255,255)",VALLineColor:"rgb(0,0,255)",VALTextColor:"rgb(255,255,255)",VAFont:14*U()+"px å¾®è½¯éé»"},this.DRAWICON={Icon:{MaxSize:24,MinSize:12,YOffset:0,Zoom:{Type:1,Value:1}},Text:{MaxSize:50,MinSize:12,YOffset:0,Zoom:{Type:1,Value:1},FontName:"Arial"}},this.DRAWTEXT={MaxSize:30,MinSize:20,YOffset:0,Zoom:{Type:1,Value:1},FontName:"å¾®è½¯éé»"},this.DRAWNUMBER={MaxSize:30,MinSize:20,YOffset:0,Zoom:{Type:1,Value:1},FontName:"å¾®è½¯éé»"},this.DRAWABOVE={YOffset:0},this.DRAWTEXT_FIX={Font:14*U()+"px å¾®è½¯éé»"},this.DRAWNUMBER_FIX={Font:14*U()+"px å¾®è½¯éé»"},this.DOTLINE={LineDash:[3,5]},this.DRAWSL={PixelWidth:15},this.CIRCLEDOT={Radius:1.3*U()},this.POINTDOT={Radius:2*U()},this.DepthMapPaint={LineColor:"rgba(255,185,15)",AreaColor:["rgba(255,185,15,0.8)","rgba(255,185,15,0.4)"],TextColor:"rgba(255,255,255)",TextBGColor:"rgb(43,54,69)"},this.StockChip={InfoColor:"rgb(0,0,0)",DayInfoColor:"rgb(255,255,255)",DefaultButton:{Color:"rgb(128,128,128)",MoveOnColor:"rgb(30,144,255)",SelectedColor:"rgb(255,0,0)",Family:"iconfont",Text:"î¡",Size:13*U(),MerginLeft:4},LongButton:{Color:"rgb(128,128,128)",MoveOnColor:"rgb(30,144,255)",SelectedColor:"rgb(255,128,0)",Family:"iconfont",Text:"î",Size:13*U(),MerginLeft:4},RecentButton:{Color:"rgb(128,128,128)",MoveOnColor:"rgb(30,144,255)",SelectedColor:"rgb(0,0,204)",Family:"iconfont",Text:"î",Size:13*U(),MerginLeft:4}},this.DepthChart={BidColor:{Line:"rgb(82,176,123)",Area:"rgba(82,176,123,0.8)"},AskColor:{Line:"rgb(207,76,89)",Area:"rgba(207,76,89, 0.8)"},LineWidth:4},this.DepthCorss={BidColor:{Line:"rgb(82,176,123)"},AskColor:{Line:"rgb(207,76,89)"},LineWidth:2,LineDash:[3,3],Tooltip:{BGColor:"rgba(236,240,245, 0.8)",TextColor:"rgb(130,140,151)",Border:{Top:5,Left:20,Bottom:5,Center:5},Font:14*U()+"px å¾®è½¯éé»",LineHeight:16}},this.RectSelect={LineColor:"rgb(64,64,64)",LineWidth:1*U(),LineDotted:[3,3],AreaColor:"rgba(234,234,234,0.5)",SubAreaColor:"rgba(105,105,105,0.5)",RangeTextColor:"rgb(248,248,255)",RangeTextFont:14*U()+"px å¾®è½¯éé»",RangeTextBGColor:"rgb(43,54,69)",RangeTextSubColor:"rgb(255,255,255)",RangeTextSubFont:12*U()+"px å¾®è½¯éé»",RangeTextSubBGColor:"rgb(54,54,54)"},this.SelectedChart={LineWidth:1,LineColor:"rgb(55,100,100)",Radius:4,MinSpace:200,BGColor:"rgb(255,255,255)"},this.DragMovePaint={TextColor:"rgb(0,0,0)",Font:14*U()+"px å¾®è½¯éé»"},this.DealList={BorderColor:"rgb(192,192,192)",Header:{Color:"RGB(60,60,60)",Mergin:{Left:5,Right:5,Top:4,Bottom:2},Font:{Size:12,Name:"å¾®è½¯éé»"}},Row:{Mergin:{Top:2,Bottom:2},Font:{Size:15,Name:"å¾®è½¯éé»"},BarMergin:{Top:2,Left:3,Right:3,Bottom:2}},FieldColor:{Vol:"rgb(90,90,90)",Time:"rgb(60,60,60)",Deal:"rgb(90,90,90)",Index:"rgb(60,60,60)",BarTitle:"rgb(60,60,60)",Text:"rgb(60,60,60)",Bar:["rgb(255,0,0)","rgb(34,139,34)","rgb(119,136,153)","rgb(75,0,130)","rgb(65,105,225)","rgb(255,215,0)","rgb(255,0,255)","rgb(128,128,0)"]},UpTextColor:"rgb(238,21,21)",DownTextColor:"rgb(25,158,0)",UnchagneTextColor:"rgb(0,0,0)"},this.Report={BorderColor:"rgb(192,192,192)",SelectedColor:"rgb(180,240,240)",Header:{Color:"rgb(60,60,60)",SortColor:"rgb(255,0,0)",Mergin:{Left:5,Right:5,Top:4,Bottom:2},Font:{Size:12,Name:"å¾®è½¯éé»"}},Item:{Mergin:{Top:2,Bottom:0,Left:5,Right:5},Font:{Size:15,Name:"å¾®è½¯éé»"},BarMergin:{Top:2,Left:3,Right:3,Bottom:2},NameFont:{Size:14,Name:"å¾®è½¯éé»"},SymbolFont:{Size:12,Name:"å¾®è½¯éé»"}},FixedItem:{Font:{Size:15,Name:"å¾®è½¯éé»"}},LimitBorder:{Color:"rgb(180,180,180)",Mergin:{Top:1,Bottom:1,Left:0,Right:0}},FieldColor:{Index:"rgb(60,60,60)",Symbol:"rgb(60,60,60)",Name:"rgb(60,60,60)",Vol:"rgb(90,90,90)",Amount:"rgb(90,90,90)",Text:"rgb(60,60,60)"},UpTextColor:"rgb(238,21,21)",DownTextColor:"rgb(25,158,0)",UnchagneTextColor:"rgb(90,90,90)",Tab:{Font:{Size:12,Name:"å¾®è½¯éé»"},ScrollBarWidth:100,ButtonColor:"rgb(252,252,252)",BarColor:"rgb(180,180,180)",BorderColor:"rgb(180,180,180)",Mergin:{Left:5,Right:5,Top:4,Bottom:2},TabTitleColor:"rgb(60,60,60)",TabSelectedTitleColor:"rgb(0,0,0)",TabSelectedBGColor:"rgb(252,252,252)",TabMoveOnTitleColor:"rgb(0,0,0)",TabBGColor:"rgb(220,220,220)"},PageInfo:{Font:{Size:15,Name:"å¾®è½¯éé»"},TextColor:"rgb(0,0,0)",BGColor:"rgba(180,180,180,0.5)",Mergin:{Left:5,Right:5,Top:4,Bottom:2}},DragRow:{Color:"rgba(190,190,190,0.8)",TextColor:"rgba(0,0, 0, 0.8)",MoveRowColor:"rgb(240,128,128)",SrcRowColor:"rgb(180,240,240)"}},this.SetStyle=function(t){var e=function(t,e){t&&(t.Color&&(e.Color=t.Color),t.MoveOnColor&&(e.MoveOnColor=t.MoveOnColor),t.SelectedColor&&(e.SelectedColor=t.SelectedColor),t.Family&&(e.Family=t.Family),t.Text&&(e.Text=t.Text),ha.IsNumber(t.Size)&&(e.Size=t.Size),ha.IsNumber(t.MerginLeft)&&(e.MerginLeft=t.MerginLeft))};if(t.TooltipBGColor&&(this.TooltipBGColor=t.TooltipBGColor),t.TooltipAlpha&&(this.TooltipAlpha=t.TooltipAlpha),t.SelectRectBGColor&&(this.SelectRectBGColor=t.SelectRectBGColor),t.UpBarColor&&(this.UpBarColor=t.UpBarColor),t.DownBarColor&&(this.DownBarColor=t.DownBarColor),t.UnchagneBarColor&&(this.UnchagneBarColor=t.UnchagneBarColor),t.EmptyBarBGColor&&(this.EmptyBarBGColor=t.EmptyBarBGColor),t.Minute){if(t.Minute.VolBarColor&&(this.Minute.VolBarColor=t.Minute.VolBarColor),t.Minute.VolTitleColor&&(this.Minute.VolTitleColor=t.Minute.VolTitleColor),t.Minute.PriceColor&&(this.Minute.PriceColor=t.Minute.PriceColor),t.Minute.AvPriceColor&&(this.Minute.AvPriceColor=t.Minute.AvPriceColor),t.Minute.AreaPriceColor&&(this.Minute.AreaPriceColor=t.Minute.AreaPriceColor),t.Minute.PositionColor&&(this.Minute.PositionColor=t.Minute.PositionColor),t.Minute.FrameSplitTextColor&&(this.Minute.FrameSplitTextColor=t.Minute.FrameSplitTextColor),t.Minute.Before){var a=t.Minute.Before;a.BGColor&&(this.Minute.Before.BGColor=a.BGColor),a.LineColor&&(this.Minute.Before.LineColor=a.LineColor),a.VolColor&&(this.Minute.Before.VolColor=a.VolColor),a.AvPriceColor&&(this.Minute.Before.AvPriceColor=a.AvPriceColor),a.CloseIcon&&e(a.CloseIcon,this.Minute.Before.CloseIcon),a.Point&&(a.Point.Color&&(this.Minute.Before.Point.Color=a.Point.Color),a.Point.Radius&&(this.Minute.Before.Point.Radius=a.Point.Radius))}if(t.Minute.After){a=t.Minute.After;a.BGColor&&(this.Minute.After.BGColor=a.BGColor),a.LineColor&&(this.Minute.After.LineColor=a.LineColor),a.VolColor&&(this.Minute.After.VolColor=a.VolColor),a.AvPriceColor&&(this.Minute.After.AvPriceColor=a.AvPriceColor),a.Point&&(a.Point.Color&&(this.Minute.After.Point.Color=a.Point.Color),a.Point.Radius&&(this.Minute.After.Point.Radius=a.Point.Radius))}}if(t.DefaultTextColor&&(this.DefaultTextColor=t.DefaultTextColor),t.DefaultTextFont&&(this.DefaultTextFont=t.DefaultTextFont),t.TitleFont&&(this.TitleFont=t.TitleFont),t.IndexTitleBGColor&&(this.IndexTitleBGColor=t.IndexTitleBGColor),t.IndexTitleColor&&(this.IndexTitleColor=t.IndexTitleColor),t.IndexTitleSelectedColor&&(this.IndexTitleSelectedColor=t.IndexTitleSelectedColor),t.OverlayIndexTitleBGColor&&(this.OverlayIndexTitleBGColor=t.OverlayIndexTitleBGColor),t.UpTextColor&&(this.UpTextColor=t.UpTextColor),t.DownTextColor&&(this.DownTextColor=t.DownTextColor),t.UnchagneTextColor&&(this.UnchagneTextColor=t.UnchagneTextColor),t.CloseLineColor&&(this.CloseLineColor=t.CloseLineColor),t.CloseLineAreaColor&&(this.CloseLineAreaColor=t.CloseLineAreaColor),t.CloseLineWidth&&(this.CloseLineWidth=t.CloseLineWidth),t.FrameBorderPen&&(this.FrameBorderPen=t.FrameBorderPen),t.MultiDayBorderPen&&(this.MultiDayBorderPen=t.MultiDayBorderPen),t.FrameSplitPen&&(this.FrameSplitPen=t.FrameSplitPen),t.FrameDotSplitPen&&(this.FrameDotSplitPen=t.FrameDotSplitPen),t.FrameSplitTextColor&&(this.FrameSplitTextColor=t.FrameSplitTextColor),t.FrameSplitTextFont&&(this.FrameSplitTextFont=t.FrameSplitTextFont),t.FrameTitleBGColor&&(this.FrameTitleBGColor=t.FrameTitleBGColor),t.Frame&&(t.Frame.XBottomOffset&&(this.Frame.XBottomOffset=t.Frame.XBottomOffset),t.Frame.YTopOffset&&(this.Frame.YTopOffset=t.Frame.YTopOffset),t.Frame.PercentageText)){a=t.Frame.PercentageText;a.PriceColor&&(this.Frame.PercentageText.PriceColor=a.PriceColor),a.PercentageColor&&(this.Frame.PercentageText.PercentageColor=a.PercentageColor),a.SplitColor&&(this.Frame.PercentageText.SplitColor=a.SplitColor),a.Font&&(this.Frame.PercentageText.Font=a.Font)}if(t.FrameLatestPrice&&(t.FrameLatestPrice.TextColor&&(this.FrameLatestPrice.TextColor=t.FrameLatestPrice.TextColor),t.FrameLatestPrice.UpBarColor&&(this.FrameLatestPrice.UpBarColor=t.FrameLatestPrice.UpBarColor),t.FrameLatestPrice.DownBarColor&&(this.FrameLatestPrice.DownBarColor=t.FrameLatestPrice.DownBarColor),t.FrameLatestPrice.UnchagneBarColor&&(this.FrameLatestPrice.UnchagneBarColor=t.FrameLatestPrice.UnchagneBarColor),t.FrameLatestPrice.BGAlpha&&(this.FrameLatestPrice.BGAlpha=t.FrameLatestPrice.BGAlpha),t.FrameLatestPrice.OverlayTextColor&&(this.FrameLatestPrice.OverlayTextColor=t.FrameLatestPrice.OverlayTextColor)),t.CorssCursorBGColor&&(this.CorssCursorBGColor=t.CorssCursorBGColor),t.CorssCursorTextColor&&(this.CorssCursorTextColor=t.CorssCursorTextColor),t.CorssCursorTextFont&&(this.CorssCursorTextFont=t.CorssCursorTextFont),t.CorssCursorVPenColor&&(this.CorssCursorVPenColor=t.CorssCursorVPenColor),t.CorssCursorHPenColor&&(this.CorssCursorHPenColor=t.CorssCursorHPenColor),t.CorssCursorBorderColor&&(this.CorssCursorBorderColor=t.CorssCursorBorderColor),t.CorssCursorXRangeBGColor&&(this.CorssCursorXRangeBGColor=t.CorssCursorXRangeBGColor),t.CorssCursor&&t.CorssCursor.RightButton){a=t.CorssCursor.RightButton;a.BGColor&&(this.CorssCursor.RightButton.BGColor=a.BGColor),a.PenColor&&(this.CorssCursor.RightButton.PenColor=a.PenColor),a.Icon&&(this.CorssCursor.RightButton.Icon=a.Icon)}if(t.KLine&&(this.KLine=t.KLine),t.Index&&(t.Index.LineColor&&(this.Index.LineColor=t.Index.LineColor),t.Index.NotSupport&&(this.Index.NotSupport=t.Index.NotSupport)),t.ColorArray&&(this.ColorArray=t.ColorArray),t.DrawPicture){a=t.DrawPicture;a.LineColor&&(this.DrawPicture.LineColor=a.LineColor),a.PointColor&&(this.DrawPicture.PointColor=a.PointColor),a.XYCoordinate&&(this.DrawPicture.XYCoordinate=a.XYCoordinate),ha.IsNumber(a.PointType)&&(this.DrawPicture.PointType=a.PointType),ha.IsBool(a.IsShowPoint)&&(this.DrawPicture.IsShowPoint=a.IsShowPoint)}if(t.TooltipPaint&&(t.TooltipPaint.BGColor&&(this.TooltipPaint.BGColor=t.TooltipPaint.BGColor),t.TooltipPaint.BorderColor&&(this.TooltipPaint.BorderColor=t.TooltipPaint.BorderColor),t.TooltipPaint.TitleColor&&(this.TooltipPaint.TitleColor=t.TooltipPaint.TitleColor),t.TooltipPaint.TitleFont&&(this.TooltipPaint.TitleFont=t.TooltipPaint.TitleFont),t.TooltipPaint.DateTimeColor&&(this.TooltipPaint.DateTimeColor=t.TooltipPaint.DateTimeColor),t.TooltipPaint.VolColor&&(this.TooltipPaint.VolColor=t.TooltipPaint.VolColor),t.TooltipPaint.AmountColor&&(this.TooltipPaint.AmountColor=t.TooltipPaint.AmountColor)),t.MinuteInfo&&(t.MinuteInfo.TextColor&&(this.MinuteInfo.TextColor=t.MinuteInfo.TextColor),t.MinuteInfo.Font&&(this.MinuteInfo.Font=t.MinuteInfo.Font),t.MinuteInfo.PointColor&&(this.MinuteInfo.PointColor=t.MinuteInfo.PointColor),t.MinuteInfo.LineColor&&(this.MinuteInfo.LineColor=t.MinuteInfo.LineColor),t.MinuteInfo.TextBGColor&&(this.MinuteInfo.TextBGColor=t.MinuteInfo.TextBGColor)),t.Title&&(t.Title.TradeIndexColor&&(this.Title.TradeIndexColor=t.Title.TradeIndexColor),t.Title.ColorIndexColor&&(this.Title.ColorIndexColor=t.Title.ColorIndexColor),t.Title.VolColor&&(this.Title.VolColor=t.Title.VolColor),t.Title.AmountColor&&(this.Title.AmountColor=t.Title.AmountColor),t.Title.DateTimeColor&&(this.Title.DateTimeColor=t.Title.DateTimeColor),t.Title.NameColor&&(this.Title.NameColor=t.Title.NameColor),t.Title.SettingColor&&(this.Title.SettingColor=t.Title.SettingColor),t.Title.TurnoverRateColor&&(this.Title.TurnoverRateColor=t.Title.TurnoverRateColor),t.Title.PositionColor&&(this.Title.PositionColor=t.Title.PositionColor)),t.DRAWICON){if(t.DRAWICON.Icon){a=t.DRAWICON.Icon;ha.IsPlusNumber(a.MaxSize)&&(this.DRAWICON.Icon.MaxSize=a.MaxSize),ha.IsPlusNumber(a.MinSize)&&(this.DRAWICON.Icon.MinSize=a.MinSize),a.Zoom&&(this.DRAWICON.Icon.Zoom=a.Zoom),ha.IsNumber(a.YOffset)&&(this.DRAWICON.Icon.YOffset=a.YOffset)}if(t.DRAWICON.Text){a=t.DRAWICON.Text;ha.IsPlusNumber(a.MaxSize)&&(this.DRAWICON.Text.MaxSize=a.MaxSize),ha.IsPlusNumber(a.MinSize)&&(this.DRAWICON.Text.MinSize=a.MinSize),a.Zoom&&(this.DRAWICON.Text.Zoom=a.Zoom),a.FontName&&(this.DRAWICON.Text.FontName=a.FontName),ha.IsNumber(a.YOffset)&&(this.DRAWICON.Text.YOffset=a.YOffset)}}if(t.DRAWTEXT){a=t.DRAWTEXT;ha.IsPlusNumber(a.MaxSize)&&(this.DRAWICON.MaxSize=a.MaxSize),ha.IsPlusNumber(a.MinSize)&&(this.DRAWICON.MinSize=a.MinSize),a.Zoom&&(this.DRAWTEXT.Zoom=a.Zoom),a.FontName&&(this.DRAWTEXT.FontName=a.FontName),ha.IsNumber(a.YOffset)&&(this.DRAWTEXT.YOffset=a.YOffset)}if(t.DRAWTEXT_FIX){a=t.DRAWTEXT_FIX;a.Font&&(this.DRAWTEXT_FIX.Font=a.Font)}if(t.DRAWNUMBER_FIX){a=t.DRAWNUMBER_FIX;a.Font&&(this.DRAWNUMBER_FIX.Font=a.Font)}if(t.DRAWNUMBER){a=t.DRAWNUMBER;ha.IsPlusNumber(a.MaxSize)&&(this.DRAWNUMBER.MaxSize=a.MaxSize),ha.IsPlusNumber(a.MinSize)&&(this.DRAWNUMBER.MinSize=a.MinSize),a.Zoom&&(this.DRAWNUMBER.Zoom=a.Zoom),a.FontName&&(this.DRAWNUMBER.FontName=a.FontName),ha.IsNumber(a.YOffset)&&(this.DRAWNUMBER.YOffset=a.YOffset)}if(t.DRAWABOVE){a=t.DRAWABOVE;ha.IsNumber(a.YOffset)&&(this.DRAWABOVE.YOffset=a.YOffset)}if(t.DOTLINE&&(this.DOTLINE=t.DOTLINE),t.DRAWSL&&(this.DOTLINE=t.DRAWSL),t.DragSubFrameBorder&&(this.DragSubFrameBorder=t.DragSubFrameBorder),t.DepthMapPaint){a=t.DepthMapPaint;a.LineColor&&(this.DepthMapPaint.LineColor=a.LineColor),a.AreaColor&&(this.DepthMapPaint.AreaColor=a.AreaColor),a.TextColor&&(this.DepthMapPaint.TextColor=a.TextColor),a.TextBGColor&&(this.DepthMapPaint.TextBGColor=a.TextBGColor)}if(t.StockChip){a=t.StockChip;a.InfoColor&&(this.StockChip.InfoColor=a.InfoColor),a.DayInfoColor&&(this.StockChip.DayInfoColor=a.DayInfoColor),a.DefaultButton&&e(a.DefaultButton,this.StockChip.DefaultButton),a.LongButton&&e(a.LongButton,this.StockChip.LongButton),a.RecentButton&&e(a.RecentButton,this.StockChip.RecentButton)}if(t.DepthChart){a=t.DepthChart;a.BidColor&&(a.BidColor.Line&&(this.DepthChart.BidColor.Line=a.BidColor.Line),a.BidColor.Area&&(this.DepthChart.BidColor.Area=a.BidColor.Area)),a.AskColor&&(a.AskColor.Line&&(this.DepthChart.AskColor.Line=a.AskColor.Line),a.AskColor.Area&&(this.DepthChart.AskColor.Area=a.AskColor.Area)),a.LineWidth&&(this.DepthChart.LineWidth=a.LineWidth)}if(t.DepthCorss){a=t.DepthCorss;if(a.BidColor&&a.BidColor.Line&&(this.DepthCorss.BidColor.Line=a.BidColor.Line),a.AskColor&&a.AskColor.Line&&(this.DepthCorss.AskColor.Line=a.AskColor.Line),a.LineWidth&&(this.DepthCorss.LineWidth=a.LineWidth),a.LineDash&&(this.DepthCorss.LineDash=a.LineDash),a.Tooltip){var i=a.Tooltip;i.BGColor&&(this.DepthCorss.Tooltip.BGColor=i.BGColor),i.TextColor&&(this.DepthCorss.Tooltip.TextColor=i.TextColor),i.Font&&(this.DepthCorss.Tooltip.Font=i.Font),i.LineHeight&&(this.DepthCorss.Tooltip.LineHeight=i.LineHeight);var r=i.Border;ha.IsNumber(r.Top)&&(this.DepthCorss.Tooltip.Border.Top=r.Top),ha.IsNumber(r.Left)&&(this.DepthCorss.Tooltip.Border.Left=r.Left),ha.IsNumber(r.Bottom)&&(this.DepthCorss.Tooltip.Border.Bottom=r.Bottom),ha.IsNumber(r.Center)&&(this.DepthCorss.Tooltip.Border.Center=r.Center)}}if(t.CIRCLEDOT){a=t.CIRCLEDOT;ha.IsNumber(a.Radius)&&(this.CIRCLEDOT.Radius=a.Radius)}if(t.POINTDOT){a=t.POINTDOT;ha.IsNumber(a.Radius)&&(this.POINTDOT.Radius=a.Radius)}if(t.RectSelect){a=t.RectSelect;a.LineColor&&(this.RectSelect.LineColor=a.LineColor),a.LineWidth>0&&(this.RectSelect.LineWidth=a.LineWidth),a.LineDotted&&(this.RectSelect.LineDotted=a.LineDotted),a.AreaColor&&(this.RectSelect.AreaColor=a.AreaColor),a.SubAreaColor&&(this.RectSelect.SubAreaColor=a.SubAreaColor),a.RangeTextColor&&(this.RectSelect.RangeTextColor=a.RangeTextColor),a.RangeTextFont&&(this.RectSelect.RangeTextFont=a.RangeTextFont),a.RangeTextBGColor&&(this.RectSelect.RangeTextBGColor=a.RangeTextBGColor),a.RangeTextSubColor&&(this.RectSelect.RangeTextSubColor=a.RangeTextSubColor),a.RangeTextSubFont&&(this.RectSelect.RangeTextSubFont=a.RangeTextSubFont),a.RangeTextSubBGColor&&(this.RectSelect.RangeTextSubBGColor=a.RangeTextSubBGColor)}if(t.OrderFlow&&(a=t.OrderFlow,a.UpColor&&(this.OrderFlow.UpColor=a.UpColor),a.DownColor&&(this.OrderFlow.DownColor=a.DownColor),a.UnchagneColor&&(this.OrderFlow.UnchagneColor=a.UnchagneColor),a.Text&&(this.OrderFlow.Text=a.Text),a.Line&&(this.OrderFlow.Line=a.Line)),t.OrderFlow_Style2&&(a=t.OrderFlow_Style2,a.UpColor&&(this.OrderFlow_Style2.UpColor=a.UpColor),a.DownColor&&(this.OrderFlow_Style2.DownColor=a.DownColor),a.UnchagneColor&&(this.OrderFlow_Style2.UnchagneColor=a.UnchagneColor),ha.IsNumber(a.BarWidth)&&(this.OrderFlow_Style2.BarWidth=a.BarWidth)),t.ChartOX){a=t.ChartOX;a.Family&&(this.ChartOX.Family=a.Family),a.Up&&(this.ChartOX.Up=a.Up),a.Down&&(this.ChartOX.Down=a.Down),a.SquareLineColor&&(this.ChartOX.SquareLineColor=a.SquareLineColor)}if(t.DealList){a=t.DealList;if(a.BorderColor&&(this.DealList.BorderColor=a.BorderColor),a.UpTextColor&&(this.DealList.UpTextColor=a.UpTextColor),a.DownTextColor&&(this.DealList.DownTextColor=a.DownTextColor),a.UnchagneTextColor&&(this.DealList.UnchagneTextColor=a.UnchagneTextColor),a.Header){var n=a.Header;if(n.Color&&(this.DealList.Header.Color=n.Color),n.Mergin){var s=n.Mergin;ha.IsNumber(s.Left)&&(this.DealList.Header.Mergin.Left=s.Left),ha.IsNumber(s.Right)&&(this.DealList.Header.Mergin.Left=s.Right),ha.IsNumber(s.Top)&&(this.DealList.Header.Mergin.Top=s.Top),ha.IsNumber(s.Bottom)&&(this.DealList.Header.Mergin.Bottom=s.Bottom)}if(n.Font){var o=n.Font;o.Name&&(this.DealList.Header.Font.Name=o.Name),ha.IsNumber(o.Size)&&(this.DealList.Header.Font.Size=o.Size)}}if(a.Row){var h=a.Row;if(h.Mergin){s=h.Mergin;ha.IsNumber(s.Top)&&(this.DealList.Row.Mergin.Top=s.Top),ha.IsNumber(s.Bottom)&&(this.DealList.Row.Mergin.Bottom=s.Bottom)}if(h.Font){o=h.Font;o.Name&&(this.DealList.Row.Font.Name=o.Name),ha.IsNumber(o.Size)&&(this.DealList.Row.Font.Size=o.Size)}if(h.BarMergin){s=h.BarMergin;ha.IsNumber(s.Left)&&(this.DealList.Row.BarMergin.Left=s.Left),ha.IsNumber(s.Top)&&(this.DealList.Row.BarMergin.Top=s.Top),ha.IsNumber(s.Right)&&(this.DealList.Row.BarMergin.Right=s.Right),ha.IsNumber(s.Bottom)&&(this.DealList.Row.BarMergin.Bottom=s.Bottom)}}if(a.FieldColor){var l=a.FieldColor;if(l.Vol&&(this.DealList.FieldColor.Vol=l.Vol),l.Time&&(this.DealList.FieldColor.Time=l.Time),l.Deal&&(this.DealList.FieldColor.Deal=l.Deal),l.Index&&(this.DealList.FieldColor.Index=l.Index),l.BarTitle&&(this.DealList.FieldColor.BarTitle=l.BarTitle),l.Text&&(this.DealList.FieldColor.Text=l.Text),ha.IsNonEmptyArray(l.Bar))for(var u=0;u<l.Bar.length;++u)this.DealList.FieldColor.Bar[u]=l.Bar[u]}}if(t.Report){a=t.Report;if(a.BorderColor&&(this.Report.BorderColor=a.BorderColor),a.UpTextColor&&(this.Report.UpTextColor=a.UpTextColor),a.DownTextColor&&(this.Report.DownTextColor=a.DownTextColor),a.UnchagneTextColor&&(this.Report.UnchagneTextColor=a.UnchagneTextColor),a.BorderColor&&(this.Report.SelectedColor=a.SelectedColor),a.Header){n=a.Header;if(n.Color&&(this.Report.Header.Color=n.Color),n.SortColor&&(this.Report.Header.SortColor=n.SortColor),n.Mergin){s=n.Mergin;ha.IsNumber(s.Left)&&(this.Report.Header.Mergin.Left=s.Left),ha.IsNumber(s.Right)&&(this.Report.Header.Mergin.Left=s.Right),ha.IsNumber(s.Top)&&(this.Report.Header.Mergin.Top=s.Top),ha.IsNumber(s.Bottom)&&(this.Report.Header.Mergin.Bottom=s.Bottom)}if(n.Font){o=n.Font;o.Name&&(this.Report.Header.Font.Name=o.Name),ha.IsNumber(o.Size)&&(this.Report.Header.Font.Size=o.Size)}}if(a.Item){h=a.Item;if(h.Mergin){s=h.Mergin;ha.IsNumber(s.Left)&&(this.Report.Item.Mergin.Left=s.Left),ha.IsNumber(s.Right)&&(this.Report.Item.Mergin.Right=s.Right),ha.IsNumber(s.Top)&&(this.Report.Item.Mergin.Top=s.Top),ha.IsNumber(s.Bottom)&&(this.Report.Item.Mergin.Bottom=s.Bottom)}if(h.Font){o=h.Font;o.Name&&(this.Report.Item.Font.Name=o.Name),ha.IsNumber(o.Size)&&(this.Report.Item.Font.Size=o.Size)}if(h.BarMergin){s=h.BarMergin;ha.IsNumber(s.Left)&&(this.Report.Item.BarMergin.Left=s.Left),ha.IsNumber(s.Top)&&(this.Report.Item.BarMergin.Top=s.Top),ha.IsNumber(s.Right)&&(this.Report.Item.BarMergin.Right=s.Right),ha.IsNumber(s.Bottom)&&(this.Report.Item.BarMergin.Bottom=s.Bottom)}if(h.NameFont){o=h.NameFont;o.Name&&(this.Report.Item.NameFont.Name=o.Name),ha.IsNumber(o.Size)&&(this.Report.Item.NameFont.Size=o.Size)}if(h.SymbolFont){o=h.SymbolFont;o.Name&&(this.Report.Item.SymbolFont.Name=o.Name),ha.IsNumber(o.Size)&&(this.Report.Item.SymbolFont.Size=o.Size)}}if(a.FixedItem){h=a.FixedItem;if(h.Font){o=h.Font;o.Name&&(this.Report.FixedItem.Font.Name=o.Name),ha.IsNumber(o.Size)&&(this.Report.FixedItem.Font.Size=o.Size)}}if(a.LimitBorder){var C=a.LimitBorder;if(C.Color&&(this.Report.LimitBorder.Color=C.Color),C.Mergin){s=C.Mergin;ha.IsNumber(s.Left)&&(this.Report.LimitBorder.Mergin.Left=s.Left),ha.IsNumber(s.Top)&&(this.Report.LimitBorder.Mergin.Top=s.Top),ha.IsNumber(s.Right)&&(this.Report.LimitBorder.Mergin.Right=s.Right),ha.IsNumber(s.Bottom)&&(this.Report.LimitBorder.Mergin.Bottom=s.Bottom)}}if(a.FieldColor){l=a.FieldColor;if(l.Name&&(this.Report.FieldColor.Name=l.Name),l.Symbol&&(this.Report.FieldColor.Symbol=l.Symbol),l.Vol&&(this.Report.FieldColor.Vol=l.Vol),l.Amount&&(this.Report.FieldColor.Amount=l.Amount),l.Index&&(this.Report.FieldColor.Index=l.Index),l.BarTitle&&(this.Report.FieldColor.BarTitle=l.BarTitle),l.Text&&(this.Report.FieldColor.Text=l.Text),ha.IsNonEmptyArray(l.Bar))for(u=0;u<l.Bar.length;++u)this.Report.FieldColor.Bar[u]=l.Bar[u]}if(a.Tab){var D=a.Tab;if(D.Font){o=D.Font;o.Name&&(this.Report.Tab.Font.Name=o.Name),ha.IsNumber(o.Size)&&(this.Report.Tab.Font.Size=o.Size)}ha.IsNumber(D.ScrollBarWidth)&&(this.Report.Tab.ScrollBarWidth=D.ScrollBarWidth),D.ButtonColor&&(this.Report.Tab.ButtonColor=D.ButtonColor),D.BarColor&&(this.Report.Tab.BarColor=D.BarColor),D.BorderColor&&(this.Report.Tab.BorderColor=D.BorderColor),D.TabTitleColor&&(this.Report.Tab.TabTitleColor=D.TabTitleColor),D.TabSelectedTitleColor&&(this.Report.Tab.TabSelectedTitleColor=D.TabSelectedTitleColor),D.TabSelectedBGColor&&(this.Report.Tab.TabSelectedBGColor=D.TabSelectedBGColor),D.TabMoveOnTitleColor&&(this.Report.Tab.TabMoveOnTitleColor=D.TabMoveOnTitleColor),D.TabBGColor&&(this.Report.Tab.TabBGColor=D.TabBGColor)}if(a.PageInfo){var f=a.PageInfo;if(f.Font){o=f.Font;o.Name&&(this.Report.PageInfo.Font.Name=o.Name),ha.IsNumber(o.Size)&&(this.Report.PageInfo.Font.Size=o.Size)}if(f.TextColor&&(this.Report.PageInfo.TextColor=f.TextColor),f.BGColor&&(this.Report.PageInfo.BGColor=f.BGColor),f.Mergin){s=f.Mergin;ha.IsNumber(s.Left)&&(this.Report.PageInfo.Mergin.Left=s.Left),ha.IsNumber(s.Top)&&(this.Report.PageInfo.Mergin.Top=s.Top),ha.IsNumber(s.Right)&&(this.Report.PageInfo.Mergin.Right=s.Right),ha.IsNumber(s.Bottom)&&(this.Report.PageInfo.Mergin.Bottom=s.Bottom)}}if(a.DragRow){var c=a.DragRow;c.Color&&(this.Report.DragRow.Color=c.Color),c.TextColor&&(this.Report.DragRow.TextColor=c.TextColor),c.MoveRowColor&&(this.Report.DragRow.MoveRowColor=c.MoveRowColor),c.SrcRowColor&&(this.Report.DragRow.SrcRowColor=c.SrcRowColor)}}if(t.SelectedChart){a=t.SelectedChart;ha.IsNumber(a.LineWidth)&&(this.SelectedChart.LineWidth=a.LineWidth),ha.IsNumber(a.Radius)&&(this.SelectedChart.Radius=a.Radius),ha.IsNumber(a.MinSpace)&&(this.SelectedChart.MinSpace=a.MinSpace),a.LineColor&&(this.SelectedChart.LineColor=a.LineColor),a.LineColor&&(this.SelectedChart.BGColor=a.BGColor)}if(t.DragMovePaint){a=t.DragMovePaint;a.TextColor&&(this.DragMovePaint.TextColor=a.TextColor),a.Font&&(this.DragMovePaint.Font=a.Font)}if(ha.IsNumber(t.ToolbarButtonStyle)&&(this.ToolbarButtonStyle=t.ToolbarButtonStyle),t.Buttons){var d=t.Buttons;e(d.CloseOverlayIndex,this.Buttons.CloseOverlayIndex),e(d.CloseWindow,this.Buttons.CloseWindow),e(d.ChangeIndex,this.Buttons.ChangeIndex),e(d.OverlayIndex,this.Buttons.OverlayIndex),e(d.ModifyIndexParam,this.Buttons.ModifyIndexParam)}if(t.ChartDrawVolProfile){a=t.ChartDrawVolProfile;a.UpVolColor&&(this.ChartDrawVolProfile.UpVolColor=a.UpVolColor),a.DownVolColor&&(this.ChartDrawVolProfile.DownVolColor=a.DownVolColor),a.AreaUpColor&&(this.ChartDrawVolProfile.AreaUpColor=a.AreaUpColor),a.AreaDonwColor&&(this.ChartDrawVolProfile.AreaDonwColor=a.AreaDonwColor),a.BGColor&&(this.ChartDrawVolProfile.BGColor=a.BGColor),a.BorderColor&&(this.ChartDrawVolProfile.BorderColor=a.BorderColor),a.VolLineColor&&(this.ChartDrawVolProfile.VolLineColor=a.VolLineColor),a.Text&&(a.Text.Color&&(this.ChartDrawVolProfile.Text.Color=a.Text.Color),a.Text.Family&&(this.ChartDrawVolProfile.Text.Family=a.Text.Family),ha.IsNumber(a.Text.FontMaxSize)&&(this.ChartDrawVolProfile.Text.FontMaxSize=a.Text.FontMaxSize),ha.IsNumber(a.Text.FontMinSize)&&(this.ChartDrawVolProfile.Text.FontMinSize=a.Text.FontMinSize))}}}ka.ColorToRGBA=function(t,e){var a=/^(rgb|RGB)/;if(a.test(t)){for(var i="#",r=t.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),n=0;n<r.length;n++){var s=Number(r[n]).toString(16);"0"===s&&(s+=s),i+=s}t=i}return"rgba("+parseInt("0x"+t.slice(1,3))+","+parseInt("0x"+t.slice(3,5))+","+parseInt("0x"+t.slice(5,7))+","+e+")"},ka.RGBToHex=function(t){var e=t.indexOf(",")>-1?",":" ";t=t.substr(4).split(")")[0].split(e);var a=(+t[0]).toString(16),i=(+t[1]).toString(16),r=(+t[2]).toString(16);return 1==a.length&&(a="0"+a),1==i.length&&(i="0"+i),1==r.length&&(r="0"+r),"#"+a+i+r},ka.ArrayDrawPricture=[{Name:"çº¿æ®µ",ClassName:"ChartDrawPictureLine",Create:function(){return new _a}},{Name:"å°çº¿",ClassName:"ChartDrawPictureHaflLine",Create:function(){return new Ua}},{Name:"ç®­å¤´",ClassName:"ChartDrawArrowLine",Create:function(){return new Wa}},{Name:"æ°´å¹³çº¿",ClassName:"ChartDrawPictureHorizontalLine",Create:function(){return new Ka}},{Name:"è¶å¿çº¿",ClassName:"ChartDrawPictureTrendLine",Create:function(){return new Ja}},{Name:"ç©å½¢",ClassName:"ChartDrawPictureRect",Create:function(){return new za}},{Name:"åå¼§çº¿",ClassName:"ChartDrawPictureArc",Create:function(){return new qa}},{Name:"Må¤´Wåº",ClassName:"ChartDrawPictureWaveMW",Create:function(){return new Za}},{Name:"å¤´è©å",ClassName:"ChartDrawHeadShouldersBT",Create:function(){return new Qa}},{Name:"å¹³è¡çº¿",ClassName:"ChartDrawPictureParallelLines",Create:function(){return new ja}},{Name:"å¹³è¡éé",ClassName:"ChartDrawPictureParallelChannel",Create:function(){return new ii}},{Name:"ä»·æ ¼ééçº¿",ClassName:"ChartDrawPicturePriceChannel",Create:function(){return new ai}},{Name:"ææ¬",ClassName:"ChartDrawPictureText",Create:function(){return new ri}},{Name:"æ±æ©è§åº¦çº¿",ClassName:"ChartDrawPictureGannFan",Create:function(){return new si}},{Name:"é»éçº¿",ClassName:"ChartDrawPictureResistanceLine",Create:function(){return new oi}},{Name:"é»éåå²",ClassName:"ChartDrawPictureGoldenSection",Create:function(){return new hi}},{Name:"ç¾åæ¯çº¿",ClassName:"ChartDrawPicturePercentage",Create:function(){return new li}},{Name:"æ³¢æ®µçº¿",ClassName:"ChartDrawPictureWaveBand",Create:function(){return new ui}},{Name:"ä¸è§å½¢",ClassName:"ChartDrawPictureTriangle",Create:function(){return new Ci}},{Name:"å¯¹ç§°è§åº¦",ClassName:"ChartDrawPictureSymmetryAngle",Create:function(){return new Di}},{Name:"å",ClassName:"ChartDrawPictureCircle",Create:function(){return new fi}},{Name:"å¹³è¡åè¾¹å½¢",ClassName:"ChartDrawPictureQuadrangle",Create:function(){return new ci}},{Name:"ææ³¢é£å¥å¨æçº¿",ClassName:"ChartDrawPictureFibonacci",Create:function(){return new di}},{Name:"çº¿å½¢åå½çº¿",ClassName:"ChartDrawLinearRegression",Create:function(){return new mi}},{Name:"çº¿å½¢åå½å¸¦",ClassName:"ChartDrawLinearRegression",Create:function(){return new mi({IsShowMaxMinLine:!0})}},{Name:"å»¶é¿çº¿å½¢åå½å¸¦",ClassName:"ChartDrawLinearRegression",Create:function(){return new mi({IsShowMaxMinLine:!0,IsShowExtendLine:!0})}},{Name:"å°ºå­",ClassName:"ChartDrawRuler",Create:function(){return new vi}},{Name:"æ ä»·çº¿",ClassName:"ChartDrawPriceLine",Create:function(){return new Si}},{Name:"æ ä»·çº¿2",ClassName:"ChartDrawPriceLineV2",Create:function(){return new Ii}},{Name:"åç´çº¿",ClassName:"ChartDrawVerticalLine",Create:function(){return new pi}},{Name:"æ³¢æµªå°º",ClassName:"ChartDrawWaveRuler",Create:function(){return new Ti}},{Name:"ABæ³¢æµªå°º",ClassName:"ChartDrawWaveRuler2Point",Create:function(){return new gi}},{Name:"ç®±åçº¿",ClassName:"ChartDrawBox",Create:function(){return new xi}},{Name:"2ç¹ç»å¾ä¾å­",ClassName:"ChartDrawTwoPointDemo",Create:function(){return new Fi}},{Name:"3ç¹ç»å¾ä¾å­",ClassName:"ChartDrawThreePointDemo",Create:function(){return new yi}},{Name:"æ°´å¹³çº¿æ®µ",ClassName:"ChartDrawHLineSegment",Create:function(){return new Li}},{Name:"å¹³è¡å°çº¿",ClassName:"ChartDrawParallelRaysLines",Create:function(){return new ei}},{ClassName:"ChartDrawPictureIconFont",Create:function(){return new ni}},{Name:"æ¶é¸¦çº¿æ®µ",ClassName:"ChartDrawGraffitiLine",Create:function(){return new Xa}},{Name:"åºå®èå´æäº¤éåå¸å¾",ClassName:"ChartDrawVolProfile",Create:function(){return new Ei}},{Name:"DisjointChannel",ClassName:"ChartDrawDisjontChannel",Create:function(){return new ti}},{Name:"FlatTop",ClassName:"ChartDrawDisjontChannel",Create:function(){return new $a}}],ka.MapIonFont=new E.default([["icon-arrow_up",{Text:"î",Color:"#318757",Family:"iconfont"}],["icon-arrow_down",{Text:"î",Color:"#db563e",Family:"iconfont"}],["icon-arrow_right",{Text:"î",Color:"#318757",Family:"iconfont"}],["icon-arrow_left",{Text:"î",Color:"#318757",Family:"iconfont"}]]),ka.GetDrawPictureByName=function(t){for(var e in ka.ArrayDrawPricture){var a=ka.ArrayDrawPricture[e];if(a.Name==t)return a}return null},ka.GetDrawPictureByClassName=function(t){for(var e in ka.ArrayDrawPricture){var a=ka.ArrayDrawPricture[e];if(a.ClassName==t)return a}return null},ka.RegisterDrawPicture=function(t){if(!t.Name||!t.ClassName||!t.Create)return!1;var e={Name:t.Name,ClassName:t.ClassName,Create:t.Create};return ka.ArrayDrawPricture.push(e),w.Chart.Log("[IChartDrawPicture.RegisterDrawPicture] registered new draw picture class. item=",e),!0},ka.RegisterIonFont=function(t){if(!t.Name||!t.Text||!t.Family)return!1;var e=ka.MapIonFont.has(t.Name);return ka.MapIonFont.set(t.Name,t),w.Chart.Log("[IChartDrawPicture.RegisterIonFont] registered new icon font, obj=, isOverwirte=",t,e),!0},ka.CreateChartDrawPicture=function(t){var e=ka.GetDrawPictureByClassName(t.ClassName);if(!e)return null;var a=e.Create();return t.Period>=0&&(a.Period=t.Period),t.Right>=0&&(a.Right=t.Right),t.Guid&&(a.Guid=t.Guid),t.Symbol&&(a.Symbol=t.Symbol),t.Value&&(a.Value=t.Value),t.Text&&(a.Text=t.Text),t.LineColor&&(a.LineColor=t.LineColor),t.AreaColor&&(a.AreaColor=t.AreaColor),t.FontOption&&(a.FontOption=t.FontOption),t.Label&&(a.Label=t.Label),t.LineWidth>0&&(a.LineWidth=t.LineWidth),!1===t.EnableMove&&(a.EnableMove=t.EnableMove),ha.IsBool(t.EnableSave)&&(a.EnableSave=t.EnableSave),a};var Oi=new wi,Ri={LANGUAGE_CHINESE_ID:0,LANGUAGE_ENGLISH_ID:1,LANGUAGE_TRADITIONAL_CHINESE_ID:2};function Pi(){this.TextResource=new E.default([["Tooltip-Open",{CN:"å¼:",EN:"O:",TC:"é"}],["Tooltip-High",{CN:"é«:",EN:"H:",TC:"é«"}],["Tooltip-Low",{CN:"ä½:",EN:"L:",TC:"ä½"}],["Tooltip-Close",{CN:"æ¶:",EN:"C:",TC:"æ¶"}],["Tooltip-Increase",{CN:"å¹:",EN:"I:",TC:"å¹"}],["Tooltip-Vol",{CN:"é:",EN:"V:",TC:"é"}],["Tooltip-Amount",{CN:"é¢:",EN:"A:",TC:"é¡"}],["Tooltip-AvPrice",{CN:"å:",EN:"AP:",TC:"å"}],["Tooltip-Price",{CN:"ä»·:",EN:"P:",TC:"å¹"}],["Tooltip-Exchange",{CN:"æ¢:",EN:"E:",TC:"æ"}],["Tooltip-Position",{CN:"æ:",EN:"P:",TC:"æ"}],["DivTooltip-Open",{CN:"å¼ç:",EN:"Open:",TC:"éç¤"}],["DivTooltip-High",{CN:"æé«:",EN:"High:",TC:"æé«"}],["DivTooltip-Low",{CN:"æä½:",EN:"Low:",TC:"æä½"}],["DivTooltip-Close",{CN:"æ¶ç:",EN:"Close:",TC:"æ¶ç¤"}],["DivTooltip-Increase",{CN:"æ¶¨å¹:",EN:"Increase:",TC:"æ¼²å¹"}],["DivTooltip-Vol",{CN:"æ°é:",EN:"Volume:",TC:"æ¸é"}],["DivTooltip-Amount",{CN:"éé¢:",EN:"Amount:",TC:"éé¡"}],["DivTooltip-Exchange",{CN:"æ¢æ:",EN:"Exchange:",TC:"ææ"}],["DivTooltip-Position",{CN:"æä»:",EN:"Position:",TC:"æå"}],["DivTooltip-Price",{CN:"ä»·æ ¼:",EN:"Open:",TC:"å¹æ ¼"}],["KTitle-Open",{CN:"å¼:",EN:"O:",TC:"é"}],["KTitle-High",{CN:"é«:",EN:"H:",TC:"é«"}],["KTitle-Low",{CN:"ä½:",EN:"L:",TC:"ä½"}],["KTitle-Close",{CN:"æ¶:",EN:"C:",TC:"æ¶"}],["KTitle-Increase",{CN:"å¹:",EN:"I:",TC:"å¹"}],["KTitle-Vol",{CN:"é:",EN:"V:",TC:"é"}],["KTitle-Amount",{CN:"é¢:",EN:"A:",TC:"é¡"}],["KTitle-Exchange",{CN:"æ¢:",EN:"E:",TC:"æ"}],["KTitle-Position",{CN:"æ:",EN:"P:",TC:"æ"}],["KTitle-Price",{CN:"ä»·:",EN:"Price:",TC:"å¹"}],["MTitle-AC-Price",{CN:"å¹éä»·:",EN:"C:",TC:"å¹éå¹"}],["MTitle-AC-AvPrice",{CN:"å¹éåä»·:",EN:"C:",TC:"å¹éåå¹"}],["MTitle-AC-Increase",{CN:"ç«ä»·æ¶¨å¹:",EN:"I:",TC:"ç«¶å¹æ¼²å¹"}],["MTitle-AC-Vol",{CN:"å¹éé:",EN:"V:",TC:"å¹éé"}],["MTitle-AC-NotMatchVol",{CN:"æªå¹éé:",EN:"NV:",TC:"æªå¹éé"}],["MTitle-Close",{CN:"ä»·:",EN:"C:",TC:"å¹"}],["MTitle-AvPrice",{CN:"å:",EN:"AC:",TC:"å"}],["MTitle-Increase",{CN:"å¹:",EN:"I:",TC:"å¹"}],["MTitle-Vol",{CN:"é:",EN:"V:",TC:"é"}],["MTitle-Amount",{CN:"é¢:",EN:"A:",TC:"é¡"}],["MTitle-Position",{CN:"æ:",EN:"P:",TC:"æ"}],["MTitle-UpdateTime",{CN:"æ´æ°:",EN:"Update:",TC:"æ´æ°:"}],["æ¥çº¿",{CN:"æ¥çº¿",EN:"1D",TC:"æ¥ç¶«"}],["å¨çº¿",{CN:"å¨çº¿",EN:"1W",TC:"å¨ç¶«"}],["åå¨",{CN:"åå¨",EN:"2W",TC:"éå¨"}],["æçº¿",{CN:"æçº¿",EN:"1M",TC:"æç¶«"}],["åå¹´",{CN:"åå¹´",EN:"HY",TC:"åå¹´"}],["å¹´çº¿",{CN:"å¹´çº¿",EN:"1Y",TC:"å¹´ç¶«"}],["1å",{CN:"1å",EN:"1Min",TC:"1å"}],["5å",{CN:"5å",EN:"5Min",TC:"5å"}],["15å",{CN:"15å",EN:"15Min",TC:"15å"}],["30å",{CN:"30å",EN:"30Min",TC:"30å"}],["60å",{CN:"60å",EN:"60Min",TC:"60å"}],["å­£çº¿",{CN:"å­£çº¿",EN:"1Q",TC:"å­£ç¶«"}],["åç¬",{CN:"åç¬",EN:"Tick",TC:"åç­"}],["2å°æ¶",{CN:"2å°æ¶",EN:"2H",TC:"2å°æ"}],["4å°æ¶",{CN:"4å°æ¶",EN:"4H",TC:"4å°æ"}],["ä¸å¤æ",{CN:"ä¸å¤æ",EN:"No Right",TC:"ä¸å¾©æ¬"}],["åå¤æ",{CN:"åå¤æ",EN:"Pro Right",TC:"åå¾©æ¬"}],["åå¤æ",{CN:"åå¤æ",EN:"Post Right",TC:"åå¾©æ¬"}],["æ¥",{CN:"æ¥",EN:"Sun.",TC:"æ¥"}],["ä¸",{CN:"ä¸",EN:"Mon.",TC:"å£¹"}],["äº",{CN:"äº",EN:"Tues.",TC:"è²³"}],["ä¸",{CN:"ä¸",EN:"Wed.",TC:"å"}],["å",{CN:"å",EN:"Thur.",TC:"è"}],["äº",{CN:"äº",EN:"Fri.",TC:"ä¼"}],["å­",{CN:"å­",EN:"Sat.",TC:"é¸"}],["1æ",{CN:"1æ",EN:"Jan",TC:"1æ"}],["2æ",{CN:"2æ",EN:"Feb",TC:"2æ"}],["3æ",{CN:"3æ",EN:"Mar",TC:"3æ"}],["4æ",{CN:"4æ",EN:"Apr",TC:"4æ"}],["5æ",{CN:"5æ",EN:"May",TC:"5æ"}],["6æ",{CN:"6æ",EN:"Jun",TC:"6æ"}],["7æ",{CN:"7æ",EN:"Jul",TC:"7æ"}],["8æ",{CN:"8æ",EN:"Aug",TC:"8æ"}],["9æ",{CN:"9æ",EN:"Sept",TC:"9æ"}],["10æ",{CN:"10æ",EN:"Oct",TC:"10æ"}],["11æ",{CN:"11æ",EN:"Nov",TC:"11æ"}],["12æ",{CN:"12æ",EN:"Dec",TC:"12æ"}],["èªå®ä¹åé",{CN:"å",EN:"Min",TC:"å"}],["èªå®ä¹æ¥çº¿",{CN:"æ¥",EN:"D",TC:"æ¥"}],["èªå®ä¹ç§",{CN:"ç§",EN:"S",TC:"ç§"}],["MVol-Vol",{CN:"æäº¤é",EN:"Volume",TC:"æäº¤é"}],["MVol-Position",{CN:"æä»é",EN:"Position",TC:"æåé"}],["Depth-Price",{CN:"å§æä»·",EN:"Price",TC:"å§æå¹"}],["Depth-Sum",{CN:"ç´¯è®¡",EN:"Sum",TC:"ç´¯è¨"}]]),this.GetText=function(t,e){var a=this.TextResource.get(t);if(!a)return"";switch(e){case Ri.LANGUAGE_CHINESE_ID:return a.CN;case Ri.LANGUAGE_ENGLISH_ID:return a.EN;case Ri.LANGUAGE_TRADITIONAL_CHINESE_ID:return a.TC;default:return a.CN}},this.SetTextResource=function(t,e){this.TextResource.set(t,e)},this.GetLanguageID=function(t){var e=null;switch(t){case"EN":e=Ri.LANGUAGE_ENGLISH_ID;break;case"CN":e=Ri.LANGUAGE_CHINESE_ID;break;case"TC":e=Ri.LANGUAGE_TRADITIONAL_CHINESE_ID;break;default:break}return e}}var bi=new Pi;function Bi(){}function Vi(){}function Gi(t,e){this.newMethod=W,this.newMethod(t,e),delete this.newMethod,this.ClassName="KLineChartContainer",this.WindowIndex=new Array,this.ColorIndex,this.TradeIndex,this.Symbol,this.Name,this.Period=0,this.IsApiPeriod=!1,this.Right=0,this.RightFormula=0,this.SourceData,this.MaxRequestDataCount=3e3,this.MaxRequestMinuteDayCount=5,this.PageSize=200,this.KLineDrawType=0,this.ScriptErrorCallback,this.FlowCapitalReady=!1,this.EnableFlowCapital={},this.EnableZoomUpDown=null,this.ChartDrawStorage=new Mi,this.ChartDrawStorageCache=null,this.RightSpaceCount=0,this.SourceDataLimit=new E.default,this.CtrlMoveStep=5,this.CustomShow=null,this.OverlayIndexFrameWidth=60,this.ZoomType=0,this.IsZoomLockRight=!1,this.KLineSize=null,this.Page={Day:{Enable:!1,Index:0,Finish:!1},Minute:{Enable:!1,Index:0,Finish:!1}},this.DragDownload={Day:{Enable:!1,IsEnd:!1,Status:0},Minute:{Enable:!1,IsEnd:!1,Status:0},Tick:{Enable:!1,IsEnd:!1,Status:0}},this.IsAutoUpdate=!1,this.AutoUpdateFrequency=3e4,this.AutoUpdateTimer,this.KLineApiUrl=Oi.Domain+"/API/KLine2",this.MinuteKLineApiUrl=Oi.Domain+"/API/KLine3",this.DragMinuteKLineApiUrl=Oi.Domain+"/API/KLine4",this.DragKLineApiUrl=Oi.Domain+"/API/KLine5",this.RealtimeApiUrl=Oi.Domain+"/API/Stock",this.KLineMatchUrl=Oi.Domain+"/API/KLineMatch",this.StockHistoryDayApiUrl=Oi.Domain+"/API/StockHistoryDay",this.TickApiUrl=Oi.Domain+"/API/StockDetail",this.MinuteDialog,this.RightMenu,this.BeforeBindMainData=null,this.AfterBindMainData=null,this.ResetDragDownload=function(){this.DragDownload.Day.Status=0,this.DragDownload.Day.IsEnd=!1,this.DragDownload.Minute.Status=0,this.DragDownload.Minute.IsEnd=!1,this.DragDownload.Tick.Status=0,this.DragDownload.Tick.IsEnd=!1},this.ResetPage=function(){this.Page.Day.Finish=!1,this.Page.Day.Index=0,this.Page.Minute.Finish=!1,this.Page.Minute.Index=0},this.AddCustomKLine=function(t,e){var a=this.ChartPaint[0];if(a&&t){if(a.CustomKLine||(a.CustomKLine=new E.default),Array.isArray(t))for(var i=0;i<t.length;++i){var r=t[i];a.CustomKLine.set(r.Key,r.Data)}else t&&a.CustomKLine.set(t.Key,t.Data);e&&1==e.Draw&&this.Draw()}},this.ClearCustomKLine=function(t){var e=this.ChartPaint[0];e&&(e.ClearCustomKLine(),t&&1==t.Draw&&this.Draw())},this.StopAutoUpdate=function(){this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"KLineChartContainer::StopAutoUpdate"),this.IsAutoUpdate&&(this.IsAutoUpdate=!1)},this.SandTableOperator=function(t){switch(t.ID){case 1:this.StopAutoUpdate(),t.Data&&this.ManualUpdateKData(t);break;case 2:this.ManualUpdateKData(t);break;case 3:t.IsAutoUpdate&&(this.IsAutoUpdate=t.IsAutoUpdate),this.ChangeSymbol(this.Symbol);break}},this.ManualUpdateKData=function(t){var e=t.Data,a=e.length,i=new Ot;i.Data=e,i.Period=this.Period,i.Right=this.Right,i.Symbol=this.Symbol,this.UpdateMainData(i,a),this.BindInstructionIndexData(i);for(var r=0;r<this.Frame.SubFrame.length;++r)this.BindIndexData(r,i);if(ha.IsNumber(t.DataOffset)&&t.DataOffset>=0){var n=null;n=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data,n&&(n.DataOffset=t.DataOffset)}this.UpdataDataoffset(),this.UpdatePointByCursorIndex(1),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.SendManualKLineUpdateEvent(i)},this.GetKDataInfo=function(){if(!this.ChartPaint[0])return null;var t=this.ChartPaint[0],e={};return t.Data&&t.Data.Data&&(e.Data=t.Data.CloneData("HistoryData")),e.ShowRange=t.ShowRange,e.Period=this.Period,e.RightSpaceCount=this.RightSpaceCount,e},this.ChartOperator=function(t){var e=t.ID;if(e===H.OP_SCROLL_LEFT||e===H.OP_SCROLL_RIGHT){var a=e===H.OP_SCROLL_LEFT,i=1;t.Step>0&&(i=t.Step);var r=this.GetMoveOneStepWidth();this.DataMove(i*r,a)?(this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw()):e===H.OP_SCROLL_RIGHT&&this.DragDownloadData&&this.DragDownloadData()}else if(e===H.OP_ZOOM_IN||e===H.OP_ZOOM_OUT){var n={};if(n.Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),e===H.OP_ZOOM_IN){if(!this.Frame.ZoomUp(n))return}else if(!this.Frame.ZoomDown(n))return;this.CursorIndex=n.Index,this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw()}else if(e===H.OP_GOTO_HOME){var s=this.ChartOperator_Temp_GetHistroyData();if(!s)return;var o=this.Frame.SubFrame[0].Frame.XPointCount;o-=this.RightSpaceCount;var h=s.Data.length-o;s.DataOffset=h,this.CursorIndex=0,this.LastPoint.X=null,this.LastPoint.Y=null,w.Chart.Log("[KLineChartContainer::ChartOperator] OP_GOTO_HOME, dataOffset="+s.DataOffset+" CursorIndex="+this.CursorIndex+" PageSize="+o),this.ChartOperator_Temp_Update()}else if(e===H.OP_GOTO_END){s=this.ChartOperator_Temp_GetHistroyData();if(!s)return;s.DataOffset=0,this.CursorIndex=0,this.LastPoint.X=null,this.LastPoint.Y=null,w.Chart.Log("[KLineChartContainer::ChartOperator] OP_GOTO_END "),this.ChartOperator_Temp_Update()}else if(e==H.OP_LEFT_ZOOM_IN||e==H.OP_LEFT_ZOOM_OUT){s=this.ChartOperator_Temp_GetHistroyData();if(!s)return;var l=s.Data.length,u=(o=this.Frame.SubFrame[0].Frame.XPointCount,s.DataOffset);if(e==H.OP_LEFT_ZOOM_IN){if(ha.IsNumber(t.Step)){if(o>=l)return;i=t.Step;if(i>u&&(i=u),o+i>l&&(i=l-o),i<=0)return;o+=i,s.DataOffset-=i}}else if(e==H.OP_LEFT_ZOOM_OUT){var C=this.GetMaxMinPageSize(),D=C.Min;if(ha.IsNumber(t.Step)){if(o<D)return;i=t.Step;if(o-i<D&&(i=o-D),i<=0)return;o-=i,s.DataOffset+=i}}for(var f in this.Frame.SubFrame){var c=this.Frame.SubFrame[f].Frame;c.XPointCount=o}s.DataOffset<0&&(s.DataOffset=0),this.ChartOperator_Temp_Update()}else if(e==H.OP_RIGHT_ZOOM_IN||e==H.OP_RIGHT_ZOOM_OUT){s=this.ChartOperator_Temp_GetHistroyData();if(!s)return;l=s.Data.length,o=this.Frame.SubFrame[0].Frame.XPointCount,u=s.DataOffset;if(e==H.OP_RIGHT_ZOOM_IN){if(ha.IsNumber(t.Step)){if(o>=l)return;var d=u+o,m=l-d;if(m<=0)return;i=t.Step;if(i>m&&(i=m),i<=0)return;o+=i}}else if(e==H.OP_RIGHT_ZOOM_OUT){C=this.GetMaxMinPageSize(),D=C.Min;if(ha.IsNumber(t.Step)){if(o<D)return;i=t.Step;if(i>o&&(i=o),o-i<D&&(i=o-D),i<=0)return;o-=i}}for(var f in this.Frame.SubFrame){c=this.Frame.SubFrame[f].Frame;c.XPointCount=o}s.DataOffset<0&&(s.DataOffset=0),this.ChartOperator_Temp_Update()}else{if(e==H.OP_SET_SELECTRECT){if(!this.ChartPaint[0])return!1;if(!this.ChartPaint[0].Data)return!1;s=this.ChartOperator_Temp_GetHistroyData();if(!ha.IsNonEmptyArray(s.Data))return!1;var v=this.GetRectSelectPaint();if(!v)return!1;if(!Ot.IsDayPeriod(this.Period,!0))return!1;for(f=0;f<s.Data.length;++f){c=s.Data[f];if(c.Date==t.Start.Date&&(T={KItem:c,DataIndex:f}),c.Date==t.End.Date&&(g={KItem:c,DataIndex:f}),t.SubClient&&t.SubClient.Start&&c.Date==t.SubClient.Start.Date&&(x={KItem:c,DataIndex:f}),t.SubClient&&t.SubClient.End&&c.Date==t.SubClient.End.Date&&(F={KItem:c,DataIndex:f}),T&&g)break}if(!T||!g)return w.Chart.Warn("[KLineChartContainer::ChartOperator][OP_SET_SELECTRECT] can't find date. firstPoint, secondPoint, obj",T,g,t),!1;v.SetPoint(T.KItem,{Index:0,DataIndex:T.DataIndex}),v.SetPoint(g.KItem,{Index:1,DataIndex:g.DataIndex}),x&&F&&(v.SetPoint(x.KItem,{Index:3,DataIndex:x.DataIndex}),v.SetPoint(F.KItem,{Index:4,DataIndex:F.DataIndex})),ha.IsBool(t.PreventClose)&&(v.PreventClose=t.PreventClose);var S=!1,I=this.ChartPaint[0].DrawKRange;if(I&&(I.Start>=T.DataIndex&&I.Start>=g.DataIndex||I.End<=T.DataIndex&&I.End<=g.DataIndex)){var p=T.DataIndex;l=s.Data.length,o=this.ChartPaint[0].ShowRange.ShowCount;p+o>l&&(p=l-o),p<0&&(p=0),s.DataOffset=p,S=!0}return S?this.ChartOperator_Temp_Update():this.Draw(),!0}if(e==H.OP_SET_SUB_SELECTRECT){if(!this.ChartPaint[0])return!1;if(!this.ChartPaint[0].Data)return!1;s=this.ChartOperator_Temp_GetHistroyData();if(!ha.IsNonEmptyArray(s.Data))return!1;var T,g,x,F;v=this.GetRectSelectPaint();if(!v)return!1;if(!Ot.IsDayPeriod(this.Period,!0))return!1;for(f=0;f<s.Data.length;++f){c=s.Data[f];if(c.Date==t.Start.Date&&(T={KItem:c,DataIndex:f}),c.Date==t.End.Date&&(g={KItem:c,DataIndex:f}),T&&g)break}return T&&g?(v.SetPoint(T.KItem,{Index:3,DataIndex:T.DataIndex}),v.SetPoint(g.KItem,{Index:4,DataIndex:g.DataIndex}),this.Draw(),!0):(w.Chart.Warn("[KLineChartContainer::ChartOperator][OP_SET_SUB_SELECTRECT] can't find date. firstPoint, secondPoint, obj",T,g,t),!1)}}},this.ChartOperator_Temp_GetHistroyData=function(){var t=null;return t=this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data,t||null},this.ChartOperator_Temp_Update=function(){this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.UpdatePointByCursorIndex()},this.OnWheel=function(t){if(w.Chart.Log("[KLineChartContainer::OnWheel]",t),!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var e=U(),a=(t.clientX-this.UIElement.getBoundingClientRect().left)*e,i=(t.clientY-this.UIElement.getBoundingClientRect().top)*e,r=!1;this.Canvas.beginPath(),this.Canvas.rect(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetTop(),this.Frame.ChartBorder.GetWidth(),this.Frame.ChartBorder.GetHeight()),r=this.Canvas.isPointInPath(a,i);var n=t.wheelDelta;ha.IsObjectExist(t.wheelDelta)||(n=-.01*t.deltaY);var s=!0;if(this.EnableZoomUpDown&&!1===this.EnableZoomUpDown.Wheel&&(s=!1),this.SourceData&&this.SourceData.Data)if(r&&n<0&&s){var o={ZoomType:this.ZoomType,IsLockRight:this.IsZoomLockRight};o.Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),this.Frame.ZoomDown(o)&&(this.CursorIndex=o.Index,this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw(),this.OnKLinePageChange("wheel"))}else if(r&&n>0&&s){o={ZoomType:this.ZoomType,IsLockRight:this.IsZoomLockRight};o.Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),this.Frame.ZoomUp(o)&&(w.Chart.Log("[KLineChartContainer::OnWheel] cursorIndex ",o),this.CursorIndex=o.Index,this.UpdatePointByCursorIndex(),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw(),this.OnKLinePageChange("wheel"))}r&&(t.preventDefault?t.preventDefault():t.returnValue=!1)}},this.Create=function(t,e){var a=this;for(var i in this.UIElement.JSChartContainer=this,this.ChartCorssCursor=new va,this.ChartCorssCursor.Canvas=this.Canvas,this.ChartCorssCursor.StringFormatX=Ra.Create("CorssCursor_XStringFormat"),this.ChartCorssCursor.StringFormatX.LanguageID=this.LanguageID,this.ChartCorssCursor.StringFormatY=Ra.Create("CorssCursor_YStringFormat"),this.ChartCorssCursor.StringFormatY.LanguageID=this.LanguageID,this.ChartCorssCursor.StringFormatY.ExtendChartPaint=this.ExtendChartPaint,this.ChartSplashPaint=new Ia,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.HQChart=this,this.Frame=new It,this.Frame.ChartBorder=new nt,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.Frame.GetExtendChartRightWidth=function(){return a.GetExtendChartRightWidth()},this.Frame.GetExtendChartByClassName=function(t){return a.GetExtendChartByClassName(t)},this.ChartCorssCursor.Frame=this.Frame,this.ChartSplashPaint.Frame=this.Frame,this.CreateChildWindow(t),this.CreateMainKLine(),this.CreateExtendChart("RectSelectPaint",e?e.SelectRect:null),this.EnableIndexChartDrag&&this.CreateExtendChart("DragMovePaint"),this.Frame.SubFrame){var r=new Ya;r.Frame=this.Frame.SubFrame[i].Frame,r.Canvas=this.Canvas,r.LanguageID=this.LanguageID,r.GetEventCallback=function(t){return a.GetEventCallback(t)},r.SelectedChart=this.SelectedChart,this.TitlePaint.push(r)}var n=!0,s=!0;if(e&&e.Listener){var o=e.Listener;!1===o.KeyDown&&(n=!1,w.Chart.Log("[KLineChartContainer::Create] not register keydown event.")),!1===o.Wheel&&(s=!1,w.Chart.Log("[KLineChartContainer::Create] not register wheel event."))}n&&this.UIElement.addEventListener("keydown",(function(t){a.OnKeyDown(t)}),!0),s&&this.UIElement.addEventListener("wheel",(function(t){a.OnWheel(t)}),!0)},this.OnCustomKeyDown=function(t,e){return 37==t&&e.ctrlKey?(this.MoveCorssCursorLeft(this.CtrlMoveStep),!0):!(39!=t||!e.ctrlKey)&&(this.MoveCorssCursorRight(this.CtrlMoveStep),!0)},this.MoveCorssCursorLeft=function(t){var e=null;if(e=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data,e)if(e.DataOffset<=0&&this.CursorIndex<=0)this.DragDownloadData&&this.DragDownloadData();else{if(this.CursorIndex-t<0)return e.DataOffset-=t,e.DataOffset<0&&(e.DataOffset=0,this.CursorIndex=0),this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw(),this.ShowTooltipByKeyDown(),void this.OnKLinePageChange("keydown");this.CursorIndex-=t,this.UpdatePointByCursorIndex(),this.DrawDynamicInfo(),this.ShowTooltipByKeyDown()}},this.MoveCorssCursorRight=function(t){var e=null;if(e=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data,e){var a=0;if(a=this.Frame.XPointCount?this.Frame.XPointCount:this.Frame.SubFrame[0].Frame.XPointCount,!(this.CursorIndex+e.DataOffset+1>=e.Data.length)){var i=!1;if(this.CursorIndex+t+e.DataOffset+1>e.Data.length&&(t=e.Data.length-1-e.DataOffset-this.CursorIndex,i=!0),this.CursorIndex+t>=a){var r=this.CursorIndex+t-(a-1);return e.DataOffset+=r,i&&(this.CursorIndex=a-1),this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw(),this.ShowTooltipByKeyDown(),void this.OnKLinePageChange("keydown")}this.CursorIndex+=t,this.UpdatePointByCursorIndex(),this.DrawDynamicInfo(),this.ShowTooltipByKeyDown()}}},this.CreateChildWindow=function(t){for(var e=this,a=0;a<t;++a){var i=new nt;i.UIElement=this.UIElement;var r=new ft;if(r.Canvas=this.Canvas,r.ChartBorder=i,r.Identify=a,r.RightSpaceCount=this.RightSpaceCount,this.ModifyIndexDialog&&(r.ModifyIndexEvent=this.ModifyIndexDialog.DoModal),this.ChangeIndexDialog&&(r.ChangeIndexEvent=this.ChangeIndexDialog.DoModal),r.HorizontalMax=20,r.HorizontalMin=10,0==a){r.YSplitOperator=new la,r.YSplitOperator.FrameSplitData=this.FrameSplitData.get("price"),r.YSplitOperator.FrameSplitData2=this.FrameSplitData.get("double"),r.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)};var n=U();i.BottomSpace=15*n,i.TopSpace=15*n,r.GetEventCallback=function(t){return e.GetEventCallback(t)}}else r.YSplitOperator=new ua,r.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),r.YSplitOperator.LanguageID=this.LanguageID,r.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)};r.YSplitOperator.Frame=r,r.YSplitOperator.ChartBorder=i,r.XSplitOperator=new Ca,r.XSplitOperator.Frame=r,r.XSplitOperator.ChartBorder=i,r.XSplitOperator.LanguageID=this.LanguageID,r.XSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},a!=t-1&&(r.XSplitOperator.ShowText=!1);for(var s=r.HorizontalMin;s<=r.HorizontalMax;s+=1)r.HorizontalInfo[s]=new rt,r.HorizontalInfo[s].Value=s,0==a&&s==r.HorizontalMin||(r.HorizontalInfo[s].Message[1]=s.toString(),r.HorizontalInfo[s].Font="14px å¾®è½¯éé»");var o=new vt;o.Frame=r,o.Height=0==a?20:10,this.Frame.SubFrame[a]=o}},this.CreateSubFrameItem=function(t){var e=this,a=new nt;a.UIElement=this.UIElement;var i=new ft;i.Canvas=this.Canvas,i.ChartBorder=a,i.Identify=t,this.ModifyIndexDialog&&(i.ModifyIndexEvent=this.ModifyIndexDialog.DoModal),this.ChangeIndexDialog&&(i.ChangeIndexEvent=this.ChangeIndexDialog.DoModal),i.HorizontalMax=20,i.HorizontalMin=10,i.YSplitOperator=new ua,i.YSplitOperator.LanguageID=this.LanguageID,i.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),i.YSplitOperator.Frame=i,i.YSplitOperator.ChartBorder=a,i.XSplitOperator=new Ca,i.XSplitOperator.Frame=i,i.XSplitOperator.ChartBorder=a,i.XSplitOperator.ShowText=!1,i.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},i.XSplitOperator.Symbol=this.Symbol,i.XSplitOperator.Period=this.Period;var r=this.Frame.SubFrame[0].Frame.XPointCount;i.XPointCount=r,i.Data=this.ChartPaint[0].Data;for(var n=i.HorizontalMin;n<=i.HorizontalMax;n+=1)i.HorizontalInfo[n]=new rt,i.HorizontalInfo[n].Value=n,i.HorizontalInfo[n].Message[1]=n.toString(),i.HorizontalInfo[n].Font="14px å¾®è½¯éé»";var s=new vt;return s.Frame=i,s.Height=10,s},this.CreateMainKLine=function(){var t=this,e=_t.Create("ChartKLine");e.Canvas=this.Canvas,e.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,e.ChartFrame=this.Frame.SubFrame[0].Frame,e.Name="Main-KLine",e.DrawType=this.KLineDrawType,e.Identify="Main-KLine",e.GetEventCallback=function(e){return t.GetEventCallback(e)},this.ChartPaint[0]=e,this.TitlePaint[0]=new Ba,this.TitlePaint[0].Frame=this.Frame.SubFrame[0].Frame,this.TitlePaint[0].Canvas=this.Canvas,this.TitlePaint[0].OverlayChartPaint=this.OverlayChartPaint,this.TitlePaint[0].LanguageID=this.LanguageID},this.BindMainData=function(t,e){if(this.ChartPaint[0].Data=t,this.ChartPaint[0].Symbol=this.Symbol,this.KLineSize)if(null==this.KLineSize.DataWidth)e=this.Frame.SubFrame[0].Frame.XPointCount-this.RightSpaceCount;else{var a=this.Frame.SetDataWidth(this.KLineSize.DataWidth);e=a.XPointCount-this.RightSpaceCount,this.KLineSize.DataWidth=null}for(var i in this.Frame.SubFrame){var r=this.Frame.SubFrame[i].Frame;r.XPointCount=e+this.RightSpaceCount,r.Data=this.ChartPaint[0].Data,r.XSplitOperator.Symbol=this.Symbol,r.XSplitOperator.Period=this.Period}for(var i in this.TitlePaint[0].Data=this.ChartPaint[0].Data,this.TitlePaint[0].Symbol=this.Symbol,this.TitlePaint[0].Name=this.Name,this.TitlePaint[0].Period=this.Period,this.ChartCorssCursor.StringFormatX.Data=this.ChartPaint[0].Data,this.Frame.Data=this.ChartPaint[0].Data,this.OverlayChartPaint){r=this.OverlayChartPaint[i];r.MainData=this.ChartPaint[0].Data}var n=t.Data.length-e;n<0&&(n=0),this.ChartPaint[0].Data.DataOffset=n,this.ChartPaint[0].Period=this.Period,this.ChartCorssCursor.StringFormatY.Symbol=this.Symbol,this.CursorIndex=e,this.CursorIndex+n>=t.Data.length&&(this.CursorIndex=t.Data.length-1-n),this.CursorIndex<0&&(this.CursorIndex=0),this.CustomShow&&(this.SetCustomShow(this.CustomShow,t),this.CustomShow=null)},this.UpdateMainData=function(t,e){var a=null;if(this.Frame.Data?this.Frame.SubFrame&&this.Frame.SubFrame[0]&&(a=this.Frame.SubFrame[0].Frame.Data):a=this.Frame.Data,a){var i=this.Frame.SubFrame[0].Frame.XPointCount,r=0;for(var n in e>0&&t.Data.length>e?(r=t.Data.length-e,w.Chart.Log("[KLineChartContainer::UpdateMainData]  [count="+e+"->"+t.Data.length+"], [newDataCount="+r+"], [Pagesize="+i+"]")):0==e&&t.Data.length>i&&(r=t.Data.length-i,w.Chart.Log("[KLineChartContainer::UpdateMainData] history data is empty. [count="+e+"->"+t.Data.length+"], [newDataCount="+r+"], [Pagesize="+i+"]")),this.ChartPaint[0].Data=t,this.ChartPaint[0].Symbol=this.Symbol,t.Data.length>i&&(this.ChartPaint[0].Data.DataOffset=a.DataOffset+r),this.Frame.SubFrame){var s=this.Frame.SubFrame[n].Frame;s.Data=this.ChartPaint[0].Data,0==n&&(s.YSplitOperator.Symbol=this.Symbol,s.YSplitOperator.Data=this.ChartPaint[0].Data,s.YSplitOperator.Period=this.Period)}for(var n in this.TitlePaint[0].Data=this.ChartPaint[0].Data,this.TitlePaint[0].Symbol=this.Symbol,this.TitlePaint[0].Name=this.Name,this.ChartCorssCursor.StringFormatX.Data=this.ChartPaint[0].Data,this.Frame.Data=this.ChartPaint[0].Data,this.OverlayChartPaint){s=this.OverlayChartPaint[n];s.MainData=this.ChartPaint[0].Data}this.ChartCorssCursor.StringFormatY.Symbol=this.Symbol}},this.SetCustomShow=function(t,e){if(t&&t.Date&&!(t.Date<19910101)){for(var a=t.Date,i=null,r=0;r<e.Data.length;++r){var n=e.Data[r];if(n.Date>=a){i=r;break}}if(null!==i){var s=e.Data.length-i;t.PageSize>0&&(s=t.PageSize);var o=s,h=this.GetMaxMinPageSize();for(var r in s>h.Max?o=h.Max:s<h.Min&&(o=h.Min),this.Frame.SubFrame){n=this.Frame.SubFrame[r].Frame;n.XPointCount=o}this.ChartPaint[0].Data.DataOffset=i,this.CursorIndex=0}else w.Chart.Log("[KLineChartContainer::SetCustomShow] Can't find first date="+a)}},this.OnDragSelectRectMouseUp=function(t){var e=this.GetRectSelectPaint();if(e){var a=e.GetSelectRectData();if(a){var i=U(),r=this.ChartCorssCursor,n=r.LastPoint.X/i,s=r.LastPoint.Y/i,o=!0,h=this.GetEventCallback(G.ON_DRAG_SELECT_RECT_MOUSEUP);if(h){var l={X:n,Y:s,SelectData:a,RectSelectPaint:e,IsShowMenu:!1};h.Callback(h,l,this),o=l.IsShowMenu}o&&this.SelectRectRightMenu&&(t.data={Chart:this,X:n,Y:s,SelectData:a,RectSelectPaint:e},this.SelectRectRightMenu.DoModal(t))}}},this.ShowSelectData=function(t){this.HideSelectRect(),this.SelectRectRightMenu&&this.SelectRectRightMenu.Hide(),w.Chart.Log("[KLineChartContainer::ShowSelectData] selectData",t);var e=t.Start,a=t.End-t.Start+1;for(var i in w.Chart.Log("[KLineChartContainer::ShowSelectData] DataOffset="+e+", ShowCount="+a),this.Frame.SubFrame){var r=this.Frame.SubFrame[i].Frame;r.XPointCount=a}this.ChartPaint[0].Data.DataOffset=e,this.CursorIndex=0,this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.UpdatePointByCursorIndex()},this.OnMarkRectSelect=function(t){var e=this.ChartCorssCursor;if(e&&0!=e.Status&&ha.IsNumber(e.CursorIndex)&&this.ChartPaint[0]&&this.ChartPaint[0].Data){var a=this.GetRectSelectPaint();if(a){var i=e.CursorIndex;w.Chart.Log("[KLineChartContainer::OnMarkRectSelect] dataIndex",i);var r=this.ChartPaint[0].Data;i=parseInt(i.toFixed(0));var n=i+r.DataOffset;n>=r.Data.length&&(n=r.Data.length-1);var s=r.Data[n];if(w.Chart.Log("[KLineChartContainer::OnMarkRectSelect] item",s),this.SetRectSelectData(s,n)){var o=a.GetPointCount(),h=U();if(1==o){var l=this.GetEventCallback(G.ON_KEYDOWN_SELECT_RECT_FIRST);if(l&&l.Callback){var u={X:e.LastPoint.X/h,Y:e.LastPoint.Y/h,Item:s,Index:n,RectSelectPaint:a};l.Callback(l,u,this)}}else if(2==o){var C=a.GetSelectRectData(),D=(l=this.GetEventCallback(G.ON_KEYDOWN_SELECT_RECT),!0);if(l&&l.Callback){u={X:e.LastPoint.X/h,Y:e.LastPoint.Y/h,SelectData:C,RectSelectPaint:a,IsShowMenu:!0};l.Callback(l,u,this),D=u.IsShowMenu}D&&this.SelectRectRightMenu&&(t.data={Chart:this,X:e.LastPoint.X/h,Y:e.LastPoint.Y/h,SelectData:C,RectSelectPaint:a},this.SelectRectRightMenu.DoModal(t))}this.Draw()}}}},this.CreateWindowIndex=function(t){this.WindowIndex[t].Create(this,t)},this.BindIndexData=function(t,e,a){this.WindowIndex[t]&&("function"!=typeof this.WindowIndex[t].RequestData?"function"!=typeof this.WindowIndex[t].ExecuteScript?this.WindowIndex[t].BindData(this,t,e):this.WindowIndex[t].ExecuteScript(this,t,e):this.WindowIndex[t].RequestData(this,t,e,a))},this.BindOverlayIndexData=function(t,e,a){t.Script&&("function"!=typeof t.Script.RequestData?"function"!=typeof t.Script.ExecuteScript?t.Script.BindData(this,e,a):t.Script.ExecuteScript(this,e,a):t.Script.RequestData(this,e,a))},this.BindInstructionIndexData=function(t){this.ColorIndex&&"function"==typeof this.ColorIndex.ExecuteScript&&this.ColorIndex.ExecuteScript(this,0,t),this.TradeIndex&&"function"==typeof this.TradeIndex.ExecuteScript&&this.TradeIndex.ExecuteScript(this,0,t)},this.GetChartPaint=function(t){var e=new Array;for(var a in this.ChartPaint)if(0!=a){var i=this.ChartPaint[a];i.ChartFrame==this.Frame.SubFrame[t].Frame&&e.push(i)}return e},this.AutoUpdateEvent=function(t,e){var a=t?G.RECV_START_AUTOUPDATE:G.RECV_STOP_AUTOUPDATE;if(this.mapEvent.has(a)){var i=this,r=this.mapEvent.get(a),n={Stock:{Symbol:this.Symbol,Name:this.Name,Right:this.Right,Period:this.Period},Explain:e};t&&(n.Callback=function(t){Ot.IsDayPeriod(i.Period,!0)?i.RecvRealtimeData(t):(Ot.IsMinutePeriod(i.Period,!0)||Ot.IsSecondPeriod(i.Period))&&i.RecvMinuteRealtimeData(t)}),r.Callback(r,n,this)}},this.SendKLineUpdateEvent=function(t){var e=this.GetEventCallback(G.RECV_KLINE_UPDATE_DATA);if(e&&e.Callback){var a={HistoryData:t,Stock:{Symbol:this.Symbol,Name:this.Name}};return e.Callback(e,a,this),!0}return!1},this.SendManualKLineUpdateEvent=function(t){var e=this.GetEventCallback(G.RECV_KLINE_MANUAL_UPDATE_DATA);if(e&&e.Callback){var a={HistoryData:t,Stock:{Symbol:this.Symbol,Name:this.Name}};return e.Callback(e,a,this),!0}return!1},this.GetKLineDrawType=function(){return this.KLineDrawType},this.RequestHistoryData=function(){var t=this;if(this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.EnableSplash(!0),this.FlowCapitalReady=!1,this.ResetPage(),this.ResetDragDownload(),this.Draw(),this.NetworkFilter){var e=this.GetKLineDrawType(),a={Name:"KLineChartContainer::RequestHistoryData",Explain:"æ¥Kæ°æ®",Request:{Url:t.KLineApiUrl,Type:"POST",Data:{symbol:t.Symbol,count:t.MaxRequestDataCount,field:["name","symbol","yclose","open","price","high","low","vol"],period:this.Period,right:this.Right,klineDrawType:e}},Self:this,PreventDefault:!1};if(this.NetworkFilter(a,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryData(e);var a=t.Page.Day;1==a.Enable&&0==a.Finish?t.RequestHistoryPageData():(t.AutoUpdateEvent(!0,"KLineChartContainer::RequestHistoryData"),t.AutoUpdate())})),1==a.PreventDefault)return}O.HttpRequest({url:this.KLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,start:-1,count:t.MaxRequestDataCount},type:"post",dataType:"json",async:!0,success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryData(e);var a=t.Page.Day;1==a.Enable&&0==a.Finish?t.RequestHistoryPageData():(t.AutoUpdateEvent(!0,"KLineChartContainer::RequestHistoryData"),t.AutoUpdate())}})},this.BindAllOverlayIndexData=function(t){if(this.Frame&&this.Frame.SubFrame)for(var e=0;e<this.Frame.SubFrame.length;++e){var a=this.Frame.SubFrame[e];for(var i in a.OverlayIndex){var r=a.OverlayIndex[i];this.BindOverlayIndexData(r,e,t)}}},this.RecvHistoryData=function(t){var e=Gi.JsonDataToHistoryData(t),a=new Ot;a.Data=e,a.DataType=0,a.Symbol=t.symbol,this.SourceData=a,this.BeforeBindMainData&&this.BeforeBindMainData("RecvHistoryData");var i,r=new Ot;if(r.Data=e,r.Right=this.Right,r.Period=this.Period,r.DataType=0,r.Symbol=t.symbol,r.Right>0&&!this.IsApiPeriod){var n=r.GetRightData(r.Right,{AlgorithmType:this.RightFormula});r.Data=n}if(Ot.IsDayPeriod(r.Period,!1)&&!this.IsApiPeriod){var s=r.GetPeriodData(r.Period);r.Data=s}this.Symbol=t.symbol,this.Name=t.name,this.BindMainData(r,this.PageSize),this.AfterBindMainData&&this.AfterBindMainData("RecvHistoryData"),this.Frame.SetSizeChage(!0),this.Frame.SubFrame[0]&&(i=this.Frame.SubFrame[0].Frame),i&&i.YSplitOperator&&(i.YSplitOperator.Symbol=this.Symbol,i.YSplitOperator.Data=this.ChartPaint[0].Data,i.YSplitOperator.Period=this.Period);var o=this.Page.Day;(0==o.Enable||1==o.Enable&&1==o.Finish)&&(this.ReqeustKLineInfoData({FunctionName:"RecvHistoryData"}),this.RequestFlowCapitalData(),this.RequestOverlayHistoryData(),this.CreateChartDrawPictureByStorage()),o.Enable&&(o.Index=1),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.UpdatePointByCursorIndex(2),this.Draw(),this.BindInstructionIndexData(r);for(var h=0;h<this.Frame.SubFrame.length;++h)this.BindIndexData(h,r);if(this.BindAllOverlayIndexData(r),this.mapEvent.has(G.RECV_HISTROY_DATA)){var l=this.mapEvent.get(G.RECV_HISTROY_DATA);t={HistoryData:r,Stock:{Symbol:this.Symbol,Name:this.Name}};l.Callback(l,t,this)}},this.RequestHistoryPageData=function(){var t=this;if(this.NetworkFilter){var e=this.SourceData.Data[0],a={Name:"KLineChartContainer::RequestHistoryPageData",Explain:"æ¥Kæ°æ®åé¡µ",Request:{Url:"none",Type:"POST",Data:{symbol:t.Symbol,index:t.Page.Day.Index,field:["name","symbol","yclose","open","price","high","low","vol"],firstDate:e.Date,first:{date:e.Date}}},Page:t.Page.Day,Self:this,PreventDefault:!1};if(this.NetworkFilter(a,(function(e){t.RecvHistoryPageData(e);var a=t.Page.Day;1==a.Enable&&0==a.Finish?t.RequestHistoryPageData():t.AutoUpdate()})),1==a.PreventDefault)return}setTimeout((function(){var e=t.Page.Day;e.Finish=!0;var a={data:[[20150218,12.54,12.5,12.74,11.95,12.27,117632441,1459671045],[20150219,12.27,12.1,12.23,11.9,12.23,95889423,1157078548],[20150220,12.23,12.17,12.17,11.9,12.05,67763439,815652761]],symbol:t.Symbol,name:t.Name};t.RecvHistoryPageData(a),1==e.Enable&&0==e.Finish?t.RequestHistoryPageData():t.AutoUpdate()}),500)},this.RecvHistoryPageData=function(t){var e=Gi.JsonDataToHistoryData(t),a=this.GetHistoryDataCount();for(var i in e){var r=e[i];this.SourceData.Data.splice(i,0,r)}var n=new Ot;if(n.Data=this.SourceData.Data,n.Period=this.Period,n.Right=this.Right,n.DataType=this.SourceData.DataType,n.Right>0&&n.Period<=3){var s=n.GetRightData(n.Right,{AlgorithmType:this.RightFormula});n.Data=s}if(Ot.IsDayPeriod(n.Period,!1)||Ot.IsMinutePeriod(n.Period,!1)){var o=n.GetPeriodData(n.Period);n.Data=o}this.UpdateMainData(n,a),this.BindInstructionIndexData(n);for(i=0;i<this.Frame.SubFrame.length;++i)this.BindIndexData(i,n);var h=this.Page.Day;++h.Index,1==h.Enable&&1==h.Finish&&(this.RequestFlowCapitalData(),this.RequestOverlayHistoryData(),this.CreateChartDrawPictureByStorage()),this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()},this.ReqeustHistoryMinuteData=function(){var t=this;if(this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.EnableSplash(!0),this.FlowCapitalReady=!1,this.ResetPage(),this.ResetDragDownload(),this.Draw(),this.NetworkFilter){var e=this.GetKLineDrawType(),a={Name:"KLineChartContainer::ReqeustHistoryMinuteData",Explain:"1åéKçº¿æ°æ®",Request:{Url:t.MinuteKLineApiUrl,Type:"POST",Data:{symbol:t.Symbol,count:t.MaxRequestMinuteDayCount,field:["name","symbol","yclose","open","price","high","low","vol"],period:this.Period,right:this.Right,klineDrawType:e}},Self:this,PreventDefault:!1};if(this.NetworkFilter(a,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvMinuteHistoryData(e);var a=t.Page.Minute;1==a.Enable&&0==a.Finish?t.ReqeustHistoryMinutePageData():(t.AutoUpdateEvent(!0,"KLineChartContainer::ReqeustHistoryMinuteData"),t.AutoUpdate())})),1==a.PreventDefault)return}O.HttpRequest({url:this.MinuteKLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,start:-1,count:t.MaxRequestMinuteDayCount},type:"post",dataType:"json",async:!0,success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvMinuteHistoryData(e);var a=t.Page.Minute;1==a.Enable&&0==a.Finish?t.ReqeustHistoryMinutePageData():(t.AutoUpdateEvent(!0,"KLineChartContainer::ReqeustHistoryMinuteData"),t.AutoUpdate())}})},this.RecvMinuteHistoryData=function(t){var e=Gi.JsonDataToMinuteHistoryData(t),a=new Ot;a.Data=e,a.DataType=1,a.Symbol=t.symbol,this.SourceData=a,this.BeforeBindMainData&&this.BeforeBindMainData("RecvMinuteHistoryData");var i,r=new Ot;if(r.Data=e,r.Right=this.Right,r.Period=this.Period,r.DataType=1,r.Symbol=t.symbol,Ot.IsMinutePeriod(r.Period,!1)&&!this.IsApiPeriod){var n=a.GetPeriodData(r.Period);r.Data=n}for(var s in this.Symbol=t.symbol,this.Name=t.name,this.BindMainData(r,this.PageSize),this.AfterBindMainData&&this.AfterBindMainData("RecvMinuteHistoryData"),this.Frame.SetSizeChage(!0),this.Frame.SubFrame[0]&&(i=this.Frame.SubFrame[0].Frame),i&&i.YSplitOperator&&(i.YSplitOperator.Symbol=this.Symbol,i.YSplitOperator.Data=this.ChartPaint[0].Data,i.YSplitOperator.Period=this.Period),this.OverlayChartPaint){var o=this.OverlayChartPaint[s];o.Data=null}var h=this.Page.Minute;(0==h.Enable||1==h.Enable&&1==h.Finish)&&(this.RequestFlowCapitalData(),this.RequestOverlayHistoryMinuteData(),this.CreateChartDrawPictureByStorage()),h.Enable&&++h.Index,this.UpdataDataoffset(),this.UpdatePointByCursorIndex(2),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.BindInstructionIndexData(r);for(s=0;s<this.Frame.SubFrame.length;++s)this.BindIndexData(s,r);if(this.BindAllOverlayIndexData(r),this.mapEvent.has(G.RECV_HISTROY_DATA)){var l=this.mapEvent.get(G.RECV_HISTROY_DATA);t={HistoryData:r,Stock:{Symbol:this.Symbol,Name:this.Name}};l.Callback(l,t,this)}},this.ReqeustHistoryMinutePageData=function(){var t=this;if(this.NetworkFilter){var e=this.SourceData.Data[0],a={Name:"KLineChartContainer::RecvHistoryMinutePageData",Explain:"1åéKçº¿æ°æ®åé¡µ",Request:{Url:"none",Type:"POST",Data:{symbol:t.Symbol,index:t.Page.Minute.Index,field:["name","symbol","yclose","open","price","high","low","vol"],firstDate:e.Date,first:{date:e.Date,time:e.Time}}},Page:t.Page.Minute,Self:this,PreventDefault:!1};if(this.NetworkFilter(a,(function(e){t.RecvHistoryMinutePageData(e);var a=t.Page.Minute;1==a.Enable&&0==a.Finish?t.ReqeustHistoryMinutePageData():t.AutoUpdate()})),1==a.PreventDefault)return}setTimeout((function(){var e=t.Page.Minute;e.Finish=!0;var a={data:[[20190906,14.58,14.71,14.71,14.71,14.71,1096425,16128411,925],[20190906,14.71,14.73,14.74,14.71,14.71,2154859,31731820,930],[20190906,14.71,14.71,14.71,14.68,14.69,1427516,20989208,931],[20190906,14.69,14.69,14.71,14.68,14.7,1680503,24694143,932],[20190906,14.7,14.69,14.7,14.65,14.65,1315900,19310964,933],[20190906,14.65,14.66,14.69,14.65,14.68,702955,10313842,934],[20190906,14.68,14.7,14.71,14.67,14.67,1735266,25495875,935],[20190906,14.67,14.68,14.7,14.67,14.67,739e3,10845398,936],[20190906,14.67,14.67,14.68,14.67,14.68,389800,5721266,937],[20190906,14.68,14.68,14.7,14.68,14.69,648477,9527859,938],[20190906,14.69,14.7,14.71,14.69,14.7,1128400,16589794,939],[20190906,14.7,14.7,14.71,14.69,14.71,714858,10509708,940],[20190906,14.71,14.71,14.71,14.69,14.69,401500,5900477,941],[20190906,14.69,14.69,14.71,14.69,14.69,1165684,17131034,942],[20190906,14.69,14.69,14.7,14.67,14.67,498516,7321024,943],[20190906,14.67,14.68,14.68,14.67,14.67,350126,5139012,944],[20190906,14.67,14.67,14.69,14.67,14.69,561600,8246789,945]]};t.RecvHistoryMinutePageData(a),1==e.Enable&&0==e.Finish?t.ReqeustHistoryMinutePageData():t.AutoUpdate()}),500)},this.RecvHistoryMinutePageData=function(t){var e=Gi.JsonDataToMinuteHistoryData(t),a=this.GetHistoryDataCount();for(var i in e){var r=e[i];this.SourceData.Data.splice(i,0,r)}var n=new Ot;if(n.Data=this.SourceData.Data,n.Period=this.Period,n.Right=this.Right,n.DataType=this.SourceData.DataType,n.Right>0&&Ot.IsDayPeriod(n.Period,!1)){var s=n.GetRightData(n.Right,{AlgorithmType:this.RightFormula});n.Data=s}if(Ot.IsDayPeriod(n.Period,!1)||Ot.IsMinutePeriod(n.Period,!1)){var o=n.GetPeriodData(n.Period);n.Data=o}this.UpdateMainData(n,a),this.BindInstructionIndexData(n);for(i=0;i<this.Frame.SubFrame.length;++i)this.BindIndexData(i,n);var h=this.Page.Minute;(0==h.Enable||1==h.Enable&&1==h.Finish)&&(this.RequestFlowCapitalData(),this.CreateChartDrawPictureByStorage()),h.Enable&&++h.Index,this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()},this.RequestRealtimeData=function(){var t=this,e=[t.Symbol];for(var a in this.OverlayChartPaint){var i=this.OverlayChartPaint[a];i.Symbol&&(i.MainData&&i.Status==Jt.STATUS_FINISHED_ID&&e.push(i.Symbol))}if(this.NetworkFilter){var r=this.GetKLineDrawType(),n={Name:"KLineChartContainer::RequestRealtimeData",Explain:"å½å¤©ææ°æ¥çº¿æ°æ®",Request:{Url:t.RealtimeApiUrl,Data:{symbol:e,field:["name","symbol","yclose","open","price","high","low","vol","amount","date","time"],period:this.Period,right:this.Right,klineDrawType:r},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(n,(function(e){t.RecvRealtimeData(e),t.AutoUpdate()})),1==n.PreventDefault)return}O.HttpRequest({url:this.RealtimeApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol","amount","date","time"],symbol:e,start:-1},type:"post",dataType:"json",async:!0,success:function(e){t.RecvRealtimeData(e),t.AutoUpdate()}})},this.RecvRealtimeData=function(t){if(1!=this.IsOnTouch){var e=Gi.JsonDataToRealtimeData(t,this.Symbol);if(e){var a=this.SourceData.Data[this.SourceData.Data.length-1],i=this.GetHistoryDataCount();if(0==this.SourceData.Data.length){var r=new xt;xt.CopyTo(r,e),this.SourceData.Data.push(r)}else if(a.Date==e.Date)w.Chart.Log("[KLineChartContainer::RecvRealtimeData] update kline by realtime data",e),xt.CopyTo(a,e);else{if(!(a.Date<e.Date))return;w.Chart.Log("[KLineChartContainer::RecvRealtimeData] insert kline by realtime data",e);r=new xt;xt.CopyTo(r,e),!ha.IsNumber(r.YClose)&&this.SourceData.Data.length>0&&(r.YClose=this.SourceData.Data[this.SourceData.Data.length-1].YClose),this.SourceData.Data.push(r)}var n=new Ot;if(n.Data=this.SourceData.Data,n.Period=this.Period,n.Right=this.Right,n.DataType=this.SourceData.DataType,n.Symbol=this.Symbol,n.Right>0&&Ot.IsDayPeriod(n.Period,!0)&&Br.IsSHSZStockA(this.Symbol)&&!this.IsApiPeriod){var s=n.GetRightData(n.Right,{AlgorithmType:this.RightFormula});n.Data=s}if(!this.IsApiPeriod&&(Ot.IsDayPeriod(n.Period,!1)||Ot.IsMinutePeriod(n.Period,!1))){var o=n.GetPeriodData(n.Period);n.Data=o}this.UpdateMainData(n,i),this.UpdateOverlayRealtimeData(t),this.BindInstructionIndexData(n);for(var h=0;h<this.Frame.SubFrame.length;++h)this.BindIndexData(h,n);this.UpdataDataoffset(),this.UpdatePointByCursorIndex(1),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.SendKLineUpdateEvent(n),this.BindAllOverlayIndexData(n)}}},this.UpdateOverlayRealtimeData=function(t){for(var e in this.OverlayChartPaint){var a=this.OverlayChartPaint[e];if(a.Symbol&&(a.MainData&&a.Status==Jt.STATUS_FINISHED_ID)){var i=Gi.JsonDataToRealtimeData(t,a.Symbol);if(i){var r=a.SourceData,n=r.Data[r.Data.length-1];if(n.Date==i.Date)w.Chart.Log("[KLineChartContainer::UpdateOverlayRealtimeData] update kline by minute data",i),n.Close=i.Close,n.High=i.High,n.Low=i.Low,n.Vol=i.Vol,n.Amount=i.Amount;else{if(!(a.Date<i.Date))continue;w.Chart.Log("[KLineChartContainer::UpdateOverlayRealtimeData] insert kline by minute data",i);var s=new xt;s.YClose=i.YClose,s.Open=i.Open,s.Close=i.Close,s.High=i.High,s.Low=i.Low,s.Vol=i.Vol,s.Amount=i.Amount,s.Date=i.Date,r.Data.push(s)}var o=new Ot;if(o.Data=r.Data,o.Period=this.Period,o.Right=this.Right,o.DataType=0,o.Right>0&&Br.IsSHSZStockA(t.symbol)&&!this.IsApiPeriod){var h=o.GetRightData(o.Right,{AlgorithmType:this.RightFormula});o.Data=h}var l=this.SourceData.GetOverlayData(o.Data,this.IsApiPeriod);if(o.Data=l,Ot.IsDayPeriod(o.Period,!1)&&!this.IsApiPeriod){var u=o.GetPeriodData(o.Period);o.Data=u}a.Data=o}}}},this.RequestMinuteRealtimeData=function(){var t=this,e=[t.Symbol];for(var a in this.OverlayChartPaint){var i=this.OverlayChartPaint[a];i.Symbol&&(i.MainData&&i.Status==Jt.STATUS_FINISHED_ID&&e.push(i.Symbol))}if(this.NetworkFilter){var r=this.GetKLineDrawType(),n={Name:"KLineChartContainer::RequestMinuteRealtimeData",Explain:"å½å¤©1åéKçº¿æ°æ®",Request:{Url:t.RealtimeApiUrl,Data:{symbol:e,field:["name","symbol","price","yclose","minutecount","minute","date","time"],period:this.Period,right:this.Right,klineDrawType:r},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(n,(function(e){t.RecvMinuteRealtimeData(e),t.AutoUpdate()})),1==n.PreventDefault)return}O.HttpRequest({url:this.RealtimeApiUrl,data:{field:["name","symbol","price","yclose","minutecount","minute","date","time"],symbol:e,start:-1},type:"post",dataType:"json",async:!0,success:function(e){t.RecvMinuteRealtimeData(e),t.AutoUpdate()}})},this.SetSourceDatatLimit=function(t){for(var e in this.SourceDataLimit=new E.default,t){var a=t[e];this.SourceDataLimit.set(a.Period,a.MaxCount),w.Chart.Log("[KLineChartContainer::SetSourceDatatLimit] Period="+a.Period+", MaxCount="+a.MaxCount)}},this.ReduceSourceData=function(){if(this.SourceDataLimit&&this.SourceDataLimit.has(this.Period)){var t=this.SourceDataLimit.get(this.Period),e=null;if(this.Frame.Data?this.Frame.SubFrame&&this.Frame.SubFrame[0]&&(e=this.Frame.SubFrame[0].Frame.Data):e=this.Frame.Data,e&&!(t<50)){var a=e.DataOffset,i=0;while(this.SourceData.Data.length>t)this.SourceData.Data.shift(),--a,++i;i>0&&(a<0&&(a=0),e.DataOffset=a,w.Chart.Log("[KLineChartContainer::ReduceSourceData] remove data "+i+", dataOffset="+a))}}},this.RecvMinuteRealtimeDataV2=function(t){if(1!=this.IsOnTouch){var e=Gi.JsonDataToMinuteHistoryData(t);if(e&&!(e.length<=0)){this.IsApiPeriod&&this.ReduceSourceData();var a=this.GetHistoryDataCount();if(this.SourceData&&this.SourceData.MergeMinuteData(e)){w.Chart.Log("[KLineChartContainer::RecvMinuteRealtimeDataV2] update kline by 1 minute data ["+a+"->"+this.SourceData.Data.length+"]");var i=new Ot;if(i.Data=this.SourceData.Data,i.Period=this.Period,i.Right=this.Right,i.DataType=this.SourceData.DataType,i.Symbol=this.Symbol,i.Right>0&&Ot.IsDayPeriod(i.Period,!0)&&!this.IsApiPeriod){var r=i.GetRightData(i.Right,{AlgorithmType:this.RightFormula});i.Data=r}if((Ot.IsDayPeriod(i.Period,!1)||Ot.IsMinutePeriod(i.Period,!1))&&!this.IsApiPeriod){var n=i.GetPeriodData(i.Period);i.Data=n}this.UpdateMainData(i,a),this.BindInstructionIndexData(i);for(var s=0;s<this.Frame.SubFrame.length;++s)this.BindIndexData(s,i);this.UpdataDataoffset(),this.UpdatePointByCursorIndex(1),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.SendKLineUpdateEvent(i),this.BindAllOverlayIndexData(i)}}}},this.RecvMinuteRealtimeData=function(t){if(1!=this.IsOnTouch)if(2!=t.ver){var e=Gi.JsonDataToMinuteRealtimeData(t,this.Symbol);if(e){this.IsApiPeriod&&this.ReduceSourceData();var a=this.GetHistoryDataCount(),i=this.SourceData.Data.length;if(this.SourceData.MergeMinuteData(e)){w.Chart.Log("[KLineChartContainer::RecvMinuteRealtimeData] update kline by 1 minute data ["+i+"->"+this.SourceData.Data.length+"]");var r=new Ot;if(r.Data=this.SourceData.Data,r.Period=this.Period,r.Right=this.Right,r.DataType=this.SourceData.DataType,r.Symbol=this.Symbol,r.Right>0&&Ot.IsDayPeriod(r.Period,!0)&&!this.IsApiPeriod){var n=r.GetRightData(r.Right,{AlgorithmType:this.RightFormula});r.Data=n}if((Ot.IsDayPeriod(r.Period,!1)||Ot.IsMinutePeriod(r.Period,!1))&&!this.IsApiPeriod){var s=r.GetPeriodData(r.Period);r.Data=s}this.UpdateMainData(r,a),this.UpdateOverlayMinuteRealtimeData(t),this.BindInstructionIndexData(r);for(var o=0;o<this.Frame.SubFrame.length;++o)this.BindIndexData(o,r);this.UpdataDataoffset(),this.UpdatePointByCursorIndex(1),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.SendKLineUpdateEvent(r),this.BindAllOverlayIndexData(r)}}}else this.RecvMinuteRealtimeDataV2(t)},this.UpdateOverlayMinuteRealtimeData=function(t){for(var e in this.OverlayChartPaint){var a=this.OverlayChartPaint[e];if(a.Symbol&&(a.MainData&&a.Status==Jt.STATUS_FINISHED_ID)){if(2==t.ver)var i=Gi.JsonDataToMinuteRealtimeDataV2(t,a.Symbol);else i=Gi.JsonDataToMinuteRealtimeData(t,a.Symbol);if(i){var r=a.SourceData;if(!r.MergeMinuteData(i))return;var n=new Ot;n.Data=r.Data,n.Period=this.Period,n.Right=this.Right,n.DataType=0;var s=this.SourceData.GetOverlayMinuteData(n.Data,this.IsApiPeriod);if(n.Data=s,Ot.IsMinutePeriod(n.Period,!1)&&!this.IsApiPeriod){var o=n.GetPeriodData(n.Period);n.Data=o}a.Data=n}}}},this.GetHistoryDataCount=function(){var t=null;if(this.Frame.Data?this.Frame.SubFrame&&this.Frame.SubFrame[0]&&(t=this.Frame.SubFrame[0].Frame.Data):t=this.Frame.Data,!t)return-1;var e=t.Data.length;return e},this.GetRequestDataCount=function(){var t={MaxRequestDataCount:this.MaxRequestDataCount,MaxRequestMinuteDayCount:this.MaxRequestMinuteDayCount};if(!this.SourceData||!this.SourceData.Data||this.SourceData.Data.length<=0)return t;if(Ot.IsDayPeriod(this.Period,!0)){var e=this.SourceData.Data.length;e>t.MaxRequestDataCount&&(t.MaxRequestDataCount=e)}else if(Ot.IsMinutePeriod(this.Period,!0)){var a;e=0;for(var i in this.SourceData.Data){var r=this.SourceData.Data[i];r.Date!=a&&++e,a=r.Date}e>t.MaxRequestMinuteDayCount&&(t.MaxRequestMinuteDayCount=e)}return t},this.RequestTickData=function(){var t=this;this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),t.ChartSplashPaint.EnableSplash(!0),t.Draw();var e=Oi.CacheDomain+"/cache/dealday/today/"+t.Symbol+".json";if(this.NetworkFilter){var a={Name:"KLineChartContainer::RequestTickData",Explain:"å½å¤©åç¬æ°æ®",Request:{Url:e,Data:{symbol:t.Symbol},Type:"GET"},Self:this,PreventDefault:!1};if(this.NetworkFilter(a,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvTickData(e),t.AutoUpdate()})),1==a.PreventDefault)return}O.HttpRequest({url:e,data:{symbol:t.Symbol},type:"get",dataType:"json",async:!0,success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvTickData(e),t.AutoUpdate(1)},error:function(e,a){t.ChartSplashPaint.EnableSplash(!1),t.AutoUpdate()}})},this.RecvTickData=function(t){if(2==t.ver)var e=Gi.JsonDataToTickDataV2(t);else e=Gi.JsonDataToTickData(t);var a=new Ot;a.Data=e,a.DataType=2,this.SourceData=a,this.BeforeBindMainData&&this.BeforeBindMainData("RecvTickData");var i,r=new Ot;r.Data=e,r.Right=this.Right,r.Period=this.Period,r.DataType=2,this.Symbol=t.symbol,this.Name=t.name,this.BindMainData(r,this.PageSize),this.AfterBindMainData&&this.AfterBindMainData("RecvTickData"),this.BindInstructionIndexData(r);for(var n=0;n<this.Frame.SubFrame.length;++n)0==n&&(i=this.Frame.SubFrame[n].Frame),this.BindIndexData(n,r);if(i&&i.YSplitOperator&&(i.YSplitOperator.Symbol=this.Symbol,i.YSplitOperator.Data=this.ChartPaint[0].Data,i.YSplitOperator.Period=this.Period,i.YSplitOperator.KLineChart=this.ChartPaint[0]),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.UpdatePointByCursorIndex(),this.BindAllOverlayIndexData(r),this.mapEvent.has(G.RECV_HISTROY_DATA)){var s=this.mapEvent.get(G.RECV_HISTROY_DATA);t={HistoryData:r,Stock:{Symbol:this.Symbol,Name:this.Name}};s.Callback(s,t,this)}},this.RequestTickRealtimeData=function(){var t=this,e=0;if(this.SourceData&&this.SourceData.Data&&(e=this.SourceData.Data.length),this.NetworkFilter){var a={Name:"KLineChartContainer::RequestTickRealtimeData",Explain:"å½å¤©ææ°åç¬æ°æ®",Request:{Url:t.TickApiUrl,Data:{symbol:t.Symbol,start:e,end:e+1e3},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(a,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvTickRealtimeData(e),t.AutoUpdate()})),1==a.PreventDefault)return}O.HttpRequest({url:t.TickApiUrl,data:{symbol:t.Symbol,start:e-10,end:e+1e3},type:"post",dataType:"json",async:!0,success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvTickRealtimeData(e),t.AutoUpdate()}})},this.RecvTickRealtimeData=function(t){if(2==t.ver)var e=Gi.JsonDataToTickDataV2(t);else e=Gi.JsonDataToTickData(t);if(e&&!(e.length<=0)){var a=!1;1==t.redraw&&(a=!0);var i=this.SourceData.Data,r=this.SourceData.Data.length,n=0;i.length>0&&(n=i[i.length-1].Time);var s=0;for(var o in e){var h=e[o];h.Time<=n||(i.push(h),++s)}if(!(s<=0&&0==a)){var l=new Ot;l.Data=i,l.Right=this.Right,l.Period=this.Period,l.DataType=2,this.Symbol=t.symbol,this.Name=t.name,this.UpdateMainData(l,r),this.BindInstructionIndexData(l);for(o=0;o<this.Frame.SubFrame.length;++o)this.BindIndexData(o,l);this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.UpdatePointByCursorIndex(),this.BindAllOverlayIndexData(l)}}},this.ClearIndexPaint=function(){if(this.Frame&&this.Frame.SubFrame)for(var t=0;t<this.Frame.SubFrame.length;++t){this.DeleteIndexPaint(t,!0);var e=this.Frame.SubFrame[t];if(ha.IsNonEmptyArray(e.OverlayIndex))for(var a=0;a<e.OverlayIndex.length;++a){for(var i=e.OverlayIndex[a],r=0;r<i.ChartPaint.length;++r){var n=i.ChartPaint[r];n&&n.OnDestroy&&n.OnDestroy()}i.ChartPaint=[]}}for(t=1;t<this.TitlePaint.length;++t){e=this.TitlePaint[t];e.OverlayIndex=new E.default}},this.ChangePeriod=function(t,e){var a=!1,i=!1,r=null;if(e&&(e.KLine&&(ha.IsNumber(e.KLine.DrawType)&&(a=!0),ha.IsNumber(e.KLine.Right)&&(r=e.KLine.Right)),1==e.Reload&&(i=!0)),this.Period!=t||0!=i){a&&this.ChangeKLineDrawType(e.KLine.DrawType,!1);var n=!0;if(this.SourceData){n=!1;if(t>Rt&&t<=Pt)0!=this.SourceData.DataType&&(n=!0);else if(t>bt&&t<=Bt||t>Vt&&t<=Gt)(1!=this.SourceData.DataType||Ot.IsSecondPeriod(t))&&(n=!0);else switch(t){case 0:case 1:case 2:case 3:case 9:case 21:0!=this.SourceData.DataType&&(n=!0);break;case 4:case 5:case 6:case 7:case 8:case 11:case 12:1!=this.SourceData.DataType&&(n=!0);break;case 10:2!=this.SourceData.DataType&&(n=!0);break}}this.Period=t,null!=r&&(this.Right=r),this.ReloadChartDrawPicture(),this.ClearRectSelect(!0),this.Frame.ClearUpDonwFrameYData(),this.ClearCustomKLine(),0!=n||this.IsApiPeriod?(this.ClearIndexPaint(),Ot.IsDayPeriod(this.Period,!0)?(this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"KLineChartContainer::ChangePeriod"),this.ResetOverlaySymbolStatus(),this.RequestHistoryData()):Ot.IsMinutePeriod(this.Period,!0)||Ot.IsSecondPeriod(this.Period)?(this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"KLineChartContainer::ChangePeriod"),this.ResetOverlaySymbolStatus(),this.ReqeustHistoryMinuteData()):Ot.IsTickPeriod(this.Period)&&(this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"KLineChartContainer::ChangePeriod"),this.RequestTickData())):this.Update({UpdateCursorIndexType:2})}else a&&this.ChangeKLineDrawType(e.KLine.DrawType)},this.ChangeRight=function(t){if(Br.IsEnableRight(this.Period,this.Symbol)){var e=this.Symbol.toUpperCase();Br.IsBIT(e)||t<0||t>2||this.Right!=t&&(this.Right=t,this.IsApiPeriod?Ot.IsDayPeriod(this.Period,!0)?(this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"KLineChartContainer::ChangeRight"),this.ClearIndexPaint(),this.ResetOverlaySymbolStatus(),this.RequestHistoryData()):(Ot.IsMinutePeriod(this.Period,!0)||Ot.IsSecondPeriod(this.Period))&&(this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"KLineChartContainer::ChangeRight"),this.ClearIndexPaint(),this.ResetOverlaySymbolStatus(),this.ReqeustHistoryMinuteData()):this.Update())}},this.SetFirstShowDate=function(t){if(t&&t.Date){w.Chart.Log("[KLineChartContainer::SetFirstShowDate] obj=",t);var e=null;if(e=this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data,e){var a=null;if(Ot.IsDayPeriod(this.Period,!0))for(var i=0;i<e.Data.length;++i){var r=e.Data[i];if(r.Date>=t.Date){a=i;break}}else if(Ot.IsMinutePeriod(this.Period,!0)){var n=t.Time;if(ha.IsPlusNumber(n))for(i=0;i<e.Data.length;++i){r=e.Data[i];if(r.Date>t.Date||r.Date==t.Date&&r.Time>=n){a=i;break}}else for(i=0;i<e.Data.length;++i){r=e.Data[i];if(r.Date>=t.Date){a=i;break}}}if(null!==a){var s=e.Data.length-a,o=s;t.PageSize>0&&(o=t.PageSize);var h=this.GetMaxMinPageSize();for(var i in h.Max<o?o=h.Max:h.Min>o&&(o=h.Min),this.Frame.SubFrame){r=this.Frame.SubFrame[i].Frame;r.XPointCount=o}e.DataOffset=a,this.CursorIndex=0,this.LastPoint.X=null,this.LastPoint.Y=null,w.Chart.Log("[KLineChartContainer::SetFirstShowDate] dataOffset="+e.DataOffset+" CursorIndex="+this.CursorIndex+" PageSize="+o),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.UpdatePointByCursorIndex(2),this.Draw()}else w.Chart.Log("[KLineChartContainer::SetFirstShowDate] an't find first date="+t.Date+" time="+t.Time,t)}}},this.DeleteIndexPaint=function(t,e){var a=new Array;for(var i in this.ChartPaint){var r=this.ChartPaint[i];0==i||r.ChartFrame!=this.Frame.SubFrame[t].Frame?a.push(r):!0===e&&r&&r.OnDestroy&&r.OnDestroy()}var n=this.Frame.SubFrame[t].Frame;n.YSpecificMaxMin=null,n.IsLocked=!1,n.YSplitScale=null,n.YSplitOperator.SplitType=n.YSplitOperator.DefaultSplitType,this.ChartPaint=a;var s=t+1;this.TitlePaint[s].Data=[],this.TitlePaint[s].Title=null},this.ShowKLine=function(t){this.ChartPaint.length<=0||!this.ChartPaint[0]||(this.ChartPaint[0].IsShow=t)},this.SetInstructionData=function(t,e){if(!(this.ChartPaint.length<=0)&&this.ChartPaint[0]){var a=this.TitlePaint[1];2==t?(this.ChartPaint[0].ColorData=e.Data,a&&(a.ColorIndex={Name:e.Name,Param:e.Param})):1==t&&(this.ChartPaint[0].TradeData={Sell:e.Sell,Buy:e.Buy,Name:e.Name,Param:e.Param},a&&(a.TradeIndex={Name:e.Name,Param:e.Param}))}},this.ChangeInstructionIndex=function(t){var e=new B,a=e.Get(t);a&&(1!=a.InstructionType&&2!=a.InstructionType||(a.ID=t,this.ChangeInstructionScriptIndex(a)))},this.ChangeInstructionScriptIndex=function(t){if(1==t.InstructionType)this.TradeIndex=new wn(t.Name,t.Script,t.Args,t);else{if(2!=t.InstructionType)return;this.ColorIndex=new wn(t.Name,t.Script,t.Args,t)}var e=this.ChartPaint[0].Data;this.BindInstructionIndexData(e),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.CancelInstructionIndex=function(){if(!(this.ChartPaint.length<=0)&&this.ChartPaint[0]){this.ColorIndex=null,this.TradeIndex=null,this.ChartPaint[0].ColorData=null,this.ChartPaint[0].TradeData=null;var t=this.TitlePaint[1];t&&(t.TradeIndex=null,t.ColorIndex=null),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()}},this.SetFrameToolbar=function(t,e){if(e&&this.Frame.SubFrame[t]&&this.Frame.SubFrame[t].Frame){var a=this.Frame.SubFrame[t].Frame,i=!1;ha.IsBool(e.Modify)&&(a.ModifyIndex=e.Modify,i=!0),ha.IsBool(e.Change)&&(a.ChangeIndex=e.Change,i=!0),ha.IsBool(e.Close)&&(a.CloseIndex=e.Close,i=!0),ha.IsBool(e.Overlay)&&(a.OverlayIndex=e.Overlay,i=!0),i&&(a.SizeChange=!0,a.ToolbarRect=null,a.DrawToolbar())}},this.ChangeScriptIndex=function(t,e,a){this.DeleteIndexPaint(t,!0),this.WindowIndex[t]=new wn(e.Name,e.Script,e.Args,e),a&&a.Window&&this.SetFrameToolbar(t,a.Window),this.Frame.ClearUpDonwFrameYData({Index:t});var i=this.ChartPaint[0].Data;this.BindIndexData(t,i),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.OnKLinePageChange=function(t){if(this.ChartPaint[0]){for(var e=this.ChartPaint[0].Data,a=0;a<this.WindowIndex.length;++a){var i=this.WindowIndex[a];i&&(!0===i.IsUsePageData&&this.BindIndexData(a,e,{Type:1}))}for(a=0;a<this.Frame.SubFrame.length;++a){i=this.Frame.SubFrame[a];for(var r=0;r<i.OverlayIndex.length;++r){var n=i.OverlayIndex[r];n&&n.Script&&1==n.Script.IsUsePageData&&this.BindOverlayIndexData(n,a,e)}}}},this.ChangeAPIIndex=function(t,e){this.DeleteIndexPaint(t,!0);var a=e.API;this.WindowIndex[t]=new Rn(a.Name,a.Script,a.Args,e),e&&e.Window&&this.SetFrameToolbar(t,e.Window),this.Frame.ClearUpDonwFrameYData({Index:t});var i=this.ChartPaint[0].Data;this.BindIndexData(t,i),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.ChangeIndex=function(t,e,a){if(a&&a.API)return this.ChangeAPIIndex(t,a);var i=Bi.Get(e);if(!i){var r=new B,n=r.Get(e);if(!n)return;n.IsMainIndex?t=0:0==t&&(t=1);var s=n;return a&&(a.FloatPrecision>=0&&(s.FloatPrecision=a.FloatPrecision),a.StringFormat>0&&(s.StringFormat=a.StringFormat),a.Args&&(s.Args=a.Args),a.TitleFont&&(s.TitleFont=a.TitleFont),a.IsShortTitle&&(s.IsShortTitle=a.IsShortTitle)),this.ChangeScriptIndex(t,s,a)}i.IsMainIndex?t>0&&(t=0):0==t&&(t=1);var o=new Array;for(var h in this.ChartPaint){var l=this.ChartPaint[h];0!=h&&l.ChartFrame==this.Frame.SubFrame[t].Frame||o.push(l)}this.Frame.SubFrame[t].Frame.YSpecificMaxMin=null,this.Frame.SubFrame[t].Frame.IsLocked=!1,this.Frame.SubFrame[t].Frame.YSplitScale=null,this.ChartPaint=o;var u=t+1;this.TitlePaint[u].Data=[],this.TitlePaint[u].Title=null,this.WindowIndex[t]=i.Create(a),this.CreateWindowIndex(t);var C=this.ChartPaint[0].Data;this.BindIndexData(t,C),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.ChangePyScriptIndex=function(t,e){this.DeleteIndexPaint(t),this.WindowIndex[t]=new or(e.Name,e.Script,e.Args,e);var a=this.ChartPaint[0].Data;this.BindIndexData(t,a),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.AddOverlayIndex=function(t){var e=this.CreateOverlayWindowsIndex(t);if(e){var a=this.ChartPaint[0].Data;this.BindOverlayIndexData(e,t.WindowIndex,a),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()}},this.CreateOverlayWindowsIndex=function(t){var e=t.IndexName,a=t.WindowIndex,i=null,r=null,n=null;if(t.API)i=t.API;else if(t.Script)r={Script:t.Script,ID:t.indexName,Name:t.indexName},t.Name&&(r.Name=t.Name);else{var s=new B;if(r=s.Get(e),!r&&(n=Bi.Get(e),!n))return console.warn("[KLineChartContainer::CreateOverlayIndex] can not find index["+e+"]"),null}var o=this.Frame.SubFrame[a];o.Interval=this.OverlayIndexFrameWidth;var h=new St;t.Identify&&(h.Identify=t.Identify);var l="KLineChartHScreenContainer"===this.ClassName?new mt:new ct;if(l.Canvas=this.Canvas,l.MainFrame=o.Frame,l.ChartBorder=o.Frame.ChartBorder,!0===t.ShowRightText?l.IsShow=!0:!1===t.ShowRightText&&(l.IsShow=!1),!0===t.IsShareY&&(l.IsShareY=!0),ha.IsBool(t.IsCalculateYMaxMin)&&(l.IsCalculateYMaxMin=t.IsCalculateYMaxMin),l.YSplitOperator=new ua,l.YSplitOperator.LanguageID=this.LanguageID,l.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),l.YSplitOperator.Frame=l,l.YSplitOperator.ChartBorder=l.ChartBorder,l.YSplitOperator.SplitCount=o.Frame.YSplitOperator.SplitCount,h.Frame=l,i){var u=new Rn(i.Name,i.Script,i.Args,t,!0);u.OverlayIndex={IsOverlay:!0,Identify:h.Identify,WindowIndex:a,Frame:h},h.Script=u}else if(r){var C=r;t.Args&&(C.Args=t.Args);var D=new On(C.Name,C.Script,C.Args,C);D.OverlayIndex={IsOverlay:!0,Identify:h.Identify,WindowIndex:a,Frame:h},h.Script=D}else{D=n.Create();D.OverlayIndex={IsOverlay:!0,Identify:h.Identify,WindowIndex:a,Frame:h},D.Create(this,a),h.Script=D}return o.OverlayIndex.push(h),h},this.DeleteOverlayWindowsIndex=function(t){this.DeleteOverlayIndex(t,null)&&(this.Frame.ResetXYSplit(!0),this.Draw())},this.ChangeKLineDrawType=function(t,e){if(this.KLineDrawType!=t){if(this.KLineDrawType=t,5==this.KLineDrawType||7==this.KLineDrawType||8==this.KLineDrawType){var a=this.ChartPaint[0];return a&&(a.DrawType=this.KLineDrawType),this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"KLineChartContainer::ChangeKLineDrawType"),void(Ot.IsDayPeriod(this.Period,!0)?(this.ResetOverlaySymbolStatus(),this.RequestHistoryData()):(Ot.IsMinutePeriod(this.Period,!0)||Ot.IsSecondPeriod(this.Period))&&(this.ResetOverlaySymbolStatus(),this.ReqeustHistoryMinuteData()))}for(var i in this.ChartPaint){var r=this.ChartPaint[i];0==i?r.DrawType=this.KLineDrawType:"ChartVolStick"==r.ClassName&&(r.KLineDrawType=this.KLineDrawType)}for(var i in this.OverlayChartPaint){r=this.OverlayChartPaint[i];r.DrawType=this.KLineDrawType}0!=e&&(this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw())}},this.ChangeCoordinateType=function(t){if((this.Frame||this.Frame.SubFrame)&&this.Frame.SubFrame.length){if(ha.IsNumber(t)){var e=t;if(2==e)this.Frame.SubFrame[0].Frame.CoordinateType=1;else if(1==e)this.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=e;else if(0==e)this.Frame.SubFrame[0].Frame.CoordinateType=0,this.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=0;else{if(3!=e)return;this.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=2}}else t.Type>=0&&t.Type<=5&&(this.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=t.Type),!0===t.IsReverse?this.Frame.SubFrame[0].Frame.CoordinateType=1:0==t.IsReverse&&(this.Frame.SubFrame[0].Frame.CoordinateType=0);this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}},this.ChangeIndexWindowCount=function(t,e){var a=this;if(!(t<=0)&&this.Frame.SubFrame.length!=t){this.Frame.RestoreIndexWindows();var i=this.Frame.SubFrame.length;if(i>t){for(var r=i-1;r>=t;--r)this.DeleteIndexPaint(r),this.Frame.SubFrame[r].Frame.ClearToolbar();this.Frame.SubFrame.splice(t,i-t),this.WindowIndex.splice(t,i-t);for(r=0;r<this.Frame.SubFrame.length;++r){var n=this.Frame.SubFrame[r].Frame;r==this.Frame.SubFrame.length-1?n.XSplitOperator.ShowText=!0:n.XSplitOperator.ShowText=!1}this.Frame.SetSizeChage(!0),this.ResetFrameXYSplit(),this.UpdateFrameMaxMin(),this.Draw()}else{var s=U();for(r=i;r<t;++r){var o=this.CreateSubFrameItem(r);o.Frame.ChartBorder.TitleHeight*=s,this.Frame.SubFrame[r]=o;var h=new Ya;h.Frame=this.Frame.SubFrame[r].Frame,h.Canvas=this.Canvas,h.LanguageID=this.LanguageID,h.GetEventCallback=function(t){return a.GetEventCallback(t)},h.SelectedChart=this.SelectedChart,this.TitlePaint[r+1]=h}for(r=0;r<this.Frame.SubFrame.length;++r){n=this.Frame.SubFrame[r].Frame;r==this.Frame.SubFrame.length-1?n.XSplitOperator.ShowText=!0:n.XSplitOperator.ShowText=!1}this.Frame.SetSizeChage(!0),this.ResetFrameXYSplit(),this.UpdateFrameMaxMin(),this.Draw();var l=[{Index:"RSI"},{Index:"MACD"},{Index:"VOL"},{Index:"UOS"},{Index:"CHO"},{Index:"BRAR"}];e&&e.Windows.length>0&&(l=e.Windows);var u=new B;for(r=i;r<t;++r){n=l[r%l.length];var C=n.Index,D=u.Get(C),f=D.Args;n.Args&&(f=n.Args);var c={Name:D.Name,Script:D.Script,Args:f,ID:n.Index,KLineType:D.KLineType,YSpecificMaxMin:D.YSpecificMaxMin,YSplitScale:D.YSplitScale,FloatPrecision:D.FloatPrecision,Condition:D.Condition,OutName:D.OutName};this.WindowIndex[r]=new wn(c.Name,c.Script,c.Args,c);o=this.Frame.SubFrame[r];null!=n.Modify&&(this.Frame.SubFrame[r].Frame.ModifyIndex=n.Modify),null!=n.Change&&(this.Frame.SubFrame[r].Frame.ChangeIndex=n.Change),null!=n.Close&&(this.Frame.SubFrame[r].Frame.CloseIndex=n.Close),null!=n.Overlay&&(chart.Frame.SubFrame[r].Frame.OverlayIndex=n.Overlay),1==n.IsDrawTitleBG&&(this.Frame.SubFrame[r].Frame.IsDrawTitleBG=n.IsDrawTitleBG),ha.IsNumber(n.TitleHeight)?this.Frame.SubFrame[r].Frame.ChartBorder.TitleHeight=n.TitleHeight:n.TitleHeight=this.Frame.SubFrame[r].Frame.ChartBorder.TitleHeight,0==n.IsShowTitleArraw&&(this.Frame.SubFrame[r].Frame.IsShowTitleArraw=!1),0==n.IsShowIndexName&&(this.Frame.SubFrame[r].Frame.IsShowIndexName=!1),0==n.IsShowOverlayIndexName&&(this.Frame.SubFrame[r].Frame.IsShowOverlayIndexName=!1),ha.IsNumber(n.IndexParamSpace)&&(this.Frame.SubFrame[r].Frame.IndexParamSpace=n.IndexParamSpace),ha.IsNumber(n.IndexTitleSpace)&&(this.Frame.SubFrame[r].Frame.IndexTitleSpace=n.IndexTitleSpace),0==n.IsShowXLine&&(this.Frame.SubFrame[r].Frame.IsShowXLine=!1),0==n.IsShowYLine&&(this.Frame.SubFrame[r].Frame.IsShowYLine=!1),ha.IsBool(n.IsShowIndexTitle)&&(this.Frame.SubFrame[r].Frame.IsShowIndexTitle=n.IsShowIndexTitle),ha.IsBool(n.IsShowLeftText)&&(o.Frame.IsShowYText[0]=n.IsShowLeftText,o.Frame.YSplitOperator.IsShowLeftText=n.IsShowLeftText),ha.IsBool(n.IsShowRightText)&&(o.Frame.IsShowYText[1]=n.IsShowRightText,o.Frame.YSplitOperator.IsShowRightText=n.IsShowRightText),n.OverlayIndexType&&(ha.IsNumber(n.OverlayIndexType.Position)&&(o.Frame.OverlayIndexType.Position=n.OverlayIndexType.Position),ha.IsNumber(n.OverlayIndexType.LineSpace)&&(o.Frame.OverlayIndexType.LineSpace=n.OverlayIndexType.LineSpace));var d=this.ChartPaint[0].Data;this.BindIndexData(r,d)}}}},this.ChangeIndexTemplate=function(t){var e=this;if(t.Windows){var a=t.Windows.length;if(!(a<=0)){var i=this.Frame.SubFrame.length,r=null,n=null;t.KLine&&(ha.IsNumber(t.KLine.Period)&&t.KLine.Period!=this.Period&&(r=t.KLine.Period),ha.IsNumber(t.KLine.Right)&&t.KLine.Right!=this.Right&&(n=t.KLine.Right));for(var s=null!=r||null!=n,o=0;o<i;++o){this.DeleteIndexPaint(o);var h=this.Frame.SubFrame[o];h.YSpecificMaxMin=null,h.IsLocked=!1,h.YSplitScale=null}if(i>a){for(o=i-1;o>=a;--o)this.Frame.SubFrame[o].Frame.ClearToolbar();this.Frame.SubFrame.splice(a,i-a),this.WindowIndex.splice(a,i-a)}else for(o=i;o<a;++o){var l=this.CreateSubFrameItem(o);this.Frame.SubFrame[o]=l;var u=new Ya;u.Frame=this.Frame.SubFrame[o].Frame,u.Canvas=this.Canvas,u.LanguageID=this.LanguageID,u.GetEventCallback=function(t){return e.GetEventCallback(t)},u.SelectedChart=this.SelectedChart,this.TitlePaint[o+1]=u}var C=new B,D=this.ChartPaint[0].Data;for(o=0;o<a;++o){var f=o,c=t.Windows[o],d=null;t.Frame&&t.Frame.length>o&&(d=t.Frame[o]);var m=f+1;if(this.TitlePaint[m].Data=[],this.TitlePaint[m].Title=null,c.Script)this.WindowIndex[o]=new wn(c.Name,c.Script,c.Args,c),s||this.BindIndexData(f,D);else{var v=c.Index,S=Bi.Get(v);if(S)this.WindowIndex[o]=S.Create(),this.CreateWindowIndex(f),s||this.BindIndexData(f,D);else{var I=C.Get(v);if(I){var p=I.Args;t.Windows[o].Args&&(p=t.Windows[o].Args);var T={Name:I.Name,Script:I.Script,Args:p,ID:v,KLineType:I.KLineType,YSpecificMaxMin:I.YSpecificMaxMin,YSplitScale:I.YSplitScale,FloatPrecision:I.FloatPrecision,Condition:I.Condition,OutName:I.OutName};c.TitleFont&&(T.TitleFont=c.TitleFont),this.WindowIndex[o]=new wn(T.Name,T.Script,T.Args,T),s||this.BindIndexData(f,D)}}}null!=c.Modify&&(this.Frame.SubFrame[o].Frame.ModifyIndex=c.Modify),null!=c.Change&&(this.Frame.SubFrame[o].Frame.ChangeIndex=c.Change),null!=c.Close&&(this.Frame.SubFrame[o].Frame.CloseIndex=c.Close),null!=c.Overlay&&(chart.Frame.SubFrame[o].Frame.OverlayIndex=c.Overlay),1==c.IsDrawTitleBG&&(this.Frame.SubFrame[o].Frame.IsDrawTitleBG=c.IsDrawTitleBG),ha.IsNumber(c.TitleHeight)?this.Frame.SubFrame[o].Frame.ChartBorder.TitleHeight=c.TitleHeight:c.TitleHeight=this.Frame.SubFrame[o].Frame.ChartBorder.TitleHeight,0==c.IsShowTitleArraw&&(this.Frame.SubFrame[o].Frame.IsShowTitleArraw=!1),0==c.IsShowIndexName&&(this.Frame.SubFrame[o].Frame.IsShowIndexName=!1),ha.IsNumber(c.IndexParamSpace)&&(this.Frame.SubFrame[o].Frame.IndexParamSpace=c.IndexParamSpace),ha.IsNumber(c.IndexTitleSpace)&&(this.Frame.SubFrame[o].Frame.IndexTitleSpace=c.IndexTitleSpace),d&&(d.SplitCount&&(this.Frame.SubFrame[o].Frame.YSplitOperator.SplitCount=d.SplitCount),!1!==d.IsShowXLine&&!0!==d.IsShowXLine||(this.Frame.SubFrame[o].Frame.IsShowXLine=d.IsShowXLine),!1!==d.IsShowYLine&&!0!==d.IsShowYLine||(this.Frame.SubFrame[o].Frame.IsShowYLine=d.IsShowYLine),!1!==d.IsShowLeftText&&!0!==d.IsShowLeftText||(this.Frame.SubFrame[o].Frame.IsShowYText[0]=d.IsShowLeftText,this.Frame.SubFrame[o].Frame.YSplitOperator.IsShowLeftText=d.IsShowLeftText),!1!==d.IsShowRightText&&!0!==d.IsShowRightText||(this.Frame.SubFrame[o].Frame.IsShowYText[1]=d.IsShowRightText,this.Frame.SubFrame[o].Frame.YSplitOperator.IsShowRightText=d.IsShowRightText))}for(o=0;o<this.Frame.SubFrame.length;++o){c=this.Frame.SubFrame[o].Frame;o==this.Frame.SubFrame.length-1?c.XSplitOperator.ShowText=!0:c.XSplitOperator.ShowText=!1}s?(this.Frame.SetSizeChage(!0),null!=r?this.ChangePeriod(r,t):null!=n&&this.ChangeRight(n)):(this.UpdataDataoffset(),this.Frame.SetSizeChage(!0),this.ResetFrameXYSplit(),this.UpdateFrameMaxMin(),this.Draw())}}},this.RemoveIndexWindow=function(t,e){if(w.Chart.Log("[KLineChartContainer::RemoveIndexWindow] remove id",t),0!=t){if(this.Frame.SubFrame&&!(t>=this.Frame.SubFrame.length)){this.Frame.RestoreIndexWindows();var a=this.Frame.SubFrame[t].Frame;this.DeleteIndexPaint(t),this.Frame.SubFrame[t].Frame.ClearToolbar(),this.Frame.SubFrame.splice(t,1),this.WindowIndex.splice(t,1),this.TitlePaint.splice(t+1,1);for(var i=0;i<this.Frame.SubFrame.length;++i){var r=this.Frame.SubFrame[i].Frame;i==this.Frame.SubFrame.length-1?r.XSplitOperator.ShowText=!0:r.XSplitOperator.ShowText=!1,r.Identify=i}if(this.ChartDrawPicture.length>0){var n=[];for(var i in this.ChartDrawPicture){r=this.ChartDrawPicture[i];r.Frame!=a&&n.push(r)}this.ChartDrawPicture=n}this.Frame.SetSizeChage(!0),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw()}}else e&&e.DeleteMainIndex&&(this.DeleteIndexPaint(t),this.WindowIndex[t]=null,this.Frame.SetSizeChage(!0),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw())},this.GetIndexInfo=function(){var t=[];for(var e in this.WindowIndex){var a=this.WindowIndex[e],i={Name:a.Name};if(a.ID&&(i.ID=a.ID),a.Arguments)for(var e in i.Args=[],a.Arguments){var r=a.Arguments[e];i.Args.push({Name:r.Name,Value:r.Value})}t.push(i)}return t},this.CreateExtendChart=function(t,e){var a;switch(t){case"ç­¹ç åå¸":return a=new Qe,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,a.Left=this.Frame.ChartBorder.Right,a.SetOption(e),this.ExtendChartPaint.push(a),this.Frame.ChartBorder.Right+=a.Width,a;case"ç»å¾å·¥å·":return a=new je,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,a.Left=this.Frame.ChartBorder.Right,a.SetOption(e),this.ExtendChartPaint.push(a),this.Frame.ChartBorder.Right+=a.Width,a;case"KLineTooltip":return a=e.Create&&"function"==typeof e.Create?e.Create():new ze,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,e.LanguageID=this.LanguageID,a.SetOption(e),this.ExtendChartPaint.push(a),a;case"æ·±åº¦å¾":return a=new ea,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,a.SetOption(e),this.ExtendChartPaint.push(a),a;case"èæ¯å¾":return a=new aa,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,a.SetOption(e),this.ExtendChartPaint.push(a),a;case"FrameSplitPaint":return a=new $e,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,a.SetOption(e),this.ExtendChartPaint.push(a),a;default:return a=Ke.Create(t),a?(a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,a.SetOption(e),this.ExtendChartPaint.push(a),a):null}},this.OnTouchFinished=function(){if(this.DragMode==Y.CLICK_TOUCH_MODE_ID){if(1==this.TouchStatus.CorssCursorShow&&this.TouchDrawCount>0)return;return this.TouchStatus.CorssCursorShow=!1,void this.DrawDynamicInfo()}if(!0!==this.CorssCursorTouchEnd)for(var t in this.ExtendChartPaint){var e=this.ExtendChartPaint[t];"KLineTooltipPaint"===e.ClassName&&this.DrawDynamicInfo()}else this.TouchDrawCount>0&&this.DrawDynamicInfo()},this.LockIndex=function(t){if(t&&t.IndexName)for(var e in this.WindowIndex){var a=this.WindowIndex[e];if(a||conintue,a.Name==t.IndexName){a.SetLock(t),this.Update();break}}},this.TryClickLock=function(t,e){for(var a in this.Frame.SubFrame){var i=this.Frame.SubFrame[a];if(i.Frame.IsLocked&&i.Frame.LockPaint){var r=new Ht;if(i.Frame.LockPaint.GetTooltipData(t,e,r))return r.HQChart=this,r.Data.Callback&&r.Data.Callback(r),!0}}return!1},this.TryClickIndexTitle=function(t,e){for(var a in this.TitlePaint){var i=this.TitlePaint[a];if(i.IsClickTitle&&i.IsClickTitle(t,e)){var r={Point:{X:t,Y:e},Title:i.Title,FrameID:i.Frame.Identify};w.Chart.Log("[KLineChartContainer::TryClickIndexTitle] click title ",r);var n=this.GetEventCallback(G.ON_CLICK_INDEXTITLE);return n&&n.Callback&&n.Callback(n,r,this),!0}}return!1},this.SetSizeChange=function(t){for(var e in this.Frame.SetSizeChage(t),this.ExtendChartPaint){var a=this.ExtendChartPaint[e];a.SizeChange=t}},this.SetSizeChage=this.SetSizeChange,this.Update=function(t){if(this.SourceData){this.BeforeBindMainData&&this.BeforeBindMainData("Update");var e,a=new Ot;if(a.Data=this.SourceData.Data,a.Period=this.Period,a.Right=this.Right,a.DataType=this.SourceData.DataType,a.Symbol=this.Symbol,a.Right>0&&Ot.IsDayPeriod(a.Period,!0)){var i=a.GetRightData(a.Right,{AlgorithmType:this.RightFormula});a.Data=i}if(Ot.IsDayPeriod(a.Period,!1)||Ot.IsMinutePeriod(a.Period,!1)){var r=a.GetPeriodData(a.Period);a.Data=r}this.BindMainData(a,this.PageSize),this.AfterBindMainData&&this.AfterBindMainData("Update");for(var n=0;n<this.Frame.SubFrame.length;++n)0==n&&(e=this.Frame.SubFrame[n].Frame),this.BindIndexData(n,a);for(var n in e&&e.YSplitOperator&&(e.YSplitOperator.Symbol=this.Symbol,e.YSplitOperator.Data=this.ChartPaint[0].Data,e.YSplitOperator.Period=this.Period),this.OverlayChartPaint){var s=this.OverlayChartPaint[n];if(s.SourceData)if(Ot.IsMinutePeriod(this.Period,!0)){a=new Ot;a.Data=s.SourceData.Data,a.Period=this.Period,a.Right=this.Right;var o=this.SourceData.GetOverlayMinuteData(a.Data,this.IsApiPeriod);if(a.Data=o,Ot.IsMinutePeriod(a.Period,!1)&&!this.IsApiPeriod){r=a.GetPeriodData(a.Period);a.Data=r}s.Data=a}else{a=new Ot;if(a.Data=s.SourceData.Data,a.Period=this.Period,a.Right=this.Right,a.Right>0&&Br.IsSHSZStockA(s.Symbol)){i=a.GetRightData(a.Right,{AlgorithmType:this.RightFormula});a.Data=i}o=this.SourceData.GetOverlayData(a.Data,this.IsApiPeriod);if(a.Data=o,Ot.IsDayPeriod(a.Period,!1)&&!this.IsApiPeriod){r=a.GetPeriodData(a.Period);a.Data=r}s.Data=a}}this.ReqeustKLineInfoData({FunctionName:"Update"}),this.CreateChartDrawPictureByStorage(),this.UpdataDataoffset(),t&&t.UpdateCursorIndexType>0?this.UpdatePointByCursorIndex(t.UpdateCursorIndexType):this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw();for(n=0;n<this.Frame.SubFrame.length;++n){s=this.Frame.SubFrame[n];for(var h in s.OverlayIndex){var l=s.OverlayIndex[h];this.BindOverlayIndexData(l,n,a)}}}},this.ChangeSymbol=function(t,e){if(this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"KLineChartContainer::ChangeSymbol"),this.ClearRectSelect(!0),this.ClearCustomKLine(),this.Symbol=t,t){if(e&&e.KLine){var a=e.KLine;ha.IsNumber(a.Right)&&(this.Right=a.Right),ha.IsNumber(a.Period)&&(this.Period=a.Period)}if(Br.IsSHSZIndex(t)&&(this.Right=0),this.ClearIndexPaint(),e&&e.Windows&&Array.isArray(e.Windows)&&e.Windows.length>0){var i=e.Windows,r=new B;for(var n in i){if(n>=this.WindowIndex.length)break;a=i[n];if(a)if(a.Script)this.WindowIndex[n]=new wn(a.Name,a.Script,a.Args,a);else if(a.API){var s=a.API;this.WindowIndex[n]=new Rn(s.Name,s.Script,s.Args,a)}else{var o=a.Index,h=r.Get(o);if(h){h.Args;a.Args&&(h.Args=a.Args),h.ID=o,this.WindowIndex[n]=new wn(h.Name,h.Script,h.Args,h)}}}}this.ReloadChartDrawPicture(),this.Frame.ClearUpDonwFrameYData(),Ot.IsDayPeriod(this.Period,!0)?this.RequestHistoryData():Ot.IsMinutePeriod(this.Period,!0)||Ot.IsSecondPeriod(this.Period)?this.ReqeustHistoryMinuteData():Ot.IsTickPeriod(this.Period)&&this.RequestTickData()}else this.DrawEmpty()},this.ReqeustKLineInfoData=function(t){if(t&&"RecvDragDayData"==t.FunctionName)t.Update=!0;else{if(this.ChartPaint.length>0){var e=this.ChartPaint[0];e.InfoData=new E.default}t.Update=!1}for(var a in this.ChartInfo)this.ChartInfo[a].RequestData(this,t)},this.SetKLineInfo=function(t,e){for(var a in this.ChartInfo=[],t){var i=lr.Get(t[a]);if(i){var r=i.Create();r.MaxRequestDataCount=this.MaxRequestDataCount,this.ChartInfo.push(r)}}1==e&&this.ReqeustKLineInfoData({FunctionName:"SetKLineInfo"})},this.AddKLineInfo=function(t,e){var a=lr.GetClassInfo(t);if(a){for(var i in this.ChartInfo){var r=this.ChartInfo[i];if(r.ClassName==a.ClassName)return}var n=lr.Get(t);if(n){r=n.Create();r.MaxRequestDataCount=this.MaxRequestDataCount,this.ChartInfo.push(r),1==e&&r.RequestData(this)}}else console.warn("[KLineChartContainer::AddKLineInfo] can't find infoname=",t)},this.DeleteKLineInfo=function(t){var e=lr.GetClassInfo(t);if(e)for(var a in this.ChartInfo){var i=this.ChartInfo[a];if(i.ClassName==e.ClassName){this.ChartInfo.splice(a,1),this.UpdataChartInfo(),this.Draw();break}}else console.warn("[KLineChartContainer::DeleteKLineInfo] can't find infoname=",t)},this.ClearKLineInfo=function(){if(this.ChartInfo&&!(this.ChartInfo.length<=0)){this.ChartInfo=[];var t=this.ChartPaint[0];t.InfoData=null,this.Draw()}},this.OverlaySymbol=function(t,e){for(var a in this.OverlayChartPaint){var i=this.OverlayChartPaint[a];if(i.Symbol===t)return console.warn("[KLineChartContainer::OverlaySymbol] overlay symbol="+t+" exist."),!1}var r=new zt;return r.Canvas=this.Canvas,r.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,r.ChartFrame=this.Frame.SubFrame[0].Frame,r.Name="Overlay-KLine",r.DrawType=this.KLineDrawType,r.Symbol=t,r.Identify="Overlay-KLine-"+t,e&&e.Color?r.Color=e.Color:r.Color=Oi.OverlaySymbol.Color[Oi.OverlaySymbol.Random%Oi.OverlaySymbol.Color.length],r.SetOption(e),++Oi.OverlaySymbol.Random,this.ChartPaint[0]&&this.ChartPaint[0].Data&&this.SourceData&&(r.MainData=this.ChartPaint[0].Data),this.OverlayChartPaint.push(r),Ot.IsDayPeriod(this.Period,!0)?this.RequestOverlayHistoryData():Ot.IsMinutePeriod(this.Period,!0)&&this.RequestOverlayHistoryMinuteData(),!0},this.RequestOverlayHistoryData=function(){var t=this;if(this.OverlayChartPaint.length&&this.SourceData&&this.SourceData.Data){var e=this,a=this.GetRequestDataCount(),i=this.SourceData.Data[0].Date,r=function(){var r=t.OverlayChartPaint[n];if(!r.MainData)return"continue";if(r.Status!=Jt.STATUS_NONE_ID)return"continue";var o=r.Symbol;return o?(r.Status=Jt.STATUS_REQUESTDATA_ID,t.NetworkFilter&&(s={Name:"KLineChartContainer::RequestOverlayHistoryData",Explain:"å å è¡ç¥¨æ¥Kçº¿æ°æ®",Request:{Url:e.KLineApiUrl,Data:{symbol:o,count:a.MaxRequestDataCount,first:{date:i},field:["name","symbol","yclose","open","price","high","vol","amount"]},Type:"POST"},Self:t,PreventDefault:!1},t.NetworkFilter(s,(function(t){r.Status=Jt.STATUS_RECVDATA_ID,e.RecvOverlayHistoryData(t,r)})),1==s.PreventDefault)?{v:void 0}:void O.HttpRequest({url:t.KLineApiUrl,data:{field:["name","symbol","yclose","open","price","high"],symbol:o,start:-1,count:a.MaxRequestDataCount},type:"post",dataType:"json",async:!0,success:function(t){r.Status=Jt.STATUS_RECVDATA_ID,e.RecvOverlayHistoryData(t,r)}})):"continue"};for(var n in this.OverlayChartPaint){var s,o=r();switch(o){case"continue":continue;default:if("object"===("undefined"===typeof o?"undefined":(0,d.default)(o)))return o.v}}}},this.RecvOverlayHistoryData=function(t,e){if(!e.IsDelete){var a=Gi.JsonDataToHistoryData(t),i=new Ot;i.Data=a,i.DataType=0;var r=new Ot;if(r.Data=a,r.Period=this.Period,r.Right=this.Right,r.DataType=0,r.Right>0&&Br.IsSHSZStockA(t.symbol)&&!this.IsApiPeriod){var n=r.GetRightData(r.Right,{AlgorithmType:this.RightFormula});r.Data=n}var s=this.SourceData.GetOverlayData(r.Data,this.IsApiPeriod);if(r.Data=s,Ot.IsDayPeriod(r.Period,!1)&&!this.IsApiPeriod){var o=r.GetPeriodData(r.Period);r.Data=o}e.Data=r,e.SourceData=i,e.Title=t.name,e.Symbol=t.symbol,e.Status=Jt.STATUS_FINISHED_ID,this.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=1,this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}},this.RequestOverlayHistoryMinuteData=function(){var t=this;if(this.OverlayChartPaint.length&&this.SourceData&&this.SourceData.Data){var e=this,a=this.GetRequestDataCount(),i=this.SourceData.Data[0].Date,r=this.SourceData.Data[0].Time,n=function(){var n=t.OverlayChartPaint[s];if(!n.MainData)return"continue";if(n.Status!=Jt.STATUS_NONE_ID)return"continue";var h=n.Symbol;return h?(n.Status=Jt.STATUS_REQUESTDATA_ID,t.NetworkFilter&&(o={Name:"KLineChartContainer::RequestOverlayHistoryMinuteData",Explain:"å å è¡ç¥¨åéKçº¿æ°æ®",Request:{Url:e.MinuteKLineApiUrl,Data:{symbol:h,count:a.MaxRequestMinuteDayCount,first:{date:i,time:r},field:["name","symbol","yclose","open","price","high","vol","amount"]},Type:"POST"},Self:t,PreventDefault:!1},t.NetworkFilter(o,(function(t){n.Status=Jt.STATUS_RECVDATA_ID,e.RecvOveralyHistoryMinuteData(t,n)})),1==o.PreventDefault)?{v:void 0}:void O.HttpRequest({url:t.MinuteKLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","vol","amount"],symbol:h,start:-1,count:a.MaxRequestMinuteDayCount},type:"post",dataType:"json",async:!0,success:function(t){n.Status=Jt.STATUS_RECVDATA_ID,e.RecvOveralyHistoryMinuteData(t,n)}})):"continue"};for(var s in this.OverlayChartPaint){var o,h=n();switch(h){case"continue":continue;default:if("object"===("undefined"===typeof h?"undefined":(0,d.default)(h)))return h.v}}}},this.RecvOveralyHistoryMinuteData=function(t,e){var a=Gi.JsonDataToMinuteHistoryData(t);if(a){var i=new Ot;i.Data=a,i.DataType=1;var r=new Ot;r.Data=a,r.Period=this.Period,r.Right=this.Right,r.DataType=1;var n=this.SourceData.GetOverlayMinuteData(r.Data,this.IsApiPeriod);if(r.Data=n,Ot.IsMinutePeriod(r.Period,!1)&&!this.IsApiPeriod){var s=r.GetPeriodData(r.Period);r.Data=s}e.Data=r,e.SourceData=i,e.Title=t.name,e.Symbol=t.symbol,e.Status=Jt.STATUS_FINISHED_ID,this.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=1,this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}},this.ResetOverlaySymbolStatus=function(){for(var t in this.OverlayChartPaint){var e=this.OverlayChartPaint[t];e.Status=Jt.STATUS_NONE_ID}},this.ClearOverlaySymbol=function(){for(var t in this.OverlayChartPaint){var e=this.OverlayChartPaint[t];e.IsDelete=!0}this.OverlayChartPaint=[],this.TitlePaint[0].OverlayChartPaint=this.OverlayChartPaint,this.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=0,this.UpdateFrameMaxMin(),this.Draw()},this.DeleteOverlaySymbol=function(t){for(var e in this.OverlayChartPaint){var a=this.OverlayChartPaint[e];if(a.Symbol===t)return a.IsDelete=!0,this.OverlayChartPaint.splice(e,1),this.OverlayChartPaint.length<=0&&(this.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType=0),this.UpdateFrameMaxMin(),this.Draw(),!0}return console.warn("[KLineChartContainer::DeleteOverlaySymbol] overlay symbol="+t+" not exist."),!1},this.RequestFlowCapitalData=function(){if(this.Symbol&&1!=this.FlowCapitalReady){var t=this.Symbol.toUpperCase(),e=!0;if((Br.IsBIT(t)||Br.IsFutures(t))&&(e=!1),this.EnableFlowCapital&&Br.IsBIT(t)&&1==this.EnableFlowCapital.BIT&&(e=!0),!e)return w.Chart.Log("[KLineChartContainer::RequestFlowCapitalData] symbol="+this.Symbol+" not need download data."),void(this.FlowCapitalReady=!0);var a=this,i=["name","date","symbol","capital.a"];if(this.NetworkFilter){var r={Name:"KLineChartContainer::RequestFlowCapitalData",Explain:"æµéè¡æ¬æ°æ®",Request:{Url:a.StockHistoryDayApiUrl,Data:{symbol:[this.Symbol],orderfield:"date",field:i},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(r,(function(t){a.RecvFlowCapitalData(t)})),1==r.PreventDefault)return}O.HttpRequest({url:this.StockHistoryDayApiUrl,data:{field:i,symbol:[this.Symbol],orderfield:"date"},type:"post",dataType:"json",async:!0,success:function(t){a.RecvFlowCapitalData(t)}})}},this.RecvFlowCapitalData=function(t){if(t.stock&&1==t.stock.length){var e=t.stock[0],a=new Array;for(var i in e.stockday){var r=e.stockday[i],n=new Et;n.Date=r.date;var s=r.capital;s&&(s.a>0&&(n.Value=s.a,a.push(n)))}if(this.IsApiPeriod){var o=this.ChartPaint[0].Data,h=null;if(Ot.IsMinutePeriod(this.Period,!0)?h=o.GetMinuteFittingFinanceData(a):Ot.IsDayPeriod(this.Period,!0)&&(h=o.GetFittingFinanceData(a)),h&&o.Data&&h.length==o.Data.length)for(var l in o.Data){r=o.Data[l];h[l]&&ha.IsNumber(h[l].Value)&&(r.FlowCapital=h[l].Value)}}else if(Ot.IsMinutePeriod(this.Period,!0)){h=this.SourceData.GetMinuteFittingFinanceData(a);for(var u in this.SourceData.Data){r=this.SourceData.Data[u];h[u]&&ha.IsNumber(h[u].Value)&&(r.FlowCapital=h[u].Value)}var C=this.ChartPaint[0].Data,D=new Ot;if(D.Data=this.SourceData.Data,Ot.IsMinutePeriod(C.Period,!1)){var f=D.GetPeriodData(C.Period);D.Data=f}C.Data=D.Data}else{h=this.SourceData.GetFittingFinanceData(a);for(var c in this.SourceData.Data){r=this.SourceData.Data[c];h[c]&&ha.IsNumber(h[c].Value)&&(r.FlowCapital=h[c].Value)}C=this.ChartPaint[0].Data,D=new Ot;if(D.Data=this.SourceData.Data,C.Right>0){var d=D.GetRightData(C.Right,{AlgorithmType:this.RightFormula});D.Data=d}if(Ot.IsDayPeriod(C.Period,!1)){f=D.GetPeriodData(C.Period);D.Data=f}C.Data=D.Data}this.FlowCapitalReady=!0;var m=!1;for(var l in this.ExtendChartPaint){r=this.ExtendChartPaint[l];if("StockChip"==r.ClassName){m=!0;break}}m&&this.Draw()}},this.CreateChartDrawPicture=function(t,e,a){var i=null,r=ka.GetDrawPictureByName(t);if(r&&(i=r.Create(),"ChartDrawPictureText"!=i.ClassName&&"ChartDrawVolProfile"!=i.ClassName||(i.HQChart=this)),!i&&ka.MapIonFont.has(t)){var n=ka.MapIonFont.get(t);i=new ni,i.FontOption.Family=n.Family,i.Text=n.Text,n.Color&&(i.LineColor=n.Color)}if(!i)return!1;i.Canvas=this.Canvas,i.Status=0,i.Symbol=this.Symbol,i.Period=this.Period,i.Right=this.Right,i.Option=this.ChartDrawOption,a&&(i.FinishedCallback=a),e&&i.SetOption(e);var s=this;return i.Update=function(){s.DrawDynamicInfo()},i.GetActiveDrawPicture=function(){return s.GetActiveDrawPicture()},this.CurrentChartDrawPicture=i,!0},this.AddChartDrawPicture=function(t){if(!t)return null;if(t.FrameID<0||t.FrameID>=this.Frame.SubFrame.length)return null;var e=ka.GetDrawPictureByClassName(t.ClassName);if(!e)return null;var a=e.Create();return a.Canvas=this.Canvas,a.Status=10,a.Frame=this.Frame.SubFrame[t.FrameID].Frame,a.Symbol=this.Symbol,a.Period=this.Period,a.Right=this.Right,t.Value&&(a.Value=t.Value),a.ImportStorageData&&a.ImportStorageData(t),a.SetOption(t),t.EnableUpdateXValue&&a.UpdateXValue(),a.ValueToPoint(),"ChartDrawPictureText"===a.ClassName&&(a.IsInitialized=!0),this.ChartDrawPicture.push(a),this.DrawDynamicInfo(),a},this.MoveChartDrawPicture=function(t,e,a){var i=this.CurrentChartDrawPicture;if(!i)return!1;var r=U();a&&(r=1);var n=t*r,s=e*r;return i.Move(n,s),!0},this.UpdateChartDrawXValue=function(){for(var t in this.ChartDrawPicture){var e=this.ChartDrawPicture[t];e.UpdateXValue()}},this.OnRightMenu=function(t,e,a){var i=U();if(this.RightMenu){var r=this.Frame.PtInFrame(t*i,e*i);a.data={Chart:this,FrameID:r},this.RightMenu.DoModal(a)}var n=this.GetEventCallback(G.ON_CONTEXT_MENU);if(n){r=this.Frame.PtInFrame(t*i,e*i);var s={X:t,Y:e,Event:a,FrameID:r};n.Callback(n,s,this)}},this.ReloadChartDrawPicture=function(){if(this.ChartDrawPicture=[],this.ChartDrawStorageCache,this.ChartDrawStorage){this.ChartDrawStorageCache=this.ChartDrawStorage.GetDrawData({Symbol:this.Symbol,Period:this.Period});var t=this.GetEventCallback(G.ON_LOAD_DRAWPICTURE);if(t&&t.Callback){var e={Symbol:this.Symbol,Period:this.Period,DrawStorage:this.ChartDrawStorage,ChartDrawStorageCache:this.ChartDrawStorageCache};t.Callback(t,e,this)}}},this.CreateChartDrawPictureByStorage=function(){if(this.ChartDrawStorageCache&&!(this.ChartDrawStorageCache.length<=0)){for(var t in this.ChartDrawStorageCache){var e=this.ChartDrawStorageCache[t];if(!(e.FrameID<0||!this.Frame.SubFrame||this.Frame.SubFrame.length<e.FrameID)){var a=ka.CreateChartDrawPicture(e);if(a){a.Canvas=this.Canvas,a.Status=10,a.Frame=this.Frame.SubFrame[e.FrameID].Frame,a.ImportStorageData&&a.ImportStorageData(e),a.UpdateXValue(),a.ValueToPoint();var i=this;a.GetActiveDrawPicture=function(){return i.GetActiveDrawPicture()},"ChartDrawPictureText"===a.ClassName&&(a.IsInitialized=!0),this.ChartDrawPicture.push(a)}}}this.ChartDrawStorageCache=null}},this.RequestKLineMatch=function(t,e){var a=this,i=e.Scope,r=e.WaitDialog;w.Chart.Log("[KLineChartContainer::RequestKLineMatch",t,i);for(var n=new Array,s=new Array,o=t.Start;o<t.End&&o<t.Data.Data.length;++o){var h=t.Data.Data[o];n.push(h.Date),s.push(h.Close)}var l={Stock:t.Stock,Index:{Start:t.Start,End:t.End},Date:{Start:n[0],End:n[n.length-1]},Minsimilar:i.Minsimilar,Plate:i.Plate,DayRegion:300};A.default.ajax({url:this.KLineMatchUrl,data:{userid:"guest",plate:i.Plate,period:this.Period,right:this.Right,dayregion:l.DayRegion,minsimilar:i.Minsimilar,sampledate:n,samplevalue:s},type:"post",dataType:"json",async:!0,success:function(t){r&&r.Close(),a.RecvKLineMatchData(t,l)},error:function(t,e,a){console.warn("[KLineChartContainer::RequestKLineMatch] failed",t,e,a),r&&r.Close()}})},this.RecvKLineMatchData=function(t,e){w.Chart.Log("[KLineChartContainer::RecvKLineMatchData] recv",t,e);var a=[];for(var i in t.match){var r=t.match[i];if(r.symbol!=e.Stock.Symbol)for(var n in r.data){var s=r.data[n],o={Symbol:r.symbol,Name:r.name,Similar:s.similar,Start:s.start,End:s.end};a.push(o)}}if(a.sort((function(t,e){return e.Similar-t.Similar})),w.Chart.Log("[KLineChartContainer::RecvKLineMatchData] filterData",a),this.mapEvent.has(G.RECV_KLINE_MATCH)){r=this.mapEvent.get(G.RECV_KLINE_MATCH),t={Sample:e,Match:a,Source:t};r.Callback(r,t,this)}else{var h=new Mr(this.Frame.ChartBorder.UIElement.parentNode),l={data:{Chart:this,MatchData:a,Sample:e,Source:t}};h.DoModal(l)}},this.UpdataChartInfo=function(){var t=null;if(0==this.Period)for(var e in t=new E.default,this.ChartInfo){var a=this.ChartInfo[e].Data;for(var i in a){var r=a[i];t.has(r.Date.toString())?t.get(r.Date.toString()).Data.push(r):t.set(r.Date.toString(),{Data:new Array(r)})}}else if(Ot.IsDayPeriod(this.Period,!1)){t=new E.default;var n=this.ChartPaint[0].Data;if(n&&n.Data&&n.Data.length>0){var s=n.Data[0],o=[];for(var e in this.ChartInfo){var h=this.ChartInfo[e];for(var i in h.Data){r=h.Data[i];r.Date>=s.Date&&o.push(r)}}o.sort((function(t,e){return t.Date-e.Date}));for(e=0;e<n.Data.length;){var l=n.Data[e];if(o.length<=0)break;h=o[0];l.Date<h.Date?++e:(t.has(l.Date.toString())?t.get(l.Date.toString()).Data.push(h):t.set(l.Date.toString(),{Data:new Array(h)}),o.shift())}}}var u=this.ChartPaint[0];u.InfoData=t},this.UpdateWindowIndex=function(t){var e=new Ot;if(e.Data=this.SourceData.Data,e.Period=this.Period,e.Right=this.Right,this.IsApiPeriod);else{if(e.Right>0){var a=e.GetRightData(e.Right,{AlgorithmType:this.RightFormula});e.Data=a}if(Ot.IsDayPeriod(e.Period,!1)||Ot.IsMinutePeriod(e.Period,!1)){var i=e.GetPeriodData(e.Period);e.Data=i}}if("function"==typeof this.WindowIndex[t].ExecuteScript){var r=this.ChartPaint[0].Data;this.WindowIndex[t].ExecuteScript(this,t,r)}else if("function"==typeof this.WindowIndex[t].RequestData){r=this.ChartPaint[0].Data;this.WindowIndex[t].RequestData(this,t,r,null)}else this.WindowIndex[t].BindData(this,t,e);this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.GetOverlayIndexByIdentify=function(t){for(var e=0;e<this.Frame.SubFrame.length;++e){var a=this.Frame.SubFrame[e];if(ha.IsNonEmptyArray(a.OverlayIndex))for(var i=0;i<a.OverlayIndex.length;++i){var r=a.OverlayIndex[i];if(r.Identify===t)return{OverlayItem:r,WindowIndex:e}}}return null},this.UpdateOverlayIndex=function(t){var e=this.GetOverlayIndexByIdentify(t);if(null!=e){if(this.ChartPaint[0]){var a=this.ChartPaint[0].Data;a&&this.BindOverlayIndexData(e.OverlayItem,e.WindowIndex,a)}}else console.warn("[KLineChartContainer::UpdateOverlayIndex] can't find overlay index. [identify="+t+"]")},this.ChangeWindowIndexParam=function(t){this.WindowIndex[t].Index[0].Param+=1,this.WindowIndex[t].Index[1].Param+=1,this.UpdateWindowIndex(t)},this.OnDoubleClick=function(t,e,a){if(this.EnableYDrag&&(this.EnableYDrag.Left||this.EnableYDrag.Right)&&this.Frame&&this.Frame.PtInFrameY){var i=U(),r=(t=(a.clientX-this.UIElement.getBoundingClientRect().left)*i,e=(a.clientY-this.UIElement.getBoundingClientRect().top)*i,this.Frame.PtInFrameY(t,e));r&&r.Index>=0&&0==r.IsOverlay&&this.CancelZoomUpDownFrameY(r)}var n;this.SelectedChart.EnableSelected&&(n=this.PtInChart(t,e));var s={SelectedChart:n};if(this.DBClickEvent(s,a),!n&&this.EnableZoomIndexWindow){var o=this.Frame.PtInFrame(t,e);if(w.Chart.Log("[KLineChartContainer::OnDoubleClick] frameId",o),o>=this.Frame.ZoomStartWindowIndex&&this.ZoomIndexWindow(o,{X:t,Y:e}))return this.Frame.SetSizeChage(!0),this.Draw(),!0}var h=null;if(this.mapEvent.has(G.DBCLICK_KLINE)&&(h=this.mapEvent.get(G.DBCLICK_KLINE)),this.MinuteDialog||h){var l=new Ht;if(this.PtInChartPaintTooltip(t,e,l)&&l.Data){if(h){null!=this.ClickChartTimer&&(clearTimeout(this.ClickChartTimer),this.ClickChartTimer=null);var u={Tooltip:l,Stock:{Symbol:this.Symbol,Name:this.Name},X:a.clientX,Y:a.clientY};h.Callback(h,u,this)}this.MinuteDialog&&(a.data={Chart:this,Tooltip:l},this.MinuteDialog.DoModal(a))}}},this.CancelAutoUpdate=function(){"number"==typeof this.AutoUpdateTimer&&(clearTimeout(this.AutoUpdateTimer),this.AutoUpdateTimer=void 0)},this.AutoUpdate=function(t){if(this.CancelAutoUpdate(),this.IsAutoUpdate&&this.Symbol){var e=this,a=Br.GetMarketStatus(this.Symbol);if(0!=a&&3!=a){var i=this.AutoUpdateFrequency;1==a?this.AutoUpdateTimer=setTimeout((function(){e.AutoUpdate()}),i):2==a&&(this.AutoUpdateTimer=setTimeout((function(){Ot.IsDayPeriod(e.Period,!0)?e.RequestRealtimeData():Ot.IsMinutePeriod(e.Period,!0)||Ot.IsSecondPeriod(e.Period)?e.RequestMinuteRealtimeData():Ot.IsTickPeriod(e.Period)&&e.RequestTickRealtimeData()}),i))}}},this.GetMaxMinPageSize=function(){var t={},e=this.Frame.ChartBorder.GetWidth(),a=Wt[Wt.length-1][0]+Wt[Wt.length-1][1];return t.Max=parseInt(e/a)-2,a=Wt[0][0]+Wt[0][1],t.Min=parseInt(e/a)-2,w.Chart.Log("[KLineChartContainer::GetMaxMinPageSize] Max="+t.Max+" Min="+t.Min),t},this.GetChartStatus=function(){var t=this.Frame.SubFrame[0].Frame;if(!t)return null;var e=t.Data;if(!e)return null;var a={KLine:{},Zoom:{}};return a.KLine.Count=e.Data.length,a.KLine.Offset=e.DataOffset,a.KLine.PageSize=t.XPointCount,a.Zoom.Index=t.ZoomIndex,a.Zoom.Max=Wt.length,a},this.DragDownloadData=function(){var t=null;if(t=this.Frame.Data?this.Frame.SubFrame[0].Frame.Data:this.Frame.Data,!t)return!1;if(!(t.DataOffset>0))if(Ot.IsMinutePeriod(this.Period,!0)||Ot.IsSecondPeriod(this.Period)){if(w.Chart.Log("[KLineChartContainer.DragDownloadData] Minute:[Enable="+this.DragDownload.Minute.Enable+", IsEnd="+this.DragDownload.Minute.IsEnd+", Status="+this.DragDownload.Minute.Status+", Period="+this.Period+"]"),!this.DragDownload.Minute.Enable)return;if(this.DragDownload.Minute.IsEnd)return;if(0!=this.DragDownload.Minute.Status)return;this.RequestDragMinuteData()}else if(Ot.IsDayPeriod(this.Period,!0)){if(w.Chart.Log("[KLineChartContainer.DragDownloadData] Day:[Enable="+this.DragDownload.Minute.Enable+", IsEnd="+this.DragDownload.Minute.IsEnd+", Status="+this.DragDownload.Minute.Status+"]"),!this.DragDownload.Day.Enable)return;if(this.DragDownload.Day.IsEnd)return;if(0!=this.DragDownload.Day.Status)return;this.RequestDragDayData()}else if(Ot.IsTickPeriod(this.Period)){if(w.Chart.Log("[KLineChartContainer.DragDownloadData] Tick:[Enable="+this.DragDownload.Tick.Enable+", IsEnd="+this.DragDownload.Tick.IsEnd+", Status="+this.DragDownload.Tick.Status+"]"),!this.DragDownload.Tick.Enable)return;if(this.DragDownload.Tick.IsEnd)return;if(0!=this.DragDownload.Tick.Status)return;this.RequestDragTickData()}},this.RequestDragTickData=function(){w.Chart.Log("[KLineChartContainer.RequestDragTickData] not finished.")},this.RequestDragMinuteData=function(){var t=this;this.AutoUpdateEvent(!1,"KLineChartContainer::RequestDragMinuteData"),this.CancelAutoUpdate();var e=this.DragDownload.Minute;e.Status=1;var a=this.SourceData.Data[0],i={field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,enddate:a.Date,endtime:a.Time,count:t.MaxRequestMinuteDayCount,first:{date:a.Date,time:a.Time}};if(ha.IsNonEmptyArray(this.OverlayChartPaint)){i.overlay=[];for(var r=0;r<this.OverlayChartPaint.length;++r){var n=this.OverlayChartPaint[r];i.overlay.push({symbol:n.Symbol})}}if(this.NetworkFilter){var s={Name:"KLineChartContainer::RequestDragMinuteData",Explain:"ææ½åé|ç§Kçº¿æ°æ®ä¸è½½",Request:{Url:this.DragMinuteKLineApiUrl,Type:"POST",Data:i,Period:this.Period,Right:this.Right},DragDownload:e,Self:this,PreventDefault:!1};if(this.NetworkFilter(s,(function(a){t.RecvDragMinuteData(a),e.Status=0,t.AutoUpdateEvent(!0,"KLineChartContainer::RequestDragMinuteData"),t.AutoUpdate()})),1==s.PreventDefault)return}O.HttpRequest({url:this.DragMinuteKLineApiUrl,data:i,type:"post",dataType:"json",async:!0,success:function(a){t.RecvDragMinuteData(a),e.Status=0,t.AutoUpdateEvent(!0,"KLineChartContainer::RequestDragMinuteData"),t.AutoUpdate()}})},this.RecvDragMinuteData=function(t){var e=Gi.JsonDataToMinuteHistoryData(t);if(!e||e.length<=0)this.DragDownload.Minute.IsEnd=!0;else{for(var a=this.GetHistoryDataCount(),i=this.SourceData.Data[0],r=null,n=e.length-1;n>=0;--n){var s=e[n];if(i.Date>s.Date||i.Date==s.Date&&i.Time>s.Time){r=n;break}if(i.Date==s.Date&&i.Time==s.Time){i.YClose=s.YClose,r=n-1;break}}if(!(null==r&&r<0)){for(n=0;n<e.length&&n<=r;++n){s=e[n];this.SourceData.Data.splice(n,0,s)}var o=new Ot;if(o.Data=this.SourceData.Data,o.Period=this.Period,o.Right=this.Right,o.DataType=this.SourceData.DataType,o.Symbol=this.Symbol,!this.IsApiPeriod&&(Ot.IsDayPeriod(o.Period,!1)||Ot.IsMinutePeriod(o.Period,!1))){var h=o.GetPeriodData(o.Period);o.Data=h}this.UpdateMainData(o,a),this.UpdateOverlayDragMinuteData(t),this.BindInstructionIndexData(o);for(n=0;n<this.Frame.SubFrame.length;++n)this.BindIndexData(n,o);this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.UpdateChartDrawXValue(),this.Draw(),this.BindAllOverlayIndexData(o)}}},this.UpdateOverlayDragMinuteData=function(t){if(ha.IsNonEmptyArray(this.OverlayChartPaint)){var e=t.overlay;if(ha.IsNonEmptyArray(e))for(var a=0;a<this.OverlayChartPaint.length;++a){var i=this.OverlayChartPaint[a];if(i.Symbol&&(i.MainData&&i.Status==Jt.STATUS_FINISHED_ID)){for(var r=null,n=0;n<e.length;++n){var s=e[n];if(s.symbol==i.Symbol){r=s;break}}if(r){var o=Gi.JsonDataToMinuteHistoryData(r),h=i.SourceData,l=h.Data[0],u=null;for(n=o.length-1;n>=0;--n){var C=o[n];if(l.Date>C.Date){u=n;break}if(l.Date==C.Date&&l.Time>C.Time){u=n;break}if(l.Date==C.Date&&l.Time==C.Time){l.YClose=C.YClose,u=n-1;break}}if(!(null==u&&u<0)){for(n=0;n<o.length&&n<=u;++n){C=o[n];h.Data.splice(n,0,C)}var D=new Ot;D.Data=h.Data,D.Period=this.Period,D.Right=this.Right,D.DataType=0;var f=this.SourceData.GetOverlayMinuteData(D.Data,this.IsApiPeriod);if(D.Data=f,Ot.IsMinutePeriod(D.Period,!1)&&!this.IsApiPeriod){var c=D.GetPeriodData(D.Period);D.Data=c}i.Data=D}}}}}},this.RequestDragDayData=function(){var t=this;this.AutoUpdateEvent(!1,"KLineChartContainer::RequestDragDayData"),this.CancelAutoUpdate();var e=this.DragDownload.Day;e.Status=1;var a=this.SourceData.Data[0],i={field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,enddate:a.Date,count:t.MaxRequestDataCount,first:{date:a.Date}};if(ha.IsNonEmptyArray(this.OverlayChartPaint)){i.overlay=[];for(var r=0;r<this.OverlayChartPaint.length;++r){var n=this.OverlayChartPaint[r];i.overlay.push({symbol:n.Symbol})}}if(this.NetworkFilter){var s={Name:"KLineChartContainer::RequestDragDayData",Explain:"ææ½æ¥Kæ°æ®ä¸è½½",Request:{Url:this.DragKLineApiUrl,Type:"POST",Data:i,Period:this.Period,Right:this.Right},DragDownload:e,Self:this,PreventDefault:!1};if(this.NetworkFilter(s,(function(a){t.RecvDragDayData(a),e.Status=0,t.AutoUpdateEvent(!0,"KLineChartContainer::RequestDragDayData"),t.AutoUpdate()})),1==s.PreventDefault)return}O.HttpRequest({url:this.DragKLineApiUrl,data:i,type:"post",dataType:"json",async:!0,success:function(a){t.RecvDragDayData(a),e.Status=0,t.AutoUpdateEvent(!0,"KLineChartContainer::RequestDragDayData"),t.AutoUpdate()}})},this.RecvDragDayData=function(t){var e=Gi.JsonDataToHistoryData(t);if(!e||e.length<=0)return this.DragDownload.Day.IsEnd=!0,void w.Chart.Log("[KLineChartContainer.RecvDragDayData] "+this.Symbol+" data end.");for(var a=this.GetHistoryDataCount(),i=this.SourceData.Data[0],r=null,n=e.length-1;n>=0;--n){var s=e[n];if(i.Date>s.Date){r=n;break}if(i.Date==s.Date){i.YClose=s.YClose,r=n-1;break}}if(!(null==r&&r<0)){for(n=0;n<e.length&&n<=r;++n){s=e[n];this.SourceData.Data.splice(n,0,s)}var o=new Ot;if(o.Data=this.SourceData.Data,o.Period=this.Period,o.Right=this.Right,o.DataType=this.SourceData.DataType,o.Symbol=this.Symbol,!this.IsApiPeriod&&(Ot.IsDayPeriod(o.Period,!1)||Ot.IsMinutePeriod(o.Period,!1))){var h=o.GetPeriodData(o.Period);o.Data=h}this.UpdateMainData(o,a),this.UpdateOverlayDragDayData(t),this.BindInstructionIndexData(o);for(n=0;n<this.Frame.SubFrame.length;++n)this.BindIndexData(n,o);this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.UpdateChartDrawXValue(),this.Draw(),this.ReqeustKLineInfoData({FunctionName:"RecvDragDayData",StartDate:i.Date}),this.BindAllOverlayIndexData(o)}},this.UpdateOverlayDragDayData=function(t){if(ha.IsNonEmptyArray(this.OverlayChartPaint)){var e=t.overlay;if(ha.IsNonEmptyArray(e))for(var a=0;a<this.OverlayChartPaint.length;++a){var i=this.OverlayChartPaint[a];if(i.Symbol&&(i.MainData&&i.Status==Jt.STATUS_FINISHED_ID)){for(var r=null,n=0;n<e.length;++n){var s=e[n];if(s.symbol==i.Symbol){r=s;break}}if(r){var o=Gi.JsonDataToHistoryData(r),h=i.SourceData,l=h.Data[0],u=null;for(n=o.length-1;n>=0;--n){var C=o[n];if(l.Date>C.Date){u=n;break}if(l.Date==C.Date){l.YClose=C.YClose,u=n-1;break}}if(!(null==u&&u<0)){for(n=0;n<o.length&&n<=u;++n){C=o[n];h.Data.splice(n,0,C)}var D=new Ot;if(D.Data=h.Data,D.Period=this.Period,D.Right=this.Right,D.DataType=0,D.Right>0&&Br.IsSHSZStockA(r.symbol)&&!this.IsApiPeriod){var f=D.GetRightData(D.Right,{AlgorithmType:this.RightFormula});D.Data=f}var c=this.SourceData.GetOverlayData(D.Data,this.IsApiPeriod);if(D.Data=c,Ot.IsDayPeriod(D.Period,!1)&&!this.IsApiPeriod){var d=D.GetPeriodData(D.Period);D.Data=d}i.Data=D}}}}}},this.SetCustomVerical=function(t,e){if(this.Frame&&!(t>=this.Frame.SubFrame.length)){var a=this.Frame.SubFrame[t];a.Frame&&(a.Frame.CustomVerticalInfo=e)}},this.OnSize=function(){if(this.Frame&&this.Frame.OnSize){var t=this.Frame.OnSize();this.Frame.SetSizeChage(!0),t.Changed&&(this.UpdataDataoffset(),this.UpdatePointByCursorIndex(2),this.UpdateFrameMaxMin()),this.Draw()}},this.ClickFrameButton=function(t,e){var a=this.GetEventCallback(G.ON_CLICK_FRAME_TOOLBAR);if(a&&a.Callback){var i={Info:t,PreventDefault:!1};if(a.Callback(a,i,this),i.PreventDefault)return}if(t.ID==k.CLOSE_OVERLAY_INDEX){var r=t.IndexID;r&&this.DeleteOverlayWindowsIndex(r)}else if(t.ID==k.MODIFY_OVERLAY_INDEX_PARAM){r=t.IndexID;var n=t.Frame;e.data={Chart:this,Identify:r,IsOverlay:!0},n.ModifyIndexEvent&&n.ModifyIndexEvent(e)}else if(t.ID==k.CLOSE_INDEX_WINDOW){n=t.Frame;this.RemoveIndexWindow(n.Identify)}else if(t.ID==k.CHANGE_INDEX){n=t.Frame;e.data={Chart:this,Identify:n.Identify,IsOverlay:!1},n.ChangeIndexEvent&&n.ChangeIndexEvent(e)}else if(t.ID==k.MODIFY_INDEX_PARAM){n=t.Frame;e.data={Chart:this,Identify:n.Identify,IsOverlay:!1},n.ModifyIndexEvent&&n.ModifyIndexEvent(e)}else if(t.ID==k.OVERLAY_INDEX){n=t.Frame;e.data={Chart:this,Identify:n.Identify,IsOverlay:!0},n.ChangeIndexEvent&&n.ChangeIndexEvent(e)}},this.ClickExtendChartButton=function(t,e){t.ID==k.CHIP_DEFULT?(t.Chart.ShowType=0,this.Draw()):t.ID==k.CHIP_LONG?(t.Chart.ShowType=1,this.Draw()):t.ID==k.CHIP_RECENT&&(t.Chart.ShowType=2,this.Draw())},this.RequestVolumeProfileData=function(t){var e=this,a=t.Chart;if(this.NetworkFilter){var i={Name:"KLineChartContainer::RequestVolumeProfileData",Explain:"æäº¤éåå¸å¾ä¸è½½",Request:{Period:this.Period,Right:this.Right,Start:t.Start,End:t.End,Symbol:this.Symbol,ValueAreaVol:t.ValueAreaVol},Self:this,VolProfile:a,PreventDefault:!1};if(this.NetworkFilter(i,(function(t){e.RecvVolumeProfileData(t,a)})),1==i.PreventDefault)return}},this.RecvVolumeProfileData=function(t,e){e.OnRecvVolumeProfileData(t),this.Draw()}}function Hi(t){this.newMethod=W,this.newMethod(t),delete this.newMethod,this.ClassName="MinuteChartContainer",this.WindowIndex=new Array,this.Symbol,this.Name,this.SourceData,this.IndexBindData,this.IsAutoUpdate=!0,this.AutoUpdateFrequency=3e4,this.AutoUpdateTimer,this.TradeDate=0,this.DayCount=1,this.DayData,this.LimitPrice,this.IsShowBeforeData=!1,this.BeforeOpenData=null,this.IsBeforeData=!1,this.IsShowAfterData=!1,this.AfterCloseData=null,this.IsAfterData=!1,this.ShareAfterVol=0,this.ExtendWidth={Left:120,Right:120},this.IsShowLead=!0,this.IsShowMultiDayBeforeData=!1,this.MultiDayBeforeOpenData=null,this.IsShowMultiDayAfterData=!1,this.MultiDayAfterCloseData=null,this.MultiDayExtendWidth={Left:20,Right:20},this.ChartDrawStorage=new Mi,this.ChartDrawStorageCache=null,this.MinuteApiUrl=Oi.Domain+"/API/Stock",this.HistoryMinuteApiUrl=Oi.Domain+"/API/StockMinuteData",this.ColorLineData,this.EnableSelectRect=!1,this.SelectRectDialog=null,this.CorssCursorIndex={DayIndex:-1,DataIndex:-1,Point:{X:-1,Y:-1},Type:-1},this.EnableNewIndex=!1,this.DayOffset={Offset:0,ShowDayCount:-1,DataOffset:0,DayCount:1},this.PageInfo={Enable:!1,Offset:-8888,ShowDayCount:4},this.SetCallCationDataBorder=function(t){if(t){var e={Left:t.Left?this.ExtendWidth.Left:0,Right:t.Right?this.ExtendWidth.Right:0};if(this.Frame.SetExtendWidth(e),t.MultiDay){var a=t.MultiDay,i={Left:a.Left?this.MultiDayExtendWidth.Left:0,Right:a.Right?this.MultiDayExtendWidth.Right:0};this.Frame.SetMultiDayMinuteWidth(i)}}},this.ReloadChartPaint=function(t){for(var e=0;e<this.ChartPaint.length;++e){var a=this.ChartPaint[e];a&&(a.ReloadResource&&a.ReloadResource(t),0==e?"Minute-Line"==a.Name&&(a.Color=Oi.Minute.PriceColor,a.AreaColor=Oi.Minute.AreaPriceColor):1==e?"Minute-Average-Line"==a.Name&&(a.Color=Oi.Minute.AvPriceColor):2==e&&"Minute-Vol-Bar"==a.Name&&(a.Color=Oi.Minute.VolBarColor))}},this.StopAutoUpdate=function(){this.CancelAutoUpdate(),this.IsAutoUpdate&&(this.IsAutoUpdate=!1)},this.ClickFrameButton=function(t,e){var a=this.GetEventCallback(G.ON_CLICK_FRAME_TOOLBAR);if(a&&a.Callback){var i={Info:t,PreventDefault:!1};if(a.Callback(a,i,this),i.PreventDefault)return}if(t.ID==k.CLOSE_BEFOREOPEN_ID&&this.ShowCallAuctionData({Left:!1,Right:!1,MultiDay:{Left:!1,Right:!1}}),t.ID==k.CLOSE_OVERLAY_INDEX){var r=t.IndexID;r&&this.DeleteOverlayWindowsIndex(r)}else if(t.ID==k.MODIFY_OVERLAY_INDEX_PARAM){r=t.IndexID;var n=t.Frame;e.data={Chart:this,Identify:r,IsOverlay:!0},n.ModifyIndexEvent&&n.ModifyIndexEvent(e)}else if(t.ID==k.CLOSE_INDEX_WINDOW){n=t.Frame;this.RemoveIndexWindow(n.Identify)}else if(t.ID==k.CHANGE_INDEX){n=t.Frame;e.data={Chart:this,Identify:n.Identify,IsOverlay:!1},n.ChangeIndexEvent&&n.ChangeIndexEvent(e)}else if(t.ID==k.MODIFY_INDEX_PARAM){n=t.Frame;e.data={Chart:this,Identify:n.Identify,IsOverlay:!1},n.ModifyIndexEvent&&n.ModifyIndexEvent(e)}else if(t.ID==k.OVERLAY_INDEX){n=t.Frame;e.data={Chart:this,Identify:n.Identify,IsOverlay:!0},n.ChangeIndexEvent&&n.ChangeIndexEvent(e)}},this.ChartOperator=function(t){var e=t.ID;if(e===H.OP_SCROLL_LEFT||e===H.OP_SCROLL_RIGHT){if(1==this.DayCount)return!1;if(!this.PageInfo.Enable)return!1;if(!this.DayData)return!1;var a=e===H.OP_SCROLL_LEFT,i=1;if(t.Step>0&&(i=t.Step),!this.DayOffset)return!1;if(a){var r=this.DayOffset.Offset;if(r+=i,r+this.DayOffset.ShowDayCount>this.DayOffset.DayCount&&(r=this.DayOffset.DayCount-this.DayOffset.ShowDayCount),r==this.DayOffset.Offset)return!1;this.DayOffset.Offset=r}else{r=this.DayOffset.Offset;if(r-=i,r<0&&(r=0),r==this.DayOffset.Offset)return!1;this.DayOffset.Offset=r}return this.UpdateHistoryMinuteUI(null),this.SendPageChangedEvent(),!0}if(e==H.OP_SCROLL_GOTO){if(1==this.DayCount)return!1;if(!this.PageInfo.Enable)return!1;if(!this.DayData)return!1;if(ha.IsNumber(t.ShowDayCount)&&(this.PageInfo.ShowDayCount=t.ShowDayCount,this.DayOffset.ShowDayCount=t.ShowDayCount),ha.IsNumber(t.Offset)){r=t.Offset;if(this.DayOffset.ShowDayCount>0&&r+this.DayOffset.ShowDayCount>=this.DayOffset.DayCount&&(r=this.DayOffset.DayCount-this.DayOffset.ShowDayCount),r==this.DayOffset.Offset)return!1;this.DayOffset.Offset=r}return this.UpdateHistoryMinuteUI(null),this.SendPageChangedEvent(),!0}},this.SendPageChangedEvent=function(){var t=this.GetEventCallback(G.ON_MINUTE_PAGE_CHANGED);if(t&&t.Callback){var e={DayOffset:this.DayOffset,DayData:this.DayData};t.Callback(t,e,this)}},this.OnDragMode_One=function(e,a){var i=this.MouseDrag,r=e.X,n=e.Y;if(this.RectSelectDrag&&this.RectSelectDrag.Index>=0){if(r<5)return;var s={X:a.clientX,Y:a.clientY,PointIndex:this.RectSelectDrag.Index,Name:"MoveRectSelectLine"};this.MoveRectSelectPoint(s)&&(i.LastMove.X=a.clientX,this.Draw())}else{if(r<5&&n<5)return;if(!this.EnableSelectRect)return;this.UIElement.style.cursor="default";var o=i.Click.X-t.getBoundingClientRect().left,h=i.Click.Y-t.getBoundingClientRect().top,l=a.clientX-t.getBoundingClientRect().left,u=a.clientY-t.getBoundingClientRect().top;this.ShowSelectRect(o,h,l,u),i.LastMove.X=a.clientX,i.LastMove.Y=a.clientY}},this.OnMinuteSelectRectMouseUp=function(e){var a=this.MouseDrag;a.LastMove.X=e.clientX,a.LastMove.Y=e.clientY;var i=new it,r=U();if(i.XStart=(a.Click.X-t.getBoundingClientRect().left)*r,i.YStart=(a.Click.Y-t.getBoundingClientRect().top)*r,i.XEnd=(a.LastMove.X-t.getBoundingClientRect().left)*r,i.YEnd=(a.LastMove.Y-t.getBoundingClientRect().top)*r,i.JSChartContainer=this,i.Stock={Symbol:this.Symbol,Name:this.Name},this.EnableSelectRect&&!this.BorderDrag&&this.GetSelectRectData(i)){var n=this.GetEventCallback(G.ON_SELECT_RECT),s=this.GetRectSelectPaint(),o=!0;if(n&&n.Callback){var h={X:a.LastMove.X-t.getBoundingClientRect().left,Y:a.LastMove.Y-t.getBoundingClientRect().top,SelectData:i,RectSelectPaint:s};n.Callback(n,h,this),o=!1}o&&this.SelectRectDialog?(e.data={Chart:this,X:a.LastMove.X-t.getBoundingClientRect().left,Y:a.LastMove.Y-t.getBoundingClientRect().top,SelectData:i,RectSelectPaint:s},this.SelectRectDialog.DoModal(e)):(this.HideSelectRect(),this.UpdateSelectRect(i.Start,i.End))}else this.TryClickPaintEvent(G.ON_CLICKUP_CHART_PAINT,this.ClickDownPoint,e),this.ClickEvent(e)},this.OnDragSelectRectMouseUp=function(t){var e=this.GetRectSelectPaint();if(e){var a=e.GetSelectRectData();if(a){var i=U(),r=this.ChartCorssCursor,n=r.LastPoint.X/i,s=r.LastPoint.Y/i,o=!0,h=this.GetEventCallback(G.ON_DRAG_SELECT_RECT_MOUSEUP);if(h){var l={X:n,Y:s,SelectData:a,RectSelectPaint:e,IsShowDialog:!1};h.Callback(h,l,this),o=l.IsShowDialog}o&&this.SelectRectDialog&&(t.data={Chart:this,X:n,Y:s,SelectData:a,RectSelectPaint:e},this.SelectRectDialog.DoModal(t))}}},this.UpdateSelectRect=function(t,e){if(this.SourceData&&this.SourceData.Data){var a=this.GetRectSelectPaint();if(a){var i=this.SourceData;if(i&&ha.IsNonEmptyArray(i.Data)){var r=i.Data.length,n=i.Data[t];e>=r&&(e=r-1);var s=i.Data[e];w.Chart.Log("[MinuteChartContainer::UpdateSelectRect]",n,s),a.SetPoint(n,{Index:0}),a.SetPoint(s,{Index:1}),this.Draw()}}}},this.MoveRectSelectPoint=function(e){var a=this.GetRectSelectPaint();if(!a)return!1;if(!this.SourceData||!this.SourceData.Data)return!1;var i=this.SourceData;if(!this.Frame.SubFrame[0])return!1;var r=this.Frame.SubFrame[0].Frame,n=U(),s=(e.X-t.getBoundingClientRect().left)*n,o=r.GetXData(s);o=parseInt(o.toFixed(0));var h=o+i.DataOffset;h>=i.Data.length&&(h=i.Data.length-1);var l=i.Data[h];if(w.Chart.Log("[MinuteChartContainer::MoveRectSelectPoint] point, item",e.PointIndex,l),!a.SetPoint(l,{Index:e.PointIndex}))return!1;var u=this.GetEventCallback(G.ON_DRAG_SELECT_RECT);if(u){var C=a.GetSelectRectData(),D={X:e.X,Y:e.Y,SelectData:C,RectSelectPaint:a};u.Callback(u,D,this)}return!0},this.GetLastCursorIndex=function(t){if(1==t.DataType)for(var e=t.Data.length-1;e>=0;--e){var a=t.Data[e];if(a&&a.DayItem&&a.DayItem.Data)return t.IndexData.DayIndex=0,t.IndexData.DataIndex=a.DayItem.Data.length-1,void(t.IndexData.Type=a.Type)}else if(2==t.DataType)for(e=t.Data.length-1;e>=0;--e)for(var i=t.Data[e],r=i.length-1;r>=0;--r){a=i[r];if(a&&a.DayItem&&a.DayItem.Data)return t.IndexData.DayIndex=e,t.IndexData.DataIndex=a.DayItem.Data.length-1,void(t.IndexData.Type=a.Type)}},this.GetFirstCursorIndex=function(t){if(1==t.DataType)for(var e=0;e<t.Data.length;++e){var a=t.Data[e];if(a&&a.DayItem&&a.DayItem.Data)return t.IndexData.DayIndex=0,t.IndexData.DataIndex=0,void(t.IndexData.Type=a.Type)}else if(2==t.DataType)for(e=0;e<t.Data.length;++e)for(var i=t.Data[e],r=0;r<i.length;++r){a=i[r];if(a&&a.DayItem&&a.DayItem.Data)return t.IndexData.DayIndex=e,t.IndexData.DataIndex=0,void(t.IndexData.Type=a.Type)}},this.MoveCorssCursorIndex=function(t){if(!this.EnableNewIndex)return!1;if(!this.Frame.SubFrame[0]||!this.Frame.SubFrame[0].Frame)return!1;var e=this.Frame.SubFrame[0].Frame;if(1==this.CorssCursorIndex.Type||2==this.CorssCursorIndex.Type||3==this.CorssCursorIndex.Type||-1==this.CorssCursorIndex.Type){var a=[],i=null;this.BeforeOpenData&&this.IsShowBeforeData&&(i=this.BeforeOpenData),a.push({DayItem:i,Type:2});i=null;this.SourceData&&(i=this.SourceData),a.push({DayItem:i,Type:1});i=null;this.AfterCloseData&&this.IsShowAfterData&&(i=this.AfterCloseData),a.push({DayItem:i,Type:3});var r={DataType:1,Data:a,IndexData:this.CorssCursorIndex,Point:{X:null,Y:null}},n=1;if(t.IsMoveLeft){if(this.CorssCursorIndex.DayIndex<0&&this.CorssCursorIndex.DataIndex<0&&(this.GetLastCursorIndex(r),n=0),e.MoveXIndexLeft(n,r)){this.LastPoint.X=r.Point.X,this.LastPoint.Y=r.Point.Y,1==this.CorssCursorIndex.Type&&(this.CursorIndex=this.CorssCursorIndex.CursorIndex);t={ParentFunction:"MoveCorssCursorIndex",Point:{X:r.Point.X,Y:r.Point.Y},IsPhone:!1,ClientPos:this.CorssCursorIndex.Type};this.DrawDynamicInfo(t)}}else if(this.CorssCursorIndex.DayIndex<0&&this.CorssCursorIndex.DataIndex<0&&(this.GetFirstCursorIndex(r),n=0),e.MoveXIndexRight(n,r)){this.LastPoint.X=r.Point.X,this.LastPoint.Y=r.Point.Y,1==this.CorssCursorIndex.Type&&(this.CursorIndex=this.CorssCursorIndex.CursorIndex);t={ParentFunction:"MoveCorssCursorIndex",Point:{X:r.Point.X,Y:r.Point.Y},IsPhone:!1,ClientPos:this.CorssCursorIndex.Type};this.DrawDynamicInfo(t)}}else if(10==this.CorssCursorIndex.Type||20==this.CorssCursorIndex.Type||30==this.CorssCursorIndex.Type||-2==this.CorssCursorIndex.Type){a=[];var s=0,o=this.DayData.length;this.DayOffset&&(ha.IsNumber(this.DayOffset.Offset)&&(s=this.DayOffset.Offset),ha.IsNumber(this.DayOffset.ShowDayCount)&&(o=this.DayOffset.ShowDayCount));for(var h=s,l=0;h<this.DayData.length&&l<o;++h,++l){var u=[];i=null;this.MultiDayBeforeOpenData&&this.IsShowMultiDayBeforeData&&(i=this.MultiDayBeforeOpenData[h]),u.push({DayItem:i,Type:20});i=null;this.DayData&&(i=this.DayData[this.DayData.length-1-h]),u.push({DayItem:i,Type:10});i=null;this.MultiDayAfterCloseData&&this.IsShowMultiDayAfterData&&(i=this.MultiDayAfterCloseData[h]),u.push({DayItem:i,Type:30}),a.push(u)}r={DataType:2,Data:a,IndexData:this.CorssCursorIndex,Point:{X:null,Y:null}},n=1;if(t.IsMoveLeft){if(this.CorssCursorIndex.DayIndex<0&&this.CorssCursorIndex.DataIndex<0&&(this.GetLastCursorIndex(r),n=0),e.MoveXIndexLeft(n,r)){this.LastPoint.X=r.Point.X,this.LastPoint.Y=r.Point.Y,10==this.CorssCursorIndex.Type&&(this.CursorIndex=this.CorssCursorIndex.CursorIndex);t={ParentFunction:"MoveCorssCursorIndex",Point:{X:r.Point.X,Y:r.Point.Y},IsPhone:!1,ClientPos:null};10==this.CorssCursorIndex.Type?t.ClientPos=1:20==this.CorssCursorIndex.Type?t.ClientPos=this.CorssCursorIndex.DayIndex+200:30==this.CorssCursorIndex.Type&&(t.ClientPos=this.CorssCursorIndex.DayIndex+300),this.DrawDynamicInfo(t)}}else if(this.CorssCursorIndex.DayIndex<0&&this.CorssCursorIndex.DataIndex<0&&(this.GetFirstCursorIndex(r),n=0),e.MoveXIndexRight(n,r)){this.LastPoint.X=r.Point.X,this.LastPoint.Y=r.Point.Y,10==this.CorssCursorIndex.Type&&(this.CursorIndex=this.CorssCursorIndex.CursorIndex);t={ParentFunction:"MoveCorssCursorIndex",Point:{X:r.Point.X,Y:r.Point.Y},IsPhone:!1,ClientPos:null};10==this.CorssCursorIndex.Type?t.ClientPos=1:20==this.CorssCursorIndex.Type?t.ClientPos=this.CorssCursorIndex.DayIndex+200:30==this.CorssCursorIndex.Type&&(t.ClientPos=this.CorssCursorIndex.DayIndex+300),this.DrawDynamicInfo(t)}}},this.SetCorssCursorIndex=function(t){if(this.EnableNewIndex&&(w.Chart.Log("[MinuteChartContainer::SetCorssCursorIndex] option ",t),"OnMouseMove"==t.ParentFunction)){this.CorssCursorIndex.Point.X=t.Point.X,this.CorssCursorIndex.Point.Y=t.Point.Y;var e=this.PtInClient_V2(t.Point.X,t.Point.Y);if(w.Chart.Log("[MinuteChartContainer::SetCorssCursorIndex] clientPos ",e),e<=0)return void(this.CorssCursorIndex={DayIndex:-1,DataIndex:-1,Point:{X:-1,Y:-1},Type:e});if(!this.Frame.SubFrame[0]||!this.Frame.SubFrame[0].Frame)return void(this.CorssCursorIndex={DayIndex:-1,DataIndex:-1,Point:{X:-1,Y:-1},Type:-1});var a=this.Frame.SubFrame[0].Frame;if(1==e||2==e||3==e){if(this.CorssCursorIndex.DayIndex=0,this.CorssCursorIndex.Type=e,2==e)a.GetLeftExtendXValidData(t.Point.X,{Data:this.BeforeOpenData,IndexData:this.CorssCursorIndex});else if(3==e)a.GetRightExtendXValidData(t.Point.X,{Data:this.AfterCloseData,IndexData:this.CorssCursorIndex});else if(1==e){var i=a.GetXData(t.Point.X);this.CorssCursorIndex.DataIndex=parseInt(i.toFixed(0))}}else if(e>=100&&e<=199){this.CorssCursorIndex.DayIndex=e-100,this.CorssCursorIndex.Type=10;i=a.GetXData(t.Point.X);var r=parseInt(i.toFixed(0));this.CorssCursorIndex.DataIndex=r%a.MinuteCount}else if(e>=200&&e<=299){this.CorssCursorIndex.DayIndex=e-200,this.CorssCursorIndex.Type=20;var n=this.MultiDayBeforeOpenData;if(this.DayOffset){var s=0,o=this.MultiDayBeforeOpenData.length;ha.IsNumber(this.DayOffset.Offset)&&(s=this.DayOffset.Offset),ha.IsNumber(this.DayOffset.ShowDayCount)&&(o=this.DayOffset.ShowDayCount),n=this.MultiDayBeforeOpenData.slice(s,s+o)}a.GetLeftExtendXValidData(t.Point.X,{Data:n,IndexData:this.CorssCursorIndex})}else if(e>=300&&e<=399){this.CorssCursorIndex.DayIndex=e-300,this.CorssCursorIndex.Type=30;n=this.MultiDayAfterOpenData;if(this.DayOffset&&this.MultiDayAfterOpenData){s=0,o=this.MultiDayBeforeOpenData.length;ha.IsNumber(this.DayOffset.Offset)&&(s=this.DayOffset.Offset),ha.IsNumber(this.DayOffset.ShowDayCount)&&(o=this.DayOffset.ShowDayCount),n=this.MultiDayAfterOpenData.slice(s,s+o)}a.GetRightExtendXValidData(t.Point.X,{Data:n,IndexData:this.CorssCursorIndex})}this.LastPoint.X=this.CorssCursorIndex.Point.X,t.Point.X=this.CorssCursorIndex.Point.X}},this.PtInClient_V2=function(t,e){if(this.Canvas.beginPath(),!0===this.Frame.IsHScreen){var a=this.Frame.ChartBorder.GetHScreenBorder();this.Canvas.rect(a.Left,a.TopEx,a.Right-a.Left,a.BottomEx-a.TopEx)}else{a=this.Frame.ChartBorder.GetBorder();if(a.DayBorder){for(var i=0;i<a.DayBorder.length;++i){var r=a.DayBorder[i];if(this.Canvas.beginPath(),this.Canvas.rect(r.LeftEx,a.TopEx,r.RightEx-r.LeftEx,a.BottomEx-a.TopEx),this.Canvas.isPointInPath(t,e))return 100+i;if(this.Canvas.beginPath(),this.Canvas.rect(r.Left,a.TopEx,r.LeftEx-r.Left,a.BottomEx-a.TopEx),this.Canvas.isPointInPath(t,e))return 200+i;if(this.Canvas.beginPath(),this.Canvas.rect(r.RightEx,a.TopEx,r.Right-r.RightEx,a.BottomEx-a.TopEx),this.Canvas.isPointInPath(t,e))return 300+i}return-2}this.Canvas.rect(a.LeftEx,a.Top,a.RightEx-a.LeftEx,a.Bottom-a.Top)}return this.Canvas.isPointInPath(t,e)?1:this.Frame.ChartBorder.LeftExtendWidth>10&&(this.Canvas.beginPath(),!0===this.Frame.IsHScreen?this.Canvas.rect(a.Left,a.Top,a.Right-a.Left,a.TopEx-a.Top):this.Canvas.rect(a.Left,a.Top,a.LeftEx-a.Left,a.Bottom-a.Top),this.Canvas.isPointInPath(t,e))?2:this.Frame.ChartBorder.RightExtendWidth>10&&(this.Canvas.beginPath(),!0===this.Frame.IsHScreen?this.Canvas.rect(a.Left,a.BottomEx,a.Right-a.Left,a.Bottom-a.BottomEx):this.Canvas.rect(a.RightEx,a.Top,a.Right-a.RightEx,a.Bottom-a.Top),this.Canvas.isPointInPath(t,e))?3:-1},this.OnTouchStart=function(e){if(0!=this.DragMode&&(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash)&&(this.IsOnTouch=!0,this.TouchDrawCount=0,this.PhonePinch=null,this.StopDragTimer(),0==this.EnableScrollUpDown&&e.preventDefault(),this.IsPhoneDragging(e))){var a={Click:{},LastMove:{}},i=this.GetToucheData(e,this.IsForceLandscape);a.Click.X=i[0].clientX,a.Click.Y=i[0].clientY,a.LastMove.X=i[0].clientX,a.LastMove.Y=i[0].clientY;var r=this,n=function(){if(!0===r.ChartCorssCursor.IsShow){var i=U(),n=a.Click.X-t.getBoundingClientRect().left*i,s=a.Click.Y-t.getBoundingClientRect().top*i;r.OnMouseMove(n,s,e)}};if(this.ChartDrawOption.IsLockScreen){if(this.MouseDrag=a,this.SelectChartDrawPicture&&(this.SelectChartDrawPicture.IsSelected=!1),this.SelectChartDrawPicture=null,this.CurrentChartDrawPicture){var s=this.CurrentChartDrawPicture;return 2==s.Status?this.SetChartDrawPictureThirdPoint(a.Click.X,a.Click.Y,!0):(this.SetChartDrawPictureFirstPoint(a.Click.X,a.Click.Y,!0),this.FinishChartDrawPicturePoint()&&this.DrawDynamicInfo({Corss:!1,Tooltip:!1})),void(e.cancelable&&e.preventDefault())}var o={};U();if(o.X=i[0].clientX-t.getBoundingClientRect().left,o.Y=i[0].clientY-t.getBoundingClientRect().top,this.GetChartDrawPictureByPoint(o)){o.ChartDrawPicture.Status=20,o.ChartDrawPicture.ValueToPoint(),o.ChartDrawPicture.MovePointIndex=o.PointIndex,o.ChartDrawPicture.IsSelected=!0,this.CurrentChartDrawPicture=o.ChartDrawPicture,this.SelectChartDrawPicture=o.ChartDrawPicture;var h=this.GetEventCallback(G.ON_CLICK_DRAWPICTURE);if(h&&h.Callback){var l={DrawPicture:o.ChartDrawPicture};h.Callback(h,l,this)}return void(e.cancelable&&e.preventDefault())}}else 1==this.EnableScrollUpDown&&(this.DragTimer=setTimeout((function(){if(a.Click.X==a.LastMove.X&&a.Click.Y==a.LastMove.Y){r.MouseDrag;r.MouseDrag=null,n(),r.PreventTouchEvent(e)}}),800)),this.MouseDrag=a,this.PhoneTouchInfo={Start:{X:i[0].clientX,Y:i[0].clientY},End:{X:i[0].clientX,Y:i[0].clientY}},this.SelectChartDrawPicture=null,0==this.EnableScrollUpDown&&n();this.EnableZoomIndexWindow&&(this.PhoneDBClick.AddTouchStart(i[0].clientX,i[0].clientY,Date.now()),w.Chart.Log("[MinuteChartContainer::OnTouchStart] PhoneDBClick ",this.PhoneDBClick)),this.TouchEvent({EventID:G.ON_PHONE_TOUCH,FunctionName:"OnTouchStart"},e)}},this.OnTouchMove=function(e){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var a=this.GetToucheData(e,this.IsForceLandscape);if(this.IsPhoneDragging(e)){var i=this.MouseDrag;if(null==i){var r=U(),n=a[0].clientX-t.getBoundingClientRect().left*r,s=a[0].clientY-t.getBoundingClientRect().top*r;this.OnMouseMove(n,s,e)}else{var o=this.GetMoveAngle(i.LastMove,{X:a[0].clientX,Y:a[0].clientY}),h=Math.abs(i.LastMove.X-a[0].clientX),l=Math.abs(i.LastMove.Y-a[0].clientY);if(h=parseInt(h),this.CurrentChartDrawPicture){var u=this.CurrentChartDrawPicture;if(1==u.Status||2==u.Status){if(h<5&&l<5)return;this.SetChartDrawPictureSecondPoint(a[0].clientX,a[0].clientY,!0)&&this.DrawDynamicInfo()}else if(3==u.Status)this.SetChartDrawPictureThirdPoint(a[0].clientX,a[0].clientY,!0)&&this.DrawDynamicInfo();else if(20==u.Status){if(h<5&&l<5)return;this.MoveChartDrawPicture(a[0].clientX-i.LastMove.X,a[0].clientY-i.LastMove.Y,!0)&&this.DrawDynamicInfo()}i.LastMove.X=a[0].clientX,i.LastMove.Y=a[0].clientY}else{if((l>0&&h<=3||o<=this.TouchMoveMinAngle)&&1==this.EnableScrollUpDown)return void this.StopDragTimer();this.PreventTouchEvent(e),this.MouseDrag=null;r=U(),n=a[0].clientX-t.getBoundingClientRect().left*r,s=a[0].clientY-t.getBoundingClientRect().top*r;this.OnMouseMove(n,s,e)}}this.PhoneTouchInfo&&(this.PhoneTouchInfo.End.X=a[0].clientX,this.PhoneTouchInfo.End.Y=a[0].clientY)}0==this.EnableScrollUpDown?e.preventDefault():null==i?this.PreventTouchEvent(e):this.StopDragTimer()}},this.OnTouchEnd=function(t){if(w.Chart.Log("[MinuteChartContainer::OnTouchEnd]",t),!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){if(this.CurrentChartDrawPicture){var e=this.CurrentChartDrawPicture;2==e.Status||1==e.Status||3==e.Status?(e.PointStatus=e.Status,this.FinishChartDrawPicturePoint()?this.DrawDynamicInfo():!1):20==e.Status&&this.FinishMoveChartDrawPicture()&&this.DrawDynamicInfo()}if(this.EnableZoomIndexWindow){var a=Date.now();this.PhoneDBClick.AddTouchEnd(a),this.PhoneDBClick.IsVaildDBClick()&&(this.OnTouchDBClick(this.PhoneDBClick.Start),this.PhoneDBClick.Clear())}this.IsOnTouch=!1,this.StopDragTimer(),this.TouchEvent({EventID:G.ON_PHONE_TOUCH,FunctionName:"OnTouchEnd"},t),this.OnTouchFinished(),this.TouchDrawCount=0}},this.OnKeyDown=function(t){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var e=t.keyCode?t.keyCode:t.which;switch(e){case 37:if(this.EnableNewIndex)this.MoveCorssCursorIndex({IsMoveLeft:!0});else if(this.CursorIndex=parseInt(this.CursorIndex),this.CursorIndex<=.99999){if(!this.DataMoveLeft())break;this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw()}else--this.CursorIndex,this.UpdatePointByCursorIndex(),this.DrawDynamicInfo();break;case 39:if(this.EnableNewIndex)this.MoveCorssCursorIndex({IsMoveLeft:!1});else{var a=0;if(a=this.Frame.XPointCount?this.Frame.XPointCount:this.Frame.SubFrame[0].Frame.XPointCount,this.CursorIndex=parseInt(this.CursorIndex),this.CursorIndex+1>=a){if(!this.DataMoveRight())break;this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw()}else{var i=null;if(i=this.Frame.Data?this.Frame.Data:this.Frame.SubFrame[0].Frame.Data,!i)break;if(this.CursorIndex+i.DataOffset+1>=i.Data.length)break;++this.CursorIndex,this.UpdatePointByCursorIndex(),this.DrawDynamicInfo()}}break;case 46:if(this.SelectChartDrawPicture){var r=this.SelectChartDrawPicture;w.Chart.Log(r,"drawPicturedrawPicturedrawPicture"),this.SelectChartDrawPicture=null,this.ClearChartDrawPicture(r)}else if(this.SelectedChart&&this.SelectedChart.Selected.Identify){var n=this.GetSelectedChartInfo(this.SelectedChart.Selected);n&&(n.Type==ra.OVERLAY_INDEX?this.DeleteOverlayWindowsIndex(n.IndexID):n.Type==ra.OVERLAY_MINUTE&&this.DeleteOverlaySymbol(n.Symbol))}break;case 32:this.OnMarkRectSelect(t);break;case 33:if(this.PageInfo.Enable){var s={ID:H.OP_SCROLL_LEFT,Step:this.PageInfo.ShowDayCount};this.ChartOperator(s)}break;case 34:if(this.PageInfo.Enable){s={ID:H.OP_SCROLL_RIGHT,Step:this.PageInfo.ShowDayCount};this.ChartOperator(s)}break;default:return}t.preventDefault?t.preventDefault():t.returnValue=!1}},this.OnMarkRectSelect=function(t){var e=this.ChartCorssCursor;if(e&&0!=e.Status&&ha.IsNumber(e.CursorIndex)&&this.SourceData&&this.SourceData.Data){var a=this.GetRectSelectPaint();if(a){var i=e.CursorIndex;w.Chart.Log("[MinuteChartContainer::OnMarkRectSelect] dataIndex",i);var r=this.SourceData;i=parseInt(i.toFixed(0));var n=i+r.DataOffset;n>=r.Data.length&&(n=r.Data.length-1);var s=r.Data[n];if(w.Chart.Log("[MinuteChartContainer::OnMarkRectSelect] item",s),this.SetRectSelectData(s)){var o=a.GetPointCount(),h=U();if(1==o){var l=this.GetEventCallback(G.ON_KEYDOWN_SELECT_RECT_FIRST);if(l&&l.Callback){var u={X:e.LastPoint.X/h,Y:e.LastPoint.Y/h,Item:s,Index:n,RectSelectPaint:a};l.Callback(l,u,this)}}else if(2==o){var C=a.GetSelectRectData();l=this.GetEventCallback(G.ON_KEYDOWN_SELECT_RECT);if(l&&l.Callback){u={X:e.LastPoint.X/h,Y:e.LastPoint.Y/h,SelectData:C,RectSelectPaint:a};l.Callback(l,u,this)}this.SelectRectDialog&&(t.data={Chart:this,X:e.LastPoint.X/h,Y:e.LastPoint.Y/h,SelectData:C,RectSelectPaint:a},this.SelectRectDialog.DoModal(t))}this.Draw()}}}},this.OnRightMenu=function(t,e,a){if(this.RightMenu){var i=this.Frame.PtInFrame(t,e);a.data={Chart:this,FrameID:i},this.RightMenu.DoModal(a)}var r=this.GetEventCallback(G.ON_CONTEXT_MENU);if(r){i=this.Frame.PtInFrame(t,e);var n={X:t,Y:e,Event:a,FrameID:i};r.Callback(r,n,this)}},this.OnWheel=function(t){w.Chart.Log("[MinuteChartContainer::OnWheel]",t)},this.OnDoubleClick=function(t,e,a){var i;w.Chart.Log("[MinuteChartContainer::OnDoubleClick]",a),null!=this.ClickChartTimer&&(clearTimeout(this.ClickChartTimer),this.ClickChartTimer=null),this.SelectedChart.EnableSelected&&(i=this.PtInChart(t,e));var r={SelectedChart:i};if(this.DBClickEvent(r,a),!i&&this.EnableZoomIndexWindow){var n=this.Frame.PtInFrame(t,e);w.Chart.Log("[MinuteChartContainer::OnDoubleClick] frameId",n),n>=this.Frame.ZoomStartWindowIndex&&this.ZoomIndexWindow(n,{X:t,Y:e})&&(this.Frame.SetSizeChage(!0),this.Draw())}},this.GetDataItem=function(t){if(!t)return null;if(!ha.IsNumber(t.Index))return null;if(!this.SourceData||!this.SourceData.Data)return null;var e=this.SourceData,a=t.ClientPos;if(2==a||3==a||a>=200&&a<=299||a>=300&&a<=399){if(!this.ChartCorssCursor||!this.ChartCorssCursor.CallAcutionXOperator)return null;var i=!0===this.Frame.IsHScreen,r=this.ChartCorssCursor.CallAcutionXOperator;if(r.Value=i?t.Point.Y:t.Point.X,r.Point={X:t.Point.X,Y:t.Point.Y},r.ClientPos=a,2==a){if(!this.BeforeOpenData)return null}else if(3==a){if(!this.AfterCloseData)return null}else if(a>=200&&a<=299){if(!this.MultiDayBeforeOpenData||!ha.IsNonEmptyArray(this.MultiDayBeforeOpenData))return}else if(a>=300&&tclientPos<=399&&(!this.MultiDayAfterCloseData||!ha.IsNonEmptyArray(this.MultiDayAfterCloseData)))return;if(r.Operator()){var n=r.Item;return{Type:a,Item:n,Index:r.DataIndex}}return null}var s=parseInt(t.Index.toFixed(0)),o=s+e.DataOffset;if(o>=e.Data.length)return null;n=e.Data[o];return{Type:a,Item:n,Index:o}},this.UpdatePointByCursorIndex=function(){this.LastPoint.X=this.Frame.GetXFromIndex(this.CursorIndex);var t=this.CursorIndex;t=parseInt(t.toFixed(0));var e=this.Frame.SourceData;if(!(e.DataOffset+t>=e.Data.length)){var a=e.Data[e.DataOffset+t],i=null;i=a.Before?a.Before.Close:a.Close,this.LastPoint.Y=this.Frame.GetYFromData(i)}},this.Create=function(t,e){var a=this;for(var i in this.UIElement.JSChartContainer=this,this.ChartCorssCursor=new va,this.ChartCorssCursor.PtInClient=function(t,e){return a.PtInClient(t,e)},this.ChartCorssCursor.Canvas=this.Canvas,this.ChartCorssCursor.StringFormatX=new Fa,this.ChartCorssCursor.StringFormatY=new ga,this.ChartCorssCursor.StringFormatY.LanguageID=this.LanguageID,this.ChartCorssCursor.StringFormatY.ShareAfterVol=this.ShareAfterVol,this.ChartCorssCursor.CallAcutionXOperator=new ma,this.ChartSplashPaint=new Ia,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.HQChart=this,this.Frame=new It,this.Frame.ChartBorder=new nt,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=25,this.Frame.ChartBorder.TitleHeight=0,this.Frame.ChartBorder.Left=50,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.Frame.GetExtendChartRightWidth=function(){return a.GetExtendChartRightWidth()},this.Frame.ZoomStartWindowIndex=2,this.ChartCorssCursor.Frame=this.Frame,this.ChartSplashPaint.Frame=this.Frame,this.CreateChildWindow(t),this.CreateMainKLine(),this.CreateExtendChart("RectSelectPaint",e?e.SelectRect:null),this.EnableIndexChartDrag&&this.CreateExtendChart("DragMovePaint"),this.Frame.SubFrame){var r=new Ya;r.Frame=this.Frame.SubFrame[i].Frame,r.Canvas=this.Canvas,r.LanguageID=this.LanguageID,r.GetEventCallback=function(t){return a.GetEventCallback(t)},r.SelectedChart=this.SelectedChart,this.TitlePaint.push(r)}this.ChartCorssCursor.StringFormatX.Frame=this.Frame.SubFrame[0].Frame,this.ChartCorssCursor.StringFormatY.Frame=this.Frame,this.ChartCorssCursor.CallAcutionXOperator&&(this.ChartCorssCursor.CallAcutionXOperator.Frame=this.Frame.SubFrame[0].Frame);var n=!0,s=!0;if(e&&e.Listener){var o=e.Listener;!1===o.KeyDown&&(n=!1,w.Chart.Log("[MinuteChartContainer::Create] not register keydown event.")),!1===o.Wheel&&(s=!1,w.Chart.Log("[MinuteChartContainer::Create] not register wheel event."))}n&&this.UIElement.addEventListener("keydown",(function(t){a.OnKeyDown(t)}),!0),s&&this.UIElement.addEventListener("wheel",(function(t){a.OnWheel(t)}),!0)},this.CreateChildWindow=function(t){for(var e=this,a=0;a<t;++a){var i=new nt;i.UIElement=this.UIElement;var r=new lt;r.Canvas=this.Canvas,r.ChartBorder=i,r.Identify=a,r.GlobalOption=this.GlobalOption,a<2&&(r.ChartBorder.TitleHeight=0),r.XPointCount=243,a>=2&&(this.ModifyIndexDialog&&(r.ModifyIndexEvent=this.ModifyIndexDialog.DoModal),this.ChangeIndexDialog&&(r.ChangeIndexEvent=this.ChangeIndexDialog.DoModal));var n=[9,8,7,6,5,4,3,2,1];for(var s in r.HorizontalMax=n[0],r.HorizontalMin=n[n.length-1],0==a?(r.YSplitOperator=new Da,r.YSplitOperator.FrameSplitData=this.FrameSplitData.get("price"),r.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},r.YSplitOperator.DayOffset=this.DayOffset,r.YSplitOperator.GlobalOption=this.GlobalOption):(r.YSplitOperator=new ua,r.YSplitOperator.LanguageID=this.LanguageID,r.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),r.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},1==a&&(r.YSplitOperator.ShareAfterVol=this.ShareAfterVol)),r.YSplitOperator.Frame=r,r.YSplitOperator.ChartBorder=i,r.XSplitOperator=new fa,r.XSplitOperator.Frame=r,r.XSplitOperator.ChartBorder=i,r.XSplitOperator.DayOffset=this.DayOffset,r.XSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},a!=t-1&&(r.XSplitOperator.ShowText=!1),r.XSplitOperator.Operator(),n)r.HorizontalInfo[s]=new rt,r.HorizontalInfo[s].Value=n[s],0==a&&s==r.HorizontalMin||(r.HorizontalInfo[s].Message[1]=n[s].toString(),r.HorizontalInfo[s].Font="14px å¾®è½¯éé»");var o=new vt;o.Frame=r,o.Height=0==a?20:10,this.Frame.SubFrame[a]=o}},this.CreateSubFrameItem=function(t){var e=this,a=new nt;a.UIElement=this.UIElement;var i=new lt;i.Canvas=this.Canvas,i.ChartBorder=a,i.Identify=t,i.XPointCount=243,i.GlobalOption=this.GlobalOption,t>=2&&(this.ModifyIndexDialog&&(i.ModifyIndexEvent=this.ModifyIndexDialog.DoModal),this.ChangeIndexDialog&&(i.ChangeIndexEvent=this.ChangeIndexDialog.DoModal));var r=[9,8,7,6,5,4,3,2,1];i.HorizontalMax=r[0],i.HorizontalMin=r[r.length-1],i.YSplitOperator=new ua,i.YSplitOperator.LanguageID=this.LanguageID,i.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),i.YSplitOperator.Frame=i,i.YSplitOperator.ChartBorder=a,i.XSplitOperator=new fa,i.XSplitOperator.Frame=i,i.XSplitOperator.ChartBorder=a,i.XSplitOperator.ShowText=!1,i.XSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},i.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},i.XSplitOperator.Symbol=this.Symbol,this.DayCount>1&&(i.XSplitOperator.DayCount=this.DayData.length,i.XSplitOperator.DayData=this.DayData,i.DayCount=this.DayData.length);var n=this.Frame.SubFrame[0].Frame.XPointCount;for(var s in i.XPointCount=n,i.Data=this.ChartPaint[0].Data,r)i.HorizontalInfo[s]=new rt,i.HorizontalInfo[s].Value=r[s],i.HorizontalInfo[s].Message[1]=r[s].toString(),i.HorizontalInfo[s].Font="14px å¾®è½¯éé»";var o=new vt;return o.Frame=i,o.Height=10,o},this.UpdateXShowText=function(){for(var t=!0,e=this.Frame.SubFrame.length-1;e>=0;--e){var a=this.Frame.SubFrame[e].Frame,i=this.Frame.SubFrame[e];t?(a.XSplitOperator.ShowText=!0,i.Height>0&&(t=!1)):a.XSplitOperator.ShowText=!1}},this.DeleteIndexPaint=function(t,e){var a=new Array;for(var i in this.ChartPaint){var r=this.ChartPaint[i];0==i||r.ChartFrame!=this.Frame.SubFrame[t].Frame?a.push(r):!0===e&&r&&r.OnDestroy&&r.OnDestroy()}var n=this.Frame.SubFrame[t].Frame;n.YSpecificMaxMin=null,n.IsLocked=!1,n.YSplitOperator.SplitType=n.YSplitOperator.DefaultSplitType,this.ChartPaint=a;var s=t+1;this.TitlePaint[s].Data=[],this.TitlePaint[s].Title=null},this.CreateStockInfo=function(){this.ExtendChartPaint[0]=new Ze,this.ExtendChartPaint[0].Canvas=this.Canvas,this.ExtendChartPaint[0].ChartBorder=this.Frame.ChartBorder,this.ExtendChartPaint[0].ChartFrame=this.Frame,this.Frame.ChartBorder.Right=300},this.CreateMainKLine=function(){var t=this,e=new ve;e.Canvas=this.Canvas,e.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,e.ChartFrame=this.Frame.SubFrame[0].Frame,e.Name="Minute-Line",e.Identify="Minute-Line",e.Color=Oi.Minute.PriceColor,e.AreaColor=Oi.Minute.AreaPriceColor,e.GetEventCallback=function(e){return t.GetEventCallback(e)},this.ChartPaint[0]=e;var a=new ve;a.Canvas=this.Canvas,a.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,a.ChartFrame=this.Frame.SubFrame[0].Frame,a.Name="Minute-Average-Line",a.Identify="Minute-Average-Line",a.Color=Oi.Minute.AvPriceColor,a.IsDrawArea=!1,this.ChartPaint[1]=a;var i=new Zt;i.Color=Oi.Minute.VolBarColor,i.Canvas=this.Canvas,i.ChartBorder=this.Frame.SubFrame[1].Frame.ChartBorder,i.ChartFrame=this.Frame.SubFrame[1].Frame,i.Name="Minute-Vol-Bar",i.Identify="Minute-Vol-Bar",i.ShareAfterVol=this.ShareAfterVol,this.ChartPaint[2]=i,this.TitlePaint[0]=new Va,this.TitlePaint[0].Frame=this.Frame.SubFrame[0].Frame,this.TitlePaint[0].Canvas=this.Canvas,this.TitlePaint[0].OverlayChartPaint=this.OverlayChartPaint,this.TitlePaint[0].LanguageID=this.LanguageID,this.TitlePaint[0].CallAcutionXOperator=new ma,this.TitlePaint[0].CallAcutionXOperator.Frame=this.Frame.SubFrame[0].Frame},this.ChangeScriptIndex=function(t,e,a){this.DeleteIndexPaint(t,!0),this.WindowIndex[t]=new wn(e.Name,e.Script,e.Args,e);var i=this.SourceData;this.BindIndexData(t,i),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.ChangeAPIIndex=function(t,e){this.DeleteIndexPaint(t,!0);var a=e.API;this.WindowIndex[t]=new Rn(a.Name,a.Script,a.Args,e),e&&e.Window&&this.SetFrameToolbar(t,e.Window),this.Frame.ClearUpDonwFrameYData({Index:t});var i=this.ChartPaint[0].Data;this.BindIndexData(t,i),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()},this.ChangeIndex=function(t,e,a){if(!(this.Frame.SubFrame.length<3)){if(a&&a.API)return this.ChangeAPIIndex(t,a);var i=new B,r=i.Get(e);if(r){t<2&&(t=2),t>=this.Frame.SubFrame.length&&(t=2);var n={Name:r.Name,Script:r.Script,Args:r.Args,ID:e,KLineType:r.KLineType,YSpecificMaxMin:r.YSpecificMaxMin,YSplitScale:r.YSplitScale,FloatPrecision:r.FloatPrecision,Condition:r.Condition,StringFormat:r.StringFormat,OutName:r.OutName};return a&&(a.FloatPrecision>=0&&(n.FloatPrecision=a.FloatPrecision),a.StringFormat>0&&(n.StringFormat=a.StringFormat),a.Args&&(n.Args=a.Args),ha.IsNumber(a.YSplitType)&&(n.YSplitType=a.YSplitType)),this.ChangeScriptIndex(t,n,a)}}},this.ChangeIndexWindowCount=function(t){var e=this;if(!(t<2)&&this.Frame.SubFrame.length!=t){var a=this.Frame.SubFrame.length;if(a>t){for(var i=a-1;i>=t;--i){this.DeleteIndexPaint(i);var r=this.Frame.SubFrame[i].Frame;r.ClearToolbar&&r.ClearToolbar()}this.Frame.SubFrame.splice(t,a-t),this.WindowIndex.splice(t,a-t)}else{for(i=a;i<t;++i){var n=this.CreateSubFrameItem(i);this.Frame.SubFrame[i]=n;var s=new Ya;s.Frame=this.Frame.SubFrame[i].Frame,s.Canvas=this.Canvas,s.LanguageID=this.LanguageID,s.GetEventCallback=function(t){return e.GetEventCallback(t)},s.SelectedChart=this.SelectedChart,this.TitlePaint[i+1]=s}var o=["RSI","MACD","DMA","DMI","KDJ","WR"],h=new B;for(i=a;i<t;++i){var l=o[i%o.length],u=h.Get(l);this.WindowIndex[i]=new wn(u.Name,u.Script,u.Args,u);var C=this.SourceData;this.BindIndexData(i,C)}for(i=0;i<this.Frame.SubFrame.length;++i){r=this.Frame.SubFrame[i].Frame;i==this.Frame.SubFrame.length-1?r.XSplitOperator.ShowText=!0:r.XSplitOperator.ShowText=!1}this.UpdataDataoffset()}this.UpdateXShowText(),this.Frame.SetSizeChage(!0),this.ResetFrameXYSplit(),this.UpdateFrameMaxMin(),this.Draw()}},this.RemoveIndexWindow=function(t){if(w.Chart.Log("[MinuteChartContainer::RemoveIndexWindow] remove id",t),!(t<2)&&this.Frame.SubFrame&&!(t>=this.Frame.SubFrame.length)){this.Frame.SubFrame[t].Frame;this.DeleteIndexPaint(t),this.Frame.SubFrame[t].Frame.ClearToolbar(),this.Frame.SubFrame.splice(t,1),this.WindowIndex.splice(t,1),this.TitlePaint.splice(t+1,1);for(var e=0;e<this.Frame.SubFrame.length;++e){var a=this.Frame.SubFrame[e].Frame;e==this.Frame.SubFrame.length-1?a.XSplitOperator.ShowText=!0:a.XSplitOperator.ShowText=!1,a.Identify=e}this.Frame.SetSizeChage(!0),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw()}},this.AutoUpdateEvent=function(t,e){var a=t?G.RECV_START_AUTOUPDATE:G.RECV_STOP_AUTOUPDATE;if(this.mapEvent.has(a)){var i=this,r=this.mapEvent.get(a),n={Stock:{Symbol:this.Symbol,Name:this.Name,DayCount:this.DayCount},Explain:e};t&&(n.Callback=function(t){i.RecvMinuteData(t)}),r.Callback(r,n,this)}},this.ClearIndexPaint=function(){if(this.Frame&&this.Frame.SubFrame)for(var t=0;t<this.Frame.SubFrame.length;++t){t>=2&&this.DeleteIndexPaint(t,!0);var e=this.Frame.SubFrame[t];if(ha.IsNonEmptyArray(e.OverlayIndex))for(var a=0;a<e.OverlayIndex.length;++a){for(var i=e.OverlayIndex[a],r=0;r<i.ChartPaint.length;++r){var n=i.ChartPaint[r];n&&n.OnDestroy&&n.OnDestroy()}i.ChartPaint=[]}}for(t=1;t<this.TitlePaint.length;++t){e=this.TitlePaint[t];e.OverlayIndex=new E.default}},this.ResetDayOffset=function(){this.PageInfo.Enable?(this.DayOffset.Offset=this.PageInfo.Offset,this.DayOffset.ShowDayCount=this.PageInfo.ShowDayCount):(this.DayOffset.Offset=0,this.DayOffset.ShowDayCount=-1),this.DayOffset.PageInfo=null},this.ChangeSymbol=function(t,e){this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"MinuteChartContainer::ChangeSymbol"),this.Symbol=t,this.ResetDayOffset(),this.ClearIndexPaint(),this.ResetOverlaySymbolStatus(),this.ReloadChartDrawPicture(),e&&ha.IsNumber(e.DayCount)&&(this.DayCount=e.DayCount),!t||this.DayCount<=0?this.DrawEmpty():(this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.EnableSplash(!0),this.Draw(),this.RequestData())},this.SetPageInfo=function(t){t&&(ha.IsBool(t.Enable)&&(this.PageInfo.Enable=t.Enable),ha.IsNumber(t.Offset)&&(this.PageInfo.Offset=t.Offset),ha.IsNumber(t.ShowDayCount)&&(this.PageInfo.ShowDayCount=t.ShowDayCount))},this.ChangeDayCount=function(t,e){t<0||(this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"MinuteChartContainer::ChangeDayCount"),this.DayCount=t,e&&e.PageInfo&&(this.SetPageInfo(e.PageInfo),this.ResetDayOffset()),this.DayCount>1?this.ChartDrawPicture=[]:this.ReloadChartDrawPicture(),this.ClearIndexPaint(),this.ResetOverlaySymbolStatus(),this.RequestData())},this.OverlaySymbol=function(t,e){for(var a in this.OverlayChartPaint){var i=this.OverlayChartPaint[a];if(i.Symbol==t)return console.warn("[MinuteChartContainer::OverlaySymbol] overlay symbol="+t+" exist."),!1}var r=new Se;return r.Canvas=this.Canvas,r.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,r.ChartFrame=this.Frame.SubFrame[0].Frame,r.Name="Overlay-Minute",r.Symbol=t,r.Identify="Overlay-Minute-"+t,e&&e.Color?r.Color=e.Color:r.Color=Oi.OverlaySymbol.Color[Oi.OverlaySymbol.Random%Oi.OverlaySymbol.Color.length],++Oi.OverlaySymbol.Random,this.ChartPaint[0].YClose>0&&this.ChartPaint[0].Data&&(r.MainData=this.ChartPaint[0].Data,r.MainYClose=this.ChartPaint[0].YClose),this.OverlayChartPaint.push(r),this.DayCount<=1?this.RequestOverlayMinuteData():this.RequestOverlayHistoryMinuteData(),!0},this.ResetOverlaySymbolStatus=function(){for(var t in this.OverlayChartPaint){var e=this.OverlayChartPaint[t];e.Status=Jt.STATUS_NONE_ID}},this.DeleteOverlaySymbol=function(t){for(var e in this.OverlayChartPaint){var a=this.OverlayChartPaint[e];if(a.Symbol===t)return a.IsDelete=!0,this.OverlayChartPaint.splice(e,1),this.UpdateFrameMaxMin(),this.Draw(),!0}return console.warn("[MinuteChartContainer::DeleteOverlaySymbol] overlay symbol="+t+" not exist."),!1},this.ClearOverlaySymbol=function(){for(var t in this.OverlayChartPaint){var e=this.OverlayChartPaint[t];e.IsDelete=!0}this.OverlayChartPaint=[],this.Frame.SubFrame[0].Frame.YSplitOperator.OverlayChartPaint=this.OverlayChartPaint,this.TitlePaint[0].OverlayChartPaint=this.OverlayChartPaint,this.UpdateFrameMaxMin(),this.Draw()},this.ShowBeforeData=function(t,e){this.ShowCallAuctionData({Left:t},e)},this.ShowCallAuctionData=function(t,e){if(t){var a=!1;if(ha.IsBool(t.Left)&&this.IsShowBeforeData!=t.Left&&(this.IsShowBeforeData=t.Left,a=!0),ha.IsBool(t.Right)&&this.IsShowAfterData!=t.Right&&(this.IsShowAfterData=t.Right,a=!0),t.MultiDay){var i=t.MultiDay;ha.IsBool(i.Left)&&this.IsShowMultiDayBeforeData!=i.Left&&(this.IsShowMultiDayBeforeData=i.Left,a=!0),ha.IsBool(i.Right)&&this.IsShowMultiDayAfterData!=i.Right&&(this.IsShowMultiDayAfterData=i.Right,a=!0)}if(e){if(e.BeforeOpen){i=e.BeforeOpen;ha.IsNumber(i.Left)&&this.ExtendWidth.Left!=i.Left&&(this.ExtendWidth.Left=i.Left,a=!0)}if(e.AfterClose){i=e.AfterClose;ha.IsNumber(i.Right)&&this.ExtendWidth.Right!=i.Right&&(this.ExtendWidth.Right=i.Right,a=!0)}if(e.MultiDay){i=e.MultiDay;ha.IsNumber(i.Left)&&this.MultiDayExtendWidth.Left!=i.Left&&(this.MultiDayExtendWidth.Left=i.Left,a=!0),ha.IsNumber(i.Right)&&this.MultiDayExtendWidth.Right!=i.Right&&(this.MultiDayExtendWidth.Right=i.Right,a=!0)}}a&&this.RequestData()}},this.RequestData=function(){this.DayCount<=1?this.RequestMinuteData():this.RequestHistoryMinuteData()},this.ChangeDrawType=function(t){if(!(this.ChartPaint.length<=0)){if(0==t)this.ChartPaint[0].IsDrawArea=!0;else{if(1!=t)return;this.ChartPaint[0].IsDrawArea=!1}this.Draw()}},this.UpdateDataOffset=function(){this.SourceData.DataOffset=this.DayOffset.DataOffset;for(var t=0;t<this.ChartPaint.length;++t){var e=this.ChartPaint[t];e.Data&&(e.Data.DataOffset=this.DayOffset.DataOffset,"ChartMinuteVolumBar"!=e.ClassName&&"ChartMinutePriceLine"!=e.ClassName||(e.DayOffset=this.DayOffset))}for(t=0;t<this.OverlayChartPaint.length;++t){e=this.OverlayChartPaint[t];e.Data&&(e.Data.DataOffset=this.DayOffset.DataOffset)}for(t=0;t<this.Frame.SubFrame.length;++t)for(var a=this.Frame.SubFrame[t],i=0;i<a.OverlayIndex.length;++i)for(var r=a.OverlayIndex[i],n=0;n<r.ChartPaint.length;++n){e=r.ChartPaint[n];e.Data&&(e.Data.DataOffset=this.DayOffset.DataOffset)}},this.RequestHistoryMinuteData=function(){var t=this;if(this.IsBeforeData=!1,this.IsAfterData=!1,this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.EnableSplash(!0),this.Draw(),this.NetworkFilter){var e={Name:"MinuteChartContainer::RequestHistoryMinuteData",Explain:"å¤æ¥åæ¶æ°æ®",Request:{Url:t.HistoryMinuteApiUrl,Data:{daycount:t.DayCount,symbol:t.Symbol},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(e,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryMinuteData(e)})),1==e.PreventDefault)return}O.HttpRequest({url:t.HistoryMinuteApiUrl,data:{symbol:t.Symbol,daycount:t.DayCount},type:"post",dataType:"json",async:!0,success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryMinuteData(e)}})},this.RecvHistoryMinuteData=function(t){this.DayData=Hi.JsonDataToMinuteDataArray(t),this.ColorLineData=Hi.JsonDataToHistoryMinuteLineColorData(t),this.MultiDayBeforeOpenData=Hi.JosnDataToBeforeOpenDataArray(t),this.MultiDayAfterCloseData=Hi.JosnDataToAfterCloseDataArray(t);var e=Hi.JsonDataToHistoryMinuteLastUpdateTime(t);this.CaclutateCallCationYRange(),this.Symbol=t.symbol,this.Name=t.name,this.SetCallCationDataBorder({Left:!1,Right:!1,MultiDay:{Left:this.IsShowMultiDayBeforeData,Right:this.IsShowMultiDayAfterData}}),this.CaclutateLimitPrice(this.DayData[0].YClose,t.data[0].limitprice),this.UpdateHistoryMinuteUI(e),this.RecvMinuteDataEvent(),this.RequestOverlayHistoryMinuteData(),this.BindAllOverlayIndexData(this.SourceData),this.AutoUpdateEvent(!0,"MinuteChartContainer::RequestHistoryMinuteData"),this.AutoUpdate()},this.CaclutateCallCationYRange=function(){var t=null,e=null;if(ha.IsNonEmptyArray(this.MultiDayAfterCloseData)){for(var a={Max:null,Min:null},i=0;i<this.MultiDayAfterCloseData.length;++i){var r=this.MultiDayAfterCloseData[i];(null==a.Max||a.Max<r.VolMax)&&(a.Max=r.VolMax),(null==a.Min||a.Min>r.VolMin)&&(a.Min=r.VolMin)}t=a}if(ha.IsNonEmptyArray(this.MultiDayBeforeOpenData)){for(a={Max:null,Min:null},i=0;i<this.MultiDayBeforeOpenData.length;++i){r=this.MultiDayBeforeOpenData[i];(null==a.Max||a.Max<r.VolMax)&&(a.Max=r.VolMax),(null==a.Min||a.Min>r.VolMin)&&(a.Min=r.VolMin)}e=a}if(2==this.ShareAfterVol&&t&&e){var n=Math.max(t.Max,e.Max),s=Math.min(t.Min,e.Min);t.Max=e.Max=n,t.Min=e.Min=s}if(t)for(i=0;i<this.MultiDayAfterCloseData.length;++i){r=this.MultiDayAfterCloseData[i];r.VolMax=t.Max,r.VolMin=t.Min}if(e)for(i=0;i<this.MultiDayBeforeOpenData.length;++i){r=this.MultiDayBeforeOpenData[i];r.VolMax=e.Max,r.VolMin=e.Min}},this.UpdateHistoryMinuteUI=function(t){var e=this.HistoryMinuteDataToArray(this.DayData),a=new Ot;a.Data=e,t&&(a.UpdateTime=t),this.SourceData=a,this.TradeDate=this.DayData[0].Date,this.DayOffset.DayCount=this.DayData.length,-1==this.DayOffset.ShowDayCount&&(this.DayOffset.ShowDayCount=this.DayData.length),-8888==this.DayOffset.Offset&&(this.DayOffset.Offset=this.DayOffset.DayCount-this.DayOffset.ShowDayCount);var i=this.DayOffset.ShowDayCount;this.Frame.SetDayCount(i);var r=this.Symbol.toUpperCase(),n=this.DayData[0].YClose,s=Br.IsFutures(r);ha.IsNumber(this.DayData[0].YClearing)&&s&&(n=this.DayData[0].YClearing),this.BindMainData(a,n),Br.IsForeignExchange(r)&&(this.ChartPaint[1].Data=null);for(var o=0;o<this.Frame.SubFrame.length;++o){var h=this.Frame.SubFrame[o];for(var l in h.Frame.XSplitOperator.Symbol=this.Symbol,h.Frame.XSplitOperator.DayCount=i,h.Frame.XSplitOperator.DayData=this.DayData,h.Frame.XSplitOperator.Operator(),h.Frame.XSplitOperator.IsBeforeData=this.IsBeforeData,h.Frame.XSplitOperator.IsAfterData=this.IsAfterData,h.Frame.YSplitOperator.Symbol=this.Symbol,h.Frame.YSplitOperator.IsBeforeData=this.IsBeforeData,h.Frame.YSplitOperator.IsAfterData=this.IsAfterData,h.OverlayIndex){var u=h.OverlayIndex[l];u.Frame.XPointCount=h.Frame.XPointCount,u.Frame.MinuteCount=h.Frame.MinuteCount}}if(this.ChartCorssCursor.StringFormatY.Symbol=this.Symbol,this.ChartCorssCursor.StringFormatX.Symbol=this.Symbol,this.ChartCorssCursor.StringFormatX.IsBeforeData=this.IsBeforeData,this.ChartCorssCursor.StringFormatX.IsAfterData=this.IsAfterData,this.TitlePaint[0].IsShowDate=!0,this.UpdateDataOffset(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.Frame.SubFrame.length>2){var C=new Ot;C.Data=e;for(var D=2;D<this.Frame.SubFrame.length;++D)this.BindIndexData(D,C)}},this.HistoryMinuteDataToArray=function(t){for(var e=[],a=t.length-1;a>=0;--a)for(var i=t[a],r=0;r<i.Data.length;++r)e.push(i.Data[r]);return e},this.UpdateLatestMinuteData=function(t,e){for(var a in this.DayData){var i=this.DayData[a];if(i.Date===e){i.Data=t;break}}},this.RequestMinuteData=function(){var t=this,e=["name","symbol","yclose","open","price","high","low","vol","amount","date","time","minute","minutecount"],a=this.Symbol.toUpperCase();if(Br.IsFutures(a)&&(e.push("clearing"),e.push("yclearing")),this.IsBeforeData=!1,this.IsShowBeforeData&&1===this.DayCount&&Br.IsSHSZStockA(t.Symbol)&&(this.IsBeforeData=!0,e.push("before")),this.IsAfterData=!1,this.IsShowAfterData&&1===this.DayCount&&Br.IsSHSZStockA(t.Symbol)&&(this.IsAfterData=!0),this.NetworkFilter){var i={Before:this.IsShowBeforeData&&1===this.DayCount,After:this.IsShowAfterData&&1===this.DayCount},r={Name:"MinuteChartContainer::RequestMinuteData",Explain:"ææ°åæ¶æ°æ®",Request:{Url:t.MinuteApiUrl,Data:{field:e,symbol:[t.Symbol],callcation:i},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(r,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvMinuteData(e)})),1==r.PreventDefault)return}O.HttpRequest({url:t.MinuteApiUrl,data:{field:e,symbol:[t.Symbol],start:-1},type:"post",dataType:"json",async:!0,success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvMinuteData(e)}})},this.RecvMinuteDataEvent=function(){if(this.mapEvent.has(G.RECV_MINUTE_DATA)){var t=this.mapEvent.get(G.RECV_MINUTE_DATA),e={MinuteData:this.SourceData,Stock:{Symbol:this.Symbol,Name:this.Name}};t.Callback(t,e,this)}},this.UpdateLineColorData=function(t,e){if(this.ColorLineData){var a=this.ColorLineData.filter((function(t,a,i){return t.Date!=e}));if(ha.IsNonEmptyArray(t))for(var i in t)a.push(t[i]);this.ColorLineData=a}else this.ColorLineData=t},this.UpdateCallCationData=function(t,e){if(t&&ha.IsNonEmptyArray(this.MultiDayBeforeOpenData)){var a=this.MultiDayBeforeOpenData[this.MultiDayBeforeOpenData.length-1];a.Date==t.Date&&(this.MultiDayBeforeOpenData[this.MultiDayBeforeOpenData.length-1]=t)}if(e&&ha.IsNonEmptyArray(this.MultiDayAfterCloseData)){a=this.MultiDayAfterCloseData[this.MultiDayBeforeOpenData.length-1];a.Date==e.Date&&(this.MultiDayAfterCloseData[this.MultiDayAfterCloseData.length-1]=e)}this.CaclutateCallCationYRange()},this.RecvMinuteData=function(t){if(t){var e=Hi.JsonDataToMinuteData(t),a=Hi.JsonDataToMinuteLineColorData(t);this.BeforeOpenData=null,this.AfterCloseData=null;var i=Hi.JsonDataToBeforeOpenData(t),r=Hi.JsonDataToAfterCloseData(t),n=Hi.JsonDataToMinuteLastUpdateTime(t);if(this.IsBeforeData&&(this.BeforeOpenData=i),this.IsAfterData&&(this.AfterCloseData=r),this.DayCount>1)return this.UpdateCallCationData(i,r),this.UpdateLineColorData(a,t.stock[0].date),this.UpdateLatestMinuteData(e,t.stock[0].date),this.UpdateHistoryMinuteUI(n),this.RecvMinuteDataEvent(),this.RequestOverlayMinuteData(),this.BindAllOverlayIndexData(this.SourceData),this.AutoUpdateEvent(!0,"MinuteChartContainer::RecvMinuteData"),void this.AutoUpdate();var s=new Ot;if(s.Data=e,s.UpdateTime=n,this.ColorLineData=a,this.TradeDate=t.stock[0].date,this.Frame.SetDayCount(1),this.SourceData=s,this.Symbol=t.stock[0].symbol,this.Name=t.stock[0].name,this.SetCallCationDataBorder({Left:this.IsBeforeData,Right:this.IsAfterData,MultiDay:{Left:!1,Right:!1}}),2==this.ShareAfterVol&&this.BeforeOpenData&&this.AfterCloseData){var o=Math.max(this.BeforeOpenData.VolMax,this.AfterCloseData.VolMax),h=Math.min(this.BeforeOpenData.VolMin,this.AfterCloseData.VolMin);this.BeforeOpenData.VolMax=this.AfterCloseData.VolMax=o,this.BeforeOpenData.VolMin=this.AfterCloseData.VolMin=h}var l=t.stock[0].yclose,u=this.Symbol.toUpperCase(),C=Br.IsFutures(u);t.stock[0].yclearing>0&&C&&(l=t.stock[0].yclearing),this.CaclutateLimitPrice(l,t.stock[0].limitprice);var D=null;if(t.stock[0].high>0&&t.stock[0].low>0&&(D={High:t.stock[0].high,Low:t.stock[0].low}),this.BindMainData(s,l,D),this.Frame.SubFrame.length>2){var f=new Ot;f.Data=e;for(var c=2;c<this.Frame.SubFrame.length;++c)this.BindIndexData(c,f)}for(var d in this.Frame.SubFrame){var m=this.Frame.SubFrame[d];for(var v in m.Frame.XSplitOperator.Symbol=this.Symbol,m.Frame.XSplitOperator.DayCount=1,m.Frame.XSplitOperator.Operator(),m.Frame.YSplitOperator.Symbol=this.Symbol,m.OverlayIndex){var S=m.OverlayIndex[v];S.Frame.XPointCount=m.Frame.XPointCount,S.Frame.MinuteCount=m.Frame.MinuteCount}}this.ChartCorssCursor.StringFormatY.Symbol=this.Symbol,this.ChartCorssCursor.StringFormatX.Symbol=this.Symbol,Br.IsSHSZ(u)&&(this.TitlePaint[0].IsShowDate=!1),1==t.stock[0].IsHistoryMinute&&(this.TitlePaint[0].IsShowDate=!0);var I=this.GetChartMinuteInfo();I&&(I.SourceData=this.SourceData),this.RecvMinuteDataEvent(),this.RequestMinuteInfoData(),this.RequestOverlayMinuteData(),this.CreateChartDrawPictureByStorage(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw(),this.BindAllOverlayIndexData(this.SourceData),this.AutoUpdateEvent(!0,"MinuteChartContainer::RecvMinuteData"),this.AutoUpdate()}else w.Chart.Warn("[MinuteChartContainer::RecvMinuteData] recv data is null")},this.CaclutateLimitPrice=function(t,e){if(this.LimitPrice=null,e&&e.max>0&&e.min>0)this.LimitPrice={Max:e.max,Min:e.min};else{var a=Br.GetLimitPriceRange(this.Symbol,this.Name);a?t<=0||(this.LimitPrice={Max:t*(1+a.Max),Min:t*(1+a.Min)},w.Chart.Log("[MinuteChartContainer::CaclutateLimitPrice] "+this.Symbol+" yClose:"+t+" max:"+this.LimitPrice.Max+" min:"+this.LimitPrice.Min),this.LimitPrice.Max=parseFloat(this.LimitPrice.Max.toFixed(2)),this.LimitPrice.Min=parseFloat(this.LimitPrice.Min.toFixed(2)),w.Chart.Log("[MinuteChartContainer::CaclutateLimitPrice] "+this.Symbol+" tofixed(2) max:"+this.LimitPrice.Max+" min:"+this.LimitPrice.Min)):w.Chart.Log("[MinuteChartContainer::CaclutateLimitPrice] "+this.Symbol+" no limit price.")}},this.RequestOverlayMinuteData=function(){var t=this,e=this,a=this.TradeDate,i=function(){var i=t.OverlayChartPaint[r];return i.MainData&&i.MainYClose>0?i.Status!=Jt.STATUS_NONE_ID?"continue":(n=i.Symbol,n?(i.Status=Jt.STATUS_REQUESTDATA_ID,t.NetworkFilter&&(s={Name:"MinuteChartContainer::RequestOverlayMinuteData",Explain:"å å è¡ç¥¨ææ°åæ¶æ°æ®",Request:{Url:e.HistoryMinuteApiUrl,Data:{days:[a],symbol:n},Type:"POST"},Self:t,PreventDefault:!1},t.NetworkFilter(s,(function(t){i.Status=Jt.STATUS_RECVDATA_ID,e.RecvOverlayMinuteData(t,i)})),1==s.PreventDefault)?"continue":void O.HttpRequest({url:e.HistoryMinuteApiUrl,data:{symbol:n,days:[a]},type:"post",dataType:"json",async:!0,success:function(t){i.Status=Jt.STATUS_RECVDATA_ID,e.RecvOverlayMinuteData(t,i)}})):{v:void 0}):"continue"};for(var r in this.OverlayChartPaint){var n,s,o=i();switch(o){case"continue":continue;default:if("object"===("undefined"===typeof o?"undefined":(0,d.default)(o)))return o.v}}},this.RecvOverlayMinuteData=function(t,e){if(!e.IsDelete){var a,i=Hi.JsonDataToMinuteDataArray(t),r=null;if(this.DayCount>1){if(i.length<=0)return;var n=i[0];for(var s in e.SourceData){var o=e.SourceData[s];if(o.Date==n.Date){e.SourceData[s]=n;var h=this.HistoryMinuteDataToArray(e.SourceData);r=new Ot;r.Data=h,a=n.YClose;break}}if(null==r)return}else r=i.length>0?i[0]:new Ot,a=r.YClose;e.Data=r,e.Title=t.name,e.Symbol=t.symbol,e.YClose=a,e.Status=Jt.STATUS_FINISHED_ID,this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}},this.RequestOverlayHistoryMinuteData=function(){var t=this,e=this,a=[];for(var i in this.DayData){var r=this.DayData[i];a.push(r.Date)}if(!(a.length<=0)){var n=function(){var r=t.OverlayChartPaint[i];return s=r.Symbol,s?r.Status!=Jt.STATUS_NONE_ID?"continue":(r.Status=Jt.STATUS_REQUESTDATA_ID,t.NetworkFilter&&(o={Name:"MinuteChartContainer::RequestOverlayHistoryMinuteData",Explain:"å å è¡ç¥¨å¤æ¥åæ¶æ°æ®",Request:{Url:e.HistoryMinuteApiUrl,Data:{days:a,symbol:s},Type:"POST"},Self:t,PreventDefault:!1},t.NetworkFilter(o,(function(t){r.Status=Jt.STATUS_RECVDATA_ID,e.RecvOverlayHistoryMinuteData(t,r)})),1==o.PreventDefault)?{v:void 0}:void O.HttpRequest({url:e.HistoryMinuteApiUrl,data:{symbol:s,days:a},type:"post",dataType:"json",async:!0,success:function(t){r.Status=Jt.STATUS_RECVDATA_ID,e.RecvOverlayHistoryMinuteData(t,r)}})):{v:void 0}};for(var i in this.OverlayChartPaint){var s,o,h=n();switch(h){case"continue":continue;default:if("object"===("undefined"===typeof h?"undefined":(0,d.default)(h)))return h.v}}}},this.RecvOverlayHistoryMinuteData=function(t,e){var a=Hi.JsonDataToMinuteDataArray(t),i=[];for(var r in this.DayData){var n=this.DayData[r],s=!1;for(var o in a)if(n.Date==a[o].Date){i.push(a[r]),s=!0;break}if(!s){var h=new Ot;h.Date=n.Date}}e.SourceData=i;var l=this.HistoryMinuteDataToArray(i),u=i[0].YClose,C=new Ot;C.Data=l,e.Data=C,e.Title=t.name,e.Symbol=t.symbol,e.YClose=u,e.Status=Jt.STATUS_FINISHED_ID,this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()},this.CancelAutoUpdate=function(){"number"==typeof this.AutoUpdateTimer&&(clearTimeout(this.AutoUpdateTimer),this.AutoUpdateTimer=void 0)},this.AutoUpdate=function(){if(this.CancelAutoUpdate(),this.IsAutoUpdate&&this.Symbol){var t=this,e=Br.GetMarketStatus(this.Symbol);if(0!=e&&3!=e){var a=this.AutoUpdateFrequency;1==e?this.AutoUpdateTimer=setTimeout((function(){t.AutoUpdate()}),a):2==e&&(this.AutoUpdateTimer=setTimeout((function(){t.ResetOverlaySymbolStatus(),t.RequestMinuteData()}),a))}}},this.BindIndexData=function(t,e){this.WindowIndex[t]&&("function"!=typeof this.WindowIndex[t].RequestData?"function"!=typeof this.WindowIndex[t].ExecuteScript?this.WindowIndex[t].BindData(this,t,e):this.WindowIndex[t].ExecuteScript(this,t,e):this.WindowIndex[t].RequestData(this,t,e))},this.BindMainData=function(t,e,a){var i=this.IsShowMultiDayBeforeData?this.MultiDayBeforeOpenData:null,r=this.IsShowMultiDayAfterData?this.MultiDayAfterCloseData:null,n=new Ot;if(n.Data=t.GetClose(),this.ChartPaint[0].Data=n,this.ChartPaint[0].YClose=e,this.ChartPaint[0].NotSupportMessage=null,this.ChartPaint[0].IsShowLead=!1,this.ChartPaint[0].LeadData=null,this.ChartPaint[0].BeforeOpenData=this.BeforeOpenData,this.ChartPaint[0].AfterCloseData=this.AfterCloseData,this.ChartPaint[0].MultiDayBeforeOpenData=i,this.ChartPaint[0].MultiDayAfterCloseData=r,this.ChartPaint[0].ColorLineData=this.ColorLineData,this.ChartPaint[0].Source=t,Br.IsSHSZIndex(this.Symbol)&&1==this.DayCount&&this.IsShowLead){var s=new Ot;s.Data=t.GetLead(),this.ChartPaint[0].LeadData=s,this.ChartPaint[0].IsShowLead=!0}var o=this.Frame.SubFrame[0].Frame;for(var h in o.YSplitOperator.YClose=e,o.YSplitOperator.Data=n,this.Frame.Data=this.ChartPaint[0].Data,this.Frame.SourceData=t,this.Frame.SubFrame){var l=this.Frame.SubFrame[h].Frame;l.Data=t}n=new Ot,n.Data=t.GetMinuteAvPrice(),this.ChartPaint[1].Data=n;var u=this.Symbol.toUpperCase();for(var h in(Br.IsForeignExchange(u)||Br.IsShowAvPrice&&!Br.IsShowAvPrice(u))&&(this.ChartPaint[1].Data=null),o.YSplitOperator.AverageData=n,o.YSplitOperator.OverlayChartPaint=this.OverlayChartPaint,o.YSplitOperator.LimitPrice=this.LimitPrice,o.YSplitOperator.MultiDayBeforeOpenData=i,o.YSplitOperator.MultiDayAfterCloseData=r,o.YSplitOperator.DayCount=this.DayCount,a?(o.YSplitOperator.High=a.High,o.YSplitOperator.Low=a.Low):(o.YSplitOperator.High=null,o.YSplitOperator.Low=null),this.ChartPaint[2].Data=t,this.ChartPaint[2].YClose=e,this.ChartPaint[2].Symbol=this.Symbol,this.ChartPaint[2].BeforeOpenData=this.BeforeOpenData,this.ChartPaint[2].AfterCloseData=this.AfterCloseData,this.ChartPaint[2].MultiDayBeforeOpenData=i,this.ChartPaint[2].MultiDayAfterCloseData=r,this.Frame.SubFrame){l=this.Frame.SubFrame[h];l.Frame.YSplitOperator.BeforeOpenData=this.BeforeOpenData,l.Frame.YSplitOperator.IsBeforeData=this.IsBeforeData,l.Frame.YSplitOperator.AfterCloseData=this.AfterCloseData,l.Frame.YSplitOperator.IsAfterData=this.IsAfterData,l.Frame.YSplitOperator.MultiDayBeforeOpenData=i,l.Frame.YSplitOperator.MultiDayAfterCloseData=r}for(var h in Br.IsShowMinutePostionLine(u)?this.BindOverlayPositionData(t,e):this.ClearBindOverlayPositionData(),this.TitlePaint[0].Data=this.SourceData,this.TitlePaint[0].Symbol=this.Symbol,this.TitlePaint[0].Name=this.Name,this.TitlePaint[0].YClose=e,this.TitlePaint[0].BeforeOpenData=this.BeforeOpenData,this.TitlePaint[0].AfterCloseData=this.AfterCloseData,this.TitlePaint[0].MultiDayBeforeOpenData=this.IsShowMultiDayBeforeData?this.MultiDayBeforeOpenData:null,this.TitlePaint[0].MultiDayAfterCloseData=this.IsShowMultiDayAfterData?this.MultiDayAfterCloseData:null,this.TitlePaint[0].CallAcutionXOperator&&(this.TitlePaint[0].CallAcutionXOperator.BeforeOpenData=this.BeforeOpenData,this.TitlePaint[0].CallAcutionXOperator.AfterCloseData=this.AfterCloseData,this.TitlePaint[0].CallAcutionXOperator.MultiDayBeforeOpenData=i,this.TitlePaint[0].CallAcutionXOperator.MultiDayAfterCloseData=r,this.TitlePaint[0].CallAcutionXOperator.DayOffset=this.DayOffset),this.ChartCorssCursor&&this.ChartCorssCursor.StringFormatY&&(this.ChartCorssCursor.StringFormatY.YClose=e,this.ChartCorssCursor.StringFormatY.BeforeOpenData=this.BeforeOpenData,this.ChartCorssCursor.StringFormatY.AfterCloseData=this.AfterCloseData,this.ChartCorssCursor.StringFormatY.MultiDayBeforeOpenData=i,this.ChartCorssCursor.StringFormatY.MultiDayAfterCloseData=r,this.ChartCorssCursor.StringFormatY.DayOffset=this.DayOffset,this.ChartCorssCursor.StringFormatX.Data=this.ChartPaint[0].Data,this.ChartCorssCursor.StringFormatX.BeforeOpenData=this.BeforeOpenData,this.ChartCorssCursor.StringFormatX.AfterCloseData=this.AfterCloseData,this.ChartCorssCursor.StringFormatX.MultiDayBeforeOpenData=i,this.ChartCorssCursor.StringFormatX.MultiDayAfterCloseData=r,this.ChartCorssCursor.StringFormatX.DayOffset=this.DayOffset,this.ChartCorssCursor.CallAcutionXOperator&&(this.ChartCorssCursor.CallAcutionXOperator.BeforeOpenData=this.BeforeOpenData,this.ChartCorssCursor.CallAcutionXOperator.AfterCloseData=this.AfterCloseData,this.ChartCorssCursor.CallAcutionXOperator.MultiDayBeforeOpenData=i,this.ChartCorssCursor.CallAcutionXOperator.MultiDayAfterCloseData=r,this.ChartCorssCursor.CallAcutionXOperator.DayOffset=this.DayOffset)),this.ExtendChartPaint[0]&&(this.ExtendChartPaint[0].Symbol=this.Symbol,this.ExtendChartPaint[0].Name=this.Name),this.OverlayChartPaint){l=this.OverlayChartPaint[h];l.MainData=this.ChartPaint[0].Data,l.MainYClose=e}},this.BindOverlayPositionData=function(t,e){if(!(this.Frame.SubFrame.length<2)){for(var a=null,i=null,r=this.Frame.SubFrame[1],n=null,s=0;s<r.OverlayIndex.length;++s){var o=r.OverlayIndex[s];if("Position_Line_Frame"==o.Identify){n=o;break}}if(n){i=n.Frame;for(s=0;s<n.ChartPaint.length;++s){o=n.ChartPaint[s];if("Position-Line"==o.Name){a=o;break}}a||(a=new jt,a.Canvas=this.Canvas,a.Name="Position-Line",a.ChartBorder=i.ChartBorder,a.ChartFrame=i,a.Identify=n.Identify,a.Color=Oi.Minute.PositionColor,n.ChartPaint.push(a))}else{n=new St,n.Identify="Position_Line_Frame",i="MinuteChartContainer"==this.ClassName?new Ct:new Dt,i.Canvas=this.Canvas,i.MainFrame=r.Frame,i.ChartBorder=r.Frame.ChartBorder,n.Frame=i,i.YSplitOperator=new ua,i.YSplitOperator.LanguageID=this.LanguageID,i.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),i.YSplitOperator.Frame=i,i.YSplitOperator.ChartBorder=i.ChartBorder,i.YSplitOperator.SplitCount=r.Frame.YSplitOperator.SplitCount;a=new jt;a.Canvas=this.Canvas,a.Name="Position-Line",a.ChartBorder=i.ChartBorder,a.ChartFrame=i,a.Identify=n.Identify,a.Color=Oi.Minute.PositionColor,n.ChartPaint.push(a),r.OverlayIndex.push(n),r.Frame.RightFrame=i}var h=this.Frame.SubFrame[0].Frame.XPointCount;i.XPointCount=h,r.Frame.IsShowPositionTitle=!0;var l=new Ot;l.Data=t.GetPosition(),a.Data=l}},this.ClearBindOverlayPositionData=function(){if(!(this.Frame.SubFrame.length<2)){var t=this.Frame.SubFrame[1];for(var e in t.Frame.RightFrame=null,t.Frame.IsShowPositionTitle=!1,t.OverlayIndex){var a=t.OverlayIndex[e];if("Position_Line_Frame"==a.Identify){t.OverlayIndex.splice(e,1);break}}}},this.AddOverlayIndex=function(t){var e=this.CreateOverlayWindowsIndex(t);if(e){var a=this.SourceData;this.BindOverlayIndexData(e,t.WindowIndex,a),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()}},this.CreateOverlayWindowsIndex=function(t){var e=t.IndexName,a=t.WindowIndex,i=null,r=null,n=null;if(t.API)i=t.API;else if(t.Script)r={Script:t.Script,ID:t.indexName,Name:t.indexName},t.Name&&(r.Name=t.Name);else{var s=new B;if(r=s.Get(e),!r&&(n=Bi.Get(e),!n))return console.warn("[MinuteChartContainer::CreateOverlayIndex] can not find index["+e+"]"),null}var o=this.Frame.SubFrame[a];o.Interval=this.OverlayIndexFrameWidth;var h=new St;t.Identify&&(h.Identify=t.Identify);var l=null;if(l="MinuteChartContainer"==this.ClassName?new Ct:new Dt,l.Canvas=this.Canvas,l.MainFrame=o.Frame,l.ChartBorder=o.Frame.ChartBorder,!0===t.ShowRightText?l.IsShow=!0:!1===t.ShowRightText&&(l.IsShow=!1),!0===t.IsShareY&&(l.IsShareY=!0),ha.IsBool(t.IsCalculateYMaxMin)&&(l.IsCalculateYMaxMin=t.IsCalculateYMaxMin),l.YSplitOperator=new ua,l.YSplitOperator.LanguageID=this.LanguageID,l.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),l.YSplitOperator.Frame=l,l.YSplitOperator.ChartBorder=l.ChartBorder,l.YSplitOperator.SplitCount=o.Frame.YSplitOperator.SplitCount,h.Frame=l,i){var u=new Rn(i.Name,i.Script,i.Args,t,!0);u.OverlayIndex={IsOverlay:!0,Identify:h.Identify,WindowIndex:a,Frame:h},h.Script=u}else if(r){var C=r;t.Args&&(C.Args=t.Args);var D=new On(C.Name,C.Script,C.Args,C);D.OverlayIndex={IsOverlay:!0,Identify:h.Identify,WindowIndex:a,Frame:h},h.Script=D}else{D=n.Create();D.OverlayIndex={IsOverlay:!0,Identify:h.Identify,WindowIndex:a,Frame:h},D.Create(this,a),h.Script=D}return o.OverlayIndex.push(h),h},this.DeleteOverlayWindowsIndex=function(t){this.DeleteOverlayIndex(t,null)&&(this.Frame.ResetXYSplit(!0),this.Draw())},this.BindAllOverlayIndexData=function(t){if(this.Frame&&this.Frame.SubFrame)for(var e=0;e<this.Frame.SubFrame.length;++e){var a=this.Frame.SubFrame[e];for(var i in a.OverlayIndex){var r=a.OverlayIndex[i];this.BindOverlayIndexData(r,e,t)}}},this.BindOverlayIndexData=function(t,e,a){t.Script&&("function"!=typeof t.Script.RequestData?"function"!=typeof t.Script.ExecuteScript?t.Script.BindData(this,e,a):t.Script.ExecuteScript(this,e,a):t.Script.RequestData(this,e,a))},this.GetChartPaint=function(t){var e=new Array;for(var a in this.ChartPaint)if(!(a<3)){var i=this.ChartPaint[a];i.ChartFrame==this.Frame.SubFrame[t].Frame&&e.push(i)}return e},this.CreateWindowIndex=function(t){this.WindowIndex[t].Create(this,t)},this.GetIndexInfo=function(){var t=[];for(var e in this.WindowIndex){var a=this.WindowIndex[e],i={Name:a.Name};a.ID&&(i.ID=a.ID),t.push(i)}return t},this.OnTouchFinished=function(){!0!==this.CorssCursorTouchEnd||this.DrawDynamicInfo()},this.CreateExtendChart=function(t,e){var a;switch(t){case"MinuteTooltip":return a=e.Create&&"function"==typeof e.Create?e.Create():new qe,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,e.LanguageID=this.LanguageID,a.SetOption(e),this.ExtendChartPaint.push(a),a;case"ç»å¾å·¥å·":return a=new je,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,a.Left=this.Frame.ChartBorder.Right,a.SetOption(e),this.ExtendChartPaint.push(a),this.Frame.ChartBorder.Right+=a.Width,a;case"MinuteBackgroundPaint":return a=new ia,a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,e.LanguageID=this.LanguageID,a.SetOption(e),this.ExtendChartPaint.push(a),a;default:return a=Ke.Create(t),a?(a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.HQChart=this,a.SetOption(e),this.ExtendChartPaint.push(a),a):null}},this.SetMinuteInfo=function(t,e){for(var a in this.ChartInfo=[],t){var i=vr.Get(t[a]);if(i){var r=i.Create();this.ChartInfo.push(r)}}1==e&&this.RequestMinuteInfoData()},this.GetChartMinuteInfo=function(){return this.ChartInfoPaint},this.CreateMinuteInfo=function(t){var e=new Ie;return e.Canvas=this.Canvas,e.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,e.ChartFrame=this.Frame.SubFrame[0].Frame,e.HQChartBorder=this.Frame.ChartBorder,e.ChartMinutePrice=this.ChartPaint[0],t&&e.SetOption&&e.SetOption(t),this.ChartInfoPaint=e,e},this.RequestMinuteInfoData=function(){if(!(this.ChartInfo.length<=0)){var t=this.GetChartMinuteInfo();for(var e in t||(t=this.CreateMinuteInfo(null)),t.SourceData=this.SourceData,this.ChartInfo)this.ChartInfo[e].RequestData(this)}},this.UpdataChartInfo=function(){var t=this.GetChartMinuteInfo();if(t){var e=new E.default;for(var a in this.ChartInfo){var i=this.ChartInfo[a].Data;for(var r in i){var n=i[r],s=n.Date+" "+n.Time;e.has(s)?e.get(s).Data.push(n):e.set(s,{Data:new Array(n)})}}t.Data=e}},this.UpdateWindowIndex=function(t){if(!(t<2)){var e=this.SourceData;this.BindIndexData(t,e),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw()}},this.CreateChartDrawPicture=function(t,e,a){var i=null,r=ka.GetDrawPictureByName(t);if(r&&(i=r.Create(),"ChartDrawPictureText"==i.ClassName&&(i.HQChart=this)),!i&&ka.MapIonFont.has(t)){var n=ka.MapIonFont.get(t);i=new ni,i.FontOption.Family=n.Family,i.Text=n.Text,n.Color&&(i.LineColor=n.Color)}if(!i)return!1;i.Canvas=this.Canvas,i.Status=0,i.Symbol=this.Symbol,i.Period=888888888,i.Option=this.ChartDrawOption,a&&(i.FinishedCallback=a),e&&i.SetOption(e);var s=this;return i.Update=function(){s.DrawDynamicInfo()},i.GetActiveDrawPicture=function(){return s.GetActiveDrawPicture()},this.CurrentChartDrawPicture=i,w.Chart.Log("[MinuteChartContainer::CreateChartDrawPicture] ",t,this.CurrentChartDrawPicture),!0},this.ReloadChartDrawPicture=function(){this.ChartDrawPicture=[],this.ChartDrawStorageCache,this.ChartDrawStorage&&(this.ChartDrawStorageCache=this.ChartDrawStorage.GetDrawData({Symbol:this.Symbol,Period:888888888}))},this.CreateChartDrawPictureByStorage=function(){if(this.ChartDrawStorageCache&&!(this.ChartDrawStorageCache.length<=0)){for(var t in this.ChartDrawStorageCache){var e=this.ChartDrawStorageCache[t];if(!(e.FrameID<0||!this.Frame.SubFrame||this.Frame.SubFrame.length<e.FrameID)){var a=ka.CreateChartDrawPicture(e);a&&(a.Canvas=this.Canvas,a.Status=10,a.Frame=this.Frame.SubFrame[e.FrameID].Frame,a.UpdateXValue(),a.ValueToPoint(),"ChartDrawPictureText"===a.ClassName&&(a.IsInitialized=!0),this.ChartDrawPicture.push(a))}}this.ChartDrawStorageCache=null}},this.SetSizeChange=function(t){for(var e in this.Frame.SetSizeChage(t),this.ExtendChartPaint){var a=this.ExtendChartPaint[e];a.SizeChange=t}},this.SetSizeChage=this.SetSizeChange,this.GetDataIndexByPoint=function(t){var e=this.Frame;if(this.Frame.SubFrame&&this.Frame.SubFrame.length>0&&(e=this.Frame.SubFrame[0].Frame),e){var a=e.GetXData(t),i=parseInt(a.toFixed(0));return i}},this.GetSelectRectData=function(t){if(Math.abs(t.XStart-t.XEnd)<5)return!1;var e=this.PtInClient(t.XStart,t.YStart),a=this.PtInClient(t.XEnd,t.YEnd);t.StartClientPos=e,t.EndClientPos=a;var i=this.SourceData;if(!i)return!1;if(!ha.IsNonEmptyArray(i.Data))return!1;var r=this.GetDataIndexByPoint(t.XStart),n=this.GetDataIndexByPoint(t.XEnd);if(Math.abs(r-n)<2)return!1;t.Data=i,r>n?(t.Start=n,t.End=r):(t.Start=r,t.End=n);var s=i.Data.length;return t.End>=s&&(t.End=s-1),!0},this.Super_UpdateFrameMaxMin=this.UpdateFrameMaxMin,this.UpdateFrameMaxMin=function(){if(this.Super_UpdateFrameMaxMin(),1==this.DayCount){var t=this.Frame.SubFrame[1];t.Frame&&(t.Frame.XYSplit=!0)}}}function Yi(t){this.newMethod=Hi,this.newMethod(t),delete this.newMethod,this.HistoryMinuteApiUrl="https://opensourcecache.zealink.com/cache/minuteday/day/",this.ClassName="HistoryMinuteChartContainer",this.CreateMainKLine=function(){var t=new ve;t.Canvas=this.Canvas,t.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,t.ChartFrame=this.Frame.SubFrame[0].Frame,t.Name="Minute-Line",t.Color=Oi.Minute.PriceColor,this.ChartPaint[0]=t;var e=new jt;e.Canvas=this.Canvas,e.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,e.ChartFrame=this.Frame.SubFrame[0].Frame,e.Name="Minute-Average-Line",e.Color=Oi.Minute.AvPriceColor,this.ChartPaint[1]=e;e=new Zt;e.Color=Oi.Minute.VolBarColor,e.Canvas=this.Canvas,e.ChartBorder=this.Frame.SubFrame[1].Frame.ChartBorder,e.ChartFrame=this.Frame.SubFrame[1].Frame,e.Name="Minute-Vol-Bar",this.ChartPaint[2]=e,this.TitlePaint[0]=new Va,this.TitlePaint[0].Frame=this.Frame.SubFrame[0].Frame,this.TitlePaint[0].Canvas=this.Canvas,this.TitlePaint[0].IsShowDate=!0},this.ChangeTradeDate=function(t){t&&(this.TradeDate=t,this.RequestData())},this.RequestData=function(){var t=new Date,e=1e4*t.getFullYear()+100*(t.getMonth()+1)+t.getDate();e==this.TradeDate?this.RequestMinuteData():this.RequestHistoryMinuteData()},this.RequestHistoryMinuteData=function(){var t=this,e=this.HistoryMinuteApiUrl+this.TradeDate.toString()+"/"+this.Symbol+".json";O.HttpRequest({url:e,type:"get",dataType:"json",async:!0,success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryMinuteData(e)},error:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryMinuteError(e)}})},this.RecvHistoryMinuteError=function(t){if(404==t.status){var e=new Ot;for(var a in this.SourceData=e,this.ChartPaint)this.ChartPaint[a].Data=e,0==a&&(this.ChartPaint[a].NotSupportMessage="æ²¡ææéè®¿é®!");this.TitlePaint[0].Data=this.SourceData,this.TitlePaint[0].Symbol=this.Symbol,this.TitlePaint[0].Name=null,this.Draw()}},this.RecvHistoryMinuteData=function(t){var e=Yi.JsonDataToMinuteData(t),a=new Ot;if(a.Data=e,this.TradeDate=t.date,this.SourceData=a,this.Symbol=t.symbol,this.Name=t.name,this.BindMainData(a,t.day.yclose),this.Frame.SubFrame.length>2){var i=new Ot;i.Data=e;for(var r=2;r<this.Frame.SubFrame.length;++r)this.BindIndexData(r,i)}this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}}function ki(t){this.newMethod=Gi,this.newMethod(t),delete this.newMethod,this.ClassName="CustomKLineChartContainer",this.CustomKLineApiUrl=Oi.Domain+"/API/IndexCalculate",this.CustomStock,this.QueryDate={Start:20180101,End:20180627},this.RequestHistoryData=function(){var t=this;this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.EnableSplash(!0),this.Draw(),O.HttpRequest({url:this.CustomKLineApiUrl,data:{stock:t.CustomStock,Name:t.Symbol,date:{startdate:t.QueryDate.Start,enddate:t.QueryDate.End}},type:"post",dataType:"json",async:!0,success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvHistoryData(e)}})},this.RecvHistoryData=function(t){var e=Gi.JsonDataToHistoryData(t),a=new Ot;a.Data=e,a.DataType=0;var i=new Ot;if(i.Data=e,i.Right=this.Right,i.Period=this.Period,i.DataType=0,i.Right>0){var r=i.GetRightData(i.Right,{AlgorithmType:this.RightFormula});i.Data=r}if(Ot.IsDayPeriod(this.Period,!1)){var n=a.GetPeriodData(i.Period);i.Data=n}this.SourceData=a,this.Name=t.name,this.BindMainData(i,this.PageSize);for(var s=0;s<this.Frame.SubFrame.length;++s)this.BindIndexData(s,i);this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}}function _i(t,e){!0===e?(this.newMethod=Wi,this.newMethod(t),delete this.newMethod):(this.newMethod=Gi,this.newMethod(t),delete this.newMethod),this.BuySellPaint,this.TrainDataCount=300,this.TrainStartDate,this.AutoRunTimer=null,this.BuySellData=[],this.TrainCallback,this.DragMode=1,this.IsAutoUpdate=!1,this.KLineSourceData,this.TrainInfo={Start:{},End:{}},this.Super_RecvFlowCapitalData=this.RecvFlowCapitalData,this.CreateBuySellPaint=function(){var t=new Ye;t.Canvas=this.Canvas,t.ChartBorder=this.Frame.SubFrame[0].Frame.ChartBorder,t.ChartFrame=this.Frame.SubFrame[0].Frame,t.Name="KLine-Train-BuySell",this.ChartPaintEx[0]=t},this.GetKDataIndexByDateTime=function(t,e){if(!e||!t)return-1;for(var a=0;a<t.length;++a){var i=t[a];if(Ot.IsMinutePeriod(this.Period,!0)){if(ha.IsNumber(this.TrainStartDate.Time)){if(i.Date>=this.TrainStartDate.Date&&i.Time>=this.TrainStartDate.Time)return a}else if(i.Date>=this.TrainStartDate.Date)return a}else if((Ot.IsDayPeriod(this.Period,!0)||Ot.IsTickPeriod(this.Period))&&i.Date>=this.TrainStartDate.Date)return a}return-1},this.AfterBindMainData=function(t){this.ChartPaintEx[0]||this.CreateBuySellPaint();var e=this.ChartPaint[0].Data;this.ChartPaintEx[0].Data=e;var a=e.Data[e.Data.length-1];this.TrainInfo.LastShowData=a,this.TrainInfo.LastData=this.SourceData.Data[this.SourceData.Data.length-1],"Update"!=t&&this.UpdateTrainUICallback("å¼å§")},this.BeforeBindMainData=function(t){if("Update"!=t){this.KLineSourceData=new Ot,this.KLineSourceData.Data=this.SourceData.Data.slice(0);var e=this.SourceData.Data.length,a=e-this.TrainDataCount-20,i=this.GetKDataIndexByDateTime(this.SourceData.Data,this.TrainStartDate);i>=0&&(a=i+1,e-a<this.TrainDataCount&&(this.TrainDataCount=e-a));var r=a-1,n=this.SourceData.Data[r];this.TrainInfo.Start.Index=r,this.TrainInfo.Start.Date=n.Date,this.TrainInfo.Start.Time=n.Time,this.TrainInfo.End.Index=r,this.TrainInfo.End.Date=n.Date,this.TrainInfo.End.Time=n.Time,this.TrainInfo.LastData=n,this.SourceData.Data.length=a}},this.Run=function(t){if(!this.AutoRunTimer&&!(this.TrainDataCount<=0)){var e=this;this.AutoRunTimer=setInterval((function(){e.MoveNextKLineData(t)||clearInterval(e.AutoRunTimer)}),1e3)}},this.MoveNextKLineData=function(t){if(this.TrainDataCount<=0)return!1;var e=1;t&&t.Step>1&&(e=t.Step);for(var a=0,i=0;i<e;++i){var r=this.TrainInfo.End.Index+1;if(r>=this.KLineSourceData.Data.length)break;var n=this.KLineSourceData.Data[r];if(this.SourceData.Data.push(n),this.TrainInfo.End.Index=r,this.TrainInfo.End.Date=n.Date,this.TrainInfo.End.Time=n.Time,--this.TrainDataCount,++a,this.TrainDataCount<=0)break}if(0==a)return!1;var s=this.Frame.GetCurrentPageSize();return ha.IsNumber(s)&&(this.PageSize=s-this.RightSpaceCount),t&&t.PageSize>0&&(this.PageSize=t.PageSize),this.Update(),this.TrainDataCount<=0?(this.FinishTrainData(),this.UpdateTrainUICallback("ç»æ"),!1):(this.UpdateTrainUICallback("è®­ç»ä¸­"),!0)},this.UpdateTrainUICallback=function(t){if(this.mapEvent.has(G.RECV_TRAIN_MOVE_STEP)){var e=this.mapEvent.get(G.RECV_TRAIN_MOVE_STEP);if(e.Callback){var a={TrainDataCount:this.TrainDataCount,BuySellData:this.BuySellData,KLine:{Start:{Index:this.TrainInfo.Start.Index,Date:this.TrainInfo.Start.Date},End:{Index:this.TrainInfo.End.Index,Date:this.TrainInfo.End.Date}},LastData:this.TrainInfo.LastData,LastShowData:this.TrainInfo.LastShowData};ha.IsNumber(this.TrainInfo.Start.Time)&&(a.KLine.Start.Time=this.TrainInfo.Start.Time),ha.IsNumber(this.TrainInfo.End.Time)&&(a.KLine.End.Time=this.TrainInfo.End.Time),t&&(a.Description=t),this.TrainDataCount<=0&&(a.Symbol=this.Symbol,a.Name=this.Name),e.Callback(e,a,this)}}},this.FinishTrainData=function(){w.Chart.Log("[KLineTrainChartContainer::FinishTrainData] trian end ")},this.Stop=function(){null!=this.AutoRunTimer&&clearInterval(this.AutoRunTimer),this.AutoRunTimer=null},this.BuyOrSell=function(t,e){var a=this.TrainInfo.LastShowData;if(!a)return!1;var i=this.ChartPaintEx[0];if(!i)return!1;var r=this.ChartPaint[0].Data;if(!r||r.Data.length<=0)return!1;var n=r.Data.length-1,s={Date:this.TrainInfo.End.Date,Time:this.TrainInfo.End.Time,Price:t.Price,Vol:t.Vol,Op:0,ID:t.ID};1==t.Op&&(s.Op=1);var o=n;s.Key=o,this.BuySellData.push(s),i.AddTradeItem(s),1==e&&this.Draw()},this.RestartTrain=function(t){w.Chart.Log("[KLineTrainChartContainer::RestartTrain] option ",t),this.TrainInfo={Start:{},End:{}},this.BuySellData=[],this.KLineSourceData=null;var e=this.ChartPaintEx[0];e&&(e.Data=null,e.ClearTradeData()),t.Symbol&&(this.Symbol=t.Symbol),ha.IsNumber(t.Period)&&(this.Period=t.Period),ha.IsNumber(t.Right)&&(this.Right=t.Right),t.Train&&(t.Train.DataCount>1&&(this.TrainDataCount=t.Train.DataCount),t.Train.DateTime&&(this.TrainStartDate=t.Train.DateTime));var a=this.Symbol;this.ChangeSymbol(a)},this.RecvFlowCapitalData=function(t){if(t.stock&&1==t.stock.length){var e=t.stock[0],a=new Array;for(var i in e.stockday){var r=e.stockday[i],n=new Et;n.Date=r.date;var s=r.capital;s&&(s.a>0&&(n.Value=s.a,a.push(n)))}if(Ot.IsMinutePeriod(this.Period,!0)){var o=this.SourceData.GetMinuteFittingFinanceData(a);for(var h in this.SourceData.Data){r=this.SourceData.Data[h];o[h]&&(r.FlowCapital=o[h].Value)}var l=this.ChartPaint[0].Data,u=new Ot;if(u.Data=this.SourceData.Data,Ot.IsMinutePeriod(l.Period,!1)){var C=u.GetPeriodData(l.Period);u.Data=C}l.Data=u.Data;o=this.KLineSourceData.GetMinuteFittingFinanceData(a);for(var D in this.KLineSourceData.Data){r=this.KLineSourceData.Data[D];o[D]&&(r.FlowCapital=o[D].Value)}}else{o=this.SourceData.GetFittingFinanceData(a);for(var f in this.SourceData.Data){r=this.SourceData.Data[f];o[f]&&(r.FlowCapital=o[f].Value)}l=this.ChartPaint[0].Data,u=new Ot;if(u.Data=this.SourceData.Data,l.Right>0){var c=u.GetRightData(l.Right,{AlgorithmType:this.RightFormula});u.Data=c}if(Ot.IsDayPeriod(l.Period,!1)){C=u.GetPeriodData(l.Period);u.Data=C}l.Data=u.Data;o=this.KLineSourceData.GetFittingFinanceData(a);for(var d in this.KLineSourceData.Data){r=this.KLineSourceData.Data[d];o[d]&&(r.FlowCapital=o[d].Value)}}this.FlowCapitalReady=!0;var m=!1;for(var v in this.ExtendChartPaint){r=this.ExtendChartPaint[v];if("StockChip"==r.ClassName){m=!0;break}}m&&this.Draw()}},this.AutoUpdate()}function Xi(t,e){this.newMethod=_i,this.newMethod(t,e),delete this.newMethod,this.IsHScreen=e,this.IsZoomLockRight=!0,this.RightSpaceCount=0,this.RecvFlowCapitalData=function(t){this.Super_RecvFlowCapitalData(t)},this.BeforeBindMainData=function(t){},this.UpdateLastDataIcon=function(){if(this.ChartPaintEx[0]){var t=this.ChartPaintEx[0];t.LastDataIndex=this.TrainInfo.End.Index}},this.AfterBindMainData=function(t){if(this.ChartPaintEx[0]||(this.CreateBuySellPaint(),this.ChartPaintEx[0].LastDataDrawType=1),"Update"!=t){var e=this.ChartOperator_Temp_GetHistroyData();if(!e)return!1;var a=e.Data.length,i=a-this.TrainDataCount-20,r=this.Frame.SubFrame[0].Frame.XPointCount,n=this.GetKDataIndexByDateTime(e.Data,this.TrainStartDate);n>=0&&(i=n+1,a-i<this.TrainDataCount&&(this.TrainDataCount=a-i));var s=i-r;e.DataOffset=s;var o=i-1,h=e.Data[o];this.TrainInfo.LastShowData=h,this.TrainInfo.LastData=h,this.TrainInfo.Start.Index=o,this.TrainInfo.Start.Date=h.Date,this.TrainInfo.Start.Time=h.Time,this.TrainInfo.End.Index=o,this.TrainInfo.End.Date=h.Date,this.TrainInfo.End.Time=h.Time,this.UpdateLastDataIcon(),this.UpdateTrainUICallback("å¼å§")}},this.Super_UpdataDataoffset=this.UpdataDataoffset,this.UpdataDataoffset=function(){this.Super_UpdataDataoffset();var t=this.ChartPaint[0].Data;this.ChartPaintEx[0].Data=t},this.MoveNextKLineData=function(t){if(this.TrainDataCount<=0)return!1;var e=this.ChartOperator_Temp_GetHistroyData();if(!e)return!1;var a=1;t&&t.Step>1&&(a=t.Step);for(var i=e.Data.length,r=0,n=0;n<a;++n){var s=this.TrainInfo.End.Index+1;if(s>=i)break;var o=e.Data[s];if(this.TrainInfo.End.Index=s,this.TrainInfo.End.Date=o.Date,this.TrainInfo.End.Time=o.Time,--this.TrainDataCount,++r,this.TrainDataCount<=0)break}if(0==r)return!1;this.TrainInfo.LastShowData=o,this.TrainInfo.LastData=o;var h=this.TrainInfo.End.Index,l=this.Frame.SubFrame[0].Frame.XPointCount,u=h-l+1;return e.DataOffset=u,this.UpdateLastDataIcon(),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw(),this.TrainDataCount<=0?(this.FinishTrainData(),this.UpdateTrainUICallback("ç»æ"),!1):(this.UpdateTrainUICallback("è®­ç»ä¸­"),!0)},this.BuyOrSell=function(t,e){var a=this.TrainInfo.LastShowData;if(!a)return!1;var i=this.ChartPaintEx[0];if(!i)return!1;var r=this.ChartPaint[0].Data;if(!r||r.Data.length<=0)return!1;var n=this.TrainInfo.End.Index,s={Date:this.TrainInfo.End.Date,Time:this.TrainInfo.End.Time,Price:t.Price,Vol:t.Vol,Op:0,ID:t.ID};1==t.Op&&(s.Op=1);var o=n;s.Key=o,this.BuySellData.push(s),i.AddTradeItem(s),1==e&&this.Draw()},this.DataMove=function(t,e){var a=this.GetMoveOneStepWidth(),i=t;if(t=parseInt(t/a),t<=0)return!1;var r=this.ChartOperator_Temp_GetHistroyData();if(!r)return!1;var n=0;if(n=this.Frame.XPointCount?this.Frame.XPointCount:this.Frame.SubFrame[0].Frame.XPointCount,!n)return!1;if(this.Frame.SubFrame&&this.Frame.SubFrame.length>0&&this.Frame.SubFrame[0].Frame){var s=this.Frame.SubFrame[0].Frame;(s.DataWidth<=1||s.DistanceWidth<=1)&&ha.IsPlusNumber(this.StepPixel)&&(t=i*this.StepPixel)}if(e){if(this.RightSpaceCount>0){if(n+r.DataOffset>=r.Data.length+this.RightSpaceCount-1)return!1;r.DataOffset+=t,r.DataOffset+n>=r.Data.length+this.RightSpaceCount&&(r.DataOffset=r.Data.length-(n-this.RightSpaceCount))}else{var o=this.TrainInfo.End.Index+1;if(n+r.DataOffset>=o)return!1;r.DataOffset+=t,r.DataOffset+n>=o&&(r.DataOffset=o-n)}return!0}return!(r.DataOffset<=0)&&(r.DataOffset-=t,r.DataOffset<0&&(r.DataOffset=0),!0)},this.DataMoveRight=function(){var t=this.ChartOperator_Temp_GetHistroyData();if(!t)return!1;var e=0;if(e=this.Frame.XPointCount?this.Frame.XPointCount:this.Frame.SubFrame[0].Frame.XPointCount,!e)return!1;var a=this.TrainInfo.End.Index+1;return!(e+t.DataOffset>=a)&&(++t.DataOffset,!0)}}function Wi(t){this.newMethod=Gi,this.newMethod(t),delete this.newMethod,this.ClassName="KLineChartHScreenContainer",this.OnMouseMove=function(t,e,a,i){this.LastPoint.X=t,this.LastPoint.Y=e,this.CursorIndex=this.Frame.GetXData(e);var r={ParentFunction:"OnMouseMove",Point:{X:t,Y:e},IsPhone:!0===i};this.DrawDynamicInfo(r)},t.onmousedown=function(e){if(this.JSChartContainer&&0!=this.JSChartContainer.DragMode){var a=U();if(this.JSChartContainer.TryClickLock){var i=(e.clientX-this.getBoundingClientRect().left)*a,r=(e.clientY-this.getBoundingClientRect().top)*a;if(this.JSChartContainer.TryClickLock(i,r))return}var n={Click:{},LastMove:{}};n.Click.X=e.clientX,n.Click.Y=e.clientY,n.LastMove.X=e.clientX,n.LastMove.Y=e.clientY,this.JSChartContainer.MouseDrag=n,document.JSChartContainer=this.JSChartContainer,this.JSChartContainer.SelectChartDrawPicture=null,t.ondblclick=function(t){var e=t.clientX-this.getBoundingClientRect().left,a=t.clientY-this.getBoundingClientRect().top;this.JSChartContainer&&this.JSChartContainer.OnDoubleClick(e,a,t)},document.onmousemove=function(t){if(this.JSChartContainer&&(!this.JSChartContainer.ChartSplashPaint||1!=this.JSChartContainer.ChartSplashPaint.IsEnableSplash)){var e=this.JSChartContainer.MouseDrag;if(e){var a=Math.abs(e.LastMove.Y-t.clientY);if(1==this.JSChartContainer.DragMode){if(a<5)return;var i=this.JSChartContainer.GetMoveOneStepWidth();if(a<i)return;var r=!0;e.LastMove.Y<t.clientY&&(r=!1),this.JSChartContainer.DataMove(a,r)&&(this.JSChartContainer.UpdataDataoffset(),this.JSChartContainer.UpdatePointByCursorIndex(),this.JSChartContainer.UpdateFrameMaxMin(),this.JSChartContainer.ResetFrameXYSplit(),this.JSChartContainer.Draw()),e.LastMove.X=t.clientX,e.LastMove.Y=t.clientY}}}},document.onmouseup=function(t){document.onmousemove=null,document.onmouseup=null,this.JSChartContainer.MouseDrag=null,this.JSChartContainer.CurrentChartDrawPicture=null,this.JSChartContainer=null}}},this.OnTouchStart=function(e){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){this.PhonePinch=null,this.IsOnTouch=!0,this.TouchDrawCount=0,this.StopDragTimer();var a=this.IsSingleTouch(e);if(e.cancelable&&e.preventDefault(),this.IsPhoneDragging(e)){var i=this.GetToucheData(e,!1),r=this.PointAbsoluteToRelative(i[0].clientX,i[0].clientY,!0);if(this.TryClickLock||this.TryClickIndexTitle){var n=r.X,s=r.Y;if(this.TryClickLock&&this.TryClickLock(n,s))return;if(this.TryClickIndexTitle&&this.TryClickIndexTitle(n,s))return}if(this.ClickFrameButton){var o=this.Frame.PtInButtons(r.X,r.Y);if(o)return void this.ClickFrameButton(o,e)}var h=!0;this.ChartDrawOption.IsLockScreen?h=!1:this.DragMode==Y.CLICK_TOUCH_MODE_ID?1==this.TouchStatus.CorssCursorShow&&(h=!1):this.DragMode==Y.DISABLE_DRAG_ID?h=!1:a||(h=!1);var l={Click:{},LastMove:{}};if(l.Click.X=i[0].clientX,l.Click.Y=i[0].clientY,l.LastMove.X=i[0].clientX,l.LastMove.Y=i[0].clientY,this.MouseDrag=l,this.PhoneTouchInfo={Start:{X:i[0].clientX,Y:i[0].clientY},End:{X:i[0].clientX,Y:i[0].clientY}},this.SelectChartDrawPicture&&(this.SelectChartDrawPicture.IsSelected=!1),this.SelectChartDrawPicture=null,this.CurrentChartDrawPicture){var u=this.CurrentChartDrawPicture;return 2==u.Status?this.SetChartDrawPictureThirdPoint(l.Click.X,l.Click.Y,!0):(this.SetChartDrawPictureFirstPoint(l.Click.X,l.Click.Y,!0),this.FinishChartDrawPicturePoint()&&this.DrawDynamicInfo({Corss:!1,Tooltip:!1})),void(e.cancelable&&e.preventDefault())}var C={};U();if(C.X=i[0].clientX-t.getBoundingClientRect().left,C.Y=i[0].clientY-t.getBoundingClientRect().top,this.GetChartDrawPictureByPoint(C)){C.ChartDrawPicture.Status=20,C.ChartDrawPicture.ValueToPoint(),C.ChartDrawPicture.MovePointIndex=C.PointIndex,C.ChartDrawPicture.IsSelected=!0,this.CurrentChartDrawPicture=C.ChartDrawPicture,this.SelectChartDrawPicture=C.ChartDrawPicture;var D=this.GetEventCallback(G.ON_CLICK_DRAWPICTURE);if(D&&D.Callback){var f={DrawPicture:C.ChartDrawPicture};D.Callback(D,f,this)}return void(e.cancelable&&e.preventDefault())}if(h){var c=this;this.DragTimer=setTimeout((function(){if(l.Click.X==l.LastMove.X&&l.Click.Y==l.LastMove.Y){c.MouseDrag;c.MouseDrag=null,c.MoveCorssCursor(l.Click,e)}}),c.PressTime)}this.ChartDrawOption.IsLockScreen?this.MouseDrag=null:this.DragMode==Y.CLICK_TOUCH_MODE_ID||(this.DragMode==Y.DISABLE_DRAG_ID?(this.MouseDrag=null,this.MoveCorssCursor(l.Click,e)):this.IsClickShowCorssCursor&&this.MoveCorssCursor(l.Click,e))}else if(this.IsPhonePinching(e)){var d={Start:{},Last:{}};i=this.GetToucheData(e,!1);d.Start={X:i[0].pageX,Y:i[0].pageY,X2:i[1].pageX,Y2:i[1].pageY},d.Last={X:i[0].pageX,Y:i[0].pageY,X2:i[1].pageX,Y2:i[1].pageY},this.PhonePinch=d,this.SelectChartDrawPicture=null}this.TouchEvent({EventID:G.ON_PHONE_TOUCH,FunctionName:"OnTouchStart"},e)}},this.OnTouchMove=function(t){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){t.cancelable&&t.preventDefault();var e=this.GetToucheData(t,!1);if(this.IsPhoneDragging(t)){var a=this.MouseDrag;if(null==a)this.ChartDrawOption.IsLockScreen||this.MoveCorssCursor({X:e[0].clientX,Y:e[0].clientY},t);else{var i=Math.abs(a.LastMove.Y-e[0].clientY),r=Math.abs(a.LastMove.X-e[0].clientX),n=this.DragMode==Y.CLICK_TOUCH_MODE_ID&&1==this.TouchStatus.CorssCursorShow;if(this.CurrentChartDrawPicture){var s=this.CurrentChartDrawPicture;if(1==s.Status||2==s.Status){if(i<5&&r<5)return;this.SetChartDrawPictureSecondPoint(e[0].clientX,e[0].clientY,!0)&&this.DrawDynamicInfo()}else if(3==s.Status)this.SetChartDrawPictureThirdPoint(e[0].clientX,e[0].clientY,!0)&&this.DrawDynamicInfo();else if(20==s.Status){if(i<5&&r<5)return;this.MoveChartDrawPicture(e[0].clientX-a.LastMove.X,e[0].clientY-a.LastMove.Y,!0)&&this.DrawDynamicInfo()}a.LastMove.X=e[0].clientX,a.LastMove.Y=e[0].clientY}else if(n){this.MouseDrag;this.MouseDrag=null,this.MoveCorssCursor(a.Click,t)}else if(1==this.DragMode||0==n){if(i<5)return;var o=this.GetMoveOneStepWidth();if(i<o)return;var h=!0;a.LastMove.Y<e[0].clientY&&(h=!1),this.DataMove(i,h)?(this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.ResetFrameXYSplit(),this.Draw(),this.OnKLinePageChange("OnTouchMove")):this.DragDownloadData&&this.DragDownloadData(),a.LastMove.X=e[0].clientX,a.LastMove.Y=e[0].clientY}}this.PhoneTouchInfo&&(this.PhoneTouchInfo.End.X=e[0].clientX,this.PhoneTouchInfo.End.Y=e[0].clientY)}else if(this.IsPhonePinching(t)){if(this.DragMode==Y.DISABLE_DRAG_ID)return;var l=this.PhonePinch;if(!l)return;var u=Math.abs(e[0].pageX-e[1].pageX),C=Math.abs(l.Last.X-l.Last.X2),D=u-C;if(Math.abs(D)<5)return;if(D>0){var f={};if(f.Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),!this.Frame.ZoomUp(f))return;this.CursorIndex=f.Index,this.UpdatePointByCursorIndex(),this.UpdataDataoffset(),this.UpdateFrameMaxMin(),this.Draw(),this.ShowTooltipByKeyDown(),this.OnKLinePageChange("OnTouchMove")}else{f={};if(f.Index=parseInt(Math.abs(this.CursorIndex-.5).toFixed(0)),!this.Frame.ZoomDown(f))return;this.CursorIndex=f.Index,this.UpdataDataoffset(),this.UpdatePointByCursorIndex(),this.UpdateFrameMaxMin(),this.Draw(),this.ShowTooltipByKeyDown(),this.OnKLinePageChange("OnTouchMove")}l.Last={X:e[0].pageX,Y:e[0].pageY,X2:e[1].pageX,Y2:e[1].pageY}}}},this.OnTouchEnd=function(t){if(w.Chart.Log("[KLineChartHScreenContainer:OnTouchEnd]",t),!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){if(this.CurrentChartDrawPicture){var e=this.CurrentChartDrawPicture;2==e.Status||1==e.Status||3==e.Status?(e.PointStatus=e.Status,this.FinishChartDrawPicturePoint()?this.DrawDynamicInfo():!1):20==e.Status&&this.FinishMoveChartDrawPicture()&&this.DrawDynamicInfo()}this.IsOnTouch=!1,this.StopDragTimer(),this.TouchEvent({EventID:G.ON_PHONE_TOUCH,FunctionName:"OnTouchEnd"},t),this.OnTouchFinished(),this.TouchDrawCount=0}},this.Create=function(t){var e=this;for(var a in this.UIElement.JSChartContainer=this,this.ChartCorssCursor=new va,this.ChartCorssCursor.Canvas=this.Canvas,this.ChartCorssCursor.StringFormatX=Ra.Create("CorssCursor_XStringFormat"),this.ChartCorssCursor.StringFormatX.LanguageID=this.LanguageID,this.ChartCorssCursor.StringFormatY=Ra.Create("CorssCursor_YStringFormat"),this.ChartCorssCursor.StringFormatY.LanguageID=this.LanguageID,this.ChartCorssCursor.StringFormatY.ExtendChartPaint=this.ExtendChartPaint,this.ChartSplashPaint=new Ia,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.HQChart=this,this.Frame=new pt,this.Frame.ChartBorder=new nt,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartCorssCursor.Frame=this.Frame,this.ChartSplashPaint.Frame=this.Frame,this.CreateChildWindow(t),this.CreateMainKLine(),this.Frame.SubFrame){var i=new Ya;i.Frame=this.Frame.SubFrame[a].Frame,i.Canvas=this.Canvas,i.LanguageID=this.LanguageID,i.GetEventCallback=function(t){return e.GetEventCallback(t)},i.SelectedChart=this.SelectedChart,this.TitlePaint.push(i)}this.UIElement.addEventListener("keydown",J,!0)},this.CreateChildWindow=function(t){for(var e=this,a=0;a<t;++a){var i=new nt;i.UIElement=this.UIElement;var r=new dt;if(r.Canvas=this.Canvas,r.ChartBorder=i,r.Identify=a,r.RightSpaceCount=this.RightSpaceCount,this.ModifyIndexDialog&&(r.ModifyIndexEvent=this.ModifyIndexDialog.DoModal),this.ChangeIndexDialog&&(r.ChangeIndexEvent=this.ChangeIndexDialog.DoModal),r.HorizontalMax=20,r.HorizontalMin=10,0==a){r.YSplitOperator=new la,r.YSplitOperator.FrameSplitData=this.FrameSplitData.get("price"),r.YSplitOperator.FrameSplitData2=this.FrameSplitData.get("double"),r.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)};var n=U();i.TopSpace=12*n,i.BottomSpace=12*n}else r.YSplitOperator=new ua,r.YSplitOperator.LanguageID=this.LanguageID,r.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double");r.YSplitOperator.Frame=r,r.YSplitOperator.ChartBorder=i,r.XSplitOperator=new Ca,r.XSplitOperator.Frame=r,r.XSplitOperator.ChartBorder=i,r.XSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},a!=t-1&&(r.XSplitOperator.ShowText=!1);for(var s=r.HorizontalMin;s<=r.HorizontalMax;s+=1)r.HorizontalInfo[s]=new rt,r.HorizontalInfo[s].Value=s,0==a&&s==r.HorizontalMin||(r.HorizontalInfo[s].Message[1]=s.toString(),r.HorizontalInfo[s].Font="14px å¾®è½¯éé»");var o=new vt;o.Frame=r,o.Height=0==a?20:10,this.Frame.SubFrame[a]=o}}}function Ui(t){this.newMethod=Hi,this.newMethod(t),delete this.newMethod,this.ClassName="MinuteChartHScreenContainer",this.OnMouseMove=function(t,e,a,i){this.LastPoint.X=t,this.LastPoint.Y=e,this.CursorIndex=this.Frame.GetXData(e);var r=this.PtInClient(t,e),n={ParentFunction:"OnMouseMove",Point:{X:t,Y:e},IsPhone:!0===i,ClientPos:r};this.DrawDynamicInfo(n)},this.Create=function(t){var e=this;for(var a in this.UIElement.JSChartContainer=this,this.ChartCorssCursor=new va,this.ChartCorssCursor.Canvas=this.Canvas,this.ChartCorssCursor.StringFormatX=new Fa,this.ChartCorssCursor.StringFormatY=new ga,this.ChartCorssCursor.CallAcutionXOperator=new ma,this.ChartSplashPaint=new Ia,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.HQChart=this,this.Frame=new pt,this.Frame.ChartBorder=new nt,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=25,this.Frame.ChartBorder.Left=50,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartCorssCursor.Frame=this.Frame,this.ChartSplashPaint.Frame=this.Frame,this.CreateChildWindow(t),this.CreateMainKLine(),this.Frame.SubFrame){var i=new Ya;i.Frame=this.Frame.SubFrame[a].Frame,i.Canvas=this.Canvas,i.LanguageID=this.LanguageID,i.GetEventCallback=function(t){return e.GetEventCallback(t)},i.SelectedChart=this.SelectedChart,this.TitlePaint.push(i)}this.ChartCorssCursor.StringFormatX.Frame=this.Frame.SubFrame[0].Frame,this.ChartCorssCursor.StringFormatY.Frame=this.Frame,this.ChartCorssCursor.CallAcutionXOperator.Frame=this.Frame.SubFrame[0].Frame,this.UIElement.addEventListener("keydown",J,!0)},this.CreateChildWindow=function(t){for(var e=this,a=0;a<t;++a){var i=new nt;i.UIElement=this.UIElement;var r=new ut;r.Canvas=this.Canvas,r.ChartBorder=i,r.Identify=a,a<2&&(r.ChartBorder.TitleHeight=0),r.XPointCount=243;var n=[9,8,7,6,5,4,3,2,1];for(var s in r.HorizontalMax=n[0],r.HorizontalMin=n[n.length-1],0==a?(r.YSplitOperator=new Da,r.YSplitOperator.FrameSplitData=this.FrameSplitData.get("price"),r.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)}):(r.YSplitOperator=new ua,r.YSplitOperator.LanguageID=this.LanguageID,r.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),r.YSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)}),r.YSplitOperator.Frame=r,r.YSplitOperator.ChartBorder=i,r.XSplitOperator=new fa,r.XSplitOperator.Frame=r,r.XSplitOperator.ChartBorder=i,r.XSplitOperator.GetEventCallback=function(t){return e.GetEventCallback(t)},a!=t-1&&(r.XSplitOperator.ShowText=!1),r.XSplitOperator.Operator(),n)r.HorizontalInfo[s]=new rt,r.HorizontalInfo[s].Value=n[s],0==a&&s==r.HorizontalMin||(r.HorizontalInfo[s].Message[1]=n[s].toString(),r.HorizontalInfo[s].Font="14px å¾®è½¯éé»");var o=new vt;o.Frame=r,o.Height=0==a?20:10,this.Frame.SubFrame[a]=o}}}function Ki(t){this.newMethod=W,this.newMethod(t),delete this.newMethod,this.ClassName="DepthChartContainer",this.Symbol,this.MapAsk=new E.default,this.MapBid=new E.default,this.IsAutoUpdate=!1,this.AutoUpdateFrequency=3e4,this.AutoUpdateTimer,this.DefaultZoom=.8,this.MaxVolRate=1.1,this.Create=function(t){var e=this;this.UIElement.JSChartContainer=this,this.ChartCorssCursor=new Sa,this.ChartCorssCursor.Canvas=this.Canvas,this.ChartCorssCursor.HQChart=this,this.ChartSplashPaint=new Ia,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.Frame=new Tt,this.Frame.ChartBorder=new nt,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.ChartBorder.TitleHeight=0,this.Frame.Canvas=this.Canvas;var a=new ua;a.FrameSplitData=this.FrameSplitData.get("double"),a.LanguageID=this.LanguageID,a.Frame=this.Frame,a.SplitCount=5,a.LineType=3,a.IgnoreYValue=[0],a.ChartBorder=this.Frame.ChartBorder,this.Frame.YSplitOperator=a;var i=new da;i.Frame=this.Frame,i.ChartBorder=this.Frame.ChartBorder,i.LanguageID=this.LanguageID,i.LineType=3,this.Frame.XSplitOperator=i,this.ChartCorssCursor&&(this.ChartCorssCursor.Frame=this.Frame),this.ChartSplashPaint.Frame=this.Frame;var r=new ke;r.Canvas=this.Canvas,r.ChartBorder=this.Frame.ChartBorder,r.ChartFrame=this.Frame,r.Name="æ·±åº¦å¾",this.ChartPaint.push(r);var n=!0,s=!0;t&&!1===t.Wheel&&(s=!1,w.Chart.Log("[DepthChartContainer::Create] not register wheel event.")),n&&this.UIElement.addEventListener("keydown",(function(t){e.OnKeyDown(t)}),!0),s&&this.UIElement.addEventListener("wheel",(function(t){e.OnWheel(t)}),!0)},this.OnWheel=function(t){w.Chart.Log("[KLineChartContainer::OnWheel]",t);var e=t.clientX-this.UIElement.getBoundingClientRect().left,a=t.clientY-this.UIElement.getBoundingClientRect().top,i=!1;this.Canvas.beginPath(),this.Canvas.rect(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetTop(),this.Frame.ChartBorder.GetWidth(),this.Frame.ChartBorder.GetHeight()),i=this.Canvas.isPointInPath(e,a);var r=t.wheelDelta;ha.IsObjectExist(t.wheelDelta)||(r=-.01*t.deltaY);var n=!0;this.EnableZoomUpDown&&!1===this.EnableZoomUpDown.Wheel&&(n=!1),i&&r<0&&n?this.Frame.ZoomDown()&&(this.UpdateFrameMaxMin(),this.Draw()):i&&r>0&&n&&this.Frame.ZoomUp()&&(this.UpdateFrameMaxMin(),this.Draw()),t.preventDefault?t.preventDefault():t.returnValue=!1},this.UIOnMouseDown=function(t){},this.OnTouchStart=function(t){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){this.IsOnTouch=!0,this.TouchDrawCount=0,this.PhonePinch=null;var e=this.IsSingleTouch(t);if(0!=this.EnableScrollUpDown&&e||t.cancelable&&t.preventDefault(),this.IsPhoneDragging(t)){var a={Click:{},LastMove:{}},i=this.GetToucheData(t,this.IsForceLandscape);a.Click.X=i[0].clientX,a.Click.Y=i[0].clientY,a.LastMove.X=i[0].clientX,a.LastMove.Y=i[0].clientY,this.MouseDrag=a,this.MoveCorssCursor(a.Click,t)}else if(this.IsPhonePinching(t)){var r={Start:{},Last:{}};i=this.GetToucheData(t,this.IsForceLandscape);r.Start={X:i[0].pageX,Y:i[0].pageY,X2:i[1].pageX,Y2:i[1].pageY},r.Last={X:i[0].pageX,Y:i[0].pageY,X2:i[1].pageX,Y2:i[1].pageY},this.PhonePinch=r}}},this.OnTouchMove=function(e){var a=this.GetToucheData(e,!1);if(this.IsPhoneDragging(e)){var i=this.MouseDrag;if(null==i){var r=U(),n=a[0].clientX-t.getBoundingClientRect().left*r,s=a[0].clientY-t.getBoundingClientRect().top*r;this.OnMouseMove(n,s,e)}else{var o=this.GetMoveAngle(i.LastMove,{X:a[0].clientX,Y:a[0].clientY}),h=Math.abs(i.LastMove.X-a[0].clientX),l=Math.abs(i.LastMove.Y-a[0].clientY);if(h=parseInt(h),(l>0&&h<=3||o<=this.TouchMoveMinAngle)&&1==this.EnableScrollUpDown)return;this.PreventTouchEvent(e),this.MouseDrag=null;r=U(),n=a[0].clientX-t.getBoundingClientRect().left*r,s=a[0].clientY-t.getBoundingClientRect().top*r;this.OnMouseMove(n,s,e)}}else if(this.IsPhonePinching(e)){this.PreventTouchEvent(e);var u=this.PhonePinch;if(!u)return;if(this.EnableZoomUpDown&&!1===this.EnableZoomUpDown.Touch)return;var C=Math.abs(a[0].pageY-a[1].pageY),D=Math.abs(u.Last.Y-u.Last.Y2),f=C-D,c=Math.abs(a[0].pageX-a[1].pageX),d=Math.abs(u.Last.X-u.Last.X2),m=c-d,v=this.ZoomStepPixel;if(Math.abs(f)<v&&Math.abs(m)<v)return;var S=f;if(Math.abs(f)<v&&(S=m),S>0){if(!this.Frame.ZoomUp())return;this.UpdateFrameMaxMin(),this.Draw()}else{if(!this.Frame.ZoomDown())return;this.UpdateFrameMaxMin(),this.Draw()}u.Last={X:a[0].pageX,Y:a[0].pageY,X2:a[1].pageX,Y2:a[1].pageY}}this.PreventTouchEvent(e)},this.OnTouchEnd=function(t){w.Chart.Log("[DepthChartContainer::OnTouchEnd]",t),this.IsOnTouch=!1,this.OnTouchFinished(),this.TouchDrawCount=0},this.OnTouchFinished=function(){!0!==this.CorssCursorTouchEnd||this.DrawDynamicInfo()},this.ChangeSymbol=function(t){this.CancelAutoUpdate(),this.Symbol=t,this.MapBid=new E.default,this.MapAsk=new E.default,this.Frame.VerticalRange.Differ=null,this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.EnableSplash(!0),this.Draw(),this.RequestDepthData()},this.RequestDepthData=function(){var t=this;if(this.NetworkFilter){var e={Name:"DepthChartContainer::RequestDepthData",Explain:"æ·±åº¦å¾æ°æ®",Request:{Data:{symbol:t.Symbol}},Self:this,PreventDefault:!1};if(this.NetworkFilter(e,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvDepthData(e),t.AutoUpdate()})),1==e.PreventDefault)return}},this.RecvDepthData=function(t){this.UpdateAskAndBid(t);var e=(0,f.default)(this.MapAsk.values());e.sort((function(t,e){return t.Price-e.Price}));var a=0;for(var i in e){var r=e[i];a+=r.Vol,e[i]={Price:r.Price,Vol:a}}var n=(0,f.default)(this.MapBid.values());n.sort((function(t,e){return e.Price-t.Price}));a=0;for(var i in n){r=n[i];a+=r.Vol,n[i]={Price:r.Price,Vol:a}}var s={Asks:e,Bids:n},o=this.ChartPaint[0];o.Data=s,this.Frame.XSplitOperator.Symbol=this.Symbol,this.ChartCorssCursor.Data=s,this.ChartCorssCursor.Symbol=this.Symbol,this.UpdateFramePriceList(),this.UpdateFrameMaxMin(),this.Draw()},this.UpdateAskAndBid=function(t){for(var e in"snapshot"==t.datatype&&(this.MapBid=new E.default,this.MapAsk=new E.default),t.asks){var a=t.asks[e],i=parseFloat(a[0]),r=parseFloat(a[1]);if(this.MapAsk.has(i)){var n=this.MapAsk.get(i);r<=0?this.MapAsk.delete(i):n.Vol=r}else r>0&&this.MapAsk.set(i,{Price:i,Vol:r})}for(var e in t.bids){a=t.bids[e],i=parseFloat(a[0]),r=parseFloat(a[1]);if(this.MapBid.has(i)){n=this.MapBid.get(i);r<=0?this.MapBid.delete(i):n.Vol=r}else r>0&&this.MapBid.set(i,{Price:i,Vol:r})}},this.UpdateFramePriceList=function(){var t=(0,f.default)(this.MapAsk.keys()),e=(0,f.default)(this.MapBid.keys());t.sort((function(t,e){return t-e})),e.sort((function(t,e){return t-e}));var a={Max:88,Min:8};if(t.length>1&&e.length>1){var i=t[0],r=t[t.length-1],n=e[0],s=e[e.length-1],o=r-i,h=s-n,l=Math.max(o,h),u={Min:i,Max:i+l},C={Max:s,Min:s-l};a={Max:u.Max,Min:C.Min}}this.Frame.SetPriceList(t,e);var D=this.Frame.VerticalRange;D.Max=a.Max,D.Center=a.Min+(a.Max-a.Min)/2,D.Min=a.Min,D.MaxDiffer=l,D.Ask=u,D.Bid=C,ha.IsNumber(D.Differ)||(D.Differ=l*this.DefaultZoom),D.Min=D.Center-D.Differ,D.Max=D.Center+D.Differ},this.UpdateFrameMaxMin=function(){var t=this.ChartPaint[0].GetMaxMin();this.Frame.HorizontalMax=t.Max*this.MaxVolRate,this.Frame.HorizontalMin=0,this.Frame.XYSplit=!0},this.CancelAutoUpdate=function(){"number"==typeof this.AutoUpdateTimer&&(clearTimeout(this.AutoUpdateTimer),this.AutoUpdateTimer=void 0)},this.StopAutoUpdate=function(){this.CancelAutoUpdate(),this.IsAutoUpdate&&(this.IsAutoUpdate=!1)},this.AutoUpdate=function(){if(this.CancelAutoUpdate(),this.IsAutoUpdate&&this.Symbol){var t=this,e=Br.GetMarketStatus(this.Symbol);if(0!=e&&3!=e){var a=this.AutoUpdateFrequency;1==e?this.AutoUpdateTimer=setTimeout((function(){t.AutoUpdate()}),a):2==e&&(this.AutoUpdateTimer=setTimeout((function(){t.RequestDepthData()}),a))}}}}function Ji(t){this.newMethod=W,this.newMethod(t),delete this.newMethod,this.MainDataControl,this.Create=function(){this.UIElement.JSChartContainer=this,this.ChartSplashPaint=new Ia,this.ChartSplashPaint.Canvas=this.Canvas,this.Frame=new gt,this.Frame.ChartBorder=new nt,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartCorssCursor&&(this.ChartCorssCursor.Frame=this.Frame),this.ChartSplashPaint.Frame=this.Frame,this.CreateMainChart(),this.UIElement.addEventListener("keydown",J,!0)},this.SetMainDataConotrl=function(t){t&&(this.MainDataControl=t,this.ChartPaint=[],this.CreateMainChart(),this.Draw(),this.RequestData())},this.CreateMainChart=function(){if(this.MainDataControl){for(var t in this.MainDataControl.DataType){var e=this.MainDataControl.DataType[t];if("BAR"==e.Type){var a=new Te;a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.Name=e.Name,e.Color&&(a.UpBarColor=e.Color),e.Color2&&(a.DownBarColor=e.Color2),this.ChartPaint.push(a)}else if("LINE"==e.Type){a=new jt;a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.Name=e.Name,e.Color&&(a.Color=e.Color),this.ChartPaint.push(a)}}this.Frame.YSplitOperator=new ua,this.Frame.YSplitOperator.FrameSplitData=this.FrameSplitData.get("double"),this.Frame.YSplitOperator.Frame=this.Frame,this.Frame.YSplitOperator.ChartBorder=this.Frame.ChartBorder,this.Frame.XSplitOperator=new ca,this.Frame.XSplitOperator.Frame=this.Frame,this.Frame.XSplitOperator.ChartBorder=this.Frame.ChartBorder}},this.RequestData=function(){this.MainDataControl&&(this.MainDataControl.JSChartContainer=this,this.MainDataControl.RequestData())},this.UpdateMainData=function(t){var e=0;for(var a in t.Data){var i=new Ot;i.Data=t.Data[a],this.ChartPaint[a].Data=i,e<i.Data.length&&(e=i.Data.length)}this.Frame.XPointCount=e,this.Frame.Data=this.ChartPaint[0].Data,this.Frame.XData=t.XData,this.UpdateFrameMaxMin(),this.Frame.SetSizeChage(!0),this.Draw()}}function zi(t){this.Radius,this.newMethod=W,this.newMethod(t),delete this.newMethod,this.MainDataControl,this.OnMouseMove=function(t,e,a){},this.Create=function(){this.UIElement.JSChartContainer=this,this.ChartSplashPaint=new Ia,this.ChartSplashPaint.Canvas=this.Canvas,this.Frame=new ot,this.Frame.ChartBorder=new nt,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartSplashPaint.Frame=this.Frame,this.CreateMainChart()},this.SetMainDataConotrl=function(t){t&&(this.MainDataControl=t,this.ChartPaint=[],this.CreateMainChart(),this.Draw(),this.RequestData())},this.CreateMainChart=function(){if(this.MainDataControl)for(var t in this.MainDataControl.DataType){var e=this.MainDataControl.DataType[t];if("PIE"==e.Type){var a=new _e;a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.Name=e.Name,this.Radius&&(a.Radius=this.Radius),this.ChartPaint.push(a)}else if("RADAR"==e.Type){a=new Xe;a.Canvas=this.Canvas,a.ChartBorder=this.Frame.ChartBorder,a.ChartFrame=this.Frame,a.Name=e.Name,e.StartAngle&&(a.StartAngle=e.StartAngle),this.ChartPaint.push(a)}}},this.RequestData=function(){this.MainDataControl&&(this.MainDataControl.JSChartContainer=this,this.MainDataControl.RequestData())},this.UpdateMainData=function(t){for(var e in t.Data){var a=new Ot;a.Data=t.Data[e],this.ChartPaint[e].Data=a}this.Frame.SetSizeChage(!0),this.Draw()}}function qi(t){this.newMethod=W,this.newMethod(t),delete this.newMethod,this.MainDataControl,this.OnMouseMove=function(t,e,a){},this.Create=function(){this.UIElement.JSChartContainer=this,this.ChartSplashPaint=new Ia,this.ChartSplashPaint.Canvas=this.Canvas,this.Frame=new ot,this.Frame.ChartBorder=new nt,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartSplashPaint.Frame=this.Frame,this.CreateMainChart()},this.SetMainDataConotrl=function(t){t&&(this.MainDataControl=t,this.ChartPaint=[],this.CreateMainChart(),this.Draw(),this.RequestData())},this.CreateMainChart=function(){if(this.MainDataControl){var t=new We;t.Canvas=this.Canvas,t.ChartBorder=this.Frame.ChartBorder,t.ChartFrame=this.Frame,t.Name=this.MainDataControl.DataType[0].Name,this.Radius&&(t.Radius=this.Radius),this.ChartPaint.push(t)}},this.RequestData=function(){this.MainDataControl&&(this.MainDataControl.JSChartContainer=this,this.MainDataControl.RequestData())},this.UpdateMainData=function(t){this.ChartPaint[0].Data=t.Data[0],this.Frame.SetSizeChage(!0),this.Draw()}}function Zi(t,e){this.Name=t,this.Param=e,this.LineColor,this.ReqeustData=null}function Qi(t){this.Index,this.Name=t,this.Script=null,this.ClassName="BaseIndex",this.OverlayIndex=null,this.GetEventCallback,this.Status=0,this.Guid=q(),this.Create=function(t,e){},this.NotSupport=function(t,e,a){var i=this.IsOverlay();if(!i){t.DeleteIndexPaint(e);var r=t.Frame.SubFrame[e].Frame,n=new Qt;n.Canvas=t.Canvas,n.ChartBorder=r.ChartBorder,n.ChartFrame=r,n.NotSupportMessage=a,t.ChartPaint.push(n)}},this.FormatIndexTitle=function(){var t=this.Name,e=null;for(var a in this.Index){var i=this.Index[a];null!=i.Param&&(e?e+=","+i.Param.toString():e=i.Param.toString())}return e&&(t+="("+e+")"),t},this.IsOverlay=function(){return!(!this.OverlayIndex||1!=this.OverlayIndex.IsOverlay)},this.CreateChart=function(t){return new jt},this.CreatePaints=function(t,e){var a=null,i=this.IsOverlay();i?(a=this.OverlayIndex.Frame.Frame,this.OverlayIndex.Frame.ChartPaint=[]):(a=t.Frame.SubFrame[e].Frame,t.DeleteIndexPaint(e));var r=[];for(var n in this.Index){var s=this.CreateChart(n);s.Color=this.Index[n].LineColor,s.Canvas=t.Canvas,s.Name=this.Name+"-"+n.toString(),s.ChartBorder=a.ChartBorder,s.ChartFrame=a,i?this.OverlayIndex.Frame.ChartPaint.push(s):t.ChartPaint.push(s),r.push(s)}return r},this.SendEvent=function(t,e,a,i){if(t.GetIndexEvent){var r=t.GetIndexEvent();if(r){var n={Data:this.GetOutData(),WindowIndex:e,Name:this.Name,HistoryData:a,Stock:{Symbol:t.Symbol,Name:t.Name}};i&&(n.Error=i),r.Callback(r,n,self)}}},this.GetOutData=function(){return null}}function ji(){this.newMethod=Qi,this.newMethod("OX"),delete this.newMethod,this.ClassName="JSIndex_OX",this.IsUsePageData=!0,this.BlockSize=.5,this.Arguments=[{Name:"Reversal",Value:3}],this.SetArgs=function(t){if(t&&ha.IsNonEmptyArray(t))for(var e=0;e<t.length;++e){var a=t[e];"Reversal"==a.Name&&this.SetParamValue(a.Name,a.Value)}},this.SetParamValue=function(t,e){for(var a=0;a<this.Arguments.length;++a){var i=this.Arguments[a];i.Name==t&&(i.Value=e)}},this.GetParamValue=function(t){for(var e=0;e<this.Arguments.length;++e){var a=this.Arguments[e];if(a.Name==t)return a.Value}},this.RequestData=function(t,e,a){return this.BindData(t,e,a),t.UpdataDataoffset(),t.UpdateFrameMaxMin(),t.Draw(),!0},this.CreatePaints=function(t,e){var a=null,i=this.IsOverlay();i?(a=this.OverlayIndex.Frame.Frame,this.OverlayIndex.Frame.ChartPaint=[]):(a=t.Frame.SubFrame[e].Frame,t.DeleteIndexPaint(e));var r=[],n=new Be;return n.Canvas=t.Canvas,n.Name=this.Name+"-0",n.ChartBorder=a.ChartBorder,n.ChartFrame=a,i?this.OverlayIndex.Frame.ChartPaint.push(n):t.ChartPaint.push(n),r.push(n),r},this.CalculateBlockSize=function(t,e){var a=t-e;return a<=5?.25:a<=20?.5:a<=100?1:a<=200?2:a<=500?5:a<=1e3?10:50},this.Calculate=function(t,e){if(!t.ChartPaint[0])return null;var a=t.ChartPaint[0].ShowRange;if(!a)return null;if(!ha.IsNonEmptyArray(e.Data))return null;for(var i=null,r=null,n=null,s=a.Start;s<=a.End&&s<e.Data.length;++s){var o=e.Data[s];null==i?ha.IsNumber(o.High)&&(i=o.High):ha.IsNumber(o.High)&&i<o.High&&(i=o.High),null==r?ha.IsNumber(o.Low)&&(r=o.Low):ha.IsNumber(o.Low)&&r>o.Low&&(r=o.Low),null==n&&ha.IsNumber(o.High)&&(n=o.High)}var h=this.GetParamValue("Reversal"),l=this.CalculateBlockSize(i,r);this.BlockSize=l;for(var u={Max:i+l,Min:r-l,StartPrice:n,Data:[],BlockSize:l},C=1,D=n,f={Type:0,Data:[],Start:null,End:null},c=(s=a.Start,0);s<=a.End&&s<e.Data.length;++s){o=e.Data[s];if(1==C){if(o.High>=D+l){var d=parseInt((o.High-D)/l);for(c=0;c<d;++c)D+=l,f.Data.push(D)}else if(o.Low<=D-l*h){C=0,f&&ha.IsNonEmptyArray(f.Data)&&u.Data.push(f),f={Type:1,Data:[],Start:null,End:null};d=parseInt((D-o.Low)/l);for(c=0;c<d;++c)D-=l,f.Data.push(D)}}else if(o.Low<=D-l){d=parseInt((D-o.Low)/l);for(c=0;c<d;++c)D-=l,f.Data.push(D)}else if(o.High>=D+l*h){C=1,f&&ha.IsNonEmptyArray(f.Data)&&u.Data.push(f),f={Type:0,Data:[],Start:null,End:null};d=parseInt((o.High-D)/l);for(c=0;c<d;++c)D+=l,f.Data.push(D)}null==f.Start&&(f.Start=o),f.End=o}return f&&ha.IsNonEmptyArray(f.Data)&&u.Data.push(f),u},this.BindData=function(t,e,a){var i=this.CreatePaints(t,e),r=this.IsOverlay(),n=t.GetEventCallback(G.ON_CALCULATE_INDEX_OX);if(n&&n.Callback){var s={HQChart:t,WidnowIndex:e,HisData:a,OXData:null};n.Callback(n,s,this),i[0].OXData=s.OXData}else i[0].OXData=this.Calculate(t,a);var o=this.BlockSize,h=this.GetParamValue("Reversal"),l=this.Name+" BlockSize="+o+" Reversal="+h,u=e+1;if(r){var C=t.TitlePaint[u],D={Data:[],Title:""};C.OverlayIndex.set(this.OverlayIndex.Identify,D)}else t.TitlePaint[u].Title=l;return!0}}function $i(t){this.newMethod=Qi,this.newMethod("VRVR"),delete this.newMethod,this.ClassName="VolProfileVisibleRangeIndex",this.IsUsePageData=!0,this.ChartVolProfile,this.HQChart,this.WindowIndex,this.RequestTimer=null,this.DelayRequestFrequency=500,this.VolType=0,this.BarPosition=1,this.BarWidthRate=.3,this.Arguments=[{Name:"VAVol",Value:70}],this.SetArgs=function(t){if(t&&ha.IsNonEmptyArray(t))for(var e=0;e<t.length;++e){var a=t[e];"VAVol"==a.Name&&this.SetParamValue(a.Name,a.Value)}},this.SetParamValue=function(t,e){for(var a=0;a<this.Arguments.length;++a){var i=this.Arguments[a];i.Name==t&&(i.Value=e)}},t&&(ha.IsNumber(t.VolType)&&(this.VolType=t.VolType),ha.IsNumber(t.BarPosition)&&(this.BarPosition=t.BarPosition),ha.IsNumber(t.BarWidthRate)&&(this.BarWidthRate=t.BarWidthRate),ha.IsNumber(t.DelayRequestFrequency)&&(this.DelayRequestFrequency=t.DelayRequestFrequency),t.Args&&this.SetArgs(t.Args)),this.GetParamValue=function(t){for(var e=0;e<this.Arguments.length;++e){var a=this.Arguments[e];if(a.Name==t)return a.Value}},this.Create=function(t,e){this.HQChart=t,this.WindowIndex=e},this.CreateChart=function(t,e){var a=null,i=this.IsOverlay();i?(a=this.OverlayIndex.Frame.Frame,this.OverlayIndex.Frame.ChartPaint=[]):(a=t.Frame.SubFrame[e].Frame,t.DeleteIndexPaint(e));var r=[],n=new Ve;return n.Canvas=t.Canvas,n.Name=this.Name+"-0",n.ChartBorder=a.ChartBorder,n.ChartFrame=a,n.HQChart=this.HQChart,n.Identify=this.Guid,n.SetOption(this),i?this.OverlayIndex.Frame.ChartPaint.push(n):t.ChartPaint.push(n),r.push(n),this.ChartVolProfile=n,r},this.CancelRequestTimer=function(){this.RequestTimer&&(clearTimeout(this.RequestTimer),this.RequestTimer=null)},this.RequestData=function(t,e,a,i){var r=this;this.CancelRequestTimer();var n=function(){var e=t.ChartPaint[0],a=e.Data;if(a&&!ha.IsNonEmptyArray(!a.Data)){var i=e.DrawKRange;if(i&&ha.IsNumber(i.Start)&&ha.IsNumber(i.End)){var n=a.Data[i.Start],s=a.Data[i.End],o={Start:{Date:n.Date,DataIndex:i.Start},End:{Date:s.Date,DataIndex:i.End},Chart:r};ha.IsNumber(n.Time)&&(o.Start.Time=n.Time),ha.IsNumber(s.Time)&&(o.End.Time=s.Time),o.ValueAreaVol=r.Arguments[0].Value,r.DataStatus=0,t&&t.RequestVolumeProfileData&&t.RequestVolumeProfileData(o)}}};return i&&1==i.Type?this.RequestTimer=setTimeout((function(){n()}),this.DelayRequestFrequency):n(),!0},this.OnRecvVolumeProfileData=function(t){return this.BindData(t),this.HQChart.UpdataDataoffset(),this.HQChart.UpdateFrameMaxMin(),this.HQChart.Draw(),!0},this.BindData=function(t){this.ChartVolProfile&&1!=this.ChartVolProfile.IsDestroy||this.CreateChart(this.HQChart,this.WindowIndex);var e=this.ChartVolProfile;if(e.Data=null,t&&ha.IsNonEmptyArray(t.Data)&&ha.IsNumber(t.MaxPrice)&&ha.IsNumber(t.MinPrice)){for(var a=0,i=0,r=null,n=0,s=0;n<t.Data.length;++n){var o=t.Data[n];for(i=0,s=0;s<o.Vol.length;++s){var h=o.Vol[s];ha.IsNumber(h.Value)&&(i+=h.Value)}a<i&&(a=i,r=o.Price)}if(!(this.maxVolPrice<=0||this.maxVol<=0)){e.MaxVolPrice=r,e.MaxVol=a,e.MaxPrice=t.MaxPrice,e.MinPrice=t.MinPrice,e.Data=t;var l=this.WindowIndex+1;this.HQChart.TitlePaint[l].Title="VPVR",this.HQChart.TitlePaint[l].Identify=this.Guid;var u=new Ha(e.Data,"VPVR",e.Data);u.ChartClassName="ChartVolProfileVisibleRange",u.Chart=e,this.HQChart.TitlePaint[l].Data[0]=u}}}}function tr(){this.newMethod=Qi,this.newMethod("CJL"),delete this.newMethod,this.Index=new Array(new Zi("VOL",null),new Zi("OPID",null)),this.Index[0].LineColor=Oi.Index.LineColor[0],this.Index[1].LineColor=Oi.Index.LineColor[1],this.CreateChart=function(t){if(0==t){var e=new oe;return e}if(1==t){e=new $t;return e.LineWidth=1*U(),e}},this.RequestData=function(t,e,a){return this.BindData(t,e,a),t.UpdataDataoffset(),t.UpdateFrameMaxMin(),t.Draw(),!0},this.BindData=function(t,e,a){var i=this.CreatePaints(t,e),r=this.IsOverlay();if(i.length!=this.Index.length)return!1;var n=a.GetVol(),s=a.GetPosition();i[0].HistoryData=a,i[0].Data.Data=n,i[1].Data.Data=s;var o=e+1;if(r){var h=t.TitlePaint[o],l={Data:[],Title:""};for(var u in h.OverlayIndex.set(this.OverlayIndex.Identify,l),i){var C=new Ha(i[u].Data,this.Index[u].Name,this.Index[u].LineColor);h.OverlayIndex.get(this.OverlayIndex.Identify).Data[u]=C}}else t.TitlePaint[o].Data[0]=new Ha(i[0].Data,this.Index[0].Name,this.Index[0].LineColor),t.TitlePaint[o].Data[1]=new Ha(i[1].Data,this.Index[1].Name,this.Index[1].LineColor),t.TitlePaint[o].Title=this.Name;return!0}}function er(){this.newMethod=Qi,this.newMethod("Long-Short"),delete this.newMethod,this.Index=new Array(new Zi("å¤å¤´åºå",null),new Zi("ç©ºå¤´åºå",null),new Zi("å¸åºå¤ç©ºææ ",null)),this.Index[0].LineColor=Oi.UpBarColor,this.Index[1].LineColor=Oi.DownBarColor,this.Index[2].LineColor=Oi.Index.LineColor[0],this.LongShortData,this.CreateChart=function(t){if(2==t){var e=new jt;return e.LineWidth=2,e}return new de},this.GetOutData=function(){return{LongShortData:this.LongShortData}},this.RequestData=function(t,e,a){var i=this,r={HQChart:t,WindowIndex:e,HistoryData:a};return this.LongShortData=[],r.HQChart.Period>0?(this.NotSupport(r.HQChart,r.WindowIndex,"ä¸æ¯æå¨æåæ¢"),r.HQChart.Draw(),this.SendEvent(t,e,a,"ä¸æ¯æå¨æåæ¢"),!1):(O.HttpRequest({url:Oi.Index.MarketLongShortApiUrl,data:{},type:"post",dataType:"json",async:!0,success:function(n){i.RecvData(n,r),i.SendEvent(t,e,a)}}),!0)},this.RecvData=function(t,e){if(!(t.data.length<=0)){var a=new Array;for(var i in t.data){var r=t.data[i],n=new Et;n.Date=r[0],n.Value=r[1],a.push(n)}var s=e.HistoryData.GetFittingData(a),o=new Ot;o.Data=s,o.Period=e.HQChart.Period,o.Right=e.HQChart.Right,this.LongShortData=o.GetValue(),this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()}},this.BindData=function(t,e,a){var i=this.CreatePaints(t,e),r=this.IsOverlay();if(i.length!=this.Index.length)return!1;i[2].Data.Data=this.LongShortData,i[0].Data.Data[0]=8,i[1].Data.Data[0]=1;var n=e+1;if(r){this.OverlayIndex.Frame.Frame.YSpecificMaxMin={Max:9,Min:0,Count:3};var s=t.TitlePaint[n],o={Data:[],Title:""};for(var h in s.OverlayIndex.set(this.OverlayIndex.Identify,o),i){var l=new Ha(i[h].Data,this.Index[h].Name,this.Index[h].LineColor);2!=h&&(l.DataType="StraightLine"),s.OverlayIndex.get(this.OverlayIndex.Identify).Data[h]=l}}else for(var h in t.Frame.SubFrame[e].Frame.YSpecificMaxMin={Max:9,Min:0,Count:3},i)t.TitlePaint[n].Data[h]=new Ha(i[h].Data,this.Index[h].Name,this.Index[h].LineColor),2!=h&&(t.TitlePaint[n].Data[h].DataType="StraightLine");return!0}}function ar(){this.newMethod=Qi,this.newMethod("Market-Timing"),delete this.newMethod,this.Index=new Array(new Zi("å å­æ©æ¶",null)),this.TimingData,this.TitleColor=Oi.FrameSplitTextColor,this.CreateChart=function(t){return new pe},this.GetOutData=function(){return{TimingData:this.TimingData}},this.RequestData=function(t,e,a){var i=this,r={HQChart:t,WindowIndex:e,HistoryData:a};return this.LongShortData=[],r.HQChart.Period>0?(this.NotSupport(r.HQChart,r.WindowIndex,"ä¸æ¯æå¨æåæ¢"),r.HQChart.Draw(),this.SendEvent(t,e,a,"ä¸æ¯æå¨æåæ¢"),!1):(O.HttpRequest({url:Oi.Index.MarketLongShortApiUrl,data:{},type:"post",dataType:"json",async:!0,success:function(n){i.RecvData(n,r),i.SendEvent(t,e,a)}}),!0)},this.RecvData=function(t,e){if(!(t.data.length<=0)){var a=new Array;for(var i in t.data){var r=t.data[i],n=new Et;n.Date=r[0],n.Value=r[2],a.push(n)}var s=e.HistoryData.GetFittingData(a),o=new Ot;o.Data=s,o.Period=e.HQChart.Period,o.Right=e.HQChart.Right,this.TimingData=o.GetValue(),this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()}},this.BindData=function(t,e,a){var i=this.CreatePaints(t,e),r=this.IsOverlay();if(i.length!=this.Index.length)return!1;i[0].Data.Data=this.TimingData,i[0].NotSupportMessage=null;var n=e+1;if(r){var s=t.TitlePaint[n],o={Data:[],Title:""};for(var h in s.OverlayIndex.set(this.OverlayIndex.Identify,o),i){var l=new Ha(i[h].Data,this.Index[h].Name,this.Index[h].LineColor);l.StringFormat=Ga.THOUSANDS,l.FloatPrecision=0,s.OverlayIndex.get(this.OverlayIndex.Identify).Data[h]=l}}else for(var h in i)t.TitlePaint[n].Data[h]=new Ha(i[h].Data,this.Index[h].Name,this.TitleColor),t.TitlePaint[n].Data[h].StringFormat=Ga.THOUSANDS,t.TitlePaint[n].Data[h].FloatPrecision=0;return!0}}function ir(){this.newMethod=Qi,this.newMethod("Market-Attention"),delete this.newMethod,this.Index=new Array(new Zi("å¸åºå³æ³¨åº¦",null)),this.Data,this.TitleColor=Oi.FrameSplitTextColor,this.ApiUrl=Oi.Index.MarketAttentionApiUrl,this.CreateChart=function(t){return new pe},this.GetOutData=function(){return{Data:this.Data}},this.SetFrame=function(t,e,a){var i=this.IsOverlay();i?this.OverlayIndex.Frame.Frame.YSpecificMaxMin={Max:6,Min:0,Count:3}:t.Frame.SubFrame[e].Frame.YSpecificMaxMin={Max:6,Min:0,Count:3}},this.RequestData=function(t,e,a){var i=this,r={HQChart:t,WindowIndex:e,HistoryData:a};return this.Data=[],r.HQChart.Period>0?(this.NotSupport(r.HQChart,r.WindowIndex,"ä¸æ¯æå¨æåæ¢"),r.HQChart.Draw(),this.SendEvent(t,e,a,"ä¸æ¯æå¨æåæ¢"),!1):(O.HttpRequest({url:this.ApiUrl,data:{symbol:r.HQChart.Symbol,startdate:20100101},type:"post",dataType:"json",async:!0,success:function(n){i.RecvData(n,r),i.SendEvent(t,e,a)}}),!0)},this.RecvData=function(t,e){if(!(t.date.length<0)){var a=new Array;for(var i in t.date){var r=new Et;r.Date=t.date[i],r.Value=t.value[i],a.push(r)}var n=e.HistoryData.GetFittingData(a),s=new Ot;s.Data=n,s.Period=e.HQChart.Period,s.Right=e.HQChart.Right,this.Data=s.GetValue(),this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),this.SetFrame(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()}},this.BindData=function(t,e,a){var i=this.CreatePaints(t,e),r=this.IsOverlay();if(i.length!=this.Index.length)return!1;i[0].Data.Data=this.Data,i[0].NotSupportMessage=null;var n=e+1;if(r){var s=t.TitlePaint[n],o={Data:[],Title:""};for(var h in s.OverlayIndex.set(this.OverlayIndex.Identify,o),i){var l=new Ha(i[h].Data,this.Index[h].Name,this.Index[h].LineColor);l.StringFormat=Ga.THOUSANDS,l.FloatPrecision=0,s.OverlayIndex.get(this.OverlayIndex.Identify).Data[h]=l}}else for(var h in i)t.TitlePaint[n].Data[h]=new Ha(i[h].Data,this.Index[h].Name,this.TitleColor),t.TitlePaint[n].Data[h].StringFormat=Ga.THOUSANDS,t.TitlePaint[n].Data[h].FloatPrecision=0;return!0}}function rr(){this.newMethod=Qi,this.newMethod("Market-Heat"),delete this.newMethod,this.Index=new Array(new Zi("ç­åº¦",5),new Zi("MA",10),new Zi("MA",null)),this.Data,this.ApiUrl=Oi.Index.MarketHeatApiUrl,this.Index[0].LineColor=Oi.FrameSplitTextColor,this.Index[1].LineColor=Oi.Index.LineColor[0],this.Index[2].LineColor=Oi.Index.LineColor[1],this.CreateChart=function(t){return 0==t?new pe:new jt},this.RequestData=function(t,e,a){var i=this,r={HQChart:t,WindowIndex:e,HistoryData:a};return this.Data=[],r.HQChart.Period>0?(this.NotSupport(r.HQChart,r.WindowIndex,"ä¸æ¯æå¨æåæ¢"),r.HQChart.Draw(),!1):(O.HttpRequest({url:this.ApiUrl,data:{symbol:r.HQChart.Symbol,startdate:20100101},type:"post",dataType:"json",async:!0,success:function(t){i.RecvData(t,r)}}),!0)},this.RecvData=function(t,e){if(!(t.date.length<0)){var a=new Array;for(var i in t.date){var r=new Et;r.Date=t.date[i],r.Value=t.value[i],a.push(r)}var n=e.HistoryData.GetFittingData(a),s=new Ot;s.Data=n,s.Period=e.HQChart.Period,s.Right=e.HQChart.Right,this.Data=s.GetValue(),this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()}},this.BindData=function(t,e,a){var i=this.CreatePaints(t,e),r=this.IsOverlay();if(i.length!=this.Index.length)return!1;i[0].Data.Data=this.Data,i[0].NotSupportMessage=null;var n=Vi.MA(this.Data,this.Index[0].Param);i[1].Data.Data=n;var s=Vi.MA(this.Data,this.Index[1].Param);i[2].Data.Data=s;var o=e+1;if(r){var h=t.TitlePaint[o],l={Data:[],Title:""};for(var u in h.OverlayIndex.set(this.OverlayIndex.Identify,l),i){var C="";C=0==u?t.Name+this.Index[u].Name:"MA"+this.Index[u-1].Param;var D=new Ha(i[u].Data,C,this.Index[u].LineColor);D.StringFormat=Ga.DEFAULT,D.FloatPrecision=2,h.OverlayIndex.get(this.OverlayIndex.Identify).Data[u]=D}}else for(var u in i){C="";C=0==u?t.Name+this.Index[u].Name:"MA"+this.Index[u-1].Param,t.TitlePaint[o].Data[u]=new Ha(i[u].Data,C,this.Index[u].LineColor),t.TitlePaint[o].Data[u].StringFormat=Ga.DEFAULT,t.TitlePaint[o].Data[u].FloatPrecision=2}return!0}}function nr(){this.newMethod=Qi,this.newMethod("Market-Heat"),delete this.newMethod,this.Index=new Array(new Zi("åºå",3),new Zi("ç­åº¦ææ°",10),new Zi("MA",5),new Zi("MA",10)),this.Data,this.ApiUrl=Oi.Index.CustomIndexHeatApiUrl,this.Index[1].LineColor=Oi.Index.LineColor[1],this.Index[2].LineColor=Oi.Index.LineColor[2],this.Index[3].LineColor=Oi.Index.LineColor[3],this.Create=function(t,e){for(var a in this.Index){var i=null;0==a?i=new me:(i=new jt,i.Color=this.Index[a].LineColor),i.Canvas=t.Canvas,i.Name=this.Name+"-"+a.toString(),i.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,i.ChartFrame=t.Frame.SubFrame[e].Frame,t.ChartPaint.push(i)}},this.RequestData=function(t,e,a){var i=this,r={HQChart:t,WindowIndex:e,HistoryData:a};return this.Data=[],r.HQChart.Period>0?(this.NotSupport(r.HQChart,r.WindowIndex,"ä¸æ¯æå¨æåæ¢"),r.HQChart.Draw(),!1):(O.HttpRequest({url:this.ApiUrl,data:{stock:r.HQChart.CustomStock,date:{startdate:r.HQChart.QueryDate.Start,enddate:r.HQChart.QueryDate.End},day:[this.Index[0].Param,this.Index[1].Param]},type:"post",dataType:"json",async:!0,success:function(t){i.RecvData(t,r)}}),!0)},this.RecvData=function(t,e){if(!(null==t.data||t.data.length<0)){var a=new Array;for(var i in t.data){var r=t.data[i],n=new Et;n.Date=r[0],n.Value=r[1],a.push(n)}var s=e.HistoryData.GetFittingData(a),o=new Ot;o.Data=s,o.Period=e.HQChart.Period,o.Right=e.HQChart.Right,this.Data=o.GetValue(),this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()}},this.BindData=function(t,e,a){var i=t.GetChartPaint(e);if(i.length!=this.Index.length)return!1;i[0].NotSupportMessage=null,i[0].Data.Data=[{Value:0,Value2:.2,Color:"rgb(50,205,50)",Title:"ç­åº¦1",TitleColor:"rgb(245,255 ,250)"},{Value:.2,Value2:.4,Color:"rgb(255,140,0)",Title:"ç­åº¦2",TitleColor:"rgb(245,255 ,250)"},{Value:.4,Value2:.8,Color:"rgb(255,106,106)",Title:"ç­åº¦3",TitleColor:"rgb(245,255 ,250)"},{Value:.8,Value2:1,Color:"rgb(208, 32 ,144)",Title:"ç­åº¦4",TitleColor:"rgb(245,255 ,250)"}],i[1].Data.Data=this.Data;var r=Vi.MA(this.Data,this.Index[2].Param);i[2].Data.Data=r;var n=Vi.MA(this.Data,this.Index[3].Param);i[3].Data.Data=n,t.Frame.SubFrame[e].Frame.YSpecificMaxMin={Max:1,Min:0,Count:3};for(var s=e+1,o=1;o<i.length;++o){var h=this.Index[o].Name;"MA"==h&&(h="MA"+this.Index[o].Param),t.TitlePaint[s].Data[o]=new Ha(i[o].Data,h,this.Index[o].LineColor),t.TitlePaint[s].Data[o].StringFormat=Ga.DEFAULT,t.TitlePaint[s].Data[o].FloatPrecision=2}return t.TitlePaint[s].Title="ç­åº¦("+this.Index[0].Param+","+this.Index[1].Param+","+this.Index[2].Param+","+this.Index[3].Param+")",!0}}function sr(){this.newMethod=Qi,this.newMethod("è´¢å¡ç²é¥°"),delete this.newMethod,this.Index=new Array(new Zi("åºå",null),new Zi("ç³»æ°",null)),this.Data,this.ApiUrl=Oi.Index.StockHistoryDayApiUrl,this.Index[0].LineColor=Oi.Index.LineColor[0],this.Index[1].LineColor="rgb(105,105,105)",this.CreateChart=function(t){return 0==t?new me:new ue},this.GetOutData=function(){return{Data:this.Data}},this.RequestData=function(t,e,a){var i=this,r={HQChart:t,WindowIndex:e,HistoryData:a};if(this.Data=[],2!=r.HQChart.Period)return this.NotSupport(r.HQChart,r.WindowIndex,"åªæ¯ææçº¿"),r.HQChart.Draw(),this.SendEvent(t,e,a,"åªæ¯ææçº¿"),!1;var n=["finance.benford","announcement2.quarter","announcement1.quarter","announcement3.quarter","announcement4.quarter"],s=[{item:["date","int32","gte","20130101"]},{item:["announcement1.year","int32","gte",0,"announcement2.year","int32","gte",0,"announcement3.year","int32","gte",0,"announcement4.year","int32","gte",0,"or"]}];return O.HttpRequest({url:this.ApiUrl,data:{symbol:[r.HQChart.Symbol],field:n,condition:s},type:"post",dataType:"json",async:!0,success:function(n){i.RecvData(n,r),i.SendEvent(t,e,a)}}),!0},this.JsonDataToMapSingleData=function(t){var e=t.stock[0].stockday,a=new E.default;for(var i in e){var r=e[i],n=new Et;if(n.Date=r.date,n.Value=new Array,null!=r.finance1&&null!=r.announcement1){var s=r.announcement1.year,o=r.announcement1.quarter,h=r.finance1.benford;n.Value.push({Year:s,Quarter:o,Value:h})}if(null!=r.finance2&&null!=r.announcement2){var l=r.announcement2.year,u=r.announcement2.quarter,C=r.finance2.benford;n.Value.push({Year:l,Quarter:u,Value:C})}if(null!=r.finance3&&null!=r.announcement3){var D=r.announcement3.year,f=r.announcement3.quarter,c=r.finance3.benford;n.Value.push({Year:D,Quarter:f,Value:c})}if(null!=r.finance4&&null!=r.announcement4){var d=r.announcement4.year,m=r.announcement4.quarter,v=r.finance4.benford;n.Value.push({Year:d,Quarter:m,Value:v})}a.set(n.Date,n)}var S=new Array,I=!0,p=!1,g=void 0;try{for(var x,F=(0,T.default)(a);!(I=(x=F.next()).done);I=!0){r=x.value;S.push(r[1])}}catch(y){p=!0,g=y}finally{try{!I&&F.return&&F.return()}finally{if(p)throw g}}return S},this.RecvData=function(t,e){if(w.Chart.Log(t),!(null==t.stock||t.stock.length<=0)){var a=this.JsonDataToMapSingleData(t),i=e.HistoryData.GetFittingMonthData(a),r=new Ot;r.Data=i,r.Period=e.HQChart.Period,r.Right=e.HQChart.Right,this.Data=r.GetValue(),this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()}},this.BindData=function(t,e,a){var i=this.CreatePaints(t,e);if(i.length!=this.Index.length)return!1;i[0].NotSupportMessage=null,i[0].Data.Data=[{Value:0,Value2:.2,Color:"rgb(50,205,50)",Title:"å®å¨åº",TitleColor:"rgb(245,255 ,250)"},{Value:.2,Value2:.4,Color:"rgb(255,140,0)",Title:"é¢è­¦åº",TitleColor:"rgb(245,255 ,250)"},{Value:.4,Value2:1,Color:"rgb(255,106,106)",Title:"è­¦ç¤ºåº",TitleColor:"rgb(245,255 ,250)"}],i[1].Data.Data=this.Data,t.Frame.SubFrame[e].Frame.YSpecificMaxMin={Max:1,Min:0,Count:3};var r=e+1;return t.TitlePaint[r].Data[1]=new Ha(i[1].Data,this.Index[1].Name,this.Index[1].LineColor),t.TitlePaint[r].Data[1].DataType="MultiReport",t.TitlePaint[r].Title=this.FormatIndexTitle(),!0}}function or(t,e,a,i){this.newMethod=Qi,this.newMethod(t),delete this.newMethod,this.Script=e,this.Arguments=[],this.OutVar=[],this.ApiUrl=Oi.PyIndexDomain+"/hq/code",a&&(this.Arguments=a),this.RequestData=function(t,e,a){this.OutVar=[];var i=this,r={HQChart:t,WindowIndex:e,HistoryData:a},n="";for(var s in this.Arguments){n.length>0&&(n+=",");var o=this.Arguments[s];n+='"'+o.Name+'":'+o.Value}n="{"+n+"}";var h=JSON.parse(n),l=(0,F.default)({code:this.Script,symbol:r.HQChart.Symbol,period:r.HQChart.Period,right:r.HQChart.Right,params:h,numcount:t.MaxRequestDataCount});return O.HttpRequest({url:this.ApiUrl,data:l,type:"post",dataType:"json",contentType:" application/json; charset=utf-8",async:!0,success:function(t){i.RecvData(t,r)},complete:function(t){},error:function(t,e){i.RecvError(t,e,r)}}),!0},this.RecvError=function(t,e,a){w.Chart.Log("[PyScriptIndex::RecvError] error",e),a.HQChart.ScriptErrorCallback&&a.HQChart.ScriptErrorCallback(e)},this.RecvData=function(t,e){if(0!=t.code)return w.Chart.Log("[PyScriptIndex::RecvData] failed.",t),void(e.HQChart.ScriptErrorCallback&&e.HQChart.ScriptErrorCallback(t.msg));w.Chart.Log("[PyScriptIndex::RecvData] recv data.",t);var a=t.date;for(var i in t.data){for(var r=t.data[i],n=[],s=0;s<a.length&&s<a.length;++s)if(!(s>=r.data.length)){var o=new Et;o.Date=a[s],o.Value=r.data[s],n.push(o)}var h=e.HistoryData.GetFittingData(n),l=new Ot;l.Data=h,l.Period=e.HQChart.Period,l.Right=e.HQChart.Right;var u={Name:r.name,Type:r.graph,LineWidth:r.width,Data:l.GetValue(),Color:r.color};this.OutVar.push(u)}this.BindData(e.HQChart,e.WindowIndex,e.HistoryData),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw()},this.BindData=function(t,e,a){for(var i in t.DeleteIndexPaint(e),this.OutVar){var r=this.OutVar[i];switch(r.Type){case"line":this.CreateLine(t,e,r,i);break;case"colorstick":this.CreateColorStock(t,e,r,i);break}}var n=e+1;t.TitlePaint[n].Title=this.Name;var s="";for(var o in this.Arguments){var h=this.Arguments[o];s.length>0&&(s+=","),s+=h.Value.toString()}return s.length>0&&(t.TitlePaint[n].Title=this.Name+"("+s+")"),!0},this.CreateLine=function(t,e,a,i){var r=new jt;r.Canvas=t.Canvas,r.DrawType=1,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=a.Color:r.Color=this.GetDefaultColor(i),a.LineWidth>0&&(r.LineWidth=a.LineWidth),0==a.IsShow&&(r.IsShow=!1);var n=e+1;r.Data.Data=a.Data,t.TitlePaint[n].Data[i]=new Ha(r.Data,a.Name,r.Color),t.ChartPaint.push(r)},this.CreateColorStock=function(t,e,a,i){var r=new pe;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame;var n=e+1;r.Data.Data=a.Data,t.TitlePaint[n].Data[i]=new Ha(r.Data,a.Name,this.GetDefaultColor(i)),t.ChartPaint.push(r)},this.GetDefaultColor=function(t){var e=["rgb(255,174,0)","rgb(25,199,255)","rgb(175,95,162)","rgb(236,105,65)","rgb(68,114,196)","rgb(229,0,79)","rgb(0,128,255)","rgb(252,96,154)","rgb(42,230,215)","rgb(24,71,178)"],a=parseInt(t);return e[a%(e.length-1)]}}function hr(t,e,a,i){this.newMethod=or,this.newMethod(t),delete this.newMethod,this.JsonData,i.JsonData&&(this.JsonData=i.JsonData),this.RequestData=function(t,e,a){if(this.JsonData){var i={HQChart:t,WindowIndex:e,HistoryData:a};this.JsonData.code=0;var r=this.JsonData;this.RecvData(r,i)}else console.warn("[PyScriptIndex::RequestData] JsonData is null"),i.HQChart.ScriptErrorCallback&&i.HQChart.ScriptErrorCallback("json æ°æ®ä¸è½ä¸ºç©º")}}function lr(){}function ur(){this.MaxRequestDataCount=1e3,this.StartDate=20160101,this.Data,this.ClassName="IKLineInfo",this.Explain="IKLineInfo",this.GetToday=function(){var t=new Date,e=1e4*t.getFullYear()+100*(t.getMonth()+1)+t.getDate();return e},this.GetRequestData=function(t){var e={Symbol:t.Symbol,MaxRequestDataCount:t.MaxRequestDataCount,MaxRequestMinuteDayCount:t.MaxRequestMinuteDayCount,Period:t.Period};return e},this.NetworkFilter=function(t,e){if(!t.NetworkFilter)return!1;var a=this,i={HQChart:t},r={Name:this.ClassName+"::RequestData",Explain:this.Explain,Request:this.GetRequestData(t),Self:this,HQChart:t,PreventDefault:!1};return e&&(1==e.Update&&(r.Update={Start:{Date:e.StartDate}},i.Update={Start:{Date:e.StartDate}}),r.CallFunctionName=e.FunctionName),t.NetworkFilter(r,(function(t){a.RecvData(t,i)})),1==r.PreventDefault}}function Cr(){this.newMethod=ur,this.newMethod(),delete this.newMethod,this.ClassName="InvestorInfo",this.Explain="äºå¨æ",this.RequestData=function(t,e){var a=this,i={HQChart:t};if(this.Data=[],!this.NetworkFilter(t,e)){var r={filed:["question","answerdate","symbol","id"],symbol:[i.HQChart.Symbol],querydate:{StartDate:this.StartDate,EndDate:this.GetToday()},start:0,end:this.MaxRequestDataCount},n=Oi.Domain+Oi.KLine.Info.Investor.ApiUrl;return O.HttpRequest({url:n,data:r,type:"post",dataType:"json",async:!0,success:function(t){a.RecvData(t,i)}}),!0}},this.RecvData=function(t,e){if(!(t.list.length<=0)){for(var a in t.list){var i=t.list[a],r=new At;r.Date=i.answerdate,r.Title=i.question,r.InfoType=Mt.INVESTOR,this.Data.push(r)}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function Dr(){this.newMethod=ur,this.newMethod(),delete this.newMethod,this.ClassName="AnnouncementInfo",this.Explain="å¬å",this.ApiType=1,this.RequestData=function(t,e){var a=this,i={HQChart:t};if(e&&!0===e.Update||(this.Data=[]),!this.NetworkFilter(t,e))if(1==this.ApiType){var r=Oi.CacheDomain+"/cache/analyze/shszreportlist/"+i.HQChart.Symbol+".json";O.HttpRequest({url:r,type:"get",dataType:"json",async:!0,success:function(t){a.RecvData(t,i)},error:function(t,e){a.RecvError(t,e,i)}})}else{r=Oi.Domain+Oi.KLine.Info.Announcement.ApiUrl;O.HttpRequest({url:r,data:{filed:["title","releasedate","symbol","id"],symbol:[i.HQChart.Symbol],querydate:{StartDate:this.StartDate,EndDate:this.GetToday()},start:0,end:this.MaxRequestDataCount},type:"post",dataType:"json",async:!0,success:function(t){a.RecvData(t,i)},error:function(t,e){a.RecvError(t,e,i)}})}},this.RecvData=function(t,e){if(!(t.report.length<=0)){var a=[];for(var i in t.report){var r=t.report[i],n=new At;for(var s in n.Date=r.releasedate,n.Title=r.title,n.InfoType=Mt.ANNOUNCEMENT,r.type){var o=r.type[s];switch(o){case"ä¸å­£åº¦æ¥å":n.InfoType=Mt.ANNOUNCEMENT_QUARTER_1;break;case"åå¹´åº¦æ¥å":n.InfoType=Mt.ANNOUNCEMENT_QUARTER_2;break;case"ä¸å­£åº¦æ¥å":n.InfoType=Mt.ANNOUNCEMENT_QUARTER_3;break;case"å¹´åº¦æ¥å":n.InfoType=Mt.ANNOUNCEMENT_QUARTER_4;break}}for(var s in r.typeex){var h=r.typeex[s];n.InfoType=Mt.ANNOUNCEMENT_EX_START+h;break}a.push(n)}!0===t.Update&&this.Data.length>0?this.UpdateData(a):this.Data=a,e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}},this.UpdateData=function(t){if(t&&!(t.length<=0)){var e=new I.default;for(var a in this.Data){var i=this.Data[a],r=i.Date+"-"+i.InfoType+"-"+i.Title;e.add(r)}var n=0;for(var a in t){i=t[a],r=i.Date+"-"+i.InfoType+"-"+i.Title;e.has(r)||(this.Data.push(i),++n)}w.Chart.Log("[AnnouncementInfo::UpdateData] add new count="+n)}},this.RecvError=function(t,e,a){console.warn("[AnnouncementInfo::RecvError] error, http ",e,t)}}function fr(){this.newMethod=ur,this.newMethod(),delete this.newMethod,this.ClassName="PforecastInfo",this.RequestData=function(t,e){var a=this,i={HQChart:t};this.Data=[];var r=Oi.Domain+Oi.KLine.Info.Pforecast.ApiUrl;return O.HttpRequest({url:r,data:{field:["pforecast.type","pforecast.reportdate","fweek"],condition:[{item:["pforecast.reportdate","int32","gte",this.StartDate]}],symbol:[i.HQChart.Symbol],start:0,end:this.MaxRequestDataCount},type:"post",dataType:"json",async:!0,success:function(t){a.RecvData(t,i)}}),!0},this.RecvData=function(t,e){if(1==t.stock.length&&!(t.stock[0].stockday.length<=0)){for(var a in t.stock[0].stockday){var i=t.stock[0].stockday[a];if(i.pforecast.length>0){var r=i.pforecast[0],n=new At;n.Date=i.date,n.Title=r.type,n.InfoType=Mt.PFORECAST,n.ExtendData={Type:r.type,ReportDate:r.reportdate},i.fweek&&(n.ExtendData.FWeek={},null!=i.fweek.week1&&(n.ExtendData.FWeek.Week1=i.fweek.week1),null!=i.fweek.week4&&(n.ExtendData.FWeek.Week4=i.fweek.week4)),this.Data.push(n)}}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function cr(){this.newMethod=ur,this.newMethod(),delete this.newMethod,this.ClassName="ResearchInfo",this.RequestData=function(t,e){var a=this,i={HQChart:t};this.Data=[];var r=Oi.Domain+Oi.KLine.Info.Research.ApiUrl;return O.HttpRequest({url:r,data:{filed:["releasedate","researchdate","level","symbol","id","type"],querydate:{StartDate:this.StartDate,EndDate:this.GetToday()},symbol:[i.HQChart.Symbol],start:0,end:this.MaxRequestDataCount},type:"post",dataType:"json",async:!0,success:function(t){a.RecvData(t,i)}}),!0},this.RecvData=function(t,e){if(!(t.list.length<=0)){for(var a in t.list){var i=t.list[a],r=new At;r.ID=i.id,r.Date=i.researchdate,r.InfoType=Mt.RESEARCH,r.ExtendData={Level:i.level,Type:i.type},this.Data.push(r)}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function dr(){this.newMethod=ur,this.newMethod(),delete this.newMethod,this.ClassName="BlockTrading",this.RequestData=function(t,e){var a=this,i={HQChart:t};this.Data=[];var r=Oi.Domain+Oi.KLine.Info.BlockTrading.ApiUrl;return O.HttpRequest({url:r,data:{field:["blocktrading.price","blocktrading.vol","blocktrading.premium","fweek","price"],condition:[{item:["date","int32","gte",this.StartDate]},{item:["blocktrading.vol","int32","gte","0"]}],symbol:[i.HQChart.Symbol],start:0,end:this.MaxRequestDataCount},type:"post",dataType:"json",async:!0,success:function(t){a.RecvData(t,i)}}),!0},this.RecvData=function(t,e){if(1==t.stock.length&&!(t.stock[0].stockday.length<=0)){for(var a in t.stock[0].stockday){var i=t.stock[0].stockday[a],r=new At;r.Date=i.date,r.InfoType=Mt.BLOCKTRADING,r.ExtendData={Price:i.blocktrading.price,Premium:i.blocktrading.premium,Vol:i.blocktrading.vol,ClosePrice:i.price},i.fweek&&(r.ExtendData.FWeek={},null!=i.fweek.week1&&(r.ExtendData.FWeek.Week1=i.fweek.week1),null!=i.fweek.week4&&(r.ExtendData.FWeek.Week4=i.fweek.week4)),this.Data.push(r)}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function mr(){this.newMethod=ur,this.newMethod(),delete this.newMethod,this.ClassName="TradeDetail",this.RequestData=function(t,e){var a=this,i={HQChart:t};this.Data=[];var r=Oi.Domain+Oi.KLine.Info.TradeDetail.ApiUrl;return O.HttpRequest({url:r,data:{field:["tradedetail.typeexplain","tradedetail.type","fweek"],condition:[{item:["date","int32","gte",this.StartDate]},{item:["tradedetail.type","int32","gte","0"]}],symbol:[i.HQChart.Symbol],start:0,end:this.MaxRequestDataCount},type:"post",dataType:"json",async:!0,success:function(t){a.RecvData(t,i)}}),!0},this.RecvData=function(t,e){if(1==t.stock.length&&!(t.stock[0].stockday.length<=0)){for(var a in t.stock[0].stockday){var i=t.stock[0].stockday[a],r=new At;for(var n in r.Date=i.date,r.InfoType=Mt.TRADEDETAIL,r.ExtendData={Detail:new Array},i.tradedetail){var s=i.tradedetail[n];r.ExtendData.Detail.push({Type:s.type,TypeExplain:s.typeexplain})}i.fweek&&(r.ExtendData.FWeek={},null!=i.fweek.week1&&(r.ExtendData.FWeek.Week1=i.fweek.week1),null!=i.fweek.week4&&(r.ExtendData.FWeek.Week4=i.fweek.week4)),this.Data.push(r)}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}}function vr(){}function Sr(){this.Data,this.ClassName="IMinuteInfo"}function Ir(){this.newMethod=Sr,this.newMethod(),delete this.newMethod,this.ClassName="MarketEventInfo",this.RequestData=function(t){var e=this;this.Data=[];var a={HQChart:t},i=Oi.CacheDomain+"/cache/analyze/shszevent/marketevent/concept/"+t.TradeDate+".json";if(t.NetworkFilter){var r={Name:"MarketEventInfo::RequestData",Explain:"å¤§çå¼å¨",Request:{Url:i,Type:"Get",Data:{Date:t.TradeDate,Symbol:t.Symbol}},Self:this,PreventDefault:!1};if(t.NetworkFilter(r,(function(t){e.RecvData(t,a),a.HQChart.UpdataChartInfo(),a.HQChart.Draw()})),1==r.PreventDefault)return}return O.HttpRequest({url:i,type:"get",dataType:"json",async:!0,success:function(t){e.RecvData(t,a)},error:function(t,e){console.warn("[MarketEventInfo::RequestData] error, http ",e,t)}}),!0},this.RecvData=function(t,e){for(var a in t.event){var i=t.event[a];for(var r in i.data){var n=i.data[r];if(Array.isArray(n)){if(n.length<2)continue;var s={Date:i.date,Time:n[0],Title:n[1],Type:0};n.length>=3&&n[2]&&"string"==typeof n[2]&&(s.Color=n[2]),n.length>=4&&n[3]&&"string"==typeof n[3]&&(s.BGColor=n[3]),this.Data.push(s)}else{if(!ha.IsNumber(n.Date)||!ha.IsNumber(n.Time)||!n.Title)continue;s={Date:n.Date,Time:n.Time,Title:n.Title,Type:0};n.Color&&(s.Color=n.Color),n.BGColor&&(s.BGColor=n.BGColor),ha.IsNumber(n.Price)&&(s.Price=n.Price),n.Content&&(s.Content=n.Content),n.Link&&(s.Link=n.Link),this.Data.push(s)}}}e.HQChart.UpdataChartInfo(),e.HQChart.Draw()}}function pr(){this.DataMap=new E.default([["ChartPictureSettingMenu",{Create:function(t){return new Rr(t)}}],["ChartPictureTextSettingMenu",{Create:function(t){return new Pr(t)}}]]),this.Create=function(t,e){if(!this.DataMap.has(t))return w.Warn("[DialogFactory::Create] can't find class="+t+"."),null;var a=this.DataMap.get(t);return a.Create(e)},this.Add=function(t,e){this.DataMap.set(t,{Create:e.Create})}}Bi.Get=function(t){var e=new E.default([["å¸åºå¤ç©º",{IsMainIndex:!1,Create:function(){return new er}}],["å¸åºæ©æ¶",{IsMainIndex:!1,Create:function(){return new ar}}],["å¸åºå³æ³¨åº¦",{IsMainIndex:!1,Create:function(){return new ir}}],["ææ°ç­åº¦",{IsMainIndex:!1,Create:function(){return new rr}}],["è´¢å¡ç²é¥°",{IsMainIndex:!1,Create:function(){return new sr}}],["èªå®ä¹ææ°ç­åº¦",{IsMainIndex:!1,Create:function(){return new nr},Name:"èªå®ä¹ææ°ç­åº¦"}],["CJL",{IsMainIndex:!1,Create:function(){return new tr}}],["OX",{IsMainIndex:!1,Create:function(){return new ji}}],["å¯è§èå´æäº¤éåå¸å¾",{IsMainIndex:!0,Create:function(t){return new $i(t)}}]]);return e.get(t)},Vi.EMA=function(t,e){var a=[],i=0;if(i>=t.length)return a;for(;i<t.length;++i)if(null!=t[i]&&!isNaN(t[i]))break;var r=i,n=i+1;a[r]=t[r];for(var s=i+1;s<t.length;++s,++r,++n)a[n]=(2*t[n]+(e-1)*a[r])/(e+1);return a},Vi.SMA=function(t,e,a){for(var i=[],r=0,n=null;r<t.length;++r)if(null!=t[r]&&!isNaN(t[r])){n=t[r],i[r]=n;break}for(++r;r<t.length;++r)i[r]=(a*t[r]+(e-a)*n)/e,n=i[r];return i},Vi.DMA=function(t,e){var a=[];if(t.length<0||t.length!=e.length)return a;for(var i=0;i<t.length;++i)if(null!=t[i]&&!isNaN(t[i])&&null!=e[i]&&!isNaN(e[i])){a[i]=t[i];break}for(i+=1;i<t.length;++i)null==t[i]||null==e[i]?a[i]=null:t[i]<1?a[i]=e[i]*t[i]+(1-e[i])*a[i-1]:a[i]=t[i];return a},Vi.HHV=function(t,e){var a=[];if(e>t.length)return a;for(var i=-1e4,r=e,n=0;r<t.length;++r,++n){if(r<e+i)i=t[r]<t[i]?i:r;else for(n=1+(i=r-e+1);n<=r;++n)t[n]>t[i]&&(i=n);a[r]=t[i]}return a},Vi.LLV=function(t,e){var a=[];if(e>t.length)return a;for(var i=-1e4,r=e;r<t.length;++r,++n){if(r<e+i)i=t[r]>t[i]?i:r;else for(var n=1+(i=r-e+1);n<=r;++n)t[n]<t[i]&&(i=n);a[r]=t[i]}return a},Vi.REF=function(t,e){var a=[];if(t.length<=0)return a;if(e>=t.length)return a;a=t.slice(0,t.length-e);for(var i=0;i<e;++i)a.unshift(null);return a},Vi.REFDATE=function(t,e){var a=[];if(t.length<=0)return a;for(var i in e=t.length-1,t)a[i]=t[e];return a},Vi.SUM=function(t,e){var a=[];if(0==e){a[0]=t[0];for(var i=1;i<t.length;++i)a[i]=a[i-1]+t[i]}else{i=e-1;for(var r=0;i<t.length;++i,++r)for(var n=0;n<e;++n)0==n?a[i]=t[n+r]:a[i]+=t[n+r]}return a},Vi.ARRAY_SUBTRACT=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)null==t[r]||isNaN(t[r])?a[r]=null:a[r]=t[r]-e;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?null==t[r]||null==e[r]?a[r]=null:a[r]=t[r]-e[r]:a[r]=null}return a},Vi.ARRAY_GT=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)a[r]=t[r]>e?1:0;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?a[r]=t[r]>e[r]?1:0:a[r]=null}return a},Vi.ARRAY_GTE=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)a[r]=t[r]>=e?1:0;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?a[r]=t[r]>=e[r]?1:0:a[r]=null}return a},Vi.ARRAY_LT=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)a[r]=t[r]<e?1:0;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?a[r]=t[r]<e[r]?1:0:a[r]=null}return a},Vi.ARRAY_LTE=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)a[r]=t[r]<=e?1:0;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?a[r]=t[r]<=e[r]?1:0:a[r]=null}return a},Vi.ARRAY_EQ=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)a[r]=t[r]==e?1:0;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?a[r]=t[r]==e[r]?1:0:a[r]=null}return a},Vi.ARRAY_IF=function(t,e,a){var i=[],r=["number"==typeof e,"number"==typeof a];for(var n in t)t[n]?r[0]?i[n]=e:i[n]=e[n]:r[1]?i[n]=a:i[n]=a[n];return i},Vi.ARRAY_AND=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)a[r]=t[r]&&e?1:0;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?a[r]=t[r]&&e[r]?1:0:a[r]=0}return a},Vi.ARRAY_OR=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)a[r]=t[r]||e?1:0;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&t[r]||r<e.length&&e[r]?a[r]=1:a[r]=0}return a},Vi.ARRAY_MULTIPLY=function(t,e){if(2==arguments.length){var a=[],i="number"==typeof e;if(i)for(var r in t)null==t[r]||isNaN(t[r])?a[r]=null:a[r]=t[r]*e;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?a[r]=t[r]*e[r]:a[r]=null}return a}for(a=Vi.ARRAY_MULTIPLY(arguments[0],arguments[1]),r=2;r<arguments.length;++r)a=Vi.ARRAY_MULTIPLY(a,arguments[r]);return a},Vi.ARRAY_DIVIDE=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)a[r]=t[r]/e;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?null==t[r]||null==e[r]||isNaN(t[r])||isNaN(e[r])||0==e[r]?a[r]=null:a[r]=t[r]/e[r]:a[r]=null}return a},Vi.ARRAY_ADD=function(t,e){if(2==arguments.length){var a=[],i="number"==typeof e;if(i)for(var r in t)a[r]=t[r]+e;else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?null==t[r]||null==e[r]||isNaN(t[r])||isNaN(e[r])?a[r]=null:a[r]=t[r]+e[r]:a[r]=null}return a}for(a=Vi.ARRAY_ADD(arguments[0],arguments[1]),r=2;r<arguments.length;++r)a=Vi.ARRAY_ADD(a,arguments[r]);return a},Vi.MAX=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)null==t[r]?a[r]=null:a[r]=Math.max(t[r],e);else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?null==t[r]||null==e[r]?a[r]=null:a[r]=Math.max(t[r],e[r]):a[r]=null}return a},Vi.MIN=function(t,e){var a=[],i="number"==typeof e;if(i)for(var r in t)null==t[r]?a[r]=null:a[r]=Math.min(t[r],e);else{var n=Math.max(t.length,e.length);for(r=0;r<n;++r)r<t.length&&r<e.length?null==t[r]||null==e[r]?a[r]=null:a[r]=Math.min(t[r],e[r]):a[r]=null}return a},Vi.ABS=function(t){var e=[];for(var a in t)null==t[a]?e[a]=null:e[a]=Math.abs(t[a]);return e},Vi.MA=function(t,e){for(var a=[],i=0,r=t.length;i<r;i++)if(i<e)a[i]=null;else{for(var n=0,s=0;s<e;s++)n+=t[i-s];a[i]=n/e}return a},Vi.EXPMA=function(t,e){var a=[];if(e>=t.length)return a;for(var i=e;i<t.length;++i)if(null!=t[i]){a[i]=t[i];break}for(i+=1;i<t.length;++i)null!=a[i-1]&&null!=t[i]?a[i]=(2*t[i]+(e-1)*a[i-1])/(e+1):null!=a[i-1]&&(a[i]=a[i-1]);return a},Vi.EXPMEMA=function(t,e){var a=[];if(e>=t.length)return a;for(var i=0;i<t.length;++i)if(t[i]&&!isNaN(t[i]))break;for(var r=0,n=0;i<t.length&&n<e;++n,++i)t[i]&&!isNaN(t[i])?r+=t[i]:r+=t[i-1];for(a[i-1]=r/e;i<t.length;++i)null!=a[i-1]&&null!=t[i]?a[i]=(2*t[i]+(e-1)*a[i-1])/(e+1):null!=a[i-1]&&(a[i]=a[i-1]);return a},Vi.STD=function(t,e){for(var a=[],i=0,r=[],n=e-1;n<t.length;++n){i=0;for(var s=0;s<e;++s)i+=t[n-s];r[n]=i/e}for(n=e-1;n<t.length;++n){i=0;for(s=0;s<e;++s)i+=Math.pow(t[n-s]-r[n],2);a[n]=Math.sqrt(i/e)}return a},Vi.AVEDEV=function(t,e){for(var a=[],i=0,r=[],n=e-1;n<t.length;++n){i=0;for(var s=0;s<e;++s)i+=t[n-s];r[n]=i/e}for(n=e-1;n<t.length;++n){i=0;for(s=0;s<e;++s)i+=Math.abs(t[n-s]-r[n]);a[n]=i/e}return a},Vi.COUNT=function(t,e){for(var a=[],i=e-1;i<t.length;++i){for(var r=0,n=0;n<e;++n)t[i-n]&&++r;a[i]=r}return a},Vi.CROSS=function(t,e){var a=[];if(t.length!=e.length)return[];for(var i=0;i<t.length;++i)if(null!=t[i]&&!isNaN(t[i])&&null!=e[i]&&isNaN(e[i]))break;for(++i;i<t.length;++i)a[i]=t[i]>e[i]&&t[i-1]<e[i-1]?1:0;return a},Vi.MULAR=function(t,e){var a=[];if(t.length<e)return a;for(var i=e;i<t.length;++i)if(null!=t[i]&&!isNaN(t[i])){a[i]=t[i];break}for(++i;i<t.length;++i)a[i]=a[i-1]*t[i];return a},Vi.STICKLINE=function(t,e,a){var i=[];if(t.length<=0)return i;var r="number"==typeof e,n="number"==typeof a;for(var s in t)if(i[s]=null,!isNaN(t[s])&&t[s])if(r&&n)i[s]={Value:e,Value2:a};else if(r&&!n){if(isNaN(a[s]))continue;i[s]={Value:e,Value2:a[s]}}else if(!r&&n){if(isNaN(e[s]))continue;i[s]={Value:e[s],Value2:a}}else{if(isNaN(e[s])||isNaN(a[s]))continue;i[s]={Value:e[s],Value2:a[s]}}return i},Gi.JsonDataToHistoryData=function(t){var e=[];if(!t.data)return e;var a=null;t.symbol&&(a=t.symbol.toUpperCase());a&&Br.IsFutures(a);for(var i=t.data,r=0,n=1,s=2,o=3,h=4,l=5,u=6,C=7,D=8,f=9,c=10,d=11,m=12,v=_.KLINE_ORDERFLOW,S=_.KLINE_COLOR_DATA,I=0;I<i.length;++I){var p=new xt,T=i[I];p.Date=T[r],p.Open=T[s],p.YClose=T[n],p.Close=T[l],p.High=T[o],p.Low=T[h],p.Vol=T[u],p.Amount=T[C],ha.IsNumber(T[D])&&(p.Position=T[D]),ha.IsNumber(T[f])&&(p.FClose=T[f]),ha.IsNumber(T[c])&&(p.YFClose=T[c]),ha.IsNumber(T[d])&&(p.BFactor=T[d]),ha.IsNumber(T[m])&&(p.AFactor=T[m]),ha.IsNumber(p.Open)&&(T[v]&&(p.OrderFlow=T[v]),T[S]&&(p.ColorData=T[S]),e.push(p))}return e},Gi.JsonDataToRealtimeData=function(t,e){if(!t.stock)return null;var a;for(var i in t.stock){var r=t.stock[i];if(r&&r.symbol==e){a=r;break}}if(!a)return null;var n=e.toUpperCase(),s=(Br.IsSHSZ(n),new xt);return s.Date=a.date,s.Open=a.open,s.YClose=a.yclose,s.High=a.high,s.Low=a.low,s.Vol=a.vol,s.Amount=a.amount,s.Close=a.price,ha.IsNumber(a.position)&&(s.Position=a.position),ha.IsNumber(a.bfactor)&&(s.BFactor=a.bfactor),ha.IsNumber(a.afactor)&&(s.AFactor=a.afactor),a.colordata&&(s.ColorData=a.colordata),s},Gi.JsonDataToMinuteRealtimeData=function(t,e){if(!t.stock)return null;var a;for(var i in t.stock){var r=t.stock[i];if(r&&r.symbol==e){a=r;break}}if(!a)return null;var n=e.toUpperCase(),s=(Br.IsSHSZ(n),Br.IsFutures(n)),o=new Array,h=a.yclose,l=a.date;for(var i in s&&a.yclearing&&(h=a.yclearing),a.minute){var u=a.minute[i],C=new xt;C.Close=u.price,C.Open=u.open,C.High=u.high,C.Low=u.low,C.Vol=u.vol,C.Amount=u.amount,u.date>0?C.Date=u.date:C.Date=l,C.Time=u.time,C.YClose=h,ha.IsNumber(u.position)&&(C.Position=u.position),ha.IsNumber(C.Close)||(C.Close=h,C.Open=C.High=C.Low=C.Close),ha.IsNumber(C.Open)||(C.Open=null),ha.IsNumber(C.Close)||(C.Close=null),ha.IsNumber(C.High)||(C.High=null),ha.IsNumber(C.Low)||(C.Low=null),ha.IsNumber(u.price)&&(h=u.price),o[i]=C}return o},Gi.JsonDataToMinuteRealtimeDataV2=function(t,e){if(!t||!t.overlay||!e)return null;for(var a=null,i=0;i<t.overlay.length;++i){var r=t.overlay[i];if(r.symbol==e){a=r;break}}if(!a)return null;var n=e.toUpperCase(),s=(Br.IsSHSZ(n),Br.IsFutures(n),0),o=1,h=2,l=3,u=4,C=5,D=6,f=7,c=8,d=9,m=_.KLINE_ORDERFLOW,v=null;for(i=0;i<a.data.length;++i){r=new xt;var S=a.data[i];r.Date=S[s],r.Open=S[h],r.YClose=S[o],r.Close=S[C],r.High=S[l],r.Low=S[u],r.Vol=S[D],r.Amount=S[f],r.Time=S[c],ha.IsNumber(S[d])&&(r.Position=S[d]),ha.IsNumber(r.YClose)||ha.IsNumber(v)&&(r.YClose=v),ha.IsNumber(r.Close)&&(v=r.Close),S[m]&&(r.OrderFlow=S[m]),aryMinuteData.push(r)}return aryMinuteData},Gi.JsonDataToMinuteHistoryData=function(t){var e=null;t.symbol&&(e=t.symbol.toUpperCase());e&&Br.IsSHSZ(e);e&&Br.IsFutures(e);for(var a=t.data,i=new Array,r=0,n=1,s=2,o=3,h=4,l=5,u=6,C=7,D=8,f=9,c=_.KLINE_ORDERFLOW,d=_.KLINE_COLOR_DATA,m=null,v=0;v<a.length;++v){var S=new xt,I=a[v];S.Date=I[r],S.Open=I[s],S.YClose=I[n],S.Close=I[l],S.High=I[o],S.Low=I[h],S.Vol=I[u],S.Amount=I[C],S.Time=I[D],ha.IsNumber(I[f])&&(S.Position=I[f]),ha.IsNumber(S.YClose)||ha.IsNumber(m)&&(S.YClose=m),ha.IsNumber(S.Close)&&(m=S.Close),I[c]&&(S.OrderFlow=I[c]),I[d]&&(S.ColorData=I[d]),i.push(S)}return i},Gi.JsonDataToTickData=function(t){var e=[];if(!t.detail)return e;var a=t.date,i=t.yclose;for(var r in t.detail){var n=new xt,s=t.detail[r];s&&(n.Date=a,n.Time=s[0],n.Low=n.High=n.Close=n.Open=s[1],n.YClose=i,n.Vol=s[2],n.Amount=s[3],n.Flag=s[4],ha.IsNumber(n.Open)&&e.push(n))}return e},Gi.JsonDataToTickDataV2=function(t){var e=[];if(!ha.IsNonEmptyArray(t.data))return e;for(var a=0;a<t.data.length;++a){var i=new xt,r=t.data[a];r&&(i.Date=r[0],i.Time=r[1],i.YClose=r[2],i.Low=i.High=i.Close=i.Open=r[3],e.push(i),r[4]&&(i.ExtendData=r[4]))}return e},Hi.JsonDataToBeforeOpenData=function(t){var e=t.stock[0].yclose,a=t.stock[0],i=a.date,r={Data:[],TotalCount:15,Ver:1,Date:i};if(a.beforeinfo&&(ha.IsNumber(a.beforeinfo.totalcount)&&(r.TotalCount=a.beforeinfo.totalcount),ha.IsNumber(a.beforeinfo.ver)&&(r.Ver=a.beforeinfo.ver)),1==r.Ver)for(var n in a.before){var s=new yt,o=a.before[n];s.Time=o[0],s.Date=i,s.Price=o[1],s.Price?e=s.Price:s.Price=e,s.Vol[0]=o[2]/100,s.Amount=o[3],s.DateTime=i.toString()+" "+s.Time.toString(),r.Data.push(s)}else if(2==r.Ver){var h=0;for(var n in a.before){s=new yt,o=a.before[n];s.Time=o[0],s.Date=i,s.Price=o[1],s.Vol[0]=o[2],s.Vol[1]=o[3],s.ColorID=o[4],s.DateTime=i.toString()+" "+s.Time.toString();var l=s.Vol[0]+s.Vol[1];ha.IsNumber(o[5])&&(l=o[5]),l>h&&(h=l),r.Data.push(s)}r.VolMax=h,r.VolMin=0}else if(3==r.Ver){h=0;for(var n in a.before){s=new yt,o=a.before[n];s.Time=o[0],s.Date=i,s.Price=o[1],s.AvPrice=o[2],s.Vol[0]=o[3],s.ColorID=o[4],s.DateTime=i.toString()+" "+s.Time.toString();l=s.Vol[0];ha.IsNumber(o[5])&&(l=o[5]),l>h&&(h=l),r.Data.push(s)}r.VolMax=h,r.VolMin=0}return r},Hi.JsonDataToAfterCloseData=function(t){t.stock[0].yclose;var e=t.stock[0],a=e.date;if(!e.afterinfo)return null;var i={Data:[],TotalCount:180,Ver:2,Date:a},r=e.afterinfo;if(ha.IsNumber(r.totalcount)&&(i.TotalCount=r.totalcount),ha.IsNumber(r.ver)&&(i.Ver=r.ver),2==i.Ver){var n=0;for(var s in e.after){r=new Lt;var o=e.after[s];r.Time=o[0],r.Date=a,r.Price=o[1],r.Vol[0]=o[2],r.Vol[1]=o[3],r.ColorID=o[4],r.DateTime=a.toString()+" "+r.Time.toString();var h=r.Vol[0]+r.Vol[1];ha.IsNumber(o[5])&&(h=o[5]),h>n&&(n=h),i.Data.push(r)}i.VolMax=n,i.VolMin=0}else if(3==i.Ver){n=0;for(var s in e.after){r=new Lt,o=e.after[s];r.Time=o[0],r.Date=a,r.Price=o[1],r.AvPrice=o[2],r.Vol[0]=o[3],r.ColorID=o[4],r.DateTime=a.toString()+" "+r.Time.toString();h=r.Vol[0];ha.IsNumber(o[5])&&(h=o[5]),h>n&&(n=h),i.Data.push(r)}i.VolMax=n,i.VolMin=0}return i},Hi.JsonDataToMinuteData=function(t,e){var a=t.stock[0].symbol,i=a.toUpperCase(),r=Br.IsSHSZ(i),n=Br.IsFutures(i),s=Br.IsSHO(i),o=Br.IsSZO(i),h=new Array,l=t.stock[0].yclose,u=t.stock[0].yclose,C=t.stock[0].yclose;n&&t.stock[0].yclearing&&(C=l=u=t.stock[0].yclearing);var D=t.stock[0].date;for(var f in t.stock[0].minute){var c=t.stock[0].minute[f],d=new Ft;d.Close=c.price,d.Open=c.open,d.High=c.high,d.Low=c.low,d.Vol=r?c.vol/100:c.vol,d.Amount=c.amount,c.date>0&&(D=c.date),d.DateTime=D.toString()+" "+c.time.toString(),d.Date=D,d.Time=c.time,(n||s||o)&&(d.Position=c.position),8<c.length&&c[8]>0&&(d.Date=c[8],d.DateTime=d.Date.toString()+" "+c[0].toString()),d.Increase=c.increase,d.Risefall=c.risefall,d.AvPrice=c.avprice,ha.IsNumber(c.lead)&&(d.Lead=c.lead),d.Close||(d.Close=l,d.Open=d.High=d.Low=d.Close),d.AvPrice||(d.AvPrice=u),d.Open<=0&&(d.Open=null),d.Close<=0&&(d.Close=null),d.AvPrice<=0&&(d.AvPrice=null),d.High<=0&&(d.High=null),d.Low<=0&&(d.Low=null),C&&d.Close&&(d.Increase=(d.Close-C)/C*100);var m=Math.abs(d.AvPrice-d.Close);r&&m>.13*d.Close&&(d.AvPrice=u),c.price>0&&(l=c.price),c.avprice>0&&d.AvPrice===c.avprice&&(u=c.avprice),c.ExtendData&&(d.ExtendData=c.ExtendData),h[f]=d}return h},Hi.JsonDataToMinuteLineColorData=function(t){if(!t||!t.stock[0])return null;var e=t.stock[0];if(!e.linecolor||!ha.IsNonEmptyArray(e.linecolor.data))return null;var a=[];for(var i in e.linecolor.data){var r=e.linecolor.data[i];if(ha.IsNumber(r.type)&&ha.IsNumber(r.date)&&ha.IsNumber(r.start)&&ha.IsNumber(r.end)&&r.color&&!(r.start>=r.end)){var n={Type:r.type,Date:r.date,Start:r.start,End:r.end,Color:r.color};ha.IsPlusNumber(r.linewidth)&&(n.LineWidth=r.linewidth),a.push(n)}}return a},Hi.JsonDataToMinuteLastUpdateTime=function(t){if(!t||!t.stock[0])return null;var e=t.stock[0];return ha.IsNumber(e.date)&&ha.IsNumber(e.time)?{Date:e.date,Time:e.time}:null},Hi.JsonDataToHistoryMinuteLastUpdateTime=function(t){if(!t||!t.updatetime)return null;var e=t.updatetime;return ha.IsNumber(e.date)&&ha.IsNumber(e.time)?{Date:e.date,Time:e.time}:null},Hi.JsonDataToMinuteDataArray=function(t){var e=t.symbol,a=e.toUpperCase(),i=Br.IsSHSZ(a),r=Br.IsSHO(a),n=Br.IsSZO(a),s=Br.IsFutures(a),o=[],h=_.MINUTE_MULTI_DAY_EXTENDDATA;for(var l in t.data){var u=[],C=t.data[l],D=C.date,f=C.yclose,c=f,d=null,m=C.yclearing;for(var v in C.minute){var S=C.minute[v];S[2]&&(c=S[2]);var I=new Ft;if(I.Close=S[2],I.Open=S[1],I.High=S[3],I.Low=S[4],I.Vol=i?S[5]/100:S[5],I.Amount=S[6],7<S.length&&S[7]>0&&(I.AvPrice=S[7]),I.DateTime=D.toString()+" "+S[0].toString(),I.Date=D,I.Time=S[0],8<S.length&&S[8]>0&&(I.Date=S[8],I.DateTime=I.Date.toString()+" "+S[0].toString()),(s||r||n)&&9<S.length&&(I.Position=S[9]),I.Close||(I.Close=c,I.Open=I.High=I.Low=I.Close),!I.AvPrice&&d&&(I.AvPrice=d),I.Close&&f?I.Increase=(I.Close-f)/f*100:I.Increase=null,I.Open<=0&&(I.Open=null),I.Close<=0&&(I.Close=null),I.AvPrice<=0&&(I.AvPrice=null),I.High<=0&&(I.High=null),I.Low<=0&&(I.Low=null),I.AvPrice<=0&&(I.AvPrice=null),I.AvPrice&&i){var p=Math.abs(I.AvPrice-I.Close);p>.13*I.Close&&(I.AvPrice=d)}S.length>7&&S[7]>0&&I.AvPrice===S[7]&&(d=S[7]),S[h]&&(I.ExtendData=S[h]),u[v]=I}var T=new Ot;T.Data=u,T.YClose=f,T.Close=C.close,T.Date=D,ha.IsNumber(m)&&(T.YClearing=m),o.push(T)}return o},Hi.JsonDataToHistoryMinuteLineColorData=function(t){if(!t)return null;var e=[];for(var a in t.data){var i=t.data[a];if(i.linecolor)for(var r in i.linecolor.data){var n=i.linecolor.data[r];if(ha.IsNumber(n.type)&&ha.IsNumber(n.date)&&ha.IsNumber(n.start)&&ha.IsNumber(n.end)&&n.color&&!(n.start>=n.end)){var s={Type:n.type,Date:n.date,Start:n.start,End:n.end,Color:n.color};ha.IsPlusNumber(n.linewidth)&&(s.LineWidth=n.linewidth),e.push(s)}}}return e.length>0?e:null},Hi.JsonDataToCallAuctionItem=function(t,e,a){var i=e.Date;if(1==e.Ver)for(var r in t){var n=a?new yt:new Lt,s=t[r];n.Time=s[0],n.Date=i,n.Price=s[1],n.Price?preClose=n.Price:n.Price=preClose,n.Vol[0]=s[2]/100,n.Amount=s[3],n.DateTime=i.toString()+" "+n.Time.toString(),e.Data.push(n)}else if(2==e.Ver){var o=0;for(var r in t){n=a?new yt:new Lt,s=t[r];n.Time=s[0],n.Date=i,n.Price=s[1],n.Vol[0]=s[2],n.Vol[1]=s[3],n.ColorID=s[4],n.DateTime=i.toString()+" "+n.Time.toString();var h=n.Vol[0]+n.Vol[1];ha.IsNumber(s[5])&&(h=s[5]),h>o&&(o=h),e.Data.push(n)}e.VolMax=o,e.VolMin=0}else if(3==beforeOpenData.Ver){o=0;for(var r in t){n=a?new yt:new Lt,s=t[r];n.Time=s[0],n.Date=i,n.Price=s[1],n.AvPrice=s[2],n.Vol[0]=s[3],n.ColorID=s[4],n.DateTime=i.toString()+" "+n.Time.toString();h=n.Vol[0];ha.IsNumber(s[5])&&(h=s[5]),h>o&&(o=h),e.Data.push(n)}e.VolMax=o,e.VolMin=0}},Hi.JosnDataToBeforeOpenDataArray=function(t){if(!t||!t.data)return null;var e=[];for(var a in t.data){var i=t.data[a],r={Data:[],TotalCount:15,Ver:1,Date:i.date};i.beforeinfo&&(ha.IsNumber(i.beforeinfo.totalcount)&&(r.TotalCount=i.beforeinfo.totalcount),ha.IsNumber(i.beforeinfo.ver)&&(r.Ver=i.beforeinfo.ver)),Hi.JsonDataToCallAuctionItem(i.before,r,!0),e.push(r)}return e.sort((function(t,e){return t.Date-e.Date})),e},Hi.JosnDataToAfterCloseDataArray=function(t){if(!t||!t.data)return null;var e=[];for(var a in t.data){var i=t.data[a],r={Data:[],TotalCount:15,Ver:1,Date:i.date};i.afterinfo&&(ha.IsNumber(i.afterinfo.totalcount)&&(r.TotalCount=i.afterinfo.totalcount),ha.IsNumber(i.afterinfo.ver)&&(r.Ver=i.afterinfo.ver)),Hi.JsonDataToCallAuctionItem(i.after,r,!1),e.push(r)}return e.sort((function(t,e){return t.Date-e.Date})),e},Yi.JsonDataToMinuteData=function(t){var e=[];for(var a in t.minute.time){var i=new Ft;t.minute.price[a]<=0&&a>0?(i.Close=e[a-1].Close,i.Open=e[a-1].Close,i.High=i.Close,i.Low=i.Close,i.Vol=t.minute.vol[a],i.Amount=t.minute.amount[a],i.DateTime=t.date.toString()+" "+t.minute.time[a].toString(),i.AvPrice=e[a-1].AvPrice):(i.Close=t.minute.price[a],i.Open=t.minute.open[a],i.High=t.minute.high[a],i.Low=t.minute.low[a],i.Vol=t.minute.vol[a],i.Amount=t.minute.amount[a],i.DateTime=t.date.toString()+" "+t.minute.time[a].toString(),i.AvPrice=t.minute.avprice[a]),i.Open<=0&&(i.Open=null),i.Close<=0&&(i.Close=null),i.AvPrice<=0&&(i.AvPrice=null),i.High<=0&&(i.High=null),i.Low<=0&&(i.Low=null),e[a]=i}return e},or.prototype.GetDefaultColor=function(t){var e=["rgb(255,174,0)","rgb(25,199,255)","rgb(175,95,162)","rgb(236,105,65)","rgb(68,114,196)","rgb(229,0,79)","rgb(0,128,255)","rgb(252,96,154)","rgb(42,230,215)","rgb(24,71,178)"],a=parseInt(t);return e[a%(e.length-1)]},lr.Get=function(t){var e=new E.default([["äºå¨æ",{Create:function(){return new Cr}}],["å¬å",{Create:function(){return new Dr}}],["ä¸ç»©é¢å",{Create:function(){return new fr}}],["è°ç ",{Create:function(){return new cr}}],["å¤§å®äº¤æ",{Create:function(){return new dr}}],["é¾èæ¦",{Create:function(){return new mr}}]]);return e.get(t)},lr.GetClassInfo=function(t){var e=new E.default([["äºå¨æ",{ClassName:"InvestorInfo"}],["å¬å",{ClassName:"AnnouncementInfo"}],["ä¸ç»©é¢å",{ClassName:"PforecastInfo"}],["è°ç ",{ClassName:"ResearchInfo"}],["å¤§å®äº¤æ",{ClassName:"BlockTrading"}],["é¾èæ¦",{ClassName:"TradeDetail"}]]);return e.get(t)},lr.GetIconUrl=function(t){switch(t){case Mt.INVESTOR:return Oi.KLine.Info.Investor.Icon;case Mt.PFORECAST:return Oi.KLine.Info.Pforecast.Icon;case Mt.ANNOUNCEMENT:return Oi.KLine.Info.Announcement.Icon;case Mt.ANNOUNCEMENT_QUARTER_1:case Mt.ANNOUNCEMENT_QUARTER_2:case Mt.ANNOUNCEMENT_QUARTER_3:case Mt.ANNOUNCEMENT_QUARTER_4:return Oi.KLine.Info.Announcement.IconQuarter;case Mt.RESEARCH:return Oi.KLine.Info.Research.Icon;case Mt.BLOCKTRADING:return Oi.KLine.Info.BlockTrading.Icon;case Mt.TRADEDETAIL:return Oi.KLine.Info.TradeDetail.Icon;default:return Oi.KLine.Info.Announcement.Icon}},lr.GetIconLibrary=function(t){var e=Oi.KLine.Info.IconLibrary;if(!e||!e.Icon)return Oi.KLine.Info.Announcement.IconFont;if(t>=0&&t<e.Icon.length){var a=e.Icon[t],i={Text:a.Text,HScreenText:a.HScreenText,Color:a.Color,Family:e.Family};return i}return Oi.KLine.Info.Announcement.IconFont},lr.GetIconFont=function(t){if(t>=Mt.ANNOUNCEMENT_EX_START&&t<=Mt.ANNOUNCEMENT_EX_END){var e=t-Mt.ANNOUNCEMENT_EX_START;return lr.GetIconLibrary(e)}switch(t){case Mt.INVESTOR:return Oi.KLine.Info.Investor.IconFont;case Mt.PFORECAST:return Oi.KLine.Info.Pforecast.IconFont;case Mt.ANNOUNCEMENT:return Oi.KLine.Info.Announcement.IconFont;case Mt.ANNOUNCEMENT_QUARTER_1:case Mt.ANNOUNCEMENT_QUARTER_2:case Mt.ANNOUNCEMENT_QUARTER_3:case Mt.ANNOUNCEMENT_QUARTER_4:return Oi.KLine.Info.Announcement.IconFont2;case Mt.RESEARCH:return Oi.KLine.Info.Research.IconFont;case Mt.BLOCKTRADING:return Oi.KLine.Info.BlockTrading.IconFont;case Mt.TRADEDETAIL:return Oi.KLine.Info.TradeDetail.IconFont;default:return Oi.KLine.Info.Announcement.IconFont}},vr.InfoMap=new E.default([["å¤§çå¼å¨",{Create:function(){return new Ir}}]]),vr.Get=function(t){return vr.InfoMap.get(t)};var Tr=new pr;function gr(t){this.DivElement=t,this.ID=null,this.TimeOut=null,this.Hide=function(){(0,A.default)("#"+this.ID).hide()},this.Show=function(t,e,a,i){var r={display:"block"};ha.IsNumber(t)&&(r.left=t+"px"),ha.IsNumber(e)&&(r.top=e+"px"),ha.IsNumber(a)&&(r.width=a+"px"),ha.IsNumber(i)&&(r.height=i+"px"),(0,A.default)("#"+this.ID).css(r)}}function xr(t){this.newMethod=gr,this.newMethod(t),delete this.newMethod,this.Title={ID:q()},this.ParamList={ID:q()},this.ParamData=[],this.Identify,this.HQChart,this.IsOverlay=!1,this.IndexScript,this.Create=function(){this.ID=q();var t=document.createElement("div");t.className="jchart-modifyindex-box",t.id=this.ID,t.innerHTML="<div class='parameter'>            <div class='parameter-header'>                <span></span>                <strong id='close' class='icon iconfont icon-close'></strong>            </div>            <div class='parameter-content'><input/>MA</div>            <div class='parameter-footer'>                <button class='submit' >ç¡®å®</button>                <button class='cancel' >åæ¶</button>            </div>        </div>",this.DivElement.appendChild(t),(0,A.default)("#"+this.ID+" .submit").click({divBox:this},(function(t){t.data.divBox.Hide()}));var e=t.getElementsByTagName("span")[0];e.id=this.Title.ID;var a=t.getElementsByClassName("parameter-content")[0];a.id=this.ParamList.ID},this.SetTitle=function(t){(0,A.default)("#"+this.Title.ID).html(t)},this.ClearParamList=function(){(0,A.default)("#"+this.ParamList.ID).empty(),this.ParamData=[]},this.BindParam=function(){for(var t=0;t<this.IndexScript.Arguments.length;++t){var e=this.IndexScript.Arguments[t];if(null==e.Name||isNaN(e.Value))break;var a=q(),i='<input class="row-line" id="'+a+'" value="'+e.Value+'" type="number" step="1"/>'+e.Name+"<br>";(0,A.default)("#"+this.ParamList.ID).append(i),this.ParamData.push({ID:a,Value:e.Value})}var r=this;for(t=0;t<this.ParamData.length;++t){e=this.ParamData[t];(0,A.default)("#"+e.ID).mouseup({ParamIndex:t},(function(t){var e=parseInt((0,A.default)(this).val());if(ha.IsNumber(e)){var a=r.HQChart,i=r.Identify,n=t.data.ParamIndex,s=r.IndexScript,o=r.IsOverlay;s.Arguments[n].Value=e,o?a.UpdateOverlayIndex(i):a.UpdateWindowIndex(i)}else alert("åæ°ä¸è½ä¸ºç©º")})),(0,A.default)("#"+e.ID).keyup({ParamIndex:t},(function(t){var e=parseInt((0,A.default)(this).val());if(ha.IsNumber(e)){var a=r.HQChart,i=r.Identify,n=t.data.ParamIndex,s=r.IndexScript,o=r.IsOverlay;s.Arguments[n].Value=e,o?a.UpdateOverlayIndex(i):a.UpdateWindowIndex(i)}else alert("åæ°ä¸è½ä¸ºç©º")}))}},this.BindCancel=function(){var t=this;(0,A.default)("#"+this.ID+" .cancel");(0,A.default)("#"+this.ID+" .cancel").unbind("click").click((function(e){var a=t.HQChart,i=t.Identify;t.RestoreParam();var r=t.IsOverlay;r?a.UpdateOverlayIndex(i):a.UpdateWindowIndex(i),t.IndexScript=null,t.Hide()})),(0,A.default)("#"+this.ID+" #close").unbind("click").click((function(e){var a=t.HQChart,i=t.Identify,r=t.IsOverlay;t.RestoreParam(),r?a.UpdateOverlayIndex(i):a.UpdateWindowIndex(i),t.IndexScript=null,t.Hide()}))},this.RestoreParam=function(){if(this.IndexScript)for(var t=0;t<this.ParamData.length;++t){var e=this.ParamData[t];this.IndexScript.Arguments[t].Value=e.Value}},this.DoModal=function(t){var e=t.data.Chart,a=t.data.Identify,i=e.ModifyIndexDialog,r=!0===t.data.IsOverlay;if(i){if(null==i.ID&&i.Create(),i.Identify=a,i.HQChart=e,i.IsOverlay=r,r){var n=e.GetOverlayIndexByIdentify(a);if(!n||!n.OverlayItem.Script)return;i.IndexScript=n.OverlayItem.Script,i.SetTitle(i.IndexScript.Name+" å å ææ åæ°è®¾ç½®")}else i.IndexScript=e.WindowIndex[a],i.SetTitle(i.IndexScript.Name+" ææ åæ°è®¾ç½®");i.ClearParamList(),i.BindParam(e,a),i.BindCancel(),i.Show()}}}function Fr(t){this.newMethod=gr,this.newMethod(t),delete this.newMethod,this.DivElement=t,this.IndexTreeApiUrl="https://opensourcecache.zealink.com/cache/hqh5/index/commonindextree.json",this.OverlayIndexTreeApiUrl="https://opensourcecache.zealink.com/cache/hqh5/index/commonindextree.json",this.IsOverlayIndex=!1,this.Create=function(){var t=document.createElement("div");t.className="jchart-changeindex-box",t.id=this.ID=q(),t.innerHTML='<div class="target-panel">\n            <div class="target-header">\n                <span>æ¢ææ </span>\n                <strong class="close-tar icon iconfont icon-close"></strong>\n            </div>\n            <div class="target-content">\n                <div class="target-left">\n                    <input type="text">\n                    <ul></ul>\n                </div>\n                <div class="target-right">\n                    <ul></ul>\n                </div>\n            </div>\n        </div>',this.DivElement.appendChild(t)},this.ReqeustData=function(){if((0,A.default)("#"+this.ID+" .target-left ul li").length>0)return!1;var t=this.IndexTreeApiUrl;function e(t){(0,A.default)(".target-left ul").html(""),A.default.each(t,(function(t,e){var a;a="<li>"+e.node+"</li>",(0,A.default)(".target-left ul").append(a)})),(0,A.default)(".target-left ul li:first-child").addClass("active-list")}function a(t){var e,a=[];A.default.each(t,(function(t,e){a.push(e.list)})),A.default.each(a[0],(function(t,a){e="<li id="+a.id+">"+a.name+"</li>",(0,A.default)(".target-right ul").append(e)})),(0,A.default)(".target-left ul").delegate("li","click",(function(){(0,A.default)(this).addClass("active-list").siblings().removeClass("active-list");var t=(0,A.default)(this).index();(0,A.default)(".target-right ul").html(""),A.default.each(a[t],(function(t,a){e="<li id="+a.id+">"+a.name+"</li>",(0,A.default)(".target-right ul").append(e)}))}))}1==this.IsOverlayIndex&&(t=this.OverlayIndexTreeApiUrl),O.HttpRequest({url:t,type:"get",success:function(t){var i=t.list;e(i),a(i)}})},this.BindClose=function(t){(0,A.default)("#"+this.ID+" .close-tar").click({Chart:t},(function(t){var e=t.data.Chart;e.ChangeIndexDialog.Hide()}))},this.BindSearch=function(t){(0,A.default)(".target-left input").on("input",{Chart:t},(function(t){var e=new B,a=e.Search(t.target.value);for(var i in(0,A.default)(".target-right ul").html(""),a){var r=a[i],n="<li id="+r+">"+r+"</li>";(0,A.default)(".target-right ul").append(n)}}))},this.DoModal=function(t){var e=t.data.Chart,a=t.data.Identify,i=e.ChangeIndexDialog,r=t.data.IsOverlay;function n(){(0,A.default)(".target-right ul").undelegate().delegate("li","click",(function(){var t=(0,A.default)(this).attr("id");r?e.AddOverlayIndex({WindowIndex:a,IndexName:t}):e.ChangeIndex(a,t),(0,A.default)(this).addClass("active-list").siblings().removeClass("active-list")}))}i&&(null==i.ID&&i.Create(),i.IsOverlayIndex=r,i.ReqeustData(),n(),i.BindSearch(e),i.BindClose(e),i.Show())}}function yr(t){this.newMethod=gr,this.newMethod(t),delete this.newMethod,this.JSChart=null,this.Height=500,this.Width=600,this.Symbol,this.TradeDate,this.HistoryData,this.Show=function(t,e,a,i){var r=document.getElementById(this.ID);if(!r)return!1;var n=r.getElementsByClassName("minute-hqchart");if(!n||1!=n.length)return!1;var s=n[0];ha.IsNumber(a)&&(r.style.width=a+"px"),ha.IsNumber(i)&&(r.style.height=i+"px"),ha.IsNumber(t)&&(r.style.left=t+"px"),ha.IsNumber(e)&&(r.style.top=e+"px"),r.style.display="block";var o=s.offsetWidth,h=s.offsetTop;s.style.width=o+"px",s.style.height=i-h-5+"px"},this.Create=function(){this.ID=q();var t=document.createElement("div");t.className="jchart-kline-minute-box",t.id=this.ID;var e=q();t.innerHTML="<div><div class='minute-dialog-title'><span></span><strong class='close-munite icon iconfont icon-close'></strong></div><div class='minute-hqchart' id='"+e+"' ></div></div>",t.style.width=this.Height+"px",t.style.height=this.Width+"px",this.DivElement.appendChild(t),this.JSChart=V.Init(document.getElementById(e));var a={Type:"åå²åéèµ°å¿å¾",Symbol:this.Symbol,IsAutoUpdate:!1,IsShowRightMenu:!1,HistoryMinute:{TradeDate:this.TradeDate,IsShowName:!1,IsShowDate:!1}};this.JSChart.SetOption(a)},this.BindClose=function(t){(0,A.default)("#"+this.ID+" .close-munite").click({Chart:t},(function(t){var e=t.data.Chart;e.MinuteDialog.Hide()}))},this.DoModal=function(t){this.UpColor=Oi.UpTextColor,this.DownColor=Oi.DownTextColor,this.UnchagneColor=Oi.UnchagneTextColor;var e=t.data.Chart,a=t.data.Tooltip,i=e.MinuteDialog;if(i.Symbol=e.Symbol,i.TradeDate=a.Data.Date,i){null==i.ID?i.Create():(i.JSChart.JSChartContainer.TradeDate=i.TradeDate,i.JSChart.ChangeSymbol(this.Symbol));t.clientX,t.clientY;var r=U();i.Show(500/r,100/r,600,500),i.JSChart.OnSize(),this.BindClose(e),this.GetColor=function(t,e){return t>e?this.UpColor:t<e?this.DownColor:this.UnchagneColor};var n=t.data.Chart.Name,s=t.data.Tooltip.Data,o=(new Date(parseInt(s.Date/1e4),s.Date/100%100-1,s.Date%100),s.Date.toString()),h=o.substring(0,4)+"-"+o.substring(4,6)+"-"+o.substring(6,8),l="<span>"+n+"</span><span>"+h+"</span>&nbsp;<span style='color:"+this.GetColor(s.Open,s.YClose)+";'>å¼:"+s.Open.toFixed(2)+"</span><span style='color:"+this.GetColor(s.High,s.YClose)+";'>é«:"+s.High.toFixed(2)+"</span><span style='color:"+this.GetColor(s.Low,s.YClose)+";'>ä½:"+s.Low.toFixed(2)+"</span><span style='color:"+this.GetColor(s.Close,s.YClose)+";'>æ¶:"+s.Close.toFixed(2)+"</span><span style='color:"+this.VolColor+";'>é:"+ha.FormatValueString(s.Vol,2)+"</span><span style='color:"+this.AmountColor+";'>é¢:"+ha.FormatValueString(s.Amount,2)+"</span>";(0,A.default)(".minute-dialog-title span").html(l)}}}function Lr(t){this.newMethod=gr,this.newMethod(t),delete this.newMethod,this.SelectData,this.Dialog,this.HQChart,this.RectSelectPaint,this.Close=function(){this.Dialog&&(this.DivElement.removeChild(this.Dialog),this.Dialog=null,this.ID=null),this.RectSelectPaint&&(this.RectSelectPaint.PreventClose=!1)},this.Create=function(){this.ID=q();var t=document.createElement("div");t.className="jchart-select-statistics-box",t.id=this.ID,t.innerHTML="<div class='parameter jchart-select-section'>            <div class='parameter-header'>                <span>åæ¶å¾åºé´ç»è®¡</span>                <strong id='close' class='icon iconfont icon-close'></strong>            </div>            <div class='parameter-content'>ç»è®¡æ°æ®</div>        <div class='parameter-footer'>            <button id='close' class='submit' >ç¡®å®</button>        </div>        </div>",this.DivElement.appendChild(t),this.Dialog=t,(0,A.default)("#"+this.ID+" #close").click({divBox:this},(function(t){t.data.divBox.Close()}))},this.BindData=function(){var t=this.SelectData.Data,e=this.SelectData.Start,a=this.SelectData.End;this.HQChart.UpdateSelectRect(e,a),this.RectSelectPaint&&(this.RectSelectPaint.PreventClose=!0);for(var i={Open:0,Close:0,High:0,Low:0,Vol:0,Amount:0,Date:{Start:{Time:null,Date:null},End:{Time:null,Date:null}},Count:0},r=e;r<=a&&r<t.Data.length;++r){var n=t.Data[r];r==e&&(i.Date.Start.Date=n.Date,i.Date.Start.Time=n.Time,i.Open=n.Close,i.High=n.High,i.Low=n.Low),i.Date.End.Date=n.Date,i.Date.End.Time=n.Time,i.Close=n.Close,i.Vol+=n.Vol,i.Amount+=n.Amount,++i.Count,i.High<n.High&&(i.High=n.High),i.Low>n.Low&&(i.Low=n.Low)}i.Vol>0&&(i.AvPrice=i.Amount/i.Vol),n.Open>0&&(i.Increase=(i.Close-i.Open)/i.Open*100,i.Amplitude=(i.High-i.Low)/i.Open*100);var s=rn(this.SelectData.Symbol),o=ha.FormatDateString(i.Date.Start.Date),h=ha.FormatDateString(i.Date.End.Date);o+=" "+ha.FormatTimeString(i.Date.Start.Time,"HH:MM"),h+=" "+ha.FormatTimeString(i.Date.End.Time,"HH:MM");var l="",u="",C="",D="";e<=0&&(l="BtnBackground"),e>=a&&(u="BtnBackground",C="BtnBackground"),a>=t.Data.length-1&&(D="BtnBackground");var f=document.createElement("div");f.className="jchart-select-table-right",f.innerHTML='<div class="jchart-select-date">\n            <span>å¼å§: '+o+'<i class="start-date-left '+l+'"><</i><i class="start-date-right '+u+'">></i></span>\n            <span>ç»æ: '+h+'<i class="end-date-left '+C+'"><</i><i class="end-date-right '+D+'">></i></span>\n            <span>æ»ä¸ªæ°: '+i.Count+"</span>\n        </div>\n        <table>\n            <tr><td><strong>èµ·å§ä»·: </strong><span>"+i.Open.toFixed(s)+"</span></td>               <td><strong>ç»æ­¢ä»·: </strong><span>"+i.Close.toFixed(s)+"</span></td>               <td><strong>åä»·: </strong><span>"+(ha.IsNumber(i.AvPrice)?i.AvPrice.toFixed(s):"--.--")+"</span></td></tr>\n            <tr><td><strong>æä½ä»·: </strong><span>"+i.Low.toFixed(s)+"</span></td>               <td><strong>æé«ä»·: </strong><span>"+i.High.toFixed(s)+'</span></td>               <td><strong>æ¶¨è·å¹: </strong><span class="'+ha.FormatValueColor(i.Increase)+'">'+i.Increase.toFixed(2)+"%</span></td></tr>\n            <tr><td><strong>æ¯å¹: </strong><span>"+i.Amplitude.toFixed(2)+"%</span></td>               <td><strong>æäº¤é: </strong><span>"+ha.FormatValueString(i.Vol,2)+"è¡</span></td>               <td><strong>éé¢: </strong><span>"+ha.FormatValueString(i.Amount,2)+"å</span></td></tr>\n        </table>",(0,A.default)(".parameter-content").html(f),this.BindEvent()},this.BindEvent=function(){var t=this;t.SelectData.Start>0&&(0,A.default)(".jchart-select-date .start-date-left").click((function(){t.SelectData.Start--,t.BindData(),t.HQChart.UpdateSelectRect(t.SelectData.Start,t.SelectData.End)})),t.SelectData.Start<t.SelectData.End&&((0,A.default)(".jchart-select-date .start-date-right").click((function(){t.SelectData.Start++,t.BindData(),t.HQChart.UpdateSelectRect(t.SelectData.Start,t.SelectData.End)})),(0,A.default)(".jchart-select-date .end-date-left").click((function(){t.SelectData.End--,t.BindData(),t.HQChart.UpdateSelectRect(t.SelectData.Start,t.SelectData.End)}))),t.SelectData.End<t.SelectData.Data.Data.length-1&&(0,A.default)(".jchart-select-date .end-date-right").click((function(){t.SelectData.End++,t.BindData(),t.HQChart.UpdateSelectRect(t.SelectData.Start,t.SelectData.End)}))},this.DoModal=function(t){var e=t.data.Chart;null==this.ID&&this.Create(),this.SelectData=t.data.SelectData,this.RectSelectPaint=t.data.RectSelectPaint,this.HQChart=e,this.HQChart.HideSelectRect(),this.BindData(),this.Show()}}function Er(t){this.newMethod=gr,this.newMethod(t),delete this.newMethod,this.SelectData,this.Dialog,this.HQChart,this.RectSelectPaint,this.Close=function(){this.Dialog&&(this.DivElement.removeChild(this.Dialog),this.Dialog=null),this.RectSelectPaint&&(this.RectSelectPaint.PreventClose=!1)},this.Create=function(){this.ID=q();var t=document.createElement("div");t.className="jchart-select-statistics-box",t.id=this.ID,t.innerHTML="<div class='parameter jchart-select-section'>            <div class='parameter-header'>                <span>åºé´ç»è®¡</span>                <strong id='close' class='icon iconfont icon-close'></strong>            </div>            <div class='parameter-content'>ç»è®¡æ°æ®</div>        <div class='parameter-footer'>            <button id='close' class='submit' >ç¡®å®</button>            <button id='match' class='submit' >å½¢æå¹é</button>        </div>        </div>",this.DivElement.appendChild(t),this.Dialog=t,(0,A.default)("#"+this.ID+" #close").click({divBox:this},(function(t){t.data.divBox.Close()})),(0,A.default)("#"+this.ID+" #match").click({divBox:this},(function(t){t.data.divBox.KLineMatch()}))},this.BindData=function(){var t=this.SelectData.Data,e=this.SelectData.Start,a=this.SelectData.End;this.HQChart.UpdateSelectRect(e,a),this.RectSelectPaint&&(this.RectSelectPaint.PreventClose=!0);for(var i={Open:0,Close:0,High:0,Low:0,YClose:0,Vol:0,Amount:0,Date:{Start:{Time:null,Date:null},End:{Time:null,Date:null}},Count:0,KLine:{Up:0,Down:0,Unchanged:0}},r=e;r<=a&&r<t.Data.length;++r){var n=t.Data[r];r==e&&(i.Date.Start.Date=n.Date,i.Date.Start.Time=n.Time,i.Open=n.Open,i.High=n.High,i.Low=n.Low,i.YClose=n.YClose),i.Date.End.Date=n.Date,i.Date.End.Time=n.Time,i.Close=n.Close,i.Vol+=n.Vol,i.Amount+=n.Amount,++i.Count,i.High<n.High&&(i.High=n.High),i.Low>n.Low&&(i.Low=n.Low),n.Close>n.Open?++i.KLine.Up:n.Close<n.Open?++i.KLine.Down:++i.KLine.Unchanged}i.Vol>0&&(i.AvPrice=i.Amount/i.Vol),n.YClose>0&&(i.Increase=(i.Close-i.YClose)/i.YClose*100,i.Amplitude=(i.High-i.Low)/i.YClose*100);var s=rn(this.SelectData.Symbol),o=ha.FormatDateString(i.Date.Start.Date),h=ha.FormatDateString(i.Date.End.Date);Ot.IsMinutePeriod(this.HQChart.Period)?(o+=" "+ha.FormatTimeString(i.Date.Start.Time,"HH:MM"),h+=" "+ha.FormatTimeString(i.Date.End.Time,"HH:MM")):(Ot.IsSecondPeriod(this.HQChart.Period)||Ot.IsTickPeriod(this.HQChart.Period))&&(o+=" "+ha.FormatTimeString(i.Date.Start.Time,"HH:MM:SS"),h+=" "+ha.FormatTimeString(i.Date.End.Time,"HH:MM:SS"));var l="",u="",C="",D="";e<=0&&(l="BtnBackground"),e>=a&&(u="BtnBackground",C="BtnBackground"),a>=t.Data.length-1&&(D="BtnBackground");var f=document.createElement("div");f.className="jchart-select-table-right",f.innerHTML='<div class="jchart-select-date">\n            <span>å¼å§: '+o+'<i class="start-date-left '+l+'"><</i><i class="start-date-right '+u+'">></i></span>\n            <span>ç»æ: '+h+'<i class="end-date-left '+C+'"><</i><i class="end-date-right '+D+'">></i></span>\n            <span>æ»ä¸ªæ°: '+i.Count+"</span>\n        </div>\n        <table>\n            <tr><td><strong>èµ·å§ä»·: </strong><span>"+i.YClose.toFixed(s)+"</span></td>               <td><strong>æç»ä»·: </strong><span>"+i.Close.toFixed(s)+"</span></td>               <td><strong>åä»·: </strong><span>"+(ha.IsNumber(i.AvPrice)?i.AvPrice.toFixed(s):"--.--")+"</span></td></tr>\n            <tr><td><strong>æä½ä»·: </strong><span>"+i.Low.toFixed(s)+"</span></td>               <td><strong>æé«ä»·: </strong><span>"+i.High.toFixed(s)+'</span></td>               <td><strong>æ¶¨è·å¹: </strong><span class="'+ha.FormatValueColor(i.Increase)+'">'+i.Increase.toFixed(2)+"%</span></td></tr>\n            <tr><td><strong>æ¯å¹: </strong><span>"+i.Amplitude.toFixed(2)+"%</span></td>               <td><strong>æäº¤é: </strong><span>"+ha.FormatValueString(i.Vol,2)+"è¡</span></td>               <td><strong>éé¢: </strong><span>"+ha.FormatValueString(i.Amount,2)+"å</span></td></tr>\n            <tr><td><strong>é´çº¿: </strong><span>"+i.KLine.Up+"</span></td>               <td><strong>é³çº¿: </strong><span>"+i.KLine.Down+"</span></td>               <td><strong>å¹³çº¿: </strong><span>"+i.KLine.Unchanged+"</span></td></tr>\n        </table>",(0,A.default)(".parameter-content").html(f),this.BindEvent()},this.BindEvent=function(){var t=this;t.SelectData.Start>0&&(0,A.default)(".jchart-select-date .start-date-left").click((function(){t.SelectData.Start--,t.BindData(),t.HQChart.UpdateSelectRect(t.SelectData.Start,t.SelectData.End)})),t.SelectData.Start<t.SelectData.End&&((0,A.default)(".jchart-select-date .start-date-right").click((function(){t.SelectData.Start++,t.BindData(),t.HQChart.UpdateSelectRect(t.SelectData.Start,t.SelectData.End)})),(0,A.default)(".jchart-select-date .end-date-left").click((function(){t.SelectData.End--,t.BindData(),t.HQChart.UpdateSelectRect(t.SelectData.Start,t.SelectData.End)}))),t.SelectData.End<t.SelectData.Data.Data.length-1&&(0,A.default)(".jchart-select-date .end-date-right").click((function(){t.SelectData.End++,t.BindData(),t.HQChart.UpdateSelectRect(t.SelectData.Start,t.SelectData.End)}))},this.DoModal=function(t){var e=t.data.Chart;null==this.ID&&this.Create(),this.SelectData=t.data.SelectData,this.RectSelectPaint=t.data.RectSelectPaint,this.HQChart=e,this.HQChart.HideSelectRect(),this.BindData(),this.Show()},this.KLineMatch=function(t){var e=new Ar(this.DivElement);e.DoModal({data:{Title:"è®¡ç®ä¸­......",Chart:this.HQChart}}),this.Close();var a=this.HQChart,i={Scope:{Plate:["CNA.ci"],Minsimilar:.9},WaitDialog:e};a.RequestKLineMatch(this.SelectData,i)}}function Mr(t){this.newMethod=gr,this.newMethod(t),delete this.newMethod,this.MatchData,this.Sample,this.Dialog,this.HQChart,this.PageData,this.Close=function(){this.DivElement.removeChild(this.Dialog)},this.Create=function(){this.ID=q();var t=document.createElement("div");t.className="jchart-kline-match-box",t.id=this.ID,t.innerHTML="<div class='parameter jchart-kline-match-box'>\n            <div class='parameter-header'>\n                <span>å½¢æå¹é</span>\n                <strong id='close' class='icon iconfont icon-close'></strong>\n            </div>\n            <div class='parameter-content'>\n                <p class='dataCount'></p>\n                <table class='matchTable'>\n                    <thead>\n                        <tr>\n                            <td>è¡ç¥¨åç§°</td>\n                            <td>å¹éåº¦</td>\n                            <td>æ¶é´æ®µ</td>\n                        </tr>\n                    </thead>\n                    <tbody>\n                    </tbody>\n                </table>\n                <div class='pagination' data-current='1'></div>\n            </div>\n            <div class='parameter-footer'>\n                <button id='close' class='submit' >ç¡®å®</button>\n            </div>\n        </div>".trim(),this.DivElement.appendChild(t),this.Dialog=t,(0,A.default)("#"+this.ID+" #close").click({divBox:this},(function(t){t.data.divBox.Close()}))},this.BindData=function(){w.Chart.Log("[KLineMatchDialog::BindData] å½¢ææº: "+this.Sample.Stock.Name+" åºé´:"+this.Sample.Date.Start+" - "+this.Sample.Date.End);var t=this.MatchData.length+1,e={NewData:{},MetaData:[],PageCount:0,Count:t},a=0;(0,A.default)("#"+this.ID+" .dataCount").html("ä¸ªæ°ï¼"+t);for(var i=0;i<t;i++){var r={};if(0==i)r={Symbol:this.Sample.Stock.Symbol,Name:this.Sample.Stock.Name,Rate:"å½¢ææº",Color:"red",Date:this.Sample.Date.Start+"-"+this.Sample.Date.End};else{var n=this.MatchData[i-1];r={Symbol:n.Symbol,Name:n.Name,Rate:Number(100*n.Similar).toFixed(2),Color:"",Date:n.Start+"-"+n.End}}e.MetaData.push(r)}a=e.Count%10==0?e.Count/10:Math.floor(e.Count/10)+1,e.PageCount=a,this.PaginationMetaData(e),this.PageData=e,w.Chart.Log("[KLineMatchDialog::DoModal pageData]",e),this.RenderDom(1),this.PaginationInit("#"+this.ID,e.PageCount,this.paginationCallback)},this.RenderDom=function(t){var e=this.PageData.NewData[t];w.Chart.Log("[KLineMatchDialog::RenderDom currentPageData]",e);for(var a="",i=0;i<e.length;i++)a+=("<tr>\n                        <td class="+e[i].Color+">"+e[i].Name+"</td>\n                        <td class="+e[i].Color+">"+e[i].Rate+"</td>\n                        <td class="+e[i].Color+">"+e[i].Date+"</td>\n                    </tr>").trim();(0,A.default)("#"+this.ID+" .matchTable tbody").html(a)};var e=this;this.paginationCallback=function(t){e.RenderDom(t),e.PaginationInit("#"+e.ID,e.PageData.PageCount,e.paginationCallback)},this.PaginationInit=function(t,e,a){var i="",r=(0,A.default)(t+" .pagination").data("current"),n=0,s=5;if(r<s)if(e>=s)for(var o=0;o<s;o++)i+=o+1!=r?"<span>"+(o+1)+"</span>":"<span class='active'>"+(o+1)+"</span>";else for(o=0;o<e;o++)i+=o+1!=r?"<span>"+(o+1)+"</span>":"<span class='active'>"+(o+1)+"</span>";else{n=r+1>e?r:r+1;for(var h=r-3;h<=n;h++)i+=h!=r?"<span>"+h+"</span>":"<span class='active'>"+h+"</span>"}i="<span class='beforePage'>ä¸ä¸é¡µ</span>"+i+"<span class='nextPage'>ä¸ä¸é¡µ</span>",(0,A.default)(t+" .pagination").html(i),(0,A.default)(t+" .pagination span").bind("click",{maxpage:e,Callback:a},this.PaginationCurrentIndex)},this.PaginationCurrentIndex=function(t){var e=(0,A.default)(this).text();w.Chart.Log("[::PaginationCurrentIndex text]",e);var a=Number((0,A.default)(this).parent().data("current")),i=t.data.maxpage,r=t.data.Callback,n=1;n="ä¸ä¸é¡µ"===e?1===a?a:a-1:"ä¸ä¸é¡µ"===e?a===i?a:a+1:Number(e),(0,A.default)(this).parent().data("current",n),r(n)},this.PaginationMetaData=function(t){for(var e={},a=t.MetaData,i=t.PageCount,r=0;r<i;r++){for(var n=[],s=0;s<10;s++){var o=10*r+s;if(!(o<=a.length-1))break;var h=a[o];n.push(h)}e[r+1]=n}t.NewData=e},this.DoModal=function(t){var e=t.data.Chart;null==this.ID&&this.Create(),this.MatchData=t.data.MatchData,this.Sample=t.data.Sample,this.HQChart=e,this.BindData();var a=e.Frame.ChartBorder,i=(Z(),a.GetWidth()/2),r=a.GetHeight()/2;this.Show(i,r,200,200)}}function Ar(t){this.newMethod=gr,this.newMethod(t),delete this.newMethod,this.Title="å è½½ä¸­......",this.Dialog,this.Close=function(){this.Dialog&&(this.DivElement.removeChild(this.Dialog),this.Dialog=null)},this.SetTitle=function(t){this.Title=t,this.Dialog},this.Create=function(){this.ID=q();var t=document.createElement("div");t.className="jchart-wait-box",t.id=this.ID,t.innerHTML=("<div class='parameter jchart-kline-match-box'>\n            <div class='parameter-header'>\n                <span>"+this.Title+"</span>\n            </div>\n        </div>").trim(),this.DivElement.appendChild(t),this.Dialog=t},this.DoModal=function(t){this.Title=t.data.Title;var e=t.data.Chart;null==this.ID&&this.Create();var a=e.Frame.ChartBorder,i=(Z(),a.GetWidth()/2),r=a.GetHeight()/2;this.Show(i,r,200,40)}}function Nr(t){this.newMethod=gr,this.newMethod(t),delete this.newMethod,this.option={},this.Create=function(){var t=this;this.ID=q(),t.BindData(),t.BindEvent()},this.BindData=function(){var t=this,e=this.DivElement.id,a=(0,A.default)("#"+e);a.find("div[id^='topMenu_']").remove(),a.find("div[id^='childMenu_']").remove();var i=(0,A.default)("<div />");i.attr("id","topMenu_"+t.ID).addClass("context-menu-wrapper topmenu").hide(),a.append(i);var r=(0,A.default)("<table />");r.attr({id:"topTable_"+t.ID,cellspacing:"0",cellpadding:"0"}).addClass("context-menu"),i.append(r),r.append(t.childrenList(t.option.data));for(var n=0;n<t.option.data.length;n++){var s="undefined"!=typeof t.option.data[n].children;if(s){var o=(0,A.default)("<div />");o.attr({id:"childMenu_"+t.ID+n,"data-index":n}).addClass("context-menu-wrapper").hide(),a.append(o);var h=(0,A.default)("<table />");h.attr({id:"childTable_"+t.ID+n,cellspacing:"0",cellpadding:"0"}).addClass("context-menu"),o.append(h),h.append(t.childrenList(t.option.data[n].children))}}},this.Update=function(){var t=this;t.BindData(),t.BindEvent()},this.childrenList=function(t){for(var e=[],a=0;a<t.length;a++){var i="undefined"!=typeof t[a].isBorder&&t[a].isBorder,r=(0,A.default)("<tr />");r.addClass("font_Arial context-menu"),i&&r.addClass("border");var n=(0,A.default)("<td />");t[a].selected?n.addClass("spacer context-menu").html("â"):n.addClass("spacer context-menu");var s=(0,A.default)("<td />");s.addClass("text").html(t[a].text);var o=(0,A.default)("<td />");o.addClass("right shortcut");var h=(0,A.default)("<td />");h.addClass("undefined"!=typeof t[a].children?"submenu-arrow":"context-menu spacer"),r.append(n).append(s).append(o).append(h),e.push(r)}return e},this.Show=function(t){var e=this;A.default.extend(e.option,t),e.ID?e.Update():e.Create();var a=(0,A.default)("#topMenu_"+e.ID),i=a.outerWidth(),r=a.outerHeight(),n=e.option.x,s=e.option.y;i>e.option.position.X+e.option.position.W-n&&(n-=i),r>e.option.position.Y+e.option.position.H-s&&(s-=r),a.hide(),a.css({position:"absolute",left:n+"px",top:s+"px"}).show(),this.isInit=!0},this.Hide=function(){var t=this;"undefined"!=typeof A.default&&((0,A.default)("#topMenu_"+t.ID).hide(),(0,A.default)("[id^='childMenu_"+t.ID+"']").hide())},this.BindEvent=function(){var t=this,e=(0,A.default)("[id^='childMenu_"+t.ID+"']");(0,A.default)("#topTable_"+t.ID).find("tr").mouseenter((function(){var a=(0,A.default)(this),i=a.index(),r=(0,A.default)("#topMenu_"+t.ID),n=(0,A.default)("#childMenu_"+t.ID+i),s=a.outerWidth(),o=a.outerHeight(),h=r.position().left+s+1,l=r.position().top+o*i;s>t.option.position.X+t.option.position.W-h&&(h=h-s-r.outerWidth()-2),n.outerHeight()>t.option.position.Y+t.option.position.H-l&&(l=r.position().top+r.outerHeight()-n.outerHeight()),e.hide(),n.css({left:h+"px",top:l+"px"}).show()})).mouseleave((function(){var e=(0,A.default)(this).index();setTimeout((function(){1!=(0,A.default)("#childMenu_"+t.ID+e).attr("data-isShow")&&(0,A.default)("#childMenu_"+t.ID+e).hide()}),10)})).click((function(){var e=(0,A.default)(this),a=e.index();"function"==A.default.type(t.option.data[a].click)&&(t.option.data[a].click(t.option.returnData),e.hide())})).contextmenu((function(){return!1})),e.mouseenter((function(){(0,A.default)(this).attr("data-isShow","1")})).mouseleave((function(){(0,A.default)(this).attr("data-isShow","0")})).contextmenu((function(){return!1})),e.find("tr").click((function(){var a=(0,A.default)(this),i=parseInt(a.closest("div").attr("data-index")),r=a.index();"function"==A.default.type(t.option.data[i].children[r].click)&&(t.option.data[i].children[r].click(t.option.windowIndex||1),e.hide())}))},this.GetPeriod=function(t){var e=[{text:"æ¥çº¿",Value:0,click:function(){t.ChangePeriod(0)}},{text:"å¨çº¿",Value:1,click:function(){t.ChangePeriod(1)}},{text:"åå¨çº¿",Value:21,click:function(){t.ChangePeriod(21)}},{text:"æçº¿",Value:2,click:function(){t.ChangePeriod(2)}},{text:"å­£çº¿",Value:9,click:function(){t.ChangePeriod(9)}},{text:"åå¹´",Value:22,click:function(){t.ChangePeriod(22)}},{text:"å¹´çº¿",Value:3,click:function(){t.ChangePeriod(3)}},{text:"1å",Value:4,click:function(){t.ChangePeriod(4)}},{text:"5å",Value:5,click:function(){t.ChangePeriod(5)}},{text:"15å",Value:6,click:function(){t.ChangePeriod(6)}},{text:"30å",Value:7,click:function(){t.ChangePeriod(7)}},{text:"60å",Value:8,click:function(){t.ChangePeriod(8)}},{text:"2å°æ¶",Value:11,click:function(){t.ChangePeriod(11)}},{text:"4å°æ¶",Value:12,click:function(){t.ChangePeriod(12)}},{text:"åç¬",Value:10,click:function(){t.ChangePeriod(10)}},{text:"èªå®ä¹å¨æ:3åé",Value:20003,click:function(){t.ChangePeriod(20003)}},{text:"èªå®ä¹å¨æ:35åé",Value:20035,click:function(){t.ChangePeriod(20035)}},{text:"èªå®ä¹å¨æ:8æ¥",Value:40008,click:function(){t.ChangePeriod(40008)}}];for(var a in e){var i=e[a];if(i.Value==t.Period){i.selected=!0;break}}return e},this.GetRight=function(t){var e=[{text:"ä¸å¤æ",click:function(){t.ChangeRight(0)}},{text:"åå¤æ",click:function(){t.ChangeRight(1)}},{text:"åå¤æ",click:function(){t.ChangeRight(2)}}];return t.Right>=0&&t.Right<e.length&&(e[t.Right].selected=!0),e},this.GetIndex=function(t){return[{text:"åçº¿",click:function(e){t.ChangeIndex(e,"åçº¿")}},{text:"BOLL",click:function(e){t.ChangeIndex(e,"BOLL")},isBorder:!0},{text:"MACD",click:function(e){t.ChangeIndex(e,"MACD")}},{text:"KDJ",click:function(e){t.ChangeIndex(e,"KDJ")}},{text:"VOL",click:function(e){t.ChangeIndex(e,"VOL")}},{text:"RSI",click:function(e){t.ChangeIndex(e,"RSI")}},{text:"BRAR",click:function(e){t.ChangeIndex(e,"BRAR")}},{text:"WR",click:function(e){t.ChangeIndex(e,"WR")}},{text:"BIAS",click:function(e){t.ChangeIndex(e,"BIAS")}},{text:"OBV",click:function(e){t.ChangeIndex(e,"OBV")}},{text:"DMI",click:function(e){t.ChangeIndex(e,"DMI")}},{text:"CR",click:function(e){t.ChangeIndex(e,"CR")}},{text:"PSY",click:function(e){t.ChangeIndex(e,"PSY")}},{text:"CCI",click:function(e){t.ChangeIndex(e,"CCI")}},{text:"DMA",click:function(e){t.ChangeIndex(e,"DMA")}},{text:"TRIX",click:function(e){t.ChangeIndex(e,"TRIX")}},{text:"VR",click:function(e){t.ChangeIndex(e,"VR")}},{text:"EMV",click:function(e){t.ChangeIndex(e,"EMV")}},{text:"ROC",click:function(e){t.ChangeIndex(e,"ROC")}},{text:"MIM",click:function(e){t.ChangeIndex(e,"MIM")}},{text:"FSL",click:function(e){t.ChangeIndex(e,"FSL")}}]},this.GetColorIndex=function(t){var e=[{text:"åå­æ",click:function(e){t.ChangeInstructionIndex("äºå½©Kçº¿-åå­æ")}},{text:"æ©æ¨ä¹æ",click:function(e){t.ChangeInstructionIndex("äºå½©Kçº¿-æ©æ¨ä¹æ")}},{text:"åæ­»åå­",click:function(e){t.ChangeInstructionIndex("äºå½©Kçº¿-åæ­»åå­")}},{text:"ä¸åªä¹é¸¦",click:function(e){t.ChangeInstructionIndex("äºå½©Kçº¿-ä¸åªä¹é¸¦")}},{text:"åèé´çº¿",click:function(e){t.ChangeInstructionIndex("äºå½©Kçº¿-åèé´çº¿")}},{text:"é»æä¹æ",click:function(e){t.ChangeInstructionIndex("äºå½©Kçº¿-é»æä¹æ")}}];return t.ColorIndex&&(e[e.length-1].isBorder=!0,e.push({text:"å é¤äºå½©Kçº¿",click:function(e){t.CancelInstructionIndex()}})),e},this.GetTradeIndex=function(t){var e=[{text:"BIAS",click:function(e){t.ChangeInstructionIndex("äº¤æç³»ç»-BIAS")}},{text:"CCI",click:function(e){t.ChangeInstructionIndex("äº¤æç³»ç»-CCI")}},{text:"DMI",click:function(e){t.ChangeInstructionIndex("äº¤æç³»ç»-DMI")}},{text:"KD",click:function(e){t.ChangeInstructionIndex("äº¤æç³»ç»-KD")}},{text:"BOLL",click:function(e){t.ChangeInstructionIndex("äº¤æç³»ç»-BOLL")}},{text:"KDJ",click:function(e){t.ChangeInstructionIndex("äº¤æç³»ç»-KDJ")}}];return t.TradeIndex&&(e[e.length-1].isBorder=!0,e.push({text:"å é¤ä¸å®¶ç³»ç»",click:function(e){t.CancelInstructionIndex()}})),e},this.GetOverlay=function(t){var e=[{text:"ä¸è¯ææ°",click:function(){t.OverlaySymbol("000001.sh")}},{text:"æ·±è¯ææ",click:function(){t.OverlaySymbol("399001.sz")}},{text:"ä¸­å°æ¿æ",click:function(){t.OverlaySymbol("399005.sz")}},{text:"åä¸æ¿æ",click:function(){t.OverlaySymbol("399006.sz")}},{text:"æ²ªæ·±300",click:function(){t.OverlaySymbol("000300.sh")}}];for(var a in t.OverlayChartPaint){var i,r=t.OverlayChartPaint[a],n=r.Symbol,s=new E.default([["000001.sh",0],["399001.sz",1],["399005.sz",2],["399006.sz",3],["000300.sh",4]]);if(s.has(n))(function(){i=e[s.get(n)];var a=n;i.selected=!0,i.click=function(){t.DeleteOverlaySymbol(a)}})()}return t.OverlayChartPaint&&t.OverlayChartPaint.length>0&&(e[e.length-1].isBorder=!0,e.push({text:"åæ¶å å ",click:function(){t.ClearOverlaySymbol()}})),e},this.GetKLineType=function(t){var e=[{text:"Kçº¿(ç©ºå¿é³çº¿)",click:function(){t.ChangeKLineDrawType(3)}},{text:"Kçº¿(å®å¿é³çº¿)",click:function(){t.ChangeKLineDrawType(0)}},{text:"ç¾å½çº¿",click:function(){t.ChangeKLineDrawType(2)}},{text:"æ¶ççº¿",click:function(){t.ChangeKLineDrawType(1)}},{text:"æ¶çé¢ç§¯",click:function(){t.ChangeKLineDrawType(4)}},{text:"Kçº¿(ç©ºå¿é³çº¿é´çº¿)",click:function(){t.ChangeKLineDrawType(6)}}];switch(t.KLineDrawType){case 0:e[1].selected=!0;break;case 1:e[3].selected=!0;break;case 2:e[2].selected=!0;break;case 3:e[0].selected=!0;break;case 4:e[4].selected=!0;break;case 6:e[5].selected=!0;break}return e},this.GetIndexWindowCount=function(t){var e=[{text:"1ä¸ªçªå£",click:function(){t.ChangeIndexWindowCount(1)}},{text:"2ä¸ªçªå£",click:function(){t.ChangeIndexWindowCount(2)}},{text:"3ä¸ªçªå£",click:function(){t.ChangeIndexWindowCount(3)}},{text:"4ä¸ªçªå£",click:function(){t.ChangeIndexWindowCount(4)}},{text:"5ä¸ªçªå£",click:function(){t.ChangeIndexWindowCount(5)}}],a=t.Frame.SubFrame.length;return a-1>=0&&a-1<e.length&&(e[a-1].selected=!0),e},this.GetCoordinateType=function(t){var e=[{text:"æ®éåæ ",click:function(){t.ChangeCoordinateType({Type:0})}},{text:"ç¾åæ¯åæ ",click:function(){t.ChangeCoordinateType({Type:1})}},{text:"åè½¬åæ ",click:function(){t.ChangeCoordinateType({IsReverse:!0})}},{text:"å¯¹æ°åæ ",click:function(){t.ChangeCoordinateType({Type:2})}},{text:"ç­æ¯åæ ",click:function(){t.ChangeCoordinateType({Type:3})}},{text:"ç­ååæ ",click:function(){t.ChangeCoordinateType({Type:4})}},{text:"é»éåå²",click:function(){t.ChangeCoordinateType({Type:5})}}];return t.Frame&&t.Frame.SubFrame&&t.Frame.SubFrame.length>0&&(1==t.Frame.SubFrame[0].Frame.CoordinateType&&(e[2].selected=!0,e[2].click=function(){t.ChangeCoordinateType({IsReverse:!1})}),1==t.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType?e[1].selected=!0:0==t.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType?e[0].selected=!0:2==t.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType?e[3].selected=!0:3==t.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType?e[4].selected=!0:4==t.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType?e[5].selected=!0:5==t.Frame.SubFrame[0].Frame.YSplitOperator.CoordinateType&&(e[6].selected=!0)),e},this.GetDragModeType=function(t){var e=[{text:"ç¦æ­¢ææ½",click:function(){t.DragMode=0}},{text:"å¯å¨ææ½",click:function(){t.DragMode=1}},{text:"åºé´éæ©",click:function(){t.DragMode=2}}];return t.DragMode>=0&&t.DragMode<e.length&&(e[t.DragMode].selected=!0),e},this.GetTools=function(t){var e=[],a=t.GetExtendChartByClassName("DrawToolsButton");a?e.push({text:"å³é­ç»å¾å·¥å·",click:function(){for(var e=a.Chart.Width,i=parseInt(a.Index),r=i+1;r<t.ExtendChartPaint.length;++r){var n=t.ExtendChartPaint[r];"StockChip"==n.ClassName&&(n.Left-=e)}t.DeleteExtendChart(a),t.Frame.ChartBorder.Right-=e,t.SetSizeChange(!0),t.Draw()}}):e.push({text:"ç»å¾å·¥å·",click:function(){var e={Name:"ç»å¾å·¥å·",Top:t.Frame.ChartBorder.Top};t.CreateExtendChart(e.Name,e);t.SetSizeChange(!0),t.Draw()}});var i=t.GetExtendChartByClassName("StockChip");return i?e.push({text:"å³é­ç§»å¨ç­¹ç ",click:function(){for(var e=i.Chart.Width,a=parseInt(i.Index),r=a+1;r<t.ExtendChartPaint.length;++r){var n=t.ExtendChartPaint[r];"DrawToolsButton"==n.ClassName&&(n.Left-=e)}t.DeleteExtendChart(i),t.Frame.ChartBorder.Right-=e,t.SetSizeChange(!0),t.Draw()}}):e.push({text:"ç§»å¨ç­¹ç ",click:function(){var e={Name:"ç­¹ç åå¸",ShowType:1,Width:230};t.CreateExtendChart(e.Name,e);t.SetSizeChange(!0),t.Draw()}}),e},this.GetKLineInfo=function(t){var e=new I.default;for(var a in t.ChartInfo){var i=t.ChartInfo[a];e.add(i.ClassName)}var r=["å¬å","ä¸ç»©é¢å","è°ç ","å¤§å®äº¤æ","é¾èæ¦","äºå¨æ"],n=[];for(var a in r){var s=r[a],o=lr.GetClassInfo(s);if(o){i=this.CreateKlineInfoItem(s,e.has(o.ClassName),t);n.push(i)}}if(t.ChartInfo.length>0){n[n.length-1].isBorder=!0;i={text:"å é¤ææ",click:function(){t.ClearKLineInfo()}};n.push(i)}return n},this.CreateKlineInfoItem=function(t,e,a){var i={text:t,selected:e};return i.click=e?function(){a.DeleteKLineInfo(t)}:function(){a.AddKLineInfo(t,!0)},i},this.DoModal=function(t){var e=t.data.Chart,a=e.RightMenu,i=t.offsetX,r=t.offsetY,n=[{text:"åæå¨æ",children:this.GetPeriod(e)},{text:"å¤æå¤ç",children:this.GetRight(e)},{text:"ææ åæ¢",children:this.GetIndex(e)},{text:"äºå½©Kçº¿",children:this.GetColorIndex(e)},{text:"ä¸å®¶ç³»ç»",children:this.GetTradeIndex(e)},{text:"ä¿¡æ¯å°é·",children:this.GetKLineInfo(e)},{text:"å å åç§",children:this.GetOverlay(e)},{text:"ä¸»å¾çº¿å",children:this.GetKLineType(e)},{text:"åæ ç±»å",children:this.GetCoordinateType(e)},{text:"ææ çªå£ä¸ªæ°",children:this.GetIndexWindowCount(e)},{text:"é¼ æ ææ½",children:this.GetDragModeType(e)},{text:"å·¥å·",children:this.GetTools(e)}],s=e.Symbol.toUpperCase();(Br.IsSHSZIndex(e.Symbol)||Br.IsBIT(s))&&n.splice(1,1);var o=t.data.FrameID,h=this.GetOverlayIndex(e,o);if(h&&h.length>0){var l={text:"å é¤å å ææ ",children:this.GetDeleteOverlayIndex(e,h)};n.splice(3,0,l)}w.Chart.Log("[KLineRightMenu::DoModal]",o),a.Show({windowIndex:o,x:i+e.UIElement.offsetLeft,y:r+e.UIElement.offsetTop,position:e.Frame.Position,data:n}),(0,A.default)(document).click((function(){a.Hide()}))},this.GetOverlayIndex=function(t,e){if(e>=t.Frame.SubFrame.length||e<0)return[];var a=[],i=t.Frame.SubFrame[e];for(var r in i.OverlayIndex){var n=i.OverlayIndex[r];a.push({Name:n.Script.Name,Identify:n.Identify})}return a},this.GetDeleteOverlayIndex=function(t,e){var a=[],i=function(){var i=e[r].Identify;a.push({text:e[r].Name,click:function(){t.DeleteOverlayWindowsIndex(i)}})};for(var r in e)i();return a}}function wr(t){this.newMethod=Nr,this.newMethod(t),delete this.newMethod,this.DoModal=function(e){var a=e.data.Chart,i=this,r=e.data.X,n=e.data.Y,s=[{text:"åºé´ç»è®¡",click:function(){w.Chart.Log("[KLineSelectRightMenu::click] åºé´ç»è®¡"),i.Hide();var a=new Er(t);a.DoModal(e)}},{text:"åºé´æ¾å¤§",click:function(){w.Chart.Log("[KLineSelectRightMenu::click] åºé´æ¾å¤§");var t=e.data.Chart;t.ShowSelectData(e.data.SelectData)}}];i.Show({x:r,y:n,position:a.Frame.Position,data:s})},this.Show=function(t){var e=this;A.default.extend(e.option,t),e.ID||e.Create();var a="topMenu_"+e.ID,i=document.getElementById(a);i||e.Create();var r=(0,A.default)("#topMenu_"+e.ID),n=r.outerWidth(),s=r.outerHeight();r.contextmenu((function(){return!1}));var o=e.option.x,h=e.option.y;n>e.option.position.X+e.option.position.W-o&&(o-=n),s>e.option.position.Y+e.option.position.H-h&&(h-=s),r.hide(),r.css({position:"absolute",left:o+"px",top:h+"px"}).show(),(0,A.default)("#topMenu_"+e.ID).find("tr").show(),this.isInit=!0}}function Or(t){this.newMethod=Nr,this.newMethod(t),delete this.newMethod,this.DoModal=function(t){var e=t.data.Chart,a=e.RightMenu,i=t.offsetX,r=t.offsetY,n=[{text:"å å åç§",children:this.GetOverlay(e)},{text:"å¤æ¥åæ¶å¾",children:this.GetDayCount(e)},{text:"ææ çªå£ä¸ªæ°",children:this.GetIndexWindowCount(e)},{text:"å¯å¾ææ åæ¢",children:this.GetIndex(e)},{text:"åºé´éæ©",children:this.GetSelectRect(e)}],s=e.Symbol;Br.IsSHSZStockA(s)&&n.push({text:"éåç«ä»·",children:this.GetShowBeforeData(e)}),n.push({text:"å·¥å·",children:this.GetTools(e)});var o=t.data.FrameID,h=this.GetOverlayIndex(e,o);if(h&&h.length>0){var l={text:"å é¤å å ææ ",children:this.GetDeleteOverlayIndex(e,h)};n.splice(3,0,l)}o=t.data.FrameID;w.Chart.Log("[MinuteRightMenu::DoModal]",o),a.Show({windowIndex:o,x:i+e.UIElement.offsetLeft,y:r+e.UIElement.offsetTop,position:e.Frame.Position,data:n}),(0,A.default)(document).click((function(){a.Hide()}))},this.GetDayCount=function(t){var e=[{text:"å½æ¥åæ¶å¾",click:function(){t.ChangeDayCount(1)},isBorder:!0},{text:"æè¿2æ¥",click:function(){t.ChangeDayCount(2)}},{text:"æè¿3æ¥",click:function(){t.ChangeDayCount(3)}},{text:"æè¿4æ¥",click:function(){t.ChangeDayCount(4)}},{text:"æè¿5æ¥",click:function(){t.ChangeDayCount(5)}},{text:"æè¿6æ¥",click:function(){t.ChangeDayCount(6)}}];return t.DayCount-1>=0&&t.DayCount-1<e.length&&(e[t.DayCount-1].selected=!0),e},this.GetIndex=function(t){var e=[{text:"MACD",click:function(e){t.ChangeIndex(e,"MACD")}},{text:"DMI",click:function(e){t.ChangeIndex(e,"DMI")}},{text:"DMA",click:function(e){t.ChangeIndex(e,"DMA")}},{text:"BRAR",click:function(e){t.ChangeIndex(e,"BRAR")}},{text:"KDJ",click:function(e){t.ChangeIndex(e,"KDJ")}},{text:"RSI",click:function(e){t.ChangeIndex(e,"RSI")}},{text:"WR",click:function(e){t.ChangeIndex(e,"WR")}},{text:"CCI",click:function(e){t.ChangeIndex(e,"CCI")}},{text:"TRIX",click:function(e){t.ChangeIndex(e,"TRIX")}}];return e},this.GetShowBeforeData=function(t){if(t.IsShowBeforeData){var e=[{text:"éè",click:function(){t.ShowCallAuctionData({Left:!1,MultiDay:{Left:!1}})}}];return e}e=[{text:"æ¾ç¤º",click:function(){t.ShowCallAuctionData({Left:!0,MultiDay:{Left:!0}})}}];return e},this.GetSelectRect=function(t){if(t.EnableSelectRect){var e=[{text:"ç¦ç¨åºé´éæ©",click:function(){t.EnableSelectRect=!1}}];return e}e=[{text:"å¯å¨åºé´éæ©",click:function(){t.EnableSelectRect=!0}}];return e},this.GetIndexWindowCount=function(t){var e=[{text:"1ä¸ªçªå£",click:function(){t.ChangeIndexWindowCount(2)}},{text:"2ä¸ªçªå£",click:function(){t.ChangeIndexWindowCount(3)}},{text:"3ä¸ªçªå£",click:function(){t.ChangeIndexWindowCount(4)}}],a=t.Frame.SubFrame.length-1;return a-1>=0&&a-1<e.length&&(e[a-1].selected=!0),e},this.GetTools=function(t){var e=[],a=t.GetExtendChartByClassName("DrawToolsButton");return a?e.push({text:"å³é­ç»å¾å·¥å·",click:function(){var e=a.Chart.Width;parseInt(a.Index);t.DeleteExtendChart(a),t.Frame.ChartBorder.Right-=e,t.SetSizeChange(!0),t.Draw()}}):e.push({text:"ç»å¾å·¥å·",click:function(){var e={Name:"ç»å¾å·¥å·",Top:t.Frame.ChartBorder.Top};t.CreateExtendChart(e.Name,e);t.SetSizeChange(!0),t.Draw()}}),e}}function Rr(t){this.newMethod=gr,this.newMethod(t),delete this.newMethod,this.HQChart,this.ChartPicture,this.SubToolsDiv,this.SettingMenu,this.SettingPV,this.DoModal=function(t){if(!this.SubToolsDiv){this.ID=q();var e=document.createElement("div");e.className="subTolls",e.id=this.ID,this.DivElement.appendChild(e),this.SubToolsDiv=e}this.HQChart=t.data.HQChart,this.ChartPicture=t.data.ChartPicture;var a=U(),i=this.HQChart.Frame.SubFrame[0].Frame,r=i.ChartBorder.Top+40,n=i.ChartBorder.Right,s=i.ChartBorder.GetLeft(),o=this.ChartPicture.ClassName,h=this.ChartPicture.LineColor;0!=h.indexOf("rgb(")&&0!=h.indexOf("RGB(")||(h=ka.RGBToHex(h.toLowerCase()));var l="";l="ChartDrawPictureText"===o?'<span class="changes-color" title="æ¹åå¾å½¢é¢è²"><i class="iconfont icon-bianji"></i><input type="color" name="color" id="color" class="change-color" value="'+h+'"></span>\n<span class="subtool-set" title="è®¾ç½®"><i class="iconfont icon-shezhi"></i></span><span class="subtool-del"><i class="iconfont icon-recycle_bin"></i></span>':"ChartDrawVolProfile"==o?'<span class="vp-set" title="è®¾ç½®"><i class="iconfont icon-shezhi"></i></span><span class="subtool-del"><i class="iconfont icon-recycle_bin"></i></span>':'<p class="changes-color" title="æ¹åå¾å½¢é¢è²"><i class="iconfont icon-bianji"></i><input type="color" name="color" id="color" class="change-color" value="'+h+'"></p>\n        <p class="subtool-del"><i class="iconfont icon-recycle_bin"></i></p>',this.SubToolsDiv.style.right=n/a+"px",this.SubToolsDiv.style.top=r/a+"px",this.SubToolsDiv.innerHTML=l,this.SubToolsDiv.style.position="absolute",this.SubToolsDiv.style.display="block";var u=this.HQChart,C=this.ChartPicture;this.SubToolsDiv;(0,A.default)(".subtool-del").click((function(){u.SelectChartDrawPicture=null,u.ClearChartDrawPicture(C),(0,A.default)(".subTolls").css("display","none")}));var D=this;(0,A.default)(".subtool-set").click((function(){(0,A.default)(D.SubToolsDiv).hide(),D.SettingMenu||(D.SettingMenu=new Pr(i.ChartBorder.UIElement.parentNode)),D.SettingMenu.ChartPicture=C,D.SettingMenu.HQChart=u,D.SettingMenu.Position={Left:n+80,Top:r+20},D.SettingMenu.DoModal()})),(0,A.default)(".changes-color").click((function(){document.getElementById("color").click(),(0,A.default)(".change-color").change((function(){var t=(0,A.default)(".change-color").val();C.LineColor=t,C.PointColor=t,u.ChartDrawStorage&&u.ChartDrawStorage.SaveDrawData(C)}))})),(0,A.default)(".vp-set").click((function(){D.SettingPV||(D.SettingPV=new br(i.ChartBorder.UIElement.parentNode)),D.SettingPV.ChartPicture=C,D.SettingPV.HQChart=u,D.SettingPV.Position={Left:n+80,Top:r+20},D.SettingPV.DoModal()})),w.Chart.Log("[ChartPictureSettingMenu::DoModal]",{Top:r,Left:s,Right:n})}}function Pr(t){this.newMethod=gr,this.newMethod(t),delete this.newMethod,this.ChartPicture,this.SettingDiv,this.Position,this.BackupData,this.Close=function(){this.SettingDiv&&this.DivElement.removeChild(this.SettingDiv)},this.DoModal=function(){var t=this.ChartPicture.Text,e=this.ChartPicture.FontOption,a=this.ChartPicture.LineColor;this.BackupData={Text:t,LineColor:a,FontOption:{Family:e.Family,Size:e.Size,Weight:e.Weight,Style:e.Style}},w.Chart.Log("[ChartPictureTextSettingMenu::DoModal] picture info",this.BackupData);var i=this,r=this.DivElement.getElementsByClassName("chartpicture-text-setting")[0];r||(r=document.createElement("div"),r.className="chartpicture-text-setting",this.DivElement.appendChild(r)),this.SettingDiv=r;var n='<div class="titleWrap"><span class="titleName">æ ·å¼è®¾ç½®</span><i class="closeBtn iconfont icon-close"></i></div>',s=[10,11,12,14,16,20,24,28,32,40],o=["å¾®è½¯éé»","å®ä½","Arial","ä»¿å®"],h="",l="";o.forEach((function(t,e){l+=0!==e?"<p>"+t+"</P>":'<p class="active">'+t+"</P>"})),s.forEach((function(t,e){h+=5!==e?"<p>"+t+"</P>":'<p class="active">'+t+"</P>"}));var u='<div class="contentWrap"><div class="styleOptions"><span class="colorPicker"><input type="color" id="fontColor" value="#1e90ff"></span><div class="likeSelect fontSelect"><span class="choicedText">å¾®è½¯éé»</span><div class="selectList">'+l+'</div><i class="iconfont icon-xia"></i></div><div class="likeSelect fontSizeSelect"><span class="choicedText">20</span><div class="selectList">'+h+'</div><i class="iconfont icon-xia"></i></div><span class="strongFont likeBtn"><i class="iconfont icon-jiacu"></i></span><span class="italicsFont likeBtn"><i class="iconfont icon-qingxieL"></i></span></div><textarea class="tArea" id="tArea" placeholder="Text"></textarea></div>',C='<div class="btnsContainer"><span class="okBtn btn">ç¡®è®¤</span><span class="cancelBtn btn">åæ¶</span></div>',D=U(),f=n+u+C;this.SettingDiv.style.left=this.Position.Left/D+"px",this.SettingDiv.style.top=this.Position.Top/D+"px",this.SettingDiv.innerHTML=f,this.SettingDiv.style.position="absolute",this.SettingDiv.style.display="block",(0,A.default)(".chartpicture-text-setting .colorPicker").css({borderColor:i.ChartPicture.LineColor,"background-color":i.ChartPicture.LineColor});var c=this.ChartPicture.FontOption.Family;(0,A.default)(".chartpicture-text-setting .fontSelect .choicedText").html(c),o.forEach((function(t,e){t==c&&((0,A.default)(".chartpicture-text-setting .fontSelect p").removeClass("active"),(0,A.default)(".chartpicture-text-setting .fontSelect p").eq(e).addClass("active"))}));var d=this.ChartPicture.FontOption.Size;(0,A.default)(".chartpicture-text-setting .fontSizeSelect .choicedText").html(d),s.forEach((function(t,e){t==d&&((0,A.default)(".chartpicture-text-setting .fontSizeSelect p").removeClass("active"),(0,A.default)(".chartpicture-text-setting .fontSizeSelect p").eq(e).addClass("active"))}));var m=this.ChartPicture.FontOption.Weight;null!=m&&"bold"==m&&(0,A.default)(".chartpicture-text-setting .strongFont").addClass("hot");var v=this.ChartPicture.FontOption.Style;null!=v&&"italic"==v&&(0,A.default)(".chartpicture-text-setting .italicsFont").addClass("hot");t=this.ChartPicture.Text;(0,A.default)(".chartpicture-text-setting .tArea").val(t);(0,A.default)(".chartpicture-text-setting #fontColor").change({Picture:this.ChartPicture},(function(t){var e=(0,A.default)(this).val();(0,A.default)(this).parent().css({borderColor:e,"background-color":e});var a=t.data.Picture;a.LineColor=e,a.Update&&a.Update()})),(0,A.default)(".chartpicture-text-setting .fontSelect,.chartpicture-text-setting .fontSizeSelect").click((function(){(0,A.default)(this).find(".selectList").toggle(),(0,A.default)(this).toggleClass("hot")})),(0,A.default)(".chartpicture-text-setting .fontSelect p").click({Picture:this.ChartPicture},(function(t){var e=(0,A.default)(this).closest(".fontSelect").find(".choicedText").html(),a=t.currentTarget.innerHTML;if(e!==a){(0,A.default)(this).closest(".fontSelect").find(".choicedText").html(a),(0,A.default)(this).siblings().removeClass("active"),(0,A.default)(this).addClass("active");var i=t.data.Picture;i.FontOption.Family=a,i.Update&&i.Update()}})),(0,A.default)(".chartpicture-text-setting .fontSizeSelect p").click({Picture:this.ChartPicture},(function(t){var e=(0,A.default)(this).closest(".fontSizeSelect").find(".choicedText").html(),a=t.currentTarget.innerHTML;if(e!==a){(0,A.default)(this).closest(".fontSizeSelect").find(".choicedText").html(a),(0,A.default)(this).siblings().removeClass("active"),(0,A.default)(this).addClass("active");var i=t.data.Picture;i.FontOption.Size=Number(a),i.Update&&i.Update()}})),(0,A.default)(".chartpicture-text-setting .strongFont").click({Picture:this.ChartPicture},(function(t){(0,A.default)(this).toggleClass("hot");var e=(0,A.default)(this).attr("class");if(e.indexOf("hot")>0){var a=t.data.Picture;a.FontOption.Weight="bold",a.Update&&a.Update()}})),(0,A.default)(".chartpicture-text-setting .italicsFont").click({Picture:this.ChartPicture},(function(t){(0,A.default)(this).toggleClass("hot");var e=(0,A.default)(this).attr("class");if(e.indexOf("hot")>0){var a=t.data.Picture;a.FontOption.Style="italic",a.Update&&a.Update()}})),(0,A.default)(".chartpicture-text-setting .titleWrap .closeBtn,.chartpicture-text-setting .btnsContainer .cancelBtn").click({Picture:this.ChartPicture},(function(t){var e=t.data.Picture;e.Text=i.BackupData.Text,e.LineColor=i.BackupData.LineColor,e.FontOption=i.BackupData.FontOption,e.Update&&e.Update(),i.Close()})),(0,A.default)(".chartpicture-text-setting .tArea").keyup({Picture:this.ChartPicture},(function(t){w.Chart.Log('[ChartPictureTextSettingMenu::DoModal] $(".chartpicture-text-setting .tArea").keyup()');var e=(0,A.default)(this).val(),a=t.data.Picture;a.Text=e,a.Update&&a.Update()})),(0,A.default)(".chartpicture-text-setting .btnsContainer .okBtn").click((function(){i.Close(),i.HQChart&&i.HQChart.ChartDrawStorage&&i.HQChart.ChartDrawStorage.SaveDrawData(i.ChartPicture)}))}}function br(t){this.newMethod=gr,this.newMethod(t),delete this.newMethod,this.ChartPicture,this.SettingDiv,this.Position,this.Close=function(){this.SettingDiv&&this.DivElement.removeChild(this.SettingDiv)},this.DoModal=function(){var t=this.ChartPicture.VAVol,e=this,a=this.DivElement.getElementsByClassName("jchart-modifyindex-box")[0];a||(a=document.createElement("div"),a.className="jchart-modifyindex-box",this.DivElement.appendChild(a)),this.SettingDiv=a,a.innerHTML="<div class='parameter'>            <div class='parameter-header'>                <span>åºå®èå´æäº¤éåå¸è®¾ç½®</span>                <strong id='close' class='icon iconfont icon-close'></strong>            </div>            <div class='parameter-content'><input class='row-line' value="+t+" />VAVol</div>            <div class='parameter-footer'>                <button class='submit' >ç¡®å®</button>                <button class='cancel' >åæ¶</button>            </div>        </div>";var i=U(),r=this.HQChart.Frame.SubFrame[0].Frame,n=r.ChartBorder.Top+40,s=r.ChartBorder.Right;r.ChartBorder.GetLeft();this.SettingDiv.style.right=s/i+"px",this.SettingDiv.style.top=n/i+"px",this.SettingDiv.style.position="absolute",this.SettingDiv.style.display="block";var o=a.getElementsByClassName("cancel")[0];o.onclick=function(){e.Close()};var h=a.getElementsByClassName("icon iconfont icon-close")[0];h.onclick=function(){e.Close()};var l=a.getElementsByClassName("submit")[0];l.onclick=function(){var t=a.getElementsByClassName("row-line")[0].value;e.ChartPicture.VAVol=parseFloat(t),e.ChartPicture.RequestVolumeProfileData(),e.Close()}}}var Br={SH:".SH",SZ:".SZ",SHSZ_C_Index:".CI",BJ:".BJ",SHO:".SHO",SZO:".SZO",HK:".HK",FHK:".FHK",SHFE:".SHF",SHFE2:".SHFE",CFFEX:".CFE",DCE:".DCE",CZCE:".CZC",USA:".USA",FTSE:".FTSE",BIT:".BIT",BIZ:".BIZ",FOREX:".FOREX",NYMEX:".NYMEX",COMEX:".COMEX",NYBOT:".NYBOT",CBOT:".CBOT",LME:".LME",TOCOM:".TOCOM",IPE:".IPE",TW:".TW",JP:".JP",ET:".ET",IsET:function(t){return!!t&&t.indexOf(this.ET)>0},IsETShowAvPrice:function(t){return!1},IsNYMEX:function(t){return!!t&&t.indexOf(this.NYMEX)>0},IsCOMEX:function(t){return!!t&&t.indexOf(this.COMEX)>0},IsNYBOT:function(t){return!!t&&t.indexOf(this.NYBOT)>0},IsCBOT:function(t){return!!t&&t.indexOf(this.CBOT)>0},IsLME:function(t){return!!t&&t.indexOf(this.LME)>0},IsTOCOM:function(t){return!!t&&t.indexOf(this.TOCOM)>0},IsIPE:function(t){return!!t&&t.indexOf(this.IPE)>0},IsForeignExchange:function(t){return!!t&&t.indexOf(this.FOREX)>0},IsFTSE:function(t){return!!t&&t.indexOf(this.FTSE)>0},IsFHK:function(t){return!!t&&t.indexOf(this.FHK)>0},IsBIT:function(t){return!!t&&(t.indexOf(this.BIT)>0||t.indexOf(this.BIZ)>0)},IsUSA:function(t){return!!t&&t.indexOf(this.USA)>0},IsSH:function(t){var e=t.length-this.SH.length,a=t.indexOf(this.SH);return a==e},IsSZ:function(t){var e=t.length-this.SZ.length,a=t.indexOf(this.SZ);return a==e},IsBJ:function(t){var e=t.length-this.BJ.length,a=t.indexOf(this.BJ);return a==e},IsSHSZCustomIndex:function(t){var e=t.length-this.SHSZ_C_Index.length,a=t.indexOf(this.SHSZ_C_Index);return a==e},IsSHO:function(t){var e=t.length-this.SHO.length,a=t.indexOf(this.SHO);return a==e},IsSZO:function(t){var e=t.length-this.SZO.length,a=t.indexOf(this.SZO);return a==e},IsHK:function(t){var e=t.length-this.HK.length,a=t.indexOf(this.HK);return a==e},IsTW:function(t){var e=t.length-this.TW.length,a=t.indexOf(this.TW);return a==e},IsJP:function(t){var e=t.length-this.JP.length,a=t.indexOf(this.JP);return a==e},IsSHFE:function(t){return!!t&&(t.indexOf(this.SHFE)>0||t.indexOf(this.SHFE2)>0)},IsCFFEX:function(t){return!!t&&t.indexOf(this.CFFEX)>0},IsDCE:function(t){return!!t&&t.indexOf(this.DCE)>0},IsCZCE:function(t){return!!t&&t.indexOf(this.CZCE)>0},IsChinaFutures:function(t){return this.IsSHO(t)||this.IsSZO(t)||this.IsCFFEX(t)||this.IsCZCE(t)||this.IsDCE(t)||this.IsSHFE(t)},IsFutures:function(t){return this.IsChinaFutures(t)||this.IsNYMEX(t)||this.IsCOMEX(t)||this.IsNYBOT(t)||this.IsCBOT(t)||this.IsLME(t)||this.IsTOCOM(t)},IsSHSZ:function(t){return this.IsSZ(t)||this.IsSH(t)||this.IsSHSZCustomIndex(t)},IsSHSZFund:function(t){if(!t)return!1;if(this.IsSH(t)){if("5"==t.charAt(0)&&"1"==t.charAt(1))return!0}else if(this.IsSZ(t)&&"1"==t.charAt(0)&&("5"==t.charAt(1)||"6"==t.charAt(1)||"7"==t.charAt(1)||"8"==t.charAt(1)))return!0;return!1},IsSHSZIndex:function(t){if(!t)return!1;var e=t.toUpperCase();if(this.IsSH(e)){var a=e.replace(".SH","");if("0"==e.charAt(0)&&parseInt(a)<=3e3)return!0}else if(this.IsSZ(e)){if("3"==e.charAt(0)&&"9"==e.charAt(1))return!0}else if(this.IsSHSZCustomIndex(e))return!0;return!1},IsSHSZStockA:function(t){if(!t)return!1;var e=t.toUpperCase();if(this.IsSH(e)){e.replace(".SH","");if("6"==e.charAt(0))return!0}else if(this.IsSZ(e))if("0"==e.charAt(0)){if("0"==e.charAt(1)&&"2"==e.charAt(2))return!0;if("7"!=e.charAt(1)&&"8"!=e.charAt(1))return!0}else if("3"==e.charAt(0)&&"0"==e.charAt(1)){if("0"==e.charAt(2))return!0;if("1"==e.charAt(2))return!0}return!1},IsBJStock:function(t){if(!t)return!1;var e=t.toUpperCase();if(!this.IsBJ(e))return!1;var a=e.charAt(0);return"4"==a||"8"==a},IsSHStockSTAR:function(t){if(!t)return!1;var e=t.toUpperCase();return!!this.IsSH(e)&&("6"==e.charAt(0)&&"8"==e.charAt(1)&&"8"==e.charAt(2))},GetMarketStatus:function(t){if(!t)return 0;var e=t.toUpperCase(),a=new Date,i=a.getDay(),r=100*a.getHours()+a.getMinutes();if(this.IsUSA(e)){var n=nn(-4);i=n.getDay(),r=100*n.getHours()+n.getMinutes();return 6==i||0==i?0:r>1730?3:r<930?1:2}return this.IsBIT(e)||this.IsForeignExchange(e)?2:this.IsFTSE(e)?6==i||0==i?0:r>=830&&r<=2359||r>=0&&r<=500?2:0:this.IsFHK(e)?6==i||0==i?0:r>=900&&r<=2359||r>=0&&r<=320?2:0:this.IsET(e)?this.GetETMarketStatus(t):this.IsHK(e)?6==i||0==i?0:r>1630?3:r<925?1:2:this.IsTW(e)?6==i||0==i?0:r>1410?3:r<820?1:2:this.IsJP(e)?6==i||0==i?0:r>1520?3:r<830?1:2:this.IsNYMEX(e)?this.GetNYMEXMarketStatus(e):this.IsCOMEX(e)?this.GetCOMEXMarketStatus(e):this.IsNYBOT(e)?this.GetNYBOTMarketStatus(e):this.IsCBOT(e)?this.GetCBOTMarketStatus(e):this.IsLME(e)?this.GetLMEMarketStatus(e):this.IsTOCOM(e)?this.GetTOCOMMarketStatus(e):this.IsChinaFutures(e)?6==i||0==i?0:r>=2100||r<=240||r>=830&&r<=1510?2:1:6==i||0==i?0:r>1540?3:r<925?1:2},GetLimitPriceRange:function(t,e){return this.IsSHSZStockA(t)?this.IsSHStockSTAR(t)?{Max:.2,Min:-.2}:e?e.indexOf("ST")>=0?{Max:.05,Min:-.05}:{Max:.1,Min:-.1}:null:null},GetDefaultDecimal:function(t){return 2},GetFHKDecimal:function(t){return 0},GetFTSEDecimal:function(t){return 0},GetBITDecimal:function(t){return 2},GetSHODecimal:function(t){return 4},GetETDecimal:function(t){return 2},GetHKDecimal:function(t){return 2},GetTWDecimal:function(t){return 2},GetJPDecimal:function(t){return 2},GetForeignExchangeDecimal:function(t){return 4},GetNYMEXDecimal:function(t){return Zr.GetDecimal(t)},GetCOMEXDecimal:function(t){return Qr.GetDecimal(t)},GetNYBOTDecimal:function(t){return jr.GetDecimal(t)},GetCBOTDecimal:function(t){return $r.GetDecimal(t)},GetLMEDecimal:function(t){return tn.GetDecimal(t)},GetTOCOMDecimal:function(t){return en.GetDecimal(t)},GetIPEDecimal:function(t){return an.GetDecimal(t)},GetETMarketStatus:function(t){return 2},GetNYMEXMarketStatus:function(t){return Zr.GetMarketStatus(t)},GetCOMEXMarketStatus:function(t){return Qr.GetMarketStatus(t)},GetNYBOTMarketStatus:function(t){return jr.GetMarketStatus(t)},GetCBOTMarketStatus:function(t){return $r.GetMarketStatus(t)},GetLMEMarketStatus:function(t){return tn.GetMarketStatus(t)},GetTOCOMMarketStatus:function(t){return en.GetMarketStatus(t)},GetIPEMarketStatus:function(t){return an.GetMarketStatus(t)},IsShowMinuteVolTitle:function(t){if(!t)return!1;t.toUpperCase();return!1},IsShowMinutePostionLine:function(t){return!!(Br.IsFutures(t)||Br.IsSHO(t)||Br.IsSZO(t))},IsShowMinuteColorVolBar:function(t){return!!Oi.Minute.VolBarColor},IsEnableRight:function(t,e){return!(!Br.IsSHSZStockA(e)&&!Br.IsBJStock(e))&&(!Ot.IsTickPeriod(t)&&!Ot.IsMinutePeriod(t,!0))}};function Vr(){this.SHSZ=null,this.BJ=null,this.SHO=null,this.HK=null,this.Futures=new E.default,this.USA=null,this.FTSE=null,this.FHK=null,this.ForeEx=null,this.BIT=null,this.TW=null,this.JP=null,this.Initialize=function(){},this.GetET=function(t){throw{Name:"MinuteTimeStringData::GetET",Error:"not implement"}},this.GetSHSZ=function(t){return this.SHSZ||(this.SHSZ=this.CreateSHSZData()),this.SHSZ},this.GetBJ=function(t){return this.BJ||(this.BJ=this.CreateBJData()),this.BJ},this.GetSHO=function(){return this.SHO||(this.SHO=this.CreateSHOData()),this.SHO},this.GetHK=function(t){return this.HK||(this.HK=this.CreateHKData()),this.HK},this.GetTW=function(t){return this.TW&&(this.TW=this.CreateTWData()),this.TW},this.GetJP=function(t){return this.JP&&(this.JP=this.CreateJPData()),this.JP},this.GetFutures=function(t){if(!this.Futures.has(t.Name)){var e=this.CreateTimeData(t.Data);this.Futures.set(t.Name,e)}return this.Futures.get(t.Name)},this.GetUSA=function(){return this.USA||(this.USA=this.CreateUSAData(0)),this.USA},this.GetFTSE=function(){return this.FTSE||(this.FTSE=this.CreateFTSEData()),this.FTSE},this.GetFHK=function(){return this.FHK||(this.FHK=this.CreateFHKData()),this.FHK},this.GetForeignExchange=function(){return this.ForeEx||(this.ForeEx=this.CreateForeignExchangeData()),this.ForeEx},this.GetBIT=function(t){return this.BIT||(this.BIT=this.CreateBITData()),this.BIT},this.CreateSHSZData=function(){var t=[{Start:925,End:925},{Start:930,End:1130},{Start:1300,End:1500}];return this.CreateTimeData(t)},this.CreateBJData=function(){var t=[{Start:925,End:925},{Start:930,End:1130},{Start:1300,End:1500}];return this.CreateTimeData(t)},this.CreateSHOData=function(){var t=[{Start:930,End:1129},{Start:1300,End:1500}];return this.CreateTimeData(t)},this.CreateHKData=function(){var t=[{Start:930,End:1200},{Start:1300,End:1600}];return this.CreateTimeData(t)},this.CreateTWData=function(){var t=[{Start:900,End:1330}];return this.CreateTimeData(t)},this.CreateJPData=function(){var t=[{Start:900,End:1130},{Start:1230,End:1500}];return this.CreateTimeData(t)},this.CreateFTSEData=function(){var t=[{Start:1700,End:2359},{Start:0,End:445},{Start:900,End:1630}];return this.CreateTimeData(t)},this.CreateFHKData=function(){var t=[{Start:1715,End:2359},{Start:0,End:300},{Start:915,End:1200},{Start:1300,End:1630}];return this.CreateTimeData(t)},this.CreateUSAData=function(t){if(1==t){var e=[{Start:2130,End:2359},{Start:0,End:400}];return this.CreateTimeData(e)}if(2==t){var a=[{Start:2230,End:2359},{Start:0,End:500}];return this.CreateTimeData(a)}var i=[{Start:930,End:1600}];return this.CreateTimeData(i)},this.CreateForeignExchangeData=function(){var t=[{Start:600,End:2359},{Start:0,End:559}];return this.CreateTimeData(t)},this.CreateBITData=function(){var t=[{Start:600,End:2359},{Start:0,End:559}];return this.CreateTimeData(t)},this.CreateTimeData=function(t){var e=[];for(var a in t)for(var i=t[a],r=i.Start;r<=i.End;++r)r%100>=60||e.push(r);return e},this.GetTimeData=function(t){if(!t)return this.SHSZ;var e=t.toLocaleUpperCase();if(Br.IsSH(e)||Br.IsSZ(e))return this.GetSHSZ(e);if(Br.IsBJ(e))return this.GetBJ(e);if(Br.IsSHO(e)||Br.IsSZO(e))return this.GetSHO();if(Br.IsHK(e))return this.GetHK(e);if(Br.IsTW(e))return this.GetTW(e);if(Br.IsJP(e))return this.GetJP(e);if(Br.IsUSA(e))return this.GetUSA(!0);if(Br.IsCFFEX(e)||Br.IsCZCE(e)||Br.IsDCE(e)||Br.IsSHFE(e)){var a=qr.GetSplitData(e);return a?this.GetFutures(a):null}if(Br.IsFTSE(e))return this.GetFTSE();if(Br.IsFHK(e))return this.GetFHK();if(Br.IsForeignExchange(e))return this.GetForeignExchange();if(Br.IsET(e))return this.GetET(e);if(Br.IsBIT(e))return this.GetBIT(e);if(Br.IsNYMEX(e)){a=Zr.GetSplitData(e);return a?this.GetFutures(a):null}if(Br.IsCOMEX(e)){a=Qr.GetSplitData(e);return a?this.GetFutures(a):null}if(Br.IsNYBOT(e)){a=jr.GetSplitData(e);return a?this.GetFutures(a):null}if(Br.IsCBOT(e)){a=$r.GetSplitData(e);return a?this.GetFutures(a):null}if(Br.IsLME(e)){a=tn.GetSplitData(e);return a?this.GetFutures(a):null}if(Br.IsTOCOM(e)){a=en.GetSplitData(e);return a?this.GetFutures(a):null}if(Br.IsIPE(e)){a=an.GetSplitData(e);return a?this.GetFutures(a):null}}}function Gr(){var t={Full:[[0,0,"rgb(200,200,200)","09:30"],[31,0,"RGB(200,200,200)","10:00"],[61,0,"RGB(200,200,200)","10:30"],[91,0,"RGB(200,200,200)","11:00"],[122,1,"RGB(200,200,200)","13:00"],[152,0,"RGB(200,200,200)","13:30"],[182,0,"RGB(200,200,200)","14:00"],[212,0,"RGB(200,200,200)","14:30"],[242,1,"RGB(200,200,200)","15:00"]],Simple:[[0,0,"rgb(200,200,200)","09:30"],[61,0,"RGB(200,200,200)","10:30"],[122,1,"RGB(200,200,200)","13:00"],[182,0,"RGB(200,200,200)","14:00"],[242,1,"RGB(200,200,200)","15:00"]],Min:[[0,0,"rgb(200,200,200)","09:30"],[122,1,"RGB(200,200,200)","13:00"],[242,1,"RGB(200,200,200)","15:00"]],Count:243,MiddleCount:122,GetData:function(t){return t<200?this.Min:t<400?this.Simple:this.Full}},e={Full:[[0,0,"rgb(200,200,200)","09:30"],[30,0,"RGB(200,200,200)","10:00"],[60,0,"RGB(200,200,200)","10:30"],[90,0,"RGB(200,200,200)","11:00"],[120,1,"RGB(200,200,200)","13:00"],[150,0,"RGB(200,200,200)","13:30"],[180,0,"RGB(200,200,200)","14:00"],[210,0,"RGB(200,200,200)","14:30"],[240,1,"RGB(200,200,200)","15:00"]],Simple:[[0,0,"rgb(200,200,200)","09:30"],[60,0,"RGB(200,200,200)","10:30"],[120,1,"RGB(200,200,200)","13:00"],[180,0,"RGB(200,200,200)","14:00"],[240,1,"RGB(200,200,200)","15:00"]],Min:[[0,0,"rgb(200,200,200)","09:30"],[120,1,"RGB(200,200,200)","13:00"],[240,1,"RGB(200,200,200)","15:00"]],Count:241,MiddleCount:120,GetData:function(t){return t<200?this.Min:t<400?this.Simple:this.Full}},a={Full:[[0,1,"RGB(200,200,200)","09:30"],[30,0,"RGB(200,200,200)","10:00"],[60,1,"RGB(200,200,200)","10:30"],[90,0,"RGB(200,200,200)","11:00"],[120,1,"RGB(200,200,200)","11:30"],[151,0,"RGB(200,200,200)","13:00"],[181,1,"RGB(200,200,200)","13:30"],[211,0,"RGB(200,200,200)","14:00"],[241,1,"RGB(200,200,200)","14:30"],[271,0,"RGB(200,200,200)","15:00"],[301,1,"RGB(200,200,200)","15:30"],[331,1,"RGB(200,200,200)","16:00"]],Simple:[[0,1,"RGB(200,200,200)","09:30"],[60,1,"RGB(200,200,200)","10:30"],[120,1,"RGB(200,200,200)","11:30"],[211,0,"RGB(200,200,200)","14:00"],[271,0,"RGB(200,200,200)","15:00"],[331,1,"RGB(200,200,200)","16:00"]],Min:[[0,1,"RGB(200,200,200)","09:30"],[151,0,"RGB(200,200,200)","13:00"],[331,1,"RGB(200,200,200)","16:00"]],Count:332,MiddleCount:151,GetData:function(t){return t<200?this.Min:t<450?this.Simple:this.Full}},i={Full:[[0,0,"rgb(200,200,200)","9:30"],[30,0,"RGB(200,200,200)","10:00"],[90,1,"RGB(200,200,200)","11:00"],[150,0,"RGB(200,200,200)","12:00"],[210,0,"RGB(200,200,200)","13:00"],[270,0,"RGB(200,200,200)","14:00"],[330,0,"RGB(200,200,200)","15:00"],[390,0,"RGB(200,200,200)","16:00"]],Simple:[[30,0,"rgb(200,200,200)","10:00"],[150,1,"RGB(200,200,200)","12:00"],[270,0,"RGB(200,200,200)","14:00"],[390,0,"RGB(200,200,200)","16:00"]],Min:[[30,0,"rgb(200,200,200)","10:00"],[210,1,"RGB(200,200,200)","13:00"],[390,0,"RGB(200,200,200)","16:00"]],Count:391,MiddleCount:211,GetData:function(t){return t<200?this.Min:t<400?this.Simple:this.Full}},r={Full:[[0,1,"RGB(200,200,200)","17:00"],[120,1,"RGB(200,200,200)","19:00"],[240,1,"RGB(200,200,200)","21:00"],[360,1,"RGB(200,200,200)","23:00"],[480,1,"RGB(200,200,200)","01:00"],[600,1,"RGB(200,200,200)","03:00"],[706,1,"RGB(200,200,200)","09:00"],[826,1,"RGB(200,200,200)","11:00"],[946,1,"RGB(200,200,200)","13:00"],[1066,1,"RGB(200,200,200)","15:00"],[1156,1,"RGB(200,200,200)","16:30"]],Simple:[[0,1,"RGB(200,200,200)","17:00"],[240,1,"RGB(200,200,200)","21:00"],[480,1,"RGB(200,200,200)","01:00"],[706,1,"RGB(200,200,200)","09:00"],[946,1,"RGB(200,200,200)","13:00"],[1156,1,"RGB(200,200,200)","16:30"]],Min:[[0,1,"RGB(200,200,200)","17:00"],[706,1,"RGB(200,200,200)","09:00"],[1156,1,"RGB(200,200,200)","16:30"]],Count:1157,MiddleCount:707,GetData:function(t){return t<200?this.Min:t<450?this.Simple:this.Full}},n={Full:[[0,1,"RGB(200,200,200)","17:15"],[105,1,"RGB(200,200,200)","19:00"],[225,1,"RGB(200,200,200)","21:00"],[345,1,"RGB(200,200,200)","23:00"],[586,0,"RGB(200,200,200)","09:15"],[691,1,"RGB(200,200,200)","11:00"],[812,1,"RGB(200,200,200)","14:00"],[963,1,"RGB(200,200,200)","16:30"]],Simple:[[0,1,"RGB(200,200,200)","17:15"],[225,1,"RGB(200,200,200)","21:00"],[586,0,"RGB(200,200,200)","09:15"],[752,1,"RGB(200,200,200)","13:00"],[963,1,"RGB(200,200,200)","16:30"]],Min:[[0,1,"RGB(200,200,200)","17:15"],[586,0,"RGB(200,200,200)","09:15"],[963,1,"RGB(200,200,200)","16:30"]],Count:963,MiddleCount:526,GetData:function(t){return t<200?this.Min:t<450?this.Simple:this.Full}},s={Full:[[0,1,"RGB(200,200,200)","06:00"],[120,1,"RGB(200,200,200)","08:00"],[240,1,"RGB(200,200,200)","10:00"],[360,1,"RGB(200,200,200)","12:00"],[480,0,"RGB(200,200,200)","14:00"],[600,1,"RGB(200,200,200)","16:00"],[720,1,"RGB(200,200,200)","18:00"],[840,1,"RGB(200,200,200)","20:00"],[960,1,"RGB(200,200,200)","22:00"],[1080,1,"RGB(200,200,200)","0:00"],[1200,1,"RGB(200,200,200)","02:00"],[1320,1,"RGB(200,200,200)","04:00"]],Simple:[[0,1,"RGB(200,200,200)","06:00"],[240,1,"RGB(200,200,200)","10:00"],[480,0,"RGB(200,200,200)","14:00"],[720,1,"RGB(200,200,200)","18:00"],[960,1,"RGB(200,200,200)","22:00"],[1200,1,"RGB(200,200,200)","02:00"]],Min:[[0,1,"RGB(200,200,200)","06:00"],[480,0,"RGB(200,200,200)","14:00"],[960,1,"RGB(200,200,200)","22:00"]],Count:1440,MiddleCount:600,GetData:function(t){return t<200?this.Min:t<450?this.Simple:this.Full}},o={Full:[[0,1,"RGB(200,200,200)","09:00"],[30,0,"RGB(200,200,200)","09:30"],[60,1,"RGB(200,200,200)","10:00"],[90,0,"RGB(200,200,200)","10:30"],[120,1,"RGB(200,200,200)","11:00"],[150,0,"RGB(200,200,200)","11:30"],[180,1,"RGB(200,200,200)","12:00"],[210,0,"RGB(200,200,200)","12:30"],[240,1,"RGB(200,200,200)","13:00"],[270,0,"RGB(200,200,200)","13:30"]],Simple:[[0,1,"RGB(200,200,200)","09:00"],[60,1,"RGB(200,200,200)","10:00"],[120,1,"RGB(200,200,200)","11:00"],[180,1,"RGB(200,200,200)","12:00"],[270,0,"RGB(200,200,200)","13:30"]],Min:[[0,1,"RGB(200,200,200)","09:00"],[60,1,"RGB(200,200,200)","11:00"],[270,0,"RGB(200,200,200)","13:30"]],Count:271,MiddleCount:151,GetData:function(t){return t<200?this.Min:t<450?this.Simple:this.Full}};this.GetCoordinateData=function(e,a){var i=null;if(e){var r=e.toLocaleUpperCase();if(Br.IsSH(r)||Br.IsSZ(r)||Br.IsSHSZIndex(r))i=this.GetSHSZData(r,a);else if(Br.IsBJ(r))i=this.GetBJData(r,a);else if(Br.IsSHO(r)||Br.IsSZO(r))i=this.GetSHOData(r,a);else if(Br.IsHK(r))i=this.GetHKData(r,a);else if(Br.IsTW(r))i=this.GetTWData(r,a);else if(Br.IsJP(r))i=this.GetJPData(r,a);else{if(Br.IsCFFEX(r)||Br.IsCZCE(r)||Br.IsDCE(r)||Br.IsSHFE(r))return this.GetChinatFuturesData(r,a);if(Br.IsUSA(r))i=this.GetUSAData(r,a);else if(Br.IsFTSE(r))i=this.GetFTSEData(r,a);else if(Br.IsFHK(r))i=this.GetFHKData(r,a);else if(Br.IsForeignExchange(r))i=this.GetForeignExchangeData(r);else if(Br.IsBIT(r,a))i=this.GetBITData(r,a);else if(Br.IsET(r))i=this.GetETData(r,a);else{if(Br.IsNYMEX(r))return this.GetNYMEXData(r,a);if(Br.IsCOMEX(r))return this.GetCOMEXData(r,a);if(Br.IsNYBOT(r))return this.GetNYBOTData(r,a);if(Br.IsCBOT(r))return this.GetCBOTData(r,a);if(Br.IsLME(r))return this.GetLMEData(r,a);if(Br.IsTOCOM(r))return this.GetTOCOMData(r,a);if(Br.IsIPE(r))return this.GetIPEData(r,a)}}}else i=t;var n={Count:i.Count,MiddleCount:i.MiddleCount,Data:i.GetData(a)};return n},this.GetSHSZData=function(e,a){var i=t;return i},this.GetBJData=function(e,a){var i=t;return i},this.GetUSAData=function(t,e){var a=i;return a},this.GetHKData=function(t,e){var i=a;return i},this.GetTWData=function(t,e){return o},this.GetSHOData=function(t,a){var i=e;return i},this.GetFuturesData=function(t,e,a){var i=a.GetSplitData(t);if(!i)return null;var r=Jr.GetFutures(i);if(!r)return null;var n={Count:r.length},s=null,o=200,h=480;s=e<o?i.Coordinate.Min:e<h?i.Coordinate.Simple:i.Coordinate.Full;for(var l=[],u=0;u<r.length;++u)for(var C=r[u],D=0;D<s.length;++D){var f=s[D];if(C==f.Value){var c=[u,0,"RGB(200,200,200)",f.Text];l.push(c);break}}return n.Data=l,n},this.GetChinatFuturesData=function(t,e){return this.GetFuturesData(t,e,qr)},this.GetNYMEXData=function(t,e){return this.GetFuturesData(t,e,Zr)},this.GetCOMEXData=function(t,e){return this.GetFuturesData(t,e,Qr)},this.GetNYBOTData=function(t,e){return this.GetFuturesData(t,e,jr)},this.GetCBOTData=function(t,e){return this.GetFuturesData(t,e,$r)},this.GetLMEData=function(t,e){return this.GetFuturesData(t,e,tn)},this.GetTOCOMData=function(t,e){return this.GetFuturesData(t,e,en)},this.GetIPEData=function(t,e){return this.GetFuturesData(t,e,an)},this.GetFTSEData=function(t,e){var a=r;return a},this.GetFHKData=function(t,e){var a=n;return a},this.GetForeignExchangeData=function(t,e){var a=s;return a},this.GetBITData=function(t,e){var a=s;return a},this.GetETData=function(t,e){throw{Name:"MinuteCoordinateData::GetETData",Error:"not implement"}},this.GetJPData=function(t,e){throw{Name:"MinuteCoordinateData::GetJPData",Error:"not implement"}}}function Hr(){this.TIME_SPLIT=[{Name:"9:00-10:15,10:31-11:30,13:31-15:00",Data:[{Start:900,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:930,Text:"9:30"},{Value:1e3,Text:"10:00"},{Value:1030,Text:"10:30"},{Value:1100,Text:"11:00"},{Value:1330,Text:"13:30"},{Value:1400,Text:"14:00"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1e3,Text:"10:00"},{Value:1330,Text:"13:30"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Min:[{Value:900,Text:"9:00"},{Value:1330,Text:"13:30"},{Value:1500,Text:"15:00"}]}},{Name:"9:30-11:30,13:01-15:15",Data:[{Start:930,End:1130},{Start:1301,End:1515}],Coordinate:{Full:[{Value:930,Text:"9:30"},{Value:1e3,Text:"10:00"},{Value:1030,Text:"10:30"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1330,Text:"13:30"},{Value:1400,Text:"14:00"},{Value:1430,Text:"14:30"},{Value:1515,Text:"15:15"}],Simple:[{Value:930,Text:"9:30"},{Value:1030,Text:"10:30"},{Value:1300,Text:"13:00"},{Value:1400,Text:"14:00"},{Value:1515,Text:"15:15"}],Min:[{Value:930,Text:"9:30"},{Value:1300,Text:"13:00"},{Value:1515,Text:"15:15"}]}},{Name:"9:30-11:30,13:00-15:00",Data:[{Start:930,End:1130},{Start:1301,End:1500}],Coordinate:{Full:[{Value:930,Text:"9:30"},{Value:1e3,Text:"10:00"},{Value:1030,Text:"10:30"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1330,Text:"13:30"},{Value:1400,Text:"14:00"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:930,Text:"9:30"},{Value:1030,Text:"10:30"},{Value:1300,Text:"13:00"},{Value:1400,Text:"14:00"},{Value:1500,Text:"15:00"}],Min:[{Value:930,Text:"9:30"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"}]}},{Name:"21:00-23:30,9:00-10:15,10:30-11:30,13:30-15:00",Data:[{Start:2100,End:2330},{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:2100,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:901,Text:"9:00"},{Value:1031,Text:"10:30"},{Value:1331,Text:"13:30"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:2100,Text:"21:00"},{Value:901,Text:"9:00"},{Value:1331,Text:"13:30"},{Value:1500,Text:"15:00"}],Min:[{Value:2100,Text:"21:00"},{Value:901,Text:"9:00"},{Value:1500,Text:"15:00"}]}},{Name:"21:00-1:00,9:01-10:15,10:31-11:30,13:31-15:00",Data:[{Start:2100,End:2359},{Start:0,End:100},{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:2100,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:901,Text:"9:00"},{Value:1031,Text:"10:30"},{Value:1331,Text:"13:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:901,Text:"9:00"},{Value:1031,Text:"10:30"},{Value:1500,Text:"15:00"}],Min:[{Value:2100,Text:"21:00"},{Value:901,Text:"9:00"},{Value:1500,Text:"15:00"}]}},{Name:"21:00-2:30,9:01-10:15,10:31-11:30,13:31-15:00",Data:[{Start:2100,End:2359},{Start:0,End:230},{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:100,Text:"1:00"},{Value:901,Text:"9:00"},{Value:1031,Text:"10:30"},{Value:1331,Text:"13:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:901,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1500,Text:"15:00"}],Min:[{Value:2100,Text:"21:00"},{Value:901,Text:"9:00"},{Value:1500,Text:"15:00"}]}},{Name:"21:00-23:00,9:01-10:15,10:30-11:30,13:31-15:00",Data:[{Start:2100,End:2300},{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:2100,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:1030,Text:"10:30"},{Value:1331,Text:"13:30"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1331,Text:"13:30"},{Value:1500,Text:"15:00"}],Min:[{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1500,Text:"15:00"}]}},{Name:"9:00-11:30,13:00-15:00",Data:[{Start:900,End:1130},{Start:1300,End:1500}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1e3,Text:"10:00"},{Value:1030,Text:"10:30"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1330,Text:"13:30"},{Value:1400,Text:"14:00"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1e3,Text:"10:00"},{Value:1300,Text:"13:00"},{Value:1400,Text:"14:00"},{Value:1500,Text:"15:00"}],Min:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"}]}},{Name:"21:00-23:00,9:00-10:15,10:30-11:30,13:30-15:00",Data:[{Start:2100,End:2300},{Start:900,End:1015},{Start:1030,End:1130},{Start:1330,End:1500}],Coordinate:{Full:[{Value:2100,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:1030,Text:"10:30"},{Value:1331,Text:"13:30"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1331,Text:"13:30"},{Value:1500,Text:"15:00"}],Min:[{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1500,Text:"15:00"}]}},{Name:"9:01-10:15,10:31-11:30,13:31-15:00",Data:[{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:901,Text:"9:00"},{Value:930,Text:"9:30"},{Value:1e3,Text:"10:00"},{Value:1030,Text:"10:30"},{Value:1100,Text:"11:00"},{Value:1330,Text:"13:30"},{Value:1400,Text:"14:00"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:901,Text:"9:00"},{Value:1e3,Text:"10:00"},{Value:1330,Text:"13:30"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Min:[{Value:901,Text:"9:00"},{Value:1330,Text:"13:30"},{Value:1500,Text:"15:00"}]}},{Name:"21:01-1:00,9:01-10:15,10:31-11:30,13:31-15:00",Data:[{Start:2101,End:2359},{Start:0,End:100},{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:2101,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:901,Text:"9:00"},{Value:1031,Text:"10:30"},{Value:1331,Text:"13:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:2101,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:901,Text:"9:00"},{Value:1031,Text:"10:30"},{Value:1500,Text:"15:00"}],Min:[{Value:2101,Text:"21:00"},{Value:901,Text:"9:00"},{Value:1500,Text:"15:00"}]}},{Name:"21:01-23:00,9:01-10:15,10:30-11:30,13:31-15:00",Data:[{Start:2101,End:2300},{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:2101,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:1030,Text:"10:30"},{Value:1331,Text:"13:30"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:2101,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1331,Text:"13:30"},{Value:1500,Text:"15:00"}],Min:[{Value:2101,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1500,Text:"15:00"}]}},{Name:"21:01-2:30,9:01-10:15,10:31-11:30,13:31-15:00",Data:[{Start:2101,End:2359},{Start:0,End:230},{Start:901,End:1015},{Start:1031,End:1130},{Start:1331,End:1500}],Coordinate:{Full:[{Value:2101,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:100,Text:"1:00"},{Value:901,Text:"9:00"},{Value:1031,Text:"10:30"},{Value:1331,Text:"13:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:2101,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:901,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1500,Text:"15:00"}],Min:[{Value:2101,Text:"21:00"},{Value:901,Text:"9:00"},{Value:1500,Text:"15:00"}]}},{Name:"9:30-11:30,13:01-15:15",Data:[{Start:931,End:1130},{Start:1301,End:1515}],Coordinate:{Full:[{Value:931,Text:"9:30"},{Value:1e3,Text:"10:00"},{Value:1030,Text:"10:30"},{Value:1100,Text:"11:00"},{Value:1301,Text:"13:00"},{Value:1330,Text:"13:30"},{Value:1400,Text:"14:00"},{Value:1430,Text:"14:30"},{Value:1515,Text:"15:15"}],Simple:[{Value:931,Text:"9:30"},{Value:1030,Text:"10:30"},{Value:1301,Text:"13:00"},{Value:1400,Text:"14:00"},{Value:1515,Text:"15:15"}],Min:[{Value:931,Text:"9:30"},{Value:1301,Text:"13:00"},{Value:1515,Text:"15:15"}]}},{Name:"9:31-11:30,13:01-15:00",Data:[{Start:931,End:1130},{Start:1301,End:1500}],Coordinate:{Full:[{Value:931,Text:"9:30"},{Value:1e3,Text:"10:00"},{Value:1030,Text:"10:30"},{Value:1100,Text:"11:00"},{Value:1301,Text:"13:00"},{Value:1330,Text:"13:30"},{Value:1400,Text:"14:00"},{Value:1430,Text:"14:30"},{Value:1500,Text:"15:00"}],Simple:[{Value:931,Text:"9:30"},{Value:1030,Text:"10:30"},{Value:1301,Text:"13:00"},{Value:1400,Text:"14:00"},{Value:1500,Text:"15:00"}],Min:[{Value:931,Text:"9:30"},{Value:1301,Text:"13:00"},{Value:1500,Text:"15:00"}]}}],this.MAP_TWOWORDS=new E.default([[Br.DCE+"-JD",{Time:0,Decimal:0,Name:"é¸¡è"}],[Br.DCE+"-FB",{Time:0,Decimal:2,Name:"çº¤æ¿"}],[Br.DCE+"-BB",{Time:0,Decimal:2,Name:"è¶æ¿"}],[Br.DCE+"-PP",{Time:6,Decimal:0,Name:"ä¸ç¯"}],[Br.DCE+"-JM",{Time:6,Decimal:1,Name:"ç¦ç¤"}],[Br.DCE+"-EG",{Time:6,Decimal:0,Name:"ä¹äºé"}],[Br.DCE+"-EB",{Time:6,Decimal:0,Name:"è¯ä¹ç¯"}],[Br.DCE+"-CS",{Time:6,Decimal:0,Name:"æ·ç²"}],[Br.DCE+"-PG",{Time:6,Decimal:0,Name:"æ¶²åæ°"}],[Br.DCE+"-RR",{Time:6,Decimal:0,Name:"æ¢ç±³"}],[Br.DCE+"-LH",{Time:0,Decimal:0,Name:"ççª"}],[Br.SHFE+"-CU",{Time:4,Decimal:0,Name:"é"}],[Br.SHFE+"-AL",{Time:4,Decimal:0,Name:"é"}],[Br.SHFE+"-NI",{Time:4,Decimal:0,Name:"é"}],[Br.SHFE+"-SN",{Time:4,Decimal:0,Name:"æ²ªé¡"}],[Br.SHFE+"-ZN",{Time:4,Decimal:0,Name:"æ²ªé"}],[Br.SHFE+"-PB",{Time:4,Decimal:0,Name:"æ²ªé"}],[Br.SHFE+"-RU",{Time:6,Decimal:0,Name:"å¤©ç¶æ©¡è¶"}],[Br.SHFE+"-FU",{Time:6,Decimal:0,Name:"çææ²¹"}],[Br.SHFE+"-RB",{Time:6,Decimal:0,Name:"èºçº¹é¢"}],[Br.SHFE+"-BU",{Time:6,Decimal:0,Name:"ç³æ²¹æ²¥é"}],[Br.SHFE+"-HC",{Time:6,Decimal:0,Name:"ç­è½§å·æ¿"}],[Br.SHFE+"-SP",{Time:6,Decimal:0,Name:"çº¸æµ"}],[Br.SHFE+"-WR",{Time:0,Decimal:0,Name:"çº¿æ"}],[Br.SHFE+"-AG",{Time:5,Decimal:0,Name:"ç½é¶"}],[Br.SHFE+"-AU",{Time:5,Decimal:2,Name:"é»é"}],[Br.SHFE+"-SS",{Time:4,Decimal:0,Name:"ä¸éé¢"}],[Br.SHFE+"-NR",{Time:6,Decimal:1,Name:"20å·è¶"}],[Br.SHFE+"-SC",{Time:5,Decimal:1,Name:"åæ²¹"}],[Br.SHFE+"-LU",{Time:6,Decimal:0,Name:"ä½ç¡«çæ²¹"}],[Br.SHFE+"-BC",{Time:4,Decimal:0,Name:"å½éé"}],[Br.CZCE+"-CF",{Time:6,Decimal:0,Name:"æ£è±"}],[Br.CZCE+"-SR",{Time:6,Decimal:0,Name:"ç½ç³"}],[Br.CZCE+"-MA",{Time:6,Decimal:0,Name:"ç²é"}],[Br.CZCE+"-ZC",{Time:6,Decimal:1,Name:"å¨åç¤"}],[Br.CZCE+"-TA",{Time:6,Decimal:0,Name:"ç²¾å¯¹è¯äºç²é¸(PTA)"}],[Br.CZCE+"-RM",{Time:6,Decimal:0,Name:"èç±½ç²"}],[Br.CZCE+"-OI",{Time:6,Decimal:0,Name:"èç±½æ²¹"}],[Br.CZCE+"-ME",{Time:3,Decimal:0,Name:"ç²é(è)"}],[Br.CZCE+"-FG",{Time:6,Decimal:0,Name:"å¹³æ¿ç»ç"}],[Br.CZCE+"-WS",{Time:0,Decimal:0}],[Br.CZCE+"-WT",{Time:0,Decimal:0}],[Br.CZCE+"-GN",{Time:0,Decimal:0}],[Br.CZCE+"-RO",{Time:0,Decimal:0}],[Br.CZCE+"-RS",{Time:0,Decimal:0,Name:"èç±½"}],[Br.CZCE+"-ER",{Time:0,Decimal:0}],[Br.CZCE+"-RI",{Time:0,Decimal:0,Name:"æ©ç±¼ç¨»"}],[Br.CZCE+"-WH",{Time:0,Decimal:0,Name:"å¼ºéº¦"}],[Br.CZCE+"-AP",{Time:0,Decimal:0,Name:"è¹æ"}],[Br.CZCE+"-PM",{Time:0,Decimal:0,Name:"æ®éº¦"}],[Br.CZCE+"-QM",{Time:0,Decimal:0}],[Br.CZCE+"-TC",{Time:0,Decimal:0}],[Br.CZCE+"-JR",{Time:0,Decimal:0,Name:"ç²³ç¨»"}],[Br.CZCE+"-LR",{Time:0,Decimal:0,Name:"æç±¼ç¨»"}],[Br.CZCE+"-SF",{Time:0,Decimal:0,Name:"ç¡é"}],[Br.CZCE+"-SM",{Time:0,Decimal:0,Name:"é°ç¡"}],[Br.CZCE+"-CJ",{Time:0,Decimal:2,Name:"çº¢æ£"}],[Br.CZCE+"-CY",{Time:6,Decimal:0,Name:"æ£çº±"}],[Br.CZCE+"-UR",{Time:0,Decimal:0,Name:"å°¿ç´ "}],[Br.CZCE+"-SA",{Time:6,Decimal:0,Name:"çº¯ç¢±"}],[Br.CZCE+"-PF",{Time:6,Decimal:0,Name:"ç­çº¤"}],[Br.CZCE+"-PK",{Time:0,Decimal:0,Name:"è±ç"}],[Br.CFFEX+"-TF",{Time:1,Decimal:3,Name:"äºåº"}],[Br.CFFEX+"-TS",{Time:1,Decimal:3,Name:"äºåº"}],[Br.CFFEX+"-IH",{Time:2,Decimal:1,Name:"ä¸è¯è¡ææè´§"}],[Br.CFFEX+"-IC",{Time:2,Decimal:1,Name:"ä¸­è¯è¡ææè´§"}],[Br.CFFEX+"-IF",{Time:2,Decimal:1,Name:"æ²ªæ·±è¡ææè´§"}]]),this.MAP_ONEWORD=new E.default([[Br.DCE+"-C",{Time:6,Decimal:0,Name:"çç±³"}],[Br.DCE+"-L",{Time:6,Decimal:0,Name:"ä¹ç¯"}],[Br.DCE+"-V",{Time:6,Decimal:0,Name:"PVC"}],[Br.DCE+"-A",{Time:6,Decimal:0,Name:"è±ä¸"}],[Br.DCE+"-B",{Time:6,Decimal:0,Name:"è±äº"}],[Br.DCE+"-M",{Time:6,Decimal:0,Name:"è±ç²"}],[Br.DCE+"-Y",{Time:6,Decimal:0,Name:"è±æ²¹"}],[Br.DCE+"-P",{Time:6,Decimal:0,Name:"æ£æ¦"}],[Br.DCE+"-J",{Time:6,Decimal:1,Name:"ç¦ç­"}],[Br.DCE+"-I",{Time:6,Decimal:1,Name:"éç¿"}],[Br.CFFEX+"-T",{Time:1,Decimal:3,Name:"ååº"}]]),this.AddNewFutures=function(t){if(t){var e=t.Suffix+"-"+t.Symbol,a={Time:t.Time,Decimal:t.Decimal,Name:t.Name};1==t.Symbol.length?this.MAP_ONEWORD.set(e,a):2==t.Symbol.length&&this.MAP_TWOWORDS.set(e,a)}},this.GetData=function(t){var e=t.charAt(0),a=t.substr(0,2),i=null,r=null;return Br.IsDCE(t)?(i=Br.DCE+"-"+e,r=Br.DCE+"-"+a):Br.IsSHFE(t)?(i=Br.SHFE+"-"+e,r=Br.SHFE+"-"+a):Br.IsCFFEX(t)?(i=Br.CFFEX+"-"+e,r=Br.CFFEX+"-"+a):Br.IsCZCE(t)&&(i=Br.CZCE+"-"+e,r=Br.CZCE+"-"+a),this.MAP_TWOWORDS.has(r)?this.MAP_TWOWORDS.get(r):this.MAP_ONEWORD.has(i)?this.MAP_ONEWORD.get(i):null},this.GetSplitData=function(t){var e=this.GetData(t);return e?this.TIME_SPLIT[e.Time]:null},this.GetDecimal=function(t){var e=this.GetData(t);return e?e.Decimal:2}}function Yr(){this.TIME_SPLIT=[{Name:"6:00-5:00",Data:[{Start:600,End:2359},{Start:0,End:500}],Coordinate:{Full:[{Value:600,Text:"6:00"},{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"},{Value:400,Text:"4:00"}],Simple:[{Value:600,Text:"6:00"},{Value:1e3,Text:"10:00"},{Value:1400,Text:"14:00"},{Value:1800,Text:"18:00"},{Value:2200,Text:"22:00"},{Value:200,Text:"2:00"}],Min:[{Value:600,Text:"6:00"},{Value:1800,Text:"18:00"},{Value:500,Text:"5:00"}]}}],this.TIME_SPLIT2=[{Name:"7:00-6:00",Data:[{Start:700,End:2359},{Start:0,End:600}],Coordinate:{Full:[{Value:700,Text:"7:00"},{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"},{Value:500,Text:"5:00"}],Simple:[{Value:700,Text:"7:00"},{Value:1100,Text:"11:00"},{Value:1500,Text:"15:00"},{Value:1900,Text:"19:00"},{Value:2300,Text:"23:00"},{Value:300,Text:"3:00"}],Min:[{Value:700,Text:"7:00"},{Value:1900,Text:"19:00"},{Value:500,Text:"5:00"}]}}],this.FUTURES_LIST=[{Symbol:"CL",Decimal:2,Time:0,Name:"åæ²¹"},{Symbol:"NG",Decimal:3,Time:0,Name:"å¤©ç¶æ°"},{Symbol:"RB",Decimal:4,Time:0,Name:"æ±½æ²¹"},{Symbol:"PL",Decimal:1,Time:0,Name:"éé"},{Symbol:"PA",Decimal:2,Time:0,Name:"é¯é"},{Symbol:"HR",Decimal:0,Time:0,Name:"ç­è½§é¢å·"},{Symbol:"QM",Decimal:3,Time:0,Name:"è¿·ä½ åæ²¹"},{Symbol:"HO",Decimal:4,Time:0,Name:"çæ²¹"}],this.MarketSuffix=".NYMEX",this.TimeType=0,this.GetFuturesInfo=function(t){if(t.indexOf(this.MarketSuffix)<=0)return null;for(var e in this.FUTURES_LIST){var a=this.FUTURES_LIST[e];if(0==t.indexOf(a.Symbol))return a}return null},this.GetSplitData=function(t){var e=0==this.TimeType?this.TIME_SPLIT:this.TIME_SPLIT2,a=this.GetFuturesInfo(t);return a?e[a.Time]:e[0]},this.GetDecimal=function(t){var e=this.GetFuturesInfo(t);return e?e.Decimal:3},this.GetMarketStatus=function(t){var e=nn(-4),a=new Date,i=e.getDay(),r=100*a.getHours()+a.getMinutes();return 6==i||0==i?0:r>430&&r<730?1:2},this.AddNewFutures=function(t){if(t){for(var e={Symbol:t.Symbol,Time:t.Time,Decimal:t.Decimal,Name:t.Name},a=0;a<this.FUTURES_LIST.length;++a){var i=this.FUTURES_LIST[a];if(i.Symbol==e.Symbol)return void(this.FUTURES_LIST[a]=e)}this.FUTURES_LIST.push(e)}}}function kr(){this.newMethod=Yr,this.newMethod(),delete this.newMethod,this.FUTURES_LIST=[{Symbol:"GC",Decimal:1,Time:0,Name:"COMEXé»é"},{Symbol:"QO",Decimal:2,Time:0,Name:"è¿·ä½ é»é"},{Symbol:"MG",Decimal:1,Time:0,Name:"å¾®åé»é"},{Symbol:"QI",Decimal:4,Time:0,Name:"è¿·ä½ ç½é¶"},{Symbol:"SI",Decimal:3,Time:0,Name:"COMEXç½é¶"},{Symbol:"HG",Decimal:4,Time:0,Name:"COMEXé"}],this.MarketSuffix=".COMEX"}function _r(){this.newMethod=Yr,this.newMethod(),delete this.newMethod,this.TIME_SPLIT=[{Name:"9:00-2:20",Data:[{Start:900,End:2359},{Start:0,End:220}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:100,Text:"1:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:100,Text:"1:00"}],Min:[{Value:900,Text:"9:00"},{Value:1700,Text:"17:00"},{Value:100,Text:"1:00"}]}},{Name:"15:30-1:00",Data:[{Start:1530,End:2359},{Start:0,End:100}],Coordinate:{Full:[{Value:1600,Text:"16:00"},{Value:1700,Text:"17:00"},{Value:1800,Text:"18:00"},{Value:1900,Text:"19:00"},{Value:2e3,Text:"20:00"},{Value:2100,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:0,Text:"0:00"},{Value:100,Text:"1:00"}],Simple:[{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"}],Min:[{Value:1600,Text:"16:00"},{Value:2100,Text:"21:00"},{Value:100,Text:"1:00"}]}}],this.TIME_SPLIT2=[{Name:"10:00-3:20",Data:[{Start:1e3,End:2359},{Start:0,End:320}],Coordinate:{Full:[{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"}],Simple:[{Value:1e3,Text:"10:00"},{Value:1400,Text:"14:00"},{Value:1800,Text:"18:00"},{Value:2200,Text:"22:00"},{Value:200,Text:"2:00"}],Min:[{Value:1e3,Text:"10:00"},{Value:1800,Text:"18:00"},{Value:200,Text:"2:00"}]}},{Name:"16:30-2:00",Data:[{Start:1630,End:2359},{Start:0,End:200}],Coordinate:{Full:[{Value:1700,Text:"17:00"},{Value:1800,Text:"18:00"},{Value:1900,Text:"19:00"},{Value:2e3,Text:"20:00"},{Value:2100,Text:"21:00"},{Value:2200,Text:"22:00"},{Value:2300,Text:"23:00"},{Value:0,Text:"0:00"},{Value:100,Text:"1:00"},{Value:200,Text:"2:00"}],Simple:[{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:100,Text:"1:00"}],Min:[{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:200,Text:"2:00"}]}}],this.FUTURES_LIST=[{Symbol:"SB",Decimal:2,Time:1},{Symbol:"CT",Decimal:2,Time:0}],this.MarketSuffix=".NYBOT",this.GetMarketStatus=function(t){var e=nn(-4),a=e.getDay(),i=100*e.getHours()+e.getMinutes();if(6==a||0==a)return 0;var r=this.GetFuturesInfo(t);if(!r)return 2;if("SB"==r.Symbol){if(i>300&&i<1400)return 2}else if("CT"==r.Symbol)return i>=0&&i<=1500||i>=2e3&&i<=2359?2:1;return 0}}function Xr(){this.newMethod=Yr,this.newMethod(),delete this.newMethod,this.TIME_SPLIT=[{Name:"8:00-2:20",Data:[{Start:800,End:2359},{Start:0,End:220}],Coordinate:{Full:[{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"}],Simple:[{Value:800,Text:"8:00"},{Value:1200,Text:"12:00"},{Value:1600,Text:"16:00"},{Value:2e3,Text:"20:00"},{Value:0,Text:"0:00"}],Min:[{Value:800,Text:"8:00"},{Value:1800,Text:"18:00"},{Value:200,Text:"2:00"}]}},{Name:"8:00-2:45",Data:[{Start:800,End:2359},{Start:0,End:245}],Coordinate:{Full:[{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"}],Simple:[{Value:800,Text:"8:00"},{Value:1200,Text:"12:00"},{Value:1600,Text:"16:00"},{Value:2e3,Text:"20:00"},{Value:0,Text:"0:00"}],Min:[{Value:800,Text:"8:00"},{Value:1800,Text:"18:00"},{Value:200,Text:"2:00"}]}},{Name:"6:00-5:00",Data:[{Start:600,End:2359},{Start:0,End:500}],Coordinate:{Full:[{Value:600,Text:"6:00"},{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"},{Value:400,Text:"4:00"}],Simple:[{Value:600,Text:"6:00"},{Value:1e3,Text:"10:00"},{Value:1400,Text:"14:00"},{Value:1800,Text:"18:00"},{Value:2200,Text:"22:00"},{Value:200,Text:"2:00"}],Min:[{Value:600,Text:"6:00"},{Value:1800,Text:"18:00"},{Value:500,Text:"5:00"}]}},{Name:"08:00-20:45 21:31-02:20",Data:[{Start:800,End:2045},{Start:2131,End:2359},{Start:0,End:220}],Coordinate:{Full:[{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"}],Simple:[{Value:800,Text:"8:00"},{Value:1200,Text:"12:00"},{Value:1600,Text:"16:00"},{Value:2e3,Text:"20:00"},{Value:0,Text:"0:00"}],Min:[{Value:800,Text:"8:00"},{Value:1800,Text:"18:00"},{Value:200,Text:"2:00"}]}},{Name:"8:00-2:45",Data:[{Start:800,End:2045},{Start:2131,End:2359},{Start:0,End:245}],Coordinate:{Full:[{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"}],Simple:[{Value:800,Text:"8:00"},{Value:1200,Text:"12:00"},{Value:1600,Text:"16:00"},{Value:2e3,Text:"20:00"},{Value:0,Text:"0:00"}],Min:[{Value:800,Text:"8:00"},{Value:1800,Text:"18:00"},{Value:200,Text:"2:00"}]}},{Name:"06:00-04:15 04:31-05:00",Data:[{Start:600,End:2359},{Start:0,End:415},{Start:431,End:500}],Coordinate:{Full:[{Value:600,Text:"6:00"},{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"},{Value:400,Text:"4:00"}],Simple:[{Value:600,Text:"6:00"},{Value:1e3,Text:"10:00"},{Value:1400,Text:"14:00"},{Value:1800,Text:"18:00"},{Value:2200,Text:"22:00"},{Value:200,Text:"2:00"}],Min:[{Value:600,Text:"6:00"},{Value:1800,Text:"18:00"},{Value:500,Text:"5:00"}]}}],this.TIME_SPLIT2=[{Name:"9:00-3:20",Data:[{Start:900,End:2359},{Start:0,End:320}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:1,Text:"1:00"}],Min:[{Value:900,Text:"9:00"},{Value:1900,Text:"19:00"},{Value:300,Text:"3:00"}]}},{Name:"9:00-3:45",Data:[{Start:900,End:2359},{Start:0,End:345}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:1,Text:"1:00"}],Min:[{Value:900,Text:"9:00"},{Value:1900,Text:"19:00"},{Value:300,Text:"3:00"}]}},{Name:"7:00-6:00",Data:[{Start:700,End:2359},{Start:0,End:600}],Coordinate:{Full:[{Value:700,Text:"7:00"},{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"},{Value:500,Text:"5:00"}],Simple:[{Value:700,Text:"7:00"},{Value:1100,Text:"11:00"},{Value:1500,Text:"15:00"},{Value:1900,Text:"19:00"},{Value:2300,Text:"23:00"},{Value:300,Text:"3:00"}],Min:[{Value:700,Text:"7:00"},{Value:1800,Text:"18:00"},{Value:500,Text:"5:00"}]}},{Name:"09:00-21:45 22:31-03:20",Data:[{Start:900,End:2145},{Start:2231,End:2359},{Start:0,End:320}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:1,Text:"1:00"}],Min:[{Value:900,Text:"9:00"},{Value:1900,Text:"19:00"},{Value:300,Text:"3:00"}]}},{Name:"09:00-21:45 22:31-03:45",Data:[{Start:900,End:2145},{Start:2231,End:2359},{Start:0,End:345}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:1,Text:"1:00"}],Min:[{Value:900,Text:"9:00"},{Value:1900,Text:"19:00"},{Value:300,Text:"3:00"}]}},{Name:"07:00-05:15 05:31-06:00",Data:[{Start:700,End:2359},{Start:0,End:515},{Start:531,End:600}],Coordinate:{Full:[{Value:700,Text:"7:00"},{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"},{Value:500,Text:"5:00"}],Simple:[{Value:700,Text:"7:00"},{Value:1100,Text:"11:00"},{Value:1500,Text:"15:00"},{Value:1900,Text:"19:00"},{Value:2300,Text:"23:00"},{Value:300,Text:"3:00"}],Min:[{Value:700,Text:"7:00"},{Value:1800,Text:"18:00"},{Value:500,Text:"5:00"}]}}],this.FUTURES_LIST=[{Symbol:"ZC",Decimal:2,Time:0,Name:"çç±³"},{Symbol:"XC",Decimal:2,Time:1,Name:"è¿·ä½ çç±³"},{Symbol:"ZS",Decimal:2,Time:0,Name:"å¤§è±"},{Symbol:"XK",Decimal:2,Time:1,Name:"è¿·ä½ å¤§è±"},{Symbol:"ZL",Decimal:2,Time:0,Name:"è±æ²¹"},{Symbol:"ZR",Decimal:2,Time:0,Name:"ç¨»è°·"},{Symbol:"ZO",Decimal:2,Time:0,Name:"çéº¦"},{Symbol:"ZW",Decimal:2,Time:0,Name:"å°éº¦"},{Symbol:"XW",Decimal:2,Time:1,Name:"è¿·ä½ å°éº¦"},{Symbol:"ZM",Decimal:1,Time:0,Name:"è±ç²"},{Symbol:"EH",Decimal:3,Time:2},{Symbol:"YM",Decimal:0,Time:2,Name:"å°åéæ"},{Symbol:"ES",Decimal:2,Time:2,Name:"å°åæ æ®"},{Symbol:"NQ",Decimal:2,Time:2,Name:"å°åçº³æ"},{Symbol:"TY",Decimal:4,Time:2,Name:"10å¹´ç¾å½åº"},{Symbol:"TU",Decimal:4,Time:2,Name:"2å¹´ç¾å½åº"},{Symbol:"FV",Decimal:4,Time:2,Name:"5å¹´ç¾å½åº"},{Symbol:"US",Decimal:4,Time:2,Name:"30å¹´ç¾å½åº"},{Symbol:"UL",Decimal:4,Time:2,Name:"è¶å½åº"}],this.MarketSuffix=".CBOT"}function Wr(){this.newMethod=Yr,this.newMethod(),delete this.newMethod,this.TIME_SPLIT=[{Name:"LME 9:00-3:00",Data:[{Start:900,End:2359},{Start:0,End:300}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:100,Text:"1:00"},{Value:300,Text:"3:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:100,Text:"1:00"}],Min:[{Value:900,Text:"9:00"},{Value:1800,Text:"18:00"},{Value:300,Text:"3:00"}]}}],this.TIME_SPLIT=[{Name:"LME 8:00-2:00",Data:[{Start:800,End:2359},{Start:0,End:200}],Coordinate:{Full:[{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"}],Simple:[{Value:800,Text:"8:00"},{Value:1200,Text:"12:00"},{Value:1600,Text:"16:00"},{Value:2e3,Text:"20:00"},{Value:0,Text:"0:00"}],Min:[{Value:800,Text:"8:00"},{Value:1800,Text:"18:00"},{Value:200,Text:"2:00"}]}}],this.FUTURES_LIST=[{Symbol:"SN",Decimal:0,Time:0,Name:"LMEé¡"},{Symbol:"AH",Decimal:2,Time:0,Name:"LMEé"},{Symbol:"PB",Decimal:2,Time:0,Name:"LMEé"},{Symbol:"ZS",Decimal:2,Time:0,Name:"LMEé"},{Symbol:"CA",Decimal:2,Time:0,Name:"LMEé"},{Symbol:"NI",Decimal:0,Time:0,Name:"LMEé"}],this.MarketSuffix=".LME"}function Ur(){this.newMethod=Yr,this.newMethod(),delete this.newMethod,this.TimeType=0,this.TIME_SPLIT=[{Name:"15:30-04:30 07:46-14:15",Data:[{Start:1530,End:2359},{Start:0,End:430},{Start:746,End:1415}],Coordinate:{Full:[{Value:1530,Text:"15:30"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:100,Text:"1:00"},{Value:300,Text:"3:00"},{Value:430,Text:"4:30"},{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1415,Text:"14:15"}],Simple:[{Value:1530,Text:"15:30"},{Value:1900,Text:"19:00"},{Value:2300,Text:"23:00"},{Value:100,Text:"1:00"},{Value:430,Text:"4:30"},{Value:1100,Text:"11:00"},{Value:1415,Text:"14:15"}],Min:[{Value:1530,Text:"15:30"},{Value:100,Text:"1:00"},{Value:1415,Text:"14:15"}]}}],this.FUTURES_LIST=[{Symbol:"JRV",Decimal:0,Time:0,Name:"ä¸äº¬TSR20æ©¡è¶"},{Symbol:"JPL",Decimal:0,Time:0,Name:"ä¸äº¬éé"},{Symbol:"JAU",Decimal:0,Time:0,Name:"ä¸äº¬é»é"},{Symbol:"JCO",Decimal:0,Time:0,Name:"ä¸­ä¸åæ²¹"},{Symbol:"JRU",Decimal:1,Time:0,Name:"ä¸äº¬RSS3æ©¡è¶æ©¡è¶"},{Symbol:"JAG",Decimal:1,Time:0,Name:"æ¥ç½é¶"},{Symbol:"JPA",Decimal:1,Time:0,Name:"æ¥é¯é"}],this.MarketSuffix=".TOCOM"}function Kr(){this.newMethod=Yr,this.newMethod(),delete this.newMethod,this.MarketSuffix=".IPE",this.TIME_SPLIT=[{Name:"8:00-6:00",Data:[{Start:800,End:2359},{Start:0,End:600}],Coordinate:{Full:[{Value:800,Text:"8:00"},{Value:1e3,Text:"10:00"},{Value:1200,Text:"12:00"},{Value:1400,Text:"14:00"},{Value:1600,Text:"16:00"},{Value:1800,Text:"18:00"},{Value:2e3,Text:"20:00"},{Value:2200,Text:"22:00"},{Value:0,Text:"0:00"},{Value:200,Text:"2:00"},{Value:400,Text:"4:00"},{Value:600,Text:"6:00"}],Simple:[{Value:800,Text:"8:00"},{Value:1200,Text:"12:00"},{Value:1600,Text:"16:00"},{Value:2e3,Text:"20:00"},{Value:0,Text:"0:00"},{Value:400,Text:"4:00"},{Value:600,Text:"6:00"}],Min:[{Value:800,Text:"8:00"},{Value:2e3,Text:"20:00"},{Value:600,Text:"6:00"}]}}],this.TIME_SPLIT2=[{Name:"09:00-07:00",Data:[{Start:900,End:2359},{Start:0,End:700}],Coordinate:{Full:[{Value:900,Text:"9:00"},{Value:1100,Text:"11:00"},{Value:1300,Text:"13:00"},{Value:1500,Text:"15:00"},{Value:1700,Text:"17:00"},{Value:1900,Text:"19:00"},{Value:2100,Text:"21:00"},{Value:2300,Text:"23:00"},{Value:1,Text:"1:00"},{Value:300,Text:"3:00"},{Value:500,Text:"5:00"},{Value:700,Text:"7:00"}],Simple:[{Value:900,Text:"9:00"},{Value:1300,Text:"13:00"},{Value:1700,Text:"17:00"},{Value:2100,Text:"21:00"},{Value:1,Text:"1:00"},{Value:500,Text:"5:00"},{Value:700,Text:"7:00"}],Min:[{Value:900,Text:"9:00"},{Value:2100,Text:"21:00"},{Value:700,Text:"7:00"}]}}],this.FUTURES_LIST=[{Symbol:"RC",Decimal:2,Time:0,Name:"ç½å¸æ¯å¡åå¡"},{Symbol:"W",Decimal:2,Time:0,Name:"ç½ç³"},{Symbol:"C",Decimal:2,Time:0,Name:"ä¼¦æ¦å¯å¯"},{Symbol:"R",Decimal:2,Time:0,Name:"é¿æè±å½å½åº"},{Symbol:"L",Decimal:2,Time:0,Name:"3ä¸ªæè±éå©ç"},{Symbol:"T",Decimal:2,Time:0,Name:"WTIåæ²¹"},{Symbol:"G",Decimal:2,Time:0,Name:"ä½ç¡«æ´æ²¹"},{Symbol:"B",Decimal:2,Time:0,Name:"å¸ä¼¦ç¹åæ²¹"}]}var Jr=new Vr,zr=new Gr,qr=new Hr,Zr=new Yr,Qr=new kr,jr=new _r,$r=new Xr,tn=new Wr,en=new Ur,an=new Kr;function rn(t){var e=2;if(!t)return e;var a=t.toUpperCase();return"function"==typeof Br.GetCustomDecimal?Br.GetCustomDecimal(a):(e=Br.IsSHSZFund(a)?3:Br.IsSHO(a)||Br.IsSZO(a)?Br.GetSHODecimal(a):Br.IsChinaFutures(a)?qr.GetDecimal(a):Br.IsFHK(a)?Br.GetFHKDecimal(a):Br.IsFTSE(a)?Br.GetFTSEDecimal(a):Br.IsBIT(a)?Br.GetBITDecimal(a):Br.IsET(a)?Br.GetETDecimal(a):Br.IsForeignExchange(a)?Br.GetForeignExchangeDecimal(a):Br.IsNYMEX(a)?Zr.GetDecimal(a):Br.IsCOMEX(a)?Qr.GetDecimal(a):Br.IsNYBOT(a)?jr.GetDecimal(a):Br.IsCBOT(a)?$r.GetDecimal(a):Br.IsLME(a)?tn.GetDecimal(a):Br.IsTOCOM(a)?en.GetDecimal(a):Br.IsIPE(a)?an.GetDecimal(a):Br.IsHK(a)?Br.GetHKDecimal(a):Br.IsTW(a)?Br.GetTWDecimal(a):Br.IsJP(a)?Br.GetJPDecimal(a):Br.GetDefaultDecimal(a),e)}function nn(t){if("number"===typeof t){var e=new Date,a=e.getTime(),i=6e4*e.getTimezoneOffset(),r=a+i;return new Date(r+36e5*t)}}if(!w)w={Chart:{Log:console.log,Warn:console.warn},Complier:{Log:console.log,Warn:console.warn}};var sn={Domain:"https://opensource.zealink.com",CacheDomain:"https://opensourcecache.zealink.com",DrawIcon:{Family:"iconfont",Data:new E.default([[1,{Text:"î ",Color:"rgb(243,28,15)"}],[2,{Text:"î¡",Color:"rgb(87,247,41)"}],[3,{Text:"î¢",Color:"rgb(237,153,0)"}],[4,{Text:"î£",Color:"rgb(237,153,0)"}],[5,{Text:"î¤",Color:"rgb(237,153,0)"}],[6,{Text:"î¥",Color:"rgb(140,57,208)"}],[7,{Text:"î¦",Color:"rgb(246,135,37)"}],[8,{Text:"î§",Color:"rgb(85,231,56)"}],[9,{Text:"î¨",Color:"rgb(227,61,41)"}],[10,{Text:"î©",Color:"rgb(216,78,48)"}],[11,{Text:"îª",Color:"rgb(249,187,0)"}],[12,{Text:"î«",Color:"rgb(249,187,0)"}],[13,{Text:"î¬",Color:"rgb(216,42,0)"}],[14,{Text:"î­",Color:"rgb(58,90,236)"}],[15,{Text:"î®",Color:"rgb(227,149,0)"}],[16,{Text:"î¯",Color:"rgb(208,82,78)"}],[17,{Text:"î°",Color:"rgb(234,114,26)"}],[18,{Text:"î±",Color:"rgb(116,25,255)"}],[19,{Text:"î²",Color:"rgb(102,9,11)"}],[20,{Text:"î³",Color:"rgb(127,125,137)"}],[21,{Text:"î´",Color:"rgb(110,188,255)"}],[22,{Text:"îµ",Color:"rgb(238,79,51)"}],[23,{Text:"î¶",Color:"rgb(244,71,0)"}],[24,{Text:"î·",Color:"rgb(102,183,248)"}],[25,{Text:"î¸",Color:"rgb(234,88,231)"}],[26,{Text:"î¹",Color:"rgb(242,171,0)"}],[27,{Text:"îº",Color:"rgb(87,247,168)"}],[28,{Text:"î»",Color:"rgb(97,204,113)"}],[29,{Text:"î¼",Color:"rgb(84,115,193)"}],[30,{Text:"î½",Color:"rgb(141,51,255)"}],[31,{Text:"î¾",Color:"rgb(200,126,24)"}],[32,{Text:"î¿",Color:"rgb(195,41,32)"}],[33,{Text:"î",Color:"rgb(215,85,194)"}],[34,{Text:"î",Color:"rgb(250,222,105)"}],[35,{Text:"î",Color:"rgb(112,249,224)"}],[36,{Text:"î",Color:"rgb(217,107,98)"}],[37,{Text:"î",Color:"rgb(114,231,17)"}],[38,{Text:"î",Color:"rgb(238,31,25)"}],[39,{Text:"î",Color:"rgb(92,247,113)"}],[40,{Text:"î",Color:"rgb(175,175,175)"}],[41,{Text:"î",Color:"rgb(252,228,23)"}],[42,{Text:"î",Color:"rgb(88,195,235)"}],[43,{Text:"î",Color:"rgb(55,74,94)"}],[44,{Text:"î",Color:"rgb(248,175,33)"}],[45,{Text:"î",Color:"rgb(194,180,112)"}],[46,{Text:"î",Color:"rgb(50,153,28)"}],[47,{Text:"î",Color:"rgb(17,65,152)"}],[48,{Text:"î",Color:"rgb(194,55,26)"}],[49,{Text:"î",Color:"rgb(243,0,0)"}]])},CustomDrawIcon:{Data:new E.default},CustomFunction:{Data:new E.default},CustomVariant:{Data:new E.default},GetDrawIcon:function(t){var e;if(sn.CustomDrawIcon.Data.has(t)){var a=sn.CustomDrawIcon.Data.get(t);return e=a.Symbol?{Symbol:a.Symbol,Color:a.Color,IconFont:!1,ID:t}:{Symbol:a.Text,Color:a.Color,Family:a.Family,IconFont:!0,ID:t},e}if(sn.DrawIcon.Data.has(t)){var i=sn.DrawIcon.Data.get(t);return e={Symbol:i.Text,Color:i.Color,Family:sn.DrawIcon.Family,IconFont:!0,ID:t},e}return null},GetDrawTextIcon:function(t){var e=new E.default([[1,{Symbol:"â",Color:"rgb(238,44,44)"}],[2,{Symbol:"â",Color:"rgb(0,139,69)"}],[3,{Symbol:"ð§"}],[4,{Symbol:"ð¨"}],[5,{Symbol:"ð"}],[6,{Symbol:"ð±"}],[7,{Symbol:"B",Color:"rgb(238,44,44)"}],[8,{Symbol:"S",Color:"rgb(0,139,69)"}],[9,{Symbol:"ð°"}],[10,{Symbol:"ðª"}],[11,{Symbol:"ð"}],[12,{Symbol:"ð"}],[13,{Symbol:"B",Color:"rgb(178,34,34)"}],[14,{Symbol:"S",Color:"rgb(0,139,69)"}],[36,{Symbol:"Î§",Color:"rgb(238,44,44)"}],[37,{Symbol:"X",Color:"rgb(0,139,69)"}],[38,{Symbol:"â²",Color:"rgb(238,44,44)"}],[39,{Symbol:"â¼",Color:"rgb(0,139,69)"}],[40,{Symbol:"â",Color:"rgb(238,44,44)"}],[41,{Symbol:"â",Color:"rgb(238,44,44)"}],[42,{Symbol:"ð"}],[43,{Symbol:"ð"}],[44,{Symbol:"ð¥"}],[45,{Symbol:"ð¥"}],[46,{Symbol:"ð¥"}],[47,{Symbol:"ð"}]]),a=e.get(t);return a},IsCustomFunction:function(t){return!!sn.CustomFunction.Data.has(t)},IsCustomVariant:function(t){return!!sn.CustomVariant.Data.has(t)}},on={BadGetterArity:"Getter must not have any formal parameters",BadSetterArity:"Setter must have exactly one formal parameter",BadSetterRestParameter:"Setter function argument must not be a rest parameter",ConstructorIsAsync:"Class constructor may not be an async method",ConstructorSpecialMethod:"Class constructor may not be an accessor",DeclarationMissingInitializer:"Missing initializer in %0 declaration",DefaultRestParameter:"Unexpected token =",DuplicateBinding:"Duplicate binding %0",DuplicateConstructor:"A class may only have one constructor",DuplicateProtoProperty:"Duplicate __proto__ fields are not allowed in object literals",ForInOfLoopInitializer:"%0 loop variable declaration may not have an initializer",GeneratorInLegacyContext:"Generator declarations are not allowed in legacy contexts",IllegalBreak:"Illegal break statement",IllegalContinue:"Illegal continue statement",IllegalExportDeclaration:"Unexpected token",IllegalImportDeclaration:"Unexpected token",IllegalLanguageModeDirective:"Illegal 'use strict' directive in function with non-simple parameter list",IllegalReturn:"Illegal return statement",InvalidEscapedReservedWord:"Keyword must not contain escaped characters",InvalidHexEscapeSequence:"Invalid hexadecimal escape sequence",InvalidLHSInAssignment:"Invalid left-hand side in assignment",InvalidLHSInForIn:"Invalid left-hand side in for-in",InvalidLHSInForLoop:"Invalid left-hand side in for-loop",InvalidModuleSpecifier:"Unexpected token",InvalidRegExp:"Invalid regular expression",LetInLexicalBinding:"let is disallowed as a lexically bound name",MissingFromClause:"Unexpected token",MultipleDefaultsInSwitch:"More than one default clause in switch statement",NewlineAfterThrow:"Illegal newline after throw",NoAsAfterImportNamespace:"Unexpected token",NoCatchOrFinally:"Missing catch or finally after try",ParameterAfterRestParameter:"Rest parameter must be last formal parameter",Redeclaration:"%0 '%1' has already been declared",StaticPrototype:"Classes may not have static property named prototype",StrictCatchVariable:"Catch variable may not be eval or arguments in strict mode",StrictDelete:"Delete of an unqualified identifier in strict mode.",StrictFunction:"In strict mode code, functions can only be declared at top level or inside a block",StrictFunctionName:"Function name may not be eval or arguments in strict mode",StrictLHSAssignment:"Assignment to eval or arguments is not allowed in strict mode",StrictLHSPostfix:"Postfix increment/decrement may not have eval or arguments operand in strict mode",StrictLHSPrefix:"Prefix increment/decrement may not have eval or arguments operand in strict mode",StrictModeWith:"Strict mode code may not include a with statement",StrictOctalLiteral:"Octal literals are not allowed in strict mode.",StrictParamDupe:"Strict mode function may not have duplicate parameter names",StrictParamName:"Parameter name eval or arguments is not allowed in strict mode",StrictReservedWord:"Use of future reserved word in strict mode",StrictVarName:"Variable name may not be eval or arguments in strict mode",TemplateOctalLiteral:"Octal literals are not allowed in template strings.",UnexpectedEOS:"Unexpected end of input",UnexpectedIdentifier:"Unexpected identifier",UnexpectedNumber:"Unexpected number",UnexpectedReserved:"Unexpected reserved word",UnexpectedString:"Unexpected string",UnexpectedTemplate:"Unexpected quasi %0",UnexpectedToken:"Unexpected token %0",UnexpectedTokenIllegal:"Unexpected token ILLEGAL",UnknownLabel:"Undefined label '%0'",UnterminatedRegExp:"Invalid regular expression: missing /"},hn={NonAsciiIdentifierStart:/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AD\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDEC0-\uDEF8]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]/,NonAsciiIdentifierPart:/[\xAA\xB5\xB7\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B4\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1369-\u1371\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFC-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AD\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C4\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF30-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDEC0-\uDEF8]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F]|\uD82C[\uDC00\uDC01]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/},ln={FromCodePoint:function(t){return t<65536?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10))+String.fromCharCode(56320+(t-65536&1023))},IsWhiteSpace:function(t){return 32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0},IsLineTerminator:function(t){return 10===t||13===t||8232===t||8233===t},IsIdentifierStart:function(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||92===t||12304===t||12305===t||9650===t||9660===t||t>=128&&hn.NonAsciiIdentifierStart.test(ln.FromCodePoint(t))},IsIdentifierPart:function(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||92===t||35===t||12304===t||12305===t||9650===t||9660===t||t>=128&&hn.NonAsciiIdentifierPart.test(ln.FromCodePoint(t))},IsDecimalDigit:function(t){return t>=48&&t<=57},IsHexDigit:function(t){return t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102},isOctalDigit:function(t){return t>=48&&t<=55}},un={};function Cn(){}function Dn(){this.Error=[],this.RecordError=function(t){this.Error.push(t)},this.ConstructError=function(t,e){var a=new Error(t);try{throw a}catch(i){C.default&&l.default&&(a=(0,C.default)(i),a.Column=e)}return a},this.CreateError=function(t,e,a,i,r){var n="Line "+e+": "+i,s=this.ConstructError(n,a);return s.Index=t,s.LineNumber=e,s.Description=i,s.Word=r,s},this.ThrowError=function(t,e,a,i,r){var n=this.CreateError(t,e,a,i,r);throw n},this.ThrowDownloadJob=function(t,e,a,i,r){var n=this.CreateError(t,e,a,i);throw n.Job=r,n}}function fn(t,e){this.Source=t,this.ErrorHandler=e,this.Length=t.length,this.Index=0,this.LineNumber=t.length>0?1:0,this.LineStart=0,this.CurlyStack=[],this.SaveState=function(){return{Index:this.Index,LineNumber:this.LineNumber,LineStart:this.LineStart}},this.RestoreState=function(t){this.Index=t.Index,this.LineNumber=t.LineNumber,this.LineStart=t.LineStart},this.IsEOF=function(){return this.Index>=this.Length},this.IsKeyword=function(t){return!1},this.CodePointAt=function(t){var e=this.Source.charCodeAt(t);if(e>=55296&&e<=56319){var a=this.Source.charCodeAt(t+1);if(a>=56320&&a<=57343){var i=e;e=1024*(i-55296)+a-56320+65536}}return e},this.Lex=function(){if(this.IsEOF())return{Type:2,Value:"",LineNumber:this.LineNumber,LineStart:this.LineStart,Start:this.Index,End:this.Index};var t=this.Source.charCodeAt(this.Index);return ln.IsIdentifierStart(t)?this.ScanIdentifier():40===t||41===t||59===t?this.ScanPunctuator():39===t||34===t?this.ScanStringLiteral():46==t?ln.IsDecimalDigit(this.Source.charCodeAt(this.Index+1))?this.ScanNumericLiteral():this.ScanPunctuator():ln.IsDecimalDigit(t)?this.ScanNumericLiteral():t>=55296&&t<57343&&ln.IsIdentifierStart(this.CodePointAt(this.Index))?this.ScanIdentifier():this.ScanPunctuator()},this.ScanIdentifier=function(){var t=void 0,e=this.Index,a=92===this.Source.charCodeAt(e)?this.GetComplexIdentifier():this.GetIdentifier();if(t=a.length?3:this.IsKeyword(a)?4:null==a?5:"true"==a||"false"==a?1:3,3!=t&&e+a.length!=this.Index){this.Index;throw this.Index=e,on.InvalidEscapedReservedWord}return"AND"!=a&&"OR"!=a||(t=7),{Type:t,Value:a,LineNumber:this.LineNumber,LineStart:this.LineStart,Start:e,End:this.Index}},this.GetIdentifier=function(){var t=this.Index++;while(!this.IsEOF()){var e=this.Source.charCodeAt(this.Index);if(92==e)return this.Index=t,this.GetComplexIdentifier();if(e>=55296&&e<57343)return this.Index=t,this.GetComplexIdentifier();if(!ln.IsIdentifierPart(e))break;++this.Index}return this.Source.slice(t,this.Index)},this.ScanPunctuator=function(){var t=this.Index,e=this.Source[this.Index];switch(e){case"(":++this.Index;break;case")":case";":case",":++this.Index;break;case".":++this.Index;break;default:e=this.Source.substr(this.Index,3),"AND"==e?this.Index+=3:(e=this.Source.substr(this.Index,2),"&&"===e||"||"===e||"=="===e||"!="===e||"<="===e||">="===e||"=>"===e||":="==e||"OR"==e||"<>"==e?this.Index+=2:(e=this.Source[this.Index],"<>=!+-*%&|^/:".indexOf(e)>=0&&++this.Index))}return this.Index==t&&this.ThrowUnecpectedToken(),{Type:7,Value:e,LineNumber:this.LineNumber,LineStart:this.LineStart,Start:t,End:this.Index}},this.ScanStringLiteral=function(){var t=this.Index,e=this.Source[this.Index];++this.Index;var a="";while(!this.IsEOF()){var i=this.Source[this.Index++];if(i==e){e="";break}if("\\"==i)throw"not complete";if(ln.IsLineTerminator(i.charCodeAt(0)))break;a+=i}return""!=e&&(this.Index=t,this.ThrowUnecpectedToken()),{Type:8,Value:a,LineNumber:this.LineNumber,LineStart:this.LineStart,Start:t,End:this.Index}},this.ScanNumericLiteral=function(){var t=this.Index,e=this.Source[this.Index],a="";if("."!=e){if(a=this.Source[this.Index++],e=this.Source[this.Index],"0"==a&&("x"==e||"X"==e))return++this.Index,this.ScanHexLiteral(t);while(ln.IsDecimalDigit(this.Source.charCodeAt(this.Index)))a+=this.Source[this.Index++];e=this.Source[this.Index]}if("."==e){a+=this.Source[this.Index++];while(ln.IsDecimalDigit(this.Source.charCodeAt(this.Index)))a+=this.Source[this.Index++];e=this.Source[this.Index]}if("e"==e||"E"==e)if(a+=this.Source[this.Index++],e=this.Source[this.Index],"+"!=e&&"-"!=e||(a+=this.Source[this.Index]),ln.IsDecimalDigit(this.Source.charCodeAt(this.Index)))while(ln.IsDecimalDigit(this.Source.charCodeAt(this.Index)))a+=this.Source[this.Index++];else this.ThrowUnecpectedToken();return ln.IsIdentifierStart(this.Source.charCodeAt(this.Index))&&this.ThrowUnecpectedToken(),{Type:6,Value:parseFloat(a),LineNumber:this.LineNumber,LineStart:this.LineStart,Start:t,End:this.Index}},this.ScanComments=function(){var t=void 0;this.Index;while(!this.IsEOF()){var e=this.Source.charCodeAt(this.Index);if(ln.IsWhiteSpace(e))++this.Index;else if(ln.IsLineTerminator(e))++this.Index,13==e&&10==this.Source.charCodeAt(this.Index)&&++this.Index,++this.LineNumber,this.LineStart=this.Index,!0;else if(47==e){if(e=this.Source.charCodeAt(this.Index+1),47!=e)break;this.Index+=2;this.SkipSingleLineComment(2);!0}else{if(123!=e)break;this.Index+=1;this.SkipMultiLineComment()}}return t},this.SkipMultiLineComment=function(){var t=[];while(!this.IsEOF()){var e=this.Source.charCodeAt(this.Index);if(ln.IsLineTerminator(e))++this.LineNumber,++this.Index,this.LineStart=this.Index;else{if(125==e)return this.Index+=1,t;++this.Index}}return t},this.SkipSingleLineComment=function(t){var e=[];while(!this.IsEOF()){var a=this.Source.charCodeAt(this.Index);if(++this.Index,ln.IsLineTerminator(a))return 13===a&&10===this.Source.charCodeAt(this.Index)&&++this.Index,++this.LineNumber,this.LineStart=this.Index,e}return e},this.ThrowUnecpectedToken=function(t,e){return t||(t=on.UnexpectedTokenIllegal),this.ErrorHandler.ThrowError(this.Index,this.LineNumber,this.Index-this.LineStart+1,t,e)}}function cn(t){this.ErrorHandler=new Dn,this.Scanner=new fn(t,this.ErrorHandler),this.Buffer=[],this.GetNextToken=function(){if(0==this.Buffer.length){this.Scanner.ScanComments();if(!this.Scanner.IsEOF()){var t=this.Scanner.Lex(),e={Type:un[t.Type],Value:this.Scanner.Source.slice(t.Start,t.End)};this.Buffer.push(e)}}return this.Buffer.shift()}}un[1]="Boolean",un[2]="<end>",un[3]="Identifier",un[4]="Keyword",un[5]="Null",un[6]="Numeric",un[7]="Punctuator",un[8]="String",un[9]="RegularExpression",un[10]="Template",Cn.GetPeriodInfo=function(t){var e=[{Name:"MIN1",Period:4,Order:1},{Name:"MIN5",Period:5,Order:2},{Name:"MIN15",Period:6,Order:3},{Name:"MIN30",Period:7,Order:4},{Name:"MIN60",Period:8,Order:5},{Name:"DAY",Period:0,Order:1e3},{Name:"MULTIDAY",Period:40002,Order:1002},{Name:"DAY2",Period:40002,Order:1002},{Name:"DAY3",Period:40003,Order:1003},{Name:"DAY4",Period:40004,Order:1004},{Name:"DAY5",Period:40005,Order:1005},{Name:"WEEK",Period:1,Order:1005},{Name:"DAY6",Period:40006,Order:1006},{Name:"DAY7",Period:40007,Order:1007},{Name:"DAY8",Period:40008,Order:1008},{Name:"DAY9",Period:40009,Order:1009},{Name:"DAY10",Period:40009,Order:1010},{Name:"WEEK2",Period:21,Order:1010},{Name:"DAY11",Period:40011,Order:1011},{Name:"DAY12",Period:40012,Order:1012},{Name:"DAY13",Period:40013,Order:1013},{Name:"DAY14",Period:40014,Order:1014},{Name:"MONTH",Period:2,Order:1030},{Name:"SEASON",Period:9,Order:1090},{Name:"HALFYEAR",Period:22,Order:1180},{Name:"YEAR",Period:3,Order:1365}];if(t.Name){for(var a in e)if(t.Name&&e[a].Name==t.Name)return e[a];return null}if(ha.IsNumber(t.PeriodID)){for(var a in e)if(e[a].Period==t.PeriodID)return e[a];return null}return null},Cn.GetConvertValueName=function(t){var e;return"COVER_C"==t?e="CLOSE":"COVER_O"==t?e="OPEN":"COVER_H"==t?e="HIGH":"COVER_L"==t?e="LOW":"COVER_A"==t?e="AMOUNT":"COVER_V"==t&&(e="VOL"),e};var dn={AssignmentExpression:"AssignmentExpression",AssignmentPattern:"AssignmentPattern",ArrayExpression:"ArrayExpression",ArrayPattern:"ArrayPattern",ArrowFunctionExpression:"ArrowFunctionExpression",AwaitExpression:"AwaitExpression",BlockStatement:"BlockStatement",BinaryExpression:"BinaryExpression",BreakStatement:"BreakStatement",CallExpression:"CallExpression",CatchClause:"CatchClause",ClassBody:"ClassBody",ClassDeclaration:"ClassDeclaration",ClassExpression:"ClassExpression",ConditionalExpression:"ConditionalExpression",ContinueStatement:"ContinueStatement",DoWhileStatement:"DoWhileStatement",DebuggerStatement:"DebuggerStatement",EmptyStatement:"EmptyStatement",ExportAllDeclaration:"ExportAllDeclaration",ExportDefaultDeclaration:"ExportDefaultDeclaration",ExportNamedDeclaration:"ExportNamedDeclaration",ExportSpecifier:"ExportSpecifier",ExpressionStatement:"ExpressionStatement",ForStatement:"ForStatement",ForOfStatement:"ForOfStatement",ForInStatement:"ForInStatement",FunctionDeclaration:"FunctionDeclaration",FunctionExpression:"FunctionExpression",Identifier:"Identifier",IfStatement:"IfStatement",ImportDeclaration:"ImportDeclaration",ImportDefaultSpecifier:"ImportDefaultSpecifier",ImportNamespaceSpecifier:"ImportNamespaceSpecifier",ImportSpecifier:"ImportSpecifier",Literal:"Literal",LabeledStatement:"LabeledStatement",LogicalExpression:"LogicalExpression",MemberExpression:"MemberExpression",MetaProperty:"MetaProperty",MethodDefinition:"MethodDefinition",NewExpression:"NewExpression",ObjectExpression:"ObjectExpression",ObjectPattern:"ObjectPattern",Program:"Program",Property:"Property",RestElement:"RestElement",ReturnStatement:"ReturnStatement",SequenceExpression:"SequenceExpression",SpreadElement:"SpreadElement",Super:"Super",SwitchCase:"SwitchCase",SwitchStatement:"SwitchStatement",TaggedTemplateExpression:"TaggedTemplateExpression",TemplateElement:"TemplateElement",TemplateLiteral:"TemplateLiteral",ThisExpression:"ThisExpression",ThrowStatement:"ThrowStatement",TryStatement:"TryStatement",UnaryExpression:"UnaryExpression",UpdateExpression:"UpdateExpression",VariableDeclaration:"VariableDeclaration",VariableDeclarator:"VariableDeclarator",WhileStatement:"WhileStatement",WithStatement:"WithStatement",YieldExpression:"YieldExpression"};function mn(t){this.IsNeedIndexData=!1,this.IsNeedLatestIndexData=!1,this.IsNeedSymbolData=!1,this.IsNeedMarginData=new I.default,this.IsNeedNewsAnalysisData=new I.default,this.NeedBlockIncreaseData=[],this.IsNeedSymbolExData=new I.default,this.NeedHK2SHSZData=[],this.IsNeedSectionFinance=new E.default,this.FunctionData=[],this.Dynainfo=[],this.IsAPIData=[],this.ExecuteIndex=[],this.OtherSymbolData=[],this.PeriodSymbolData=[],this.ErrorHandler=t,this.GetDataJobList=function(){var t=[];this.IsNeedSymbolData&&t.push({ID:xn.JOB_DOWNLOAD_SYMBOL_DATA}),this.IsNeedIndexData&&t.push({ID:xn.JOB_DOWNLOAD_INDEX_DATA}),this.IsNeedLatestIndexData&&t.push({ID:xn.JOB_DOWNLOAD_LATEST_INDEX_DATA});for(var e=0;e<this.Dynainfo.length;++e){var a=this.Dynainfo[e];t.push(a)}for(var e in this.NeedBlockIncreaseData)t.push(this.NeedBlockIncreaseData[e]);var i=!0,r=!1,n=void 0;try{for(var s,o=(0,T.default)(this.IsNeedMarginData);!(i=(s=o.next()).done);i=!0){var h=s.value;t.push({ID:h})}}catch(y){r=!0,n=y}finally{try{!i&&o.return&&o.return()}finally{if(r)throw n}}for(var e in this.NeedHK2SHSZData)t.push(this.NeedHK2SHSZData[e]);var l=!0,u=!1,C=void 0;try{for(var D,f=(0,T.default)(this.IsNeedNewsAnalysisData);!(l=(D=f.next()).done);l=!0){h=D.value;t.push({ID:h})}}catch(y){u=!0,C=y}finally{try{!l&&f.return&&f.return()}finally{if(u)throw C}}var c=!0,d=!1,m=void 0;try{for(var v,S=(0,T.default)(this.IsNeedSymbolExData);!(c=(v=S.next()).done);c=!0){h=v.value;t.push({ID:h})}}catch(y){d=!0,m=y}finally{try{!c&&S.return&&S.return()}finally{if(d)throw m}}var I=!0,p=!1,g=void 0;try{for(var x,F=(0,T.default)(this.IsNeedSectionFinance);!(I=(x=F.next()).done);I=!0){a=x.value;t.push({ID:xn.JOB_DOWNLOAD_SECTION_SF,SF:a})}}catch(y){p=!0,g=y}finally{try{!I&&F.return&&F.return()}finally{if(p)throw g}}for(var e in this.IsAPIData){a=this.IsAPIData[e];t.push(a)}for(var e in this.ExecuteIndex){a=this.ExecuteIndex[e];t.push(a)}for(var e in this.OtherSymbolData){a=this.OtherSymbolData[e];t.push(a)}for(var e in this.PeriodSymbolData){a=this.PeriodSymbolData[e];t.push(a)}for(var e in this.FunctionData){a=this.FunctionData[e];t.push(a)}return t},this.VerifySymbolVariable=function(t,e){var a=new I.default(["INDEXA","INDEXC","INDEXH","INDEXL","INDEXO","INDEXV","INDEXDEC","INDEXADV"]);if(a.has(t))this.IsNeedIndexData=!0;else{var i=new I.default(["CLOSE","C","VOL","V","OPEN","O","HIGH","H","LOW","L","AMOUNT","AMO","VOLINSTK"]);if(i.has(t))this.IsNeedSymbolData=!0;else{"VOLR"===t&&(this.IsNeedSymbolExData.has(xn.JOB_DOWNLOAD_VOLR_DATA)||this.IsNeedSymbolExData.add(xn.JOB_DOWNLOAD_VOLR_DATA));var r=new I.default(["CAPITAL","TOTALCAPITAL","EXCHANGE","HYBLOCK","DYBLOCK","GNBLOCK","FGBLOCK","ZSBLOCK","ZHBLOCK","ZDBLOCK","HYZSCODE","GNBLOCKNUM","FGBLOCKNUM","ZSBLOCKNUM","ZHBLOCKNUM","ZDBLOCKNUM","HYSYL","HYSJL"]);if(r.has(t)){var n={ID:xn.JOB_DOWNLOAD_VARIANT,VariantName:t};return e&&(n.Token={Index:e.Start,Line:e.LineNumber}),void this.FunctionData.push(n)}if("FROMOPEN"!=t){if("ADVANCE"==t||"DECLINE"==t){n={ID:xn.JOB_DOWNLOAD_INDEX_INCREASE_DATA,IsSelfSymbol:!0,FunctionName:t};return e&&(n.Token={Index:e.Start,Line:e.LineNumber}),void this.NeedBlockIncreaseData.push(n)}if(t.indexOf("#")>0){var s=t.split("#");if(2!=s.length){var o=t+", è·¨å¨æè¯­æ³éè¯¯, åéå#å¨æ";this.ThrowUnexpectedToken(e,o)}else{var h=["C","CLOSE","O","OPEN","H","HIGH","L","LOW","AMOUNT","AMO","VOL","V","VOLINSTK"];if(h.indexOf(s[0])<0){o=t+", è·¨å¨æè¯­æ³éè¯¯, æ°æ®åªæ¯æ'OPEN,HIGH,LOW,CLOSE,VOL,AMOUNT,VOLINSTK'";this.ThrowUnexpectedToken(e,o)}var l=["MIN1","MIN5","MIN15","MIN30","MIN60","DAY","WEEK","MONTH","SEASON","YEAR","HALFYEAR","WEEK2","MULTIDAY","DAY2","DAY3","DAY4","DAY5","DAY6","DAY7","DAY8","DAY9","DAY10","DAY11","DAY12","DAY13","DAY14","DAY15"];if(l.indexOf(s[1])<0){o=t+", è·¨å¨æè¯­æ³éè¯¯ï¼ å¨æåªæ¯æ'MIN1,MIN5,MIN15,MIN30,MIN60,DAY,WEEK,MONTH,SEASON,YEAR'";this.ThrowUnexpectedToken(e,o)}n={ID:xn.JOB_DOWNLOAD_SYMBOL_PERIOD_DATA,VarName:t,ValueName:s[0],PeriodName:s[1]};e&&(n.Token={Index:e.Start,Line:e.LineNumber}),this.PeriodSymbolData.push(n)}}else if(sn.IsCustomVariant(t)){n={VariantName:t,ID:xn.JOB_CUSTOM_VARIANT_DATA};return e&&(n.Token={Index:e.Start,Line:e.LineNumber}),void this.FunctionData.push(n)}}else this.IsNeedLatestIndexData=!0}}},this.VerifySymbolLiteral=function(t,e){if(ha.IsString(t)&&t.indexOf("$")>0){var a=t.split("$");if(2!=a.length)return;var i={Literal:t,ID:xn.JOB_DOWNLOAD_OTHER_SYMBOL_DATA};e&&(i.Token={Index:e.Start,Line:e.LineNumber}),this.OtherSymbolData.push(i)}},this.VerifySymbolFunction=function(t,e,a){if(sn.IsCustomFunction(t.Name)){var i={FunctionName:t.Name,ID:xn.JOB_CUSTOM_FUNCTION_DATA,Args:e};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if("DYNAINFO"!=t.Name){if("FINANCE"==t.Name){i={ID:xn.JOB_DOWNLOAD_FINANCE,Args:e,FunctionName:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if("FINVALUE"==t.Name){i={ID:xn.JOB_DOWNLOAD_FINVALUE,Args:e,FunctionName:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if("FINONE"==t.Name){i={ID:xn.JOB_DOWNLOAD_FINONE,Args:e,FunctionName:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if("GPJYVALUE"==t.Name){i={ID:xn.JOB_DOWNLOAD_GPJYVALUE,Args:e,FunctionName:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if("SCJYVALUE"==t.Name){i={ID:xn.JOB_DOWNLOAD_SCJYVALUE,Args:e,FunctionName:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if("MARGIN"!==t.Name)if("NEWS"!==t.Name){if("HK2SHSZ"===t.Name){i={ID:xn.JOB_DOWNLOAD_HK_TO_SHSZ,Args:e,FunctionName:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.NeedHK2SHSZData.push(i)}if("COST"==t.Name||"WINNER"==t.Name||"PPART"==t.Name||"COSTEX"==t.Name||"LWINNER"==t.Name||"PWINNER"==t.Name){i={ID:xn.JOB_DOWNLOAD_FINANCE,Args:[7],FunctionName:"FINANCE",FunctionName2:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if("INBLOCK"==t.Name){i={ID:xn.JOB_DOWNLOAD_VARIANT,VariantName:"INBLOCK"};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.FunctionData.push(i)}if("BETA"!==t.Name){if("UPCOUNT"==t.Name||"DOWNCOUNT"==t.Name){i={ID:xn.JOB_DOWNLOAD_INDEX_INCREASE_DATA,Args:e,FunctionName:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.NeedBlockIncreaseData.push(i)}if("STKINDI"==t.Name){i={ID:xn.JOB_EXECUTE_INDEX,Args:e,FunctionName:t.Name};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.ExecuteIndex.push(i)}if("COVER_C"==t.Name||"COVER_O"==t.Name||"COVER_H"==t.Name||"COVER_L"==t.Name||"COVER_A"==t.Name||"COVER_V"==t.Name){var r=e[0].Value,n=["MIN1","MIN5","MIN15","MIN30","MIN60","DAY","WEEK","MONTH","SEASON","YEAR"];if(n.indexOf(r)<0){var s=t.Name+", è·¨å¨æå½æ°éè¯¯ï¼ å¨æåªæ¯æ'MIN1,MIN5,MIN15,MIN30,MIN60,DAY,WEEK,MONTH,SEASON,YEAR'";this.ThrowUnexpectedToken(a,s)}var o=Cn.GetConvertValueName(t.Name);i={ID:xn.JOB_DOWNLOAD_SYMBOL_PERIOD_DATA,FunctionName:t.Name,ValueName:o,PeriodName:r};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.PeriodSymbolData.push(i)}if("SF"!=t.Name){if("LOADAPIDATA"==t.Name){i={Name:t.Name,ID:xn.JOB_DOWNLOAD_CUSTOM_API_DATA,Args:e};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.IsAPIData.push(i)}var h=new I.default(["CLOSE","C","VOL","V","OPEN","O","HIGH","H","LOW","L","AMOUNT","AMO","VOLINSTK"]);if(h.has(t.Name)){i={Name:t.Name,ID:xn.JOB_DOWNLOAD_OTHER_SYMBOL_DATA,Args:e};return a&&(i.Token={Index:a.Start,Line:a.LineNumber}),void this.OtherSymbolData.push(i)}}else{var l=xn.GetSectionReportPeriod(e[0].Value,e[1].Value);if(!l)return;var u=xn.GetSectionFinanceID(e[2].Value);if(!u)return;var C=l.Year+"-"+l.Quarter;if(this.IsNeedSectionFinance.has(C)){D=this.IsNeedSectionFinance.get(C);D.Fields.has(u)||D.Fields.add(u)}else{var D={Period:l,Fields:new I.default([u])};this.IsNeedSectionFinance.set(C,D)}}}else this.IsNeedIndexData=!0}else{var f=xn.GetNewsAnalysisID(e[0].Value);f&&!this.IsNeedNewsAnalysisData.has(f)&&this.IsNeedNewsAnalysisData.add(f)}else{var c=xn.GetMarginJobID(e[0].Value);c&&!this.IsNeedMarginData.has(c)&&this.IsNeedMarginData.add(c)}}else{var i={ID:xn.JOB_DOWNLOAD_SYMBOL_LATEST_DATA,Args:e,FunctionName:t.Name};this.Dynainfo.push(i)}},this.VerifyMemberVariable=function(t,e,a){var i={ID:xn.JOB_EXECUTE_INDEX,Member:{Object:t,Property:e}};a&&(i.Token={Index:a.Start,Line:a.LineNumber}),this.ExecuteIndex.push(i)},this.ExpressionStatement=function(t){return{Type:dn.ExpressionStatement,Expression:t}},this.Script=function(t){return{Type:dn.Program,Body:t,SourceType:"éè¾¾ä¿¡èæ¬"}},this.SequenceExpression=function(t){return{Type:dn.SequenceExpression,Expression:t}},this.BinaryExpression=function(t,e,a){var i="||"===t||"&&"===t||"AND"==t||"OR"==t,r=i?dn.LogicalExpression:dn.BinaryExpression;return{Type:r,Operator:t,Left:e,Right:a}},this.Literal=function(t,e,a){return this.VerifySymbolLiteral(t,a),{Type:dn.Literal,Value:t,Raw:e}},this.Identifier=function(t,e){return this.VerifySymbolVariable(t,e),{Type:dn.Identifier,Name:t}},this.MemberIdentifier=function(t,e){return{Type:dn.Identifier,Name:t}},this.AssignmentExpression=function(t,e,a){return{Type:dn.AssignmentExpression,Operator:t,Left:e,Right:a}},this.UnaryExpression=function(t,e){return{Type:dn.UnaryExpression,Operator:t,Argument:e,Prefix:!0}},this.EmptyStatement=function(){return{Type:dn.EmptyStatement}},this.CallExpression=function(t,e,a){return this.VerifySymbolFunction(t,e,a),{Type:dn.CallExpression,Callee:t,Arguments:e}},this.StaticMemberExpression=function(t,e,a){return this.VerifyMemberVariable(t,e,a),{Type:dn.MemberExpression,Computed:!1,Object:t,Property:e}},this.Directive=function(t,e){return{Type:dn.ExpressionStatement,Expression:t,Directive:e}},this.ThrowUnexpectedToken=function(t,e){throw this.UnexpectedTokenError(t,e)},this.UnexpectedTokenError=function(t,e){var a=e||on.UnexpectedToken,i="ILLEGAL";if(t&&(i=t.Value),a=a.replace("%0",i),t&&"number"==typeof t.LineNumber){var r=t.Start,n=t.LineNumber,s=-1;return this.ErrorHandler.CreateError(r,n,s,a)}}}function vn(t){this.ErrorHandler=new Dn,this.Scanner=new fn(t,this.ErrorHandler),this.Node=new mn(this.ErrorHandler),this.LookAhead={Type:2,Value:"",LineNumber:this.Scanner.LineNumber,LineStart:0,Start:0,End:0},this.HasLineTerminator=!1,this.Context={IsModule:!1,await:!1,allowIn:!0,allowStrictDirective:!0,allowYield:!0,FirstCoverInitializedNameError:null,IsAssignmentTarget:!1,IsBindingElement:!1,InFunctionBody:!1,inIteration:!1,inSwitch:!1,labelSet:{},Strict:!1},this.PeratorPrecedence={")":0,";":0,",":0,"]":0,"||":1,OR:1,"&&":2,AND:2,"|":3,"^":4,"&":5,"==":6,"=":6,"!=":6,"<>":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":11,"/":11,"%":11},this.StartMarker={Index:0,Line:this.Scanner.LineNumber,Column:0},this.LastMarker={Index:0,Line:this.Scanner.LineNumber,Column:0},this.Initialize=function(){this.NextToken(),this.LastMarker={Index:this.Scanner.Index,Line:this.Scanner.LineNumber,Column:this.Scanner.Index-this.Scanner.LineStart}},this.CreateNode=function(){return{Index:this.StartMarker.Index,Line:this.StartMarker.Line,Column:this.StartMarker.Column}},this.StartNode=function(t,e){void 0==e&&(e=0);var a=t.Start-t.LineStart,i=t.LineNumber;return a<0&&(a+=e,i--),{Index:t.Start,Line:i,Column:a}},this.Match=function(t){return 7==this.LookAhead.Type&&this.LookAhead.Value==t},this.Expect=function(t){var e=this.NextToken();7==e.Type&&e.Value==t||this.ThrowUnexpectedToken(e)},this.MatchAssign=function(){if(7!=this.LookAhead.Type)return!1;var t=this.LookAhead.Value;return":"==t||":="==t},this.GetTokenRaw=function(t){return this.Scanner.Source.slice(t.Start,t.End)},this.NextToken=function(){var t=this.LookAhead;this.LastMarker.Index=this.Scanner.Index,this.LastMarker.Line=this.Scanner.LineNumber,this.LastMarker.Column=this.Scanner.Index-this.Scanner.LineStart,this.CollectComments(),this.Scanner.Index!==this.StartMarker.Index&&(this.StartMarker.Index=this.Scanner.Index,this.StartMarker.Line=this.Scanner.LineNumber,this.StartMarker.Column=this.Scanner.Index-this.Scanner.LineStart);var e=this.Scanner.Lex();return this.HasLineTerminator=t.LineNumber!=e.LineNumber,e&&this.Context.Strict&&e.Type,this.LookAhead=e,t},this.CollectComments=function(){this.Scanner.ScanComments()},this.ParseScript=function(){var t=this.CreateNode(),e=this.ParseDirectivePrologues();while(2!=this.LookAhead.Type)e.push(this.ParseStatementListItem());return this.Finalize(t,this.Node.Script(e))},this.ParseDirective=function(){var t=this.LookAhead,e=this.CreateNode(),a=this.ParseExpression(),i=a.Type===dn.Literal?this.GetTokenRaw(t).slice(1,-1):null;return this.ConsumeSemicolon(),this.Finalize(e,i?this.Node.Directive(a,i):this.Node.ExpressionStatement(a))},this.ParseDirectivePrologues=function(){var t=[];while(1){var e=this.LookAhead;if(8!=e.Type)break;var a=this.ParseDirective();t.push(a)}return t},this.ParseStatementListItem=function(){var t=void 0;return this.Context.IsAssignmentTarget=!0,this.Context.IsBindingElement=!0,4==this.LookAhead.Type||(t=this.ParseStatement()),t},this.ParseStatement=function(){var t=void 0;switch(this.LookAhead.Type){case 1:case 5:case 6:case 8:case 10:case 9:t=this.ParseExpressionStatement();break;case 7:var e=this.LookAhead.Value;t="("===e?this.ParseExpressionStatement():";"===e?this.ParseEmptyStatement():this.ParseExpressionStatement();break;case 3:t=this.ParseLabelledStatement();break;case 4:break;default:t="error"}return t},this.ParseEmptyStatement=function(){var t=this.CreateNode();return this.Expect(";"),this.Finalize(t,this.Node.EmptyStatement())},this.ParseLabelledStatement=function(){var t=this.CreateNode(),e=this.ParseExpression();this.ConsumeSemicolon();var a=new this.Node.ExpressionStatement(e);return this.Finalize(t,a)},this.ParseExpression=function(){var t=this.LookAhead,e=this.IsolateCoverGrammar(this.ParseAssignmentExpression);if(this.Match(",")){var a=[];a.push(e);while(2!=this.LookAhead.Type){if(!this.Match(","))break;this.NextToken(),a.push(this.IsolateCoverGrammar(this.ParseAssignmentExpression))}e=this.Finalize(this.StartNode(t),this.Node.SequenceExpression(a))}return e},this.ParseAssignmentExpression=function(){var t=void 0,e=this.LookAhead,a=e;if(t=this.ParseConditionalExpression(),this.MatchAssign()){if(!this.Context.IsAssignmentTarget){var i=t.Marker;this.ThrowUnexpectedError(i.Index,i.Line,i.Column,on.InvalidLHSInAssignment)}this.Match("=")||this.Match(":")?this.ReinterpretExpressionAsPattern(t):(this.Context.IsAssignmentTarget=!1,this.Context.IsBindingElement=!1),a=this.NextToken();var r=a.Value,n=this.IsolateCoverGrammar(this.ParseAssignmentExpression);t=this.Finalize(this.StartNode(e),this.Node.AssignmentExpression(r,t,n)),this.Context.FirstCoverInitializedNameError=null}return t},this.ParseConditionalExpression=function(){this.LookAhead;var t=this.InheritCoverGrammar(this.ParseBinaryExpression);return t},this.ParseBinaryExpression=function(){var t=this.LookAhead,e=this.InheritCoverGrammar(this.ParseExponentiationExpression),a=this.LookAhead,i=this.BinaryPrecedence(a);if(i>0){this.NextToken(),this.Context.IsAssignmentTarget=!1,this.Context.IsBindingElement=!1;var r=[t,this.LookAhead],n=e,s=this.IsolateCoverGrammar(this.ParseExponentiationExpression),o=[n,a.Value,s],h=[i];while(1){if(i=this.BinaryPrecedence(this.LookAhead),i<=0)break;while(o.length>2&&i<=h[h.length-1]){s=o.pop();var l=o.pop();h.pop(),n=o.pop(),r.pop();var u=this.StartNode(r[r.length-1]);o.push(this.Finalize(u,this.Node.BinaryExpression(l,n,s)))}o.push(this.NextToken().Value),h.push(i),r.push(this.LookAhead),o.push(this.IsolateCoverGrammar(this.ParseExponentiationExpression))}var C=o.length-1;e=o[C];var D=r.pop();while(C>1){var f=r.pop(),c=D&&D.LineStart,d=this.StartNode(f,c),m=o[C-1];e=this.Finalize(d,this.Node.BinaryExpression(m,o[C-2],e)),C-=2,D=f}}return e},this.ParseExponentiationExpression=function(){this.LookAhead;var t=this.InheritCoverGrammar(this.ParseUnaryExpression);return t},this.ParseUnaryExpression=function(){var t=void 0;if(this.Match("+")||this.Match("-")){var e=this.StartNode(this.LookAhead),a=this.NextToken();t=this.InheritCoverGrammar(this.ParseUnaryExpression),t=this.Finalize(e,this.Node.UnaryExpression(a.Value,t)),this.Context.IsAssignmentTarget=!1,this.Context.IsBindingElement=!1}else t=this.ParseUpdateExpression();return t},this.ParseUpdateExpression=function(){var t=void 0;this.LookAhead;return t=this.InheritCoverGrammar(this.ParseLeftHandSideExpressionAllowCall),t},this.ParseLeftHandSideExpressionAllowCall=function(){var t=this.LookAhead,e=void 0;e=this.InheritCoverGrammar(this.ParsePrimaryExpression);while(1)if(this.Match(".")){this.Context.IsBindingElement=!1,this.Context.IsAssignmentTarget=!0,this.Expect(".");var a=this.ParseMemberIdentifierName();e=this.Finalize(this.StartNode(t),this.Node.StaticMemberExpression(e,a,t))}else{if(!this.Match("("))break;this.Context.IsBindingElement=!1,this.Context.IsAssignmentTarget=!1;var i=this.ParseArguments();e=this.Finalize(this.StartNode(t),this.Node.CallExpression(e,i,t))}return e},this.IsIdentifierName=function(t){return 3===t.Type||4===t.Type||1===t.Type||5===t.Type},this.ParseIdentifierName=function(){var t=this.CreateNode(),e=this.NextToken();return this.IsIdentifierName(e)||this.ThrowUnexpectedToken(e),this.Finalize(t,this.Node.Identifier(e.Value,e))},this.ParseMemberIdentifierName=function(){var t=this.CreateNode(),e=this.NextToken();return this.IsIdentifierName(e)||this.ThrowUnexpectedToken(e),this.Finalize(t,this.Node.MemberIdentifier(e.Value,e))},this.ParseArguments=function(){this.Expect("(");var t=[];if(!this.Match(")"))while(1){var e=this.IsolateCoverGrammar(this.ParseAssignmentExpression);if(t.push(e),this.Match(")"))break;if(this.ExpectCommaSeparator(),this.Match(")"))break}return this.Expect(")"),t},this.ExpectCommaSeparator=function(){this.Expect(",")},this.ParsePrimaryExpression=function(){var t,e,a=this.CreateNode(),i=void 0;switch(this.LookAhead.Type){case 3:t=this.NextToken(),i=this.Finalize(a,this.Node.Identifier(t.Value,t));break;case 6:case 8:this.Context.IsAssignmentTarget=!1,this.Context.IsBindingElement=!1,t=this.NextToken(),e=this.GetTokenRaw(t),i=this.Finalize(a,this.Node.Literal(t.Value,e,t));break;case 7:switch(this.LookAhead.Value){case"(":this.Context.IsBindingElement=!1,i=this.InheritCoverGrammar(this.ParseGroupExpression);break;default:i=this.ThrowUnexpectedToken(this.NextToken())}break;default:i=this.ThrowUnexpectedToken(this.NextToken())}return i},this.ParseGroupExpression=function(){var t=void 0;if(this.Expect("("),this.Match(")"))this.NextToken();else{this.LookAhead;var e=!1;if(this.Context.IsBindingElement=!0,t=this.InheritCoverGrammar(this.ParseAssignmentExpression),this.Match(",")){var a=[];this.Context.IsAssignmentTarget=!1,a.push(t);while(2!=this.LookAhead.Type){if(!this.Match(","))break;this.NextToken(),this.Match(")")}}e||(this.Expect(")"),this.Context.IsBindingElement=!1)}return t},this.ParseExpressionStatement=function(){var t=this.CreateNode(),e=this.ParseExpression();return this.ConsumeSemicolon(),this.Finalize(t,this.Node.ExpressionStatement(e))},this.ConsumeSemicolon=function(){this.Match(";")?this.NextToken():this.HasLineTerminator||(this.LastMarker.Index=this.StartMarker.Index,this.LastMarker.Line=this.StartMarker.Line,this.LastMarker.Column=this.StartMarker.Column)},this.ReinterpretExpressionAsPattern=function(t){switch(t.Type){case dn.Identifier:case dn.MemberExpression:case dn.AssignmentExpression:break;default:break}},this.Finalize=function(t,e){return e.Marker={Line:t.Line,Column:t.Column,Index:t.Index},e},this.BinaryPrecedence=function(t){var e=t.Value,a=void 0;return a=7===t.Type&&this.PeratorPrecedence[e]||0,a},this.IsolateCoverGrammar=function(t){var e=this.Context.IsBindingElement,a=this.Context.IsAssignmentTarget,i=this.Context.FirstCoverInitializedNameError;this.Context.IsBindingElement=!0,this.Context.IsAssignmentTarget=!0,this.Context.FirstCoverInitializedNameError=null;var r=t.call(this);return this.Context.FirstCoverInitializedNameError,this.Context.IsBindingElement=e,this.Context.IsAssignmentTarget=a,this.Context.FirstCoverInitializedNameError=i,r},this.InheritCoverGrammar=function(t){var e=this.Context.IsBindingElement,a=this.Context.IsAssignmentTarget,i=this.Context.FirstCoverInitializedNameError;this.Context.IsBindingElement=!0,this.Context.IsAssignmentTarget=!0,this.Context.FirstCoverInitializedNameError=null;var r=t.call(this);return this.Context.IsBindingElement=this.Context.IsBindingElement&&e,this.Context.IsAssignmentTarget=this.Context.IsAssignmentTarget&&a,this.Context.FirstCoverInitializedNameError=i||this.Context.FirstCoverInitializedNameError,r},this.ThrowUnexpectedToken=function(t,e){throw this.UnexpectedTokenError(t,e)},this.ThrowUnexpectedError=function(t,e,a,i){var r=i||"æ§è¡å¼å¸¸";return this.ErrorHandler.ThrowError(t,e,a,r)},this.UnexpectedTokenError=function(t,e){var a=e||on.UnexpectedToken,i="ILLEGAL";if(t&&(i=t.Value),a=a.replace("%0",i),t&&"number"==typeof t.LineNumber){var r=t.Start,n=t.LineNumber,s=this.LastMarker.Index-this.LastMarker.Column,o=t.Start-s+1;return this.ErrorHandler.CreateError(r,n,o,a)}var h=this.LastMarker.Index,l=this.LastMarker.Line,u=this.LastMarker.Column+1;return this.ErrorHandler.CreateError(h,l,u,a)}}function Sn(t,e){this.ErrorHandler=t,this.SymbolData=e,this.Add=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t+e;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&this.IsNumber(t[s])&&this.IsNumber(e[s])&&(r[s]=t[s]+e[s]);return r}var o=void 0,h=void 0;for(var l in a?(o=t,h=e):(o=e,h=t),h)r[l]=null,this.IsNumber(h[l])&&this.IsNumber(o)&&(r[l]=o+h[l]);return r},this.Subtract=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t-e;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&this.IsNumber(t[s])&&this.IsNumber(e[s])&&(r[s]=t[s]-e[s]);return r}if(a)for(var o in e)r[o]=null,this.IsNumber(t)&&this.IsNumber(e[o])&&(r[o]=t-e[o]);else for(var h in t)r[h]=null,this.IsNumber(t[h])&&this.IsNumber(e)&&(r[h]=t[h]-e);return r},this.Multiply=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t*e;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&this.IsNumber(t[s])&&this.IsNumber(e[s])&&(r[s]=t[s]*e[s]);return r}var o=void 0,h=void 0;for(var l in a?(o=t,h=e):(o=e,h=t),h)r[l]=null,this.IsNumber(h[l])&&this.IsNumber(o)&&(r[l]=o*h[l]);return r},this.Divide=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return 0==e?null:t/e;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&this.IsNumber(t[s])&&this.IsDivideNumber(e[s])&&(r[s]=t[s]/e[s]);return r}if(a)for(var o in e)r[o]=null,this.IsNumber(t)&&this.IsDivideNumber(e[o])&&(r[o]=t/e[o]);else for(var h in t)r[h]=null,this.IsNumber(t[h])&&this.IsDivideNumber(e)&&(r[h]=t[h]/e);return r},this.GT=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t>e?1:0;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=t[s]>e[s]?1:0));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=t>e[o]?1:0);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]>e?1:0);return r},this.GTE=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t>=e?1:0;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=t[s]>=e[s]?1:0));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=t>=e[o]?1:0);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]>=e?1:0);return r},this.LT=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t<e?1:0;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=t[s]<e[s]?1:0));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=t<e[o]?1:0);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]<e?1:0);return r},this.LTE=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t>=e?1:0;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=t[s]<=e[s]?1:0));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=t<=e[o]?1:0);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]<=e?1:0);return r},this.EQ=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t==e?1:0;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=t[s]==e[s]?1:0));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=t==e[o]?1:0);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]==e?1:0);return r},this.NEQ=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t!=e?1:0;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=t[s]!=e[s]?1:0));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=t!=e[o]?1:0);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]!=e?1:0);return r},this.And=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t&&e?1:0;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=t[s]&&e[s]?1:0));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=t&&e[o]?1:0);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]&&e?1:0);return r},this.Or=function(t,e){var a="number"==typeof t,i="number"==typeof e;if(a&&i)return t||e?1:0;var r=[];if(!a&&!i){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)r[s]=null,s<t.length&&s<e.length&&(isNaN(t[s])||isNaN(e[s])||(r[s]=t[s]||e[s]?1:0));return r}if(a)for(var o in e)r[o]=null,isNaN(t)||isNaN(e[o])||(r[o]=t||e[o]?1:0);else for(var h in t)r[h]=null,isNaN(t[h])||isNaN(e)||(r[h]=t[h]||e?1:0);return r},this.IF=function(t,e,a){var i=this.IsNumber(t),r=this.IsNumber(e),n=this.IsNumber(a),s=Array.isArray(e),o=Array.isArray(a);if(i)return t?e:a;var h=[];for(var l in t)t[l]?h[l]=r?e:s?e[l]:null:h[l]=n?a:o?a[l]:null;return h},this.IFN=function(t,e,a){return this.IF(t,a,e)},this.REF=function(t,e){var a=[];if("number"==typeof e){if(t.length<=0)return a;if(e>=t.length)return a;a=t.slice(0,t.length-e);for(var i=t[0],r=0;r<e;++r)a.unshift(i)}else for(var n=0;n<t.length;++n)if(a[n]=null,!(n>=e.length)){var s=e[n];a[n]=s>=0&&s<=n?t[n-s]:n?a[n-1]:t[n]}return a},this.REFV=function(t,e){var a=[];if("number"==typeof e){if(t.length<=0)return a;if(e>=t.length)return a;a=t.slice(0,t.length-e);for(var i=0;i<e;++i)a.unshift(null)}else for(var r=0;r<t.length;++r)if(a[r]=null,!(r>=e.length)){var n=e[r];n>=0&&n<=r&&(a[r]=t[r-n])}return a},this.REFX=function(t,e){var a=[];if("number"==typeof e){if(t.length<=0)return a;if(e>=t.length)return t.length>0?t[t.length-1]:a;a=t.slice(e,t.length);for(var i=t[t.length-1],r=0;r<e;++r)a.push(i)}else for(var n=t.length,s=0;s<t.length;++s)if(a[s]=null,!(s>=e.length)){var o=e[s];a[s]=o>=0&&o+s<n?t[s+o]:s?a[s-1]:t[s]}return a},this.REFXV=function(t,e){var a=[];if("number"==typeof e){if(t.length<=0)return a;if(e>=t.length)return a;a=t.slice(e,t.length);for(var i=0;i<e;++i)a.push(null)}else for(var r=t.length,n=0;n<t.length;++n)if(a[n]=null,!(n>=e.length)){var s=e[n];s>=0&&s+n<r&&(a[n]=t[n+s])}return a},this.MAX=function(t,e){if(0==t.length&&this.ThrowUnexpectedNode(e,"MAX() Error: åæ°ä¸ªæ°ä¸è½ä¸º0"),1==t.length)return t[0];var a=[],i=[];for(var r in t){var n=t[r];ha.IsNumber(n)?i.push(n):Array.isArray(n)&&a.push(n)}var s=null;if(i.length>0){s=i[0];for(r=1;r<i.length;++r)s=Math.max(s,i[r])}var o=null;if(a.length>0){o=a[0].slice(0);for(r=1;r<a.length;++r){var h=a[r];for(var l in h){var u=o[l];n=h[l];ha.IsNumber(u)&&(ha.IsNumber(n)?o[l]=Math.max(u,n):o[l]=null)}}}if(null==o&&null!=s)return s;if(o&&null==s)return o;for(var r in o)ha.IsNumber(o[r])&&(o[r]=Math.max(o[r],s));return o},this.MIN=function(t,e){if(0==t.length&&this.ThrowUnexpectedNode(e,"MIN() Error: åæ°ä¸ªæ°ä¸è½ä¸º0"),1==t.length)return t[0];var a=[],i=[];for(var r in t){var n=t[r];ha.IsNumber(n)?i.push(n):Array.isArray(n)&&a.push(n)}var s=null;if(i.length>0){s=i[0];for(r=1;r<i.length;++r)s=Math.min(s,i[r])}var o=null;if(a.length>0){o=a[0].slice(0);for(r=1;r<a.length;++r){var h=a[r];for(var l in h){var u=o[l];n=h[l];ha.IsNumber(u)&&(ha.IsNumber(n)?o[l]=Math.min(u,n):o[l]=null)}}}if(null==o&&null!=s)return s;if(o&&null==s)return o;for(var r in o)ha.IsNumber(o[r])&&(o[r]=Math.min(o[r],s));return o},this.ABS=function(t){var e=[];for(var a in t)e[a]=null,isNaN(t[a])||(e[a]=Math.abs(t[a]));return e},this.MA=function(t,e){var a=[];if(e<=0)return a;if(Array.isArray(e)){for(h=0;h<t.length;++h)if(a[h]=null,!(h>=e.length)){var i=e[h];if(this.IsNumber(i)&&!(i<=0)){for(var r=0,n=0,s=h,o=0;s>=0&&o<i;--s,++o)r+=t[s],++n;n>0&&(a[h]=r/n)}}}else{if(e<=0&&(e=1),!t||!t.length)return a;for(var h=0;h<t.length;++h)if(a[h]=null,this.IsNumber(t[h]))break;t=t.slice(0);for(var l=0;h<t.length;++h,++l)if(l<e-1)a[h]=null;else{for(var u=t[h-(e-1)],C=0,D=e-1;D>=0;--D){var f=t[h-D];this.IsNumber(f)?u=f:(f=u,t[h-D]=f),C+=f}a[h]=C/e}}return a},this.EMA=function(t,e){var a=[];if(t.length<=0)return a;if(Array.isArray(e))for(var i=0;i<e.length;++i){var r=e[i];if(this.IsNumber(r)&&(r=parseInt(r),!(r<=0))){r>i+1&&(r=i+1);for(var n=[2/(r+1),(r-1)/(r+1)],s=null,o=null,h=0;h<r;++h){var l=i-(r-h-1),u=t[l];this.IsNumber(u)||coninue,null==o?(s=u,o=s):(s=n[0]*u+n[1]*o,o=s)}a[i]=s}}else{if(e<=0)return a;for(var C=0;C<t.length;++C)if(null!=t[C]&&!isNaN(t[C]))break;var D=C,f=C+1;a[D]=t[D];for(i=C+1;i<t.length;++i,++D,++f)a[f]=(2*t[f]+(e-1)*a[D])/(e+1)}return a},this.XMA=function(t,e){for(var a=[],i=0;i<t.length;++i)if(this.IsNumber(t[i]))break;for(var r=parseInt((e-2)/2),n=0,s=0,o=0,h=0,l=i,u=0;l<t.length;++l){for(o=l-r-1,h=l+(e-r)-1,u=o;u<h;++u)u>=0&&u<t.length&&this.IsNumber(t[u])&&(n+=t[u],++s);a[l]=0!=s?n/s:null,n=0,s=0}return a},this.SMA=function(t,e,a){var i=[];if(Array.isArray(e))for(var r=0;r<e.length;++r){var n=e[r];if(this.IsNumber(n)&&(n=parseInt(n),!(n<=0))){n>r+1&&(n=r+1);for(var s=null,o=null,h=0;h<n;++h){var l=r-(n-h-1),u=t[l];this.IsNumber(u)&&(null==s?(s=u,o=u):(o=(a*u+(n-a)*s)/n,s=o))}i[r]=o}}else{r=0;for(var C=null;r<t.length;++r)if(null!=t[r]&&!isNaN(t[r])){C=t[r],i[r]=C;break}for(++r;r<t.length;++r)i[r]=(a*t[r]+(e-a)*C)/e,C=i[r]}return i},this.DMA=function(t,e){var a=[];if(t.length<0||t.length!=e.length)return a;for(var i=0;i<t.length;++i)if(null!=t[i]&&!isNaN(t[i])&&null!=e[i]&&!isNaN(e[i])){a[i]=t[i];break}for(i+=1;i<t.length;++i)null==t[i]||null==e[i]?a[i]=null:e[i]<1?a[i]=e[i]*t[i]+(1-e[i])*a[i-1]:a[i]=t[i];return a},this.WMA=function(t,e){var a=[];if(!t||!t.length)return a;if(Array.isArray(e)){for(D=0;D<e.length&&D<t.length;++D){a[D]=null;var i=e[D];if(!(i<=0)){for(var r=0,n=0,s=0,o=0,h=0;h<i;++h)if(s=D-(i-h-1),n=t[s],r=h,this.IsNumber(n)){o=n;break}if(!(r>=i)){for(var l=0,u=0,C=(h=r,1);h<i;++h,++C)s=D-(i-h-1),n=t[s],this.IsNumber(n)?o=n:n=o,u+=C,l+=n*C;a[D]=l/u}}}return a}if(e<=0)return[];var D=0;for(D=0;D<t.length&&!this.IsNumber(t[D]);++D)a[D]=null;t=t.slice(0);for(var f=0;D<t.length;++D,++f)if(f<e-1)a[D]=null;else{for(o=t[D-(e-1)],l=0,u=0,h=e-1;h>=0;--h){n=t[D-h];this.IsNumber(n)?o=n:(n=o,t[D-h]=n),u+=e-h,l+=n*(e-h)}a[D]=l/u}return a},this.MEMA=function(t,e){var a=[];if(!t||!t.length)return a;var i=0,r=0;for(r=0;r<t.length&&!this.IsNumber(t[r]);++r)a[r]=null;if(i=r,e<1||i+e>=t.length)return a;var n=0;for(t=t.slice(0);i<r+e;++i)a[i]=null,!this.IsNumber(t[i])&&i-1>=0&&(t[i]=t[i-1]),n+=t[i];for(a[i-1]=n/e;i<t.length;++i)this.IsNumber(a[i-1])&&this.IsNumber(t[i])?a[i]=(t[i]+a[i-1]*(e-1))/e:i-1>-1&&this.IsNumber(a[i-1])?a[i]=a[i-1]:a[i]=null;return a},this.EXPMA=function(t,e){var a=[];if(e>=t.length)return a;for(var i=e;i<t.length;++i)if(null!=t[i]){a[i]=t[i];break}for(i+=1;i<t.length;++i)null!=a[i-1]&&null!=t[i]?a[i]=(2*t[i]+(e-1)*a[i-1])/(e+1):null!=a[i-1]&&(a[i]=a[i-1]);return a},this.EXPMEMA=function(t,e){var a=[];if(e>=t.length)return a;for(var i=0;i<t.length;++i)if(t[i]&&!isNaN(t[i]))break;for(var r=0,n=0;i<t.length&&n<e;++n,++i)t[i]&&!isNaN(t[i])?r+=t[i]:r+=t[i-1];for(a[i-1]=r/e;i<t.length;++i)null!=a[i-1]&&null!=t[i]?a[i]=(2*t[i]+(e-1)*a[i-1])/(e+1):null!=a[i-1]&&(a[i]=a[i-1]);return a},this.SUMBARS=function(t,e){var a=[];if(!t||!t.length||!e||!e.length)return a;for(var i=0,r=0,n=0;i<t.length&&!this.IsNumber(t[i]);++i)a[i]=null;for(r=t.length-1;r>=i;--r){var s=0;for(n=r,s=0;n>=i&&s<e[r];--n)s+=t[n];a[r]=n<i?null:r-n}for(r=i+1;r<t.length;++r)null==a[r]&&(a[r]=a[r-1]);return a},this.REVERSE=function(t){if(this.IsNumber(t))return 0-t;for(var e=[],a=0;a<t.length&&!this.IsNumber(t[a]);++a)e[a]=null;for(;a<t.length;++a)this.IsNumber(t[a])?e[a]=0-t[a]:e[a]=null;return e},this.COUNT=function(t,e){if(Array.isArray(e)){for(var a=null,i=t.length,r=0;r<i;++r)if(this.IsNumber(t[r])){a=r;break}if(null==a)return[];var n=[],s=0;for(r=0;r<e.length;++r){var o=e[r];if(ha.IsNumber(o)){o<1&&(o=r+1),s=0;for(var h=r,l=0;h>=0&&l<o;--h,++l)t[h]&&++s;n[r]=s}}return n}for(o=e,i=t.length,o=o<1?i:o,r=0,h=0;r<i;++r)if(this.IsNumber(t[r]))break;n=[];for(var u=0;r<i&&h<o;++r,++h)u=t[r]?u+1:u,n[r]=u;for(;r<i;++r)t[r-o]&&u&&u--,u=t[r]?u+1:u,n[r]=u;return n},this.HHV=function(t,e){var a=[];if(Array.isArray(e)){for(var i=null,r=0,n=0;r<t.length;++r)if(a[r]=null,!(r>=e.length)){i=null;var s=e[r];if(s>0&&s<=r)for(n=r-s;n<=r;++n)(null==i||i<t[n])&&(i=t[n]);else for(s=r,n=0;n<=r;++n)(null==i||i<t[n])&&(i=t[n]);a[r]=i}}else{if(!ha.IsNonEmptyArray(t))return a;(e<=0||e>t.length)&&(e=t.length);var o=this.GetFirstVaildIndex(t);if(o>=t.length)return a;var h=o;h<t.length&&(a[h]=t[h]);for(r=h+1,n=2;r<t.length&&n<e;++r,++n)t[r]>=t[h]&&(h=r),a[r]=t[h];for(;r<t.length;++r){if(r-h<e)h=t[r]<t[h]?h:r;else for(n=h=r-e+1;n<=r;++n)h=t[n]<t[h]?h:n;a[r]=t[h]}}return a},this.HV=function(t,e){var a=this.HHV(t,e);return this.REF(a,1)},this.LLV=function(t,e){var a=[];if(Array.isArray(e)){for(var i=0;i<t.length;++i)if(a[i]=null,!(i>=e.length)){var r=null,n=e[i];if(n>0&&n<=i)for(var s=i-n;s<=i;++s)(null==r||r>t[s])&&(r=t[s]);else{n=i;for(s=0;s<=i;++s)(null==r||r>t[s])&&(r=t[s])}a[i]=r}}else{if(!ha.IsNonEmptyArray(t))return a;(e<=0||e>t.length)&&(e=t.length);var o=this.GetFirstVaildIndex(t);if(o>=t.length)return a;var h=o;h<t.length&&(a[h]=t[h]);for(i=h+1,s=2;i<t.length&&s<e;++i,++s)t[i]<=t[h]&&(h=i),a[i]=t[h];for(;i<t.length;++i){if(i-h<e)h=t[i]>t[h]?h:i;else for(s=h=i-e+1;s<=i;++s)h=t[s]>t[h]?h:s;a[i]=t[h]}}return a},this.LV=function(t,e){var a=this.LLV(t,e);return this.REF(a,1)},this.STD=function(t,e){var a=[];if(!Array.isArray(t))return a;var i=this.GetFirstVaildIndex(t);if(!ha.IsNumber(e))return a;if(i+e>t.length||e<1)return a;var r=i,n=0,s=!0,o=0,h=0;for(r+=e-1;r<t.length;++r){if(o=0,s){for(s=!1,n=r-e+1;n<=r;++n)h+=t[n];h/=e}else h+=(t[r]-t[r-e])/e;for(n=r-e+1;n<=r;++n)o+=(t[n]-h)*(t[n]-h);a[r]=Math.sqrt(o/(e-1))}return a},this.AVEDEV=function(t,e){for(var a=[],i=0,r=[],n=e-1;n<t.length;++n){i=0;for(var s=0;s<e;++s)i+=t[n-s];r[n]=i/e}for(n=e-1;n<t.length;++n){i=0;for(s=0;s<e;++s)i+=Math.abs(t[n-s]-r[n]);a[n]=i/e}return a},this.CROSS=function(t,e){var a=[];if(Array.isArray(t)&&Array.isArray(e)){if(t.length!=e.length)return[];for(var i=0;i<t.length;++i)if(this.IsNumber(t[i])&&this.IsNumber(e[i]))break;for(++i;i<t.length;++i)a[i]=t[i]>e[i]&&t[i-1]<e[i-1]?1:0}else if(Array.isArray(t)&&"number"==typeof e){for(i=0;i<t.length;++i)if(this.IsNumber(t[i]))break;for(++i;i<t.length;++i)a[i]=t[i]>e&&t[i-1]<e?1:0}else if("number"==typeof t&&Array.isArray(e)){for(i=0;i<e.length;++i)if(this.IsNumber(e[i]))break;for(++i;i<e.length;++i)a[i]=e[i]<t&&e[i-1]>t?1:0}return a},this.CROSSDOWN=function(t,e){return this.CROSS(e,t)},this.CROSSUP=function(t,e){return this.CROSS(t,e)},this.MULAR=function(t,e){var a=[];if(Array.isArray(e))for(n=0;n<t.length;++n){a[n]=null;var i=e[n];if(this.IsNumber(i)&&(i=parseInt(i),!(i<0)))for(s=n,o=0;s>=0&&o<i;--s,++o)0==o?a[n]=t[s]:a[n]*=t[s]}else{if(t.length<e)return a;if(0==e){for(var r=e;r<t.length;++r)if(this.IsNumber(t[r])){a[r]=t[r];break}for(++r;r<t.length;++r)a[r]=a[r-1]*t[r]}else for(var n=e-1,s=0;n<t.length;++n,++s)for(var o=0;o<e;++o)0==o?a[n]=t[o+s]:a[n]*=t[o+s]}return a},this.SUM=function(t,e){var a=[];if(Array.isArray(e))for(r=0;r<t.length;++r){a[r]=null;var i=e[r];if(i>0)for(n=r,s=0;n>=0&&s<i;--n,++s)0==s?a[r]=t[n]:a[r]+=t[n]}else if(0==e){a[0]=t[0];for(var r=1;r<t.length;++r)a[r]=a[r-1]+t[r]}else for(var r=e-1,n=0;r<t.length;++r,++n)for(var s=0;s<e;++s)0==s?a[r]=t[s+n]:a[r]+=t[s+n];return a},this.BARSCOUNT=function(t){var e=[],a=null;for(var i in t){if(e[i]=0,null==a){if(!this.IsNumber(t[i]))continue;a=0}e[i]=a,++a}return e},this.DEVSQ=function(t,e){if(this.IsNumber(t)&&this.IsNumber(e))return 0;var a=[];if(Array.isArray(t)){var i=null;if(Array.isArray(e)){for(var r=e.length-1;r>=0;--r)if(this.IsNumber(e[r])){i=parseInt(e[r]);break}}else i=parseInt(e);if(!this.IsNumber(i))return a;var n=t.length,s=(r=0,0),o=0,h=0,l=0;for(r=0;r<n&&!this.IsNumber(t[r]);++r)a[r]=null;if(i<1||r+i>n)return a;for(h=0;r<n&&s<i;++r,++s)h+=t[r]/i;if(s==i){for(l=0,r--;o<i;o++)l+=(t[r-o]-h)*(t[r-o]-h);a[r]=l,r++}for(;r<n;++r){for(h+=(t[r]-t[r-i])/i,l=0,o=0;o<i;++o)l+=(t[r-o]-h)*(t[r-o]-h);a[r]=l}}return a},this.NOT=function(t){var e="number"==typeof t;if(e)return t?0:1;var a=[];for(var i in t)a[i]=null,this.IsNumber(t[i])&&(a[i]=t[i]?0:1);return a},this.FORCAST=function(t,e){var a=[];"number"!=typeof e&&(e=parseInt(e));var i=e,r=t.length;if(i<1||i>=r)return a;var n,s,o,h,l,u=0,C=0,D=0,f=0;for(h=0;h<r&&!this.IsNumber(t[h]);++h)a[h]=null;for(o=h+i-1;o<r;++o){for(u=C=D=f=0,h=0,l=i;h<i&&h<=o;++h,--l)u+=l,C+=t[o-h];for(u/=i,C/=i,h=0,l=i;h<i&&h<=o;++h,--l)D+=(l-u)*(t[o-h]-C),f+=(l-u)*(l-u);s=D/f,n=C-u*s,a[o]=s*i+n}return a},this.TSMA=function(t,e){var a=[];"number"!=typeof e&&(e=parseInt(e));var i=e,r=t.length;if(i<1||i>=r)return a;var n,s,o,h,l,u=0,C=0,D=0,f=0;for(h=0;h<r&&!this.IsNumber(t[h]);++h)a[h]=null;for(o=h+i-1;o<r;++o){for(u=C=D=f=0,h=0,l=i;h<i&&h<=o;++h,--l)u+=l,C+=t[o-h];for(u/=i,C/=i,h=0,l=i;h<i&&h<=o;++h,--l)D+=(l-u)*(t[o-h]-C),f+=(l-u)*(l-u);s=D/f,n=C-u*s,a[o]=s*i+n+s}return a},this.SLOPE=function(t,e){var a=[];if("number"!=typeof e&&(e=parseInt(e)),e<1||!t.length)return a;if(e>=t.length)return a;for(var i=0,r=0;r<t.length;++r,++i)if(a[r]=null,this.IsNumber(t[r]))break;for(var n=void 0,s=void 0,o=void 0,h=void 0,l=i+e-1;l<t.length;++l){a[l]=null,n=s=o=h=0;for(var u=0;u<e&&u<=l;++u)n+=l-u,s+=t[l-u];for(n/=e,s/=e,u=0;u<e&&u<=l;++u)o+=(l-u-n)*(t[l-u]-s),h+=(l-u-n)*(l-u-n);h?a[l]=o/h:l&&(a[l]=a[l-1])}return a},this.STDP=function(t,e){var a=[];if(!Array.isArray(t))return a;var i=this.GetFirstVaildIndex(t);if(!ha.IsNumber(e))return a;if(i+e>t.length||e<1)return a;var r=i,n=0,s=!0,o=0,h=0;for(r+=e-1;r<t.length;++r){if(o=0,s){for(s=!1,n=r-e+1;n<=r;++n)h+=t[n];h/=e}else h+=(t[r]-t[r-e])/e;for(n=r-e+1;n<=r;++n)o+=(t[n]-h)*(t[n]-h);a[r]=Math.sqrt(o/e)}return a},this.VAR=function(t,e){if(this.IsNumber(t)&&this.IsNumber(e))return 0;var a=[];if(Array.isArray(t)&&this.IsNumber(e)){var i,r=parseInt(e),n=t.length;if(r<=0||r>=n)return a;for(o=0;o<n&&!this.IsNumber(t[o]);++o)a[o]=null;for(l=0,o=o+r-1;o<n;++o){for(h=i=0,l=0;l<r&&l<=o;++l)h+=t[o-l]*t[o-l],i+=t[o-l];a[o]=(r*h-i*i)/r*(r-1)}}else if(Array.isArray(t)&&Array.isArray(e))for(var s=this.GetFirstVaildIndex(t),o=s;o<t.length;++o){var h=i=0;if(this.IsNumber(e[o])){r=parseInt(e[o]);if(!(r<=0||o-(r-1)<0)){for(var l=0;l<r;++l)h+=t[o-l]*t[o-l],i+=t[o-l];a[o]=(r*h-i*i)/r*(r-1)}}}return a},this.VARP=function(t,e){var a=[];"number"!=typeof e&&(e=parseInt(e));var i=e,r=t.length;if(i<1||i>=r)return a;var n=0,s=0;for(n=0;n<r&&!this.IsNumber(t[n]);++n)a[n]=null;for(var o=0,h=0;n<r&&s<i;++n,++s)o+=t[n]*t[n],h+=t[n];for(s==i&&(a[n-1]=(i*o-h*h)/(i*i));n<r;++n)o+=t[n]*t[n]-t[n-i]*t[n-i],h+=t[n]-t[n-i],a[n]=(i*o-h*h)/(i*i);return a},this.RANGE=function(t,e,a){var i="number"==typeof t,r="number"==typeof e,n="number"==typeof a;if(i&&r&&n)return t>Math.min(e,a)&&t<Math.max(e,a)?1:0;for(var s=[],o=void 0,h=void 0,l=0;l<t.length;++l)if(s[l]=null,o=t[l],this.IsNumber(o)){if(r)h=e;else{if(l>=e.length)continue;h=e[l]}if(this.IsNumber(h)){if(n)rangeValue2=a;else{if(l>=a.length)continue;rangeValue2=a[l]}this.IsNumber(rangeValue2)&&(s[l]=o>Math.min(h,rangeValue2)&&o<Math.max(h,rangeValue2)?1:0)}}return s},this.EXIST=function(t,e){if("number"==typeof t)return 0;if(Array.isArray(e)){var a=[];if(t.length<=0)return a;for(var i in t)a[i]=0;for(i=0;i<e.length&&i<t.length;++i){var r=e[i];if(this.IsNumber(r)&&(r=parseInt(r),!(r<=0))){r>i+1&&(r=i+1);for(var n=!1,s=0,o=0;o<r;++o)if(i-(r-o-1),s=t[i],this.IsNumber(s)&&s>0){n=!0;break}a[i]=n?1:0}}return a}e=parseInt(e);for(var h=null,l=(a=[],0);l<t.length;++l)a[l]=null,s=t[l],this.IsNumber(s)&&s>0&&(h=l),a[l]=null!=h&&l-h<e?1:0;return a},this.TFILTER=function(t,e,a){if(!this.IsNumber(a))return[];if(1==a)return this.And(t,this.EQ(this.COUNT(t,this.BARSLAST(e)),1));if(2==a)return this.And(e,this.EQ(this.COUNT(e,this.BARSLAST(t)),1));if(0==a){for(var i=this.And(e,this.EQ(this.COUNT(e,this.BARSLAST(t)),1)),r=this.And(e,this.EQ(this.COUNT(e,this.BARSLAST(t)),1)),n=0;n<i.length;++n){var s=r[n];s>0&&(i[n]=2)}return i}return[]},this.FILTER=function(t,e){for(var a=[],i=0,r=0;i<t.length;++i)if(t[i]){for(a[i]=1,r=0;r<e&&r+i+1<t.length;++r)a[r+i+1]=0;i+=e}else a[i]=0;return a},this.BARSLAST=function(t){var e=[];if(!t)return e;for(var a=null,i=0;i<t.length;++i)e[i]=null,t[i]>0?a=0:null!=a&&++a,null!=a&&(e[i]=a);return e},this.BARSSINCEN=function(t,e){var a=[];if(this.IsNumber(e)&&Array.isArray(t)){var i=e;i<1&&(i=t.length);var r=this.GetFirstVaildIndex(t);if(r>=t.length)return a;var n=0;for(n=r<=i-1?i-1:r,a[n]=n-r;n<t.length;++n)if(this.IsNumber(a[n-1])){if(a[n-1]+1<i)a[n]=a[n-1]+1;else for(var s=n-i+1;s<=n;++s)if(!(Math.abs(t[s])<1e-6)){a[n]=n-s;break}}else Math.abs(t[n])<1e-6||(a[n]=0)}return a},this.BARSSINCE=function(t){for(var e=[],a=null,i=0;i<t.length;++i)e[i]=null,null==a?t[i]&&(a=0):++a,a&&(e[i]=a);return e},this.Trigonometric=function(t,e){if(Array.isArray(t)){var a=[];for(var i in t){var r=t[i];this.IsNumber(r)?a[i]=e(r):a[i]=null}return a}return this.IsNumber(t)?e(t):null},this.ASIN=function(t){if(Array.isArray(t)){var e=[];for(var a in t){var i=t[a];if(e[a]=null,this.IsNumber(i))if(i>=-1&&i<=1)e[a]=Math.asin(i);else if(a-1>=0){var r=e[a-1];this.IsNumber(r)&&(e[a]=r)}}return e}return this.IsNumber(t)?Math.acos(t):null},this.ACOS=function(t){if(Array.isArray(t)){var e=[];for(var a in t){var i=t[a];if(e[a]=null,this.IsNumber(i))if(i>=-1&&i<=1)e[a]=Math.acos(i);else if(a-1>=0){var r=e[a-1];this.IsNumber(r)&&(e[a]=r)}}return e}return this.IsNumber(t)?Math.acos(t):null},this.LAST=function(t,e,a){if(!Array.isArray(t))return[];for(var i=[],r=t.length,n=e,s=a,o=0,h=0,l=0,u=0;o<r;++o)if(t[o])break;for(h=o,u=o-s+1;h<r;++h,++u){for(l=0==n?o:Math.max(o,h-n);l<u;++l)if(t[l]<=0)break;i[h]=l<u?0:1}return i},this.ZIG=function(t,e){var a=this.SymbolData.Data,i=[];if("number"==typeof t)switch(t){case 0:t=a.GetOpen();break;case 1:t=a.GetHigh();break;case 2:t=a.GetLow();break;case 3:t=a.GetClose();break;default:return i}return this.ZIG_Calculate(t,e)},this.GetFirstVaildIndex=function(t){for(var e=0;e<t.length;++e)if(this.IsNumber(t[e]))return e;return t.length},this.ZIG_Calculate=function(t,e){var a=[],i=t.length,r=this.GetFirstVaildIndex(t),n=0,s=0,o=0,h=0,l=0;for(n=r+1,s=o=r;n<i-1&&o==r;++n)o=100*Math.abs(t[n]-t[r])>=e*t[r]?t[n]>t[r]?n:-n:r;for(;n<i-1;++n)if(t[n]>=t[n-1]&&t[n]>=t[n+1])if(o<0){if(100*(t[n]-t[-o])<e*t[-o])continue;for(l=(t[s]-t[h=-o])/(-o-s),a[h--]=t[-o];h>=s;h--)a[h]=t[-o]+(-o-h)*l;s=-o,o=n}else t[n]>t[o]&&(o=n);else if(t[n]<=t[n-1]&&t[n]<=t[n+1])if(o>0){if(100*(t[o]-t[n])<e*t[o])continue;for(l=(t[o]-t[h=s])/(o-s),a[h++]=t[s];h<=o;++h)a[h]=t[s]+(h-s)*l;s=o,o=-n}else t[n]<t[-o]&&(o=-n);if(Math.abs(o)>=i-2&&(o>0&&t[i-1]>=t[o]&&(o=i-1),o<0&&t[i-1]<=t[-o]&&(o=1-i)),o>0)for(l=(t[o]-t[h=s])/(o-s),a[h++]=t[s];h<=o;++h)a[h]=t[s]+(h-s)*l;else for(l=(t[s]-t[h=-o])/(-o-s),a[h--]=t[-o];h>=s;h--)a[h]=t[-o]+(-o-h)*l;if((o=Math.abs(o))<i-1)if(t[i-1]>=t[o])for(l=(t[i-1]-t[h=o])/(i-o),a[h++]=t[o];h<i;++h)a[h]=t[o]+(h-o)*l;else for(l=(t[o]-t[h=i-1])/(i-o),a[h--]=t[i-1];h>=o;h--)a[h]=t[i-1]+(i-h)*l;return a},this.JSDraw=null,this.CalculateZIGLine=function(t,e,a,i,r){null==this.JSDraw&&(this.JSDraw=new In(this.ErrorHandler));var n=e.Up,s=t;if(n)for(var o=t.ID+1;o<a.ID;++o){var h=i[o];this.IsNumber(h)&&(s.Value<h&&(s={ID:o,Value:h}))}else for(o=t.ID+1;o<a.ID;++o){h=i[o];this.IsNumber(h)&&(s.Value>h&&(s={ID:o,Value:h}))}e.Value=s.Value,e.ID=s.ID;var l={Start:{ID:t.ID,Value:t.Value},End:{ID:e.ID,Value:e.Value}},u=this.JSDraw.CalculateDrawLine(l);for(var o in u){var C=u[o];r[C.ID]=C.Value}if(a.ID==i.length-1)for(var o in l={Start:{ID:e.ID,Value:e.Value},End:{ID:a.ID,Value:a.Value}},u=this.JSDraw.CalculateDrawLine(l),u){C=u[o];r[C.ID]=C.Value}else t.ID=e.ID,t.Value=e.Value,e.ID=a.ID,e.Value=a.Value,e.Up=t.Value<e.Value},this.TROUGHBARS=function(t,e,a){var i=this.ZIG(t,e),r=[],n=a;if(n<1)return r;for(var s=i.length,o=[],h=0;h<n;++h)o[h]=0;var l=0;h=this.GetFirstVaildIndex(i)+1;for(n--;h<s&&i[h]>i[h-1];++h);for(;h<s&&i[h]<i[h-1];++h);for(o[0]=--h;h<s-1;++h){if(i[h]<i[h+1]){if(l){if(n)for(var u=o.slice(0),C=0;C<n;++C)o[C+1]=u[C];o[l=0]=h}}else l=1;o[n]&&(r[h]=h-o[n])}return o[n]&&(r[h]=h-o[n]),r},this.TROUGH=function(t,e,a){var i=this.ZIG(t,e),r=[],n=a;if(n<1)return r;for(var s=i.length,o=[],h=0;h<n;++h)o[h]=0;h=1;var l=0;h=this.GetFirstVaildIndex(i)+1;for(n--;h<s&&i[h]>i[h-1];++h);for(;h<s&&i[h]<i[h-1];++h);for(o[0]=--h;h<s-1;++h){if(i[h]<i[h+1]){if(l){if(n)for(var u=o.slice(0),C=0;C<n;++C)o[C+1]=u[C];o[l=0]=h}}else l=1;o[n]&&(r[h]=i[o[n]])}return o[n]&&(r[h]=i[o[n]]),r},this.PEAKBARS=function(t,e,a){var i=this.ZIG(t,e),r=[],n=i.length,s=a;if(s<1)return r;for(var o=[],h=0;h<s;++h)o[h]=0;var l=0;h=this.GetFirstVaildIndex(i)+1;for(s--;h<n&&i[h]<i[h-1];++h);for(;h<n&&i[h]>i[h-1];++h);for(o[0]=--h;h<n-1;++h){if(i[h]>i[h+1]){if(l){if(s)for(var u=o.slice(0),C=0;C<s;++C)o[C+1]=u[C];o[l=0]=h}}else l=1;o[s]&&(r[h]=h-o[s])}return o[s]&&(r[h]=h-o[s]),r},this.PEAK=function(t,e,a){var i=this.ZIG(t,e),r=[],n=i.length,s=a;if(s<1)return r;for(var o=0,h=[],l=0;l<s;++l)h[l]=0;l=this.GetFirstVaildIndex(i)+1;for(s--;l<n&&i[l]<i[l-1];++l);for(;l<n&&i[l]>i[l-1];++l);for(h[0]=--l;l<n-1;++l){if(i[l]>i[l+1]){if(o){if(s)for(var u=h.slice(0),C=0;C<s;++C)h[C+1]=u[C];h[o=0]=l}}else o=1;h[s]&&(r[l]=i[h[s]])}return h[s]&&(r[l]=i[h[s]]),r},this.EVERY=function(t,e){var a=[];if(e<1)return a;for(var i=0;i<t.length;++i)if(a[i]=null,this.IsNumber(t[i]))break;for(var r=0;i<t.length;++i)t[i]?r+=1:r=0,r==e?(a[i]=1,--r):a[i]=0;return a},this.COST=function(t,e){var a=[],i=t/100;if(i<1e-6||i>1)return a;var r=this.SymbolData.Data.Data;if(!r||r.length<=0)return a;for(var n=this.SymbolData.GetStockCacheData({FunctionName:"FINANCE",Args:[7],ArgCount:1,Node:e}),s=r[0].High,o=r[0].Low,h=0;h<r.length;++h){var l=r[h];o=Math.min(o,l.Low),s=Math.max(s,l.High)}(o>2e3||o<0||s>2e3||o<0)&&this.ThrowUnexpectedNode(e,"COST() åå²Kçº¿æå¤§æå°å¼éè¯¯, è¶åº(0,1000)èå´");var u=parseInt(100*s+1),C=parseInt(100*o-1),D=0,f=0,c=0;s=u/100,o=C/100;var d=u-C+1;if(d<1)return a;var m=[],v=[];for(h=0;h<d;++h)m[h]=0,v[h]=0;var S=0,I=0,p=0,T=0;for(h=0;h<r.length;++h)if(!(h>=n.length)){if(n[h]>1){var g=r[h];S=g.Vol/n[h];for(var x=0;x<d;x++)m[x]*=1-S;D=parseInt(Math.min(u,Math.max(C,100*g.Low)))-C,f=parseInt(Math.min(u,Math.max(C,100*g.High)))-C,c=parseInt(Math.min(u,Math.max(C,100*g.Close)))-C;for(x=0;x<d;++x)v[x]=0;var F=parseInt((D+f+2*c)/4);if(F==f||F==D)v[F]+=g.Vol;else{for(var y=g.Vol/(F-D),L=D;L<F;++L)v[L]+=y/(F-D)*(L-D);for(L;L<=f;++L)v[L]+=y/(F-f)*(L-f)}for(I=0,x=D;x<=f;x++)m[x]+=v[x];for(x=0;x<d;x++)I+=m[x];for(x=0,T=p=0;x<d;++x)if(p+=m[x],p>=I*i){T=(s-o)*x/d+o;break}}a[h]=T}return a},this.WINNER=function(t,e){var a=[],i=this.SymbolData.Data.Data;if(!i||i.length<=0)return a;for(var r=this.SymbolData.GetStockCacheData({FunctionName:"FINANCE",Args:[7],ArgCount:1,Node:e}),n=i[0].High,s=i[0].Low,o=0;o<i.length;++o){var h=i[o];s=Math.min(s,h.Low),n=Math.max(n,h.High)}(s>5e3||s<0||n>5e3||s<0)&&this.ThrowUnexpectedNode(e,"WINNER() åå²Kçº¿æå¤§æå°å¼éè¯¯, è¶åº(0,5000)èå´");var l=parseInt(100*n+1),u=parseInt(100*s-1),C=0,D=0,f=0;n=l/100,s=u/100;var c=l-u+1;if(c<1)return a;var d=[],m=[];for(o=0;o<c;++o)d[o]=0,m[o]=0;var v=0,S=0,I=0;for(o=0;o<i.length;++o)if(!(o>=r.length)&&r[o]>1){var p=i[o];v=p.Vol/r[o];for(var T=0;T<c;T++)d[T]*=1-v;C=parseInt(Math.min(l,Math.max(u,100*p.Low)))-u,D=parseInt(Math.min(l,Math.max(u,100*p.High)))-u,f=parseInt(Math.min(l,Math.max(u,100*p.Close)))-u;for(T=0;T<c;++T)m[T]=0;var g=parseInt((C+D+2*f)/4);if(g==D||g==C)m[g]+=p.Vol;else{for(var x=p.Vol/(g-C),F=C;F<g;++F)m[F]+=x/(g-C)*(F-C);for(F;F<=D;++F)m[F]+=x/(g-D)*(F-D)}for(S=0,T=C;T<=D;T++)d[T]+=m[T];for(T=0;T<c;T++)S+=d[T];D=Array.isArray(t)?parseInt(Math.min(100*t[o]-u,c-1)):parseInt(Math.min(100*t-u,c-1));for(T=0,I=0;T<=D;T++)I+=d[T];S>0?a[o]=I/S:o-1>=0&&(a[o]=a[o-1])}return a},this.COSTEX=function(t,e,a){var i=[],r=this.SymbolData.Data.Data;if(!r||r.length<=0)return i;for(var n=this.SymbolData.GetStockCacheData({FunctionName:"FINANCE",Args:[7],ArgCount:1,Node:a}),s=r[0].High,o=r[0].Low,h=0;h<r.length;++h){var l=r[h];o=Math.min(o,l.Low),s=Math.max(s,l.High)}(o>5e3||o<0||s>5e3||o<0)&&this.ThrowUnexpectedNode(a,"COSTEX() åå²Kçº¿æå¤§æå°å¼éè¯¯, è¶åº(0,5000)èå´");var u=parseInt(100*s+1),C=parseInt(100*o-1),D=0,f=0,c=0;s=u/100,o=C/100;var d=u-C+1;if(d<1)return i;var m=[],v=[];for(h=0;h<d;++h)m[h]=0,v[h]=0;for(var S=0,I=0,p=0,T=0,g=0,x=0,F=(h=0,0);h<r.length;++h)if(!(h>=n.length)&&n[h]>1){var y=r[h];S=y.Vol/n[h];for(F=0;F<d;F++)m[F]*=1-S;D=parseInt(Math.min(u,Math.max(C,100*y.Low)))-C,f=parseInt(Math.min(u,Math.max(C,100*y.High)))-C,c=parseInt(Math.min(u,Math.max(C,100*y.Close)))-C;for(F=0;F<d;++F)v[F]=0;var L=parseInt((D+f+2*c)/4);if(L==f||L==D)v[L]+=y.Vol;else{for(var E=y.Vol/(L-D),M=D;M<L;++M)v[M]+=E/(L-D)*(M-D);for(M;M<=f;++M)v[M]+=E/(L-f)*(M-f)}0;for(F=D;F<=f;F++)m[F]+=v[F];for(F=0;F<d;F++)m[F];for(f=Array.isArray(t)?parseInt(Math.min(100*t[h]-C,d-1)):parseInt(Math.min(100*t-C,d-1)),F=0,p=0,T=0;F<=f;F++)p+=m[F],T+=.01*(F+C)*m[F];for(f=Array.isArray(e)?parseInt(Math.min(100*e[h]-C,d-1)):parseInt(Math.min(100*e-C,d-1)),F=0,g=0,x=0;F<=f;F++)g+=m[F],x+=.01*(F+C)*m[F];I=p-g,dPerVolRange=T-x,Math.abs(dPerVolRange)>.001&&0!=I?i[h]=dPerVolRange/I:h-1>=0&&(i[h]=i[h-1])}return i},this.PPART=function(t,e){var a=[],i=t;if(i<0)return a;var r=this.SymbolData.Data.Data;if(!r||r.length<=0)return a;for(var n=this.SymbolData.GetStockCacheData({FunctionName:"FINANCE",Args:[7],ArgCount:1,Node:e}),s=i,o=0;s<r.length;++s){var h=s-i;if(!(h<0)){var l=0;for(o=0;o<i;++o){var u=r[o+h];l+=u.Vol}if(s<n.length&&n[s]>0){var C=1-l/n[s];a[s]=C}}}return a},this.LWINNER=function(t,e,a){var i=t;i<=0&&this.ThrowUnexpectedNode(a,"LWINNER() ç¬¬1ä¸ªåæ°éè¯¯");var r=[],n=this.SymbolData.Data.Data;if(!n||n.length<=0)return r;for(var s=this.SymbolData.GetStockCacheData({FunctionName:"FINANCE",Args:[7],ArgCount:1,Node:a}),o=0,h=0,l=i-1,u=0,C=0;l<n.length;++l){var D=l-i+1,f=n[D].High,c=n[D].Low;for(u=0;u<i;++u){var d=n[D+u];c=Math.min(c,d.Low),f=Math.max(f,d.High)}(c>5e3||c<0||f>5e3||c<0)&&this.ThrowUnexpectedNode(a,"LWINNER() åå²Kçº¿æå¤§æå°å¼éè¯¯, è¶åº(0,5000)èå´");var m=parseInt(100*f+1),v=parseInt(100*c-1),S=0,I=0,p=0;f=m/100,c=v/100;var T=m-v+1;if(T<1)return r;var g=[],x=[];for(u=0;u<T;++u)g[u]=0,x[u]=0;for(u=0;u<i;++u){var F=s[D+u];if(!(F<1)){var y=n[D+u],L=y.Vol/F;for(C=0;C<T;C++)g[C]*=1-L;S=parseInt(Math.min(m,Math.max(v,100*y.Low)))-v,I=parseInt(Math.min(m,Math.max(v,100*y.High)))-v,p=parseInt(Math.min(m,Math.max(v,100*y.Close)))-v;for(C=0;C<T;++C)x[C]=0;var E=parseInt((S+I+2*p)/4);if(E==I||E==S)x[E]+=y.Vol;else{for(var M,A=y.Vol/(E-S),N=S;N<E;++N)x[N]+=A/(E-S)*(N-S);for(;M<=I;++M)x[M]+=A/(E-I)*(M-I)}o=0;for(C=S;C<=I;C++)g[C]+=x[C]}}for(u=0;u<T;u++)o+=g[u];for(I=Array.isArray(e)?parseInt(Math.min(100*e[l]-v,T-1)):parseInt(Math.min(100*e-v,T-1)),h=0,C=0;C<=I;C++)h+=g[C];o>0&&h>0&&h<=o?r[l]=h/o:l-1>=0&&(r[l]=r[l-1])}return r},this.PWINNER=function(t,e,a){var i=[];return i},this.CalculateChip=function(t,e,a,i){for(var r={Min:null,Max:null,Data:[]},n=1,s=null,o=null,h=t;h>=0;--h){var l={},u=a[h];l.Vol=h==t?u.Vol*e[h]:u.Vol*n,l.Date=u.Date,l.High=u.High,l.Low=u.Low,(null==s||s<l.High)&&(s=l.High),(null==o||o<l.Low)&&(o=l.Low),r.Data[h]=l,n*=1-e[h]/100*i}return r.Max=s,r.Min=o,r},this.UPNDAY=function(t,e){var a=[];if(e<1)return a;if(null==t||e>t.length)return a;for(var i=0,r=0;r<t.length;++r)a[r]=0,r-1<0||(this.IsNumber(t[r])&&this.IsNumber(t[r-1])?(t[r]>t[r-1]?++i:i=0,i==e&&(a[r]=1,--i)):i=0);return a},this.DOWNNDAY=function(t,e){var a=[];if(e<1)return a;if(null==t||e>t.length)return a;for(var i=0,r=0;r<t.length;++r)a[r]=0,r-1<0||(this.IsNumber(t[r])&&this.IsNumber(t[r-1])?(t[r]<t[r-1]?++i:i=0,i==e&&(a[r]=1,--i)):i=0);return a},this.NDAY=function(t,e,a){var i=[];if(a<1)return i;if(!Array.isArray(t)&&!Array.isArray(e))return i;if(null==t||null==e)return i;if(Array.isArray(t)&&Array.isArray(e)){if(a>=t.length||a>=e.length)return i;for(var r=Math.max(t.length,e.length),n=0,s=0;s<r;++s)i[s]=0,s>=t.length||s>=e.length||(this.IsNumber(t[s])&&this.IsNumber(e[s])?(t[s]>e[s]?++n:n=0,n==a&&(i[s]=1,--n)):n=0)}else if(Array.isArray(t)&&!Array.isArray(e)){if(a>=t.length||!this.IsNumber(e))return;n=0;for(var o in t)i[o]=0,this.IsNumber(t[o])?(t[o]>e?++n:n=0,n==a&&(i[o]=1,--n)):n=0}else if(!Array.isArray(t)&&Array.isArray(e)){if(a>=e.length||!this.IsNumber(t))return;n=0;for(var h in e)i[h]=0,this.IsNumber(e[h])?(t>e[h]?++n:n=0,n==a&&(i[h]=1,--n)):n=0}return i},this.LONGCROSS=function(t,e,a){for(var i=[],r=Math.max(t.length,e.length),n=0;n<r;++n)i[n]=0,n-1<0||n>=t.length||n>=e.length||this.IsNumber(t[n])&&this.IsNumber(e[n])&&this.IsNumber(t[n-1])&&this.IsNumber(e[n-1])&&t[n]>e[n]&&t[n-1]<e[n-1]&&(i[n]=1);for(var s=0,o=0;s<r;++s)if(i[s])for(o=1;o<=a&&s-o>=0;++o)if(t[s-o]>=e[s-o]){i[s]=0;break}return i},this.EXISTR=function(t,e,a){var i=[];if(!Array.isArray(t))return i;if(e=parseInt(e),a=parseInt(a),e<=0&&(e=t.length),a<=0&&(a=1),a>e)return i;i=[];for(var r=0,n=0;r<t.length;++r)if(i[r]=null,!(r-e<0||r-a<0))for(i[r]=0,n=e;n>=a;--n){var s=t[r-n];if(this.IsNumber(s)&&s){i[r]=1;break}}return i},this.RELATE=function(t,e,a){var i=[];if(a<1&&(a=1),!Array.isArray(t)||!Array.isArray(e))return i;for(var r=this.CalculateAverage(t,a),n=this.CalculateAverage(e,a),s=Math.max(t.length,e.length),o=0,h=0;o<s;++o)if(i[o]=null,!(o>=t.length||o>=e.length||o>=r.length||o>=n.length)){var l=r[o],u=n[o],C=0,D=0,f=0;for(h=o-a+1;h<=o;++h)C+=(t[h]-l)*(e[h]-u),D+=Math.pow(t[h]-l,2),f+=Math.pow(e[h]-u,2);i[o]=C/a/(Math.sqrt(D/a)*Math.sqrt(f/a))}return i},this.CalculateAverage=function(t,e){var a=[];if(e<1)return a;for(var i=0,r=0;r<t.length;++r)if(this.IsNumber(t[r]))break;for(;r<t.length&&r<e;++r){a[r]=null;var n=t[r];this.IsNumber(n)&&(i+=n)}for(a[r-1]=i/e;r<t.length;++r){n=t[r];var s=t[r-e];this.IsNumber(n)||(n=0),this.IsNumber(s)||(s=0),i=i-s+n,a[r]=i/e}return a},this.COVAR=function(t,e,a){if(this.IsNumber(t)||this.IsNumber(e))return 0;var i=[];if(a<1&&(a=1),!Array.isArray(t)||!Array.isArray(e))return i;for(var r=this.CalculateAverage(t,a),n=this.CalculateAverage(e,a),s=Math.max(t.length,e.length),o=(s=Math.max(t.length,e.length),0),h=0;o<s;++o)if(i[o]=null,!(o>=t.length||o>=e.length||o>=r.length||o>=n.length)){var l=r[o],u=n[o],C=0;for(h=o-a+1;h<=o;++h)C+=(t[h]-l)*(e[h]-u);i[o]=C/a}return i},this.HHVBARS=function(t,e){var a=[];if(!Array.isArray(t))return a;if(Array.isArray(e))for(var i=0;i<e.length;++i){a[i]=null;var r=e[i];if(this.IsNumber(r)){var n=i-r;n<0&&(n=0);for(var s=null,o=n;o<t.length;++o)if(this.IsNumber(t[o])){s=o;break}for(var h=0;o<t.length&&h<r;++h,++o)t[o]>=t[s]&&(s=o);null!=s&&(a[i]=i-s)}}else{e<1&&(e=t.length);for(s=null,i=0;i<t.length;++i)if(a[i]=null,this.IsNumber(t[i])){s=i;break}o=0;for(i=s+1;i<t.length&&o<e;++i,++o)t[i]>=t[s]&&(s=i),e==t.length&&(a[i]=i-s);for(;i<t.length;++i){if(i-s<e)t[i]>=t[s]&&(s=i);else for(s=i-e+1,o=s;o<=i;++o)t[o]>=t[s]&&(s=o);a[i]=i-s}}return a},this.LLVBARS=function(t,e){var a=[];if(!Array.isArray(t))return a;if(Array.isArray(e))for(var i=0;i<e.length;++i){a[i]=null;var r=e[i];if(this.IsNumber(r)){var n=i-r;n<0&&(n=0);for(var s=null,o=n;o<t.length;++o)if(this.IsNumber(t[o])){s=o;break}for(var h=0;o<t.length&&h<r;++h,++o)t[o]<=t[s]&&(s=o);null!=s&&(a[i]=i-s)}}else{e<1&&(e=t.length);for(s=null,i=0;i<t.length;++i)if(a[i]=null,this.IsNumber(t[i])){s=i;break}o=0;for(i=s+1;i<t.length&&o<e;++i,++o)t[i]<=t[s]&&(s=i),e==t.length&&(a[i]=i-s);for(;i<t.length;++i){if(i-s<e)t[i]<=t[s]&&(s=i);else for(s=i-e+1,o=s;o<=i;++o)t[o]<=t[s]&&(s=o);a[i]=i-s}}return a},this.BETA=function(t){var e=[],a=this.SymbolData.Data,i=this.SymbolData.IndexData;t<=0&&(t=1);for(var r=[],n=[],s=0;s<a.Data.length;++s){r[s]=0,n[s]=0;var o=a.Data[s],h=i.Data[s];o.Close>0&&o.YClose>0&&(r[s]=(o.Close-o.YClose)/o.YClose),h.Close>0&&h.YClose>0&&(n[s]=(h.Close-h.YClose)/h.YClose)}for(var l=this.CalculateAverage(r,t),u=this.CalculateAverage(n,t),C=0,D=0;C<a.Data.length;++C)if(e[C]=null,!(C>=r.length||C>=n.length||C>=l.length||C>=u.length)){var f=l[C],c=u[C],d=0,m=0;for(D=C-t+1;D<=C;++D){var v=n[D]-c,S=r[D]-f;d+=v*S,m+=v*v}this.IsDivideNumber(m)&&this.IsNumber(d)&&(e[C]=d/m)}return e},this.BETA2=function(t,e,a){var i=[];a<=0&&(a=1);for(var r=[null],n=[null],s=Math.max(t.length,e.length),o={X:t[0],Y:e[0]},h=1;h<s;++h){r[h]=0,n[h]=0;var l=t[h],u=e[h];o.X>0&&(r[h]=(l-o.X)/o.X),o.Y>0&&(n[h]=(u-o.Y)/o.Y),o={X:l,Y:u}}for(var C=this.CalculateAverage(r,a),D=this.CalculateAverage(n,a),f=(h=0,0);h<s;++h)if(i[h]=null,!(h>=r.length||h>=n.length||h>=C.length||h>=D.length)){var c=C[h],d=D[h],m=0,v=0;for(f=h-a+1;f<=h;++f){var S=r[f]-c,I=n[f]-d;m+=S*I,v+=S*S}this.IsDivideNumber(v)&&this.IsNumber(m)&&(i[h]=m/v)}return i},this.SAR=function(t,e,a){var i=[],r=this.SymbolData.Data;if(t>=r.Data.length)return i;for(var n=null,s=null,o=0;o<t;++o){var h=r.Data[o];(null==n||n<h.High)&&(n=h.High),(null==s||s>h.Low)&&(s=h.Low)}var l=0,u=1,C=l;i[t-1]=s;var D=s,f=r.Data[0].High,c=e/100;for(o=t;o<r.Data.length;++o){var d=f,m=(h=r.Data[o],r.Data[o-1]);C==l?h.Low<i[o-1]?(C=u,f=h.Low,c=e/100,D=Math.max(h.High,m.High),D=Math.max(D,d+c*(f-d))):(C=l,h.High>d&&(f=h.High,c=Math.min(c+e/100,a/100)),D=Math.min(h.Low,m.Low),D=Math.min(D,i[o-1]+c*(f-i[o-1]))):C==u&&(h.High>i[o-1]?(C=l,f=h.High,c=e/100,D=Math.min(h.Low,m.Low),D=Math.min(D,i[o-1]+c*(f-d))):(C=u,h.Low<d&&(f=h.Low,c=Math.min(c+e/100,a/100)),D=Math.max(h.High,m.High),D=Math.max(D,i[o-1]+c*(f-i[o-1])))),i[o]=D}return i},this.SARTURN=function(t,e,a){var i=[],r=this.SAR(t,e,a),n=this.SymbolData.Data,s=0;for(s=0;s<r.length;++s)if(this.IsNumber(r[s]))break;var o=0;s<n.Data.length&&(o=n.Data[s].Close>r[s]);for(var h=s+1;h<n.Data.length;++h){var l=n.Data[h];l.Close<r[h]&&o?i[h]=-1:i[h]=l.Close>r[h]&&!o?1:0,o=l.Close>r[h]}return i},this.BACKSET=function(t,e){var a=[];if(!t)return a;var i=t.length;if(!this.IsNumber(i)||i<=0)return a;if(Array.isArray(e)){for(var r=0;r<i;++r)a[r]=0;for(r=0;r<i;++r){var n=t[r],s=e[r];if(this.IsNumber(n)&&n&&this.IsNumber(s))for(var o=r,h=0;o>=0&&h<s;--o,++h)a[o]=1}}else{for(r=0;r<i;++r)a[r]=0;for(var l=0;l<i;++l)if(this.IsNumber(t[l]))break;if(l==i)return a;var u=Math.min(i-l,Math.max(e,1));for(r=i-1,o=0;r>=0;--r){n=t[r];if(this.IsNumber(n)&&n)for(o=r;o>r-u;--o)a[o]=1}if(t[r])for(o=r;o>=l;--o)a[o]=1}return a},this.BETWEEN=function(t,e,a){var i=[],r="number"==typeof t,n="number"==typeof e,s="number"==typeof a;if(r&&n&&s)return t>=e&&t<=a?1:0;for(var o in t){i[o]=0;var h=t[o],l=null,u=null;n?l=e:o<e.length-1&&(l=e[o]),s?u=a:o<a.length-1&&(u=a[o]),null!=l&&null!=u&&(l>u?h>=u&&h<=l&&(i[o]=1):h<=u&&h>=l&&(i[o]=1))}return i},this.STRCAT=function(t,e){var a=[];return ha.IsString(t)&&ha.IsString(e)&&(a=t+e),a},this.VARCAT=function(t,e){var a=[];if(Array.isArray(t)&&Array.isArray(e))for(var i=Math.max(t.length,e.length),r="",n=0;n<i;++n){if(a[n]=null,r="",n<t.length){var s=t[n];ha.IsString(s)&&(r+=s)}if(n<e.length){s=e[n];ha.IsString(s)&&(r+=s)}""!=r&&(a[n]=r)}else if(ha.IsString(t)&&Array.isArray(e))for(n=0;n<e.length;++n){a[n]=null;s=e[n];ha.IsString(s)&&(a[n]=t+s)}else if(Array.isArray(t)&&ha.IsString(e))for(n=0;n<t.length;++n){a[n]=null;s=t[n];ha.IsString(s)&&(a[n]=s+e)}else ha.IsString(t)&&ha.IsString(e)&&(a=t+e);return a},this.FINDSTR=function(t,e){var a,i,r=[];if(a=ha.IsNumber(t)?t.toString():t,i=ha.IsNumber(e)?e.toString():e,ha.IsString(a)&&ha.IsString(i))return a.indexOf(i)>=0?1:0;if(Array.isArray(t)&&ha.IsString(i))for(var n=0;n<t.length;++n){var s=t[n];ha.IsString(s)?r[n]=s.indexOf(i)>=0?1:0:ha.IsNumber(s)?(a=s.toString(),r[n]=a.indexOf(i)>=0?1:0):r[n]=0}return r},this.STRSPACE=function(t){var e=[];if(Array.isArray(t))for(var a=0;a<t.length;++a){e[a]=null;var i=t[a];ha.IsString(i)&&(e[a]=i+" ")}else ha.IsString(t)&&(e=t+" ");return e},this.CON2STR=function(t,e){var a=[];if(Array.isArray(t))for(var i=t.length-1;i>=0;--i){var r=t[i];if(this.IsNumber(r))return a=r.toFixed(e),a}else this.IsNumber(t)&&(a=t.toFixed(e));return a},this.VAR2STR=function(t,e){var a=[];if(Array.isArray(t))for(var i=0;i<t.length;++i){a[i]=null;var r=t[i];this.IsNumber(r)&&(a[i]=r.toFixed(e))}else this.IsNumber(t)&&(a=t.toFixed(e));return a},this.MOD=function(t,e){var a=[],i="number"==typeof t,r="number"==typeof e;if(i&&r)return Sn.MOD(t,e);if(!i&&!r){for(var n=Math.max(t.length,e.length),s=0;s<n;++s)a[s]=null,s<t.length&&s<e.length&&this.IsNumber(t[s])&&this.IsNumber(e[s])&&(a[s]=Sn.MOD(t[s],e[s]));return a}if(i&&!r){for(var o in e)a[o]=null,this.IsNumber(t)&&this.IsNumber(e[o])&&(a[o]=Sn.MOD(t,e[o]));return a}if(!i&&r){for(var o in t)a[o]=null,this.IsNumber(t[o])&&this.IsNumber(e)&&(a[o]=Sn.MOD(t[o],e));return a}return a},this.POW=function(t,e){var a=[];if(Array.isArray(t)&&Array.isArray(e))for(var i=0;i<t.length;++i){var r=t[i],n=e[i];this.IsNumber(r)&&this.IsNumber(n)?a[i]=Math.pow(r,n):a[i]=null}else if(ha.IsNumber(t)&&Array.isArray(e))for(i=0;i<e.length;++i){var s=e[i];this.IsNumber(s)?a[i]=Math.pow(t,s):a[i]=null}else{if(ha.IsNumber(t)&&ha.IsNumber(e))return Math.pow(t,e);if(Array.isArray(t)&&ha.IsNumber(e))for(i=0;i<t.length;++i){s=t[i];this.IsNumber(s)?a[i]=Math.pow(s,e):a[i]=null}}return a},this.CEILING=function(t){var e="number"==typeof t;if(e)return parseInt(t);var a=[];for(var i in t){var r=t[i];this.IsNumber(r)?a[i]=parseInt(r):a[i]=null}return a},this.FLOOR=function(t){var e="number"==typeof t;if(e)return parseInt(t-1);var a=[];for(var i in t){var r=t[i];this.IsNumber(r)?a[i]=parseInt(r-1):a[i]=null}return a},this.ZTPRICE=function(t,e){if(!this.IsNumber(e))return null;if(Array.isArray(t)){var a=[];for(var i in t){var r=t[i];this.IsNumber(r)?a[i]=(1+e)*r:a[i]=null}return a}if(this.IsNumber(t)){a=(1+e)*t;return a}},this.DTPRICE=function(t,e){if(!this.IsNumber(e))return null;if(Array.isArray(t)){var a=[];for(var i in t){var r=t[i];this.IsNumber(r)?a[i]=(1-e)*r:a[i]=null}return a}if(this.IsNumber(t)){a=(1-e)*t;return a}},this.FRACPART=function(t){if(Array.isArray(t)){var e=[],a=0;for(var i in t){var r=t[i];this.IsNumber(r)?(a=parseInt(r),e[i]=r-a):e[i]=null}return e}if(this.IsNumber(t)){a=parseInt(t);e=t-a;return e}},this.BARSLASTCOUNT=function(t){var e=null;if(Array.isArray(t)){if(e=[],t.length>0)for(var a=0,i=t.length-1;i>=0;--i){a=0;for(var r=i;r>=0;--r){if(!t[r])break;++a}e[i]=a}}else e=t?1:0;return e},this.INTPART=function(t){var e=null;if(Array.isArray(t))for(var a in e=[],t){var i=t[a];this.IsNumber(i)?e[a]=parseInt(i):e[a]=null}else this.IsNumber(t)&&(e=parseInt(t));return e},this.CONST=function(t){if(Array.isArray(t)){var e=t.length;return e>0?t[e-1]:null}return t},this.TOPRANGE=function(t){if(this.IsNumber(t))return 0;var e=[];if(Array.isArray(t))for(var a=t.length,i=a-1;i>=0;--i){e[i]=0;var r=t[i];if(this.IsNumber(r)){for(var n=0,s=i-1;s>=0;--s){if(t[s]>r)break;++n}e[i]=n}}return e},this.LOWRANGE=function(t){if(this.IsNumber(t))return 0;var e=[];if(Array.isArray(t))for(var a=t.length,i=a-1;i>=0;--i){e[i]=0;var r=t[i];if(this.IsNumber(r)){for(var n=0,s=i-1;s>=0;--s){if(t[s]<r)break;++n}e[i]=n}}return e},this.FINDLOW=function(t,e,a,i){if(this.IsNumber(t))return t;var r=[];if(Array.isArray(t))for(var n=t.length,s=n-1;s>=0;--s){r[s]=null;for(var o=[],h=e;h<a;++h){var l=s-h;if(l<0)break;var u=t[l];this.IsNumber(u)&&o.push(u)}if(o.length>0){o.sort((function(t,e){return t-e}));l=i-1;l<0?l=0:l>=o.length&&(l=o.length-1),r[s]=o[l]}}return r},this.FINDHIGH=function(t,e,a,i){if(this.IsNumber(t))return t;var r=[];if(Array.isArray(t))for(var n=t.length,s=n-1;s>=0;--s){r[s]=null;for(var o=[],h=e;h<a;++h){var l=s-h;if(l<0)break;var u=t[l];this.IsNumber(u)&&o.push(u)}if(o.length>0){o.sort((function(t,e){return e-t}));l=i-1;l<0?l=0:l>=o.length&&(l=o.length-1),r[s]=o[l]}}return r},this.FINDHIGHBARS=function(t,e,a,i){if(this.IsNumber(t))return a-e-i;var r=[];if(Array.isArray(t))for(var n=t.length,s=n-1;s>=0;--s){r[s]=null;for(var o=[],h=e;h<a;++h){var l=s-h;if(l<0)break;var u=t[l];this.IsNumber(u)&&o.push({Value:u,Period:h})}if(o.length>0){o.sort((function(t,e){return e.Value-t.Value}));l=i-1;l<0?l=0:l>=o.length&&(l=o.length-1),r[s]=o[l].Period}}return r},this.FINDLOWBARS=function(t,e,a,i){if(this.IsNumber(t))return a-e-i;var r=[];if(Array.isArray(t))for(var n=t.length,s=n-1;s>=0;--s){r[s]=null;for(var o=[],h=e;h<a;++h){var l=s-h;if(l<0)break;var u=t[l];this.IsNumber(u)&&o.push({Value:u,Period:h})}if(o.length>0){o.sort((function(t,e){return t.Value-e.Value}));l=i-1;l<0?l=0:l>=o.length&&(l=o.length-1),r[s]=o[l].Period}}return r},this.HOD=function(t,e){var a=[];if(ha.IsNumber(t))return 1;if(Array.isArray(t))for(var i=t.length,r=i-1;r>=0;--r){var n=t[r];if(ha.IsNumber(n)){if(Array.isArray(e))var s=parseInt(e[r]);else s=parseInt(e);e<=0&&(s=r);for(var o=1,h=r-1,l=1;h>=0&&l<s;--h,++l){var u=t[h];ha.IsNumber(u)&&u>n&&++o}a[r]=o}}return a},this.LOD=function(t,e){var a=[];if(ha.IsNumber(t))return 1;if(Array.isArray(t))for(var i=t.length,r=i-1;r>=0;--r){var n=t[r];if(ha.IsNumber(n)){if(Array.isArray(e))var s=parseInt(e[r]);else s=parseInt(e);e<=0&&(s=r);for(var o=1,h=r-1,l=1;h>=0&&l<s;--h,++l){var u=t[h];ha.IsNumber(u)&&u<n&&++o}a[r]=o}}return a},this.BARSNEXT=function(t){if(!Array.isArray(t))return 0;for(var e=[],a=0;a<t.length;++a){e[a]=0;for(var i=a,r=0;i<t.length;++i,++r){var n=t[i];if(n>0){e[a]=r;break}}}return e},this.RAND=function(t){if(Array.isArray(t)){var e=[];for(var a in t){e[a]=null;var i=t[a],r=parseInt(i);r<=0||(e[a]=Math.ceil(Math.random()*r))}return e}r=parseInt(t);if(r<=0)return null;var n=this.SymbolData.Data,s=n.Data.length;for(e=[],a=0;a<s;++a)e[a]=Math.ceil(Math.random()*r);return e},this.AMA=function(t,e){var a,i=[];if(Array.isArray(e)){for(var r=t.length-1;r>=0;--r)if(this.IsNumber(e[r])){a=e[r];break}}else a=e;if(this.IsNumber(a)){if(a>1)return i;var n=0,s=0;for(n;n<t.length;++n)if(i[n]=null,this.IsNumber(t[n])){s=t[n],i[n]=s;break}for(r=n+1;r<t.length;++r){var o=t[r];i[r]=i[r-1]+a*(o-i[r-1])}}return i},this.TMA=function(t,e,a){var i=[];if(this.IsNumber(e)&&e<=1&&this.IsNumber(a)&&a<1){var r=!1;for(var n in t)if(i[n]=null,0==r){var s=t[n];this.IsNumber(s)&&(i[n]=s,i[n],r=!0)}else{s=t[n];if(!this.IsNumber(s))continue;i[n]=e*i[n-1]+a*s,i[n]}}return i},this.ROUND=function(t){if(this.IsNumber(t))return Math.round(t);var e=[];if(Array.isArray(t))for(var a in t){var i=t[a];this.IsNumber(i)?e[a]=Math.round(i):e[a]=null}return e},this.ROUND2=function(t,e){var a=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12],i=0;if(this.IsNumber(e)&&(i=parseInt(e)),e<0?i=0:e>=a.length&&(i=a.length-1),this.IsNumber(t))return Math.round(t*a[i])/a[i];var r=[];if(Array.isArray(t))for(var n in t){var s=t[n];this.IsNumber(s)?r[n]=Math.round(s*a[i])/a[i]:r[n]=null}return r},this.TRMA=function(t,e){if(!this.IsNumber(e)||e<=0)return[];e=parseInt(e);var a=0,i=0;e%2==0?(a=parseInt(e/2),i=a+1):(a=parseInt((e+1)/2),i=a);var r=this.MA(t,a),n=this.MA(r,i);return n},this.VALUEWHEN=function(t,e){if(Array.isArray(t)){var a=[];if(Array.isArray(e)){var i=null;for(var r in t)if(r>=e.length)a[r]=i;else{var n=e[r];t[r]?(a[r]=n,i=n):a[r]=i}}else{i=null;for(var r in t)t[r]?(a[r]=e,i=e):a[r]=i}return a}return t?1:0},this.HARMEAN=function(t,e){var a=[];if(Array.isArray(t))if(Array.isArray(e))for(var i=0;i<t.length;++i)if(i>=e.length)a[i]=null;else{var r=parseInt(e[i]);if(r<=0||r>i)a[i]=null;else{for(var n=0,s=0;s<r;++s){var o=t[i-s];if(!this.IsNumber(o)||0==o){n=null;break}n+=1/o}a[i]=null==n?null:1/(n/r)}}else if(this.IsNumber(e)){if(e=parseInt(e),e<=0)return a;for(i=0;i<t.length;++i)if(e>i)a[i]=null;else{for(n=0,s=0;s<e;++s){o=t[i-s];if(!this.IsNumber(o)||0==o){n=null;break}n+=1/o}a[i]=null==n?null:1/(n/e)}}return a},this.DATETODAY=function(t){var e=[],a=new Date("1990-12-19"),i=19901219,r=864e5;if(Array.isArray(t))for(var n in t){e[n]=null;var s=t[n];if(this.IsNumber(s)){var o=s+19e6;if(!(o<i)){var h=parseInt(o/1e4),l=parseInt(o%1e4/100),u=parseInt(o%100),C=new Date(h+"-"+l+"-"+u);e[n]=Math.round((C-a)/r)}}}else if(this.IsNumber(t)){o=t+19e6;if(o>=i){h=parseInt(o/1e4),l=parseInt(o%1e4/100),u=parseInt(o%100),C=new Date(h+"-"+l+"-"+u);return Math.round((C-C)/r)}}return e},this.DAYTODATE=function(t){var e=new Date("1990-12-19"),a=[];if(Array.isArray(t))for(var i in t){a[i]=null;var r=t[i];if(this.IsNumber(r)){e.setDate(e.getDate()+r);var n=1e4*e.getFullYear()+100*(e.getMonth()+1)+e.getDate();n-=19e6,a[i]=n,e.setDate(e.getDate()-r)}}else if(this.IsNumber(t)){e.setDate(e.getDate()+t);n=1e4*e.getFullYear()+100*(e.getMonth()+1)+e.getDate();return n-=19e6,n}return a},this.ANY=function(t,e){e<=0&&(e=1);var a=[];if(Array.isArray(t)){if(e>=t.length)return 0;for(var i=e,r=0;i<t.length;++i){var n=0;for(r=0;r<e;++r){var s=t[i-r];if(s>0){n=1;break}}a[i]=n}return a}if(ha.IsNumber(t)){if(t<=0)return 0;if(e>=this.SymbolData.Data.Data.length)return 0;for(i=e;i<this.SymbolData.Data.Data.length;++i)a[i]=1;return a}return 0},this.ALL=function(t,e){e<=0&&(e=1);var a=[];if(Array.isArray(t)){if(e>=t.length)return 0;for(var i=e,r=0;i<t.length;++i){var n=1;for(r=0;r<e;++r){var s=t[i-r];if(!(s>0)){n=0;break}}a[i]=n}return a}if(ha.IsNumber(t)){if(t<=0)return 0;if(e>=this.SymbolData.Data.Data.length)return 0;for(i=e;i<this.SymbolData.Data.Data.length;++i)a[i]=1;return a}return 0},this.CallFunction=function(t,e,a,i){switch(t){case"MAX":case"MAX6":return this.MAX(e,a);case"MIN":case"MIN6":return this.MIN(e,a);case"REF":return this.REF(e[0],e[1]);case"REFV":return this.REFV(e[0],e[1]);case"REFX":return this.REFX(e[0],e[1]);case"REFXV":return this.REFXV(e[0],e[1]);case"REFX1":return this.REFX(e[0],e[1]);case"ABS":return this.ABS(e[0]);case"MA":return this.MA(e[0],e[1]);case"EMA":return this.EMA(e[0],e[1]);case"SMA":return this.SMA(e[0],e[1],e[2]);case"DMA":return this.DMA(e[0],e[1]);case"XMA":return this.XMA(e[0],e[1]);case"EXPMA":return this.EXPMA(e[0],e[1]);case"EXPMEMA":return this.EXPMEMA(e[0],e[1]);case"COUNT":return this.COUNT(e[0],e[1]);case"LLV":return this.LLV(e[0],e[1]);case"LV":return this.LV(e[0],e[1]);case"LLVBARS":return this.LLVBARS(e[0],e[1]);case"HHV":return this.HHV(e[0],e[1]);case"HV":return this.HV(e[0],e[1]);case"HHVBARS":return this.HHVBARS(e[0],e[1]);case"MULAR":return this.MULAR(e[0],e[1]);case"CROSS":return this.CROSS(e[0],e[1]);case"LONGCROSS":return this.LONGCROSS(e[0],e[1],e[2]);case"CROSSDOWN":return this.CROSSDOWN(e[0],e[1]);case"CROSSUP":return this.CROSSUP(e[0],e[1]);case"AVEDEV":return this.AVEDEV(e[0],e[1]);case"STD":return this.STD(e[0],e[1]);case"IF":case"IFF":case"IFELSE":return this.IF(e[0],e[1],e[2]);case"IFN":return this.IFN(e[0],e[1],e[2]);case"NOT":return this.NOT(e[0]);case"SUM":return this.SUM(e[0],e[1]);case"RANGE":return this.RANGE(e[0],e[1],e[2]);case"EXIST":return this.EXIST(e[0],e[1]);case"EXISTR":return this.EXISTR(e[0],e[1],e[2]);case"FILTER":return this.FILTER(e[0],e[1]);case"TFILTER":return this.TFILTER(e[0],e[1],e[2]);case"SLOPE":return this.SLOPE(e[0],e[1]);case"BARSLAST":return this.BARSLAST(e[0]);case"BARSCOUNT":return this.BARSCOUNT(e[0]);case"BARSSINCEN":return this.BARSSINCEN(e[0],e[1]);case"BARSSINCE":return this.BARSSINCE(e[0]);case"LAST":return this.LAST(e[0],e[1],e[2]);case"EVERY":return this.EVERY(e[0],e[1]);case"DEVSQ":return this.DEVSQ(e[0],e[1]);case"ZIG":return this.ZIG(e[0],e[1]);case"TROUGHBARS":return this.TROUGHBARS(e[0],e[1],e[2]);case"TROUGH":return this.TROUGH(e[0],e[1],e[2]);case"PEAKBARS":return this.PEAKBARS(e[0],e[1],e[2]);case"PEAK":return this.PEAK(e[0],e[1],e[2]);case"COST":return this.COST(e[0]);case"WINNER":return this.WINNER(e[0],a);case"PPART":return this.PPART(e[0],a);case"COSTEX":return this.COSTEX(e[0],e[1],a);case"LWINNER":return this.LWINNER(e[0],e[1],a);case"PWINNER":return this.PWINNER(e[0],e[1],a);case"FORCAST":return this.FORCAST(e[0],e[1]);case"TSMA":return this.TSMA(e[0],e[1]);case"STDP":return this.STDP(e[0],e[1]);case"VAR":return this.VAR(e[0],e[1]);case"VARP":return this.VARP(e[0],e[1]);case"UPNDAY":return this.UPNDAY(e[0],e[1]);case"DOWNNDAY":return this.DOWNNDAY(e[0],e[1]);case"NDAY":return this.NDAY(e[0],e[1],e[2]);case"RELATE":return this.RELATE(e[0],e[1],e[2]);case"COVAR":return this.COVAR(e[0],e[1],e[2]);case"BETA":return this.BETA(e[0]);case"BETA2":return this.BETA2(e[0],e[1],e[2]);case"WMA":return this.WMA(e[0],e[1]);case"MEMA":return this.MEMA(e[0],e[1]);case"SUMBARS":return this.SUMBARS(e[0],e[1]);case"REVERSE":return this.REVERSE(e[0]);case"SAR":return this.SAR(e[0],e[1],e[2]);case"SARTURN":return this.SARTURN(e[0],e[1],e[2]);case"BACKSET":return this.BACKSET(e[0],e[1]);case"BETWEEN":return this.BETWEEN(e[0],e[1],e[2]);case"STRCAT":return this.STRCAT(e[0],e[1]);case"CON2STR":return this.CON2STR(e[0],e[1]);case"VAR2STR":return this.VAR2STR(e[0],e[1]);case"VARCAT":return this.VARCAT(e[0],e[1]);case"STRSPACE":return this.STRSPACE(e[0]);case"FINDSTR":return this.FINDSTR(e[0],e[1]);case"DTPRICE":return this.DTPRICE(e[0],e[1]);case"ZTPRICE":return this.ZTPRICE(e[0],e[1]);case"MOD":return this.MOD(e[0],e[1]);case"POW":return this.POW(e[0],e[1]);case"CEILING":return this.CEILING(e[0]);case"FLOOR":return this.FLOOR(e[0]);case"FRACPART":return this.FRACPART(e[0]);case"BARSLASTCOUNT":return this.BARSLASTCOUNT(e[0]);case"INTPART":return this.INTPART(e[0]);case"CONST":return this.CONST(e[0]);case"TOPRANGE":return this.TOPRANGE(e[0]);case"LOWRANGE":return this.LOWRANGE(e[0]);case"FINDLOW":return this.FINDLOW(e[0],e[1],e[2],e[3]);case"FINDLOWBARS":return this.FINDLOWBARS(e[0],e[1],e[2],e[3]);case"FINDHIGH":return this.FINDHIGH(e[0],e[1],e[2],e[3]);case"FINDHIGHBARS":return this.FINDHIGHBARS(e[0],e[1],e[2],e[3]);case"BARSNEXT":return this.BARSNEXT(e[0]);case"HOD":return this.HOD(e[0],e[1]);case"LOD":return this.LOD(e[0],e[1]);case"AMA":return this.AMA(e[0],e[1]);case"TMA":return this.TMA(e[0],e[1],e[2]);case"ROUND":return this.ROUND(e[0]);case"ROUND2":return this.ROUND2(e[0],e[1]);case"TRMA":return this.TRMA(e[0],e[1]);case"VALUEWHEN":return this.VALUEWHEN(e[0],e[1]);case"HARMEAN":return this.HARMEAN(e[0],e[1]);case"DATETODAY":return this.DATETODAY(e[0]);case"DAYTODATE":return this.DAYTODATE(e[0]);case"ANY":return this.ANY(e[0],e[1]);case"ALL":return this.ALL(e[0],e[1]);case"ATAN":return this.Trigonometric(e[0],Math.atan);case"ACOS":return this.ACOS(e[0]);case"ASIN":return this.ASIN(e[0]);case"COS":return this.Trigonometric(e[0],Math.cos);case"SIN":return this.Trigonometric(e[0],Math.sin);case"TAN":return this.Trigonometric(e[0],Math.tan);case"LN":return this.Trigonometric(e[0],Math.log);case"LOG":return this.Trigonometric(e[0],o.default);case"EXP":return this.Trigonometric(e[0],Math.exp);case"SQRT":return this.Trigonometric(e[0],Math.sqrt);case"RAND":return this.RAND(e[0]);default:this.ThrowUnexpectedNode(a,"å½æ°"+t+"ä¸å­å¨",t)}},this.CallCustomFunction=function(t,e,a,i){var r=sn.CustomFunction.Data.get(t),n=a.GetStockCacheData({CustomName:t,Node:i});if(!r.Invoke)return{Out:n};w.Complier.Log("[JSAlgorithm::CallCustomFunction] call custom function functionInfo=",r);var s=this,o={Name:t,Args:e,Symbol:a.Symbol,Period:a.Period,Right:a.Right,KData:a.Data,DownloadData:n,ThrowError:function(t){s.ThrowUnexpectedNode(i,t)}};return r.Invoke(o)},this.ThrowUnexpectedNode=function(t,e,a){var i=t.Marker,r=e||"æ§è¡å¼å¸¸";return this.ErrorHandler.ThrowError(i.Index,i.Line,i.Column,r,a)}}function In(t,e){this.ErrorHandler=t,this.SymbolData=e,this.DRAWTEXT=function(t,e,a){var i=[],r={DrawData:i,DrawType:"DRAWTEXT",Text:a};if(Array.isArray(t)){if(t.length<=0)return r;var n=this.IsNumber(e),s=!1;for(var o in"TOP"!==e&&"BOTTOM"!==e||(r.FixedPosition=e,s=!0),t)i[o]=null,!isNaN(t[o])&&t[o]&&(n||s?i[o]=e:this.IsNumber(e[o])&&(i[o]=e[o]))}else if(this.IsNumber(t)&&t){n=this.IsNumber(e),s=!1;"TOP"!==e&&"BOTTOM"!==e||(r.FixedPosition=e,s=!0);for(o=0;o<this.SymbolData.Data.Data.length;++o)n||s?i[o]=e:this.IsNumber(e[o])&&(i[o]=e[o])}return r},this.DRAWTEXT_FIX=function(t,e,a,i,r){var n={Value:[],Text:[]},s={DrawData:n,DrawType:"DRAWTEXT_FIX",Text:null,Position:{X:e,Y:a,Type:i}};if(t.length<=0)return s;if(Array.isArray(t))for(var o in t)n.Text[o]=null,n.Value[o]=0,!isNaN(t[o])&&t[o]&&(n.Value[o]=1,n.Text[o]=r);else if(t)for(o=0;o<this.SymbolData.Data.Data.length;++o)n.Text[o]=r,n.Value[o]=1;return s},this.SUPERDRAWTEXT=function(t,e,a,i,r){var n=[],s={DrawData:n,DrawType:"SUPERDRAWTEXT",Text:a,YOffset:r,Direction:i,TextAlign:"center"};if(t.length<=0)return s;var o="number"==typeof e;for(var h in t)n[h]=null,!isNaN(t[h])&&t[h]&&(o?n[h]=e:this.IsNumber(e[h])&&(n[h]=e[h]));return s},this.STICKLINE=function(t,e,a,i,r){var n=[],s={DrawData:n,DrawType:"STICKLINE",Width:i,Type:r};s.Width<0&&(s.Width=3);var o="number"==typeof e,h="number"==typeof a;if(Array.isArray(t)){if(t.length<=0)return s;for(var l in t)if(n[l]=null,!isNaN(t[l])&&t[l])if(o&&h)n[l]={Value:e,Value2:a};else if(o&&!h){if(isNaN(a[l]))continue;n[l]={Value:e,Value2:a[l]}}else if(!o&&h){if(isNaN(e[l]))continue;n[l]={Value:e[l],Value2:a}}else{if(isNaN(e[l])||isNaN(a[l]))continue;n[l]={Value:e[l],Value2:a[l]}}}else{if(!t)return s;for(l=0;l<this.SymbolData.Data.Data.length;++l)if(n[l]=null,o&&h)n[l]={Value:e,Value2:a};else if(o&&!h){if(!ha.IsNumber(a[l]))continue;n[l]={Value:e,Value2:a[l]}}else if(!o&&h){if(!ha.IsNumber(e[l]))continue;n[l]={Value:e[l],Value2:a}}else{if(!ha.IsNumber(e[l])||!ha.IsNumber(a[l]))continue;n[l]={Value:e[l],Value2:a[l]}}}return s},this.DRAWLINE=function(t,e,a,i,r){var n=[],s={DrawData:n,DrawType:"DRAWLINE",Expand:r};if(t.length<=0)return s;for(var o=Math.max(t.length,a.length),h=!1,l=!1,u={Start:{},End:{},List:new Array},C=0;C<o;++C){if(n[C]=null,C<t.length&&C<a.length)if(0==h&&0==l){if(null==t[C]||!t[C])continue;h=!0,u.Start={ID:C,Value:e[C]}}else if(1==h&&0==l){var D=null!=a[C]&&a[C];if(!D){t[C]&&(u.Start={ID:C,Value:e[C]});continue}D&&(l=!0,u.End={ID:C,Value:i[C]})}else if(1==h&&1==l){D=null!=a[C]&&a[C];if(D)u.End={ID:C,Value:i[C]};else if(t[C]){var f=this.CalculateDrawLine(u);for(var c in f){var d=f[c];n[d.ID]=d.Value}1==r&&this.CalculateDrawDataExtendLine(n,u.Start.ID-2),h=l=!1,u={Start:{},End:{}},h=!0,l=!1,u.Start={ID:C,Value:e[C]}}}if(1==h&&1==l){var m=this.CalculateDrawLine(u);for(var v in m){var S=m[v];n[S.ID]=S.Value}}}return 1==r&&this.CalculateDrawDataExtendLine(n),s},this.DRAWBAND=function(t,e,a,i){ha.IsNumber(e)&&(e="rgb("+e+",0,0)"),ha.IsNumber(i)&&(i="rgb("+i+",0,0)");var r=[],n={DrawData:r,DrawType:"DRAWBAND",Color:[e.toLowerCase(),i.toLowerCase()]},s=ha.IsNumber(t),o=ha.IsNumber(a);if(s||o){if(s&&!o)for(h=a.length,l=0;l<h;++l){u={Value:t,Value2:null};l<a.length&&(u.Value2=a[l]),r.push(u)}else if(!s&&o)for(h=t.length,l=0;l<h;++l){u={Value:null,Value2:a};l<t.length&&(u.Value=t[l]),r.push(u)}else if(s&&o)for(h=this.SymbolData.Data.Data.length,l=0;l<h;++l){u={Value:t,Value2:a};r.push(u)}}else for(var h=Math.max(t.length,a.length),l=0;l<h;++l){var u={Value:null,Value2:null};l<t.length&&(u.Value=t[l]),l<a.length&&(u.Value2=a[l]),r.push(u)}return n},this.GetDataByIndex=function(t,e){var a={Result:!1,Data:null};return this.IsNumber(t)?(a.Result=!0,a.Data=t):e<t.length?(a.Result=!0,a.Data=t[e]):a.Result=!1,a},this.FILLRGN=function(t,e,a){var i=[],r={DrawData:i,DrawType:"FILLRGN"};this.IsNumber(e),this.IsNumber(a);if(Array.isArray(t))for(var n in t){i[n]=null;var s=t[n];if(s){var o=this.GetDataByIndex(e,n);if(o.Result){var h=this.GetDataByIndex(a,n);if(h.Result){var l={Value:o.Data,Value2:h.Data};i[n]=l}}}}else if(t)for(n=0;n<this.SymbolData.Data.Data.length;++n){i[n]=null;o=this.GetDataByIndex(e,n);if(o.Result){h=this.GetDataByIndex(a,n);if(h.Result){l={Value:o.Data,Value2:h.Data};i[n]=l}}}return r},this.DRAWKLINE=function(t,e,a,i){for(var r=[],n={DrawData:r,DrawType:"DRAWKLINE"},s=Math.max(t.length,e.length,a.length,i.length),o=0;o<s;++o){var h={Open:null,High:null,Low:null,Close:null};o<t.length&&o<e.length&&o<a.length&&o<i.length&&(h.Open=e[o],h.High=t[o],h.Low=a[o],h.Close=i[o]),r[o]=h}return n},this.DRAWKLINE_IF=function(t,e,a,i,r){for(var n=[],s={DrawData:n,DrawType:"DRAWKLINE_IF"},o=Math.max(t.length,e.length,a.length,i.length,r.length),h=0;h<o;++h){var l={Open:null,High:null,Low:null,Close:null};h<e.length&&h<a.length&&h<i.length&&h<r.length&&h<t.length&&t[h]&&(l.Open=a[h],l.High=e[h],l.Low=i[h],l.Close=r[h]),n[h]=l}return s},this.DRAWCOLORKLINE=function(t,e,a){var i=[],r={DrawData:i,DrawType:"DRAWCOLORKLINE",IsEmptyBar:!(0==a),Color:e};if(Array.isArray(t))for(var n=0;n<t.length&&n<this.SymbolData.Data.Data.length;++n){i[n]=null;var s=t[n];if(s){var o=this.SymbolData.Data.Data[n];o&&(i[n]={Open:o.Open,High:o.High,Low:o.Low,Close:o.Close})}}else if(t)for(n=0;n<this.SymbolData.Data.Data.length;++n){i[n]=null;o=this.SymbolData.Data.Data[n];o&&(i[n]={Open:o.Open,High:o.High,Low:o.Low,Close:o.Close})}return r},this.POLYLINE=function(t,e){var a=[],i={DrawData:a,DrawType:"POLYLINE"},r="number"==typeof e,n=!1,s=!1;if(r)if(this.IsNumber(t)){if(t)for(var o=this.SymbolData.Data.Data.length,h=0;h<o;++h)a[h]=e}else{var l=!1;for(var h in t)if(a[h]=null,l)a[h]=e;else{if(!t[h])continue;l=!0,a[h]=e}}else{var u={Start:{},End:{},List:new Array};for(var C in t)if(a[C]=null,0==n&&0==s){if(null==t[C]||!t[C])continue;if(C>=e.length||!this.IsNumber(e[C]))continue;n=!0,u.Start={ID:parseInt(C),Value:e[C]}}else if(1==n&&0==s){if(null==t[C]||!t[C])continue;if(C>=e.length||!this.IsNumber(e[C]))continue;u.End={ID:parseInt(C),Value:e[C]};var D=this.CalculateDrawLine(u);for(var f in D){var c=D[f];a[c.ID]=c.Value}var d={ID:u.End.ID,Value:u.End.Value};u={Start:d,End:{}}}this.CalculateDrawDataExtendLine(a)}return i},this.CalculateDrawDataExtendLine=function(t,e){if(!(e<0)){var a=null,i=t.length;this.IsNumber(e)&&e<i&&(i=e);for(var r=i-1;r>=0;--r)if(this.IsNumber(t[r])){a=r;break}if(null!=a&&a-1>=0){var n=a-1;for(r=a+1;r<i;++r){var s=t[n],o=t[a],h=(s-o)*(r-n)/(a-n);if(s-h<0)break;t[r]=s-h}}}},this.DRAWNUMBER=function(t,e,a,i){var r={Value:[],Text:[]},n={DrawData:r,DrawType:"DRAWNUMBER"},s=2;ha.IsNumber(i)&&(s=i);var o={DataType:0,SingleValue:null,ArrayValue:null};Array.isArray(e)?(o.ArrayValue=e,o.DataType=2):("TOP"!==e&&"BOTTOM"!==e||(n.FixedPosition=e),o.SingleValue=e,o.DataType=1);var h={DataType:0,SingleValue:null,ArrayValue:null};if(Array.isArray(a)?(h.ArrayValue=a,h.DataType=2):(h.SingleValue=a,h.DataType=1,ha.IsNumber(a)&&(ha.IsInteger(a)?h.SingleValue=a.toString():text=a.toFixed(s))),Array.isArray(t))for(var l=0;l<t.length;++l)r.Value[l]=null,t[l]&&(r.Value[l]=this.DRAWNUMBER_Temp_PriceItem(l,o),r.Text[l]=this.DRAWNUMBER_Temp_NumberItem(l,h,s));else if(this.IsNumber(t)&&t)for(l=0;l<this.SymbolData.Data.Data.length;++l)r.Value[l]=this.DRAWNUMBER_Temp_PriceItem(l,o),r.Text[l]=this.DRAWNUMBER_Temp_NumberItem(l,h,s);return n},this.DRAWNUMBER_Temp_PriceItem=function(t,e){return e?1==e.DataType?e.SingleValue:ha.IsNonEmptyArray(e.ArrayValue)?e.ArrayValue[t]:null:null},this.DRAWNUMBER_Temp_NumberItem=function(t,e,a){if(!e)return null;if(1==e.DataType)return e.SingleValue;if(!ha.IsNonEmptyArray(e.ArrayValue))return null;var i=e.ArrayValue[t];return this.IsNumber(i)?ha.IsInteger(i)?i.toString():i.toFixed(a):i.toString()},this.DRAWNUMBER_FIX=function(t,e,a,i,r){var n={Value:[],Text:[]},s={DrawData:n,DrawType:"DRAWNUMBER_FIX",Position:{X:e,Y:a,Type:i}},o=ha.IsNumber(r);if(Array.isArray(t)){for(var h in t)if(n.Text[h]=null,n.Value[h]=null,t[h])if(o)n.Text[h]=this.RemoveZero(r.toFixed(2)),n.Value[h]=r;else{if(h>=r.length||!ha.IsNumber(r[h]))continue;var l=r[h];n.Text[h]=this.RemoveZero(l.toFixed(2)),n.Value[h]=l}}else if(t)for(h=0;h<this.SymbolData.Data.Data.length;++h)if(o)n.Text[h]=this.RemoveZero(r.toFixed(2)),n.Value[h]=r;else{if(h>=r.length||!ha.IsNumber(r[h]))continue;l=r[h];n.Text[h]=this.RemoveZero(l.toFixed(2)),n.Value[h]=l}else;return s},this.DRAWICON=function(t,e,a){if(ha.IsString(a)){var i=a.replace("ICO","");a=parseInt(i)}var r=sn.GetDrawIcon(a);r||sn.GetDrawTextIcon(a),r||(r={Symbol:"ð©"});var n=[],s={DrawData:n,DrawType:"DRAWICON",Icon:r,IconType:a};if(t.length<=0)return s;var o="number"==typeof e;if("number"==typeof t){if(!t)return s;for(var h=0;h<this.SymbolData.Data.Data.length;++h)o?n[h]=e:h<e.length&&this.IsNumber(e[h])?n[h]=e[h]:n[h]=null;return s}for(var h in t)n[h]=null,t[h]&&(o?n[h]=e:this.IsNumber(e[h])&&(n[h]=e[h]));return s},this.ICON=function(t,e){if(ha.IsString(e)){var a=e.replace("ICO","");e=parseInt(a)}var i=sn.GetDrawIcon(e);i||sn.GetDrawTextIcon(e),i||(i={Symbol:"ð©"});for(var r=[],n={DrawData:r,DrawType:"ICON",Icon:i},s=0;s<this.SymbolData.Data.Data.length;++s){var o=this.SymbolData.Data.Data[s];o&&(0==t?r[s]=o.Low:1==t&&(r[s]=o.High))}return n},this.DRAWCHANNEL=function(t,e,a,i,r,n,s){var o=[],h={DrawData:o,DrawType:"DRAWCHANNEL",Border:{}};if(t.length<=0)return h;if(i&&(h.Border.Color=i),s&&(h.AreaColor=s),r>0&&(h.Border.Width=r),n){var l=n.split(",");for(var u in h.Border.Dotted=[],l){var C=l[u];if(C){var D=parseInt(l[u]);D<=0||h.Border.Dotted.push(D)}}h.Border.Dotted.length<=0&&(h.Border.Dotted=null)}var f="number"==typeof e,c="number"==typeof a;if("number"==typeof t){if(!t)return h;for(u=0;u<this.SymbolData.Data.Data.length;++u)if(o[u]=null,f&&c)o[u]={Value:e,Value2:a};else if(f&&!c){if(isNaN(a[u]))continue;o[u]={Value:e,Value2:a[u]}}else if(!f&&c){if(isNaN(e[u]))continue;o[u]={Value:e[u],Value2:a}}else{if(isNaN(e[u])||isNaN(a[u]))continue;o[u]={Value:e[u],Value2:a[u]}}}else for(u=0;u<t.length;++u)if(o[u]=null,!isNaN(t[u])&&t[u])if(f&&c)o[u]={Value:e,Value2:a};else if(f&&!c){if(isNaN(a[u]))continue;o[u]={Value:e,Value2:a[u]}}else if(!f&&c){if(isNaN(e[u]))continue;o[u]={Value:e[u],Value2:a}}else{if(isNaN(e[u])||isNaN(a[u]))continue;o[u]={Value:e[u],Value2:a[u]}}return h},this.RGB=function(t,e,a){var i="RGB("+t+","+e+","+a+")";return i},this.RGBA=function(t,e,a,i){var r="RGB("+t+","+e+","+a+","+i+")";return r},this.SOUND=function(t){return{Name:"SOUND",Value:t}},this.PLAYSOUND=function(t,e){return null},this.PARTLINE=function(t){var e=[],a={DrawData:e,DrawType:"PARTLINE"};if(t.length<3)return a;for(var i=t[0],r=[],n=1;n<t.length&&n+1<t.length;n+=2)r.push({Cond:t[n],RGB:t[n+1]});for(var n in i){var s={Value:null,RGB:null};e[n]=s;var o=i[n];if(this.IsNumber(o)){var h=null;for(var l in r){var u=r[l];if(Array.isArray(u.Cond)){if(n<u.Cond.length&&u.Cond[n]){h=u.RGB;break}}else if(this.IsNumber(u.Cond)&&u.Cond){h=u.RGB;break}}h&&(s.Value=o,s.RGB=h)}}return a},this.FILLRGN2=function(t){var e=[],a={DrawData:e,DrawType:"FILLRGN2"};if(t.length<4)return a;for(var i=t[0],r=t[1],n=[],s=2;s<t.length&&s+1<t.length;s+=2)n.push({Cond:t[s],Color:t[s+1]});for(s=0;s<this.SymbolData.Data.Data.length;++s){e[s]=null;var o={Value:null,Value2:null,Color:null};for(var h in n){var l=n[h];if(Array.isArray(l.Cond)){if(s<l.Cond.length&&l.Cond[s]){o.Color=l.Color;break}}else if(this.IsNumber(l.Cond)&&l.Cond){o.Color=l.Color;break}}if(o.Color){if(Array.isArray(i)){if(s>=i.length)continue;if(!this.IsNumber(i[s]))continue;o.Value=i[s]}else{if(!this.IsNumber(i))continue;o.Value=i}if(Array.isArray(r)){if(s>=r.length)continue;if(!this.IsNumber(r[s]))continue;o.Value2=r[s]}else{if(!this.IsNumber(r))continue;o.Value2=r}e[s]=o}}return a},this.FLOATRGN=function(t){var e=[],a={DrawData:e,DrawType:"FLOATRGN"};if(t.length<4)return a;for(var i=t[0],r=t[1],n=[],s=2;s<t.length&&s+1<t.length;s+=2)n.push({Cond:t[s],Color:t[s+1]});for(s=0;s<this.SymbolData.Data.Data.length;++s){e[s]=null;var o={Value:null,Value2:null,Color:null};for(var h in n){var l=n[h];if(Array.isArray(l.Cond)){if(s<l.Cond.length&&l.Cond[s]){o.Color=l.Color;break}}else if(this.IsNumber(l.Cond)&&l.Cond){o.Color=l.Color;break}}if(o.Color){if(Array.isArray(i)){if(s>=i.length)continue;if(!this.IsNumber(i[s]))continue;o.Value=i[s]}else{if(!this.IsNumber(i))continue;o.Value=i}if(Array.isArray(r)){if(s>=r.length)continue;if(!this.IsNumber(r[s]))continue;o.Value2=r[s]}else{if(!this.IsNumber(r))continue;o.Value2=r}e[s]=o}}return a},this.FILLBGRGN=function(t,e){var a=[],i={DrawData:a,DrawType:1==t?"FILLTOPRGN":"FILLBOTTOMRGN"};if(e.length<3)return i;for(var r=e[0],n=[],s=1;s<e.length&&s+1<e.length;s+=2)n.push({Cond:e[s],Color:e[s+1]});for(s=0;s<this.SymbolData.Data.Data.length;++s){a[s]=null;var o={Value:null,Color:null};for(var h in n){var l=n[h];if(Array.isArray(l.Cond)){if(s<l.Cond.length&&l.Cond[s]){o.Color=l.Color;break}}else if(this.IsNumber(l.Cond)&&l.Cond){o.Color=l.Color;break}}if(o.Color){if(Array.isArray(r)){if(s>=r.length)continue;if(!this.IsNumber(r[s]))continue;o.Value=r[s]}else{if(!this.IsNumber(r))continue;o.Value=r}a[s]=o}}return i},this.FILLVERTICALRGN=function(t){var e=[],a={DrawData:e,DrawType:"FILLVERTICALRGN"};if(t.length<2)return a;for(var i=[],r=0;r<t.length&&r+1<t.length;r+=2)i.push({Cond:t[r],Color:t[r+1]});for(r=0;r<this.SymbolData.Data.Data.length;++r){e[r]=null;var n={Color:null};for(var s in i){var o=i[s];if(Array.isArray(o.Cond)){if(r<o.Cond.length&&o.Cond[r]){n.Color=o.Color;break}}else if(this.IsNumber(o.Cond)&&o.Cond){n.Color=o.Color;break}}n.Color&&(e[r]=n)}return a},this.DRAWGBK=function(t,e,a,i){var r={Color:[],Angle:i};e&&r.Color.push(e),a&&r.Color.push(a);var n={DrawData:null,DrawType:"DRAWGBK"};if(Array.isArray(t))for(var s in t){var o=t[s];if(o){n.DrawData=r;break}}else t&&(n.DrawData=r);return n},this.DRAWGBK2=function(t,e,a,i){var r={Color:[],Angle:i};e&&r.Color.push(e),a&&r.Color.push(a);var n={DrawData:null,DrawType:"DRAWGBK2"};if(Array.isArray(t)){for(var s in r.Data=[],t){var o=t[s];r.Data[s]=o?1:0}n.DrawData=r}else t&&(n.DrawData=r,n.DrawType="DRAWGBK");return n},this.DRAWTEXT_LINE=function(t,e,a,i,r,n,s){var o={Text:{Title:a,Color:i},Line:{Type:n,Color:s}};r<=0&&(r=12),o.Text.Font=r*U()+"px å¾®è½¯éé»";var h={DrawData:null,DrawType:"DRAWTEXT_LINE"};if(Array.isArray(t))for(var l in t){var u=t[l];if(u){Array.isArray(e)?o.Price=e[l]:o.Price=e,h.DrawData=o;break}}else t&&(Array.isArray(e)?o.Price=e[0]:o.Price=e,h.DrawData=o);return h},this.DRAWRECTREL=function(t,e,a,i,r){var n={Rect:{Left:Math.min(t,a),Top:Math.min(e,i),Right:Math.max(a,t),Bottom:Math.max(i,e)},Color:r};0==r&&(n.Color=null);var s={DrawData:n,DrawType:"DRAWRECTREL"};return s},this.DRAWTEXTREL=function(t,e,a){var i={Point:{X:t,Y:e}};ha.IsString(a)?i.Text=a:ha.IsNonEmptyArray(a)&&(i.Text=a[0]);var r={DrawData:i,DrawType:"DRAWTEXTREL"};return r},this.DRAWTEXTABS=function(t,e,a){var i={Point:{X:t,Y:e}};ha.IsString(a)?i.Text=a:ha.IsNonEmptyArray(a)&&(i.Text=a[0]);var r={DrawData:i,DrawType:"DRAWTEXTABS"};return r},this.DRAWOVERLAYLINE=function(t,e,a){var i={Data:t,MainData:e};a&&"string"==typeof a&&(i.Title=a);var r={DrawData:i,DrawType:"DRAWOVERLAYLINE"};return r},this.DRAWSL=function(t,e,a,i,r){var n={Data:[],Option:[]},s={DrawData:n,DrawType:"DRAWSL"},o=this.IsNumber(e);if(Array.isArray(t))for(var h in t)n[h]=null,t[h]&&(o?(n.Data[h]=e,n.Option[h]={Slope:a,Length:i,Direct:r}):h<e.length&&this.IsNumber(e[h])&&(n.Data[h]=e[h],n.Option[h]={Slope:a,Length:i,Direct:r}));else if(t){var l=this.SymbolData.Data.Data.length;for(h=0;h<l;++h)n[h]=null,o?(n.Data[h]=e,n.Option[h]={Slope:a,Length:i,Direct:r}):h<e.length&&this.IsNumber(e[h])&&(n.Data[h]=e[h],n.Option[h]={Slope:a,Length:i,Direct:r})}return s},this.VERTLINE=function(t,e){var a={Data:[],LineType:e},i={DrawData:a,DrawType:"VERTLINE"};if(Array.isArray(t))for(var r=0;r<t.length;++r){var n=t[r];a.Data[r]=n?1:0}return i},this.HORLINE=function(t,e,a,i){var r={Data:[],LineType:a,Extend:i},n={DrawData:r,DrawType:"HORLINE"};if(Array.isArray(t)&&Array.isArray(e))for(var s=0;s<t.length;++s){var o=t[s];if(r.Data[s]=null,o&&!(s>=e.length)){var h=e[s];ha.IsNumber(h)&&(r.Data[s]=h)}}else if(Array.isArray(t)&&ha.IsNumber(e))for(s=0;s<t.length;++s){o=t[s];r.Data[s]=null,o&&(r.Data[s]=e)}else if(ha.IsNumber(t)&&t&&this.SymbolData&&this.SymbolData.Data&&this.SymbolData.Data.Data)if(Array.isArray(e)){var l=this.SymbolData.Data.Data.length;for(s=0;s<l;++s)if(r.Data[s]=null,!(s>=e.length)){h=e[s];ha.IsNumber(h)&&(r.Data[s]=h)}}else if(ha.IsNumber(e))for(l=this.SymbolData.Data.Data.length,s=0;s<l;++s)r.Data[s]=e;return n},this.BACKGROUND=function(t,e,a,i,r,n){var s={Margin:[0,1,1,1]};return t&&(s.Color=t),e&&(s.Border=e),ha.IsNumber(a)&&(s.Margin[2]=a),ha.IsNumber(i)&&(s.Margin[3]=i),ha.IsNumber(r)&&(s.Margin[0]=r),ha.IsNumber(n)&&(s.Margin[1]=n),s},this.CKLINE=function(t,e,a,i){var r={Color:t,LineWidth:1,LineType:0,LineDot:[3,3]};if(ha.IsPlusNumber(e)&&(r.LineWidth=e),ha.IsPlusNumber(a)&&(r.LineType=a),i){var n=i.split(","),s=[];for(var o in n){var h=n[o];if(h){var l=parseInt(n[o]);l<=0||s.push(l)}}s.length>0&&(r.LineDotted=s)}r.Data=[];for(o=0;o<this.SymbolData.Data.Data.length;++o){h=this.SymbolData.Data.Data[o];r.Data[o]={High:h.High,Low:h.Low}}return r}}Sn.prototype.IsNumber=function(t){return null!=t&&!isNaN(t)},Sn.prototype.IsDivideNumber=function(t){return null!=t&&(!isNaN(t)&&0!=t)},Sn.MOD=function(t,e){if(t<0&&e<0||t>=0&&e>=0){if(parseInt(t)==t&&parseInt(e)==e)return t%e;var a=parseFloat((t-Math.floor(t/e)*e).toFixed(1));return a}var i=Math.abs(t),r=Math.abs(e);a=Math.abs(Math.abs(e)*(Math.floor(i/r)+1)-Math.abs(t));return e<0&&(a=-a),a},In.prototype.CalculateDrawLine=function(t){t.List=[];for(var e=t.Start.ID;e<=t.End.ID;++e)t.List.push(e);var a=Math.abs(t.Start.Value-t.End.Value),i=t.List.length-1,r=[];if(r.push({ID:t.Start.ID,Value:t.Start.Value}),t.Start.Value>t.End.Value)for(var n=1;n<t.List.length-1;++n){var s=a*(t.List.length-1-n)/i+t.End.Value;r.push({ID:t.List[n],Value:s})}else for(var o=1;o<t.List.length-1;++o){s=a*o/i+t.Start.Value;r.push({ID:t.List[o],Value:s})}return r.push({ID:t.End.ID,Value:t.End.Value}),r},In.prototype.IsNumber=function(t){return null!=t&&!isNaN(t)},In.prototype.IsDrawFunction=function(t){var e=new I.default(["STICKLINE","DRAWTEXT","SUPERDRAWTEXT","DRAWLINE","DRAWBAND","DRAWKLINE","DRAWKLINE1","DRAWKLINE_IF","DRAWCOLORKLINE","PLOYLINE","POLYLINE","DRAWNUMBER","DRAWNUMBER_FIX","DRAWICON","DRAWCHANNEL","PARTLINE","DRAWTEXT_FIX","DRAWGBK","DRAWTEXT_LINE","DRAWRECTREL","DRAWTEXTABS","DRAWTEXTREL","DRAWOVERLAYLINE","FILLRGN","FILLRGN2","FILLTOPRGN","FILLBOTTOMRGN","FILLVERTICALRGN","FLOATRGN","DRAWSL","DRAWGBK2","VERTLINE","HORLINE"]);return!!e.has(t)},In.prototype.RemoveZero=function(t){while(t.length>0){var e=t.length-1,a=t[e];if("0"!=a){if("."==a){t=t.substr(0,e);break}break}t=t.substr(0,e)}return t};var pn={YCLOSE:3,OPEN:4,HIGH:5,LOW:6,CLOSE:7,VOL:8,AMOUNT:10,AMPLITUDE:13,INCREASE:14,EXCHANGERATE:37};function Tn(t,e,a){this.AST=t,this.Execute=a,this.Symbol="600000.sh",this.Name,this.Data=null,this.PeriodData=new E.default,this.IsApiPeriod=!1,this.SourceData=null,this.MarketValue=null,this.Period=0,this.Right=0,this.DataType=0,this.IsBeforeData=!1,this.DayCount,this.Arguments=[],this.KLineApiUrl=sn.Domain+"/API/KLine2",this.MinuteKLineApiUrl=sn.Domain+"/API/KLine3",this.RealtimeApiUrl=sn.Domain+"/API/stock",this.HistoryMinuteApiUrl=Oi.Domain+"/API/StockMinuteData",this.StockHistoryDayApiUrl=sn.Domain+"/API/StockHistoryDay",this.StockHistoryDay3ApiUrl=sn.Domain+"/API/StockHistoryDay3",this.StockHistoryDay2ApiUrl=sn.Domain+"/API/StockHistoryDay2",this.StockNewsAnalysisApiUrl=sn.CacheDomain+"/cache/newsanalyze",this.HKToSHSZApiUrl=[sn.CacheDomain+"/cache/historyday/all/hk2shsz.json",sn.CacheDomain+"/cache/analyze/hk2shsz/hk2shsz.json",sn.Domain+"/API/HKToSHSZMinuteData",sn.CacheDomain+"/cache/analyze/hk2szshanalyze"],this.MaxRequestDataCount=1e3,this.MaxRequestMinuteDayCount=5,this.KLineDateTimeRange,this.LatestData=new E.default,this.IndexData,this.LatestIndexData,this.MarginData=new E.default,this.HKToSHSZData=new E.default,this.NewsAnalysisData=new E.default,this.ExtendData=new E.default,this.UserData=new E.default,this.CustomAPIData=new E.default,this.ScriptIndexOutData=new E.default,this.OtherSymbolData=new E.default,this.StockData=new E.default,this.SectionFinanceData=new E.default,this.ThrowSFPeirod=new I.default,this.NetworkFilter,this.DrawInfo,e&&(e.HQDataType&&(this.DataType=e.HQDataType),e.Data&&(this.Data=e.Data,this.DataType!=En.MINUTE_ID&&this.DataType!=En.MULTIDAY_MINUTE_ID&&this.DataType!=En.HISTORY_MINUTE_ID&&(this.Period=e.Data.Period,this.Right=e.Data.Right)),e.SourceData&&(this.SourceData=e.SourceData),e.Symbol&&(this.Symbol=e.Symbol),e.Name&&(this.Name=e.Name),e.MaxRequestDataCount>0&&(this.MaxRequestDataCount=e.MaxRequestDataCount),e.MaxRequestMinuteDayCount>0&&(this.MaxRequestMinuteDayCount=e.MaxRequestMinuteDayCount),e.KLineApiUrl&&(this.KLineApiUrl=e.KLineApiUrl),e.Right&&(this.Right=e.Right),e.Period&&(this.Period=e.Period),!0===e.IsBeforeData&&(this.IsBeforeData=e.IsBeforeData),e.NetworkFilter&&(this.NetworkFilter=e.NetworkFilter),e.DayCount>0&&(this.DayCount=e.DayCount),e.Arguments&&(this.Arguments=e.Arguments),e.KLineRange&&(this.KLineDateTimeRange=e.KLineRange),e.IsApiPeriod&&(this.IsApiPeriod=e.IsApiPeriod),e.DrawInfo&&(this.DrawInfo=e.DrawInfo)),this.RecvError=function(t){throw w.Complier.Log("[JSSymbolData::RecvError] ajax error.",t.status),{FunctionName:"RecvError",Request:t}},this.GetLatestDataKey=function(t){t="DYNAINFO-"+t;return t},this.GetLatestData=function(t){var e=this.JobArgumentsToArray(t,1),a=e[0],i=this.GetLatestDataKey(a);if(this.LatestData.has(i))return this.Execute.RunNextJob();var r=this;if(this.NetworkFilter){var n={Name:"JSSymbolData::GetLatestData",Explain:"DYNAINFO()",Args:e,Request:{Url:r.RealtimeApiUrl,Type:"POST",Data:{symbol:[this.Symbol],field:["name","symbol","yclose","open","price","high","low","vol","amount","date","time","increase","exchangerate","amplitude"]}},Self:this,PreventDefault:!1};if(this.NetworkFilter(n,(function(t){r.RecvLatestData(t),r.Execute.RunNextJob()})),1==n.PreventDefault)return}O.HttpRequest({url:r.RealtimeApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol","amount","date","time","increase","exchangerate","amplitude"],symbol:[this.Symbol]},type:"post",dataType:"json",async:!0,success:function(t){r.RecvLatestData(t),r.Execute.RunNextJob()},error:function(t){r.RecvError(t)}})},this.RecvLatestData=function(t){if(2!=t.ver){if(t.stock&&1==t.stock.length){var e=t.stock[0];e&&(ha.IsNumber(e.yclose)&&this.LatestData.set(pn.YCLOSE,e.yclose),ha.IsNumber(e.open)&&this.LatestData.set(pn.OPEN,e.open),ha.IsNumber(e.high)&&this.LatestData.set(pn.HIGH,e.high),ha.IsNumber(e.low)&&this.LatestData.set(pn.LOW,e.low),ha.IsNumber(e.price)&&this.LatestData.set(pn.CLOSE,e.price),ha.IsNumber(e.vol)&&this.LatestData.set(pn.VOL,e.vol),ha.IsNumber(e.amount)&&this.LatestData.set(pn.AMOUNT,e.amount),ha.IsNumber(e.increase)&&this.LatestData.set(pn.INCREASE,e.increase),ha.IsNumber(e.exchangerate)&&this.LatestData.set(pn.EXCHANGERATE,e.exchangerate),ha.IsNumber(e.amplitude)&&this.LatestData.set(pn.AMPLITUDE,e.amplitude),w.Complier.Log("[JSSymbolData::RecvLatestData] symbol, LatestData",e.symbol,this.LatestData))}}else this.RecvLatestDataVer2(t)},this.RecvLatestDataVer2=function(t){if(ha.IsNonEmptyArray(t.data)){for(var e=t.symbol,a=0;a<t.data.length;++a){var i=t.data[a];i&&(ha.IsNumber(i.id)&&(ha.IsNumber(i.value)||ha.IsString(i.value))&&(w.Complier.Log("[JSSymbolData::RecvLatestDataVer2] symbol="+e+" DYNAINFO("+i.id+")="+i.value+"."),this.LatestData.set(i.id,i.value)))}w.Complier.Log("[JSSymbolData::RecvLatestDataVer2]",this.LatestData)}},this.GetLatestCacheData=function(t){return this.LatestData.has(t)?this.LatestData.get(t):null},this.GetLatestIndexData=function(){if(this.LatestIndexData)return this.Execute.RunNextJob();var t=this;if(this.NetworkFilter){var e={Name:"JSSymbolData::GetLatestIndexData",Explain:"ææ°å¤§çæ°æ®",Request:{Url:t.RealtimeApiUrl,Type:"POST",Data:{symbol:["000001.sh"],field:["name","symbol","yclose","open","price","high","low","vol","amount","date","time","increase","amplitude"]}},Self:this,PreventDefault:!1};if(this.NetworkFilter(e,(function(e){t.RecvLatestIndexData(e),t.Execute.RunNextJob()})),1==e.PreventDefault)return}O.HttpRequest({url:t.RealtimeApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol","amount","date","time","increase","amplitude"],symbol:["000001.sh"]},type:"post",dataType:"json",async:!0,success:function(e){t.RecvLatestIndexData(e),t.Execute.RunNextJob()},error:function(e){t.RecvError(e)}})},this.RecvLatestIndexData=function(t){if(t.stock&&1==t.stock.length){var e=t.stock[0];this.LatestIndexData={Symbol:e.symbol,Name:e.name,Date:e.date,Time:e.time,YClose:e.yclose,Price:e.price,Open:e.open,High:e.high,Low:e.low,Vol:e.vol,Amount:e.amount,Increase:e.increase,Amplitude:e.amplitude},w.Complier.Log("[JSSymbolData::RecvLatestIndexData]",this.LatestIndexData)}},this.GetLatestIndexCacheData=function(t){if(!this.LatestIndexData)return null;switch(t){case"FROMOPEN":var e=parseInt(this.LatestIndexData.Time/100),a=60*parseInt(e/100)+e%100,i=0;return i=a<=565?0:a<570?1:a<=690?a-570+1:a<780?121:a<=900?122+a-780:242,i;default:return null}},this.GetVolRateData=function(t,e){var a=t.ID.toString()+"-VolRate-"+this.Symbol;if(this.ExtendData.has(a))return this.Execute.RunNextJob();var i=this,r=30;if(this.NetworkFilter){var n=this.Data.GetDateRange();r=1;this.DataType==En.MULTIDAY_MINUTE_ID&&(r=this.DayCount);var s={Name:"JSSymbolData::GetVolRateData",Explain:"åæ¶éæ¯æ°æ®(æäº¤é)",Request:{Url:i.KLineApiUrl,Type:"POST",Data:{symbol:i.Symbol,dayCount:r,field:["name","symbol","vol"],period:0,right:0,dateRange:n}},Self:this,PreventDefault:!1};if(this.NetworkFilter(s,(function(t){i.RecvVolRateData(t,a),i.Execute.RunNextJob()})),1==s.PreventDefault)return}O.HttpRequest({url:i.KLineApiUrl,data:{field:["name","symbol","vol"],symbol:i.Symbol,start:-1,count:r},type:"post",dataType:"json",async:!0,success:function(t){i.RecvVolRateData(t,a),i.Execute.RunNextJob()},error:function(t){i.RecvError(t)}})},this.RecvVolRateData=function(t,e){var a=0,i=0,r=new E.default;if(2==t.Ver){if(!ha.IsNonEmptyArray(t.data))return;for(var n=0;n<t.data.length;++n){var s=t.data[n];ha.IsNonEmptyArray(s)&&(s.length<2||ha.IsNumber(s[0])&&ha.IsPlusNumber(s[1])&&r.set(s[0],{AvgVol5:s[1]}))}}else{if(!ha.IsNonEmptyArray(t.data))return;var o=241;ha.IsNumber(t.minutecount)&&(o=t.minutecount);n=0;for(var h=0,l=0;n<t.data.length;++n){for(a=0,h=n,l=0;h>=0&&l<5;--h,++l){s=t.data[h];ha.IsNumber(s[6])&&(a+=s[6])}if(l>0){i=a/l/o;s=t.data[n];r.set(s[0],{AvgVol5:i})}}}r.size>0&&this.ExtendData.set(e,r),w.Complier.Log("[JSSymbolData::RecvVolRateData]",r)},this.GetVolRateCacheData=function(t){var e=xn.JOB_DOWNLOAD_VOLR_DATA.toString()+"-VolRate-"+this.Symbol;e&&this.ExtendData.has(e)||this.Execute.ThrowUnexpectedNode(t,"ä¸æ¯æVOLR");for(var a=[],i=this.ExtendData.get(e),r=0,n=0,s=null,o=0,h=0;o<this.Data.Data.length;++o){a[o]=null;var l=this.Data.Data[o];if(n!=l.Date){if(s=null,h=0,r=0,i.has(l.Date)){var u=i.get(l.Date);s=u.AvgVol5}n=l.Date}null!=s&&(r+=l.Vol,a[o]=r/(h+1)/s*100,++h)}return a},this.GetIndexData=function(){if(this.IndexData)return this.Execute.RunNextJob();var t=this;if(Ot.IsDayPeriod(this.Period,!0)){if(this.NetworkFilter){var e=this.Data.GetDateRange(),a={Name:"JSSymbolData::GetIndexData",Explain:"å¤§çæ°æ®",Period:t.Period,Request:{Url:t.KLineApiUrl,Type:"POST",Data:{field:["name","symbol","yclose","open","price","high","low","vol","up","down","stop","unchanged"],indexSymbol:"000001.sh",symbol:this.Symbol,period:this.Period,dateRange:e}},Self:this,PreventDefault:!1};if(this.NetworkFilter(a,(function(e){t.RecvIndexHistroyData(e),t.Execute.RunNextJob()})),1==a.PreventDefault)return}O.HttpRequest({url:t.KLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol","up","down","stop","unchanged"],symbol:"000001.sh",start:-1,count:t.MaxRequestDataCount+500},type:"post",dataType:"json",async:!0,success:function(e){t.RecvIndexHistroyData(e),t.Execute.RunNextJob()},error:function(e){t.RecvError(e)}})}else if(Ot.IsMinutePeriod(this.Period,!0)){if(this.NetworkFilter){e=this.Data.GetDateRange(),a={Name:"JSSymbolData::GetIndexData",Explain:"å¤§çæ°æ®",Period:t.Period,Request:{Url:t.MinuteKLineApiUrl,Type:"POST",Data:{field:["name","symbol","yclose","open","price","high","low","vol"],indexSymbol:"000001.sh",symbol:this.Symbol,period:this.Period,dateRange:e}},Self:this,PreventDefault:!1};if(this.NetworkFilter(a,(function(e){t.RecvIndexMinuteHistroyData(e),t.Execute.RunNextJob()})),1==a.PreventDefault)return}O.HttpRequest({url:t.MinuteKLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:"000001.sh",start:-1,count:t.MaxRequestMinuteDayCount+5},type:"post",dataType:"json",async:!0,success:function(e){t.RecvIndexMinuteHistroyData(e),t.Execute.RunNextJob()},error:function(e){t.RecvError(e)}})}},this.RecvIndexHistroyData=function(t){w.Complier.Log("[JSSymbolData::RecvIndexHistroyData] recv data",t);var e=this.JsonDataToHistoryData(t);if(this.IndexData=new Ot,this.IndexData.DataType=0,this.IndexData.Data=e,1==this.IsApiPeriod)this.IndexData.Period=this.Period,this.IndexData.Data=this.Data.FixKData(e,this.Period);else{var a=this.SourceData.GetOverlayData(this.IndexData.Data);if(this.IndexData.Data=a,Ot.IsDayPeriod(this.Period,!1)){var i=this.IndexData.GetPeriodData(this.Period);this.IndexData.Data=i}}},this.RecvIndexMinuteHistroyData=function(t){w.Complier.Log("[JSSymbolData::RecvIndexMinuteHistroyData] recv data",t);var e=this.JsonDataToMinuteHistoryData(t);if(this.IndexData=new Ot,this.IndexData.DataType=1,this.IndexData.Data=e,1==this.IsApiPeriod)this.IndexData.Period=this.Period,this.IndexData.Data=this.Data.FixKData(e,this.Period);else if(Ot.IsMinutePeriod(this.Period,!1)){var a=this.IndexData.GetPeriodData(this.Period);this.IndexData.Data=a}},this.GetOtherSymbolParam=function(t){var e=t.split("$"),a=new I.default(["CLOSE","C","VOL","V","OPEN","O","HIGH","H","LOW","L","AMOUNT","AMO","VOLINSTK"]);if(!a.has(e[1]))return null;var i=e[0];if(6==i.length)"6"==i[0]||"5"==i[0]||"8"==i[0]||"9"==i[0]?i+=".SH":"0"!=i[0]&&"1"!=i[0]&&"2"!=i[0]&&"3"!=i[0]||(i+=".SZ");else if(0==i.indexOf("SZ"))i=i.substr(2)+".SZ";else if(0==i.indexOf("SH"))i=i.substr(2)+".SH";else{if(!(i.indexOf("_")>0))return null;var r=i.split("_");i=r[1]+"."+r[0]}return{Symbol:i.toLowerCase(),DataName:e[1]}},this.GetOtherSymbolData=function(t){var e=this.Symbol;if(t.Literal){var a=this.GetOtherSymbolParam(t.Literal.toUpperCase());if(!a){var i=t.Token;this.Execute.ErrorHandler.ThrowError(i.Index,i.Line,0,t.Literal+" Error.")}e=a.Symbol}else{a=t.Args;if(a.length>0){var r=a[0];if(r.Type==dn.Literal)e=r.Value;else if(r.Type==dn.Identifier){var n=!1;for(var s in this.Arguments){var o=this.Arguments[s];if(o.Name==r.Name){e=o.Value,n=!0;break}}if(!n){i=t.Token;this.Execute.ErrorHandler.ThrowError(i.Index,i.Line,0,t.FunctionName+"() Error: can't read "+r.Name)}}}}if(t.Symbol=e.toLowerCase(),t.Symbol==this.Symbol)return this.Execute.RunNextJob();if(this.OtherSymbolData.has(t.Symbol))return this.Execute.RunNextJob();var h=this;if(this.DataType==En.KLINE_ID&&Ot.IsDayPeriod(this.Period,!0)){if(this.NetworkFilter){var l=this.Data.GetDateRange(),u={Name:"JSSymbolData::GetOtherSymbolData",Explain:"æå®ä¸ªè¡æ°æ®",Request:{Data:{symbol:t.Symbol,right:h.Right,period:h.Period,dateRange:l}},Self:this,PreventDefault:!1};if(this.NetworkFilter(u,(function(e){h.RecvOtherSymbolKData(e,t),h.Execute.RunNextJob()})),1==u.PreventDefault)return}O.HttpRequest({url:h.KLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,start:-1,count:h.MaxRequestDataCount+500},type:"post",dataType:"json",async:!0,success:function(e){h.RecvOtherSymbolKDayData(e,t),h.Execute.RunNextJob()},error:function(t){h.RecvError(t)}})}else if(Ot.IsMinutePeriod(this.Period,!0)||this.DataType==En.MINUTE_ID||this.DataType==En.MULTIDAY_MINUTE_ID){if(this.NetworkFilter){l=this.Data.GetDateRange(),u={Name:"JSSymbolData::GetOtherSymbolData",Explain:"æå®ä¸ªè¡æ°æ®",Request:{Data:{symbol:t.Symbol,right:h.Right,period:h.Period,dateRange:l}},Self:this,PreventDefault:!1};if(this.NetworkFilter(u,(function(e){h.RecvOtherSymbolKData(e,t),h.Execute.RunNextJob()})),1==u.PreventDefault)return}O.HttpRequest({url:h.MinuteKLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,start:-1,count:h.MaxRequestMinuteDayCount+5},type:"post",dataType:"json",async:!0,success:function(e){h.RecvOtherSymbolKMinuteData(e,t),h.Execute.RunNextJob()},error:function(t){h.RecvError(t)}})}},this.RecvOtherSymbolKData=function(t,e){w.Complier.Log("[JSSymbolData::RecvOtherSymbolKData] recv data",t);var a=new Ot,i=null,r=this.Period;this.DataType==En.KLINE_ID&&Ot.IsDayPeriod(this.Period,!0)?(i=this.JsonDataToHistoryData(t),a.DataType=0):(i=this.JsonDataToMinuteHistoryData(t),a.DataType=1,this.DataType!=En.MINUTE_ID&&this.DataType!=En.MULTIDAY_MINUTE_ID||(r=4)),a.Period=this.Period,a.Right=this.Right,a.Data=this.Data.FixKData(i,r),this.OtherSymbolData.set(e.Symbol,a)},this.RecvOtherSymbolKDayData=function(t,e){w.Complier.Log("[JSSymbolData::RecvOtherSymbolKDayData] recv data",t);var a=this.JsonDataToHistoryData(t),i=new Ot;i.DataType=0,i.Data=a;var r=this.SourceData.GetOverlayData(i.Data);if(i.Data=r,Ot.IsDayPeriod(this.Period,!1)){var n=i.GetPeriodData(this.Period);i.Data=n}this.OtherSymbolData.set(e.Symbol,i)},this.RecvOtherSymbolKMinuteData=function(t,e){w.Complier.Log("[JSSymbolData::RecvOtherSymbolKMinuteData] recv data",t);var a=this.JsonDataToMinuteHistoryData(t),i=new Ot;if(i.DataType=1,i.Data=a,Ot.IsMinutePeriod(this.Period,!1)){var r=i.GetPeriodData(this.Period);i.Data=r}this.OtherSymbolData.set(e.Symbol,i)},this.GetOtherSymolCacheData=function(t){var e,a;if(t.FunctionName){a=t.FunctionName;var i=t.Args;if(i.length<=0)return this.GetSymbolCacheData(a);e=i[0].toString().toLowerCase()}else if(t.Literal){i=this.GetOtherSymbolParam(t.Literal.toUpperCase());if(!i)return[];e=i.Symbol,a=i.DataName}if(e==this.Symbol)return this.GetSymbolCacheData(a);if(!this.OtherSymbolData.has(e))return[];var r=this.OtherSymbolData.get(e),n=e.toUpperCase();switch(a){case"CLOSE":case"C":return r.GetClose();case"VOL":case"V":return Br.IsSHSZ(n)?r.GetVol(100):r.GetVol();case"OPEN":case"O":return r.GetOpen();case"HIGH":case"H":return r.GetHigh();case"LOW":case"L":return r.GetLow();case"AMOUNT":case"AMO":return r.GetAmount();case"VOLINSTK":return r.GetPosition()}},this.GetIndexCacheData=function(t){if(!this.IndexData)return new Array;switch(t){case"INDEXA":return this.IndexData.GetAmount();case"INDEXC":return this.IndexData.GetClose();case"INDEXH":return this.IndexData.GetHigh();case"INDEXL":return this.IndexData.GetLow();case"INDEXO":return this.IndexData.GetOpen();case"INDEXV":return this.IndexData.GetVol();case"INDEXADV":return this.IndexData.GetUp();case"INDEXDEC":return this.IndexData.GetDown()}},this.GetBlockSymbol=function(t){var e=new E.default([["æ²ªæ·±Aè¡","CNA.ci"],["åä¸æ¿","GEM.ci"],["æ²ªå¸Aè¡","SHA.ci"],["ä¸­å°æ¿","SME.ci"],["æ·±å¸Aè¡","SZA.ci"]]);if(e.has(t))return e.get(t);if(!t)return null;var a=null,i=t.toUpperCase();if(i.indexOf(".SH")>0||i.indexOf(".SZ")>0){var r=new I.default(["000001.SH","000003.SH","000016.SH","000300.SH","000905.SH","399001.SZ"," 399005.SZ","399006.SZ"]);if(!r.has(i))return null;a=t.replace(".SH",".sh"),a=t.replace(".SZ",".sz")}else t.indexOf(".CI")>0&&(a=t.replace(".CI",".ci"));return a},this.GetIndexIncreaseData=function(t){var e=null;if(t.IsSelfSymbol)e=this.Symbol;else{if(!t.Args||t.Args.length<=0){var a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,t.FunctionName+" Error: åæ°ä¸è½ä¸ºç©º")}e=t.Args[0].Value}var i=this.GetBlockSymbol(e);if(!i){a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,t.FunctionName+" Error: can't support "+e)}var r=t.ID.toString()+"-UpCount-"+i,n=t.ID.toString()+"-DownCount-"+i;if(this.ExtendData.has(r)&&this.ExtendData.has(n))return this.Execute.RunNextJob();var s=this;if(this.NetworkFilter){var o={Type:this.DataType};this.DataType===En.KLINE_ID&&(o.Period=this.Period);var h=this.Data.GetDateRange(),l={Name:"JSSymbolData::GetIndexIncreaseData",Explain:"æ¶¨åå®¶æ°ç»è®¡",DateRange:h,DataType:o,Request:{Url:"www.121287.com",Type:"POST",Data:{symbol:this.Symbol,blocksymbol:i,field:["up","down"]}},Self:this,PreventDefault:!1};if(this.NetworkFilter(l,(function(t){this.DataType===En.KLINE_ID?this.RecvHistoryIncreaseDataV2(t,{UpKey:r,DownKey:n}):this.RecvMinuteIncreaseDataV2(t,{UpKey:r,DownKey:n}),s.Execute.RunNextJob()})),1==l.PreventDefault)return}if(this.DataType===En.MINUTE_ID||this.DataType===En.MULTIDAY_MINUTE_ID){var u=sn.CacheDomain+"/cache/analyze/increaseanalyze/"+i+".json";w.Complier.Log("[JSSymbolData::GetIndexIncreaseData] minute Get url=",u),O.HttpRequest({url:u,type:"get",dataType:"json",async:!0,success:function(t){s.RecvMinuteIncreaseData(t,{UpKey:r,DownKey:n}),s.Execute.RunNextJob()},error:function(t){s.RecvError(t)}})}else this.DataType===En.KLINE_ID&&Ot.IsDayPeriod(this.Period,!0)?(w.Complier.Log("[JSSymbolData::GetIndexIncreaseData] K day Get url=",s.KLineApiUrl),O.HttpRequest({url:s.KLineApiUrl,data:{symbol:i,start:-1,count:s.MaxRequestDataCount,field:["up","down"]},type:"post",dataType:"json",async:!0,success:function(t){s.RecvHistoryIncreaseData(t,{UpKey:r,DownKey:n}),s.Execute.RunNextJob()},error:function(t){s.RecvError(t)}})):this.Execute.RunNextJob()},this.RecvHistoryIncreaseDataV2=function(t,e){w.Complier.Log("[JSSymbolData::RecvHistoryIncreaseData] recv data, key",t,e);var a=[],i=[];for(var r in t.data){var n=t.data[r],s=new Et,o=new Et,h=n[0],l=null;s.Date=h,o.Date=h,Ot.IsMinutePeriod(this.Period,!0)&&ha.IsNumber(n[1])&&(l=n[1],s.Time=l,o.Time=l),s.Value=n[2],a[r]=s,o.Value=n[3],i[r]=o}var u=this.Data.GetFittingData2(a,0),C=this.Data.GetFittingData2(i,0);this.ExtendData.set(e.UpKey,u),this.ExtendData.set(e.DownKey,C)},this.RecvHistoryIncreaseData=function(t,e){w.Complier.Log("[JSSymbolData::RecvHistoryIncreaseData] recv data",t);var a,i,r=[],n=[];for(var s in t.data){var o=t.data[s],h=new Et,l=new Et;h.Date=o[0],h.Value=o[8],r[s]=h,l.Date=o[0],l.Value=o[9],n[s]=l}a=this.SourceData?this.SourceData.GetFittingData(r):this.Data.GetFittingData(aryData),i=this.SourceData?this.SourceData.GetFittingData(n):this.Data.GetFittingData(aryData),this.ExtendData.set(e.UpKey,a),this.ExtendData.set(e.DownKey,i)},this.RecvMinuteIncreaseDataV2=function(t,e){w.Complier.Log("[JSSymbolData::RecvMinuteIncreaseDataV2] recv data, key",t,e)},this.RecvMinuteIncreaseData=function(t,e){if(w.Complier.Log("[JSSymbolData::RecvMinuteIncreaseData] recv data",t),t.minute){var a=t.minute;if(a.time&&a.up&&a.down){var i=[],r=[];if(this.IsBeforeData)for(var n=0,s=0;n<this.Data.Data.length;++n){i[n]=null,r[n]=null;var o=this.Data.Data[n];if(!o.Before){var h=o.DateTime;if(h){var l=h.split(" ");if(2==l.length){var u=parseInt(l[0]);u==t.date&&(i[n]=a.up[s],r[n]=a.down[s],++s)}}}}else for(n=0,s=0;n<this.Data.Data.length;++n){i[n]=null,r[n]=null;o=this.Data.Data[n],h=o.DateTime;if(h){l=h.split(" ");if(2==l.length){u=parseInt(l[0]);u==t.date&&(i[n]=a.up[s],r[n]=a.down[s],++s)}}}this.ExtendData.set(e.UpKey,i),this.ExtendData.set(e.DownKey,r)}}},this.GetIndexIncreaseCacheData=function(t,e,a){var i,r=this.GetBlockSymbol(e);if(r||this.Execute.ThrowUnexpectedNode(a,"ä¸æ¯æå½æ°"+t+"("+e+")"),"UPCOUNT"==t||"ADVANCE"==t?i=xn.JOB_DOWNLOAD_INDEX_INCREASE_DATA.toString()+"-UpCount-"+r:"DOWNCOUNT"!=t&&"DECLINE"!=t||(i=xn.JOB_DOWNLOAD_INDEX_INCREASE_DATA.toString()+"-DownCount-"+r),i&&this.ExtendData.has(i)||this.Execute.ThrowUnexpectedNode(a,"ä¸æ¯æå½æ°"+t+"("+e+")"),this.DataType===En.MINUTE_ID||this.DataType===En.MULTIDAY_MINUTE_ID)return this.ExtendData.get(i);if(this.DataType===En.KLINE_ID&&Ot.IsDayPeriod(this.Period,!0)){var n=this.ExtendData.get(i),s=new Ot;if(s.Data=n,s.Period=this.Period,s.Period>0){var o=s.GetPeriodSingleData(s.Period);s.Data=o}return s.GetValue()}return null},this.GetSymbolData=function(){if(this.Data)return this.Execute.RunNextJob();var t=this;if(this.DataType!==En.MINUTE_ID)if(this.DataType!==En.MULTIDAY_MINUTE_ID){if(Ot.IsDayPeriod(this.Period,!0)){if(this.NetworkFilter){var e={Name:"JSSymbolData::GetSymbolData",Explain:"æ¥çº¿æ°æ®",Request:{Url:t.RealtimeApiUrl,Type:"POST",Data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,start:-1,count:t.MaxRequestDataCount}},Self:this,PreventDefault:!1};if(this.KLineDateTimeRange&&(e.Request.KLineDataTimeRange={Start:{Date:this.KLineDateTimeRange.Start.Date},End:{Date:this.KLineDateTimeRange.End.Date}},this.IsNumber(this.KLineDateTimeRange.Start.Time)&&(e.Request.KLineDataTimeRange.Start.Time=this.KLineDateTimeRange.Start.Time),this.IsNumber(this.KLineDateTimeRange.End.Time)&&(e.Request.KLineDataTimeRange.End.Time=this.KLineDateTimeRange.End.Time)),this.NetworkFilter(e,(function(e){t.RecvHistroyData(e),t.Execute.RunNextJob()})),1==e.PreventDefault)return}O.HttpRequest({url:t.KLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,start:-1,count:t.MaxRequestDataCount},type:"post",dataType:"json",async:!0,success:function(e){t.RecvHistroyData(e),t.Execute.RunNextJob()},error:function(e){t.RecvError(e)}})}else if(Ot.IsMinutePeriod(this.Period,!0)){if(this.NetworkFilter){e={Name:"JSSymbolData::GetSymbolData",Explain:"åéKçº¿æ°æ®",Request:{Url:t.MinuteKLineApiUrl,Type:"POST",Data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,start:-1,count:t.MaxRequestMinuteDayCount}},Self:this,PreventDefault:!1};if(this.KLineDateTimeRange&&(e.Request.KLineDataTimeRange={Start:{Date:this.KLineDateTimeRange.Start.Date},End:{Date:this.KLineDateTimeRange.End.Date}},this.IsNumber(this.KLineDateTimeRange.Start.Time)&&(e.Request.KLineDataTimeRange.Start.Time=this.KLineDateTimeRange.Start.Time),this.IsNumber(this.KLineDateTimeRange.End.Time)&&(e.Request.KLineDataTimeRange.End.Time=this.KLineDateTimeRange.End.Time)),this.NetworkFilter(e,(function(e){t.RecvMinuteHistroyData(e),t.Execute.RunNextJob()})),1==e.PreventDefault)return}O.HttpRequest({url:this.MinuteKLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:t.Symbol,start:-1,count:t.MaxRequestMinuteDayCount},type:"post",dataType:"json",async:!0,success:function(e){t.RecvMinuteHistroyData(e),t.Execute.RunNextJob()},error:function(e){t.RecvError(e)}})}}else O.HttpRequest({url:t.HistoryMinuteApiUrl,data:{symbol:t.Symbol,daycount:t.DayCount},type:"post",dataType:"json",async:!0,success:function(e){t.RecvMultiDayMinuteData(e),t.Execute.RunNextJob()}});else O.HttpRequest({url:t.RealtimeApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol","amount","date","minute","time","minutecount"],symbol:[t.Symbol],start:-1},type:"post",dataType:"json",async:!0,success:function(e){t.RecvMinuteData(e),t.Execute.RunNextJob()}})},this.RecvHistroyData=function(t){w.Complier.Log("[JSSymbolData::RecvHistroyData] recv data",t);var e=this.JsonDataToHistoryData(t);if(this.Data=new Ot,this.Data.DataType=0,this.Data.Data=e,this.SourceData=new Ot,this.SourceData.Data=e,this.IsApiPeriod);else{if(this.Right>0){var a=this.Data.GetRightData(this.Right);this.Data.Data=a}if(Ot.IsDayPeriod(this.Period,!1)){var i=this.Data.GetPeriodData(this.Period);this.Data.Data=i}}this.Data.Right=this.Right,this.Data.Period=this.Period,this.Name=t.name},this.RecvMinuteHistroyData=function(t){w.Complier.Log("[JSSymbolData::RecvMinuteHistroyData] recv data",t);var e=this.JsonDataToMinuteHistoryData(t);if(this.Data=new Ot,this.Data.DataType=1,this.Data.Data=e,this.SourceData=new Ot,this.SourceData.Data=e,this.IsApiPeriod);else if(Ot.IsMinutePeriod(this.Period,!1)){var a=this.Data.GetPeriodData(this.Period);this.Data.Data=a}this.Data.Period=this.Period,this.Name=t.name},this.RecvMinuteData=function(t){w.Complier.Log("[JSSymbolData::RecvMinuteData] recv data",t);var e=this.JsonDataToMinuteData(t);this.Data=new Ot,this.Data.DataType=2,this.Data.Data=e,this.Name=t.stock[0].name},this.RecvMultiDayMinuteData=function(t){var e=this.JsonDataToMultiDayMinuteData(t);this.Data=new Ot,this.Data.DataType=2,this.Data.Data=e,this.Name=t.name},this.GetSymbolCacheData=function(t){if(!this.Data)return new Array;var e=this.Symbol.toUpperCase();switch(t){case"CLOSE":case"C":return this.Data.GetClose();case"VOL":case"V":return Br.IsSHSZ(e)?this.Data.GetVol(100):this.Data.GetVol();case"OPEN":case"O":return this.Data.GetOpen();case"HIGH":case"H":return this.Data.GetHigh();case"LOW":case"L":return this.Data.GetLow();case"AMOUNT":case"AMO":return this.Data.GetAmount();case"OPI":case"VOLINSTK":return this.Data.GetPosition();case"ZSTJJ":return this.Data.GetAvPrice();case"SETTLE":case"QHJSJ":return this.Data.GetSettlementPrice();case"ISEQUAL":return this.Data.GetIsEqual();case"ISUP":return this.Data.GetIsUp();case"ISDOWN":return this.Data.GetIsDown()}},this.GetSymbolPeriodData=function(t){var e=Cn.GetPeriodInfo({Name:t.PeriodName}).Period,a={PeriodID:e,PeriodName:t.PeriodName};if(e==this.Period&&this.Execute.RunNextJob(),this.IsApiPeriod){if(this.PeriodData.has(t.PeriodName))return this.Execute.RunNextJob()}else if(Ot.IsDayPeriod(e,!0)){if(Ot.IsDayPeriod(this.Period,!0))return this.Execute.RunNextJob();a={PeriodID:0,PeriodName:"DAY"}}else{if(!Ot.IsMinutePeriod(e,!0))return this.Execute.RunNextJob();if(Ot.IsMinutePeriod(this.Period,!0))return this.Execute.RunNextJob();a={PeriodID:4,PeriodName:"MIN1"}}var i=this;if(this.NetworkFilter){var r={Name:"JSSymbolData::GetSymbolPeriodData",Explain:"è·¨å¨ææ°æ®",Request:{Data:{field:["symbol","name",t.ValueName],period:t.PeriodName,symbol:i.Symbol}},Self:this,PreventDefault:!1};if(this.NetworkFilter(r,(function(t){i.RecvSymbolPeriodData(t,a),i.Execute.RunNextJob()})),1==r.PreventDefault)return}if(Ot.IsMinutePeriod(e,!0))O.HttpRequest({url:this.MinuteKLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:i.Symbol,start:-1,count:i.MaxRequestMinuteDayCount},type:"post",dataType:"json",async:!0,success:function(t){i.RecvSymbolPeriodData(t,a),i.Execute.RunNextJob()},error:function(t){i.RecvError(t)}});else{if(!Ot.IsDayPeriod(e,!0))return this.Execute.RunNextJob();O.HttpRequest({url:i.KLineApiUrl,data:{field:["name","symbol","yclose","open","price","high","low","vol"],symbol:i.Symbol,start:-1,count:i.MaxRequestDataCount},type:"post",dataType:"json",async:!0,success:function(t){i.RecvSymbolPeriodData(t,a),i.Execute.RunNextJob()},error:function(t){i.RecvError(t)}})}},this.RecvSymbolPeriodData=function(t,e){if(w.Complier.Log("[JSSymbolData::RecvSymbolPeriodData] data, periodInfo ",t,e),Ot.IsDayPeriod(e.PeriodID,!0)){var a=this.JsonDataToHistoryData(t),i=new Ot;i.DataType=0,i.Data=a,i.Right=0,i.Period=e.PeriodID,this.PeriodData.set(e.PeriodName,i)}else if(Ot.IsMinutePeriod(e.PeriodID,!0)){a=this.JsonDataToMinuteHistoryData(t);var r=new Ot;r.DataType=1,r.Data=a,r.Right=0,r.Period=e.PeriodID,this.PeriodData.set(e.PeriodName,r)}},this.GetSymbolPeriodCacheData=function(t,e){var a=Cn.GetPeriodInfo({Name:e});if(this.Period==a.Period)return this.GetSymbolCacheData(t);var i=null;if(this.IsApiPeriod){var r=Cn.GetPeriodInfo({PeriodID:this.Period});if(!r)return null;if(r.Order>a.Order)return null;if(!this.PeriodData.has(e))return null;i=this.PeriodData.get(e),i=i.Data}else{r=Cn.GetPeriodInfo({PeriodID:this.Period});if(!r)return null;if(r.Order>a.Order)return null;if(Ot.IsDayPeriod(a.Period,!0)&&Ot.IsMinutePeriod(this.Period,!0)){var n=this.PeriodData.get("DAY");i=0==a.Period?n.Data:n.GetPeriodData(a.Period)}else{var s=new Ot;if(s.Data=this.SourceData.Data,s.Period=this.Period,s.Right=this.Right,Ot.IsDayPeriod(a.Period,!0)&&s.Right>0){var o=s.GetRightData(s.Right);s.Data=o}i=s.GetPeriodData(a.Period)}}var h=this.Data.ConverPeriod(i,this.Period,a.Period),l=new Ot;l.Data=h;var u=this.Symbol.toUpperCase();switch(t){case"C":case"CLOSE":return l.GetClose();case"O":case"OPEN":return l.GetOpen();case"H":case"HIGH":return l.GetHigh();case"L":case"LOW":return l.GetLow();case"AMO":case"AMOUNT":return l.GetAmount();case"V":case"VOL":return Br.IsSHSZ(u)?l.GetVol(100):l.GetVol();case"VOLINSTK":return l.GetPosition();default:return null}},this.GetSymbolPeriodCacheData2=function(t,e,a){var i=Cn.GetPeriodInfo({Name:e});if(!i)return null;var r=Cn.GetPeriodInfo({PeriodID:this.Period});if(!r)return null;if(r.Order>i.Order)return null;if(r.Period==i.Period)u=this.Data;else{var n;if(this.IsApiPeriod){if(!this.PeriodData.has(e))return null;n=this.PeriodData.get(e)}else if(Ot.IsMinutePeriod(r.Period,!0)&&Ot.IsDayPeriod(i.Period,!0)){var s=this.PeriodData.get("DAY");n=0==i.Period?s:s.GetPeriodData(i.Period)}else{var o=new Ot;if(o.Data=this.SourceData.Data,o.Period=this.Period,o.Right=this.Right,Ot.IsDayPeriod(i.Period,!0)&&o.Right>0){var h=o.GetRightData(o.Right);o.Data=h}n=o.GetPeriodData(i.Period)}var l=this.Data.ConverPeriod(n,this.Period,i.Period),u=new Ot;u.Data=l}if(ha.IsPlusNumber(a)){var C=new Ot;l=u.GetRef(a);C.Data=l,u=C}var D=this.Symbol.toUpperCase();switch(t){case"C":case"CLOSE":return u.GetClose();case"O":case"OPEN":return u.GetOpen();case"H":case"HIGH":return u.GetHigh();case"L":case"LOW":return u.GetLow();case"AMO":case"AMOUNT":return u.GetAmount();case"V":case"VOL":return Br.IsSHSZ(D)?u.GetVol(100):u.GetVol();case"VOLINSTK":return u.GetPosition();default:return null}},this.GetCurrBarsCount=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e=this.Data.Data.length,a=e-1;a>=0;--a)t.push(a+1);return t},this.GetBarPos=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e=this.Data.Data.length,a=0;a<e;++a)t.push(a+1);return t},this.GetTotalTradeMinuteCount=function(){var t=zr.GetCoordinateData(this.Symbol);return t&&t.Count>0?t.Count-1:242},this.GetTotalBarsCount=function(){var t=this.Data.Data.length;return t},this.GetIsLastBar=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e=this.Data.Data.length,a=0;a<e;++a)a==e-1?t.push(1):t.push(0);return t},this.GetBarStatus=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e=this.Data.Data.length,a=0;a<e;++a)t[a]=0==a?1:a==e-1?2:0;return t},this.GetMarginCacheData=function(t,e){var a=xn.GetMarginJobID(t);return a||this.Execute.ThrowUnexpectedNode(e,"ä¸æ¯æMARGIN("+t+")"),this.MarginData.has(a)?this.MarginData.get(a):[]},this.GetMarginData=function(t){if(this.MarginData.has(t))return this.Execute.RunNextJob();w.Complier.Log("[JSSymbolData::GetMarginData] jobID=",t);var e=this,a=["name","date","symbol"];switch(t){case xn.JOB_DOWNLOAD_MARGIN_BALANCE:a.push("margin.balance");break;case xn.JOB_DOWNLOAD_MARGIN_RATE:a.push("margin.rate");break;case xn.JOB_DOWNLOAD_MARGIN_BUY_BALANCE:case xn.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT:case xn.JOB_DOWNLOAD_MARGIN_BUY_REPAY:case xn.JOB_DOWNLOAD_MARGIN_BUY_NET:a.push("margin.buy");break;case xn.JOB_DOWNLOAD_MARGIN_SELL_BALANCE:case xn.JOB_DOWNLOAD_MARGIN_SELL_VOLUME:case xn.JOB_DOWNLOAD_MARGIN_SELL_REPAY:case xn.JOB_DOWNLOAD_MARGIN_SELL_NET:a.push("margin.sell");break}O.HttpRequest({url:this.StockHistoryDayApiUrl,data:{field:a,symbol:[this.Symbol],orderfield:"date"},type:"post",dataType:"json",async:!0,success:function(a){e.RecvMarginData(a,t),e.Execute.RunNextJob()}})},this.RecvMarginData=function(t,e){if(w.Complier.Log(t),t.stock&&1==t.stock.length){var a=t.stock[0],i=new Array,r=[],n=[],s=[];for(var o in a.stockday){var h=a.stockday[o],l=h.margin;if(l){var u=new Et;switch(u.Date=h.date,e){case xn.JOB_DOWNLOAD_MARGIN_BALANCE:if(!this.IsNumber(l.balance))continue;u.Value=l.balance,i.push(u);break;case xn.JOB_DOWNLOAD_MARGIN_RATE:if(!this.IsNumber(l.rate))continue;u.Value=l.rate,i.push(u);break;case xn.JOB_DOWNLOAD_MARGIN_BUY_BALANCE:case xn.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT:case xn.JOB_DOWNLOAD_MARGIN_BUY_REPAY:case xn.JOB_DOWNLOAD_MARGIN_BUY_NET:var C=l.buy;if(!C)continue;if(!this.IsNumber(C.balance)||!this.IsNumber(C.amount)||!this.IsNumber(C.repay)||!this.IsNumber(C.net))continue;u.Value=C.balance;var D=new Et;D.Date=h.date,D.Value=C.amount;var f=new Et;f.Date=h.date,f.Value=C.repay;var c=new Et;c.Date=h.date,c.Value=C.net,i.push(u),r.push(D),n.push(f),s.push(c);break;case xn.JOB_DOWNLOAD_MARGIN_SELL_BALANCE:case xn.JOB_DOWNLOAD_MARGIN_SELL_VOLUME:case xn.JOB_DOWNLOAD_MARGIN_SELL_REPAY:case xn.JOB_DOWNLOAD_MARGIN_SELL_NET:var d=l.sell;if(!d)continue;if(!this.IsNumber(d.balance)||!this.IsNumber(d.volume)||!this.IsNumber(d.repay)||!this.IsNumber(d.net))continue;u.Value=C.balance;D=new Et;D.Date=h.date,D.Value=C.volume;f=new Et;f.Date=h.date,f.Value=C.repay;c=new Et;c.Date=h.date,c.Value=C.net,i.push(u),r.push(D),n.push(f),s.push(c);break;default:continue}}}var m=[];for(var v in e===xn.JOB_DOWNLOAD_MARGIN_BALANCE||e===xn.JOB_DOWNLOAD_MARGIN_RATE?m.push({JobID:e,Data:i}):e===xn.JOB_DOWNLOAD_MARGIN_BUY_BALANCE||e===xn.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT||e===xn.JOB_DOWNLOAD_MARGIN_BUY_REPAY||e===xn.JOB_DOWNLOAD_MARGIN_BUY_NET?(m.push({JobID:xn.JOB_DOWNLOAD_MARGIN_BUY_BALANCE,Data:i}),m.push({JobID:xn.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT,Data:r}),m.push({JobID:xn.JOB_DOWNLOAD_MARGIN_BUY_REPAY,Data:n}),m.push({JobID:xn.JOB_DOWNLOAD_MARGIN_BUY_NET,Data:s})):e!==xn.JOB_DOWNLOAD_MARGIN_SELL_BALANCE&&e!==xn.JOB_DOWNLOAD_MARGIN_SELL_VOLUME&&e!==xn.JOB_DOWNLOAD_MARGIN_SELL_REPAY&&e!==xn.JOB_DOWNLOAD_MARGIN_SELL_NET||(m.push({JobID:xn.JOB_DOWNLOAD_MARGIN_SELL_BALANCE,Data:i}),m.push({JobID:xn.JOB_DOWNLOAD_MARGIN_SELL_VOLUME,Data:r}),m.push({JobID:xn.JOB_DOWNLOAD_MARGIN_SELL_REPAY,Data:n}),m.push({JobID:xn.JOB_DOWNLOAD_MARGIN_SELL_NET,Data:s})),m){var S=this.SourceData.GetFittingData(m[v].Data),I=new Ot;if(I.Data=S,I.Period=this.Period,I.Period>0){var p=I.GetPeriodSingleData(I.Period);I.Data=p}var T=I.GetValue();this.MarginData.set(m[v].JobID,T)}}},this.GetNewsAnalysisCacheData=function(t,e){var a=xn.GetNewsAnalysisID(t);return a||this.Execute.ThrowUnexpectedNode(e,"ä¸æ¯æNEWS("+t+")"),this.NewsAnalysisData.has(a)?this.NewsAnalysisData.get(a):[]},this.GetHKToSHSZData=function(t){var e=t.Args,a=this.Symbol;if(e.length>0){var i=e[0];if(i.Type==dn.Literal)a=i.Value;else if(i.Type==dn.Identifier){var r=!1;for(var n in this.Arguments){var s=this.Arguments[n];if(s.Name==i.Name){a=s.Value,r=!0;break}}if(!r){var o=t.Token;this.Execute.ErrorHandler.ThrowError(o.Index,o.Line,0,"HK2SHSZ() Error: can't read "+i.Name)}}}t.Symbol=a,1==a||2==a||3==a?this.GetHKToSHSZMarketData(a,t):this.GetHKToSHSZStockData(a,t)},this.GetHKToSHSZStockData=function(t,e){if(this.HKToSHSZData.has(t))return this.Execute.RunNextJob();var a=t.toLowerCase(),i=this,r=this.HKToSHSZApiUrl[3]+"/"+a+".json";O.HttpRequest({url:r,type:"get",dataType:"json",async:!0,success:function(t){i.RecvHKToSHSZStockData(t,e),i.Execute.RunNextJob()},error:function(t){console.warn("[JSSymbolData::GetHKToSHSZStockData] request url="+r+" failed. error="+t.status),i.RecvHKToSHSZStockData(null,e),i.Execute.RunNextJob()}})},this.RecvHKToSHSZStockData=function(t,e){if(t){for(var a=t.symbol,i=a.toUpperCase(),r=[],n=0;n<t.date.length;++n){var s=new Et;s.Date=t.date[n],s.Value=t.vol[n],r.push(s)}var o=this.Data.GetFittingData(r),h=new Ot;if(h.Data=o,h.Period=this.Period,h.Period>0){var l=h.GetPeriodSingleData(h.Period);h.Data=l}t=h.GetValue();this.HKToSHSZData.set(i,t)}},this.GetHKToSHSZMarketData=function(t,e){if(this.HKToSHSZData.has(t))return this.Execute.RunNextJob();var a,i=0;this.DataType===En.MINUTE_ID?i=1:this.DataType==En.MULTIDAY_MINUTE_ID?i=2:this.Period<=3&&(i=0),a=this.HKToSHSZApiUrl[i];var r=this;w.Complier.Log("[JSSymbolData::GetHKToSHSZMarketData] code="+t+" url="+a+", dataType="+i),2===i?O.HttpRequest({url:a,data:{symbol:this.Symbol,daycount:this.MaxRequestMinuteDayCount},type:"post",dataType:"json",async:!0,success:function(t){r.RecvMulitMinuteHKToSHSZData(t,e),r.Execute.RunNextJob()}}):O.HttpRequest({url:a,type:"get",dataType:"json",async:!0,success:function(t){0==i?r.RecvHKToSHSZData(t,e):1==i&&r.RecvMinuteHKToSHSZData(t,e),r.Execute.RunNextJob()}})},this.RecvMinuteHKToSHSZData=function(t,e){var a=[],i=[],r=[];if(this.IsBeforeData){for(s in this.SourceData.Data){var n=this.SourceData.Data[s];if(!n.Before)break;a.push(null),i.push(null),r.push(null)}for(var s=0;s<t.time.length;++s){var o=t.time[s];if(925!==o){var h=t.hk2sh[s],l=t.hk2sz[s],u=h+l;a.push(u),i.push(h),r.push(l)}}}else for(s=0;s<t.time.length;++s){o=t.time[s],h=t.hk2sh[s],l=t.hk2sz[s],u=h+l;a.push(u),i.push(h),r.push(l)}var C=[{Data:a,ID:1},{Data:i,ID:2},{Data:r,ID:3}];for(var s in C){n=C[s];this.HKToSHSZData.set(n.ID,n.Data)}},this.RecvHKToSHSZData=function(t,e){for(var a=[],i=[],r=[],n=0;n<t.date.length;++n){var s=t.date[n],o=1e6*t.hk2sh[n],h=1e6*t.hk2sz[n],l=o+h,u=new Et;u.Date=s,u.Value=l;var C=new Et;C.Date=s,C.Value=o;var D=new Et;D.Date=s,D.Value=h,a.push(u),i.push(C),r.push(D)}var f=[{Data:a,ID:1},{Data:i,ID:2},{Data:r,ID:3}];for(var c in f){var d=this.Data.GetFittingData(f[c].Data),m=new Ot;if(m.Data=d,m.Period=this.Period,m.Period>0){var v=m.GetPeriodSingleData(m.Period);m.Data=v}var S=m.GetValue();this.HKToSHSZData.set(f[c].ID,S)}},this.RecvMulitMinuteHKToSHSZData=function(t,e){if(t.data&&!(t.data.length<=0)){for(var a=[],i=[],r=[],n=0,s=0;n<this.Data.Data.length&&s<t.data.length;){a[n]=null,i[n]=null,r[n]=null;var o=this.Data.Data[n],h=o.DateTime;if(h){var l=h.split(" ");if(2==l.length){var u=parseInt(l[0]),C=t.data[s];if(!C.minute||C.minute.length<=0)++s;else if(C.date>u)++n;else if(C.date<u)++s;else{for(var D in C.minute){var f=C.minute[D],c=f[1],d=f[2],m=c+d;a[n]=m,i[n]=c,r[n]=d,++n}++s}}else++n}else++n}var v=[{Data:a,ID:1},{Data:i,ID:2},{Data:r,ID:3}];for(var n in v){o=v[n];this.HKToSHSZData.set(o.ID,o.Data)}}},this.GetHKToSHSZCacheData=function(t,e){return t||(t=this.Symbol),"string"==typeof t&&(t=t.toUpperCase()),this.HKToSHSZData.has(t)?this.HKToSHSZData.get(t):[]},this.GetNewsAnalysisData=function(t){if(this.NewsAnalysisData.has(t))return this.Execute.RunNextJob();var e=this,a=new E.default([[xn.JOB_DOWNLOAD_NEWS_ANALYSIS_NEGATIVE,"negative"],[xn.JOB_DOWNLOAD_NEWS_ANALYSIS_RESEARCH,"research"],[xn.JOB_DOWNLOAD_NEWS_ANALYSIS_INTERACT,"interact"],[xn.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE,"holderchange"],[xn.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2,"holderchange"],[xn.JOB_DOWNLOAD_NEWS_ANALYSIS_TRUSTHOLDER,"trustholder"],[xn.JOB_DOWNLOAD_NEWS_ANALYSIS_BLOCKTRADING,"Blocktrading"],[xn.JOB_DOWNLOAD_NEWS_ANALYSIS_COMPANYNEWS,"companynews"],[xn.JOB_DOWNLOAD_NEWS_ANALYSIS_TOPMANAGERS,"topmanagers"],[xn.JOB_DOWNLOAD_NEWS_ANALYSIS_PLEDGE,"Pledge"]]);if(a.has(t)){var i=a.get(t),r=this.StockNewsAnalysisApiUrl+"/"+i+"/"+this.Symbol+".json";O.HttpRequest({url:r,type:"get",dataType:"json",async:!0,success:function(a){e.RecvNewsAnalysisData(a,t),e.Execute.RunNextJob()},error:function(a,i){e.RecvNewsAnalysisDataError(a,i,t),e.Execute.RunNextJob()}})}else this.Execute.RunNextJob()},this.RecvNewsAnalysisDataError=function(t,e,a){w.Complier.Log("[JSSymbolData::RecvNewsAnalysisDataError] ajax error.",t.status);for(var i=[],r=0;r<this.Data.Data.length;++r){var n=new Et;n.Date=this.Data.Data[r].Date,n.Value=0,i.push(n)}var s=new Ot;s.Data=i,this.NewsAnalysisData.set(a,s.GetValue())},this.RecvNewsAnalysisData=function(t,e){if(t.data&&t.date&&!(t.data.length<=0||t.data.length!=t.date.length))if(w.Complier.Log("[JSSymbolData::RecvNewsAnalysisData] jobID",e,t.update),e==xn.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE||e==xn.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2){for(var a=[],i=[],r=0;r<t.data.length;++r){var n=new Et;n.Date=t.date[r],n.Value=t.data[r],this.IsNumber(n.Value)&&a.push(n),r<t.data2.length&&(n=new Et,n.Date=t.date[r],n.Value=t.data2[r],this.IsNumber(n.Value)&&i.push(n))}var s=this.Data.GetFittingData2(a,0),o=new Ot;o.Data=s,this.NewsAnalysisData.set(xn.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE,o.GetValue()),s=this.Data.GetFittingData2(i,0),o=new Ot,o.Data=s,this.NewsAnalysisData.set(xn.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2,o.GetValue())}else{for(a=[],r=0;r<t.data.length;++r){n=new Et;n.Date=t.date[r],n.Value=t.data[r],a.push(n)}var h=this.Data.GetFittingData2(a,0);o=new Ot;o.Data=h,this.NewsAnalysisData.set(e,o.GetValue())}},this.GetSectionFinanceData=function(t){var e=t.SF[0],a=t.SF[1].Period;if(this.SectionFinanceData.has(e))return this.Execute.RunNextJob();w.Complier.Log("[JSSymbolData::GetSectionFinanceData] "+a.Year+"-"+a.Quarter);var i="announcement"+a.Quarter,r=this,n=["name","date","symbol",i,"finance"+a.Quarter],s=[i+".year","int32","eq",a.Year.toString()];O.HttpRequest({url:this.StockHistoryDayApiUrl,data:{field:n,symbol:[this.Symbol],condition:[{item:s}]},type:"post",dataType:"json",async:!0,success:function(e){r.RecvSectionFinanceData(e,t),r.Execute.RunNextJob()}})},this.RecvSectionFinanceData=function(t,e){if(t.stock&&1==t.stock.length){var a=t.stock[0];if(a.stockday&&!(a.stockday.length<=0)){var i=a.stockday[0],r=e.SF[1].Period,n=null;if(1===r.Quarter?n=i.finance1:2===r.Quarter?n=i.finance2:3===r.Quarter?n=i.finance3:4===r.Quarter&&(n=i.finance4),n){t=new E.default([[xn.JOB_DOWNLOAD_SECTION_F_01,n.currentassets],[xn.JOB_DOWNLOAD_SECTION_F_02,n.monetaryfunds],[xn.JOB_DOWNLOAD_SECTION_F_03,n.inventory],[xn.JOB_DOWNLOAD_SECTION_F_04,n.currentliabilities],[xn.JOB_DOWNLOAD_SECTION_F_05,n.ncurrentliabilities],[xn.JOB_DOWNLOAD_SECTION_F_06,n.expenses3],[xn.JOB_DOWNLOAD_SECTION_F_07,n.investmentincome],[xn.JOB_DOWNLOAD_SECTION_F_08,n.pcnprofit],[xn.JOB_DOWNLOAD_SECTION_F_09,n.nnetprofit],[xn.JOB_DOWNLOAD_SECTION_F_10,n.npersearning],[xn.JOB_DOWNLOAD_SECTION_F_11,n.woewa],[xn.JOB_DOWNLOAD_SECTION_F_12,n.inprocess],[xn.JOB_DOWNLOAD_SECTION_F_13,n.accdepreciation],[xn.JOB_DOWNLOAD_SECTION_F_14,n.mholderprofit],[xn.JOB_DOWNLOAD_SECTION_F_15,n.lossexchange],[xn.JOB_DOWNLOAD_SECTION_F_16,n.baddebts],[xn.JOB_DOWNLOAD_SECTION_F_17,n.fixedassets],[xn.JOB_DOWNLOAD_SECTION_F_18,n.curdepreciation],[xn.JOB_DOWNLOAD_SECTION_F_19,n.orevenues],[xn.JOB_DOWNLOAD_SECTION_F_20,n.moprofit],[xn.JOB_DOWNLOAD_SECTION_F_21,n.oprofit],[xn.JOB_DOWNLOAD_SECTION_F_22,n.nprofit],[xn.JOB_DOWNLOAD_SECTION_F_23,n.areceivable],[xn.JOB_DOWNLOAD_SECTION_F_24,n.financialcost],[xn.JOB_DOWNLOAD_SECTION_F_25,n.ccfo],[xn.JOB_DOWNLOAD_SECTION_F_26,n.totalassets],[xn.JOB_DOWNLOAD_SECTION_F_27,n.totalliabilities],[xn.JOB_DOWNLOAD_SECTION_F_28,n.totalownersequity],[xn.JOB_DOWNLOAD_SECTION_F_29,n.grossmargin],[xn.JOB_DOWNLOAD_SECTION_F_30,n.percreserve],[xn.JOB_DOWNLOAD_SECTION_F_31,n.peruprofit],[xn.JOB_DOWNLOAD_SECTION_F_32,n.persearning],[xn.JOB_DOWNLOAD_SECTION_F_33,n.pernetasset],[xn.JOB_DOWNLOAD_SECTION_F_34,n.perccfo],[xn.JOB_DOWNLOAD_SECTION_F_38,n.alratio],[xn.JOB_DOWNLOAD_SECTION_F_39,n.profityoy]]);4===r.Quarter&&(t.set(xn.JOB_DOWNLOAD_SECTION_F_35,n.nnprofitincrease),t.set(xn.JOB_DOWNLOAD_SECTION_F_36,n.nnprofitspeed),t.set(xn.JOB_DOWNLOAD_SECTION_F_37,n.nprofitincrease));var s=e.SF[0];this.SectionFinanceData.set(s,t)}}}},this.GetSectionFinanceCacheData=function(t,e,a,i){var r=xn.GetSectionReportPeriod(t,e);r||this.Execute.ThrowUnexpectedNode(i,"ä¸æ¯æFS("+t+", "+e+", '"+a+"') æ¥åæéè¯¯");var n=xn.GetSectionFinanceID(a);n||this.Execute.ThrowUnexpectedNode(i,"ä¸æ¯æFS("+t+", "+e+",'"+a+"') è´¢å¡æ°æ®å­æ®µåç§°éè¯¯");var s=r.Year+"-"+r.Quarter;if(!this.SectionFinanceData.has(s)&&!this.ThrowSFPeirod.has(s)){this.ThrowSFPeirod.add(s);var o={ID:xn.JOB_DOWNLOAD_SECTION_SF,SF:[s,{Period:r,Fields:new I.default([n])}]};this.Execute.ThrowDownloadSF(i,o,"FS("+t+", "+e+", '"+a+"') å¨æä¸è½½")}if(!this.SectionFinanceData.has(s))return this.Execute.ThrowUnexpectedNode(i,"ä¸æ¯æFS("+t+", "+e+", '"+a+"') æ²¡æè¿æè´¢å¡æ°æ®");var h=this.SectionFinanceData.get(s);return h.has(n)||this.Execute.ThrowUnexpectedNode(i,"ä¸æ¯æFS("+t+", "+e+", '"+a+"') æ²¡æè¿æè´¢å¡æ°æ®å­æ®µ"),h.get(n)},this.GetFinOne=function(t){var e=this.JobArgumentsToArray(t,3),a=this.GetStockDataKey(t,e);if(this.StockData.has(a))return this.Execute.RunNextJob();var i=this;if(this.NetworkFilter){var r=this.Data.GetDateRange(),n={Name:"JSSymbolData::GetFinOne",Explain:"è´¢å¡æ°æ®FINONE(ID,Y,MMDD)",JobID:t.ID,Request:{Url:i.StockHistoryDayApiUrl,Type:"POST",Data:{Args:e,symbol:this.Symbol,daterange:r}},Self:this,PreventDefault:!1};if(this.NetworkFilter(n,(function(e){i.RecvStockValue(e,t,a,1),i.Execute.RunNextJob()})),1==n.PreventDefault)return}var s=new Vn({Job:t,Symbol:this.Symbol,Url:this.StockHistoryDayApiUrl,Args:e,DataKey:a,Callback:function(t,e,a){i.RecvStockValue(t,e,a,1),i.Execute.RunNextJob()},ErrorCallback:function(t){i.AddStockValueError(a,t)}});s.Download()},this.GetStockDataKey=function(t,e){var a=t.FunctionName;if(e.length>0){a+="(";for(var i=0;i<e.length;++i)i>0&&(a+=","),a+=e[i].toString();a+=")"}return a},this.GetFinValue=function(t){var e=this.JobArgumentsToArray(t,1),a=e[0],i=this.GetStockDataKey(t,e);if(this.StockData.has(i))return this.Execute.RunNextJob();var r=this;if(this.NetworkFilter){var n=this.Data.GetDateRange(),s={Name:"JSSymbolData::GetFinValue",Explain:"è´¢å¡æ°æ®FINVALUE(ID)",JobID:t.ID,Request:{Url:r.StockHistoryDayApiUrl,Type:"POST",Data:{id:a,symbol:this.Symbol,daterange:n}},Self:this,PreventDefault:!1};if(this.NetworkFilter(s,(function(e){r.RecvStockValue(e,t,i,0),r.Execute.RunNextJob()})),1==s.PreventDefault)return}var o=new Bn({Job:t,Symbol:this.Symbol,Url:this.StockHistoryDayApiUrl,Args:e,DataKey:i,Callback:function(t,e,a){r.RecvStockValue(t,e,a,0),r.Execute.RunNextJob()},ErrorCallback:function(t){r.AddStockValueError(i,t)}});o.Download()},this.GetFinance=function(t){var e=this.JobArgumentsToArray(t,1),a=e[0],i=this.GetStockDataKey(t,e);if(this.StockData.has(i))return this.Execute.RunNextJob();var r=this;if(this.NetworkFilter){var n=this.Data.GetDateRange(),s={Name:"JSSymbolData::GetFinance",Explain:"è´¢å¡æ°æ®FINANCE(ID)",JobID:t.ID,Request:{Url:r.RealtimeApiUrl,Type:"POST",Data:{id:a,symbol:this.Symbol,daterange:n}},Self:this,PreventDefault:!1};if(this.NetworkFilter(s,(function(e){r.RecvStockValue(e,t,i,0),r.Execute.RunNextJob()})),1==s.PreventDefault)return}var o=new Gn({Job:t,Symbol:this.Symbol,Url:this.StockHistoryDayApiUrl,RealtimeUrl:this.RealtimeApiUrl,Args:e,DataKey:i,Callback:function(t,e,a){r.RecvStockValue(t,e,a,0),r.Execute.RunNextJob()},ErrorCallback:function(t){r.AddStockValueError(i,t)}});o.Download()},this.GetGPJYValue=function(t){var e=this.JobArgumentsToArray(t,3),a=this.GetStockDataKey(t,e);if(this.StockData.has(a))return this.Execute.RunNextJob();var i=this,r=1==e[2]?0:2;if(this.NetworkFilter){var n=this.Data.GetDateRange(),s={Name:"JSSymbolData::GetGPJYValue",Explain:"è¡ç¥¨äº¤æç±»æ°æ®GPJYVALUE(ID,N,TYPE)",JobID:t.ID,Request:{Url:i.StockHistoryDayApiUrl,Type:"POST",Data:{Args:e,symbol:this.Symbol,daterange:n}},Self:this,PreventDefault:!1};if(this.NetworkFilter(s,(function(e){i.RecvStockValue(e,t,a,r),i.Execute.RunNextJob()})),1==s.PreventDefault)return}var o=new Hn({Job:t,Symbol:this.Symbol,Url:this.StockHistoryDayApiUrl,Args:e,DataKey:a,Callback:function(t,e,a){i.RecvStockValue(t,e,a,r),i.Execute.RunNextJob()},ErrorCallback:function(t){i.AddStockValueError(a,t)}});o.Download()},this.GetSCJYValue=function(t){var e=this.JobArgumentsToArray(t,3),a=this.GetStockDataKey(t,e);if(this.StockData.has(a))return this.Execute.RunNextJob();var i=this,r=1==e[2]?0:2;if(this.NetworkFilter){var n=this.Data.GetDateRange(),s={Name:"JSSymbolData::GetSCJYValue",Explain:"è¡ç¥¨äº¤æç±»æ°æ®SCJYVALUE(ID,N,TYPE)",JobID:t.ID,Request:{Url:i.StockHistoryDayApiUrl,Type:"POST",Data:{Args:e,symbol:this.Symbol,daterange:n}},Self:this,PreventDefault:!1};if(this.NetworkFilter(s,(function(e){i.RecvStockValue(e,t,a,r),i.Execute.RunNextJob()})),1==s.PreventDefault)return}var o=new Yn({Job:t,Symbol:this.Symbol,Url:this.StockHistoryDayApiUrl,Args:e,DataKey:a,Callback:function(t,e,a){i.RecvStockValue(t,e,a,r),i.Execute.RunNextJob()},ErrorCallback:function(t){i.AddStockValueError(a,t)}});o.Download()},this.GetVariantData=function(t){var e=t.VariantName;if(this.StockData.has(e))return this.Execute.RunNextJob();var a=this;if(this.NetworkFilter){var i=this.Data.GetDateRange(),r={Name:"JSSymbolData::GetVariantData",Explain:"åéæ°æ®ä¸è½½",JobID:t.ID,Request:{Url:"www.121287.com",Type:"POST",Data:{VariantName:t.VariantName,symbol:this.Symbol,daterange:i}},Self:this,PreventDefault:!1};if(this.NetworkFilter(r,(function(i){if(i.Error)a.AddStockValueError(e,i.Error);else{var r=0;ha.IsNumber(i.DataType)&&(r=i.DataType),a.RecvStockValue(i.Data,t,e,r)}a.Execute.RunNextJob()})),1==r.PreventDefault)return}var n,s=function(t){a.AddStockValueError(e,t)};if("CAPITAL"==t.VariantName||"TOTALCAPITAL"==t.VariantName||"EXCHANGE"==t.VariantName){var o=function(t,e,i){a.RecvStockValue(t,e,i,0),a.Execute.RunNextJob()};n=new Gn({Job:t,Symbol:this.Symbol,Url:this.StockHistoryDayApiUrl,RealtimeUrl:this.RealtimeApiUrl,Args:[t.VariantName],DataKey:e,Callback:o,ErrorCallback:s})}else{if("HYBLOCK"!=t.VariantName&&"DYBLOCK"!=t.VariantName&&"GNBLOCK"!=t.VariantName){if("INBLOCK"==t.VariantName){var h=t.VariantName+", è¯·å¯¹æ¥å¤é¨æ°æ®.";return this.AddStockValueError(e,h),void this.Execute.RunNextJob()}h="ä¸æ¯æåé"+t.VariantName+", è¯·å¯¹æ¥å¤é¨æ°æ®.";return this.AddStockValueError(e,h),void this.Execute.RunNextJob()}o=function(t,e,i,r){a.RecvStockValue(t,e,i,r),a.Execute.RunNextJob()};n=new kn({Job:t,Symbol:this.Symbol,Url:this.StockHistoryDayApiUrl,RealtimeUrl:this.RealtimeApiUrl,Args:[t.VariantName],DataKey:e,Callback:o,ErrorCallback:s})}n.Download()},this.GetCustomVariantData=function(t){var e=t.VariantName;if(this.StockData.has(e))return this.Execute.RunNextJob();var a=sn.CustomVariant.Data.get(e),i=this;if(this.NetworkFilter){var r=this.Data.GetDateRange(),n={Name:"JSSymbolData::GetCustomVariantData",Explain:"èªå®ä¹åéæ°æ®ä¸è½½",JobID:t.ID,Request:{Url:"www.121287.com",Type:"POST",Data:{VariantName:t.VariantName,symbol:this.Symbol,daterange:r,period:this.Period}},Self:this,VariantInfo:a,PreventDefault:!1};this.NetworkFilter(n,(function(a){a.Error?i.AddStockValueError(e,a.Error):i.RecvStockValue(a.Data,t,e,a.DataType),i.Execute.RunNextJob()}))}else this.AddStockValueError(e,"èªå®ä¹åé"+e+"ä¸è½½å¤±è´¥"),this.Execute.RunNextJob()},this.GetCustomFunctionData=function(t){var e=t.FunctionName,a=sn.CustomFunction.Data.get(e);if(!a.IsDownload)return this.Execute.RunNextJob();if(this.StockData.has(e))return this.Execute.RunNextJob();var i=this;if(this.NetworkFilter){var r=this.Data.GetDateRange(),n={Name:"JSSymbolData::GetCustomFunctionData",Explain:"èªå®ä¹å½æ°æ°æ®ä¸è½½",JobID:t.ID,Request:{Url:"www.121287.com",Type:"POST",Data:{FunctionName:t.FunctionName,symbol:this.Symbol,daterange:r,JobItem:t}},Self:this,FunctionInfo:a,PreventDefault:!1};this.NetworkFilter(n,(function(a){a.Error?i.AddStockValueError(e,a.Error):i.RecvStockValue(a.Data,t,e,a.DataType),i.Execute.RunNextJob()}))}else this.AddStockValueError(e,"èªå®ä¹å½æ°"+e+"ä¸è½½å¤±è´¥"),this.Execute.RunNextJob()},this.RecvStockValue=function(t,e,a,i){if(t){if(0==i)if(Array.isArray(t)){var r=this.Data;if(Ot.IsDayPeriod(this.Period,!0))l=r.GetFittingFinanceData(t);else{if(!Ot.IsMinutePeriod(this.Period,!0))return;l=r.GetMinuteFittingFinanceData(t)}var n=new Ot;n.Data=l;var s=n.GetValue();if("EXCHANGE"==a)for(var o in s){var h=r.Data[o];ha.IsPlusNumber(s[o])&&(s[o]=h.Vol/s[o]*100)}this.StockData.set(a,{Data:s})}else this.StockData.set(a,{Data:t.Value});else if(1==i)this.StockData.set(a,{Data:t.Value});else if(2==i){var l;r=this.Data;if(Ot.IsDayPeriod(this.Period,!0))l=r.GetFittingTradeData(t,0);else if(Ot.IsMinutePeriod(this.Period,!0))l=r.GetMinuteFittingTradeData(t,0);else{if(!Ot.IsTickPeriod(this.Period))return;l=r.GetMinuteFittingTradeData(t,0)}n=new Ot;n.Data=l;s=n.GetValue();this.StockData.set(a,{Data:s})}}else w.Complier.Log("[JSSymbolData::RecvStockValue] key="+a+" data is null")},this.AddStockValueError=function(t,e){this.StockData.set(t,{Error:e})},this.GetStockCacheData=function(t){var e;if(t.FunctionName)e=this.GetStockDataKey({FunctionName:t.FunctionName},t.Args);else if(t.VariantName)e=t.VariantName;else{if(!t.CustomName)return null;e=t.CustomName}if(!this.StockData.has(e))return null;var a=this.StockData.get(e);return a.Error&&this.Execute.ThrowUnexpectedNode(t.Node,a.Error),a.Data},this.IsInBlock=function(t,e){var a=this.GetStockCacheData({VariantName:"INBLOCK",Node:e});if(!a)return 0;for(var i=a.split("|"),r=0;r<i.length;++r){var n=i[r];if(n==t)return 1}return 0},this.JobArgumentsToArray=function(t,e){var a=t.Args;if(a.length!=e){var i=t.Token;this.Execute.ErrorHandler.ThrowError(i.Index,i.Line,0,t.FunctionName+"() Error: argument count error.")}for(var r=[],n=0;n<a.length;++n){var s=a[n];if(ha.IsNumber(s))r.push(s);else if(s.Type==dn.Literal)r.push(s.Value);else if(s.Type==dn.Identifier){var o=!1;for(var h in this.Arguments){var l=this.Arguments[h];if(l.Name==s.Name){r.push(l.Value),o=!0;break}}if(!o){i=t.Token;this.Execute.ErrorHandler.ThrowError(i.Index,i.Line,0,t.FunctionName+"() Error: can't read "+s.Name)}}}return r},this.DownloadCustomAPIData=function(t){if(!this.NetworkFilter)return this.Execute.RunNextJob();var e=[];for(var a in t.Args){var i=t.Args[a];if(i.Type==dn.Literal)e.push(i.Value);else{if(i.Type!=dn.Identifier)return this.Execute.RunNextJob();var r=!1;for(var n in this.Arguments){var s=this.Arguments[n];if(s.Name==i.Name){e.push(s.Value),r=!0;break}}if(!r){var o=t.Token;this.Execute.ErrorHandler.ThrowError(o.Index,o.Line,0,"LoadAPIData() Error: can't read "+i.Name)}}}var h=this,l={Name:"JSSymbolData::DownloadCustomAPIData",Explain:"ä¸è½½èªå®ä¹apiæ°æ®",Period:this.Period,Right:this.Right,Symbol:this.Symbol,KData:this.Data,Cache:this.CustomAPIData,Args:e,Self:this,PreventDefault:!1};this.NetworkFilter(l,(function(t){h.RecvCustomAPIData(t,e),h.Execute.RunNextJob()})),1!=l.PreventDefault&&this.Execute.RunNextJob()},this.RecvCustomAPIData=function(t,e){t&&(1==t.Type?this.RecvCustomAPISingleData(t,e):this.RecvCustomAPIGroupData(t,e))},this.RecvCustomAPIGroupData=function(t,e){if(t&&t.data){var a=t.data,i=this.GenerateCustomAPIKey(e);if(Ot.IsMinutePeriod(this.Period,!0)){if(!a.date||!a.time)return;var r=a.date;a.time;for(var n in a)if("date"!=n&&"time"!=n)var s=a[n]}else if(Ot.IsDayPeriod(this.Period,!0)){if(!a.date)return;r=a.date;var o={__Type__:"Object"};for(var n in a)if("date"!=n){s=a[n];if(Array.isArray(s)){var h=this.FittingCustomAPIArray(s,r);o[n]=h}else this.IsNumber(s)&&(o[n]=s)}this.CustomAPIData.set(i,o)}}},this.RecvCustomAPISingleData=function(t,e){var a=t.data,i=this.GenerateCustomAPIKey(e);if(Ot.IsMinutePeriod(this.Period,!0)){if(!a.date||!a.time)return;var r=a.date;a.time;for(var n in a)if("date"!=n&&"time"!=n)a[n]}else if(Ot.IsDayPeriod(this.Period,!0)){if(!a.date)return;r=a.date;var s=a.value,o=null;o=Array.isArray(s)?1==t.DataType?this.FittingCustomAPIFinanceArray(s,r):this.FittingCustomAPIArray(s,r):s,this.CustomAPIData.set(i,o)}},this.FittingCustomAPIFinanceArray=function(t,e,a){var i,r=this.Data,n=[];for(var s in t){var o=t[s],h=new Et;h.Date=e[s],a&&s<a.length&&(h.Time=a[s]),h.Value=o,n.push(h)}if(Ot.IsDayPeriod(this.Period,!0))i=r.GetFittingFinanceData(n);else{if(!Ot.IsMinutePeriod(this.Period,!0))return null;i=r.GetMinuteFittingFinanceData(n)}var l=new Ot;l.Data=i;var u=l.GetValue();return u},this.FittingCustomAPIArray=function(t,e,a){var i,r=this.Data,n=[];for(var s in t){var o=t[s],h=new Et;h.Date=e[s],a&&s<a.length&&(h.Time=a[s]),h.Value=o,n.push(h)}if(Ot.IsDayPeriod(this.Period,!0))i=r.GetFittingData(n);else{if(!Ot.IsMinutePeriod(this.Period,!0))return null;i=r.GetMinuteFittingData(n)}var l=new Ot;l.Data=i;var u=l.GetValue();return u},this.GenerateCustomAPIKey=function(t){if(t.length<=0)return"__12_EMPTY_ARGS__";var e="";for(var a in t)e.length>0&&(e+=","),e+=t[a];return e},this.GetCustomApiData=function(t){var e=this.GenerateCustomAPIKey(t);return this.CustomAPIData.has(e)?this.CustomAPIData.get(e):(w.Complier.Log("[JSSymbolData::GetCustomApiData] can't find api data key=["+e+"]"),null)},this.ReadArgumentValue=function(t,e){if(e.Name=t.Name,t.Type==dn.Literal)return e.Value=t.Value,!0;if(t.Type==dn.Identifier){var a=!1;for(var i in this.Arguments){var r=this.Arguments[i];if(r.Name==t.Name)return e.Value=r.Value,a=!0,!0}if(!a)return e.Error="can't read "+t.Name,!1}return e.Error="can't read "+t.Name+", type error.",!1},this.ReadIndexFunctionValue=function(t,e){var a={};if("object"===("undefined"===typeof t?"undefined":(0,d.default)(t))){if(!this.ReadArgumentValue(t,a))return e.Error=a.Error,!1}else a.Value=t;var i=a.Value.indexOf(".");if(-1!=i){e.Name=a.Value.slice(0,i);var r=a.Value.indexOf("#",i+1);-1!=r?(e.Out=a.Value.slice(i+1,r),e.Period=a.Value.slice(r+1)):e.Out=a.Value.slice(i+1)}else{r=a.Value.indexOf("#");-1!=r?(e.Name=a.Value.slice(0,r),e.Period=a.Value.slice(r+1)):e.Name=a.Value}var n=new E.default([["DAY",0],["WEEK",1],["MONTH",2],["SEASON",9],["YEAR",3],["HALFYEAR",22],["WEEK2",21],["MIN1",4],["MIN5",5],["MIN15",6],["MIN30",7],["MIN60",8],["DAY2",40002],["MULTIDAY",40002],["DAY3",40003],["DAY4",40004],["DAY5",40005],["DAY6",40006],["DAY7",40007],["DAY8",40008],["DAY9",40009],["DAY10",40010],["DAY11",40011],["DAY12",40012],["DAY13",40013],["DAY14",40014],["DAY15",40015]]);if(e.Period){if(!n.has(e.Period))return e.Error=e.Period+", å¨æéè¯¯",!1;e.PeriodID=n.get(e.Period)}return!0},this.ReadSymbolArgumentValue=function(t,e){var a={};if("object"===("undefined"===typeof t?"undefined":(0,d.default)(t))){if(!this.ReadArgumentValue(t,a))return e.Error=a.Error,!1}else a.Value=t;return""==a.Value&&(a.Value=this.Symbol),a.Value.indexOf(".SH")>0?e.Symbol=a.Value.replace(".SH",".sh"):a.Value.indexOf(".SZ")>0?e.Symbol=a.Value.replace(".SZ",".sz"):e.Symbol=a.Value,!0},this.ReadIndexArgumentValue=function(t,e){for(var a in e.Args=[],e.SytemIndex.Args){var i=e.SytemIndex.Args[a];e.Args.push({Value:i.Value,Name:i.Name})}if(t.length>2&&e.SytemIndex.Args&&e.SytemIndex.Args.length>0){a=2;for(var r=0;a<t.length&&r<e.SytemIndex.Args.length;++a,++r){var n={};i=t[a];if("object"===("undefined"===typeof i?"undefined":(0,d.default)(i))){if(!this.ReadArgumentValue(i,n))return e.Error=n.Error,!1}else n.Value=i;e.Args[r].Value=n.Value}}return!0},this.GenerateScriptIndexKey=function(t){var e="",a=t.Args;for(var i in a){e.length>0&&(e+=",");var r=a[i];e+=r.Value.toString()}var n=t.Out?t.Out:"ALL",s="("+t.Symbol+","+t.PeriodID+"), "+t.Name+"("+e+")=>"+n;return s},this.CallMemberScriptIndex=function(t){var e=this;if(t.Member.Object.Type!=dn.Identifier||t.Member.Property.Type!=dn.Identifier){var a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"CallMemberScriptIndex() Error: åæ°éè¯¯")}var i=t.Member.Object.Name,r=t.Member.Property.Name;if(""==r||null==r){a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"CallMemberScriptIndex() Error: "+i+"."+r+" ææ è¾åºåééè¯¯")}if(this.Execute.VarTable.has(i)){var n=this.Execute.VarTable.get(i);if(n.hasOwnProperty(r))return w.Complier.Log("[JSSymbolData::CallMemberScriptIndex] index data "+i+"."+r+" in cache."),this.Execute.RunNextJob()}var s=i+"."+r,o={Job:t,PeriodID:this.Period,Symbol:this.Symbol};if(!this.ReadIndexFunctionValue(s,o)){a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"CallMemberScriptIndex() Error: '"+s+"' "+o.Error)}var h=new B,l=h.Get(o.Name);if(!l){a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"CallMemberScriptIndex() Error: '"+s+"' "+o.Name+" ææ ä¸å­å¨")}if(Array.isArray(l.Args)&&l.Args.length>0)for(var u in o.Args=[],l.Args){var C=l.Args[u];o.Args.push({Value:C.Value,Name:C.Name})}w.Complier.Log("[JSSymbolData::CallMemberScriptIndex] call script index",o);var D=this.Data.GetDateRange(),f={HQDataType:this.DataType,Symbol:o.Symbol,Name:"",Right:this.Right,Period:o.PeriodID,Data:null,SourceData:null,Callback:function(t,a,i){e.RecvMemberScriptIndexData(t,a,i),e.Execute.RunNextJob()},CallbackParam:o,Async:!0,MaxRequestDataCount:this.MaxRequestDataCount+60,MaxRequestMinuteDayCount:this.MaxRequestMinuteDayCount+2,Arguments:o.Args,IsBeforeData:this.IsBeforeData,NetworkFilter:this.NetworkFilter,KLineRange:D};Ln.Execute(l.Script,f,(function(t,a){e.ExecuteScriptIndexError(t,a)}))},this.CallScriptIndex=function(t){var e=this;if(t.Member)return this.CallMemberScriptIndex(t);if(!t.Args||!(t.Args.length>=2)){var a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"CallScriptIndex() Error: "+t.FunctionName+" åæ°éè¯¯")}var i={Job:t,PeriodID:this.Period};if(!this.ReadSymbolArgumentValue(t.Args[0],i)){a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"CallScriptIndex() Error: "+i.Error)}if(!this.ReadIndexFunctionValue(t.Args[1],i)){a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"CallScriptIndex() Error: "+i.Error)}var r=new B,n=r.Get(i.Name);if(!n){a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"CallScriptIndex() "+i.Name+" ææ ä¸å­å¨")}if(i.SytemIndex=n,!this.ReadIndexArgumentValue(t.Args,i)){a=t.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"CallScriptIndex() "+i.Name+" ææ åæ°éè¯¯ : "+i.Error+" ")}w.Complier.Log("[JSSymbolData::CallScriptIndex] call script index",i);var s=null;if(this.Data&&this.Data.Data.length>0){var o=this.Data.Data[0],h=this.Data.Data[this.Data.Data.length-1];s={Start:{Date:o.Date,Time:o.Time},End:{Date:h.Date,Time:h.Time}}}var l={HQDataType:this.DataType,Symbol:i.Symbol,Name:"",Right:this.Right,Period:i.PeriodID,Data:null,SourceData:null,Callback:function(t,a,i){e.RecvScriptIndexData(t,a,i),e.Execute.RunNextJob()},CallbackParam:i,Async:!0,MaxRequestDataCount:this.MaxRequestDataCount+60,MaxRequestMinuteDayCount:this.MaxRequestMinuteDayCount+2,Arguments:i.Args,IsBeforeData:this.IsBeforeData,NetworkFilter:this.NetworkFilter,KLineRange:s};Ln.Execute(i.SytemIndex.Script,l,(function(t,a){e.ExecuteScriptIndexError(t,a)}))},this.RecvMemberScriptIndexData=function(t,e,a){w.Complier.Log("[JSSymbolData::RecvMemberScriptIndexData] ",t,e,a);var i=a.Data.Data,r=t,n=this.Data.FitKLineIndex(i,r,this.Period,e.PeriodID),s=e.Job.Member,o=s.Object.Name,h=(s.Property.Name,{});for(var l in this.Execute.VarTable.has(o)?h=this.Execute.VarTable.get(o):this.Execute.VarTable.set(o,h),n){var u=t[l].Name;e.Period&&(u+="#"+e.Period),h[u]=n[l].Data}},this.RecvScriptIndexData=function(t,e,a){var i=this.GenerateScriptIndexKey(e);w.Complier.Log("[JSSymbolData::RecvScriptIndexData] ",t,e,a,i);var r=a.Data.Data,n=t;if(e.Out){for(var s in t){var o=t[s];if(o.Name==e.Out){n=[o];break}}var h=this.Data.FitKLineIndex(r,n,this.Period,e.PeriodID);this.ScriptIndexOutData.set(i,h[0].Data)}else{h=this.Data.FitKLineIndex(r,n,this.Period,e.PeriodID);var l={__Type__:"Object"};for(var s in h){o=h[s];l[o.Name]=o.Data}this.ScriptIndexOutData.set(i,l)}},this.ExecuteScriptIndexError=function(t,e){var a=e.Job.Token;this.Execute.ErrorHandler.ThrowError(a.Index,a.Line,0,"CallScriptIndex() "+e.Name+" ææ æ§è¡éè¯¯ : "+t+" ")},this.GetScriptIndexOutData=function(t,e){var a={PeriodID:this.Period};this.ReadSymbolArgumentValue(t[0],a)||this.Execute.ThrowUnexpectedNode(e,"STKINDI() è¡ç¥¨ä»£ç éè¯¯: "+a.Error),this.ReadIndexFunctionValue(t[1],a)||this.Execute.ThrowUnexpectedNode(e,"STKINDI() ææ éè¯¯: "+a.Error);var i=new B,r=i.Get(a.Name);r||this.Execute.ThrowUnexpectedNode(e,"STKINDI() ææ éè¯¯: "+a.Name+" ææ ä¸å­å¨"),a.SytemIndex=r,this.ReadIndexArgumentValue(t,a)||this.Execute.ThrowUnexpectedNode(e,"STKINDI()  ææ åæ°éè¯¯: "+a.Error);var n=this.GenerateScriptIndexKey(a);return this.ScriptIndexOutData.has(n)?this.ScriptIndexOutData.get(n):null},this.JsonDataToHistoryData=function(t){for(var e=t.data,a=new Array,i=0,r=1,n=2,s=3,o=4,h=5,l=6,u=7,C=8,D=9,f=10,c=11,d=0;d<e.length;++d){var m=new xt;m.Date=e[d][i],m.Open=e[d][n],m.YClose=e[d][r],m.Close=e[d][h],m.High=e[d][s],m.Low=e[d][o],m.Vol=e[d][l],m.Amount=e[d][u],e[d].length>C&&(m.Up=e[d][C]),e[d].length>D&&(m.Down=e[d][D]),e[d].length>f&&(m.Stop=e[d][f]),e[d].length>c&&(m.Unchanged=e[d][c]),isNaN(m.Open)||m.Open<=0||a.push(m)}return a},this.JsonDataToMinuteHistoryData=function(t){for(var e=t.data,a=new Array,i=0,r=1,n=2,s=3,o=4,h=5,l=6,u=7,C=8,D=0;D<e.length;++D){var f=new xt;f.Date=e[D][i],f.Open=e[D][n],f.YClose=e[D][r],f.Close=e[D][h],f.High=e[D][s],f.Low=e[D][o],f.Vol=e[D][l],f.Amount=e[D][u],f.Time=e[D][C],a.push(f)}for(var c=0;c<a.length;++c){var d=a[c];if(null==d&&coninue,isNaN(d.Open)||d.Open<=0||isNaN(d.High)||d.High<=0||isNaN(d.Low)||d.Low<=0||isNaN(d.Close)||d.Close<=0||isNaN(d.YClose)||d.YClose<=0)if(0==c)d.YClose>0&&(d.Open=d.YClose,d.High=d.YClose,d.Low=d.YClose,d.Close=d.YClose);else for(var m=c-1;m>=0;--m){var v=a[m];if(null==v&&coninue,v.Open>0&&v.High>0&&v.Low>0&&v.Close>0){d.YClose<=0&&(d.YClose=v.Close),d.Open=v.Open,d.High=v.High,d.Low=v.Low,d.Close=v.Close;break}}}return a},this.JsonDataToMinuteData=function(t){var e=new Array;for(var a in t.stock[0].minute){var i=t.stock[0].minute[a],r=new Ft;r.Close=i.price,r.Open=i.open,r.High=i.high,r.Low=i.low,r.Vol=i.vol,r.Amount=i.amount,r.DateTime=0==a?t.stock[0].date.toString()+" 0925":t.stock[0].date.toString()+" "+i.time.toString(),r.Date=t.stock[0].date,r.Time=i.time,r.Increase=i.increase,r.Risefall=i.risefall,r.AvPrice=i.avprice,e[a]=r}return e},this.JsonDataToMultiDayMinuteData=function(t){var e=t.symbol,a=e.toUpperCase(),i=Br.IsSHSZ(a),r=(Br.IsChinaFutures(a),[]);for(var n in t.data){var s=[],o=t.data[n],h=o.date,l=o.yclose,u=l,C=null;for(var D in o.minute){var f=o.minute[D];f[2]&&(u=f[2]);var c=new Ft;c.Close=f[2],c.Open=f[1],c.High=f[3],c.Low=f[4],c.Vol=f[5]/100,c.Amount=f[6],7<f.length&&f[7]>0&&(c.AvPrice=f[7],C=f[7]),c.DateTime=h.toString()+" "+f[0].toString(),c.Date=h,c.Time=f[0],c.Close||(c.Close=u,c.Open=c.High=c.Low=c.Close),!c.AvPrice&&C&&(c.AvPrice=C),c.Close&&l?c.Increase=(c.Close-l)/l*100:c.Increase=null,0==D&&(i&&(c.DateTime=h.toString()+" 0925"),c.IsFristData=!0),c.Open<=0&&(c.Open=null),c.Close<=0&&(c.Close=null),c.AvPrice<=0&&(c.AvPrice=null),c.High<=0&&(c.High=null),c.Low<=0&&(c.Low=null),c.AvPrice<=0&&(c.AvPrice=null),s[D]=c}var d=new Ot;d.Data=s,d.YClose=l,d.Close=o.close,d.Date=h,r.push(d)}for(s=[],n=r.length-1;n>=0;--n){c=r[n];for(var D in c.Data)s.push(c.Data[D])}return s},this.CODELIKE=function(t){return this.Symbol&&0==this.Symbol.indexOf(t)?1:0},this.NAMELIKE=function(t){return this.Name&&0==this.Name.indexOf(t)?1:0},this.SETCODE=function(){return this.Symbol.indexOf(".sh")?1:(this.Symbol.indexOf(".sz"),0)},this.GetSymbol=function(){return this.Symbol},this.GetName=function(){return this.Name},this.DATE=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e in this.Data.Data){var a=this.Data.Data[e];t[e]=a.Date-19e6}return t},this.YEAR=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e in this.Data.Data){var a=this.Data.Data[e];this.IsNumber(a.Date)?t[e]=parseInt(a.Date/1e4):t[e]=null}return t},this.DAY=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e in this.Data.Data){var a=this.Data.Data[e];this.IsNumber(a.Date)?t[e]=parseInt(a.Date%100):t[e]=null}return t},this.MONTH=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e in this.Data.Data){var a=this.Data.Data[e];this.IsNumber(a.Date)?t[e]=parseInt(a.Date%1e4/100):t[e]=null}return t},this.TIME=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e=0;e<this.Data.Data.length;++e){var a=this.Data.Data[e];this.IsNumber(a.Time)?t[e]=a.Time:t[e]=0}return t},this.DateTime=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e=Ot.IsMinutePeriod(this.Period,!0),a=0;a<this.Data.Data.length;++a){var i=this.Data.Data[a];t[a]=e?1e4*i.Date+i.Time:i.Date}return t},this.WEEK=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;var e=new Date;for(var a in this.Data.Data){var i=this.Data.Data[a];if(t[a]=null,this.IsNumber(i.Date)){var r=parseInt(i.Date/1e4),n=parseInt(i.Date%1e4/100),s=i.Date%100;e.setFullYear(r),e.setMonth(n-1),e.setDate(s),t[a]=e.getDay()}}return t},this.REFDATE=function(t,e){var a=null;if(Array.isArray(e)?e.length>0&&(a=e[e.length-1]):this.IsNumber(e)&&(a=e),null==a)return null;a<5e6&&(a+=19e6);var i=null;for(var r in this.Data.Data)if(this.Data.Data[r].Date==a){i=parseInt(r);break}return null==i||i>=t.length?null:t[i]},this.PERIOD=function(){var t=[5,6,7,11,0,1,2,3,4,5,9];return this.Period>=0&&this.Period<=t.length-1?t[this.Period]:this.Period},this.GetDrawNull=function(){var t=[];if(!this.Data||!this.Data.Data||!this.Data.Data.length)return t;for(var e in this.Data.Data)t[e]=null;return t},this.SysParam=function(t,e){if(!this.DrawInfo)return[];if(2==t){if(e.IsUsePageData=!0,ha.IsNumber(this.DrawInfo.Start))return this.DrawInfo.Start+1}else if(3==t){if(e.IsUsePageData=!0,ha.IsNumber(this.DrawInfo.End))return this.DrawInfo.End+1}else{if(4==t){if(e.IsUsePageData=!0,!ha.IsNumber(this.DrawInfo.End)||!ha.IsNumber(this.DrawInfo.Start))return[];if(!this.Data||!ha.IsNonEmptyArray(this.Data.Data))return[];for(var a=null,i=this.DrawInfo.Start;i<=this.DrawInfo.End&&i<this.Data.Data.length;++i){var r=this.Data.Data[i];ha.IsNumber(r.High)&&((null==a||a<r.High)&&(a=r.High))}return a}if(5==t){if(e.IsUsePageData=!0,!ha.IsNumber(this.DrawInfo.End)||!ha.IsNumber(this.DrawInfo.Start))return[];if(!this.Data||!ha.IsNonEmptyArray(this.Data.Data))return[];var n=null;for(i=this.DrawInfo.Start;i<=this.DrawInfo.End&&i<this.Data.Data.length;++i){r=this.Data.Data[i];ha.IsNumber(r.Low)&&((null==n||n>r.Low)&&(n=r.Low))}return n}}return[]}}Tn.prototype.IsNumber=function(t){return null!=t&&!isNaN(t)},Tn.prototype.IsDivideNumber=function(t){return null!=t&&(!isNaN(t)&&0!=t)},Tn.prototype.JsonDataToFinance=function(t){for(var e,a=1;a<=4;++a){switch(a){case 1:var i=t.finance1,r=t.announcement1;break;case 2:i=t.finance2,r=t.announcement2;break;case 3:i=t.finance3,r=t.announcement3;break;case 4:i=t.finance4,r=t.announcement4;break;default:break}i&&r&&this.IsNumber(r.year)&&this.IsNumber(r.quarter)&&(e?e.Announcement.year<r.year&&(e={Date:t.date,Finance:i,Announcement:r}):e={Date:t.date,Finance:i,Announcement:r})}return e};var gn=!1,xn={JOB_DOWNLOAD_SYMBOL_DATA:1,JOB_DOWNLOAD_INDEX_DATA:2,JOB_DOWNLOAD_SYMBOL_LATEST_DATA:3,JOB_DOWNLOAD_INDEX_INCREASE_DATA:4,JOB_DOWNLOAD_VOLR_DATA:5,JOB_DOWNLOAD_LATEST_INDEX_DATA:8,JOB_DOWNLOAD_OTHER_SYMBOL_DATA:9,JOB_DOWNLOAD_SYMBOL_PERIOD_DATA:10,JOB_DOWNLOAD_FINVALUE:301,JOB_DOWNLOAD_FINONE:302,JOB_DOWNLOAD_FINANCE:303,JOB_DOWNLOAD_GPJYVALUE:304,JOB_DOWNLOAD_VARIANT:305,JOB_DOWNLOAD_SCJYVALUE:306,JOB_DOWNLOAD_MARGIN_BALANCE:1e3,JOB_DOWNLOAD_MARGIN_RATE:1001,JOB_DOWNLOAD_MARGIN_BUY_BALANCE:1010,JOB_DOWNLOAD_MARGIN_BUY_AMOUNT:1011,JOB_DOWNLOAD_MARGIN_BUY_REPAY:1012,JOB_DOWNLOAD_MARGIN_BUY_NET:1013,JOB_DOWNLOAD_MARGIN_SELL_BALANCE:1020,JOB_DOWNLOAD_MARGIN_SELL_VOLUME:1021,JOB_DOWNLOAD_MARGIN_SELL_REPAY:1022,JOB_DOWNLOAD_MARGIN_SELL_NET:1023,JOB_DOWNLOAD_NEWS_ANALYSIS_NEGATIVE:2e3,JOB_DOWNLOAD_NEWS_ANALYSIS_RESEARCH:2001,JOB_DOWNLOAD_NEWS_ANALYSIS_INTERACT:2002,JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE:2003,JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2:2004,JOB_DOWNLOAD_NEWS_ANALYSIS_TRUSTHOLDER:2005,JOB_DOWNLOAD_NEWS_ANALYSIS_BLOCKTRADING:2006,JOB_DOWNLOAD_NEWS_ANALYSIS_COMPANYNEWS:2007,JOB_DOWNLOAD_NEWS_ANALYSIS_TOPMANAGERS:2008,JOB_DOWNLOAD_NEWS_ANALYSIS_PLEDGE:2009,JOB_DOWNLOAD_HK_TO_SH:2050,JOB_DOWNLOAD_HK_TO_SZ:2051,JOB_DOWNLOAD_HK_TO_SH_SZ:2052,JOB_DOWNLOAD_HK_TO_SHSZ:2053,JOB_CUSTOM_FUNCTION_DATA:6e3,JOB_CUSTOM_VARIANT_DATA:6001,JOB_DOWNLOAD_SECTION_SF:2e4,JOB_DOWNLOAD_SECTION_F_01:20001,JOB_DOWNLOAD_SECTION_F_02:20002,JOB_DOWNLOAD_SECTION_F_03:20003,JOB_DOWNLOAD_SECTION_F_04:20004,JOB_DOWNLOAD_SECTION_F_05:20005,JOB_DOWNLOAD_SECTION_F_06:20006,JOB_DOWNLOAD_SECTION_F_07:20007,JOB_DOWNLOAD_SECTION_F_08:20008,JOB_DOWNLOAD_SECTION_F_09:20009,JOB_DOWNLOAD_SECTION_F_10:20010,JOB_DOWNLOAD_SECTION_F_11:20011,JOB_DOWNLOAD_SECTION_F_12:20012,JOB_DOWNLOAD_SECTION_F_13:20013,JOB_DOWNLOAD_SECTION_F_14:20014,JOB_DOWNLOAD_SECTION_F_15:20015,JOB_DOWNLOAD_SECTION_F_16:20016,JOB_DOWNLOAD_SECTION_F_17:20017,JOB_DOWNLOAD_SECTION_F_18:20018,JOB_DOWNLOAD_SECTION_F_19:20019,JOB_DOWNLOAD_SECTION_F_20:20020,JOB_DOWNLOAD_SECTION_F_21:20021,JOB_DOWNLOAD_SECTION_F_22:20022,JOB_DOWNLOAD_SECTION_F_23:20023,JOB_DOWNLOAD_SECTION_F_24:20024,JOB_DOWNLOAD_SECTION_F_25:20025,JOB_DOWNLOAD_SECTION_F_26:20026,JOB_DOWNLOAD_SECTION_F_27:20027,JOB_DOWNLOAD_SECTION_F_28:20028,JOB_DOWNLOAD_SECTION_F_29:20029,JOB_DOWNLOAD_SECTION_F_30:20030,JOB_DOWNLOAD_SECTION_F_31:20031,JOB_DOWNLOAD_SECTION_F_32:20032,JOB_DOWNLOAD_SECTION_F_33:20033,JOB_DOWNLOAD_SECTION_F_34:20034,JOB_DOWNLOAD_SECTION_F_35:20035,JOB_DOWNLOAD_SECTION_F_36:20036,JOB_DOWNLOAD_SECTION_F_37:20037,JOB_DOWNLOAD_SECTION_F_38:20038,JOB_DOWNLOAD_SECTION_F_39:20039,JOB_DOWNLOAD_CUSTOM_API_DATA:3e4,JOB_EXECUTE_INDEX:30010,JOB_RUN_SCRIPT:1e4,GetMarginJobID:function(t){var e=new E.default([[1,xn.JOB_DOWNLOAD_MARGIN_BALANCE],[2,xn.JOB_DOWNLOAD_MARGIN_RATE],[3,xn.JOB_DOWNLOAD_MARGIN_BUY_BALANCE],[4,xn.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT],[5,xn.JOB_DOWNLOAD_MARGIN_BUY_REPAY],[6,xn.JOB_DOWNLOAD_MARGIN_BUY_NET],[7,xn.JOB_DOWNLOAD_MARGIN_SELL_BALANCE],[8,xn.JOB_DOWNLOAD_MARGIN_SELL_VOLUME],[9,xn.JOB_DOWNLOAD_MARGIN_SELL_REPAY],[10,xn.JOB_DOWNLOAD_MARGIN_SELL_NET]]);return e.has(t)?e.get(t):null},GetNewsAnalysisID:function(t){var e=new E.default([[1,xn.JOB_DOWNLOAD_NEWS_ANALYSIS_NEGATIVE],[2,xn.JOB_DOWNLOAD_NEWS_ANALYSIS_RESEARCH],[3,xn.JOB_DOWNLOAD_NEWS_ANALYSIS_INTERACT],[4,xn.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE],[5,xn.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2],[6,xn.JOB_DOWNLOAD_NEWS_ANALYSIS_TRUSTHOLDER],[7,xn.JOB_DOWNLOAD_NEWS_ANALYSIS_BLOCKTRADING],[8,xn.JOB_DOWNLOAD_NEWS_ANALYSIS_COMPANYNEWS],[9,xn.JOB_DOWNLOAD_NEWS_ANALYSIS_TOPMANAGERS],[10,xn.JOB_DOWNLOAD_NEWS_ANALYSIS_PLEDGE]]);return e.has(t)?e.get(t):null},GetSectionFinanceID:function(t){var e=new E.default([["æµå¨èµäº§",xn.JOB_DOWNLOAD_SECTION_F_01],["è´§å¸èµé",xn.JOB_DOWNLOAD_SECTION_F_02],["å­è´§",xn.JOB_DOWNLOAD_SECTION_F_03],["æµå¨è´åº",xn.JOB_DOWNLOAD_SECTION_F_04],["éæµå¨è´åº",xn.JOB_DOWNLOAD_SECTION_F_05],["ä¸é¡¹è´¹ç¨",xn.JOB_DOWNLOAD_SECTION_F_06],["æèµæ¶ç",xn.JOB_DOWNLOAD_SECTION_F_07],["å½æ¯åå©æ¶¦",xn.JOB_DOWNLOAD_SECTION_F_08],["æ£éåå©æ¶¦",xn.JOB_DOWNLOAD_SECTION_F_09],["æ£éæ¯è¡æ¶ç",xn.JOB_DOWNLOAD_SECTION_F_10],["å æå¹³ååèµäº§æ¶ç",xn.JOB_DOWNLOAD_SECTION_F_11],["å¨å»ºå·¥ç¨",xn.JOB_DOWNLOAD_SECTION_F_12],["ç´¯è®¡ææ§",xn.JOB_DOWNLOAD_SECTION_F_13],["å°æ°è¡ä¸å©æ¶¦",xn.JOB_DOWNLOAD_SECTION_F_14],["æ±åæç",xn.JOB_DOWNLOAD_SECTION_F_15],["åè´¦è®¡æ",xn.JOB_DOWNLOAD_SECTION_F_16],["åºå®èµäº§",xn.JOB_DOWNLOAD_SECTION_F_17],["å½æææ§",xn.JOB_DOWNLOAD_SECTION_F_18],["è¥ä¸æ»æ¶å¥",xn.JOB_DOWNLOAD_SECTION_F_19],["ä¸»è¥ä¸å¡å©æ¶¦",xn.JOB_DOWNLOAD_SECTION_F_20],["è¥ä¸å©æ¶¦",xn.JOB_DOWNLOAD_SECTION_F_21],["åå©æ¶¦",xn.JOB_DOWNLOAD_SECTION_F_22],["åºæ¶è´¦æ¬¾",xn.JOB_DOWNLOAD_SECTION_F_23],["è´¢å¡è´¹ç¨",xn.JOB_DOWNLOAD_SECTION_F_24],["ç»è¥æ§ç°éæµ",xn.JOB_DOWNLOAD_SECTION_F_25],["èµäº§æ»è®¡",xn.JOB_DOWNLOAD_SECTION_F_26],["è´åºæ»è®¡",xn.JOB_DOWNLOAD_SECTION_F_27],["ææèæçæ»è®¡",xn.JOB_DOWNLOAD_SECTION_F_28],["æ¯å©ç",xn.JOB_DOWNLOAD_SECTION_F_29],["æ¯è¡èµæ¬å¬ç§¯é",xn.JOB_DOWNLOAD_SECTION_F_30],["æ¯è¡æªåéå©æ¶¦",xn.JOB_DOWNLOAD_SECTION_F_31],["æ¯è¡æ¶ç",xn.JOB_DOWNLOAD_SECTION_F_32],["æ¯è¡åèµäº§",xn.JOB_DOWNLOAD_SECTION_F_33],["æ¯è¡ç»è¥æ§ç°éæµ",xn.JOB_DOWNLOAD_SECTION_F_34],["æ£éåå©æ¶¦æ¶¨å¹",xn.JOB_DOWNLOAD_SECTION_F_35],["æ£éåå©æ¶¦æ¶¨é",xn.JOB_DOWNLOAD_SECTION_F_36],["åå©æ¶¦æ¶¨å¹",xn.JOB_DOWNLOAD_SECTION_F_37],["èµäº§è´åºç",xn.JOB_DOWNLOAD_SECTION_F_38],["å©æ¶¦åæ¯",xn.JOB_DOWNLOAD_SECTION_F_39]]);return e.has(t)?e.get(t):null},GetSectionReportPeriod:function(t,e){return t>=2e3&&e>=1&&e<=4?{Year:t,Quarter:e}:null}};function Fn(t,e){var a=this;this.AST=t,this.ErrorHandler=new Dn,this.VarTable=new E.default,this.OutVarTable=[],this.Arguments=[],this.ErrorCallback,this.GetEventCallback,this.IsUsePageData=!1,this.IndexCtrl,this.Debug=0,this.DebugFilter,this.ConstVarTable=new E.default([["CLOSE",null],["VOL",null],["OPEN",null],["HIGH",null],["LOW",null],["AMOUNT",null],["C",null],["V",null],["O",null],["H",null],["L",null],["AMO",null],["VOLR",null],["VOLINSTK",null],["OPI",null],["QHJSJ",null],["SETTLE",null],["ZSTJJ",null],["ISEQUAL",null],["ISUP",null],["ISDOWN"],["DATE",null],["YEAR",null],["MONTH",null],["PERIOD",null],["WEEK",null],["TIME",null],["DAY",null],["DATETIME",null],["INDEXA",null],["INDEXC",null],["INDEXH",null],["INDEXL",null],["INDEXO",null],["INDEXV",null],["INDEXADV",null],["INDEXDEC",null],["ADVANCE",null],["DECLINE",null],["FROMOPEN",null],["TOTALFZNUM",null],["CURRBARSCOUNT",null],["TOTALBARSCOUNT",null],["ISLASTBAR",null],["BARSTATUS",null],["BARPOS",null],["CAPITAL",null],["TOTALCAPITAL",null],["EXCHANGE",null],["SETCODE",null],["CODE",null],["STKNAME",null],["TQFLAG",null],["HYBLOCK",null],["DYBLOCK",null],["GNBLOCK",null],["FGBLOCK",null],["ZSBLOCK",null],["ZHBLOCK",null],["ZDBLOCK",null],["HYZSCODE",null],["GNBLOCKNUM",null],["FGBLOCKNUM",null],["ZSBLOCKNUM",null],["ZHBLOCKNUM",null],["ZDBLOCKNUM",null],["HYSYL",null],["HYSJL",null],["DRAWNULL",null],["NULL",null],["MACHINEDATE",null],["MACHINETIME",null],["MACHINEWEEK",null]]),this.SymbolData=new Tn(this.AST,e,this),this.Algorithm=new Sn(this.ErrorHandler,this.SymbolData),this.Draw=new In(this.ErrorHandler,this.SymbolData),this.JobList=[],this.UpdateUICallback=null,this.CallbackParam=null,this.IsSectionMode=!1,e&&(e.Callback&&(this.UpdateUICallback=e.Callback),e.CallbackParam&&(this.CallbackParam=e.CallbackParam,this.CallbackParam.HQChart&&(this.GetEventCallback=function(t){return a.CallbackParam.HQChart.GetEventCallback(t)})),e.Arguments&&(this.Arguments=e.Arguments),e.IsSectionMode&&(this.IsSectionMode=e.IsSectionMode),e.Self&&(this.IndexCtrl=e.Self),ha.IsNumber(e.Debug)&&(this.Debug=e.Debug),e.DebugFilter&&(this.DebugFilter=e.DebugFilter)),this.Execute=function(){for(var t in this.OutVarTable=[],this.VarTable=new E.default,w.Complier.Log("[JSExecute::Execute] Load Arguments",this.Arguments),this.Arguments){var e=this.Arguments[t];this.VarTable.set(e.Name,e.Value)}this.RunNextJob()},this.RunNextJob=function(){if(!(this.JobList.length<=0)){w.Complier.Log("[JSExecute::Execute] JobList",this.JobList);var t=this.JobList.shift();switch(t.ID){case xn.JOB_DOWNLOAD_SYMBOL_DATA:return this.SymbolData.GetSymbolData();case xn.JOB_DOWNLOAD_SYMBOL_PERIOD_DATA:return this.SymbolData.GetSymbolPeriodData(t);case xn.JOB_DOWNLOAD_INDEX_DATA:return this.SymbolData.GetIndexData();case xn.JOB_DOWNLOAD_LATEST_INDEX_DATA:return this.SymbolData.GetLatestIndexData();case xn.JOB_DOWNLOAD_INDEX_INCREASE_DATA:return this.SymbolData.GetIndexIncreaseData(t);case xn.JOB_DOWNLOAD_SYMBOL_LATEST_DATA:return this.SymbolData.GetLatestData(t);case xn.JOB_DOWNLOAD_VOLR_DATA:return this.SymbolData.GetVolRateData(t);case xn.JOB_DOWNLOAD_OTHER_SYMBOL_DATA:return this.SymbolData.GetOtherSymbolData(t);case xn.JOB_DOWNLOAD_RELEASE_DATE_DATA:return this.SymbolData.GetCompanyReleaseDate(t.ID);case xn.JOB_DOWNLOAD_MARGIN_BALANCE:case xn.JOB_DOWNLOAD_MARGIN_RATE:case xn.JOB_DOWNLOAD_MARGIN_BUY_BALANCE:case xn.JOB_DOWNLOAD_MARGIN_BUY_AMOUNT:case xn.JOB_DOWNLOAD_MARGIN_BUY_REPAY:case xn.JOB_DOWNLOAD_MARGIN_BUY_NET:case xn.JOB_DOWNLOAD_MARGIN_SELL_BALANCE:case xn.JOB_DOWNLOAD_MARGIN_SELL_VOLUME:case xn.JOB_DOWNLOAD_MARGIN_SELL_REPAY:case xn.JOB_DOWNLOAD_MARGIN_SELL_NET:return this.SymbolData.GetMarginData(t.ID);case xn.JOB_DOWNLOAD_NEWS_ANALYSIS_NEGATIVE:case xn.JOB_DOWNLOAD_NEWS_ANALYSIS_RESEARCH:case xn.JOB_DOWNLOAD_NEWS_ANALYSIS_INTERACT:case xn.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE:case xn.JOB_DOWNLOAD_NEWS_ANALYSIS_HOLDERCHANGE2:case xn.JOB_DOWNLOAD_NEWS_ANALYSIS_TRUSTHOLDER:case xn.JOB_DOWNLOAD_NEWS_ANALYSIS_BLOCKTRADING:case xn.JOB_DOWNLOAD_NEWS_ANALYSIS_COMPANYNEWS:case xn.JOB_DOWNLOAD_NEWS_ANALYSIS_TOPMANAGERS:case xn.JOB_DOWNLOAD_NEWS_ANALYSIS_PLEDGE:return this.SymbolData.GetNewsAnalysisData(t.ID);case xn.JOB_DOWNLOAD_HK_TO_SHSZ:return this.SymbolData.GetHKToSHSZData(t);case xn.JOB_DOWNLOAD_SECTION_SF:return this.SymbolData.GetSectionFinanceData(t);case xn.JOB_DOWNLOAD_FINONE:return this.SymbolData.GetFinOne(t);case xn.JOB_DOWNLOAD_FINVALUE:return this.SymbolData.GetFinValue(t);case xn.JOB_DOWNLOAD_FINANCE:return this.SymbolData.GetFinance(t);case xn.JOB_DOWNLOAD_GPJYVALUE:return this.SymbolData.GetGPJYValue(t);case xn.JOB_DOWNLOAD_SCJYVALUE:return this.SymbolData.GetSCJYValue(t);case xn.JOB_DOWNLOAD_VARIANT:return this.SymbolData.GetVariantData(t);case xn.JOB_CUSTOM_VARIANT_DATA:return this.SymbolData.GetCustomVariantData(t);case xn.JOB_CUSTOM_FUNCTION_DATA:return this.SymbolData.GetCustomFunctionData(t);case xn.JOB_DOWNLOAD_CUSTOM_API_DATA:return this.SymbolData.DownloadCustomAPIData(t);case xn.JOB_EXECUTE_INDEX:return this.SymbolData.CallScriptIndex(t);case xn.JOB_RUN_SCRIPT:return 1===this.Debug&&this.DebugFilter?this.DebugRun():this.Run()}}},this.ReadSymbolData=function(t,e){switch(t){case"CLOSE":case"C":case"VOL":case"V":case"OPEN":case"O":case"HIGH":case"H":case"LOW":case"L":case"AMOUNT":case"AMO":case"OPI":case"VOLINSTK":case"SETTLE":case"QHJSJ":case"ZSTJJ":case"ISEQUAL":case"ISUP":case"ISDOWN":return this.SymbolData.GetSymbolCacheData(t);case"VOLR":return this.SymbolData.GetVolRateCacheData(e);case"INDEXA":case"INDEXC":case"INDEXH":case"INDEXH":case"INDEXO":case"INDEXV":case"INDEXL":case"INDEXADV":case"INDEXDEC":return this.SymbolData.GetIndexCacheData(t);case"CURRBARSCOUNT":return this.SymbolData.GetCurrBarsCount();case"BARPOS":return this.SymbolData.GetBarPos();case"TOTALBARSCOUNT":return this.SymbolData.GetTotalBarsCount();case"TOTALFZNUM":return this.SymbolData.GetTotalTradeMinuteCount();case"ISLASTBAR":return this.SymbolData.GetIsLastBar();case"BARSTATUS":return this.SymbolData.GetBarStatus();case"TOTALCAPITAL":case"CAPITAL":case"EXCHANGE":case"HYBLOCK":case"DYBLOCK":case"GNBLOCK":case"FGBLOCK":case"ZSBLOCK":case"ZHBLOCK":case"ZDBLOCK":case"HYZSCODE":case"GNBLOCKNUM":case"FGBLOCKNUM":case"ZSBLOCKNUM":case"ZHBLOCKNUM":case"ZDBLOCKNUM":case"HYSYL":case"HYSJL":return this.SymbolData.GetStockCacheData({VariantName:t,Node:e});case"SETCODE":return this.SymbolData.SETCODE();case"CODE":return this.SymbolData.GetSymbol();case"STKNAME":return this.SymbolData.GetName();case"TIME":return this.SymbolData.TIME();case"DATE":return this.SymbolData.DATE();case"DATETIME":return this.SymbolData.DateTime();case"YEAR":return this.SymbolData.YEAR();case"MONTH":return this.SymbolData.MONTH();case"WEEK":return this.SymbolData.WEEK();case"DAY":return this.SymbolData.DAY();case"PERIOD":return this.SymbolData.PERIOD();case"FROMOPEN":return this.SymbolData.GetLatestIndexCacheData("FROMOPEN");case"DRAWNULL":case"NULL":return this.SymbolData.GetDrawNull();case"ADVANCE":case"DECLINE":return this.SymbolData.GetIndexIncreaseCacheData(t,this.SymbolData.Symbol,e);case"TQFLAG":return this.SymbolData.Right;case"MACHINEDATE":var a=new Date;return 1e4*a.getFullYear()+1*a.getMonth()*100+a.getDate()-19e6;case"MACHINETIME":a=new Date;return 1e4*a.getHours()+1*a.getMinutes()*100+a.getSeconds();case"MACHINEWEEK":a=new Date;return a.getDay()}},this.ReadCustomVariant=function(t,e){return this.SymbolData.GetStockCacheData({VariantName:t,Node:e})},this.ReadVariable=function(t,e){if(this.ConstVarTable.has(t)){var a=this.ConstVarTable.get(t);return null==a&&(a=this.ReadSymbolData(t,e),this.ConstVarTable.set(t,a)),a}if(sn.IsCustomVariant(t))return this.ReadCustomVariant(t,e);if(this.VarTable.has(t))return this.VarTable.get(t);if(t.indexOf("#")>0){var i=t.split("#");return this.SymbolData.GetSymbolPeriodCacheData(i[0],i[1])}if(0==t.indexOf("COLOR")){var r=Ln.ColorVarToRGB(t);if(r)return r}return this.ThrowUnexpectedNode(e,"åé"+t+"ä¸å­å¨",t),null},this.ReadMemberVariable=function(t){var e=t.Object,a=t.Property,i=void 0;if(i=e.Type==dn.BinaryExpression||e.Type==dn.LogicalExpression?this.VisitBinaryExpression(e):e.Type==dn.CallExpression?this.VisitCallExpression(e):this.GetNodeValue(e),!i)return null;var r=i[a.Name];return r||null},this.SingleDataToArrayData=function(t){for(var e=this.SymbolData.Data.Data.length,a=[],i=0;i<e;++i)a[i]=t;return a},this.RunAST=function(){this.AST||this.ThrowError(),this.AST.Body||this.ThrowError();for(var t=0;t<this.AST.Body.length;++t){var e=this.AST.Body[t];this.RunASTNode(e,t)}return w.Complier.Log("[JSExecute::Run]",this.VarTable),this.OutVarTable},this.RunASTNode=function(t,e){this.VisitNode(t);var a=e;if(t.Type==dn.ExpressionStatement&&t.Expression)if(t.Expression.Type==dn.AssignmentExpression){if(":"==t.Expression.Operator&&t.Expression.Left){var i=t.Expression,r=i.Left.Name,n=this.VarTable.get(r),s=0;if(n&&"object"==("undefined"===typeof n?"undefined":(0,d.default)(n))&&"Object"==n.__Type__)s=1e3;else if(!this.IsSectionMode&&!Array.isArray(n))if("string"==typeof n){var o=parseFloat(n);ha.IsNumber(o)?n=this.SingleDataToArrayData(o):(n=this.SingleDataToArrayData(n),s=1001)}else n=this.SingleDataToArrayData(n);this.OutVarTable.push({Name:r,Data:n,Type:s})}}else if(t.Expression.Type==dn.CallExpression){var h=t.Expression;if(this.Draw.IsDrawFunction(h.Callee.Name)){var l=h.Draw;l.Name=h.Callee.Name,this.OutVarTable.push({Name:l.Name,Draw:l,Type:1})}else{var u=h.Out;c="__temp_c_"+h.Callee.Name+"_"+a+"__";s=0;Array.isArray(u)||(u=this.SingleDataToArrayData(u)),this.OutVarTable.push({Name:c,Data:u,Type:s,NoneName:!0})}}else if(t.Expression.Type==dn.Identifier){var C=t.Expression.Name,D=this.ReadVariable(C,t.Expression);s=0;D&&"object"==("undefined"===typeof D?"undefined":(0,d.default)(D))&&"Object"==D.__Type__?s=1e3:this.IsSectionMode||Array.isArray(D)||(D="string"==typeof D?this.SingleDataToArrayData(parseFloat(D)):this.SingleDataToArrayData(D)),C="__temp_i_"+a+"__",this.OutVarTable.push({Name:C,Data:D,Type:s,NoneName:!0})}else if(t.Expression.Type==dn.Literal){var f=t.Expression.Value;ha.IsString(f)&&f.indexOf("$")>0&&(f=this.SymbolData.GetOtherSymolCacheData({Literal:f})),c="__temp_li_"+a+"__";s=0;this.OutVarTable.push({Name:c,Data:f,Type:s,NoneName:!0})}else if(t.Expression.Type==dn.BinaryExpression){var c="__temp_b_"+a+"__",m=t.Expression.Out;s=0;Array.isArray(m)||(m=this.SingleDataToArrayData(m)),this.OutVarTable.push({Name:c,Data:m,Type:s,NoneName:!0})}else if(t.Expression.Type==dn.LogicalExpression){c="__temp_l_"+a+"__";var v=t.Expression.Out;s=0;Array.isArray(v)||(v=this.SingleDataToArrayData(v)),this.OutVarTable.push({Name:c,Data:v,Type:s,NoneName:!0})}else if(t.Expression.Type==dn.SequenceExpression){for(var S=void 0,I=void 0,p=void 0,T=void 0,g=!1,x=!1,F=!1,y=!1,L=!1,E=!1,M=!1,A=!0,N=!1,w=!1,O=!1,R=!1,P=!0,b=!1,B=!1,V=!1,G=-1,H=-1,Y=-1,k=null,_=null,X=0;X<t.Expression.Expression.length;++X){var W=t.Expression.Expression[X];if(W.Type==dn.AssignmentExpression&&":"==W.Operator&&W.Left){if(0==X){S=W.Left.Name;var U=this.VarTable.get(S);Array.isArray(U)||(U=this.SingleDataToArrayData(U),this.VarTable.set(S,U))}}else if(W.Type==dn.Identifier){var K=W.Name;if("COLORSTICK"===K)g=!0;else if("POINTDOT"===K)x=!0;else if("CIRCLEDOT"===K)F=!0;else if("DOTLINE"===K)w=!0;else if("LINESTICK"===K)y=!0;else if("STICK"===K)L=!0;else if("VOLSTICK"===K)E=!0;else if("DRAWABOVE"===K)b=!0;else if("DRAWCENTER"===K)B=!0;else if("DRAWBELOW"==K)V=!0;else if("STEPLINE"==K)M=!0;else if(0==K.indexOf("COLOR"))p=K;else if(0==K.indexOf("LINETHICK"))T=K;else if("ALIGN0"==K)G=0;else if("ALIGN1"==K)G=1;else if("ALIGN2"==K)G=2;else if("VALIGN0"==K)H=0;else if("VALIGN1"==K)H=1;else if("VALIGN2"==K)H=2;else if(0==K.indexOf("NODRAW"))A=!1;else if(0==K.indexOf("EXDATA"))N=!0;else if(0==K.indexOf("LINEOVERLAY"))O=!0;else if(0==K.indexOf("NOTEXT")||0==K.indexOf("NOTITLE"))P=!1;else if(0==K.indexOf("FONTSIZE")){var J=K.replace("FONTSIZE","");Y=parseInt(J)}else if(0==X){S=W.Name;var z=this.ReadVariable(S,W);Array.isArray(z)||(z=this.SingleDataToArrayData(z)),S="__temp_si_"+a+"__",R=!0,this.VarTable.set(S,z)}}else if(W.Type==dn.Literal){if(0==X){var q=this.SingleDataToArrayData(W.Value);S=W.Value.toString(),this.VarTable.set(S,q)}}else if(W.Type==dn.CallExpression)if(0==X)if(this.Draw.IsDrawFunction(W.Callee.Name))I=W.Draw,I.Name=W.Callee.Name;else{var Z=W.Out;S="__temp_sc_"+W.Callee.Name+"_"+a+"__",R=!0,this.VarTable.set(S,Z)}else if("RGB"==W.Callee.Name||"RGBA"==W.Callee.Name)p=W.Out;else if("SOUND"==W.Callee.Name){this.GetSoundEvent();S=null}else if("ICON"==W.Callee.Name){var Q=this.VarTable.get(S);Q&&(I=this.GetOutIconData(Q,W.Draw),I&&(I.Name=W.Callee.Name)),S=null}else"BACKGROUND"==W.Callee.Name?(k=W.Draw,S=null):"CKLINE"==W.Callee.Name&&(_=W.Draw,S=null);else if(W.Type==dn.BinaryExpression&&0==X){S="__temp_sb_"+a+"__";var j=W.Out;R=!0,this.VarTable.set(S,j)}}if(x&&S){var $=this.VarTable.get(S);Array.isArray($)||($=this.SingleDataToArrayData($));var tt={Name:S,Data:$,Radius:Oi.POINTDOT.Radius,Type:3};p&&(tt.Color=p),T&&(tt.LineWidth=T),this.OutVarTable.push(tt)}else if(F&&S){var et=this.VarTable.get(S);Array.isArray(et)||(et=this.SingleDataToArrayData(et));var at={Name:S,Data:et,Radius:Oi.CIRCLEDOT.Radius,Type:3};p&&(at.Color=p),T&&(at.LineWidth=T),this.OutVarTable.push(at)}else if(y&&S){var it=this.VarTable.get(S),rt={Name:S,Data:it,Type:4};p&&(rt.Color=p),T&&(rt.LineWidth=T),this.OutVarTable.push(rt)}else if(L&&S){var nt=this.VarTable.get(S),st={Name:S,Data:nt,Type:5};p&&(st.Color=p),T&&(st.LineWidth=T),this.OutVarTable.push(st)}else if(E&&S){var ot=this.VarTable.get(S),ht={Name:S,Data:ot,Type:6};p&&(ht.Color=p),this.OutVarTable.push(ht)}else if(g&&S){var lt=this.VarTable.get(S),ut={Name:S,Data:lt,Color:p,Type:2};T&&(ut.LineWidth=T),p&&(ut.Color=p),this.OutVarTable.push(ut)}else if(S&&p){var Ct=this.VarTable.get(S);Array.isArray(Ct)||(Ct=this.SingleDataToArrayData(Ct));var Dt={Name:S,Data:Ct,Color:p,Type:0};T&&(Dt.LineWidth=T),0==A&&(Dt.IsShow=!1),1==N&&(Dt.IsExData=!0),1==w&&(Dt.IsDotLine=!0),1==O&&(Dt.IsOverlayLine=!0),1==R&&(Dt.NoneName=!0),0==P&&(Dt.IsShowTitle=!1),1==M&&(Dt.Type=7),this.OutVarTable.push(Dt)}else if(I){var ft={Name:I.Name,Draw:I,Type:1};p&&(ft.Color=p),1==w&&(ft.IsDotLine=!0),T&&(ft.LineWidth=T),b&&(ft.IsDrawAbove=!0),B&&(ft.IsDrawCenter=!0),V&&(ft.IsDrawBelow=!0),G>=0&&(ft.DrawAlign=G),H>=0&&(ft.DrawVAlign=H),Y>0&&(ft.DrawFontSize=Y),k&&(ft.Background=k),_&&(ft.VerticalLine=_),this.OutVarTable.push(ft)}else if(S){var ct=this.VarTable.get(S),dt={Name:S,Data:ct,Type:0};p&&(dt.Color=p),T&&(dt.LineWidth=T),0==A&&(dt.IsShow=!1),1==N&&(dt.IsExData=!0),1==w&&(dt.IsDotLine=!0),1==O&&(dt.IsOverlayLine=!0),0==P&&(dt.IsShowTitle=!1),1==M&&(dt.Type=7),this.OutVarTable.push(dt)}}},this.GetOutIconData=function(t,e){if(Array.isArray(t)){for(var a=0;a<t.length&&a<e.DrawData.length;++a){var i=t[a];i<=0&&(e.DrawData[a]=null)}return e}return t?e:null},this.GetSoundEvent=function(){return this.GetEventCallback?this.GetEventCallback(G.ON_PLAY_SOUND):null},this.Run=function(){try{var t=this.RunAST();w.Complier.Log("[JSComplier.Run] execute finish",t),this.IndexCtrl&&(this.IndexCtrl.Status=0),this.UpdateUICallback&&(w.Complier.Log("[JSComplier.Run] invoke UpdateUICallback."),this.CallbackParam&&this.CallbackParam.Job&&this.CallbackParam.Job.ID==xn.JOB_EXECUTE_INDEX?this.UpdateUICallback(t,this.CallbackParam,this.SymbolData):(this.CallbackParam&&this.CallbackParam.Self&&"ScriptIndexConsole"===this.CallbackParam.Self.ClassName&&(this.CallbackParam.JSExecute=this),1==this.IsUsePageData&&(this.CallbackParam.Self.IsUsePageData=!0),this.UpdateUICallback(t,this.CallbackParam)))}catch(e){w.Complier.Log(e),e.Job?(w.Complier.Log("[JSComplier.Run] download job and reexectue",e.Job),this.JobList.push(e.Job),this.JobList.push({ID:xn.JOB_RUN_SCRIPT}),this.Execute()):this.ErrorCallback&&(this.IndexCtrl&&(this.IndexCtrl.Status=0),this.ErrorCallback(e,this.CallbackParam))}},this.DebugRun_End=function(){var t=this.OutVarTable;w.Complier.Log("[JSComplier.DebugRun_End] execute finish",t),this.IndexCtrl&&(this.IndexCtrl.Status=0),this.UpdateUICallback&&(w.Complier.Log("[JSComplier.DebugRun_End] invoke UpdateUICallback."),this.CallbackParam&&this.CallbackParam.Job&&this.CallbackParam.Job.ID==xn.JOB_EXECUTE_INDEX?this.UpdateUICallback(t,this.CallbackParam,this.SymbolData):(this.CallbackParam&&this.CallbackParam.Self&&"ScriptIndexConsole"===this.CallbackParam.Self.ClassName&&(this.CallbackParam.JSExecute=this),1==this.IsUsePageData&&(this.CallbackParam.Self.IsUsePageData=!0),this.UpdateUICallback(t,this.CallbackParam)))},this.DebugRun_Next=function(t){var e=this;if(t.ExeLine<t.LineCount){var a=this.AST.Body[t.ExeLine];this.RunASTNode(a),++t.ExeLine,this.DebugFilter(t,(function(){e.DebugRun_Next(t)}))}else this.DebugRun_End(),t.Status=2,this.DebugFilter(t,null)},this.DebugRun=function(){var t=this;try{this.AST||this.ThrowError(),this.AST.Body||this.ThrowError();var e={LineCount:this.AST.Body.length,ExeLine:0,Self:this,Status:1};this.DebugFilter(e,(function(){t.DebugRun_Next(e)}))}catch(a){this.ErrorCallback&&(this.IndexCtrl&&(this.IndexCtrl.Status=0),this.ErrorCallback(a,this.CallbackParam))}},this.VisitNode=function(t){switch(t.Type){case dn.SequenceExpression:this.VisitSequenceExpression(t);break;case dn.ExpressionStatement:this.VisitNode(t.Expression);break;case dn.AssignmentExpression:this.VisitAssignmentExpression(t);break;case dn.BinaryExpression:case dn.LogicalExpression:this.VisitBinaryExpression(t);break;case dn.CallExpression:this.VisitCallExpression(t);break}},this.VisitSequenceExpression=function(t){for(var e in t.Expression){var a=t.Expression[e];this.VisitNode(a)}},this.VisitCallExpression=function(t){var e=t.Callee.Name,a=[];for(var i in t.Arguments){var r=t.Arguments[i],n=void 0;n=r.Type==dn.BinaryExpression||r.Type==dn.LogicalExpression?this.VisitBinaryExpression(r):r.Type==dn.CallExpression?this.VisitCallExpression(r):this.GetNodeValue(r),a.push(n)}if(sn.IsCustomFunction(e)){var s=this.Algorithm.CallCustomFunction(e,a,this.SymbolData,t);return t.Out=[],t.Draw=null,s&&(s.Out&&(t.Out=s.Out),s.Draw&&(t.Draw=s.Draw)),t.Out}switch(e){case"DYNAINFO":t.Out=this.SymbolData.GetLatestCacheData(a[0]);break;case"STICKLINE":t.Draw=this.Draw.STICKLINE(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"DRAWTEXT":t.Draw=this.Draw.DRAWTEXT(a[0],a[1],a[2]),t.Out=[];break;case"DRAWTEXT_FIX":t.Draw=this.Draw.DRAWTEXT_FIX(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"SUPERDRAWTEXT":t.Draw=this.Draw.SUPERDRAWTEXT(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"DRAWICON":t.Draw=this.Draw.DRAWICON(a[0],a[1],a[2]),t.Out=[];break;case"ICON":t.Draw=this.Draw.ICON(a[0],a[1]),t.Out=[];break;case"BACKGROUND":t.Draw=this.Draw.BACKGROUND(a[0],a[1],a[2],a[3],a[4],a[5]),t.Out=[];break;case"CKLINE":t.Draw=this.Draw.CKLINE(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"DRAWLINE":t.Draw=this.Draw.DRAWLINE(a[0],a[1],a[2],a[3],a[4]),t.Out=t.Draw.DrawData;break;case"DRAWBAND":t.Draw=this.Draw.DRAWBAND(a[0],a[1],a[2],a[3]),t.Out=[];break;case"FILLRGN":a.length>=4?t.Draw=this.Draw.FILLRGN2(a):t.Draw=this.Draw.FILLRGN(a[0],a[1],a[2]),t.Out=[];break;case"FLOATRGN":t.Draw=this.Draw.FLOATRGN(a),t.Out=[];break;case"FILLTOPRGN":t.Draw=this.Draw.FILLBGRGN(1,a),t.Out=[];break;case"FILLBOTTOMRGN":t.Draw=this.Draw.FILLBGRGN(0,a),t.Out=[];break;case"FILLVERTICALRGN":t.Draw=this.Draw.FILLVERTICALRGN(a),t.Out=[];break;case"DRAWKLINE":case"DRAWKLINE1":t.Draw=this.Draw.DRAWKLINE(a[0],a[1],a[2],a[3]),t.Out=[];break;case"DRAWKLINE_IF":t.Draw=this.Draw.DRAWKLINE_IF(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"DRAWCOLORKLINE":t.Draw=this.Draw.DRAWCOLORKLINE(a[0],a[1],a[2]),t.Out=[];break;case"PLOYLINE":case"POLYLINE":t.Draw=this.Draw.POLYLINE(a[0],a[1]),t.Out=t.Draw.DrawData;break;case"DRAWNUMBER":t.Draw=this.Draw.DRAWNUMBER(a[0],a[1],a[2],a[3]),t.Out=t.Draw.DrawData.Value;break;case"DRAWNUMBER_FIX":t.Draw=this.Draw.DRAWNUMBER_FIX(a[0],a[1],a[2],a[3],a[4]),t.Out=t.Draw.DrawData.Value;break;case"DRAWCHANNEL":t.Draw=this.Draw.DRAWCHANNEL(a[0],a[1],a[2],a[3],a[4],a[5],a[6]),t.Out=[];break;case"RGB":t.Out=this.Draw.RGB(a[0],a[1],a[2]);break;case"RGBA":t.Out=this.Draw.RGBA(a[0],a[1],a[2],a[3]);break;case"PARTLINE":t.Draw=this.Draw.PARTLINE(a),t.Out=[];break;case"DRAWGBK":t.Draw=this.Draw.DRAWGBK(a[0],a[1],a[2],a[3]),t.Out=[];break;case"DRAWGBK2":t.Draw=this.Draw.DRAWGBK2(a[0],a[1],a[2],a[3]),t.Out=[];break;case"DRAWTEXT_LINE":t.Draw=this.Draw.DRAWTEXT_LINE(a[0],a[1],a[2],a[3],a[4],a[5],a[6]),t.Out=[];break;case"DRAWRECTREL":t.Draw=this.Draw.DRAWRECTREL(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"DRAWTEXTREL":t.Draw=this.Draw.DRAWTEXTREL(a[0],a[1],a[2]),t.Out=[];break;case"DRAWTEXTABS":t.Draw=this.Draw.DRAWTEXTABS(a[0],a[1],a[2]),t.Out=[];break;case"DRAWOVERLAYLINE":t.Draw=this.Draw.DRAWOVERLAYLINE(a[0],a[1],a[2]),t.Out=t.Draw.DrawData.Data;break;case"DRAWSL":t.Draw=this.Draw.DRAWSL(a[0],a[1],a[2],a[3],a[4]),t.Out=[];break;case"VERTLINE":t.Draw=this.Draw.VERTLINE(a[0],a[1]),t.Out=t.Draw.DrawData.Data;break;case"HORLINE":t.Draw=this.Draw.HORLINE(a[0],a[1],a[2],a[3]),t.Out=t.Draw.DrawData.Data;break;case"CODELIKE":t.Out=this.SymbolData.CODELIKE(a[0]);break;case"NAMELIKE":case"NAMEINCLUDE":t.Out=this.SymbolData.NAMELIKE(a[1]);break;case"REFDATE":t.Out=this.SymbolData.REFDATE(a[0],a[1]);break;case"FINANCE":t.Out=this.SymbolData.GetStockCacheData({FunctionName:e,Args:a,ArgCount:1,Node:t});break;case"FINVALUE":t.Out=this.SymbolData.GetStockCacheData({FunctionName:e,Args:a,ArgCount:1,Node:t});break;case"FINONE":t.Out=this.SymbolData.GetStockCacheData({FunctionName:e,Args:a,ArgCount:3,Node:t});break;case"GPJYVALUE":t.Out=this.SymbolData.GetStockCacheData({FunctionName:e,Args:a,ArgCount:3,Node:t});break;case"SCJYVALUE":t.Out=this.SymbolData.GetStockCacheData({FunctionName:e,Args:a,ArgCount:3,Node:t});break;case"MARGIN":t.Out=this.SymbolData.GetMarginCacheData(a[0],t);break;case"HK2SHSZ":t.Out=this.SymbolData.GetHKToSHSZCacheData(a[0],t);break;case"NEWS":t.Out=this.SymbolData.GetNewsAnalysisCacheData(a[0],t);break;case"UPCOUNT":case"DOWNCOUNT":t.Out=this.SymbolData.GetIndexIncreaseCacheData(e,a[0],t);break;case"SF":t.Out=this.SymbolData.GetSectionFinanceCacheData(a[0],a[1],a[2],t);break;case"LOADAPIDATA":t.Out=this.SymbolData.GetCustomApiData(a);break;case"STKINDI":t.Out=this.SymbolData.GetScriptIndexOutData(a,t);break;case"SOUND":t.Draw=this.Draw.SOUND(a[0]),t.Out=[];break;case"PLAYSOUND":t.Draw=this.Draw.PLAYSOUND(a[0],a[1]),t.Out=[];break;case"CLOSE":case"C":case"VOL":case"V":case"OPEN":case"O":case"HIGH":case"H":case"LOW":case"L":case"AMOUNT":case"AMO":t.Out=this.SymbolData.GetOtherSymolCacheData({FunctionName:e,Args:a});break;case"INBLOCK":t.Out=this.SymbolData.IsInBlock(a[0],t);break;case"COVER_C":case"COVER_O":case"COVER_H":case"COVER_L":case"COVER_A":case"COVER_V":return 2==a.length?this.SymbolData.GetSymbolPeriodCacheData2(Cn.GetConvertValueName(e),a[0],a[1]):this.SymbolData.GetSymbolPeriodCacheData(Cn.GetConvertValueName(e),a[0]);case"SYSPARAM":return this.SymbolData.SysParam(a[0],this);default:t.Out=this.Algorithm.CallFunction(e,a,t,this.SymbolData);break}return t.Out},this.VisitAssignmentExpression=function(t){var e=t.Left;e.Type!=dn.Identifier&&this.ThrowUnexpectedNode(t);var a=e.Name,i=t.Right,r=null;if(i.Type==dn.BinaryExpression||i.Type==dn.LogicalExpression)r=this.VisitBinaryExpression(i);else if(i.Type==dn.CallExpression)r=this.VisitCallExpression(i);else if(i.Type==dn.Literal)r=i.Value,ha.IsString(r)&&i.Value.indexOf("$")>0&&(r=this.SymbolData.GetOtherSymolCacheData({Literal:r}));else if(i.Type==dn.Identifier)r=this.ReadVariable(i.Name,i);else if(i.Type==dn.MemberExpression)r=this.ReadMemberVariable(i);else if(i.Type==dn.UnaryExpression)if("-"==i.Operator){var n=this.GetNodeValue(i.Argument);r=this.Algorithm.Subtract(0,n)}else r=i.Argument.Value;gn&&w.Complier.Log("[JSExecute::VisitAssignmentExpression]",a," = ",r),this.VarTable.set(a,r)},this.VisitBinaryExpression=function(t){var e=[];e.push(t);var a=null;while(0!=e.length)if(a=e[e.length-1],a.Left&&t!=a.Left&&t!=a.Right)e.push(a.Left);else if(a.Right&&t!=a.Right)e.push(a.Right);else{var i=e.pop();if(i.Type==dn.BinaryExpression){var r=this.GetNodeValue(i.Left),n=this.GetNodeValue(i.Right);switch(gn&&w.Complier.Log("[JSExecute::VisitBinaryExpression] BinaryExpression",i,r,n),i.Out=null,i.Operator){case"-":i.Out=this.Algorithm.Subtract(r,n);break;case"*":i.Out=this.Algorithm.Multiply(r,n);break;case"/":i.Out=this.Algorithm.Divide(r,n);break;case"+":i.Out=this.Algorithm.Add(r,n);break;case">":i.Out=this.Algorithm.GT(r,n);break;case">=":i.Out=this.Algorithm.GTE(r,n);break;case"<":i.Out=this.Algorithm.LT(r,n);break;case"<=":i.Out=this.Algorithm.LTE(r,n);break;case"==":case"=":i.Out=this.Algorithm.EQ(r,n);break;case"!=":case"<>":i.Out=this.Algorithm.NEQ(r,n);break}gn&&w.Complier.Log("[JSExecute::VisitBinaryExpression] BinaryExpression",i)}else if(i.Type==dn.LogicalExpression){var s=this.GetNodeValue(i.Left),o=this.GetNodeValue(i.Right);switch(gn&&w.Complier.Log("[JSExecute::VisitBinaryExpression] LogicalExpression",i,s,o),i.Out=null,i.Operator){case"&&":case"AND":i.Out=this.Algorithm.And(s,o);break;case"||":case"OR":i.Out=this.Algorithm.Or(s,o);break}gn&&w.Complier.Log("[JSExecute::VisitBinaryExpression] LogicalExpression",i)}t=a}return t.Out},this.GetNodeValue=function(t){switch(t.Type){case dn.Literal:return t.Value;case dn.UnaryExpression:if("-"==t.Operator){var e=this.GetNodeValue(t.Argument);return this.Algorithm.Subtract(0,e)}return t.Argument.Value;case dn.Identifier:var a=this.ReadVariable(t.Name,t);return a;case dn.BinaryExpression:case dn.LogicalExpression:return t.Out;case dn.CallExpression:return this.VisitCallExpression(t);case dn.MemberExpression:return this.ReadMemberVariable(t);default:this.ThrowUnexpectedNode(t)}},this.ThrowUnexpectedNode=function(t,e,a){var i=t.Marker,r=e||"æ§è¡å¼å¸¸";return this.ErrorHandler.ThrowError(i.Index,i.Line,i.Column,r,a)},this.ThrowDownloadSF=function(t,e,a){var i=t.Marker,r=a;return this.ErrorHandler.ThrowDownloadJob(i.Index,i.Line,i.Column,r,e)},this.ThrowError=function(){}}function yn(t,e){this.AST=t,this.ErrorHandler=new Dn,this.ErrorCallback,this.UpdateUICallback,this.CallbackParam,this.JobList=[],this.VarTable=new E.default,this.OutVarTable=[],this.ConstVarTable=new E.default([["CLOSE","æ¶çä»·"],["VOL","æäº¤é"],["OPEN","å¼çä»·"],["HIGH","æé«ä»·"],["LOW","æä½ä»·"],["AMOUNT","æäº¤é"],["C","æ¶çä»·"],["V","æäº¤é"],["O","å¼çä»·"],["H","æé«ä»·"],["L","æä½ä»·"],["AMO","æäº¤é"],["VOLR","éæ¯"],["VOLINSTK","æä»é"],["OPI","æä»é"],["ZSTJJ","åä»·"],["QHJSJ","ç»ç®ä»·"],["SETTLE","ç»ç®ä»·"],["DATE","æ¥æ"],["YEAR","å¹´ä»½"],["MONTH","æä»½"],["PERIOD","å¨æ"],["WEEK","ææ"],["TIME","æ¶é´"],["INDEXA","å¤§çæäº¤é¢"],["INDEXC","å¤§çæ¶çä»·"],["INDEXH","å¤§çæé«ä»·"],["INDEXL","å¤§çæä½ä»·"],["INDEXO","å¤§çå¼çä»·"],["INDEXV","å¤§çæäº¤é"],["INDEXADV","å¤§çä¸æ¶¨å®¶æ°"],["INDEXDEC","Â´å¤§çä¸è·å®¶æ°"],["ADVANCE","ä¸æ¶¨å®¶æ°"],["DECLINE","ä¸è·å®¶æ°"],["FROMOPEN","å½åç¦»å¼çåéæ°"],["TOTALFZNUM","æ»åéæ°"],["CURRBARSCOUNT","å°æåäº¤æçå¨æ"],["TOTALBARSCOUNT","æ»çå¨ææ°"],["ISLASTBAR","æ¯å¦æ¯æåä¸ä¸ªå¨æ"],["BARSTATUS","æ°æ®ä½ç½®ç¶æ"],["CAPITAL","å½åæµéè¡æ¬(æ)"],["TOTALCAPITAL","å½åæ»è¡æ¬(æ)"],["EXCHANGE","æ¢æç"],["SETCODE","å¸åºç±»å"],["CODE","åç§ä»£ç "],["STKNAME","åç§åç§°"],["TQFLAG","å½åå¤æç¶æ"],["HYBLOCK","æå±è¡ä¸"],["DYBLOCK","æå±å°å"],["GNBLOCK","æå±æ¦å¿µ"],["FGBLOCK","æå±é£æ ¼æ¿å"],["ZSBLOCK","æå±ææ°æ¿å"],["ZHBLOCK","æå±ç»åæ¿å"],["ZDBLOCK","æå±èªå®ä¹æ¿å"],["HYZSCODE","æå±è¡ä¸çæ¿åææ°ä»£ç "],["GNBLOCKNUM","æå±æ¦å¿µæ¿åçä¸ªæ°"],["FGBLOCKNUM","æå±é£æ ¼æ¿åçä¸ªæ°"],["ZSBLOCKNUM","æå±ææ°æ¿åçä¸ªæ°"],["ZHBLOCKNUM","æå±ç»åæ¿åçä¸ªæ°"],["ZDBLOCKNUM","æå±èªå®ä¹æ¿åçä¸ªæ°"],["HYSYL","ææ°å¸ççæä¸ªè¡æå±è¡ä¸çå¸çç"],["HYSJL","ææ°å¸åçæä¸ªè¡æå±è¡ä¸çå¸åç"],["DRAWNULL","æ ææ°æ®"]]),e&&(e.Callback&&(this.UpdateUICallback=e.Callback),e.CallbackParam&&(this.CallbackParam=e.CallbackParam),e.Arguments&&(this.Arguments=e.Arguments)),this.Run=function(){try{for(var t in this.OutVarTable=[],this.VarTable=new E.default,w.Complier.Log("[JSExecute::JSExplainer] Load Arguments",this.Arguments),this.Arguments){var e=this.Arguments[t];this.VarTable.set(e.Name,e.Value)}var a=this.RunAST();w.Complier.Log("[JSExplainer.Run] explain finish",a),this.UpdateUICallback&&(w.Complier.Log("[JSExplainer.Run] invoke UpdateUICallback."),this.UpdateUICallback(a))}catch(i){w.Complier.Log("[JSExplainer.Run] throw error ",i),this.ErrorCallback&&this.ErrorCallback(i,this.OutVarTable)}},this.RunAST=function(){for(var t in this.AST||this.ThrowError(),this.AST.Body||this.ThrowError(),this.AST.Body){var e=this.AST.Body[t];if(this.VisitNode(e),e.Type==dn.ExpressionStatement&&e.Expression)if(e.Expression.Type==dn.AssignmentExpression){if(":"==e.Expression.Operator&&e.Expression.Left){var a=e.Expression,i=a.Left.Name,r="è¾åº"+i+": "+this.VarTable.get(i);this.OutVarTable.push({Name:i,Data:r,Type:0})}else if(":="==e.Expression.Operator&&e.Expression.Left){var n=e.Expression,s=n.Left.Name,o="èµå¼"+s+": "+this.VarTable.get(s);this.OutVarTable.push({Name:s,Data:o,Type:0,IsOut:!1})}}else if(e.Expression.Type==dn.CallExpression){var h=e.Expression;if(this.IsDrawFunction(h.Callee.Name)){var l=h.Out,u=h.Callee.Name;this.OutVarTable.push({Name:u,Draw:"è¾åº: "+l,Type:1})}else{var C=h.Out;d="__temp_c_"+h.Callee.Name+"_"+t+"__",this.OutVarTable.push({Name:d,Data:"è¾åº: "+C,Type:0,NoneName:!0})}}else if(e.Expression.Type==dn.Identifier){var D=e.Expression.Name,f=this.ReadVariable(D,e.Expression);D="__temp_i_"+t+"__",this.OutVarTable.push({Name:D,Data:"è¾åº: "+f,Type:0,NoneName:!0})}else if(e.Expression.Type==dn.Literal){var c=e.Expression.Value;ha.IsString(c)&&c.indexOf("$")>0&&(c=this.GetOtherSymbolExplain({Literal:c},e)),d="__temp_li_"+t+"__";this.OutVarTable.push({Name:d,Data:"è¾åº: "+c,Type:0,NoneName:!0})}else if(e.Expression.Type==dn.BinaryExpression){var d="__temp_b_"+t+"__",m=e.Expression.Out;this.OutVarTable.push({Name:d,Data:"è¾åº: "+m,Type:0,NoneName:!0})}else if(e.Expression.Type==dn.LogicalExpression){d="__temp_l_"+t+"__";var v=e.Expression.Out;this.OutVarTable.push({Name:d,Data:"è¾åº: "+v,Type:0,NoneName:!0})}else if(e.Expression.Type==dn.SequenceExpression){var S,I=void 0,p=void 0,T=void 0,g=void 0,x=void 0,F=!1,y=!1,L=!1,E=!1,M=!1,A=!1,N=!0,O=!1,R=!1,P=!1;for(var b in e.Expression.Expression){var B=e.Expression.Expression[b];if(B.Type==dn.AssignmentExpression&&":"==B.Operator&&B.Left){I=B.Left.Name;var V=this.VarTable.get(I);this.VarTable.set(I,V)}else if(B.Type==dn.Identifier){var G=B.Name;if("COLORSTICK"===G)F=!0;else if("POINTDOT"===G)y=!0;else if("CIRCLEDOT"===G)L=!0;else if("DOTLINE"===G)O=!0;else if("LINESTICK"===G)E=!0;else if("STICK"===G)M=!0;else if("VOLSTICK"===G)A=!0;else if("DRAWABOVE"===G)P=!0;else if(0==G.indexOf("COLOR"))g=G;else if(0==G.indexOf("LINETHICK"))x=G;else if(0==G.indexOf("NODRAW"))N=!1;else if(0==G.indexOf("EXDATA"))!0;else if(0==G.indexOf("LINEOVERLAY"))!0;else{I=B.Name;var H=this.ReadVariable(I,B);I="__temp_si_"+t+"__",R=!0,this.VarTable.set(I,H)}}else if(B.Type==dn.Literal){var Y=B.Value;I=B.Value.toString(),R=!0,this.VarTable.set(I,Y)}else if(B.Type==dn.CallExpression)if(this.IsDrawFunction(B.Callee.Name))T=B.Out,p=B.Callee.Name;else{var k=B.Out;I="__temp_sc_"+B.Callee.Name+"_"+t+"__",R=!0,this.VarTable.set(I,k)}else if(B.Type==dn.BinaryExpression){I="__temp_sb_"+t+"__";var _=B.Out;R=!0,this.VarTable.set(I,_)}}if(S=T?"è¾åº: "+T:R?"è¾åº: "+this.VarTable.get(I):"è¾åº"+I+": "+this.VarTable.get(I),g&&(S+=",é¢è²"+this.GetColorExplain(g)),x&&(S+=",çº¿æ®µç²ç»"+this.GetLineWidthExplain(x)),0==N&&(S+=",ä¸æ¾ç¤º"),1==O&&(S+=",ç»èçº¿"),1==P&&(S+=",æ¾ç¤ºå¨ä½ç½®ä¹ä¸"),y&&I){S+=",ç»å°åç¹çº¿";var X={Name:I,Data:S,Radius:Oi.POINTDOT.Radius,Type:3};this.OutVarTable.push(X)}else if(L&&I){S+=",ç»å°ååçº¿";var W={Name:I,Data:S,Radius:Oi.CIRCLEDOT.Radius,Type:3};this.OutVarTable.push(W)}else if(E&&I){S+=",ç»åºæ±ç¶çº¿åææ çº¿";var U={Name:I,Data:S,Type:4};this.OutVarTable.push(U)}else if(M&&I){S+=",ç»æ±ç¶çº¿";var K={Name:I,Data:S,Type:5};this.OutVarTable.push(K)}else if(A&&I){S+=",ç»æäº¤éæ±ç¶çº¿";var J={Name:I,Data:S,Type:6};this.OutVarTable.push(J)}else if(I&&g){var z={Name:I,Data:S,Color:g,Type:0};this.OutVarTable.push(z)}else if(T){var q={Name:p,Data:S,Type:1};this.OutVarTable.push(q)}else if(F&&I){S+=",ç»å½©è²æ±ç¶çº¿";var Z={Name:I,Data:S,Color:g,Type:2};this.OutVarTable.push(Z)}else if(I){var Q={Name:I,Data:S,Type:0};this.OutVarTable.push(Q)}}}return w.Complier.Log("[JSExplainer::Run]",this.VarTable),this.OutVarTable},this.VisitNode=function(t){switch(t.Type){case dn.SequenceExpression:this.VisitSequenceExpression(t);break;case dn.ExpressionStatement:this.VisitNode(t.Expression);break;case dn.AssignmentExpression:this.VisitAssignmentExpression(t);break;case dn.BinaryExpression:case dn.LogicalExpression:this.VisitBinaryExpression(t);break;case dn.CallExpression:this.VisitCallExpression(t);break}},this.VisitSequenceExpression=function(t){for(var e in t.Expression){var a=t.Expression[e];this.VisitNode(a)}},this.VisitCallExpression=function(t){var e=t.Callee.Name,a=[];for(var i in t.Arguments){var r=t.Arguments[i],n=void 0;n=r.Type==dn.BinaryExpression||r.Type==dn.LogicalExpression?this.VisitBinaryExpression(r):r.Type==dn.CallExpression?this.VisitCallExpression(r):this.GetNodeValue(r),a.push(n)}if(w.Complier.Log("[JSExplainer::VisitCallExpression]",e,"(",a.toString(),")"),sn.IsCustomFunction(e)){var s=this.Algorithm.CallCustomFunction(e,a,this.SymbolData,t);return t.Out=[],t.Draw=null,s&&(s.Out&&(t.Out=s.Out),s.Draw&&(t.Draw=s.Draw)),t.Out}return t.Out=this.CallFunctionExplain(e,a,t),t.Out},this.FUNCTION_INFO_LIST=new E.default([["REF",{Name:"REF",Param:{Count:2},ToString:function(t){return t[1]+"æ¥åç"+t[0]}}],["REFX",{Name:"REFX",Param:{Count:2},ToString:function(t){return t[1]+"æ¥åç"+t[0]}}],["REFV",{Name:"REFV",Param:{Count:2},ToString:function(t){return t[1]+"æ¥åç(æªä½å¹³æ»å¤ç)"+t[0]}}],["REFXV",{Name:"REFXV",Param:{Count:2},ToString:function(t){return t[1]+"æ¥åç(æªä½å¹³æ»å¤ç)"+t[0]}}],["REFDATE",{Name:"REFDATE",Param:{Count:2},ToString:function(t){return t[1]+"æ¥"+t[0]}}],["COUNT",{Name:"COUNT",Param:{Count:2},ToString:function(t){return"ç»è®¡"+t[1]+"æ¥ä¸­æ»¡è¶³"+t[0]+"çå¤©æ°"}}],["BARSLASTCOUNT",{Name:"BARSLASTCOUNT",Param:{Count:1},ToString:function(t){return"æ¡ä»¶"+t[0]+"è¿ç»­æç«æ¬¡æ°"}}],["BARSCOUNT",{Name:"BARSCOUNT",Param:{Count:1},ToString:function(t){return t[0]+"æææ°æ®å¨ææ°"}}],["BARSLAST",{Name:"BARSLAST",Param:{Count:1},ToString:function(t){return"ä¸æ¬¡"+t[0]+"ä¸ä¸º0è·ä»å¤©æ°"}}],["BARSNEXT",{Name:"BARSNEXT",Param:{Count:1},ToString:function(t){return"ä¸æ¬¡"+t[0]+"ä¸ä¸º0è·ä»å¤©æ°"}}],["BARSSINCEN",{Name:"BARSSINCEN",Param:{Count:2},ToString:function(t){return"å¨"+t[1]+"å¨æåé¦æ¬¡"+t[0]+"è·ä»å¤©æ°"}}],["BARSSINCE",{Name:"BARSSINCE",Param:{Count:1},ToString:function(t){return"é¦æ¬¡"+t[0]+"è·ä»å¤©æ°"}}],["HHV",{Name:"HHV",Param:{Count:2},ToString:function(t){return t[1]+"æ¥å"+t[0]+"çæé«å¼"}}],["LLV",{Name:"LLV",Param:{Count:2},ToString:function(t){return t[1]+"æ¥å"+t[0]+"çæä½å¼"}}],["HOD",{Name:"HOD",Param:{Count:2},ToString:function(t){return t[1]+"æ¥å"+t[0]+"çé«å¼åæ¬¡"}}],["LOD",{Name:"LOD",Param:{Count:2},ToString:function(t){return t[1]+"æ¥å"+t[0]+"çä½å¼åæ¬¡"}}],["REVERSE",{Name:"REVERSE",Param:{Count:1},ToString:function(t){return t[0]+"çç¸åæ°"}}],["FILTER",{Name:"FILTER",Param:{Count:2},ToString:function(t){return t[0]+"ç"+t[1]+"æ¥è¿æ»¤"}}],["FILTERX",{Name:"FILTERX",Param:{Count:2},ToString:function(t){return t[0]+"ç"+t[1]+"æ¥ååè¿æ»¤"}}],["SUMBARS",{Name:"SUMBARS",Param:{Count:2},ToString:function(t){return t[0]+"ç´¯å è³"+t[1]+"çå¤©æ°"}}],["MA",{Name:"MA",Param:{Count:2},ToString:function(t){return t[0]+"ç"+t[1]+"æ¥ç®åç§»å¨å¹³å"}}],["SMA",{Name:"SMA",Param:{Count:3},ToString:function(t){return t[0]+"ç"+t[1]+"æ¥["+t[2]+"æ¥æé]ç§»å¨å¹³å"}}],["MEMA",{Name:"MEMA",Param:{Count:2},ToString:function(t){return t[0]+"ç"+t[1]+"æ¥å¹³æ»ç§»å¨å¹³å"}}],["EMA",{Name:"EMA",Param:{Count:2},ToString:function(t){return t[0]+"ç"+t[1]+"æ¥ææ°ç§»å¨å¹³å"}}],["EXPMA",{Name:"EXPMA",Param:{Count:2},ToString:function(t){return t[0]+"ç"+t[1]+"æ¥ææ°ç§»å¨å¹³å"}}],["EXPMEMA",{Name:"EXPMEMA",Param:{Count:2},ToString:function(t){return t[0]+"ç"+t[1]+"æ¥ææ°å¹³æ»ç§»å¨å¹³å"}}],["WMA",{Name:"WMA",Param:{Count:2},ToString:function(t){return t[0]+"ç"+t[1]+"æ¥å æç§»å¨å¹³å"}}],["DMA",{Name:"DMA",Param:{Count:2},ToString:function(t){return"ä»¥"+t[1]+"ä¸ºæé"+t[0]+"çå¨æç§»å¨å¹³å"}}],["XMA",{Name:"XMA",Param:{Count:2},ToString:function(t){return t[0]+"ç"+t[1]+"æ¥åç§»ç§»å¨å¹³å"}}],["RANGE",{Name:"RANGE",Param:{Count:3},ToString:function(t){return t[0]+"ä½äº"+t[1]+"å"+t[2]+"ä¹é´"}}],["CONST",{Name:"CONST",Param:{Count:1},ToString:function(t){return t[0]+"çæåä¸æ¥å¼"}}],["TOPRANGE",{Name:"TOPRANGE",Param:{Count:1},ToString:function(t){return"å½åå¼æ¯è¿"+t[0]+"å¨æçæå¤§å¼"}}],["LOWRANGE",{Name:"LOWRANGE",Param:{Count:1},ToString:function(t){return"å½åå¼æ¯è¿"+t[0]+"å¨æçæå°å¼"}}],["FINDHIGH",{Name:"FINDHIGH",Param:{Count:4},ToString:function(t){return t[0]+"å¨"+t[1]+"æ¥åç"+t[2]+"å¤©åç¬¬"+t[3]+"ä¸ªæé«ä»·"}}],["FINDHIGHBARS",{Name:"FINDHIGHBARS",Param:{Count:4},ToString:function(t){return t[0]+"å¨"+t[1]+"æ¥åç"+t[2]+"å¤©åç¬¬"+t[3]+"ä¸ªæé«ä»·å°å½åå¨æçå¨ææ°"}}],["FINDLOW",{Name:"FINDLOW",Param:{Count:4},ToString:function(t){return t[0]+"å¨"+t[1]+"æ¥åç"+t[2]+"å¤©åç¬¬"+t[3]+"ä¸ªæä½ä»·"}}],["FINDLOWBARS",{Name:"FINDLOWBARS",Param:{Count:2},ToString:function(t){return t[0]+"å¨"+t[1]+"æ¥åç"+t[2]+"å¤©åç¬¬"+t[3]+"ä¸ªæä½ä»·å°å½åå¨æçå¨ææ°"}}],["SUM",{Name:"SUM",Param:{Count:2},ToString:function(t){return""+t[0]+t[1]+"æ¥ç´¯å "}}],["MULAR",{Name:"MULAR",Param:{Count:2},ToString:function(t){return t[0]+"å"+t[1]+"æ¥ç´¯ä¹"}}],["AMA",{Name:"AMA",Param:{Count:2},ToString:function(t){return"ä»¥"+t[1]+"ä¸ºæé"+t[0]+"çèªéåºåçº¿"}}],["TMA",{Name:"TMA",Param:{Count:3},ToString:function(t){return t[0]+"ç"+t[1]+"æ¥["+t[2]+"æ¥æé]ç§»å¨å¹³å"}}],["CROSS",{Name:"CROSS",Param:{Count:2},ToString:function(t){return t[0]+"ä¸ç©¿"+t[1]}}],["LONGCROSS",{Name:"LONGCROSS",Param:{Count:3},ToString:function(t){return t[0]+"å°äº"+t[1]+"ä¿æ"+t[2]+"ä¸ªäº¤ææ¥åäº¤åä¸ç©¿"}}],["UPNDAY",{Name:"UPNDAY",Param:{Count:2},ToString:function(t){return"æè¿"+t[1]+"æ¥"+t[0]+"è¿æ¶¨"}}],["DOWNNDAY",{Name:"DOWNNDAY",Param:{Count:2},ToString:function(t){return"æè¿"+t[1]+"æ¥"+t[0]+"è¿è·"}}],["NDAY",{Name:"NDAY",Param:{Count:3},ToString:function(t){return"æè¿"+t[2]+"æ¥"+t[0]+"ä¸ç´å¤§äº"+t[1]}}],["EXIST",{Name:"EXIST",Param:{Count:2},ToString:function(t){return"æè¿"+t[1]+"æ¥å­å¨"+t[0]}}],["EXISTR",{Name:"EXISTR",Param:{Count:3},ToString:function(t){return"ä»å"+t[1]+"æ¥å°å"+t[2]+"æ¥å­å¨"+t[0]}}],["EVERY",{Name:"EVERY",Param:{Count:2},ToString:function(t){return"æè¿"+t[1]+"æ¥ä¸ç´å­å¨"+t[0]}}],["LAST",{Name:"LAST",Param:{Count:3},ToString:function(t){return"ä»å"+t[1]+"æ¥å°å"+t[2]+"æ¥æç»­"+t[0]}}],["NOT",{Name:"NOT",Param:{Count:1},ToString:function(t){return t[0]+"åå"}}],["IF",{Name:"IF",Param:{Count:3},ToString:function(t){return"å¦æ"+t[0]+",è¿å"+t[1]+",å¦åè¿å"+t[2]}}],["IFF",{Name:"IFF",Param:{Count:3},ToString:function(t){return"å¦æ"+t[0]+",è¿å"+t[1]+",å¦åè¿å"+t[2]}}],["IFN",{Name:"IFN",Param:{Count:3},ToString:function(t){return"å¦æ"+t[0]+",è¿å"+t[1]+",å¦åè¿å"+t[2]}}],["MAX",{Name:"MAX",Param:{Count:2},ToString:function(t){return t[0]+"å"+t[1]+"çè¾å¤§å¼"}}],["MIN",{Name:"MIN",Param:{Count:2},ToString:function(t){return t[0]+"å"+t[1]+"çè¾å°å¼"}}],["ACOS",{Name:"ACOS",Param:{Count:1},ToString:function(t){return t[0]+"çåä½å¼¦"}}],["ASIN",{Name:"ASIN",Param:{Count:1},ToString:function(t){return t[0]+"çåæ­£å¼¦"}}],["ATAN",{Name:"ATAN",Param:{Count:1},ToString:function(t){return t[0]+"çåæ­£å"}}],["COS",{Name:"COS",Param:{Count:1},ToString:function(t){return t[0]+"çä½å¼¦"}}],["SIN",{Name:"SIN",Param:{Count:1},ToString:function(t){return t[0]+"çæ­£å¼¦"}}],["TAN",{Name:"TAN",Param:{Count:1},ToString:function(t){return t[0]+"çæ­£å"}}],["EXP",{Name:"EXP",Param:{Count:1},ToString:function(t){return t[0]+"çææ°"}}],["LN",{Name:"LN",Param:{Count:1},ToString:function(t){return t[0]+"çèªç¶å¯¹æ°"}}],["LOG",{Name:"LOG",Param:{Count:1},ToString:function(t){return t[0]+"çå¯¹æ°"}}],["SQRT",{Name:"SQRT",Param:{Count:1},ToString:function(t){return t[0]+"çå¼æ¹"}}],["ABS",{Name:"ABS",Param:{Count:1},ToString:function(t){return t[0]+"çç»å¯¹å¼"}}],["POW",{Name:"POW",Param:{Count:2},ToString:function(t){return t[0]+"ç"+t[1]+"ä¹å¹"}}],["CEILING",{Name:"CEILING",Param:{Count:1},ToString:function(t){return t[0]+"çåä¸èå¥"}}],["FLOOR",{Name:"FLOOR",Param:{Count:1},ToString:function(t){return t[0]+"çåä¸èå¥"}}],["INTPART",{Name:"INTPART",Param:{Count:1},ToString:function(t){return t[0]+"çæ´æ°é¨å"}}],["BETWEEN",{Name:"BETWEEN",Param:{Count:3},ToString:function(t){return t[0]+"ä½äº"+t[1]+"å"+t[2]+"ä¹é´"}}],["FRACPART",{Name:"FRACPART",Param:{Count:1},ToString:function(t){return t[0]+"çå°æ°é¨å"}}],["ROUND",{Name:"ROUND",Param:{Count:1},ToString:function(t){return"å¯¹"+t[0]+"(è¿è¡)åèäºå¥"}}],["ROUND2",{Name:"ROUND2",Param:{Count:2},ToString:function(t){return"å¯¹"+t[0]+"(è¿è¡)åèäºå¥"}}],["SIGN",{Name:"SIGN",Param:{Count:1},ToString:function(t){return t[0]+"çç¬¦å·"}}],["MOD",{Name:"MOD",Param:{Count:2},ToString:function(t){return t[0]+"å³äº"+t[1]+"çæ¨¡"}}],["RAND",{Name:"RAND",Param:{Count:1},ToString:function(t){return"éæºæ­£æ´æ°"}}],["AVEDEV",{Name:"AVEDEV",Param:{Count:2},ToString:function(t){return t[0]+"ç"+t[1]+"æ¥å¹³åç»å¯¹åå·®"}}],["DEVSQ",{Name:"DEVSQ",Param:{Count:2},ToString:function(t){return t[0]+"ç"+t[1]+"æ¥æ°æ®åå·®å¹³æ¹å"}}],["FORCAST",{Name:"FORCAST",Param:{Count:2},ToString:function(t){return t[0]+"ç"+t[1]+"æ¥çº¿æ§åå½é¢æµå¼"}}],["TSMA",{Name:"TSMA",Param:{Count:2},ToString:function(t){return t[0]+"å¨"+t[1]+"ä¸ªå¨æåçæ¶é´åºåä¸è§ç§»å¨å¹³å"}}],["SLOPE",{Name:"SLOPE",Param:{Count:2},ToString:function(t){return t[0]+"ç"+t[1]+"æ¥çº¿æ§åå½æç"}}],["STD",{Name:"STD",Param:{Count:2},ToString:function(t){return t[0]+"ç"+t[1]+"æ¥ä¼°ç®æ åå·®"}}],["STDP",{Name:"STDP",Param:{Count:2},ToString:function(t){return t[0]+"ç"+t[1]+"æ¥æ»ä½æ åå·®"}}],["STDDEV",{Name:"STDDEV",Param:{Count:2},ToString:function(t){return t[0]+"ç"+t[1]+"æ¥æ ååå·®"}}],["VAR",{Name:"VAR",Param:{Count:2},ToString:function(t){return t[0]+"ç"+t[1]+"æ¥ä¼°ç®æ ·æ¬æ¹å·®"}}],["VARP",{Name:"VARP",Param:{Count:2},ToString:function(t){return t[0]+"ç"+t[1]+"æ¥æ»ä½æ ·æ¬æ¹å·®"}}],["COVAR",{Name:"COVAR",Param:{Count:3},ToString:function(t){return t[0]+"å"+t[1]+"ç"+t[2]+"å¨æçåæ¹å·®"}}],["RELATE",{Name:"RELATE",Param:{Count:3},ToString:function(t){return t[0]+"å"+t[1]+"ç"+t[0]+"å¨æçç¸å³ç³»æ°"}}],["BETA",{Name:"BETA",Param:{Count:1},ToString:function(t){return"Î²(Beta)ç³»æ°"}}],["BETAEX",{Name:"BETAEX",Param:{Count:3},ToString:function(t){return t[0]+"å"+t[1]+"ç"+t[2]+"å¨æçç¸å³æ¾å¤§ç³»æ°"}}],["COST",{Name:"COST",Param:{Count:1},ToString:function(t){return"è·å©çä¸º"+t[0]+"%çææ¬åå¸"}}],["WINNER",{Name:"WINNER",Param:{Count:1},ToString:function(t){return"ä»¥"+t[0]+"è®¡ç®çè·å©çæ¯ä¾"}}],["LWINNER",{Name:"LWINNER",Param:{Count:2},ToString:function(t){return"æè¿"+t[0]+"æ¥é£é¨åææ¬ä»¥"+t[1]+"ä»·æ ¼ååºçè·å©çæ¯ä¾"}}],["PWINNER",{Name:"PWINNER",Param:{Count:2},ToString:function(t){return t[0]+"æ¥åé£é¨åææ¬ä»¥"+t[1]+"ä»·æ ¼ååºçè·å©çæ¯ä¾"}}],["COSTEX",{Name:"COSTEX",Param:{Count:2},ToString:function(t){return"ä½äºä»·æ ¼"+t[0]+"å"+t[1]+"é´çææ¬"}}],["PPART",{Name:"PPART",Param:{Count:2},ToString:function(t){return t[0]+"æ¥åé£é¨åææ¬å æ»ææ¬çæ¯ä¾"}}],["SAR",{Name:"SAR",Param:{Count:3},ToString:function(t){return"æ­¥é¿ä¸º"+t[1]+"æéå¼ä¸º"+t[0]+"ç"+t[2]+"æ¥æç©è½¬å"}}],["SARTURN",{Name:"SARTURN",Param:{Count:3},ToString:function(t){return"æ­¥é¿ä¸º"+t[1]+"æéå¼ä¸º"+t[0]+"ç"+t[2]+"æ¥æç©è½¬åç¹"}}],["CON2STR",{Name:"CON2STR",Param:{Count:2},ToString:function(t){return t[0]+"è½¬ä¸ºå­ç¬¦ä¸²"}}],["VAR2STR",{Name:"VAR2STR",Param:{Count:2},ToString:function(t){return t[0]+"è½¬ä¸ºå­ç¬¦ä¸²"}}],["STR2CON",{Name:"STR2CON",Param:{Count:1},ToString:function(t){return t[0]+"è½¬ä¸ºæ°å­"}}],["STRLEN",{Name:"STRLEN",Param:{Count:1},ToString:function(t){return"å¾å°"+t[0]+"å­ç¬¦ä¸²é¿åº¦"}}],["STRCAT",{Name:"STRCAT",Param:{Count:2},ToString:function(t){return"å­ç¬¦ä¸²ç¸å "}}],["VARCAT",{Name:"VARCAT",Param:{Count:2},ToString:function(t){return"å­ç¬¦ä¸²ç¸å "}}],["STRSPACE",{Name:"STRSPACE",Param:{Count:1},ToString:function(t){return"å­ç¬¦ä¸²"+t[0]+"å ä¸ç©ºæ ¼"}}],["SUBSTR",{Name:"SUBSTR",Param:{Count:3},ToString:function(t){return"å­ç¬¦ä¸²"+t[0]+"ä¸­åä¸é¨å"}}],["STRCMP",{Name:"STRCMP",Param:{Count:2},ToString:function(t){return"å­ç¬¦ä¸²"+t[0]+"åå­ç¬¦ä¸²"+t[1]+"æ¯è¾"}}],["FINDSTR",{Name:"FINDSTR",Param:{Count:2},ToString:function(t){return"å­ç¬¦ä¸²"+t[0]+"ä¸­æ¥æ¾å­ç¬¦ä¸²"+t[1]}}],["NAMEINCLUD",{Name:"NAMEINCLUD",Param:{Count:1},ToString:function(t){return"æ¥æ¾åç§åç§°ä¸­åå«"+t[0]}}],["CODELIKE",{Name:"CODELIKE",Param:{Count:1},ToString:function(t){return"æ¥æ¾åç§åç§°ä¸­åå«"+t[0]}}],["INBLOCK",{Name:"AVEDEV",Param:{Count:1},ToString:function(t){return"å±äº"+t[0]+"æ¿å"}}],["HHVBARS",{Name:"HHVBARS",Param:{Count:2},ToString:function(t){return 0==t[1]?"åå²"+t[0]+"æ°é«è·ä»å¤©æ°":t[1]+"æ¥å"+t[0]+"æ°é«è·ä»å¤©æ°"}}],["LLVBARS",{Name:"LLVBARS",Param:{Count:2},ToString:function(t){return 0==t[1]?"åå²"+t[0]+"æ°ä½è·ä»å¤©æ°":t[1]+"æ¥å"+t[0]+"æ°ä½è·ä»å¤©æ°"}}]]),this.CallFunctionExplain=function(t,e,a){if(this.FUNCTION_INFO_LIST.has(t)){var i=this.FUNCTION_INFO_LIST.get(t);return i.Param.Count!=e.length&&this.ThrowUnexpectedNode(a,"å½æ°"+t+"åæ°ä¸ªæ°ä¸æ­£ç¡®. éè¦"+i.Param.Count+"ä¸ªåæ°"),i.ToString(e)}switch(t){case"CALCSTOCKINDEX":return"å¼ç¨"+e[0]+"ç"+e[1]+"ææ ç¬¬"+e[2]+"ä¸ªè¾åºå¼";case"PEAK":case"PEAKBARS":case"ZIG":case"ZIGA":case"TROUGH":case"TROUGHBARS":return this.GetZIGExplain(t,e);case"FINANCE":return this.GetFinanceExplain(e);case"DYNAINFO":return this.GetDynainfoExplain(e);case"CLOSE":case"C":case"VOL":case"V":case"OPEN":case"O":case"HIGH":case"H":case"LOW":case"L":case"AMOUNT":case"AMO":return this.GetOtherSymbolExplain({FunctionName:t,Args:e},a);case"PLOYLINE":return"å½æ»¡è¶³æ¡ä»¶"+e[0]+"æ¶ä»¥"+e[1]+"ä½ç½®ä¸ºé¡¶ç¹ç»æçº¿è¿æ¥";case"DRAWLINE":return"å½æ»¡è¶³æ¡ä»¶"+e[0]+"æ¶,å¨"+e[1]+"ä½ç½®ç»ç´çº¿èµ·ç¹ï¼å½æ»¡è¶³æ¡ä»¶"+e[2]+"æ¶,å¨"+e[3]+"ä½ç½®ç»ç´çº¿ç»ç¹,"+e[4]+"è¡¨ç¤ºæ¯å¦å»¶é¿";case"DRAWSL":return"å½æ»¡è¶³æ¡ä»¶"+e[0]+"æ¶,å¨"+e[1]+"ä½ç½®ç»æçº¿çº¿æ§åå½,"+e[2]+"æç,"+e[3]+"é¿åº¦,"+e[4]+"æ¹å";case"DRAWKLINE":case"DRAWKLINE1":return"Kçº¿";case"DRAWICON":return"å½æ»¡è¶³æ¡ä»¶"+e[0]+"æ¶,å¨"+e[1]+"ä½ç½®ç»"+e[2]+"å·å¾æ ";case"DRAWTEXT":return"å½æ»¡è¶³æ¡ä»¶"+e[0]+"æ¶,å¨"+e[1]+"ä½ç½®ä¹¦åæå­";case"DRAWTEXT_FIX":return"å½æ»¡è¶³æ¡ä»¶"+e[0]+"æ¶,å¨æ¨ªè½´"+e[1]+"çºµè½´"+e[2]+"ä½ç½®ä¹¦åæå­";case"DRAWNUMBER":return"å½æ»¡è¶³æ¡ä»¶"+e[0]+"æ¶,å¨"+e[1]+"ä½ç½®ä¹¦åæ°å­";case"DRAWNUMBER_FIX":return"å½æ»¡è¶³æ¡ä»¶"+e[0]+"æ¶,å¨æ¨ªè½´"+e[1]+"çºµè½´"+e[2]+"ä½ç½®ä¹¦åæ°å­";case"RGB":return"èªå®è²["+e[0]+","+e[1]+","+e[2]+"]";case"DRAWBAND":return"ç»å¸¦ç¶çº¿";case"DRAWRECTREL":return"ç¸å¯¹ä½ç½®ä¸ç»ç©å½¢.";case"DRAWGBK":return"å¡«åèæ¯";case"STICKLINE":var r="";return r=-1==e[4]?"èçº¿ç©ºå¿æ±":0==e[4]?"å®å¿æ±":"å®çº¿ç©ºå¿æ±","å½æ»¡è¶³æ¡ä»¶"+e[0]+"æ¶, å¨"+e[1]+"å"+e[2]+"ä½ç½®ä¹é´ç»æ±ç¶çº¿,å®½åº¦ä¸º"+e[3]+","+r;default:this.ThrowUnexpectedNode(a,"å½æ°"+t+"ä¸å­å¨")}},this.GetDynainfoExplain=function(t){var e=new E.default([[3,"åæ¶çä»·"],[4,"å¼çä»·"],[5,"æé«ä»·"],[6,"æä½ä»·"],[7,"ç°ä»·"],[8,"æ»é"],[9,"ç°é"],[10,"æ»éé¢"],[11,"åä»·"],[12,"æ¥æ¶¨è·"],[13,"æ¯å¹"],[14,"æ¶¨å¹"],[15,"å¼çæ¶çæäº¤éé¢"],[16,"å5æ¥æ¯åéåé"],[17,"éæ¯"],[18,"ä¸æ¶¨å®¶æ°"],[19,"ä¸è·å®¶æ°"]]),a=t[0];return e.has(a)?e.get(a):"å³æ¶è¡æ["+a+"]"},this.GetFinanceExplain=function(t){var e=new E.default([[1,"æ»è¡æ¬"],[2,"å¸åºç±»å"],[3,"æ²ªæ·±åç§ç±»å"],[4,"æ²ªæ·±è¡ä¸ä»£ç "],[5,"Bè¡"],[6,"Hè¡"],[7,"æµéè¡æ¬[è¡]"],[8,"è¡ä¸äººæ°[æ·]"],[9,"èµäº§è´åºç%"],[10,"æ»èµäº§"],[11,"æµå¨èµäº§"],[12,"åºå®èµäº§"],[13,"æ å½¢èµäº§"],[15,"æµå¨è´åº"],[16,"å°æ°è¡ä¸æç"]]),a=t[0];return e.has(a)?e.get(a):"è´¢å¡æ°æ®["+a+"]"},this.GetZIGExplain=function(t,e){var a=e[0];switch(0==a?a="å¼çä»·":1==a?a="æé«ä»·":2==a?a="æä½ä»·":3==a&&(a="æ¶çä»·"),t){case"PEAK":return a+"ç"+e[1]+"%ä¹å­è½¬åçå"+e[2]+"ä¸ªæ³¢å³°å¼";case"PEAKBARS":return a+"ç"+e[1]+"5%ä¹å­è½¬åçå"+e[2]+"ä¸ªæ³¢å³°ä½ç½®";case"ZIG":return a+"ç"+e[1]+"çä¹å­è½¬å";case"ZIGA":return a+"åå"+e[1]+"çä¹å­è½¬å";case"TROUGH":return a+"ç"+e[1]+"%ä¹å­è½¬åçå"+e[2]+"ä¸ªæ³¢è°·å¼";case"TROUGHBARS":return a+"ç"+e[1]+"%ä¹å­è½¬åçå"+e[2]+"ä¸ªæ³¢è°·ä½ç½®"}},this.GetColorExplain=function(t){var e=new E.default([["COLORBLACK","é»è²"],["COLORBLUE","èè²"],["COLORGREEN","ç»¿è²"],["COLORCYAN","éè²"],["COLORRED","çº¢è²"],["COLORMAGENTA","æ´çº¢è²"],["COLORBROWN","æ£è²"],["COLORLIGRAY","æ·¡ç°è²"],["COLORGRAY","æ·±ç°è²"],["COLORLIBLUE","æ·¡èè²"],["COLORLIGREEN","æ·¡ç»¿è²"],["COLORLICYAN","æ·¡éè²"],["COLORLIRED","æ·¡çº¢è²"],["COLORLIMAGENTA","æ·¡æ´çº¢è²"],["COLORWHITE","ç½è²"],["COLORYELLOW","é»è²"]]);return e.has(t)?e.get(t):0==t.indexOf("COLOR")?"#"+t.substr(5):"rgb(30,144,255)"},this.GetLineWidthExplain=function(t){var e=parseInt(t.replace("LINETHICK",""));return ha.IsPlusNumber(e)?e:1},this.SymbolPeriodExplain=function(t,e){var a=new E.default([["CLOSE","æ¶çä»·"],["C","æ¶çä»·"],["VOL","æäº¤é"],["V","æäº¤é"],["OPEN","å¼çä»·"],["O","å¼çä»·"],["HIGH","æé«ä»·"],["H","æé«ä»·"],["LOW","æä½ä»·"],["L","æä½ä»·"],["AMOUNT","æäº¤éé¢"],["AMO","æäº¤éé¢"],["VOLINSTK","æä»é"]]),i=new E.default([["MIN1","1åé"],["MIN5","5åé"],["MIN15","15åé"],["MIN30","30åé"],["MIN60","60åé"],["DAY","æ¥"],["WEEK","å¨"],["MONTH","æ"],["SEASON","å­£"],["YEAR","å¹´"],["WEEK2","åå¨"],["HALFYEAR","åå¹´"]]),r=t;a.has(t)&&(r=a.get(t));var n=e;return i.has(e)&&(n=i.get(e)),r+"[å"+n+"æ°æ®]"},this.GetOtherSymbolExplain=function(t,e){var a=new E.default([["CLOSE","æ¶çä»·"],["C","æ¶çä»·"],["VOL","æäº¤é"],["V","æäº¤é"],["OPEN","å¼çä»·"],["O","å¼çä»·"],["HIGH","æé«ä»·"],["H","æé«ä»·"],["LOW","æä½ä»·"],["L","æä½ä»·"],["AMOUNT","æäº¤éé¢"],["AMO","æäº¤éé¢"],["VOLINSTK","æä»é"]]);if(t.FunctionName){var i=t.Args,r=a.get(t.FunctionName);return"["+i[0]+"]"+r}if(t.Literal){var n=t.Literal.toUpperCase();i=n.split("$");if(!a.has(i[1]))return"";var s=i[0];r=a.get(i[1]);return"["+s+"]"+r}},this.IsDrawFunction=function(t){var e=new I.default(["STICKLINE","DRAWTEXT","SUPERDRAWTEXT","DRAWLINE","DRAWBAND","DRAWKLINE","DRAWKLINE1","DRAWKLINE_IF","PLOYLINE","POLYLINE","DRAWNUMBER","DRAWNUMBER_FIX","DRAWICON","DRAWCHANNEL","PARTLINE","DRAWTEXT_FIX","DRAWGBK","DRAWTEXT_LINE","DRAWRECTREL","DRAWTEXTABS","DRAWOVERLAYLINE","FILLRGN","FILLRGN2","FILLTOPRGN","FILLBOTTOMRGN","FILLVERTICALRGN","FLOATRGN","DRAWSL","DRAWGBK2"]);return!!e.has(t)},this.VisitAssignmentExpression=function(t){var e=t.Left;e.Type!=dn.Identifier&&this.ThrowUnexpectedNode(t);var a=e.Name,i=t.Right,r=null;if(i.Type==dn.BinaryExpression||i.Type==dn.LogicalExpression)r=this.VisitBinaryExpression(i);else if(i.Type==dn.CallExpression)r=this.VisitCallExpression(i);else if(i.Type==dn.Literal)r=i.Value,ha.IsString(r)&&i.Value.indexOf("$")>0&&(r=this.GetOtherSymbolExplain({Literal:r},t));else if(i.Type==dn.Identifier)r=this.ReadVariable(i.Name,i);else if(i.Type==dn.MemberExpression)r=this.ReadMemberVariable(i);else if(i.Type==dn.UnaryExpression)if("-"==i.Operator){var n=this.GetNodeValue(i.Argument);r="-"+n}else r=i.Argument.Value;w.Complier.Log("[JSExplainer::VisitAssignmentExpression]",a," = ",r),this.VarTable.set(a,r)},this.VisitBinaryExpression=function(t){var e=[];e.push(t);var a=null;while(0!=e.length)if(a=e[e.length-1],a.Left&&t!=a.Left&&t!=a.Right)e.push(a.Left);else if(a.Right&&t!=a.Right)e.push(a.Right);else{var i=e.pop();if(i.Type==dn.BinaryExpression){var r=this.GetNodeValue(i.Left),n=this.GetNodeValue(i.Right);w.Complier.Log("[JSExplainer::VisitBinaryExpression] BinaryExpression",i,r,n),i.Out=null,i.Out="("+r+" "+i.Operator+" "+n+")","æ¶çä»·"==r&&"å¼çä»·"==n?">"==i.Operator?i.Out="(æ¶é³çº¿)":"<"==i.Operator?i.Out="(æ¶é´çº¿)":"="==i.Operator&&(i.Out="(å¹³ç)"):"å¼çä»·"==r&&"æ¶çä»·"==n&&("<"==i.Operator?i.Out="(æ¶é³çº¿)":">"==i.Operator?i.Out="(æ¶é´çº¿)":"="==i.Operator&&(i.Out="(å¹³ç)")),w.Complier.Log("[JSExplainer::VisitBinaryExpression] BinaryExpression",i)}else if(i.Type==dn.LogicalExpression){var s=this.GetNodeValue(i.Left),o=this.GetNodeValue(i.Right);switch(w.Complier.Log("[JSExecute::VisitBinaryExpression] LogicalExpression",i,s,o),i.Out=null,i.Operator){case"&&":case"AND":i.Out="("+s+" å¹¶ä¸ "+o+")";break;case"||":case"OR":i.Out="("+s+" æè "+o+")";break}w.Complier.Log("[JSExplainer::VisitBinaryExpression] LogicalExpression",i)}t=a}return t.Out},this.GetNodeValue=function(t){switch(t.Type){case dn.Literal:return t.Value;case dn.UnaryExpression:if("-"==t.Operator){var e=this.GetNodeValue(t.Argument);return"-"+e}return t.Argument.Value;case dn.Identifier:var a=this.ReadVariable(t.Name,t);return a;case dn.BinaryExpression:case dn.LogicalExpression:return t.Out;case dn.CallExpression:return this.VisitCallExpression(t);default:this.ThrowUnexpectedNode(t)}},this.ReadVariable=function(t,e){if(this.ConstVarTable.has(t)){var a=this.ConstVarTable.get(t);return a}if(sn.IsCustomVariant(t))return this.ReadCustomVariant(t,e);if(this.VarTable.has(t))return this.VarTable.get(t);if(t.indexOf("#")>0){var i=t.split("#");return this.SymbolPeriodExplain(i[0],i[1])}return this.ThrowUnexpectedNode(e,"åé"+t+"ä¸å­å¨"),t},this.ThrowUnexpectedNode=function(t,e){var a=t.Marker,i=e||"æ§è¡å¼å¸¸";return this.ErrorHandler.ThrowError(a.Index,a.Line,a.Column,i)},this.ThrowError=function(){}}function Ln(){}Ln.Tokenize=function(t){w.Complier.Log("[JSComplier.Tokenize]",t);var e=new cn(t),a=[];try{while(1){var i=e.GetNextToken();if(!i)break;a.push(i)}}catch(r){}return a},Ln.Parse=function(t){w.Complier.Log("[JSComplier.Parse]",t);var e=new vn(t);e.Initialize();var a=e.ParseScript(),i=a;return i},Ln.Execute=function(t,e,a){var i=function(){try{e.Self&&(e.Self.Status=1),w.Complier.Log("[JSComplier.Execute]",t,e),w.Complier.Log("[JSComplier.Execute] parser .....");var i=new vn(t);i.Initialize();var r=i.ParseScript(),n=r;w.Complier.Log("[JSComplier.Execute] parser finish.",n),e.Self&&(e.Self.Status=2),w.Complier.Log("[JSComplier.Execute] execute .....");var s=new Fn(n,e);s.ErrorCallback=a,s.JobList=i.Node.GetDataJobList(),"ScriptIndexConsole"==e.ClassName&&s.JobList.unshift({ID:xn.JOB_DOWNLOAD_SYMBOL_DATA}),s.JobList.push({ID:xn.JOB_RUN_SCRIPT}),e.Self&&(e.Self.Status=3);s.Execute()}catch(o){w.Complier.Log(o),a&&a(o,e.CallbackParam),e.Self&&(e.Self.Status=0)}};i(),w.Complier.Log("[JSComplier.Execute] async execute.")},Ln.Explain=function(t,e,a){var i=function(){try{w.Complier.Log("[JSComplier.Explain]",t,e),w.Complier.Log("[JSComplier.Explain] parser .....");var i=new vn(t);i.Initialize();var r=i.ParseScript(),n=r;w.Complier.Log("[JSComplier.Explain] parser finish.",n),w.Complier.Log("[JSComplier.Explain] explain .....");var s=new yn(n,e);s.ErrorCallback=a,s.JobList=i.Node.GetDataJobList(),s.JobList.push({ID:xn.JOB_RUN_SCRIPT});s.Run()}catch(o){w.Complier.Log(o),a&&a(o,e.CallbackParam)}};i(),w.Complier.Log("[JSComplier.Explain] async explain.")},Ln.SetDomain=function(t,e){t&&(sn.Domain=t),e&&(sn.CacheDomain=e)},Ln.AddIcon=function(t){sn.CustomDrawIcon.Data.set(t.ID,t)},Ln.AddFunction=function(t){if(t&&t.Name){var e=t.Name.toUpperCase();sn.CustomFunction.Data.set(e,t)}},Ln.AddVariant=function(t){if(t&&t.Name){var e=t.Name.toUpperCase();sn.CustomVariant.Data.set(e,t)}},Ln.ColorVarToRGB=function(t){var e=new E.default([["COLORBLACK","rgb(0,0,0)"],["COLORBLUE","rgb(18,95,216)"],["COLORGREEN","rgb(25,158,0)"],["COLORCYAN","rgb(0,255,198)"],["COLORRED","rgb(238,21,21)"],["COLORMAGENTA","rgb(255,0,222)"],["COLORBROWN","rgb(149,94,15)"],["COLORLIGRAY","rgb(218,218,218)"],["COLORGRAY","rgb(133,133,133)"],["COLORLIBLUE","rgb(94,204,255)"],["COLORLIGREEN","rgb(183,255,190)"],["COLORLICYAN","rgb(154,255,242)"],["COLORLIRED","rgb(255,172,172)"],["COLORLIMAGENTA","rgb(255,145,241)"],["COLORWHITE","rgb(255,255,255)"],["COLORYELLOW","rgb(255,198,0)"]]);if(e.has(t))return e.get(t);if(0!=t.indexOf("COLOR"))return null;var a=t.substr(5);if(6!=a.length)return null;var i=a.substr(0,2),r=parseInt(i,16);i=a.substr(2,2);var n=parseInt(i,16);i=a.substr(4,2);var s=parseInt(i,16);return"rgb("+s+","+n+","+r+")"};var En={KLINE_ID:0,MINUTE_ID:2,HISTORY_MINUTE_ID:3,MULTIDAY_MINUTE_ID:4},Mn={OVERLAY_BARS:"OVERLAY_BARS",KLINE_TABLE:"KLINE_TABLE"};function An(){this.DataMap=new E.default,this.Add=function(t,e){this.DataMap.set(t,{MinuteFittingCallback:e.MinuteFittingCallback,KLineFittingCallback:e.KLineFittingCallback,CreateChartCallback:e.CreateChartCallback})},this.Get=function(t){return this.DataMap.has(t)?this.DataMap.get(t):null}}var Nn=new An;function wn(t,e,a,i){this.newMethod=Qi,this.newMethod(t),delete this.newMethod,this.ClassName="ScriptIndex",this.Script=e,this.Arguments=[],this.OutVar=[],this.ID,this.FloatPrecision=2,this.StringFormat,this.KLineType=null,this.InstructionType,this.YSpecificMaxMin=null,this.YSplitScale=null,this.Condition=null,this.OutName=null,this.YSplitType,this.IsLocked=!1,this.LockCallback=null,this.LockID=null,this.LockBG=null,this.LockTextColor=null,this.LockText=null,this.LockFont=null,this.LockCount=20,this.LockMinWidth=null,this.TitleFont=Oi.TitleFont,this.IsShortTitle=!1,this.IsUsePageData=!1,this.Debug,i&&(i.FloatPrecision>=0&&(this.FloatPrecision=i.FloatPrecision),i.StringFormat>0&&(this.StringFormat=i.StringFormat),i.ID&&(this.ID=i.ID),(i.KLineType>=0||-1===i.KLineType)&&(this.KLineType=i.KLineType),i.InstructionType&&(this.InstructionType=i.InstructionType),i.YSpecificMaxMin&&(this.YSpecificMaxMin=i.YSpecificMaxMin),i.YSplitScale&&(this.YSplitScale=i.YSplitScale),i.Condition&&(this.Condition=i.Condition),i.TitleFont&&(this.TitleFont=i.TitleFont),i.IsShortTitle&&(this.IsShortTitle=i.IsShortTitle),i.OutName&&(this.OutName=i.OutName),ha.IsNumber(i.YSplitType)&&(this.YSplitType=i.YSplitType),i.Debug&&ha.IsPlusNumber(i.Debug.Count)&&i.Debug.Callback&&(this.Debug={Count:i.Debug.Count,Callback:i.Debug.Callback})),i&&i.Lock&&(1==i.Lock.IsLocked&&(this.IsLocked=!0),i.Lock.Callback&&(this.LockCallback=i.Lock.Callback),i.Lock.ID&&(this.LockID=i.Lock.ID),i.Lock.BG&&(this.LockBG=i.Lock.BG),i.Lock.TextColor&&(this.LockTextColor=i.Lock.TextColor),i.Lock.Text&&(this.LockText=i.Lock.Text),i.Lock.Font&&(this.LockFont=i.Lock.Font),i.Lock.Count&&(this.LockCount=i.Lock.Count),i.Lock.MinWidth&&(this.LockMinWidth=i.Lock.MinWidth*U())),a&&(this.Arguments=a),this.CopyTo=function(t){t.FloatPrecision=this.FloatPrecision,t.StringFormat=this.StringFormat,t.KLineType=this.KLineType,t.InstructionType=this.InstructionType,t.Condition=this.Condition,t.TitleFont=this.TitleFont,t.IsShortTitle=this.IsShortTitle,t.OutName=this.OutName,t.Arguments=this.Arguments,t.Script=this.Script,t.Name=this.Name,t.ID=this.ID},this.SetLock=function(t){1==t.IsLocked?(this.IsLocked=!0,t.Callback&&(this.LockCallback=t.Callback),t.ID&&(this.LockID=t.ID),t.BG&&(this.LockBG=t.BG),t.TextColor&&(this.LockTextColor=t.TextColor),t.Text&&(this.LockText=t.Text),t.Font&&(this.LockFont=t.Font),t.Count&&(this.LockCount=t.Count),t.MinWidth&&(this.LockMinWidth=t.MinWidth*U())):(this.IsLocked=!1,this.LockCallback=null,this.LockID=null,this.LockBG=null,this.LockTextColor=null,this.LockText=null,this.LockFont=null,this.LockCount=20)},this.ExecuteScript=function(t,e,a){this.OutVar=[];var i={HQChart:t,WindowIndex:e,HistoryData:a,Self:this},r=En.KLINE_ID;"MinuteChartContainer"===t.ClassName||"MinuteChartHScreenContainer"===t.ClassName?r=t.DayCount>1?En.MULTIDAY_MINUTE_ID:En.MINUTE_ID:"HistoryMinuteChartContainer"===t.ClassName&&(r=En.HISTORY_MINUTE_ID);var n={HQDataType:r,Symbol:t.Symbol,Name:t.Name,Data:a,SourceData:t.SourceData,Callback:this.RecvResultData,CallbackParam:i,Async:!0,MaxRequestDataCount:t.MaxRequestDataCount,MaxRequestMinuteDayCount:t.MaxRequestMinuteDayCount,Arguments:this.Arguments,Condition:this.Condition,IsBeforeData:t.IsBeforeData,IsApiPeriod:t.IsApiPeriod,DrawInfo:null,Self:this};if(this.Debug&&ha.IsPlusNumber(this.Debug.Count)&&this.Debug.Callback&&(--this.Debug.Count,n.Debug=1,n.DebugFilter=this.Debug.Callback),t&&t.ChartPaint[0]){var s=t.ChartPaint[0];s&&s.DrawKRange&&(n.DrawInfo={Start:s.DrawKRange.Start,End:s.DrawKRange.End})}if(r===En.HISTORY_MINUTE_ID&&(n.TrateDate=t.TradeDate),r===En.MULTIDAY_MINUTE_ID&&(n.DayCount=t.DayCount),t.NetworkFilter&&(n.NetworkFilter=t.NetworkFilter),!this.Condition||this.IsMeetCondition(i,n)){var o=this.Script;Ln.Execute(o,n,t.ScriptErrorCallback)}else this.ShowConditionError(i)},this.IsMeetCondition=function(t,e){if(w.Complier.Log("[ScriptIndex::IsMeetCondition] ",this.Condition),this.Condition.Period){if(!this.IsMeetPeriodCondition(t,e))return!1;if(!this.IsMeetIncludeCondition(t,e))return!1}return!0},this.IsMeetPeriodCondition=function(t,e){if(!this.Condition.Period)return!0;for(var a in this.Condition.Period){var i=this.Condition.Period[a];switch(i){case R.MINUTE_ID:if(e.HQDataType==En.MINUTE_ID)return!0;break;case R.MULTIDAY_MINUTE_ID:if(e.HQDataType==En.MULTIDAY_MINUTE_ID)return!0;break;case R.KLINE_DAY_ID:case R.KLINE_WEEK_ID:case R.KLINE_MONTH_ID:case R.KLINE_YEAR_ID:case R.KLINE_TWOWEEK_ID:case R.KLINE_QUARTER_ID:case R.KLINE_MINUTE_ID:case R.KLINE_5_MINUTE_ID:case R.KLINE_15_MINUTE_ID:case R.KLINE_30_MINUTE_ID:case R.KLINE_60_MINUTE_ID:if(t.HQChart.Period==i)return!0;break}}return!1},this.IsMeetIncludeCondition=function(t,e){if(!this.Condition.Include||this.Condition.Include.length<=0)return!0;var a=t.HQChart.Symbol;for(var i in a&&(a=a.toUpperCase()),this.Condition.Include){var r=this.Condition.Include[i];if(a==r)return!0}return!1},this.ShowConditionError=function(t){var e=t.HQChart,a=t.WindowIndex;e.DeleteIndexPaint(a),0==a&&e.ShowKLine(!0);var i="ææ ä¸æ¯æå½ååç§æå¨æ",r=new jt;r.Canvas=e.Canvas,r.ChartBorder=e.Frame.SubFrame[a].Frame.ChartBorder,r.ChartFrame=e.Frame.SubFrame[a].Frame,r.NotSupportMessage=i,e.ChartPaint.push(r),e.Draw()},this.RecvResultData=function(t,e){var a=e.HQChart,i=e.WindowIndex,r=e.HistoryData;if(e.Self.OutVar=t,e.Self.BindData(a,i,r),0==e.Self.IsLocked)e.HQChart.Frame.SubFrame[i].Frame.SetLock(null);else{var n={IsLocked:!0,Callback:e.Self.LockCallback,IndexName:e.Self.Name,ID:e.Self.LockID,BG:e.Self.LockBG,Text:e.Self.LockText,TextColor:e.Self.LockTextColor,Font:e.Self.LockFont,Count:e.Self.LockCount,MinWidth:e.Self.LockMinWidth};e.HQChart.Frame.SubFrame[i].Frame.SetLock(n)}if(e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw(),a.GetIndexEvent){var s=a.GetIndexEvent();if(s){var o=e.Self,h={OutVar:o.OutVar,WindowIndex:i,Name:o.Name,Arguments:o.Arguments,HistoryData:r,Stock:{Symbol:a.Symbol,Name:a.Name}};s.Callback(s,h,o)}}},this.CreateLine=function(t,e,a,i,r){if(7==r)var n=new ae;else n=new jt;if(n.Canvas=t.Canvas,n.DrawType=1,n.Name=a.Name,n.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,n.ChartFrame=t.Frame.SubFrame[e].Frame,n.Identify=this.Guid,a.Color?n.Color=this.GetColor(a.Color):n.Color=this.GetDefaultColor(i),a.LineWidth){var s=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(s)&&s>0&&(n.LineWidth=s)}a.IsDotLine&&(n.IsDotLine=!0),0==a.IsShow&&(n.IsShow=!1);var o=e+1;n.Data.Data=a.Data,!1===a.IsShowTitle||ha.IsString(a.Name)&&0==a.Name.indexOf("NOTEXT")||(a.NoneName?t.TitlePaint[o].Data[i]=new Ha(n.Data,null,n.Color):t.TitlePaint[o].Data[i]=new Ha(n.Data,a.Name,n.Color),t.TitlePaint[o].Data[i].ChartClassName=n.ClassName),t.ChartPaint.push(n)},this.CreateOverlayLine=function(t,e,a,i,r){if(7==r)var n=new ae;n=new $t;if(n.Canvas=t.Canvas,n.DrawType=1,n.Name=a.Name,n.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,n.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?n.Color=this.GetColor(a.Color):n.Color=this.GetDefaultColor(i),a.LineWidth){var s=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(s)&&s>0&&(n.LineWidth=s)}a.IsDotLine&&(n.IsDotLine=!0),0==a.IsShow&&(n.IsShow=!1);var o=e+1;n.Data.Data=a.Data,t.TitlePaint[o].Data[i]=new Ha(n.Data,a.Name,n.Color),t.TitlePaint[o].Data[i].ChartClassName=n.ClassName,t.ChartPaint.push(n)},this.CreateBar=function(t,e,a,i){var r=new Ce;r.Canvas=t.Canvas,a.Draw.Width>0?r.Width=a.Draw.Width:r.Width=0,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i);r.Data.Data=a.Draw.DrawData,r.BarType=a.Draw.Type,t.ChartPaint.push(r)},this.CreateText=function(t,e,a,i,r){var n=new De;n.Canvas=t.Canvas,n.Name=a.Name,n.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,n.ChartFrame=t.Frame.SubFrame[e].Frame,n.ReloadResource(),a.Color?n.Color=this.GetColor(a.Color):n.Color=this.GetDefaultColor(i),!0===a.IsDrawCenter&&(n.TextAlign="center"),!0===a.IsDrawAbove&&(n.Direction=1),!0===a.IsDrawBelow&&(n.Direction=2);a.Draw.Position&&(n.Position=a.Draw.Position),a.Draw.DrawData&&(n.Data.Data=a.Draw.DrawData),n.Text=a.Draw.Text,a.Draw.Direction>0&&(n.Direction=a.Draw.Direction),a.Draw.YOffset>0&&(n.YOffset=a.Draw.YOffset),a.Draw.TextAlign&&(n.TextAlign=a.Draw.TextAlign),a.DrawVAlign>=0&&(0==a.DrawVAlign?n.Direction=1:1==a.DrawVAlign?n.Direction=0:2==a.DrawVAlign&&(n.Direction=2)),a.DrawAlign>=0&&(0==a.DrawAlign?n.TextAlign="left":1==a.DrawAlign?n.TextAlign="center":2==a.DrawAlign&&(n.TextAlign="right")),a.DrawFontSize>0&&(n.FixedFontSize=a.DrawFontSize),a.Background&&(n.TextBG=a.Background),t.ChartPaint.push(n)},this.CreateDrawNumber=function(t,e,a,i){var r=new ce;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.ReloadResource(),a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),!0===a.IsDrawCenter&&(r.TextAlign="center"),!0===a.IsDrawAbove&&(r.TextBaseline="bottom"),!0===a.IsDrawBelow&&(r.TextBaseline="top"),r.Data.Data=a.Draw.DrawData.Value,r.Text=a.Draw.DrawData.Text,a.Draw.Direction>0&&(r.Direction=a.Draw.Direction),a.Draw.YOffset>0&&(r.YOffset=a.Draw.YOffset),a.Draw.TextAlign&&(r.TextAlign=a.Draw.TextAlign),"TOP"===a.Draw.FixedPosition?r.FixedPosition=1:"BOTTOM"===a.Draw.FixedPosition&&(r.FixedPosition=2),a.DrawVAlign>=0&&(0==a.DrawVAlign?r.TextBaseline="top":1==a.DrawVAlign?r.TextBaseline="middle":2==a.DrawVAlign&&(r.TextBaseline="bottom")),a.DrawAlign>=0&&(0==a.DrawAlign?r.TextAlign="left":1==a.DrawAlign?r.TextAlign="center":2==a.DrawAlign&&(r.TextAlign="right")),a.DrawFontSize>0&&(r.FixedFontSize=a.DrawFontSize),a.Background&&(r.TextBG=a.Background),a.VerticalLine&&(r.VerticalLine=a.VerticalLine);t.ChartPaint.push(r)},this.CreateDrawTextV2=function(t,e,a,i){var r=new fe;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.ReloadResource(),a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),!0===a.IsDrawCenter&&(r.TextAlign="center"),!0===a.IsDrawAbove&&(r.TextBaseline="bottom"),!0===a.IsDrawBelow&&(r.TextBaseline="top"),a.Draw.DrawData&&(r.Data.Data=a.Draw.DrawData),r.Text=a.Draw.Text,a.Draw.Direction>0&&(r.Direction=a.Draw.Direction),a.Draw.YOffset>0&&(r.YOffset=a.Draw.YOffset),a.Draw.TextAlign&&(r.TextAlign=a.Draw.TextAlign),"TOP"===a.Draw.FixedPosition?r.FixedPosition=1:"BOTTOM"===a.Draw.FixedPosition&&(r.FixedPosition=2),a.DrawVAlign>=0&&(0==a.DrawVAlign?r.TextBaseline="top":1==a.DrawVAlign?r.TextBaseline="middle":2==a.DrawVAlign&&(r.TextBaseline="bottom")),a.DrawAlign>=0&&(0==a.DrawAlign?r.TextAlign="left":1==a.DrawAlign?r.TextAlign="center":2==a.DrawAlign&&(r.TextAlign="right")),a.DrawFontSize>0&&(r.FixedFontSize=a.DrawFontSize),a.Background&&(r.TextBG=a.Background),a.VerticalLine&&(r.VerticalLine=a.VerticalLine);t.ChartPaint.push(r)},this.CreateMACD=function(t,e,a,i){var r=new pe;if(r.Canvas=t.Canvas,r.Identify=this.Guid,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(n)&&n>0&&(r.LineWidth=n)}var s=e+1;r.Data.Data=a.Data;var o=this.GetDefaultColor(i);a.Color&&(o=this.GetColor(a.Color)),t.TitlePaint[s].Data[i]=new Ha(r.Data,a.Name,o),t.ChartPaint.push(r)},this.CreatePointDot=function(t,e,a,i){var r=new re;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.Radius&&(r.Radius=a.Radius),a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(n)&&n>0&&(r.Radius=n)}var s=e+1;r.Data.Data=a.Data,t.TitlePaint[s].Data[i]=new Ha(r.Data,a.Name,r.Color),t.ChartPaint.push(r)},this.CreateStick=function(t,e,a,i){var r=new ne;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(n)&&n>0&&(r.LineWidth=n)}var s=e+1;r.Data.Data=a.Data,t.TitlePaint[s].Data[i]=new Ha(r.Data,a.Name,r.Color),t.ChartPaint.push(r)},this.CreateLineStick=function(t,e,a,i){var r=new se;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(n)&&n>0&&(r.LineWidth=n)}var s=e+1;r.Data.Data=a.Data,t.TitlePaint[s].Data[i]=new Ha(r.Data,a.Name,r.Color),t.ChartPaint.push(r)},this.CreateStraightLine=function(t,e,a,i){var r=new jt;if(r.DrawType=1,r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(n)&&n>0&&(r.LineWidth=n)}var s=e+1;r.Data.Data=a.Draw.DrawData,"DRAWLINE"==a.Name&&(t.TitlePaint[s].Data[i]=new Ha(r.Data,null,r.Color)),t.ChartPaint.push(r)},this.CreateVolStick=function(t,e,a,i,r){var n=new oe;n.Canvas=t.Canvas,n.Name=a.Name,n.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,n.ChartFrame=t.Frame.SubFrame[e].Frame,n.KLineDrawType=t.KLineDrawType,n.Identify=this.Guid,a.Color?n.Color=this.GetColor(a.Color):n.Color=this.GetDefaultColor(i);var s=e+1;n.Data.Data=a.Data,n.HistoryData=r,t.TitlePaint[s].Data[i]=new Ha(n.Data,a.Name,n.Color),t.ChartPaint.push(n)},this.CreateBand=function(t,e,a,i){var r=new ge;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.FirstColor=a.Draw.Color[0],r.SecondColor=a.Draw.Color[1],r.Data.Data=a.Draw.DrawData,t.ChartPaint.push(r)},this.CreateFillRGN=function(t,e,a,i){var r=new xe;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data.Data=a.Draw.DrawData,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),t.ChartPaint.push(r)},this.CreateFillRGN2=function(t,e,a,i){var r=new Fe;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data.Data=a.Draw.DrawData,t.ChartPaint.push(r)},this.CreateFillBGRGN=function(t,e,a,i){var r=new Le;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data.Data=a.Draw.DrawData,t.ChartPaint.push(r)},this.CreateFLOATRGN=function(t,e,a,i){var r=new ye;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data.Data=a.Draw.DrawData,t.ChartPaint.push(r)},this.CreateKLine=function(t,e,a,i){var r=new Ut;r.Canvas=t.Canvas,r.Name=a.Name,r.Identify=this.Guid,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data.Data=a.Draw.DrawData,r.IsShowMaxMinPrice=!1,r.IsShowKTooltip=!1,a.Color&&(r.UnchagneColor=r.DownColor=r.UpColor=this.GetColor(a.Color)),t.ChartPaint.push(r)},this.CreateDrawColorKLine=function(t,e,a,i){var r=new Kt;r.Canvas=t.Canvas,r.Name=a.Name,r.DrawName="DRAWCOLORKLINE",r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data.Data=a.Draw.DrawData,ha.IsBool(a.Draw.IsEmptyBar)&&(r.IsEmptyBar=a.Draw.IsEmptyBar),a.Draw.Color&&(r.Color=a.Draw.Color),t.ChartPaint.push(r)},this.CreatePolyLine=function(t,e,a,i){var r=new jt;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.IsDotLine&&(r.IsDotLine=!0),a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(n)&&n>0&&(r.LineWidth=n)}var s=e+1;r.Data.Data=a.Draw.DrawData,t.TitlePaint[s].Data[i]=new Ha(r.Data," ",r.Color),t.ChartPaint.push(r)},this.CreateChartSlopeLine=function(t,e,a,i){var r=new ie;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.IsDotLine&&(r.IsDotLine=!0),a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(n)&&n>0&&(r.LineWidth=n)}var s=e+1;r.Data.Data=a.Draw.DrawData.Data,r.Option=a.Draw.DrawData.Option,t.TitlePaint[s].Data[i]=new Ha(r.Data,null,r.Color),t.ChartPaint.push(r)},this.CreateChartVericaltLine=function(t,e,a,i){var r=new he;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(n)&&n>0&&(r.LineWidth=n)}this.SetChartLineDash(r,a.Draw.DrawData),r.Data.Data=a.Draw.DrawData.Data,t.ChartPaint.push(r)},this.SetChartLineDash=function(t,e){if(ha.IsNumber(e.LineType)){var a=e.LineType,i=U();switch(a){case 1:t.LineType=[10*i,10*i];break;case 2:t.LineType=[0,10*i],t.LineCap="square";break;case 3:t.LineType=[10*i,3*i,3*i,3*i];break;case 4:t.LineType=[10*i,3*i,3*i,3*i,3*i,3*i];break}}else if(ha.IsString(e.LineType)){for(var r=e.LineType.split(","),n=[],s=0;s<r.length;++s)n.push(parseInt(r[s]));t.LineType=n}},this.CreateChartHorizontalLine=function(t,e,a,i){var r=new le;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(n)&&n>0&&(r.LineWidth=n)}this.SetChartLineDash(r,a.Draw.DrawData),r.ExtendType=a.Draw.DrawData.Extend,r.Data.Data=a.Draw.DrawData.Data,t.ChartPaint.push(r)},this.CreateBackgroud=function(t,e,a,i){var r=new Me;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Draw&&a.Draw.DrawData){var n=a.Draw.DrawData;r.Color=n.Color,r.ColorAngle=n.Angle,n.Data&&(r.Data.Data=n.Data)}t.ChartPaint.push(r)},this.CreateLineMultiData=function(t,e,a,i){var r=new ue;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Draw&&a.Draw.DrawData){var n=a.Draw.DrawData;r.Color=n.Color,n.PointColor&&(r.PointColor=n.PointColor),ha.IsPlusNumber(n.PointRadius)&&(r.PointRadius=n.PointRadius),ha.IsPlusNumber(n.LineWidth)&&(r.LineWidth=n.LineWidth),n.Data&&(r.Data.Data=n.Data)}var s=e+1,o=new Ha(r.Data,a.Name,r.Color);o.DataType="MULTI_POINT_LINE",t.TitlePaint[s].Data[i]=o,t.ChartPaint.push(r)},this.CreateTextLine=function(t,e,a,i){var r=new Ne;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Draw&&a.Draw.DrawData){var n=a.Draw.DrawData;r.Text=n.Text,r.Line=n.Line,r.Price=n.Price}t.ChartPaint.push(r)},this.CreateNumberText=function(t,e,a,i){var r=new De;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.ReloadResource(),r.TextAlign="center",a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.IsDrawAbove?r.Direction=1:r.Direction=2,a.Draw.Position&&(r.Position=a.Draw.Position);r.Data.Data=a.Draw.DrawData.Value,r.Text=a.Draw.DrawData.Text,t.ChartPaint.push(r)},this.CreateDrawText=function(t,e,a,i){var r=new De;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.ReloadResource(),a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.IsDrawAbove?r.Direction=1:r.Direction=0;r.DrawData=a.Draw.DrawData,t.ChartPaint.push(r)},this.CreateIcon=function(t,e,a,i){var r=new De;r.Canvas=t.Canvas,r.TextAlign="center",r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Direction=2,a.IsDrawAbove&&(r.Direction=1),a.DrawVAlign>=0&&(0==a.DrawVAlign?r.Direction=1:1==a.DrawVAlign?r.Direction=0:2==a.DrawVAlign&&(r.Direction=2)),a.DrawAlign>=0&&(0==a.DrawAlign?r.TextAlign="left":1==a.DrawAlign?r.TextAlign="center":2==a.DrawAlign&&(r.TextAlign="right"));r.Data.Data=a.Draw.DrawData;var n=a.Draw.Icon;1==n.IconFont?(r.IconFont={Family:n.Family,Text:n.Symbol,Color:n.Color},a.Color&&(r.IconFont.Color=this.GetColor(a.Color))):(r.Text=n.Symbol,a.Color?r.Color=this.GetColor(a.Color):n.Color?r.Color=n.Color:r.Color="rgb(0,0,0)"),a.DrawFontSize>0&&(r.FixedFontSize=a.DrawFontSize),t.ChartPaint.push(r)},this.CreateChannel=function(t,e,a,i){var r=new Ee;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Draw.AreaColor?r.AreaColor=a.Draw.AreaColor:a.Color?r.AreaColor=this.GetColor(a.Color):r.AreaColor=this.GetDefaultColor(i),a.Draw.Border.Color?r.LineColor=a.Draw.Border.Color:r.LineColor=null,a.Draw.Border.Dotted&&(r.LineDotted=a.Draw.Border.Dotted),a.Draw.Border.Width>0&&(r.LineWidth=a.Draw.Border.Width),r.Data.Data=a.Draw.DrawData,t.ChartPaint.push(r)},this.CreatePartLine=function(t,e,a,i){var r=new ee;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data.Data=a.Draw.DrawData,t.ChartPaint.push(r)},this.CreateMultiLine=function(t,e,a,i){var r=new Oe;if(r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data=t.ChartPaint[0].Data,r.Lines=a.Draw.DrawData,a.Draw.Name&&(r.Name=a.Draw.Name),a.Draw.LineDash&&(r.LineDash=a.Draw.LineDash),ha.IsNumber(a.Draw.LineWidth)&&(r.LineWidth=a.Draw.LineWidth),a.Draw.Arrow){var n=a.Draw.Arrow;1==n.Start&&(r.Arrow.Start=!0),1==n.End&&(r.Arrow.End=!0),ha.IsNumber(n.Angle)&&(r.ArrawAngle=n.Angle),ha.IsNumber(n.Length)&&(r.ArrawLength=n.Length),ha.IsNumber(n.LineWidth)&&(r.ArrawLineWidth=n.LineWidth)}t.ChartPaint.push(r);var s=e+1,o=new Ha(r.Data,r.Name,null);o.DataType="ChartMultiLine",o.Lines=r.Lines,t.TitlePaint[s].Data[i]=o},this.CreateMultiBar=function(t,e,a,i){var r=new we;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data=t.ChartPaint[0].Data,r.Bars=a.Draw.DrawData;var n=e+1,s=new Ha({KData:r.Data,BarData:r.Bars},a.Name,null);s.IsShow=!1,s.DataType="MULTI_BAR",t.TitlePaint[n].Data[i]=s,t.ChartPaint.push(r)},this.CreateMultiText=function(t,e,a,i){var r=new Re;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data=t.ChartPaint[0].Data,r.Texts=a.Draw.DrawData,t.ChartPaint.push(r)},this.CreateMultiSVGIcon=function(t,e,a,i){var r=new Pe;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data=t.ChartPaint[0].Data,r.Family=a.Draw.DrawData.Family,r.Icon=a.Draw.DrawData.Icon,t.ChartPaint.push(r)},this.CreateMulitHtmlDom=function(t,e,a,i){var r=new be;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.HQChart=t,r.Data=t.ChartPaint[0].Data,r.Texts=a.Draw.DrawData,r.DrawCallback=a.Draw.Callback,t.ChartPaint.push(r)},this.CreateStackedBar=function(t,e,a,i){var r=new Ge;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.HQChart=t,r.Identify=this.Guid,r.Data.Data=a.Draw.DrawData,ha.IsNonEmptyArray(a.Draw.BarColor)&&(r.BarColor=a.Draw.BarColor),ha.IsNonEmptyArray(a.Draw.BarName)&&(r.BarName=a.Draw.BarName),ha.IsNumber(a.Draw.LineWidth)&&(r.LineWidth=a.Draw.LineWidth),ha.IsNumber(a.Draw.BarType)&&(r.BarType=a.Draw.BarType),t.ChartPaint.push(r);var n=e+1,s=new Ha(r.Data,r.BarName,r.BarColor);s.DataType="ChartStackedBar",t.TitlePaint[n].Data[i]=s},this.CreateKLineTable=function(t,e,a,i){var r=new qt;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.HQChart=t,r.Identify=this.Guid,r.Data.Data=a.Draw.DrawData,ha.IsNumber(a.Draw.RowCount)&&(r.RowCount=a.Draw.RowCount),ha.IsBool(a.Draw.IsShowRowName)&&(r.IsShowRowName=a.Draw.IsShowRowName),ha.IsNonEmptyArray(a.Draw.RowName)&&(r.RowName=a.Draw.RowName),a.Draw.BGColor&&(r.BGColor=a.Draw.BGColor),t.ChartPaint.push(r);var n=e+1,s=new Ha(r.Data,r.BarName,r.BarColor);s.DataType="ChartKLineTable",t.TitlePaint[n].Data[i]=s},this.CreateColorKLine=function(t,e,a,i){var r=new Kt;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Data=t.ChartPaint[0].Data,r.KLineColor=a.Draw.DrawData.KLine,a.Color&&(r.Color=a.Color),t.ChartPaint.push(r)},this.CreateRectangle=function(t,e,a,i){var r=new Ae;r.Canvas=t.Canvas,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,r.Color=[a.Draw.DrawData.Color],r.Rect=a.Draw.DrawData.Rect,a.Color&&(r.BorderColor=this.GetColor(a.Color)),t.ChartPaint.push(r)},this.CreateScriptOverlayLine=function(t,e,a,i){var r=new te;if(r.Canvas=t.Canvas,r.DrawType=1,r.Name=a.Name,r.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,r.ChartFrame=t.Frame.SubFrame[e].Frame,a.Color?r.Color=this.GetColor(a.Color):r.Color=this.GetDefaultColor(i),a.LineWidth){var n=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(n)&&n>0&&(r.LineWidth=n)}a.IsDotLine&&(r.IsDotLine=!0),0==a.IsShow&&(r.IsShow=!1);var s=e+1;r.Data.Data=a.Draw.DrawData.Data,r.MainData.Data=a.Draw.DrawData.MainData,a.Draw.DrawData.Title&&(t.TitlePaint[s].Data[i]=new Ha(r.Data,a.Draw.DrawData.Title,r.Color)),t.ChartPaint.push(r)},this.CreateSelfKLine=function(t,e,a){var i=new Ut;i.Canvas=t.Canvas,i.Name="Self Kline",i.Identify=this.Guid,i.ChartBorder=t.Frame.SubFrame[e].Frame.ChartBorder,i.ChartFrame=t.Frame.SubFrame[e].Frame,i.Data=a,i.IsShowMaxMinPrice=!1,i.IsShowKTooltip=!1,i.DrawType=this.KLineType,t.ChartPaint.push(i)},this.BindInstructionData=function(t,e,a){if(!(null==this.OutVar||this.OutVar.length<0)){var i="";for(var r in this.Arguments){var n=this.Arguments[r];i.length>0&&(i+=","),i+=n.Value.toString()}if(i.length>0&&(i="("+i+")"),2==this.InstructionType){var s=this.OutVar[this.OutVar.length-1];return t.SetInstructionData(this.InstructionType,{Data:s.Data,Name:this.Name,Param:i,ID:this.ID}),!0}if(1==this.InstructionType){var o,h;for(var l in this.OutVar){var u=this.OutVar[l];"ENTERLONG"==u.Name?o=u.Data:"EXITLONG"==u.Name&&(h=u.Data)}return t.SetInstructionData(this.InstructionType,{Buy:o,Sell:h,Name:this.Name,Param:i,ID:this.ID}),!0}}},this.BindData=function(t,e,a){if(0==e&&this.InstructionType)this.BindInstructionData(t,e,a);else if(t.DeleteIndexPaint(e),0==e&&t.ShowKLine(!0),!(null==this.OutVar||this.OutVar.length<0)){for(var i in null!=this.KLineType&&(0===this.KLineType||1===this.KLineType||2===this.KLineType?this.CreateSelfKLine(t,e,a):-1===this.KLineType&&0==e&&t.ShowKLine(!1)),e>=1&&t.Frame&&(t.Frame.SubFrame[e].Frame.YSplitOperator.FloatPrecision=this.FloatPrecision,this.YSpecificMaxMin&&(t.Frame.SubFrame[e].Frame.YSpecificMaxMin=this.YSpecificMaxMin),this.YSplitScale&&(t.Frame.SubFrame[e].Frame.YSplitScale=this.YSplitScale)),ha.IsNumber(this.YSplitType)&&(t.Frame.SubFrame[e].Frame.YSplitOperator.SplitType=this.YSplitType),this.OutVar){var r=this.OutVar[i];if(!0!==r.IsExData&&(1e3!=r.Type&&1001!=r.Type)){if(0==r.Type)r.IsOverlayLine?this.CreateOverlayLine(t,e,r,i,r.Type):this.CreateLine(t,e,r,i,r.Type);else if(1==r.Type)switch(r.Draw.DrawType){case"STICKLINE":this.CreateBar(t,e,r,i);break;case"DRAWTEXT":this.CreateDrawTextV2(t,e,r,i);break;case"SUPERDRAWTEXT":this.CreateText(t,e,r,i);break;case"DRAWLINE":this.CreateStraightLine(t,e,r,i);break;case"DRAWBAND":this.CreateBand(t,e,r,i);break;case"FILLRGN":this.CreateFillRGN(t,e,r,i);break;case"FILLRGN2":this.CreateFillRGN2(t,e,r,i);break;case"FILLTOPRGN":case"FILLBOTTOMRGN":case"FILLVERTICALRGN":this.CreateFillBGRGN(t,e,r,i);break;case"FLOATRGN":this.CreateFLOATRGN(t,e,r,i);break;case"DRAWKLINE":case"DRAWKLINE1":this.CreateKLine(t,e,r,i);break;case"DRAWCOLORKLINE":this.CreateDrawColorKLine(t,e,r,i);break;case"DRAWKLINE_IF":this.CreateKLine(t,e,r,i);break;case"POLYLINE":this.CreatePolyLine(t,e,r,i);break;case"DRAWGBK":case"DRAWGBK2":this.CreateBackgroud(t,e,r,i);break;case"DRAWTEXT_LINE":this.CreateTextLine(t,e,r,i);break;case"DRAWNUMBER":this.CreateDrawNumber(t,e,r,i);break;case"DRAWNUMBER_FIX":case"DRAWTEXT_FIX":this.CreateNumberText(t,e,r,i);break;case"DRAWICON":this.CreateIcon(t,e,r,i);break;case"ICON":this.CreateIcon(t,e,r,i);break;case"DRAWCHANNEL":this.CreateChannel(t,e,r,i);break;case"PARTLINE":this.CreatePartLine(t,e,r,i);break;case"DRAWRECTREL":this.CreateRectangle(t,e,r,i);break;case"DRAWTEXTABS":case"DRAWTEXTREL":this.CreateDrawText(t,e,r,i);break;case"DRAWOVERLAYLINE":this.CreateScriptOverlayLine(t,e,r,i);break;case"DRAWSL":this.CreateChartSlopeLine(t,e,r,i);break;case"VERTLINE":this.CreateChartVericaltLine(t,e,r,i);break;case"HORLINE":this.CreateChartHorizontalLine(t,e,r,i);break;case"MULTI_LINE":this.CreateMultiLine(t,e,r,i);break;case"MULTI_BAR":this.CreateMultiBar(t,e,r,i);break;case"MULTI_TEXT":this.CreateMultiText(t,e,r,i);break;case"MULTI_SVGICON":this.CreateMultiSVGIcon(t,e,r,i);break;case"MULTI_HTMLDOM":this.CreateMulitHtmlDom(t,e,r,i);break;case"COLOR_KLINE":this.CreateColorKLine(t,e,r,i);break;case"KLINE_BG":this.CreateBackgroud(t,e,r,i);break;case"MULTI_POINT_LINE":this.CreateLineMultiData(t,e,r,i);break;case Mn.OVERLAY_BARS:this.CreateStackedBar(t,e,r,i);break;case Mn.KLINE_TABLE:this.CreateKLineTable(t,e,r,i);break;default:var n=Nn.Get(r.Draw.DrawType);n&&n.CreateChartCallback&&n.CreateChartCallback(t,e,r,i,this);break}else 2==r.Type?this.CreateMACD(t,e,r,i):3==r.Type?this.CreatePointDot(t,e,r,i):4==r.Type?this.CreateLineStick(t,e,r,i):5==r.Type?this.CreateStick(t,e,r,i):6==r.Type?this.CreateVolStick(t,e,r,i,a):7==r.Type&&this.CreateLine(t,e,r,i,r.Type);var s=t.TitlePaint[e+1];s&&s.Data&&i<s.Data.length&&(this.StringFormat>0&&(s.Data[i].StringFormat=this.StringFormat),this.FloatPrecision>=0&&(s.Data[i].FloatPrecision=this.FloatPrecision),this.OutName&&this.OutName.length>0&&this.Arguments&&this.Arguments.length>0&&s.SetDynamicTitle(this.OutName,this.Arguments))}}var o=e+1;if(t.TitlePaint[o].Title=this.Name,t.TitlePaint[o].Identify=this.Guid,!this.IsShortTitle){var h="";for(var l in this.Arguments){var u=this.Arguments[l];h.length>0&&(h+=","),h+=u.Value.toString()}h.length>0&&(t.TitlePaint[o].Title=this.Name+"("+h+")")}return this.TitleFont&&(t.TitlePaint[o].Font=this.TitleFont),!0}},this.GetDefaultColor=function(t){var e=null;Oi&&Oi.Index&&Oi.Index.LineColor&&(e=Oi.Index.LineColor),e&&Array.isArray(e)||(e=["rgb(255,174,0)","rgb(25,199,255)","rgb(175,95,162)","rgb(236,105,65)","rgb(68,114,196)","rgb(229,0,79)","rgb(0,128,255)","rgb(252,96,154)","rgb(42,230,215)","rgb(24,71,178)"]);var a=parseInt(t);return e[a%(e.length-1)]},this.GetColor=function(t){if(0==t.indexOf("RGB("))return t.toLowerCase();if(0==t.indexOf("rgb("))return t;if(0==t.indexOf("RGBA("))return t.toLowerCase();if(0==t.indexOf("rgba("))return t;var e=Ln.ColorVarToRGB(t);return e||"rgb(30,144,255)"}}function On(t,e,a,i){this.newMethod=wn,this.newMethod(t,e,a,i),delete this.newMethod,this.ClassName="OverlayScriptIndex",this.OverlayIndex=null,this.BindData=function(t,e,a){if(this.OverlayIndex&&1==this.OverlayIndex.IsOverlay&&(this.OverlayIndex.Frame.ChartPaint=[],!(null==this.OutVar||this.OutVar.length<0))){ha.IsNumber(this.YSplitType)&&(this.OverlayIndex.Frame.Frame.YSplitOperator.SplitType=this.YSplitType);var i={Data:[],Title:this.Name},r="";for(var n in this.Arguments){var s=this.Arguments[n];r.length>0&&(r+=","),r+=s.Value.toString()}r.length>0&&(i.Title=this.Name+"("+r+")");var o=e+1,h=t.TitlePaint[o];for(var n in h.OverlayIndex.set(this.OverlayIndex.Identify,i),this.OverlayIndex.Frame.Frame.Title=i.Title,this.OutName&&this.OutName.length>0&&this.Arguments&&this.Arguments.length>0&&h.SetDynamicTitle(this.OutName,this.Arguments,this.OverlayIndex.Identify),this.OutVar){var l=this.OutVar[n];if(!0!==l.IsExData)if(0==l.Type)this.CreateLine(t,e,l,n,l.Type);else if(1==l.Type)switch(l.Draw.DrawType){case"STICKLINE":this.CreateBar(t,e,l,n);break;case"DRAWTEXT":case"SUPERDRAWTEXT":this.CreateText(t,e,l,n);break;case"DRAWLINE":this.CreateStraightLine(t,e,l,n);break;case"DRAWBAND":this.CreateBand(t,e,l,n);break;case"DRAWKLINE":this.CreateKLine(t,e,l,n);break;case"DRAWKLINE_IF":this.CreateKLine(t,e,l,n);break;case"POLYLINE":this.CreatePolyLine(t,e,l,n);break;case"DRAWNUMBER":case"DRAWNUMBER_FIX":case"DRAWTEXT_FIX":this.CreateNumberText(t,e,l,n);break;case"DRAWICON":this.CreateIcon(t,e,l,n);break;case"DRAWCHANNEL":this.CreateChannel(t,e,l,n);break;case"DRAWTEXT_LINE":this.CreateTextLine(t,e,l,n);break;case"VERTLINE":this.CreateChartVericaltLine(t,e,l,n);break;case"HORLINE":this.CreateChartHorizontalLine(t,e,l,n);break;case"MULTI_LINE":this.CreateMultiLine(t,e,l,n);break;case"MULTI_BAR":this.CreateMultiBar(t,e,l,n);break;case"MULTI_TEXT":this.CreateMultiText(t,e,l,n);break;case"MULTI_SVGICON":this.CreateMultiSVGIcon(t,e,l,n);break;case"MULTI_HTMLDOM":this.CreateMulitHtmlDom(t,e,l,n);break;case"KLINE_BG":this.CreateBackgroud(t,e,l,n);break;case Mn.OVERLAY_BARS:this.CreateStackedBar(t,e,l,n);break}else 2==l.Type?this.CreateMACD(t,e,l,n):3==l.Type?this.CreatePointDot(t,e,l,n):4==l.Type?this.CreateLineStick(t,e,l,n):5==l.Type?this.CreateStick(t,e,l,n):6==l.Type?this.CreateVolStick(t,e,l,n,a):7==l.Type&&this.CreateLine(t,e,l,n,l.Type)}return!0}},this.RecvResultData=function(t,e){var a=e.HQChart,i=e.WindowIndex,r=e.HistoryData;e.Self.OutVar=t,e.Self.BindData(a,i,r),e.HQChart.UpdataDataoffset(),e.HQChart.UpdateFrameMaxMin(),e.HQChart.Draw();var n=a.GetOverlayIndexEvent();if(n){var s=e.Self,o={OutVar:s.OutVar,WindowIndex:i,Name:s.Name,Arguments:s.Arguments,HistoryData:r,Identify:s.OverlayIndex.Identify,Stock:{Symbol:a.Symbol,Name:a.Name}};n.Callback(n,o,s)}},this.CreateLine=function(t,e,a,i,r){var n=this.OverlayIndex,s=n.Frame;if(7==r)var o=new ae;else o=new jt;if(o.Canvas=t.Canvas,o.DrawType=1,o.Name=a.Name,o.ChartBorder=s.Frame.ChartBorder,o.ChartFrame=s.Frame,o.Identify=n.Identify,a.Color?o.Color=this.GetColor(a.Color):o.Color=this.GetDefaultColor(i),a.LineWidth){var h=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(h)&&h>0&&(o.LineWidth=h)}0==a.IsShow&&(o.IsShow=!1);var l=e+1;o.Data.Data=a.Data;var u=t.TitlePaint[l],C=new Ha(o.Data,a.Name,o.Color);C.ChartClassName=o.ClassName,u.OverlayIndex.get(n.Identify).Data[i]=C,s.ChartPaint.push(o)},this.CreateBar=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new Ce;s.Canvas=t.Canvas,a.Draw.Width>0?s.Width=a.Draw.Width:s.Width=1,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(i);s.Data.Data=a.Draw.DrawData,n.ChartPaint.push(s)},this.CreateText=function(t,e,a,i,r){var n=this.OverlayIndex,s=n.Frame,o=new De;o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=s.Frame.ChartBorder,o.ChartFrame=s.Frame,o.Identify=n.Identify,o.ReloadResource(),a.Color?o.Color=this.GetColor(a.Color):o.Color=this.GetDefaultColor(i);a.Draw.Position&&(o.Position=a.Draw.Position),a.Draw.DrawData&&(o.Data.Data=a.Draw.DrawData),o.Text=a.Draw.Text,a.Draw.Direction>0&&(o.Direction=a.Draw.Direction),a.Draw.YOffset>0&&(o.YOffset=a.Draw.YOffset),a.Draw.TextAlign&&(o.TextAlign=a.Draw.TextAlign),s.ChartPaint.push(o)},this.CreateMACD=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new pe;s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify;var o=e+1;s.Data.Data=a.Data;var h=t.TitlePaint[o],l=this.GetDefaultColor(i);a.Color&&(l=this.GetColor(a.Color)),h.OverlayIndex.get(r.Identify).Data[i]=new Ha(s.Data,a.Name,l),n.ChartPaint.push(s)},this.CreatePointDot=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new re;if(s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(i),a.Radius&&(s.Radius=a.Radius),a.LineWidth){var o=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(o)&&o>0&&(s.Radius=o)}var h=e+1;s.Data.Data=a.Data;var l=t.TitlePaint[h];l.OverlayIndex.get(r.Identify).Data[i]=new Ha(s.Data,a.Name,s.Color),n.ChartPaint.push(s)},this.CreateStick=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new ne;if(s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(i),a.LineWidth){var o=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(o)&&o>0&&(s.LineWidth=o)}var h=e+1;s.Data.Data=a.Data;var l=t.TitlePaint[h];l.OverlayIndex.get(r.Identify).Data[i]=new Ha(s.Data,a.Name,s.Color),n.ChartPaint.push(s)},this.CreateLineStick=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new se;if(s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(i),a.LineWidth){var o=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(o)&&o>0&&(s.LineWidth=o)}var h=e+1;s.Data.Data=a.Data;var l=t.TitlePaint[h];l.OverlayIndex.get(r.Identify).Data[i]=new Ha(s.Data,a.Name,s.Color),n.ChartPaint.push(s)},this.CreateStraightLine=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new jt;if(s.DrawType=1,s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(i),a.LineWidth){var o=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(o)&&o>0&&(s.LineWidth=o)}s.Data.Data=a.Draw.DrawData,n.ChartPaint.push(s)},this.CreateVolStick=function(t,e,a,i,r){var n=this.OverlayIndex,s=n.Frame,o=new oe;o.Canvas=t.Canvas,o.Name=a.Name,o.ChartBorder=s.Frame.ChartBorder,o.ChartFrame=s.Frame,o.Identify=n.Identify,o.KLineDrawType=t.KLineDrawType,a.Color?o.Color=this.GetColor(a.Color):o.Color=this.GetDefaultColor(i);var h=e+1;o.Data.Data=a.Data,o.HistoryData=r;var l=t.TitlePaint[h];l.OverlayIndex.get(n.Identify).Data[i]=new Ha(o.Data,a.Name,o.Color),s.ChartPaint.push(o)},this.CreateBand=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new ge;s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,s.FirstColor=a.Draw.Color[0],s.SecondColor=a.Draw.Color[1],s.Data.Data=a.Draw.DrawData,n.ChartPaint.push(s)},this.CreateKLine=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new Ut;s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,s.Data.Data=a.Draw.DrawData,s.IsShowMaxMinPrice=!1,s.IsShowKTooltip=!1,a.Color&&(s.UnchagneColor=s.DownColor=s.UpColor=this.GetColor(a.Color)),n.ChartPaint.push(s)},this.CreatePolyLine=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new jt;if(s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(i),a.LineWidth){var o=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(o)&&o>0&&(s.LineWidth=o)}var h=e+1;s.Data.Data=a.Draw.DrawData;var l=t.TitlePaint[h];l.OverlayIndex.get(r.Identify).Data[i]=new Ha(line.Data," ",line.Color),n.ChartPaint.push(s)},this.CreateNumberText=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new De;s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,s.ReloadResource(),s.TextAlign="center",a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(i),a.IsDrawAbove?s.Direction=1:s.Direction=2,a.Draw.Position&&(s.Position=a.Draw.Position);s.Data.Data=a.Draw.DrawData.Value,s.Text=a.Draw.DrawData.Text,n.ChartPaint.push(s)},this.CreateTextLine=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new Ne;if(s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,a.Draw&&a.Draw.DrawData){var o=a.Draw.DrawData;s.Text=o.Text,s.Line=o.Line,s.Price=o.Price}n.ChartPaint.push(s)},this.CreateStackedBar=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new Ge;s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,ha.IsNonEmptyArray(a.Draw.BarColor)&&(s.BarColor=a.Draw.BarColor),ha.IsNonEmptyArray(a.Draw.BarName)&&(s.BarName=a.Draw.BarName),ha.IsNumber(a.Draw.LineWidth)&&(s.LineWidth=a.Draw.LineWidth),ha.IsNumber(a.Draw.BarType)&&(s.BarType=a.Draw.BarType),s.Data.Data=a.Draw.DrawData;var o=e+1,h=t.TitlePaint[o],l=new Ha(s.Data,s.BarName,s.BarColor);l.DataType="ChartStackedBar",h.OverlayIndex.get(r.Identify).Data[i]=l,n.ChartPaint.push(s)},this.CreateIcon=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new De;s.Canvas=t.Canvas,s.TextAlign="center",s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify;s.Data.Data=a.Draw.DrawData;var o=a.Draw.Icon;1==o.IconFont?s.IconFont={Family:o.Family,Text:o.Symbol,Color:o.Color}:(s.Text=o.Symbol,a.Color?s.Color=this.GetColor(a.Color):o.Color?s.Color=o.Color:s.Color="rgb(0,0,0)"),n.ChartPaint.push(s)},this.CreateChannel=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new Ee;s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,a.Draw.AreaColor?s.AreaColor=a.Draw.AreaColor:a.Color?s.AreaColor=this.GetColor(a.Color):s.AreaColor=this.GetDefaultColor(i),a.Draw.Border.Color?s.LineColor=a.Draw.Border.Color:s.LineColor=null,a.Draw.Border.Dotted&&(s.LineDotted=a.Draw.Border.Dotted),a.Draw.Border.Width>0&&(s.LineWidth=a.Draw.Border.Width),s.Data.Data=a.Draw.DrawData,n.ChartPaint.push(s)},this.CreatePartLine=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new ee;s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,s.Data.Data=a.Draw.DrawData,n.ChartPaint.push(s)},this.CreateMultiLine=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new Oe;if(s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,s.Data=t.ChartPaint[0].Data,s.Lines=a.Draw.DrawData,a.Draw.LineDash&&(s.LineDash=a.Draw.LineDash),ha.IsNumber(a.Draw.LineWidth)&&(s.LineWidth=a.Draw.LineWidth),a.Draw.Arrow){var o=a.Draw.Arrow;1==o.Start&&(s.Arrow.Start=!0),1==o.End&&(s.Arrow.End=!0),ha.IsNumber(o.Angle)&&(s.ArrawAngle=o.Angle),ha.IsNumber(o.Length)&&(s.ArrawLength=o.Length),ha.IsNumber(o.LineWidth)&&(s.ArrawLineWidth=o.LineWidth)}n.ChartPaint.push(s)},this.CreateBackgroud=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new Me;if(s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,a.Draw&&a.Draw.DrawData){var o=a.Draw.DrawData;s.Color=o.Color,s.ColorAngle=o.Angle,o.Data&&(s.Data.Data=o.Data)}n.ChartPaint.push(s)},this.CreateMultiBar=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new we;s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,s.Data=t.ChartPaint[0].Data,s.Bars=a.Draw.DrawData;var o=e+1,h=t.TitlePaint[o],l=new Ha({KData:s.Data,BarData:s.Bars},a.Name,null);l.IsShow=!1,l.DataType="MULTI_BAR",h.OverlayIndex.get(r.Identify).Data[i]=l,n.ChartPaint.push(s)},this.CreateMultiText=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new Re;s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,s.Data=t.ChartPaint[0].Data,s.Texts=a.Draw.DrawData,n.ChartPaint.push(s)},this.CreateMultiSVGIcon=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new Pe;s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,s.Data=t.ChartPaint[0].Data,s.Family=a.Draw.DrawData.Family,s.Icon=a.Draw.DrawData.Icon,n.ChartPaint.push(s)},this.CreateMulitHtmlDom=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new be;s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,s.HQChart=t,s.Data=t.ChartPaint[0].Data,s.Texts=a.Draw.DrawData,s.DrawCallback=a.Draw.Callback,n.ChartPaint.push(s)},this.CreateChartVericaltLine=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new he;if(s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,s.HQChart=t,a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(i),a.LineWidth){var o=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(o)&&o>0&&(s.LineWidth=o)}this.SetChartLineDash(s,a.Draw.DrawData),s.Data.Data=a.Draw.DrawData.Data,n.ChartPaint.push(s)},this.CreateChartHorizontalLine=function(t,e,a,i){var r=this.OverlayIndex,n=r.Frame,s=new le;if(s.Canvas=t.Canvas,s.Name=a.Name,s.ChartBorder=n.Frame.ChartBorder,s.ChartFrame=n.Frame,s.Identify=r.Identify,s.HQChart=t,a.Color?s.Color=this.GetColor(a.Color):s.Color=this.GetDefaultColor(i),a.LineWidth){var o=parseInt(a.LineWidth.replace("LINETHICK",""));!isNaN(o)&&o>0&&(s.LineWidth=o)}this.SetChartLineDash(s,a.Draw.DrawData),s.ExtendType=a.Draw.DrawData.Extend,s.Data.Data=a.Draw.DrawData.Data,n.ChartPaint.push(s)},this.CreateSelfKLine=function(t,e,a){var i=this.OverlayIndex,r=i.Frame,n=new Ut;n.Canvas=t.Canvas,n.Name="Self Kline",n.ChartBorder=r.Frame.ChartBorder,n.ChartFrame=r.Frame,n.Identify=i.Identify,n.Data=a,n.IsShowMaxMinPrice=!1,n.IsShowKTooltip=!1,n.DrawType=this.KLineType,r.ChartPaint.push(n)},this.GetDefaultColor=function(t){var e=["rgb(24,71,178)","rgb(42,230,215)","rgb(252,96,154)","rgb(0,128,255)","rgb(229,0,79)","rgb(68,114,196)","rgb(255,174,0)","rgb(25,199,255)","rgb(175,95,162)","rgb(236,105,65)"],a=parseInt(t);return e[a%(e.length-1)]}}function Rn(t,e,a,i,r){this.newMethod=r?On:wn,this.newMethod(t,e,a,i),delete this.newMethod,this.ClassName="APIScriptIndex",this.IsOverlayIndex=1==r,this.ApiUrl,this.HQDataType,this.Version=1,i&&i.API&&(i.API.Url&&(this.ApiUrl=i.API.Url),i.API.Name&&(this.Name=this.ID=i.API.Name),i.API.ID&&(this.ID=i.API.ID),i.API.Version>0&&(this.Version=i.API.Version),!0===i.API.IsUsePageData&&(this.IsUsePageData=i.API.IsUsePageData)),this.Super_CopyTo=this.CopyTo,this.CopyTo=function(t){this.Super_CopyTo(t),t.ApiUrl=this.ApiUrl,t.Version=this.Version,t.IsOverlayIndex=this.IsOverlayIndex},this.ExecuteScript=function(t,e,a){w.Complier.Log("[APIScriptIndex::ExecuteScript] name, Arguments ",this.Name,this.Arguments);var i=En.KLINE_ID,r=null;"MinuteChartContainer"===t.ClassName||"MinuteChartHScreenContainer"===t.ClassName?(i=t.DayCount>1?En.MULTIDAY_MINUTE_ID:En.MINUTE_ID,r=a.GetDateRange()):"HistoryMinuteChartContainer"===t.ClassName?i=En.HISTORY_MINUTE_ID:r=a.GetDateRange();var n,s=[];if(this.Arguments)for(var o in this.Arguments){var h=this.Arguments[o];s.push({name:h.Name,value:h.Value})}t.GetRequestDataCount&&(n=t.GetRequestDataCount());var l=this,u={indexname:this.ID,symbol:t.Symbol,script:this.Script,args:s,period:t.Period,right:t.Right,hqdatatype:i};if(r&&(u.DateRange=r),n&&(u.maxdatacount=n.MaxRequestDataCount,u.maxminutedaycount=n.MaxRequestMinuteDayCount),i!=En.MULTIDAY_MINUTE_ID&&i!=En.MINUTE_ID||(u.daycount=t.DayCount),this.HQDataType=i,t.NetworkFilter){var C={Name:"APIScriptIndex::ExecuteScript",Explain:"ææ è®¡ç®",Request:{Url:l.ApiUrl,Type:"POST",Data:u},Self:this,HQChart:t,PreventDefault:!1};if(t.NetworkFilter(C,(function(i){2==l.Version?l.RecvAPIData2(i,t,e,a):l.RecvAPIData(i,t,e,a)})),1==C.PreventDefault)return}O.HttpRequest({url:l.ApiUrl,data:u,type:"post",dataType:"json",async:!0,success:function(i){l.RecvAPIData(i,t,e,a)},error:function(t){l.RecvError(t)}})},this.RecvAPIData2=function(t,e,a,i){if(w.Complier.Log("[APIScriptIndex::RecvAPIData2] recv data ",this.Name,t),(this.HQDataType==En.KLINE_ID||this.HQDataType==En.MINUTE_ID||this.HQDataType==En.MULTIDAY_MINUTE_ID)&&(this.OutVar=this.ConvertToLocalData(t,e),w.Complier.Log("[APIScriptIndex::RecvAPIData2] conver to OutVar ",this.OutVar)),this.BindData(e,a,i),e.UpdataDataoffset(),e.UpdateFrameMaxMin(),e.Draw(),e.GetIndexEvent){var r=e.GetIndexEvent();if(r){t={OutVar:this.OutVar,WindowIndex:a,Name:this.Name,Arguments:this.Arguments,HistoryData:i,Stock:{Symbol:e.Symbol,Name:e.Name}};r.Callback(r,t,this)}}},this.ConvertToLocalData=function(t,e){var a=t.OutVar;if("MinuteChartContainer"==e.ClassName||"MinuteChartHScreenContainer"==e.ClassName)var i=e.SourceData,r=i.GetAPIDataIndex(t.Date,t.Time);else{i=e.ChartPaint[0].Data;if(Ot.IsDayPeriod(t.Period,!0))r=i.GetAPIDataIndex(t.Date);else r=i.GetAPIDataIndex(t.Date,t.Time)}var n=[];for(var s in a){var o=a[s],h={Type:o.Type,Name:o.Name};if(0==o.Type){h.Data=[];for(var l=0;l<r.length;++l){var u=r[l];u.Index<0?h.Data[l]=null:h.Data[l]=o.Data[u.Index]}h.Name&&h.Name.indexOf("@NODRAW@")>=0&&(h.Name=h.Name.replace("@NODRAW@",""))}else{if(1!=o.Type)continue;h.Name=o.DrawType,h.Draw={DrawType:o.DrawType};var C=o.Draw;switch(o.DrawType){case"STICKLINE":var D=[];for(l=0;l<r.length;++l){D[l]=null;u=r[l];var f=u.Index;if(!(f<0)){var c=C.Price[f],d=C.Price2[f];ha.IsNumber(c)&&ha.IsNumber(d)&&(D[l]={Value:c,Value2:d})}}h.Draw.DrawData=D,h.Draw.Width=C.Width,h.Draw.Type=C.Empty;break;case"DRAWTEXT":D=[];var m=[];for(l=0;l<r.length;++l){D[l]=null;u=r[l],f=u.Index;if(!(f<0)){c=C.Price[f];if(ha.IsNumber(c)&&(D[l]=c),Array.isArray(C.Text)){o=C.Text[f];ha.IsString(o)&&(m[l]=o)}}}Array.isArray(C.Text)?h.Draw.Text=m:h.Draw.Text=C.Text,h.Draw.DrawData=D;break;case"DRAWNUMBER":for(D={Value:[],Text:[]},l=0;l<r.length;++l){D.Value[l]=null,D.Text[l]=null;u=r[l],f=u.Index;if(!(f<0)){c=C.Price[f];var v=C.Number[f];ha.IsNumber(c)&&ha.IsNumber(v)&&(D.Value[l]=c,D.Text[l]=v.toFixed(2))}}h.Draw.DrawData=D;break;case"DRAWBAND":for(D=[],l=0;l<r.length;++l){D[l]=null;u=r[l],f=u.Index;if(!(f<0)){c=C.Val1[f],d=C.Val2[f];ha.IsNumber(c)&&ha.IsNumber(d)&&(D[l]={Value:c,Value2:d})}}h.Draw.DrawData=D,h.Draw.Color=[C.Color1.toLowerCase(),C.Color2.toLowerCase()];break;case"DRAWKLINE":for(D=[],l=0;l<r.length;++l){o={Open:null,High:null,Low:null,Close:null};D[l]=o;u=r[l],f=u.Index;if(!(f<0)){var S=C.High[f],I=C.Low[f],p=C.Open[f],T=C.Close[f];ha.IsPlusNumber(S)&&ha.IsPlusNumber(I)&&ha.IsPlusNumber(p)&&ha.IsPlusNumber(T)&&(o.Open=p,o.Close=T,o.High=S,o.Low=I)}}h.Draw.DrawData=D;break;case"DRAWTEXT_FIX":for(D={Value:[],Text:[]},l=0;l<r.length;++l){D.Value[l]=0,D.Text[l]=null;u=r[l],f=u.Index;if(!(f<0)){var g=C.Cond[f];g&&(D.Value[l]=1,D.Text[l]=C.Text)}}h.Draw.DrawData=D,h.Draw.Position={X:C.X,Y:C.Y,Type:C.Type};break;case"DRAWNUMBER_FIX":for(D={Value:[],Text:[]},l=0;l<r.length;++l){D.Value[l]=null,D.Text[l]=null;u=r[l],f=u.Index;if(!(f<0)){var x=C.Number[f];ha.IsNumber(x)&&(D.Value[l]=x,D.Text[l]=ha.RemoveZero(x.toFixed(2)))}}h.Draw.DrawData=D,h.Draw.Position={X:C.X,Y:C.Y,Type:C.Type};break;case"DRAWICON":var F=sn.GetDrawIcon(C.Type);F||sn.GetDrawTextIcon(C.Type),F||(F={Symbol:"ð©"}),h.Draw.Icon=F;for(D=[],l=0;l<r.length;++l){D[l]=null;u=r[l],f=u.Index;if(!(f<0)){x=C.Price[f];ha.IsNumber(x)&&(D[l]=x)}}h.Draw.DrawData=D;break;case"PARTLINE":for(D=[],l=0;l<r.length;++l){D[l]={Value:null,RGB:null};u=r[l],f=u.Index;if(!(f<0)){var y=C.Color[f];if(ha.IsString(y)){x=C.Price[f];ha.IsNumber(x)&&(D[l].Value=x,D[l].RGB=y)}}}h.Draw.DrawData=D;break;case"FILLRGN":for(D=[],l=0;l<r.length;++l){D[l]=null;u=r[l],f=u.Index;if(!(f<0)){y=C.Color[f];if(ha.IsString(y)){x=C.Price[f];if(ha.IsNumber(x)){var L=C.Price2[f];ha.IsNumber(L)&&(D[l]={Value:x,Value2:L,Color:y})}}}}h.Draw.DrawData=D,h.Draw.DrawType="FILLRGN2";break;default:continue}}for(var s in o.Attribute){var E=o.Attribute[s];switch(E){case"COLORSTICK":h.Type=2;break;case"POINTDOT":h.Radius=Oi.POINTDOT.Radius,h.Type=3;break;case"CIRCLEDOT":h.Radius=Oi.CIRCLEDOT.Radius,h.Type=3;break;case"DOTLINE":h.IsDotLine=!0;break;case"DRAWABOVE":h.IsDrawAbove=!0;break;case"LINESTICK":h.Type=4;break;case"STICK":h.Type=5;break;case"VOLSTICK":h.Type=6;break;case"NODRAW":h.IsShow=!1;break;case"NONE_OUT_NAME":h.NoneName=!0;break;case"NOTEXT":h.IsShowTitle=!1;break}0==E.indexOf("COLOR")?h.Color=E:0==E.indexOf("LINETHICK")&&(h.LineWidth=E)}n.push(h)}return n},this.RecvAPIData=function(t,e,a,i){if(w.Complier.Log("[APIScriptIndex::RecvAPIData] recv data ",this.Name,t),0==t.code){if(t.outdata&&t.outdata.name&&(this.Name=t.outdata.name),t.outdata.args)for(var r in this.Arguments=[],t.outdata.args){var n=t.outdata.args[r];this.Arguments.push({Name:n.name,Value:n.value})}if(this.HQDataType==En.KLINE_ID?(this.OutVar=this.FittingData(t.outdata,e),w.Complier.Log("[APIScriptIndex::RecvAPIData] conver to OutVar ",this.OutVar)):this.OutVar=this.FittingMinuteData(t.outdata,e),this.BindData(e,a,i),0==this.IsLocked)e.Frame.SubFrame[a].Frame.SetLock(null);else{var s={IsLocked:!0,Callback:this.LockCallback,IndexName:this.Name,ID:this.LockID,BG:this.LockBG,Text:this.LockText,TextColor:this.LockTextColor,Font:this.LockFont,Count:this.LockCount,MinWidth:this.LockMinWidth};e.Frame.SubFrame[a].Frame.SetLock(s)}if(e.UpdataDataoffset(),e.UpdateFrameMaxMin(),e.Draw(),e.GetIndexEvent){var o=e.GetIndexEvent();if(o){t={OutVar:this.OutVar,WindowIndex:a,Name:this.Name,Arguments:this.Arguments,HistoryData:i,Stock:{Symbol:e.Symbol,Name:e.Name}};o.Callback(o,t,this)}}}},this.FittingArray=function(t,e,a,i,r){var n,s=i.ChartPaint[0].Data,o=[];for(var h in t){var l=t[h],u=new Et;u.Date=e[h],a&&h<a.length&&(u.Time=a[h]),u.Value=l,o.push(u)}n=Ot.IsDayPeriod(i.Period,!0)?s.GetFittingData(o):s.GetMinuteFittingData(o);var C,D=new Ot;return D.Data=n,C=1==r?D.GetObject():D.GetValue(),C},this.FittingMultiLine=function(t,e,a,i){var r=i.ChartPaint[0].Data;if(Ot.IsDayPeriod(i.Period,!0)){r=i.ChartPaint[0].Data;var n=[];for(var s in t){var o=t[s];for(var h in o.Point){var l=o.Point[h];n.push(l)}}return n.sort((function(t,e){return t.Date-e.Date})),r.GetDateIndex(n),t}if(Ot.IsMinutePeriod(i.Period,!0)||Ot.IsTickPeriod(i.Period)){r=i.ChartPaint[0].Data,n=[];for(var s in t){o=t[s];for(var h in o.Point){l=o.Point[h];n.push(l)}}return n.sort((function(t,e){return t.Date==e.Date?t.Time-e.Time:t.Date-e.Date})),r.GetDateTimeIndex(n),t}if(this.HQDataType==En.MINUTE_ID||this.HQDataType==En.MULTIDAY_MINUTE_ID){var u=i.SourceData;n=[];for(var s in t){o=t[s];for(var h in o.Point){l=o.Point[h];n.push(l)}}return n.sort((function(t,e){return t.Date==e.Date?t.Time-e.Time:t.Date-e.Date})),u.GetDateTimeIndex(n),t}return null},this.FittingMultiText=function(t,e,a,i){if(Ot.IsDayPeriod(i.Period,!0)){var r=i.ChartPaint[0].Data;return t.sort((function(t,e){return t.Date-e.Date})),r.GetDateIndex(t),t}if(Ot.IsMinutePeriod(i.Period,!0)||Ot.IsTickPeriod(i.Period)){r=i.ChartPaint[0].Data;return t.sort((function(t,e){return t.Date==e.Date?t.Time-e.Time:t.Date-e.Date})),r.GetDateTimeIndex(t),t}if(this.HQDataType==En.MINUTE_ID||this.HQDataType==En.MULTIDAY_MINUTE_ID){var n=i.SourceData;return t.sort((function(t,e){return t.Date==e.Date?t.Time-e.Time:t.Date-e.Date})),n.GetDateTimeIndex(t),t}return null},this.FittingData=function(t,e){var a=t.outvar,i=t.date,r=t.time,n=(e.ChartPaint[0].Data,[]);for(var s in a){var o=a[s],h={Name:o.name,Type:o.type};if(o.color&&(h.Color=o.color),o.data)h.Data=this.FittingArray(o.data,i,r,e),o.color&&(h.Color=o.color),o.linewidth&&(h.LineWidth=o.linewidth),0==o.isshow&&(h.IsShow=!1),1==o.isexdata&&(h.IsExData=!0),n.push(h);else if(o.Draw){var l=o.Draw,u={};if("DRAWICON"==l.DrawType)u.Icon=l.Icon,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData=this.FittingArray(l.DrawData,i,r,e),h.Draw=u,n.push(h);else if("DRAWTEXT"==l.DrawType)u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData=this.FittingArray(l.DrawData,i,r,e),h.Draw=u,n.push(h);else if("STICKLINE"==l.DrawType)u.Name=l.Name,u.Type=l.Type,u.Width=l.Width,u.DrawType=l.DrawType,u.DrawData=this.FittingArray(l.DrawData,i,r,e,1),h.Draw=u,n.push(h);else if("MULTI_LINE"==l.DrawType){for(var C in u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData=this.FittingMultiLine(l.DrawData,i,r,e),u.DrawData)this.GetKLineData(u.DrawData[C].Point,e);h.Draw=u,l.LineDash&&(u.LineDash=l.LineDash),l.Arrow&&(u.Arrow=l.Arrow),ha.IsNumber(l.LineWidth)&&(u.LineWidth=l.LineWidth),n.push(h)}else if("MULTI_BAR"==l.DrawType)u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData=this.FittingMultiLine(l.DrawData,i,r,e),h.Draw=u,n.push(h);else if(l.DrawType==Mn.OVERLAY_BARS)u.Name=l.Name,u.Type=l.Type,u.DrawType=l.DrawType,u.BarName=l.BarName,u.BarColor=l.BarColor,u.LineWidth=l.LineWidth,u.BarType=l.BarType,u.DrawData=this.FittingArray(l.DrawData,i,r,e,1),h.Draw=u,n.push(h);else if(l.DrawType==Mn.KLINE_TABLE)u.Name=l.Name,u.Type=l.Type,u.DrawType=l.DrawType,u.DrawData=this.FittingArray(l.DrawData,i,r,e,1),u.RowCount=l.RowCount,u.RowName=l.RowName,u.IsShowRowName=l.IsShowRowName,u.BGColor=l.BGColor,h.Draw=u,n.push(h);else if("MULTI_TEXT"==l.DrawType)u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData=this.FittingMultiText(l.DrawData,i,r,e),this.GetKLineData(u.DrawData,e),h.Draw=u,n.push(h);else if("MULTI_SVGICON"==l.DrawType)u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData={Icon:this.FittingMultiText(l.DrawData.Icon,i,r,e),Family:l.DrawData.Family},this.GetKLineData(u.DrawData.Icon,e),h.Draw=u,n.push(h);else if("MULTI_HTMLDOM"==l.DrawType)u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.Callback=l.Callback,u.DrawData=this.FittingMultiText(l.DrawData,i,r,e),this.GetKLineData(u.DrawData,e),h.Draw=u,n.push(h);else if("COLOR_KLINE"==l.DrawType){u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType;var D=this.FittingMultiText(l.DrawData.KLine,i,r,e),f=new E.default;for(var s in D){o=D[s];f.set(o.Index,o)}u.DrawData={KLine:f},l.Color&&(h.Color=l.Color),h.Draw=u,n.push(h)}else"KLINE_BG"==l.DrawType?(u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData={},u.DrawData.Color=l.Color,u.DrawData.Angle=l.Angle,2==l.Ver?u.DrawData.Data=this.FittingKLineBG_V2(l.DrawData,e):u.DrawData.Data=this.FittingKLineBG(l.DrawData,e),h.Draw=u,h.Name=l.DrawType,n.push(h)):"MULTI_POINT_LINE"==l.DrawType&&(u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData={},u.DrawData.Color=l.Color,u.DrawData.PointRadius=l.PointRadius,u.DrawData.PointColor=l.PointColor,u.DrawData.LineWidth=l.LineWidth,u.DrawData.Data=this.FittingMultiPointLine(l.DrawData,e),h.Draw=u,n.push(h))}}return n},this.GetKLineData=function(t,e){if(t&&Array.isArray(t)){if(this.HQDataType==En.MINUTE_ID||this.HQDataType==En.MULTIDAY_MINUTE_ID)var a=e.SourceData;else a=e.ChartPaint[0].Data;for(var i in t){var r=t[i];if(ha.IsString(r.Value)&&(ha.IsNumber(r.Index)&&!(r.Index<0||r.Index>=a.Data.length))){var n=r.Value.toUpperCase(),s=a.Data[r.Index];switch(n){case"HIGH":case"H":r.Value=s.High;break;case"L":case"LOW":r.Value=s.Low;break;case"C":case"CLOSE":r.Value=s.Close;break}}}}},this.FittingKLineBG=function(t,e){var a=e.ChartPaint[0].Data,i=[];if(Ot.IsDayPeriod(e.Period,!0)){for(var r=!1,n=0,s=0;n<a.Data.length;){i[n]=0;var o=a.Data[n];if(s>=t.length)++n;else{var h=t[s];h.Date<o.Date?++s:(h.Date>o.Date||(r=!0,i[n]=1,++s),++n)}}if(r)return i}else if(Ot.IsMinutePeriod(e.Period,!0)){for(r=!1,n=0,s=0;n<a.Data.length;){i[n]=0;o=a.Data[n];if(s>=t.length)++n;else{h=t[s];h.Date<o.Date||h.Date==o.Date&&h.Time<o.Time?++s:(h.Date>o.Date||h.Date==o.Date&&h.Time>o.Time||(r=!0,i[n]=1,++s),++n)}}if(r)return i}return null},this.FittingKLineBG_V2=function(t,e){var a=e.ChartPaint[0].Data,i=[];if(Ot.IsDayPeriod(e.Period,!0)){for(var r=!1,n=0,s=0;n<a.Data.length;++n){i[n]=0;var o=a.Data[n],h=o.Date;for(s=0;s<t.length;++s){var l=t[s];if(h>=l.Start.Date&&h<=l.End.Date){i[n]=1,r=!0;break}}}if(r)return i}else if(Ot.IsMinutePeriod(e.Period,!0)){var u=[];for(n=0;n<t.length;++n){var C=t[n],D=1e4*C.Start.Date;ha.IsNumber(C.Start.Time)&&(D+=C.Start.Time);var f=1e4*C.End.Date;ha.IsNumber(C.End.Time)&&(f+=C.End.Time),u.push({Start:D,End:f})}for(r=!1,n=0,s=0;n<a.Data.length;++n){i[n]=0;o=a.Data[n],h=1e4*o.Date+o.Time;for(s=0;s<u.length;++s){l=u[s];if(h>=l.Start&&h<=l.End){i[n]=1,r=!0;break}}}if(r)return i}return null},this.FittingMinuteData=function(t,e){for(var a=t.outvar,i=t.date,r=t.time,n=[],s=0;s<a.length;++s){var o=a[s],h={Name:o.name,Type:o.type};if(o.data)h.Data=this.FittingMinuteArray(o.data,i,r,e),o.color&&(h.Color=o.color),o.linewidth>=1&&(h.LineWidth=o.linewidth),0==o.isshow&&(h.IsShow=!1),1==o.isexdata&&(h.IsExData=!0),n.push(h);else if(o.Draw){var l=o.Draw,u={};if("DRAWICON"==l.DrawType)u.Icon=l.Icon,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData=this.FittingMinuteArray(l.DrawData,i,r,e),h.Draw=u,n.push(h);else if("DRAWTEXT"==l.DrawType)u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData=this.FittingMinuteArray(l.DrawData,i,r,e),h.Draw=u,n.push(h);else if("STICKLINE"==l.DrawType)u.Name=l.Name,u.Type=l.Type,u.Width=l.Width,u.DrawType=l.DrawType,u.DrawData=this.FittingMinuteArray(l.DrawData,i,r,e,1),h.Draw=u,n.push(h);else if(l.DrawType==Mn.OVERLAY_BARS)u.Name=l.Name,u.Type=l.Type,u.DrawType=l.DrawType,u.BarName=l.BarName,u.BarColor=l.BarColor,u.LineWidth=l.LineWidth,u.DrawData=this.FittingMinuteArray(l.DrawData,i,r,e,1),h.Draw=u,n.push(h);else if("MULTI_LINE"==l.DrawType){for(var C in u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData=this.FittingMultiLine(l.DrawData,i,r,e),u.DrawData)this.GetKLineData(u.DrawData[C].Point,e);h.Draw=u,l.LineDash&&(u.LineDash=l.LineDash),l.Arrow&&(u.Arrow=l.Arrow),n.push(h)}else if("MULTI_TEXT"==l.DrawType)u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData=this.FittingMultiText(l.DrawData,i,r,e),this.GetKLineData(u.DrawData,e),h.Draw=u,n.push(h);else if("MULTI_SVGICON"==l.DrawType)u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.DrawData={Icon:this.FittingMultiText(l.DrawData.Icon,i,r,e),Family:l.DrawData.Family},this.GetKLineData(u.DrawData.Icon,e),h.Draw=u,n.push(h);else if("MULTI_HTMLDOM"==l.DrawType)u.Text=l.Text,u.Name=l.Name,u.DrawType=l.DrawType,u.Callback=l.Callback,u.DrawData=this.FittingMultiText(l.DrawData,i,r,e),this.GetKLineData(u.DrawData,e),h.Draw=u,n.push(h);else{var D=Nn.Get(l.DrawType);D&&D.MinuteFittingCallback&&D.MinuteFittingCallback(o,h,{Date:i,Time:r,HQChart:e},this)&&n.push(h)}}}return n},this.FittingMinuteArray=function(t,e,a,i){var r=i.SourceData,n=[];for(var s in t){var o=t[s],h=new Et;h.Date=e[s],a&&s<a.length&&(h.Time=a[s]),h.Value=o,n.push(h)}var l=r.GetMinuteFittingData(n),u=new Ot;u.Data=l;var C=u.GetValue();return C},this.FittingMultiPointLine=function(t,e){var a=e.Period,i=t.Data,r=[];if(Ot.IsDayPeriod(a,!0)){var n=i[0],s=e.ChartPaint[0].Data,o=s.Data[0],h=0,l=0;if(n.Date>o.Date){var u=0;for(h=0;h<s.Data.length;++h){var C=s.Data[h];if(C.Date==n.Date)break;if(C.Date>n.Date){h=u;break}u=h}}else for(l=0;l<i.length;++l){var D=i[l];if(D.Date>=o.Date)break}for(var f=null,c=h,d=l;c<s.Data.length&&d<i.length;){C=s.Data[c],D=i[d];D.Date<=C.Date?(r[c]||(r[c]=[]),r[c].push({Date:D.Date,Value:D.Value,Data:D.Data,KDate:C.Date,Type:1}),f=D,++d):(f&&!r[c]&&(r[c]={Date:f.Date,Value:f.Value,Type:0}),++c)}if(f)for(;c<s.Data.length;++c)r[c]||(r[c]={Date:f.Date,Value:f.Value,Type:0});return r}if(Ot.IsMinutePeriod(a,!0)){s=e.ChartPaint[0].Data;return r}}}function Pn(t,e,a){this.newMethod=wn,this.newMethod(t,null,e,null),delete this.newMethod,this.JsonData,a.JsonData&&(this.JsonData=a.JsonData),this.RequestData=function(t,e,a){if(!this.JsonData)return console.warn("[LocalJsonDataIndex::RequestData] JsonData is null"),void(param.HQChart.ScriptErrorCallback&&param.HQChart.ScriptErrorCallback("json æ°æ®ä¸è½ä¸ºç©º"));this.OutVar=this.FittingData(this.JsonData,a),this.BindData(t,e,a)},this.FittingData=function(t,e){for(i in outVar=t.OutVar,date=t.Date,time=t.Time,result=[],outVar)if(item=outVar[i],w.Complier.Log("[LocalJsonDataIndex::FittingData] item",item),0==item.Type||3==item.Type){var a=[];for(j in outVarItem={Name:item.Name,Type:item.Type},item.Data){var r=new Et;r.Date=date[j],time&&j<time.length&&(r.Time=time[j]),r.Value=item.Data[j],a.push(r)}if(e.Period<4)var n=e.GetFittingData(a);else n=e.GetMinuteFittingData(a);var s=new Ot;s.Data=n,outVarItem.Data=s.GetValue(),result.push(outVarItem)}else console.warn("[LocalJsonDataIndex::FittingData] can't support ",item.Name,item.Type);return result}}function bn(t){this.ID,this.Name,this.Script,this.Arguments=[],this.ClassName="ScriptIndexConsole",this.ErrorCallback,this.FinishCallback,this.IsSectionMode=!1,this.NetworkFilter,t&&(t.Name&&(this.Name=t.Name),t.Script&&(this.Script=t.Script),t.ID&&(this.ID=t.ID),t.Args&&(this.Arguments=t.Args),t.ErrorCallback&&(this.ErrorCallback=t.ErrorCallback),t.FinishCallback&&(this.FinishCallback=t.FinishCallback),t.IsSectionMode&&(this.IsSectionMode=t.IsSectionMode),t.NetworkFilter&&(this.NetworkFilter=t.NetworkFilter)),this.ExecuteScript=function(t){this.OutVar=[];var e={Self:this},a={HQDataType:t.HQDataType,Symbol:t.Stock.Symbol,Name:t.Stock.Name,Period:t.Period,Right:t.Right,Callback:this.RecvResultData,CallbackParam:e,Async:!0,MaxRequestDataCount:t.Request.MaxDataCount,MaxRequestMinuteDayCount:t.Request.MaxMinuteDayCount,Arguments:this.Arguments,IsSectionMode:this.IsSectionMode,ClassName:"ScriptIndexConsole",NetworkFilter:this.NetworkFilter};t.HQDataType===En.HISTORY_MINUTE_ID&&(a.TrateDate=t.Request.TradeDate),t.HQDataType==En.MULTIDAY_MINUTE_ID&&(a.DayCount=t.DayCount);var i=this.Script;Ln.Execute(i,a,this.ErrorCallback)},this.RecvResultData=function(t,e){var a=e.Self,i=e.JSExecute,r=null;i.SymbolData.Data&&(r=i.SymbolData.Data.GetDate());var n={Out:t,Date:r,Stock:{Name:i.SymbolData.Name,Symbol:i.SymbolData.Symbol},Index:{Name:a.Name,ID:a.ID}};(i.SymbolData.DataType==En.MULTIDAY_MINUTE_ID||i.SymbolData.DataType==En.MINUTE_ID||i.SymbolData.DataType==En.KLINE_ID&&Ot.IsMinutePeriod(i.SymbolData.Period,!0))&&(n.Time=i.SymbolData.Data.GetTime()),a.FinishCallback&&a.FinishCallback(n,e.JSExecute)}}function Bn(t){this.Url=t.Url,this.Job=t.Job,this.Symbol=t.Symbol,this.Args=t.Args,this.DataKey=t.DataKey,this.RecvCallback=t.Callback,this.ErrorCallback=t.ErrorCallback,this.Download=function(){var t=this,e=this.GetFieldList();if(!e)return message=this.Job.FunctionName+"("+this.Args[0]+") can't support.",this.ErrorCallback(message),void t.RecvCallback(null,t.Job,t.DataKey);O.HttpRequest({url:this.Url,data:{field:e,symbol:[this.Symbol],condition:[{item:["finance","doc","exists","true"]}],start:0,end:200},type:"post",dataType:"json",async:!0,success:function(e){var a=t.ToHQChartData(e);a&&a.sort((function(t,e){return t.Date-e.Date})),t.RecvCallback(a,t.Job,t.DataKey)}})},this.ToHQChartData=function(t){if(!t.stock||1!=t.stock.length)return null;var e=[],a=new I.default,i=t.stock[0];for(var r in i.stockday){var n=i.stockday[r];if(n.announcement1){var s=this.ToHQChartItemData(n.announcement1,n.finance1,n);s&&!a.has(s.Date)&&(e.push(s),a.add(s.Date))}if(n.announcement2){s=this.ToHQChartItemData(n.announcement2,n.finance2,n);s&&!a.has(s.Date)&&(e.push(s),a.add(s.Date))}if(n.announcement3){s=this.ToHQChartItemData(n.announcement3,n.finance3,n);s&&!a.has(s.Date)&&(e.push(s),a.add(s.Date))}if(n.announcement4){s=this.ToHQChartItemData(n.announcement4,n.finance4,n);s&&!a.has(s.Date)&&(e.push(s),a.add(s.Date))}}return e},this.ToHQChartItemData=function(t,e,a){var i=this.Args[0],r=1e4*t.year,n=t.quarter;switch(n){case 1:r+=331;break;case 2:r+=630;break;case 3:r+=930;break;case 4:r+=1231;break;default:return null}var s={Date:r,Value:0};switch(i){case 0:s.Value=r%1e6;break;case 1:s.Value=e.persearning;break;case 3:s.Value=e.peruprofit;break;case 4:s.Value=e.pernetasset;break;case 5:s.Value=e.percreserve;break;case 6:s.Value=e.woewa;break;case 7:s.Value=e.perccfo;break;case 8:s.Value=e.monetaryfunds;break;case 11:s.Value=e.areceivable;break}return s},this.GetFieldList=function(){var t=this.Args[0];switch(t){case 0:return["finance.date"];case 1:return["finance.persearning"];case 3:return["finance.peruprofit"];case 4:return["finance.pernetasset"];case 5:return["finance.percreserve"];case 6:return["finance.woewa"];case 7:return["finance.perccfo"];case 8:return["finance.monetaryfunds"];case 11:return["finance.areceivable"];default:return null}}}function Vn(t){this.newMethod=Bn,this.newMethod(t),delete this.newMethod,this.Download=function(){var t=this,e=this.GetFieldList();if(!e)return message=this.Job.FunctionName+"("+this.Args[0]+", "+this.Args[1]+", "+this.Args[2]+") can't support.",this.ErrorCallback(message),void t.RecvCallback(null,t.Job,t.DataKey);var a=[{item:["finance","doc","exists","true"]}],i=this.Args[1],r=this.Args[2],n=0,s=3,o=null;0==i&&0==r||(0==i&&r<300?(n=r,s=200):0==r&&i<1e3?o=i:i>1909&&(331==r?(a=[{item:["announcement1.year","int32","eq",i]},{item:["finance1","doc","exists","true"]}],e.push("announcement1.year"),e.push("announcement1.quarter")):630==r?(a=[{item:["announcement2.year","int32","eq",i]},{item:["finance2","doc","exists","true"]}],e.push("announcement2.year"),e.push("announcement2.quarter")):930==r?(a=[{item:["announcement3.year","int32","eq",i]},{item:["finance3","doc","exists","true"]}],e.push("announcement4.year"),e.push("announcement4.quarter")):(a=[{item:["announcement4.year","int32","eq",i]},{item:["finance4","doc","exists","true"]}],e.push("announcement4.year"),e.push("announcement4.quarter")))),O.HttpRequest({url:this.Url,data:{field:e,symbol:[this.Symbol],condition:a,start:0,end:s},type:"post",dataType:"json",async:!0,success:function(e){var a=t.ToHQChartData(e),i=null;a&&a.length>0&&(a.sort((function(t,e){return e.Date-t.Date})),i=null==o?a[n]:t.GetPreYearData(a,o)),t.RecvCallback(i,t.Job,t.DataKey)}})},this.GetPreYearData=function(t,e){if(331!=e&&630!=e&&930!=e&&1231!=e){for(var a=t[0].Date%1e3,i=(r=1,0);r<t.length;++r){n=t[r];if(n.Date%1e4==a&&(++i,i==e))return n}return null}for(var r in t){var n=t[r];if(n.Date%1e4==e)return n}}}function Gn(t){this.Url=t.Url,this.RealtimeUrl=t.RealtimeUrl,this.Job=t.Job,this.Symbol=t.Symbol,this.Args=t.Args,this.DataKey=t.DataKey,this.RecvCallback=t.Callback,this.ErrorCallback=t.ErrorCallback,this.Download=function(){var t=this.Args[0];switch(t){case 1:case 7:case"EXCHANGE":this.DownloadHistoryData(t);break;case 3:this.GetSymbolType(t);break;case 9:case 18:case 30:case 32:case 33:case 34:case 38:case 40:case 41:case 42:case 43:case"CAPITAL":case"TOTALCAPITAL":case 100:this.DownloadRealtimeData(t);break;default:this.DownloadRealtimeData(t);break}},this.GetSymbolType=function(t){var e=1;Br.IsSHSZIndex(this.Symbol)&&(e=0);var a={Date:null,Value:e};this.RecvCallback(a,this.Job,this.DataKey)},this.DownloadRealtimeData=function(t){var e=this,a=this.GetFieldList();if(!a)return this.Job.FunctionName2?message=this.Job.FunctionName2+" can't support.":this.Job.FunctionName?message=this.Job.FunctionName+"("+this.Args[0]+") can't support.":message=this.Args[0]+" can't support.",this.ErrorCallback(message),void e.RecvCallback(null,e.Job,e.DataKey);O.HttpRequest({url:this.RealtimeUrl,data:{field:a,symbol:[this.Symbol],condition:[],start:0,end:10},type:"post",dataType:"json",async:!0,success:function(t){var a=e.RealtimeDataToHQChartData(t);e.RecvCallback(a,e.Job,e.DataKey)}})},this.DownloadHistoryData=function(t){var e=this,a=this.GetFieldList();if(!a)return message=this.Job.FunctionName+"("+this.Args[0]+") can't support.",this.ErrorCallback(message),void e.RecvCallback(null,e.Job,e.DataKey);O.HttpRequest({url:this.Url,data:{field:a,symbol:[this.Symbol],condition:[],start:0,end:200},type:"post",dataType:"json",async:!0,success:function(t){var a=e.ToHQChartData(t);a&&a.sort((function(t,e){return t.Date-e.Date})),e.RecvCallback(a,e.Job,e.DataKey)}})},this.GetFieldList=function(){var t=this.Args[0];switch(t){case 1:return["capital.total","capital.date"];case 7:return["capital.a","capital.date"];case"EXCHANGE":return["capital.a","capital.date"];case 9:return["finance.peruprofit","symbol","date"];case 18:return["finance.percreserve","symbol","date"];case 30:return["finance.nprofit","symbol","date"];case 32:return["finance.peruprofit","symbol","date"];case 33:return["finance.persearning","symbol","date"];case 34:return["finance.pernetasset","symbol","date"];case 38:return["finance.persearning","symbol","date"];case 40:return["capital.a","capital.date","symbol","date","price"];case 41:return["capital.total","capital.date","symbol","date","price"];case"CAPITAL":return["capital.a","capital.date","symbol","date"];case"TOTALCAPITAL":return["capital.total","capital.date","symbol","date"];case 42:return["company.releasedate","symbol","date"];case 43:return["dividendyield","symbol","date"];case 100:return["shareholder","symbol","date"];default:return null}},this.RealtimeDataToHQChartData=function(t,e){if(!t.stock||1!=t.stock.length)return null;var a=t.stock[0],i=(e=this.Args[0],a.date);switch(e){case 9:return a.finance?{Date:i,Value:a.finance.peruprofit}:null;case 18:return a.finance?{Date:i,Value:a.finance.percreserve}:null;case 30:return a.finance?{Date:i,Value:a.finance.nprofit}:null;case 32:return a.finance?{Date:i,Value:a.finance.peruprofit}:null;case 33:return a.finance?{Date:i,Value:a.finance.persearning}:null;case 34:return a.finance?{Date:i,Value:a.finance.pernetasset}:null;case 38:return a.finance?{Date:i,Value:a.finance.persearning}:null;case 40:return a.capital?{Date:i,Value:a.capital.a*a.price}:null;case 41:return a.capital?{Date:i,Value:a.capital.total*a.price}:null;case 42:if(!a.company)return null;var r=a.company.releasedate,n=parseInt(r/1e4),s=parseInt(r%1e4/100),o=r%100,h=new Date(n,s-1,o),l=new Date,u=parseInt((l.getTime()-h.getTime())/864e5);return{Date:i,Value:u+1};case 43:return a.dividendyield?{Date:i,Value:a.dividendyield.quarter4}:null;case 100:return a.shareholder?{Date:i,Value:a.shareholder.count}:null;case"CAPITAL":return a.capital?{Date:i,Value:a.capital.a/100}:null;case"TOTALCAPITAL":return a.capital?{Date:i,Value:a.capital.total/100}:null}},this.ToHQChartData=function(t){if(!t.stock||1!=t.stock.length)return null;var e=[],a=new I.default,i=t.stock[0],r=this.Args[0];for(var n in i.stockday){var s=i.stockday[n],o=this.ToHQChartItemData(s,r);o&&!a.has(o.Date)&&(e.push(o),a.add(o.Date))}return e},this.ToHQChartItemData=function(t,e){if(!t)return null;var a=t.date;switch(e){case 1:return t.capital?{Date:a,Value:t.capital.total}:null;case 7:case"EXCHANGE":return t.capital?{Date:a,Value:t.capital.a}:null;default:return null}}}function Hn(t){this.Url=t.Url,this.RealtimeUrl=t.RealtimeUrl,this.Job=t.Job,this.Symbol=t.Symbol,this.Args=t.Args,this.DataKey=t.DataKey,this.RecvCallback=t.Callback,this.ErrorCallback=t.ErrorCallback,this.Download=function(){var t=this,e=this.GetFieldList();if(!e)return message=this.Job.FunctionName+"("+this.Args[0]+", "+this.Args[1]+", "+this.Args[2]+") can't support.",this.ErrorCallback(message),void t.RecvCallback(null,t.Job,t.DataKey,!0);O.HttpRequest({url:this.Url,data:{field:e,symbol:[this.Symbol],orderfield:"date",order:-1,start:0,end:5},type:"post",dataType:"json",async:!0,success:function(e){var a=t.ToHQChartData(e);a&&a.length>0&&a.sort((function(t,e){return t.Date-e.Date})),t.RecvCallback(a,t.Job,t.DataKey)}})},this.GetFieldList=function(){var t=this.Args[0];switch(t){case 1:return["shareholder","date","symbol"];case 2:return["tradedetail.buy","tradedetail.sell","date","symbol"];case 3:return["margin","date","symbol"];case 4:return["blocktrading.amount","blocktrading.price","date","symbol"];default:return null}},this.ToHQChartData=function(t){if(!t.stock||1!=t.stock.length)return null;var e=[],a=new I.default,i=t.stock[0],r=this.Args[0],n=this.Args[1];for(var s in i.stockday){var o=i.stockday[s],h=this.ToHQChartItemData(o,r,n);h&&!a.has(h.Date)&&(e.push(h),a.add(h.Date))}return e},this.ToHQChartItemData=function(t,e,a){if(!t)return null;var i=t.date;switch(e){case 1:return t.shareholder?{Date:i,Value:t.shareholder.count}:null;case 2:return!t.tradedetail&&t.tradedetail[0]?null:0==a?{Date:i,Value:t.tradedetail[0].buy}:{Date:i,Value:t.tradedetail[0].sell};case 3:if(!t.margin)return null;if(0==a){if(t.margin.buy)return{Date:i,Value:t.margin.buy.balance}}else if(t.margin.sell)return{Date:i,Value:t.margin.sell.balance};return null;case 4:return t.blocktrading?0==a?{Date:i,Value:t.blocktrading.price}:{Date:i,Value:t.blocktrading.amount}:null;default:return null}}}function Yn(t){this.Url=t.Url,this.Job=t.Job,this.Symbol=t.Symbol,this.Args=t.Args,this.DataKey=t.DataKey,this.RecvCallback=t.Callback,this.ErrorCallback=t.ErrorCallback,this.Download=function(){var t=this,e=this.GetQueryCondtion();if(!e)return message=this.Job.FunctionName+"("+this.Args[0]+", "+this.Args[1]+", "+this.Args[2]+") can't support.",this.ErrorCallback(message),void t.RecvCallback(null,t.Job,t.DataKey,!0);O.HttpRequest({url:this.Url,data:{field:e.Field,symbol:e.Symbol,condition:e.Cond,start:0,end:2e3},type:"post",dataType:"json",async:!0,success:function(e){var a=t.ToHQChartData(e);a&&a.sort((function(t,e){return t.Date-e.Date})),t.RecvCallback(a,t.Job,t.DataKey)}})},this.GetQueryCondtion=function(){var t=new Date,e=1e4*t.getFullYear()+100*(t.getMonth()+1)+t.getDate();t.setDate(t.getDate()-100);var a=1e4*t.getFullYear()+100*(t.getMonth()+1)+t.getDate(),i=this.Args[0];switch(i){case 1:var r={Symbol:["CNA.ci"],Field:["margin"],Cond:[{item:["date","int32","gte",a.toString(),"lte",e.toString()]},{item:["margin","doc","exists","true"]}]};return r}},this.ToHQChartData=function(t){if(!t.stock||1!=t.stock.length)return null;var e=[],a=new I.default,i=t.stock[0],r=this.Args[0],n=this.Args[1];for(var s in i.stockday){var o=i.stockday[s],h=this.ToHQChartItemData(o,r,n);h&&!a.has(h.Date)&&(e.push(h),a.add(h.Date))}return e},this.ToHQChartItemData=function(t,e,a){if(!t)return null;var i=t.date,r=null;switch(e){case 1:return t.margin?(r=t.margin,1==a?r.buy&&ha.IsNumber(r.buy.balance)?{Date:i,Value:r.buy.balance}:null:ha.IsNumber(r.sell.balance)?{Date:i,Value:r.sell.balance}:null):null;default:return null}}}function kn(t){this.Url=t.Url,this.RealtimeUrl=t.RealtimeUrl,this.Job=t.Job,this.Symbol=t.Symbol,this.Args=t.Args,this.DataKey=t.DataKey,this.RecvCallback=t.Callback,this.ErrorCallback=t.ErrorCallback,this.Download=function(){var t=this.Args[0];switch(t){case"HYBLOCK":case"DYBLOCK":case"GNBLOCK":this.DownloadGroupName(t);break}},this.DownloadGroupName=function(t){var e=this,a=["name","symbol"];"HYBLOCK"==t?a.push("industry"):"DYBLOCK"==t?a.push("region"):"GNBLOCK"==t&&a.push("concept"),O.HttpRequest({url:e.RealtimeUrl,data:{field:a,symbol:[this.Symbol]},type:"post",dataType:"json",async:!0,success:function(t){var a=e.RecvGroupName(t);e.RecvCallback(a,e.Job,e.DataKey,1)},error:function(t){e.ErrorCallback(t)}})},this.RecvGroupName=function(t){if(!t.stock||1!=t.stock.length)return null;var e=t.stock[0],a=this.Args[0],i=null;if("HYBLOCK"==a){var r=e.industry;if(!r)return null;for(var n in r){var s=r[n];i=s.name}}else if("DYBLOCK"==a){var o=e.region;if(!o)return null;for(var n in o){s=o[n];i=s.name}}else if("GNBLOCK"==a){var h=e.concept;if(!h)return null;for(var n in i="",h){s=h[n];i.length>0&&(i+=" "),i+=s.name}}return{Value:i}}}function _n(){var t={BGColor:"rgb(0,0,0)",TooltipBGColor:"rgb(255, 255, 255)",TooltipAlpha:.92,SelectRectBGColor:"rgba(1,130,212,0.06)",UpBarColor:"rgb(238,21,21)",DownBarColor:"rgb(25,158,0)",UnchagneBarColor:"rgb(228,228,228)",EmptyBarBGColor:"rgb(0,0,0)",Minute:{VolBarColor:null,PriceColor:"rgb(25,180,231)",AreaPriceColor:"rgba(63,158,255,.3)",AvPriceColor:"rgb(255,236,0)",PositionColor:"rgb(218,165,32)",VolTitleColor:"rgb(190,190,190)",Before:{BGColor:"rgba(105,105,105,0.5)",AvPriceColor:"rgb(248,248,255)",CloseIcon:{MoveOnColor:"rgb(255,255,255)",Color:"rgb(156,156,156)"}},After:{BGColor:"rgba(105,105,105,0.5)",AvPriceColor:"rgb(248,248,255)"}},DefaultTextColor:"rgb(101,104,112)",DefaultTextFont:14*U()+"px å¾®è½¯éé»",TitleFont:13*U()+"px å¾®è½¯éé»",IndexTitleColor:"rgb(101,104,112)",UpTextColor:"rgb(238,21,21)",DownTextColor:"rgb(25,158,0)",UnchagneTextColor:"rgb(101,104,112)",CloseLineColor:"rgb(178,34,34)",Title:{TradeIndexColor:"rgb(105,105,105)",ColorIndexColor:"rgb(112,128,144)",VolColor:"rgb(101,104,112)",AmountColor:"rgb(101,104,112)",DateTimeColor:"rgb(101,104,112)",SettingColor:"rgb(101,104,112)",NameColor:"rgb(101,104,112)",TurnoverRateColor:"rgb(101,104,112)",PositionColor:"rgb(101,104,112)"},FrameBorderPen:"rgba(236,236,236,0.13)",MultiDayBorderPen:"rgba(236,236,236,0.5)",FrameSplitPen:"rgba(236,236,236,0.13)",FrameSplitTextColor:"rgb(101,104,112)",FrameSplitTextFont:12*U()+"px å¾®è½¯éé»",FrameTitleBGColor:"rgb(0,0,0)",OverlayIndexTitleBGColor:"rgba(0,0,0,0.7)",Frame:{XBottomOffset:1*U(),PercentageText:{PriceColor:"rgb(101,104,112)",PercentageColor:"rgb(101,104,112)",SplitColor:"rgb(101,104,112)",Font:14*U()+"px å¾®è½¯éé»"}},FrameLatestPrice:{TextColor:"rgb(255,255,255)",UpBarColor:"rgb(238,21,21)",DownBarColor:"rgb(25,158,0)",UnchagneBarColor:"rgb(190,190,190)",BGAlpha:.6},CorssCursorBGColor:"rgb(43,54,69)",CorssCursorTextColor:"rgb(255,255,255)",CorssCursorTextFont:12*U()+"px å¾®è½¯éé»",CorssCursorHPenColor:"rgb(130,130,130)",CorssCursorVPenColor:"rgb(130,130,130)",CorssCursor:{RightButton:{BGColor:"rgb(43,54,69)",PenColor:"rgb(255,255,255)",Icon:{Text:"î£",Color:"rgb(255,255,255)",Family:"iconfont",Size:18}}},OrderFlow:{UpColor:{BG:"rgb(223,191,180)",Border:"rgb(196,84,86)"},DownColor:{BG:"rgb(176,212,184)",Border:"rgb(66,94,74)"},UnchagneColor:{BG:"rgb(216,221,177)",Border:"rgb(209,172,129)"},Text:{Color:"rgb(248,248,255)",Family:"Arial",FontMaxSize:16,MaxValue:"8888"},Line:{UpDownColor:"rgb(220,220,220)",MiddleColor:"rgb(211,211,211)"}},KLine:{MaxMin:{Font:12*U()+"px å¾®è½¯éé»",Color:"rgb(255,250,240)",RightArrow:"â",LeftArrow:"â",HighYOffset:0,LowYOffset:0},Info:{Investor:{ApiUrl:"/API/NewsInteract",IconFont:{Family:"iconfont",Text:"î±",HScreenText:"î",Color:"#1c65db"}},Announcement:{ApiUrl:"/API/ReportList",IconFont:{Family:"iconfont",Text:"î³",HScreenText:"î",Color:"#f5a521"},IconFont2:{Family:"iconfont",Text:"î´",HScreenText:"î",Color:"#ed7520"}},Pforecast:{ApiUrl:"/API/StockHistoryDay",IconFont:{Family:"iconfont",Text:"î®",HScreenText:"î",Color:"#986cad"}},Research:{ApiUrl:"/API/InvestorRelationsList",IconFont:{Family:"iconfont",Text:"î²",HScreenText:"î",Color:"#19b1b7"}},BlockTrading:{ApiUrl:"/API/StockHistoryDay",IconFont:{Family:"iconfont",Text:"î°",HScreenText:"î",Color:"#f39f7c"}},TradeDetail:{ApiUrl:"/API/StockHistoryDay",IconFont:{Family:"iconfont",Text:"î¯",HScreenText:"î",Color:"#b22626"}}},NumIcon:{Color:"rgb(251,80,80)",Family:"iconfont",Text:["î","î»","î","î½","î¿","î","î","î","î","î","î¶","îµ","î·","î¸","î¹","îº","î¼","î¾","î","î","î"]},TradeIcon:{Family:"iconfont",Buy:{Color:"rgb(255,15,4)",Text:"î",HScreenText:"î"},Sell:{Color:"rgb(64,122,22)",Text:"î",HScreenText:"î"}}},Index:{LineColor:["rgb(255,189,09)","rgb(22,198,255)","rgb(174,35,161)","rgb(236,105,65)","rgb(68,114,196)","rgb(229,0,79)","rgb(0,128,255)","rgb(252,96,154)","rgb(42,230,215)","rgb(24,71,178)"],NotSupport:{Font:"14px å¾®è½¯éé»",TextColor:"rgb(52,52,52)"}},ColorArray:["rgb(255,174,0)","rgb(25,199,255)","rgb(175,95,162)","rgb(236,105,65)","rgb(68,114,196)","rgb(229,0,79)","rgb(0,128,255)","rgb(252,96,154)","rgb(42,230,215)","rgb(24,71,178)"],Buttons:{CloseOverlayIndex:{MoveOnColor:"rgb(255,255,255)",Color:"rgb(156,156,156)"},CloseWindow:{MoveOnColor:"rgb(255,255,255)",Color:"rgb(156,156,156)"},ChangeIndex:{MoveOnColor:"rgb(255,255,255)",Color:"rgb(156,156,156)"},OverlayIndex:{MoveOnColor:"rgb(255,255,255)",Color:"rgb(156,156,156)"},ModifyIndexParam:{MoveOnColor:"rgb(255,255,255)",Color:"rgb(156,156,156)"}},DrawPicture:{LineColor:["rgb(255,255,0)"],PointColor:["rgb(228,228,228)","rgb(192,192,192)"]},TooltipPaint:{BGColor:"rgba(20,20,20,0.8)",BorderColor:"rgb(210,210,210)",TitleColor:"rgb(210,210,210)",TitleFont:13*U()+"px å¾®è½¯éé»",DateTimeColor:"rgb(210,210,210)",VolColor:"rgb(210,210,210)",AmountColor:"rgb(210,210,210)"},MinuteInfo:{TextColor:"rgb(84,143,255)",Font:14*U()+"px å¾®è½¯éé»",PointColor:"rgb(38,113,254)",LineColor:"rgb(120,167,255)",TextBGColor:"rgba(255,255,255,1)"},DepthMapPaint:{LineColor:"rgba(255,185,15)",AreaColor:"rgba(255,185,15,0.8)",TextColor:"rgba(255,255,255)",TextBGColor:"rgb(43,54,69)"},StockChip:{InfoColor:"rgb(255,255,255)",DayInfoColor:"rgb(0,0,0)"},DepthChart:{BidColor:{Line:"rgb(82,176,123)",Area:"rgba(82,176,123,0.5)"},AskColor:{Line:"rgb(207,76,89)",Area:"rgba(207,76,89, 0.5)"},LineWidth:4},DepthCorss:{BidColor:{Line:"rgb(82,176,123)"},AskColor:{Line:"rgb(207,76,89)"},LineWidth:2,LineDash:[3,3],Tooltip:{BGColor:"rgba(54,54,54, 0.8)",TextColor:"rgb(203,215,224)",Border:{Top:5,Left:20,Bottom:5,Center:5},Font:14*U()+"px å¾®è½¯éé»",LineHeight:16}},ChartDrawVolProfile:{BGColor:"rgba(244,250,254,0.3)",BorderColor:"rgba(255,255,255)",VolLineColor:"rgb(232,5,9)",UpVolColor:"rgba(103,179,238, 0.24)",DownVolColor:"rgba(237,208,105,0.24)",AreaUpColor:"rgb(103,179,238,0.7)",AreaDonwColor:"rgba(237,208,105,0.7)",Text:{Color:"rgb(0,0,0)",Family:"Arial",FontMaxSize:18,FontMinSize:6}},RectSelect:{LineColor:"rgb(115,83,64)",LineWidth:1*U(),LineDotted:[3,3],AreaColor:"rgba(26,13,7,0.5)"},SelectedChart:{LineWidth:1,LineColor:"rgb(55,100,100)",Radius:4,MinSpace:200,BGColor:"rgb(255,255,255)"},DragMovePaint:{TextColor:"rgb(255,255,255)"},DealList:{BorderColor:"rgb(38,38,41)",Header:{Color:"RGB(245,245,245)",Mergin:{Left:5,Right:5,Top:4,Bottom:2},Font:{Size:12,Name:"å¾®è½¯éé»"}},Row:{Mergin:{Top:2,Bottom:2},Font:{Size:15,Name:"å¾®è½¯éé»"},BarMergin:{Top:2,Left:3,Right:3,Bottom:2}},FieldColor:{Vol:"rgb(192,192,0)",Time:"rgb(245,245,245)",Deal:"rgb(111,128,112)",Index:"rgb(245,245,245)",BarTitle:"rgb(245,245,245)",Text:"rgb(245,245,245)"},UpTextColor:"rgb(238,21,21)",DownTextColor:"rgb(25,158,0)",UnchagneTextColor:"rgb(228,228,228)"},Report:{BorderColor:"rgb(38,38,41)",SelectedColor:"rgb(49,48,56)",Header:{Color:"RGB(245,245,245)",SortColor:"rgb(255,0,0)",Mergin:{Left:5,Right:5,Top:4,Bottom:2},Font:{Size:12,Name:"å¾®è½¯éé»"}},Item:{Mergin:{Top:2,Bottom:0,Left:5,Right:5},Font:{Size:15,Name:"å¾®è½¯éé»"},BarMergin:{Top:2,Left:3,Right:3,Bottom:2},NameFont:{Size:14,Name:"å¾®è½¯éé»"},SymbolFont:{Size:12,Name:"å¾®è½¯éé»"}},FixedItem:{Font:{Size:15,Name:"å¾®è½¯éé»"}},LimitBorder:{Color:"rgb(64,64,64)",Mergin:{Top:1,Bottom:1,Left:0,Right:0}},FieldColor:{Index:"rgb(245,245,245)",Symbol:"rgb(255,255,255)",Name:"rgb(255,255,255)",Amount:"rgb(2,226,244)",Vol:"rgb(192,192,0)",BarTitle:"rgb(245,245,245)",Text:"rgb(245,245,245)"},UpTextColor:"rgb(238,21,21)",DownTextColor:"rgb(25,158,0)",UnchagneTextColor:"rgb(228,228,228)",Tab:{Font:{Size:12,Name:"å¾®è½¯éé»"},ScrollBarWidth:100,ButtonColor:"rgb(13,12,15)",BarColor:"rgb(48,48,48)",BorderColor:"rgb(48,48,48)",TabTitleColor:"rgb(153,153,153)",TabSelectedTitleColor:"rgb(255,255,255)",TabSelectedBGColor:"rgb(13,12,15)",TabMoveOnTitleColor:"rgb(255,255,255)",TabBGColor:"rgb(28,28,31)"},PageInfo:{Font:{Size:15,Name:"å¾®è½¯éé»"},TextColor:"rgb(255,255,255)",BGColor:"rgba(49,48,56,0.8)",Mergin:{Left:5,Right:5,Top:4,Bottom:2}},DragRow:{Color:"rgba(255,250, 250,0.8)",TextColor:"rgba(0,0, 0, 0.8)",MoveRowColor:"rgb(135,206,250)",SrcRowColor:"rgb(49,48,56)"}}};return t}bn.SetDomain=function(t,e){Ln.SetDomain(t,e)};var Xn={BLACK_ID:1,WHITE_ID:0};function Wn(){}function Un(t){this.DivElement=t,this.JSChartContainer,this.CanvasElement=document.createElement("canvas"),this.CanvasElement.className="jsdeallist-drawing",this.CanvasElement.id=q(),this.CanvasElement.setAttribute("tabindex",0),this.CanvasElement.style&&(this.CanvasElement.style.outline="none"),t.hasChildNodes()&&w.Chart.Log("[JSDealChart::JSDealList] divElement hasChildNodes",t.childNodes),t.appendChild(this.CanvasElement),this.OnSize=function(){var t=parseInt(this.DivElement.style.height.replace("px",""));this.CanvasElement.height=t,this.CanvasElement.width=parseInt(this.DivElement.style.width.replace("px","")),this.CanvasElement.style.width=this.CanvasElement.width+"px",this.CanvasElement.style.height=this.CanvasElement.height+"px";var e=U();this.CanvasElement.height*=e,this.CanvasElement.width*=e,w.Chart.Log("[JSDealChart::OnSize] devicePixelRatio="+window.devicePixelRatio+", height="+this.CanvasElement.height+", width="+this.CanvasElement.width),this.JSChartContainer&&this.JSChartContainer.OnSize&&this.JSChartContainer.OnSize()},this.SetOption=function(t){var e=this.CreateJSDealChartContainer(t);if(!e)return!1;t.OnCreatedCallback&&t.OnCreatedCallback(e),this.JSChartContainer=e,this.DivElement.JSChart=this,t.Symbol?e.ChangeSymbol(t.Symbol):e.Draw()},this.CreateJSDealChartContainer=function(t){var e=new Kn(this.CanvasElement);if(e.Create(t),t.NetworkFilter&&(e.NetworkFilter=t.NetworkFilter),ha.IsNonEmptyArray(t.Column)&&e.SetColumn(t.Column),this.SetChartBorder(e,t),null!=t.IsAutoUpdate&&(e.IsAutoUpdate=t.IsAutoUpdate),t.AutoUpdateFrequency>0&&(e.AutoUpdateFrequency=t.AutoUpdateFrequency),ha.IsBool(t.EnableFilter)&&(e.EnableFilter=t.EnableFilter),t.EventCallback)for(var a=0;a<t.EventCallback.length;++a){var i=t.EventCallback[a];e.AddEventCallback(i)}return e},this.SetChartBorder=function(t,e){if(e.Border){e.Border;ha.IsNumber(e.Border.Left)&&(t.Frame.ChartBorder.Left=e.Border.Left),ha.IsNumber(e.Border.Right)&&(t.Frame.ChartBorder.Right=e.Border.Right),ha.IsNumber(e.Border.Top)&&(t.Frame.ChartBorder.Top=e.Border.Top),ha.IsNumber(e.Border.Bottom)&&(t.Frame.ChartBorder.Bottom=e.Border.Bottom);var a=U();t.Frame.ChartBorder.Left*=a,t.Frame.ChartBorder.Right*=a,t.Frame.ChartBorder.Top*=a,t.Frame.ChartBorder.Bottom*=a}},this.ChangeSymbol=function(t,e){this.JSChartContainer&&this.JSChartContainer.ChangeSymbol(t,e)},this.SetColumn=function(t,e){this.JSChartContainer&&this.JSChartContainer.SetColumn(t,e)},this.EnableFilter=function(t,e){this.JSChartContainer&&this.JSChartContainer.EnableFilter(t,e)},this.AddEventCallback=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddEventCallback&&(w.Chart.Log("[JSDealChart:AddEventCallback] obj=",t),this.JSChartContainer.AddEventCallback(t))},this.ReloadResource=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ReloadResource&&(w.Chart.Log("[JSDealChart:ReloadResource] "),this.JSChartContainer.ReloadResource(t))}}function Kn(t){this.ClassName="JSDealChartContainer",this.Frame,this.ChartPaint=[],this.ChartSplashPaint=null,this.LoadDataSplashTitle="æ°æ®å è½½ä¸­",this.Canvas=t.getContext("2d"),this.ShowCanvas=null,this.Symbol,this.Name,this.TradeDate,this.NetworkFilter,this.Data={DataOffset:0,Data:[]},this.SourceData={DataOffset:0,Data:[]},this.IsShowLastPage=!0,this.mapEvent=new E.default,this.AutoUpdateTimer=null,this.AutoUpdateFrequency=15e3,this.LoadDataSplashTitle="æ°æ®å è½½ä¸­",this.UIElement=t,this.LastPoint=new at,this.IsDestroy=!1,this.ChartDestory=function(){this.IsDestroy=!0,this.StopAutoUpdate()},this.EnableFilterData=!1,this.FilterData=function(t){if(!this.EnableFilterData)return t;var e=this.GetEventCallback(G.ON_FILTER_DEAL_DATA);if(!e||!e.Callback)return t;var a={Data:t,Result:[]};return e.Callback(e,a,this),a.Result},this.EnableFilter=function(t,e){this.EnableFilterData=t,this.Data.Data=this.FilterData(this.SourceData.Data),this.Data.DataOffset=0,e&&(1==e.GotoLastPage&&this.GotoLastPage(),1==e.Redraw&&this.Draw())},this.CloneArray=function(t){var e=[];if(!ha.IsNonEmptyArray(t))return e;for(var a=0;a<t.length;++a)e.push(t[a]);return e},this.Create=function(t){var e=this;this.UIElement.JSChartContainer=this,this.ChartSplashPaint=new Ia,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.Frame=new Jn,this.Frame.ChartBorder=new nt,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartSplashPaint.Frame=this.Frame;var a=new qn;a.Frame=this.Frame,a.ChartBorder=this.Frame.ChartBorder,a.Canvas=this.Canvas,a.GetEventCallback=function(t){return e.GetEventCallback(t)},this.ChartPaint[0]=a,t&&(ha.IsBool(t.IsSingleTable)&&(a.IsSingleTable=t.IsSingleTable),ha.IsBool(t.IsShowHeader)&&(a.IsShowHeader=t.IsShowHeader),ha.IsBool(t.IsShowLastPage)&&(this.IsShowLastPage=t.IsShowLastPage),ha.IsNumber(t.BorderLine)&&(this.Frame.BorderLine=t.BorderLine));var i=!0,r=!0;t&&(!1===t.KeyDown&&(i=!1,w.Chart.Log("[JSDealChartContainer::Create] not register keydown event.")),!1===t.Wheel&&(r=!1,w.Chart.Log("[JSDealChartContainer::Create] not register wheel event."))),i&&this.UIElement.addEventListener("keydown",(function(t){e.OnKeyDown(t)}),!0),r&&this.UIElement.addEventListener("wheel",(function(t){e.OnWheel(t)}),!0)},this.Draw=function(){if(!(this.UIElement.width<=0||this.UIElement.height<=0)){this.Canvas.clearRect(0,0,this.UIElement.width,this.UIElement.height);var t=U();if(this.Canvas.lineWidth=t,this.ChartSplashPaint&&this.ChartSplashPaint.IsEnableSplash)return this.Frame.Draw({IsEnableSplash:this.ChartSplashPaint.IsEnableSplash}),void this.ChartSplashPaint.Draw();this.Frame.Draw(),this.Frame.DrawLogo();for(var e=0;e<this.ChartPaint.length;++e){var a=this.ChartPaint[e];a.IsDrawFirst&&a.Draw()}for(e=0;e<this.ChartPaint.length;++e){a=this.ChartPaint[e];a.IsDrawFirst||a.Draw()}}},this.ChangeSymbol=function(t,e){this.Symbol=t,this.Data=null,this.SourceData=null;var a=this.ChartPaint[0];a&&(a.Data=null),e&&ha.IsNumber(e.TradeDate)&&(this.TradeDate=e.TradeDate),this.Symbol?this.RequestDealData():this.Draw()},this.CancelAutoUpdate=function(){"number"==typeof this.AutoUpdateTimer&&(clearTimeout(this.AutoUpdateTimer),this.AutoUpdateTimer=null)},this.AutoUpdateEvent=function(t,e){var a=t?G.RECV_START_AUTOUPDATE:G.RECV_STOP_AUTOUPDATE;if(this.mapEvent.has(a)){var i=this,r=this.mapEvent.get(a),n={Stock:{Symbol:this.Symbol,Name:this.Name,DayCount:this.DayCount},Explain:e};t&&(n.Callback=function(t){i.RecvDealUpdateData(t)}),r.Callback(r,n,this)}},this.RequestDealData=function(){this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.EnableSplash(!0),this.Draw();var t=this;if(this.NetworkFilter){var e={Name:"JSDealChartContainer::RequestDealData",Explain:"æäº¤æç»",Request:{Data:{symbol:t.Symbol,tradeDate:t.TradeDate}},Self:this,PreventDefault:!1};if(this.NetworkFilter(e,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvDealData(e),t.AutoUpdateEvent(!0,"JSDealChartContainer::RequestDealData"),t.AutoUpdate()})),1==e.PreventDefault)return}var a=Oi.CacheDomain+"/cache/dealday/today/"+this.Symbol+".json";O.HttpRequest({url:a,type:"get",dataType:"json",async:!0,success:function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvDealData(e),t.AutoUpdate(1)},error:function(e,a){t.ChartSplashPaint.EnableSplash(!1),t.AutoUpdate()}})},this.RecvDealData=function(t){var e=Kn.JsonDataToDealData(t);this.SourceData={DataOffset:0,Data:e},this.Data={DataOffset:0,Data:this.FilterData(this.CloneArray(e))},this.Symbol=t.symbol,this.Name=t.name;var a=this.ChartPaint[0];if(a.Data=this.Data,a.Symbol=this.Symbol,a.YClose=t.yclose,a.Open=t.open,this.IsShowLastPage){var i=a.GetPageSize(!0),r=e.length-i;r<0&&(r=0),this.Data.DataOffset=r}this.Draw()},this.RequestDealUpdateData=function(){var t=this;if(this.NetworkFilter){var e={Name:"JSDealChartContainer::RequestDealUpdateData",Explain:"å¢éæäº¤æç»",Request:{Data:{symbol:t.Symbol}},Self:this,PreventDefault:!1};if(this.Data&&ha.IsNonEmptyArray(this.Data.Data)){var a=this.Data.Data[this.Data.Data.length-1];e.LastItem=a}if(this.NetworkFilter(e,(function(e){t.RecvDealUpdateData(e),t.AutoUpdate()})),1==e.PreventDefault)return}},this.RecvDealUpdateData=function(t){var e=Kn.JsonDataToDealData(t);ha.IsNonEmptyArray(e)&&(1===t.UpdateType?(this.SourceData.Data=e,this.Data.Data=this.FilterData(this.CloneArray(e)),this.Data.DataOffset>=this.Data.Data.length&&(this.Data.DataOffset=0)):(this.AddDealData(this.SourceData,e),this.AddDealData(this.Data,this.FilterData(e))),this.Draw())},this.AddDealData=function(t,e){if(t.Data){var a=0,i=this.ChartPaint[0];i&&(a=i.GetPageSize());for(var r=0;r<e.length;++r)t.Data.push(e[r]),t.DataOffset+a<t.Data.length&&++t.DataOffset}else t.Data=e},this.AutoUpdate=function(t){if(this.CancelAutoUpdate(),this.IsAutoUpdate&&this.Symbol){var e=this,a=Br.GetMarketStatus(this.Symbol);if(0!=a&&3!=a){var i=this.AutoUpdateFrequency;1==a?this.AutoUpdateTimer=setTimeout((function(){e.AutoUpdate()}),i):2==a&&(this.AutoUpdateTimer=setTimeout((function(){e.RequestDealUpdateData()}),i))}}},this.StopAutoUpdate=function(){this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"JSDealChartContainer::StopAutoUpdate"),this.IsAutoUpdate&&(this.IsAutoUpdate=!1)},this.AddEventCallback=function(t){if(t&&t.event&&t.callback){var e={Callback:t.callback,Source:t};this.mapEvent.set(t.event,e)}},this.RemoveEventCallback=function(t){this.mapEvent.has(t)&&this.mapEvent.delete(t)},this.GetEventCallback=function(t){if(!this.mapEvent.has(t))return null;var e=this.mapEvent.get(t);return e},this.OnSize=function(){if(this.Frame){this.SetSizeChange(!0);var t=this.ChartPaint[0];if(t&&this.Data&&this.Data.DataOffset>0&&ha.IsNonEmptyArray(this.Data.Data)){var e=t.GetPageSize(!0);e+this.Data.DataOffset>=this.Data.Data.length&&this.GotoLastPage()}this.Draw()}},this.SetSizeChange=function(t){var e=this.ChartPaint[0];e&&(e.SizeChange=t)},this.OnWheel=function(t){if(w.Chart.Log("[JSDealChartContainer::OnWheel]",t),(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash)&&this.Data&&ha.IsNonEmptyArray(this.Data.Data)){var e=t.clientX-this.UIElement.getBoundingClientRect().left,a=t.clientY-this.UIElement.getBoundingClientRect().top,i=!1;if(this.Canvas.beginPath(),this.Canvas.rect(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetTop(),this.Frame.ChartBorder.GetWidth(),this.Frame.ChartBorder.GetHeight()),i=this.Canvas.isPointInPath(e,a),i){var r=this.ChartPaint[0];if(r){var n=t.wheelDelta;ha.IsObjectExist(t.wheelDelta)||(n=-.01*t.deltaY),n<0?this.GotoNextPage()&&this.Draw():n>0&&this.GotoPreviousPage()&&this.Draw(),t.preventDefault?t.preventDefault():t.returnValue=!1}}}},this.OnKeyDown=function(t){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var e=t.keyCode?t.keyCode:t.which;switch(e){case 38:this.GotoPreviousPage()&&this.Draw();break;case 40:this.GotoNextPage()&&this.Draw();break}t.preventDefault?t.preventDefault():t.returnValue=!1}},this.GotoNextPage=function(){if(!this.Data||!ha.IsNonEmptyArray(this.Data.Data))return!1;var t=this.ChartPaint[0];if(!t)return!1;var e=t.GetPageSize();if(e>this.Data.Data.length)return!1;var a=this.Data.DataOffset+e;return a+e!=this.Data.Data.length-1&&(a+e>this.Data.Data.length?this.Data.DataOffset=this.Data.Data.length-e:this.Data.DataOffset=a,!0)},this.GotoPreviousPage=function(){if(!this.Data||!ha.IsNonEmptyArray(this.Data.Data))return!1;var t=this.ChartPaint[0];if(!t)return!1;if(this.Data.DataOffset<=0)return!1;var e=t.GetPageSize(),a=this.Data.DataOffset;return a-=e,a<0&&(a=0),this.Data.DataOffset=a,!0},this.GotoLastPage=function(){var t=this.ChartPaint[0];if(t){var e=t.GetPageSize(!0),a=this.Data.Data.length-e;a<0&&(a=0),this.Data.DataOffset=a}},this.SetColumn=function(t,e){var a=this.ChartPaint[0];a&&(a.SetColumn(t),a.SizeChange=!0,e&&e.Redraw&&this.Draw())},this.ReloadResource=function(t){this.Frame.ReloadResource(t);for(var e=0;e<this.ChartPaint.length;++e){var a=this.ChartPaint[e];a.ReloadResource&&a.ReloadResource(t)}t&&t.Redraw&&(this.SetSizeChange(!0),this.Draw())}}function Jn(){this.ChartBorder,this.Canvas,this.BorderColor=Oi.DealList.BorderColor,this.LogoTextColor=Oi.FrameLogo.TextColor,this.LogoTextFont=Oi.FrameLogo.Font,this.ReloadResource=function(t){this.BorderColor=Oi.DealList.BorderColor,this.LogoTextColor=Oi.FrameLogo.TextColor,this.LogoTextFont=Oi.FrameLogo.Font},this.Draw=function(t){var e=Q(this.ChartBorder.GetLeft()),a=Q(this.ChartBorder.GetTop()),i=Q(this.ChartBorder.GetRight()),r=Q(this.ChartBorder.GetBottom()),n=i-e,s=r-a;ha.IsNumber(this.BorderLine)?(this.Canvas.strokeStyle=this.BorderColor,this.Canvas.beginPath(),(1&this.BorderLine)>0&&(this.Canvas.moveTo(e,a),this.Canvas.lineTo(i,a)),(2&this.BorderLine)>0&&(this.Canvas.moveTo(e,r),this.Canvas.lineTo(i,r)),(4&this.BorderLine)>0&&(this.Canvas.moveTo(e,a),this.Canvas.lineTo(e,r)),(8&this.BorderLine)>0&&(this.Canvas.moveTo(i,a),this.Canvas.lineTo(i,r)),this.Canvas.stroke()):(this.Canvas.strokeStyle=this.BorderColor,this.Canvas.strokeRect(e,a,n,s))},this.DrawLogo=function(){var t=Oi.FrameLogo.Text;if(ha.IsString(t)){this.Canvas.fillStyle=this.LogoTextColor,this.Canvas.font=this.LogoTextFont,this.Canvas.textAlign="left",this.Canvas.textBaseline="bottom";var e=this.ChartBorder.GetLeft()+5,a=this.ChartBorder.GetBottom()-5;this.Canvas.fillText(t,e,a)}}}Wn.GetStyleConfig=function(t){switch(t){case Xn.BLACK_ID:return _n();case Xn.WHITE_ID:return new wi;default:return null}},Un.Init=function(t){var e=new Un(t);return e.OnSize(),e},Kn.JsonDataToDealData=function(t){t.symbol;var e=[];if(!ha.IsNonEmptyArray(t.detail))return e;for(var a=0;a<t.detail.length;++a){var i=t.detail[a],r={Time:i[0],Price:i[1],Vol:i[2],BS:i[4],Amount:i[3]};r.Source=i,i[5]&&(r.StrTime=i[5]),i[6]&&(r.ID=i[6]),e.push(r)}return e};var zn={TIME_ID:0,PRICE_ID:1,VOL_ID:2,DEAL_ID:3,BS_ID:4,UPDOWN_ID:5,STRING_TIME_ID:6,INDEX_ID:7,MULTI_BAR_ID:8,CENTER_BAR_ID:9,CUSTOM_TEXT_ID:10};function qn(){this.Canvas,this.ChartBorder,this.ChartFrame,this.Name,this.ClassName="ChartDealList",this.IsDrawFirst=!1,this.GetEventCallback,this.Data,this.Symbol,this.YClose,this.Open,this.Decimal=2,this.IsSingleTable=!1,this.IsShowHeader=!0,this.SizeChange=!0,this.UpColor=Oi.DealList.UpTextColor,this.DownColor=Oi.DealList.DownTextColor,this.UnchagneColor=Oi.DealList.UnchagneTextColor,this.BorderColor=Oi.DealList.BorderColor,this.HeaderFontConfig={Size:Oi.DealList.Header.Font.Size,Name:Oi.DealList.Header.Font.Name},this.HeaderColor=Oi.DealList.Header.Color,this.HeaderMergin={Left:Oi.DealList.Header.Mergin.Left,Right:Oi.DealList.Header.Mergin.Right,Top:Oi.DealList.Header.Mergin.Top,Bottom:Oi.DealList.Header.Mergin.Bottom},this.ItemFontConfig={Size:Oi.DealList.Row.Font.Size,Name:Oi.DealList.Row.Font.Name},this.RowMergin={Top:Oi.DealList.Row.Mergin.Top,Bottom:Oi.DealList.Row.Mergin.Bottom},this.BarMergin={Top:Oi.DealList.Row.BarMergin.Top,Left:Oi.DealList.Row.BarMergin.Left,Right:Oi.DealList.Row.BarMergin.Right,Bottom:Oi.DealList.Row.BarMergin.Bottom},this.HeaderFont=12*U()+"px å¾®è½¯éé»",this.ItemFont=15*U()+"px å¾®è½¯éé»",this.RowCount=0,this.TableWidth=0,this.TableCount=0,this.HeaderHeight=0,this.Column=[{Type:zn.TIME_ID,Title:"æ¶é´",TextAlign:"center",Width:null,TextColor:Oi.DealList.FieldColor.Time,MaxText:"88:88:88",Foramt:"HH:MM:SS"},{Type:zn.PRICE_ID,Title:"ä»·æ ¼",TextAlign:"center",Width:null,MaxText:"888888.88"},{Type:zn.VOL_ID,Title:"æäº¤",TextAlign:"right",Width:null,TextColor:Oi.DealList.FieldColor.Vol,MaxText:"888888"},{Type:zn.BS_ID,Title:"",TextAlign:"right",Width:null,MaxText:"æ"}],this.RectClient={},this.ReloadResource=function(t){this.UpColor=Oi.DealList.UpTextColor,this.DownColor=Oi.DealList.DownTextColor,this.UnchagneColor=Oi.DealList.UnchagneTextColor,this.BorderColor=Oi.DealList.BorderColor,this.HeaderFontConfig={Size:Oi.DealList.Header.Font.Size,Name:Oi.DealList.Header.Font.Name},this.HeaderColor=Oi.DealList.Header.Color,this.HeaderMergin={Left:Oi.DealList.Header.Mergin.Left,Right:Oi.DealList.Header.Mergin.Right,Top:Oi.DealList.Header.Mergin.Top,Bottom:Oi.DealList.Header.Mergin.Bottom},this.ItemFontConfig={Size:Oi.DealList.Row.Font.Size,Name:Oi.DealList.Row.Font.Name},this.RowMergin={Top:Oi.DealList.Row.Mergin.Top,Bottom:Oi.DealList.Row.Mergin.Bottom};for(var e=0;e<this.Column.length;++e){var a=this.Column[e];a.Type==zn.TIME_ID||a.Type==zn.STRING_TIME_ID?a.TextColor=Oi.DealList.FieldColor.Time:a.Type==zn.VOL_ID?a.TextColor=Oi.DealList.FieldColor.Vol:a.Type==zn.DEAL_ID?a.TextColor=Oi.DealList.FieldColor.Deal:a.Type==zn.INDEX_ID&&(a.TextColor=Oi.DealList.FieldColor.Index)}},this.SetColumn=function(t){if(ha.IsNonEmptyArray(t)){this.Column=[];for(var e=0;e<t.length;++e){var a=t[e],i=this.GetDefaultColunm(a.Type);if(i){if(a.Title&&(i.Title=a.Title),a.TextAlign&&(i.TextAlign=a.TextAlign),a.TextColor&&(i.TextColor=a.TextColor),a.MaxText&&(i.MaxText=a.MaxText),a.Type==zn.MULTI_BAR_ID||a.Type==zn.CENTER_BAR_ID){if(!ha.IsNumber(a.DataIndex))continue;i.DataIndex=a.DataIndex}this.Column.push(i)}}}},this.GetDefaultColunm=function(t){for(var e=[{Type:zn.TIME_ID,Title:"æ¶é´",TextAlign:"center",Width:null,TextColor:Oi.DealList.FieldColor.Time,MaxText:"88:88:88",Foramt:"HH:MM:SS"},{Type:zn.PRICE_ID,Title:"ä»·æ ¼",TextAlign:"center",Width:null,MaxText:"888888.88"},{Type:zn.VOL_ID,Title:"æäº¤",TextAlign:"right",Width:null,TextColor:Oi.DealList.FieldColor.Vol,MaxText:"888888"},{Type:zn.BS_ID,Title:"",TextAlign:"right",Width:null,MaxText:"æ"},{Type:zn.DEAL_ID,Title:"ç¬æ°",TextAlign:"right",Width:null,TextColor:Oi.DealList.FieldColor.Deal,MaxText:"8888"},{Type:zn.UPDOWN_ID,Title:"æ¶¨è·",TextAlign:"right",Width:null,MaxText:"-8888.88"},{Type:zn.STRING_TIME_ID,Title:"æ¶é´",TextAlign:"center",Width:null,TextColor:Oi.DealList.FieldColor.Time,MaxText:"88:88:88"},{Type:zn.INDEX_ID,Title:"åºå·",TextAlign:"center",Width:null,TextColor:Oi.DealList.FieldColor.Index,MaxText:"88888"},{Type:zn.MULTI_BAR_ID,Title:"æ±å­",TextAlign:"center",Width:null,TextColor:Oi.DealList.FieldColor.BarTitle,MaxText:"888888"},{Type:zn.CENTER_BAR_ID,Title:"æ±å­2",TextAlign:"center",Width:null,TextColor:Oi.DealList.FieldColor.BarTitle,MaxText:"888888"},{Type:zn.CUSTOM_TEXT_ID,Title:"èªå®ä¹",TextAlign:"center",Width:null,TextColor:Oi.DealList.FieldColor.Text,MaxText:"æææææ"}],a=0;a<e.length;++a){var i=e[a];if(i.Type==t)return i}return null},this.Draw=function(){this.SizeChange?this.CalculateSize():this.UpdateCacheData(),this.DrawBorder(),this.DrawHeader(),this.DrawBody(),this.SizeChange=!1},this.UpdateCacheData=function(){this.RectClient.Left=this.ChartBorder.GetLeft(),this.RectClient.Right=this.ChartBorder.GetRight(),this.RectClient.Top=this.ChartBorder.GetTop(),this.RectClient.Bottom=this.ChartBorder.GetBottom(),this.Decimal=rn(this.Symbol)},this.GetPageSize=function(t){t&&this.CalculateSize();var e=this.TableCount*this.RowCount;return e},this.CalculateSize=function(){this.UpdateCacheData();var t=U();this.HeaderFont=this.HeaderFontConfig.Size*t+"px "+this.HeaderFontConfig.Name,this.ItemFont=this.ItemFontConfig.Size*t+"px "+this.ItemFontConfig.Name,this.Canvas.font=this.ItemFont;for(var e=0,a=0,i=0;i<this.Column.length;++i){var r=this.Column[i];a=this.Canvas.measureText(r.MaxText).width,r.Width=a+4,e+=r.Width}var n=this.RectClient.Right-this.RectClient.Left;this.TableCount=parseInt(n/e),this.IsSingleTable&&(this.TableCount=1),this.TableWidth=n/this.TableCount,this.HeaderHeight=this.GetFontHeight(this.HeaderFont,"æ")+this.HeaderMergin.Top+this.HeaderMergin.Bottom,this.IsShowHeader||(this.HeaderHeight=0),this.RowHeight=this.GetFontHeight(this.ItemFont,"æ")+this.HeaderMergin.Top+this.HeaderMergin.Bottom,this.RowCount=parseInt((this.RectClient.Bottom-this.RectClient.Top-this.HeaderHeight)/this.RowHeight)},this.DrawHeader=function(){if(this.IsShowHeader){var t=this.RectClient.Left+this.HeaderMergin.Left,e=this.RectClient.Top,a=e+this.HeaderMergin.Top+(this.HeaderHeight-this.HeaderMergin.Top-this.HeaderMergin.Bottom)/2;this.Canvas.font=this.HeaderFont,this.Canvas.fillStyle=this.HeaderColor;for(var i=0,r=0;i<this.TableCount;++i){var n=t+this.TableWidth*i,s=n;for(r=0;r<this.Column.length;++r){var o=this.Column[r],h=o.Width;r==this.Column.length-1&&(h=this.TableWidth-(s-n)-this.HeaderMergin.Right-this.HeaderMergin.Left);var l=s;"center"==o.TextAlign?(l=s+h/2,this.Canvas.textAlign="center"):"right"==o.TextAlign?(l=s+h,this.Canvas.textAlign="right"):this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillText(o.Title,l,a),s+=o.Width}}}},this.DrawBorder=function(){var t=Q(this.RectClient.Left),e=Q(this.RectClient.Right),a=Q(this.RectClient.Top),i=Q(this.RectClient.Bottom);this.Canvas.strokeStyle=this.BorderColor,this.Canvas.beginPath(),this.IsShowHeader&&(this.Canvas.moveTo(t,a+this.HeaderHeight),this.Canvas.lineTo(e,a+this.HeaderHeight));for(var r=Q(t+this.TableWidth),n=1;n<this.TableCount;++n)this.Canvas.moveTo(r,a),this.Canvas.lineTo(r,i),r=Q(r+this.TableWidth);this.Canvas.stroke()},this.DrawBody=function(){if(this.Data&&ha.IsNonEmptyArray(this.Data.Data)){this.Canvas.font=this.ItemFont;for(var t=this.RectClient.Top+this.HeaderHeight,e=this.RectClient.Left+this.HeaderMergin.Left,a=this.Data.Data.length,i=this.Data.DataOffset,r=0,n=0;r<this.TableCount;++r){var s=e+this.TableWidth*r,o=s,h=t;for(n=0;n<this.RowCount&&i<a;++n,++i){var l=this.Data.Data[i];this.DrawRow(l,o,h,i),h+=this.RowHeight}}}},this.DrawRow=function(t,e,a,i,r){for(var n=e,s=e+this.TableWidth,o=0;o<this.Column.length;++o){var h=this.Column[o],l=h.TextColor,u=null,C=h.Width,D=h.TextAlign;if(e+C>s)break;if(o==this.Column.length-1&&(C=this.TableWidth-(e-n)-this.HeaderMergin.Right-this.HeaderMergin.Left),h.Type==zn.TIME_ID)u=ha.FormatTimeString(t.Time,h.Foramt);else if(h.Type==zn.STRING_TIME_ID)u=t.StrTime;else if(h.Type==zn.PRICE_ID)l=t.Price>this.YClose?this.UpColor:t.Price<this.YClose?this.DownColor:this.UnchagneColor,u=t.Price.toFixed(this.Decimal);else if(h.Type==zn.VOL_ID)u=ha.FormatValueString(t.Vol,0),l=this.GetVolColor(h,t);else if(h.Type==zn.DEAL_ID)u=ha.FormatValueString(t.Deal,0);else if(h.Type==zn.BS_ID)1==t.BS?(u="B",l=this.UpColor):2==t.BS&&(u="S",l=this.DownColor);else if(h.Type==zn.UPDOWN_ID){if(ha.IsNumber(this.YClose)){var f=t.Price-this.YClose;u=f.toFixed(2),l=f>0?this.UpColor:f<0?this.DownColor:this.UnchagneColor}}else if(h.Type==zn.INDEX_ID)u=(i+1).toString();else if(h.Type==zn.MULTI_BAR_ID){var c={Left:e,Top:a,Width:C,Height:this.RowHeight};this.DrawMultiBar(h,t,c)}else if(h.Type==zn.CENTER_BAR_ID){c={Left:e,Top:a,Width:C,Height:this.RowHeight};this.DrawCenterBar(h,t,c)}else if(h.Type==zn.CUSTOM_TEXT_ID){var d={Text:null,TextColor:null,TextAlign:null};c={Left:e,Top:a,Width:C,Height:this.RowHeight};this.DrawCustomText(h,t,c,i,o,d)&&(d.Text&&(u=d.Text),d.TextColor&&(l=d.TextColor),d.TextAlign&&(D=d.TextAlign))}this.DrawItemText(u,l,D,e,a,C),e+=h.Width}},this.DrawItemText=function(t,e,a,i,r,n){var s=i;"center"==a?(s=i+n/2,this.Canvas.textAlign="center"):"right"==a?(s=i+n,this.Canvas.textAlign="right"):this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillStyle=e,t&&this.Canvas.fillText(t,s,r+this.RowHeight/2)},this.DrawMultiBar=function(t,e,a){if(!e.Source||!ha.IsNonEmptyArray(e.Source))return!1;var i=e.Source[t.DataIndex];if(!i)return!1;if(!ha.IsNonEmptyArray(i.Value))return!1;for(var r=a.Width-this.BarMergin.Left-this.BarMergin.Right,n=a.Left+this.BarMergin.Left,s=a.Top+this.RowMergin.Top+this.BarMergin.Top,o=a.Height-this.RowMergin.Top-this.RowMergin.Bottom-this.BarMergin.Top-this.BarMergin.Bottom,h=n+r,l=0;l<i.Value.length;++l){var u=i.Value[l];if(!(u<=0)){if(n>=h)break;var C=r*u;C<1&&(C=1),n+C>h&&(C=h-n);var D=l;ha.IsNonEmptyArray(i.Color)&&l<i.Color.length&&(D=i.Color[l]),this.Canvas.fillStyle=Oi.DealList.FieldColor.Bar[D],this.Canvas.fillRect(n,s,C,o),n+=C}}return!0},this.DrawCenterBar=function(t,e,a){if(!e.Source||!ha.IsNonEmptyArray(e.Source))return!1;var i=e.Source[t.DataIndex];if(!i)return!1;if(!ha.IsNonEmptyArray(i.Value))return!1;for(var r=(a.Width-this.BarMergin.Left-this.BarMergin.Right)/2,n=a.Left+this.BarMergin.Left,s=n+r,o=a.Top+this.RowMergin.Top+this.BarMergin.Top,h=a.Height-this.RowMergin.Top-this.RowMergin.Bottom-this.BarMergin.Top-this.BarMergin.Bottom,l=0;l<i.Value.length&&l<2;++l){var u=i.Value[l];if(!(u<=0)){u>1&&(u=1);var C=r*u;C<1&&(C=1);var D=l;ha.IsNonEmptyArray(i.Color)&&l<i.Color.length&&(D=i.Color[l]),this.Canvas.fillStyle=Oi.DealList.FieldColor.Bar[D],0==l?this.Canvas.fillRect(s,o,-C,h):this.Canvas.fillRect(s,o,C,h)}}},this.DrawCustomText=function(t,e,a,i,r,n){var s=this.GetEventCallback(G.ON_DRAW_DEAL_TEXT);if(!s||!s.Callback)return!1;var o={Data:e,DataIndex:i,ColumnIndex:r,ColumnInfo:t,Out:{Text:null,TextColor:null,TextAlign:null}};return s.Callback(s,o,this),!!o.Out.Text&&(n.Text=o.Out.Text,o.Out.TextColor&&(n.TextColor=o.Out.TextColor),o.Out.TextAlign&&(n.TextAlign=o.Out.TextAlign),!0)},this.GetVolColor=function(t,e){var a=this.GetEventCallback(G.ON_DRAW_DEAL_VOL_COLOR);if(a&&a.Callback){var i={Data:e,TextColor:null};if(a.Callback(a,i,this),i.TextColor)return i.TextColor}return t.TextColor},this.GetFontHeight=function(t,e){return K(this.Canvas,t,e)}}function Zn(t){this.DivElement=t,this.JSChartContainer,this.CanvasElement=document.createElement("canvas"),this.CanvasElement.className="jsreportlist-drawing",this.CanvasElement.id=q(),this.CanvasElement.setAttribute("tabindex",0),this.CanvasElement.style&&(this.CanvasElement.style.outline="none"),t.hasChildNodes()&&w.Chart.Log("[JSReportChart::JSReportChart] divElement hasChildNodes",t.childNodes),t.appendChild(this.CanvasElement),this.OnSize=function(){var t=parseInt(this.DivElement.style.height.replace("px",""));this.CanvasElement.height=t,this.CanvasElement.width=parseInt(this.DivElement.style.width.replace("px","")),this.CanvasElement.style.width=this.CanvasElement.width+"px",this.CanvasElement.style.height=this.CanvasElement.height+"px";var e=U();this.CanvasElement.height*=e,this.CanvasElement.width*=e,w.Chart.Log("[JSReportChart::OnSize] devicePixelRatio="+window.devicePixelRatio+", height="+this.CanvasElement.height+", width="+this.CanvasElement.width),this.JSChartContainer&&this.JSChartContainer.OnSize&&this.JSChartContainer.OnSize()},this.SetOption=function(t){var e=this.CreateJSReportChartContainer(t);if(!e)return!1;t.OnCreatedCallback&&t.OnCreatedCallback(e),this.JSChartContainer=e,this.DivElement.JSChart=this,t.Symbol&&(e.Symbol=t.Symbol),t.Name&&(e.Name=t.Name);var a={Callback:null};e.Symbol&&(a.Callback=function(){e.RequestMemberListData()}),e.RequestStockListData(a)},this.CreateJSReportChartContainer=function(t){var e=new jn(this.CanvasElement);if(e.Create(t),t.NetworkFilter&&(e.NetworkFilter=t.NetworkFilter),ha.IsNonEmptyArray(t.Column)&&e.SetColumn(t.Column),ha.IsNonEmptyArray(t.Tab)&&e.SetTab(t.Tab),ha.IsNumber(t.TabSelected)&&e.SetSelectedTab(t.TabSelected),ha.IsBool(t.EnableDragRow)&&(e.EnableDragRow=t.EnableDragRow),ha.IsNumber(t.DragRowType)&&(e.DragRowType=t.DragRowType),t.SortInfo){var a=t.SortInfo;ha.IsNumber(a.Field)&&(e.SortInfo.Field=a.Field),ha.IsNumber(a.Sort)&&(e.SortInfo.Sort=a.Sort)}if(this.SetChartBorder(e,t),null!=t.IsAutoUpdate&&(e.IsAutoUpdate=t.IsAutoUpdate),t.AutoUpdateFrequency>0&&(e.AutoUpdateFrequency=t.AutoUpdateFrequency),ha.IsBool(t.EnableFilter)&&(e.EnableFilter=t.EnableFilter),t.EventCallback)for(var i=0;i<t.EventCallback.length;++i){a=t.EventCallback[i];e.AddEventCallback(a)}return e},this.SetChartBorder=function(t,e){if(e.Border){e.Border;ha.IsNumber(e.Border.Left)&&(t.Frame.ChartBorder.Left=e.Border.Left),ha.IsNumber(e.Border.Right)&&(t.Frame.ChartBorder.Right=e.Border.Right),ha.IsNumber(e.Border.Top)&&(t.Frame.ChartBorder.Top=e.Border.Top),ha.IsNumber(e.Border.Bottom)&&(t.Frame.ChartBorder.Bottom=e.Border.Bottom);var a=U();t.Frame.ChartBorder.Left*=a,t.Frame.ChartBorder.Right*=a,t.Frame.ChartBorder.Top*=a,t.Frame.ChartBorder.Bottom*=a}},this.ChangeSymbol=function(t,e){this.JSChartContainer&&this.JSChartContainer.ChangeSymbol(t,e)},this.SetColumn=function(t,e){this.JSChartContainer&&this.JSChartContainer.SetColumn(t,e)},this.EnableFilter=function(t,e){this.JSChartContainer&&this.JSChartContainer.EnableFilter(t,e)},this.AddEventCallback=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.AddEventCallback&&(w.Chart.Log("[JSReportChart:AddEventCallback] obj=",t),this.JSChartContainer.AddEventCallback(t))},this.ReloadResource=function(t){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ReloadResource&&(w.Chart.Log("[JSReportChart:ReloadResource] "),this.JSChartContainer.ReloadResource(t))},this.ChartDestory=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.ChartDestory&&this.JSChartContainer.ChartDestory()},this.Draw=function(){this.JSChartContainer&&"function"==typeof this.JSChartContainer.Draw&&(w.Chart.Log("[JSReportChart:Draw] "),this.JSChartContainer.Draw())}}function Qn(){this.OriginalSymbol,this.Symbol,this.Name,this.YClose,this.Open,this.Price,this.High,this.Low,this.Amount,this.Vol,this.Increase,this.UpDown,this.Exchange,this.Amplitude,this.BuyPrice,this.BuyVol,this.SellPrice,this.SellVol,this.AvPrice,this.LimitHigh,this.LimitLow,this.VolIn,this.VolOut,this.DealNum,this.OutShares,this.TotalShares,this.MarketValue,this.CircMarketValue,this.ExtendData}function jn(t){this.ClassName="JSReportChartContainer",this.Frame,this.ChartPaint=[],this.ChartSplashPaint=null,this.LoadDataSplashTitle="æ°æ®å è½½ä¸­",this.SplashTitle={StockList:"ä¸è½½ç è¡¨ä¸­.....",MemberList:"ä¸è½½æåä¸­....."},this.Canvas=t.getContext("2d"),this.ShowCanvas=null,this.Symbol,this.Name,this.NetworkFilter,this.Data={XOffset:0,YOffset:0,Data:[]},this.SourceData={Data:[]},this.BlockData=new E.default,this.MapStockData=new E.default,this.FixedRowData={Data:[],Type:0,Symbol:[]},this.SortInfo={Field:-1,Sort:0},this.DragRow,this.EnableDragRow=!1,this.DragRowType=0,this.AutoDragScrollTimer=null,this.EnablePageScroll=!1,this.DragMove,this.mapEvent=new E.default,this.AutoUpdateTimer=null,this.AutoUpdateFrequency=15e3,this.DelayUpdateTimer=null,this.DelayUpdateFrequency=500,this.UIElement=t,this.LastPoint=new at,this.IsOnTouch=!1,this.TouchDrag,this.TouchMoveMinAngle=70,this.YStepPixel=5*U(),this.XStepPixel=10*U(),this.PageUpDownCycle=!0,this.DragPageCycle=!0,this.DragXScroll=null,this.IsDestroy=!1,this.ChartDestory=function(){this.IsDestroy=!0,this.StopAutoUpdate()},this.StopAutoDragScrollTimer=function(){w.Chart.Log("[JSReportChartContainer::StopAutoDragScrollTimer] stop "),this.EnablePageScroll=!1,null!=this.AutoDragScrollTimer&&(clearTimeout(this.AutoDragScrollTimer),this.AutoDragScrollTimer=null)},this.AutoScrollPage=function(t){var e=this;this.AutoDragScrollTimer=setTimeout((function(){e.ChartOperator_Temp_ScrollPage(t)}),300)},this.ChartOperator_Temp_ScrollPage=function(t){if(this.EnablePageScroll){var e=this.GetReportChart();if(e){if(t>0){var a=e.GetCurrentPageStatus();if(a.IsEnd)return;this.MoveYOffset(t,!1),++t}else{if(!(t<0))return;if(this.Data.YOffset<=0)return;this.MoveYOffset(t,!1),--t}this.Draw(),this.EnablePageScroll&&this.AutoScrollPage(t)}}},this.ClearFixedRowData=function(){this.FixedRowData.Data=[],this.FixedRowData.Symbol=[]},this.SetFixedRowCount=function(t){var e=this.GetReportChart();e&&(e.FixedRowCount=t)},this.Create=function(t){var e=this;this.UIElement.JSChartContainer=this,this.ChartSplashPaint=new Ia,this.ChartSplashPaint.Canvas=this.Canvas,this.ChartSplashPaint.SetTitle(this.LoadDataSplashTitle),this.ChartSplashPaint.IsEnableSplash=!0,this.Frame=new $n,this.Frame.ChartBorder=new nt,this.Frame.ChartBorder.UIElement=this.UIElement,this.Frame.ChartBorder.Top=30,this.Frame.ChartBorder.Left=5,this.Frame.ChartBorder.Bottom=20,this.Frame.Canvas=this.Canvas,this.ChartSplashPaint.Frame=this.Frame;var a=new as;if(a.Frame=this.Frame,a.ChartBorder=this.Frame.ChartBorder,a.Canvas=this.Canvas,a.UIElement=this.UIElement,a.GetEventCallback=function(t){return e.GetEventCallback(t)},a.GetStockDataCallback=function(t){return e.GetStockData(t)},a.GetBlockDataCallback=function(t){return e.GetBlockData(t)},a.Data=this.Data,a.FixedRowData=this.FixedRowData,a.SortInfo=this.SortInfo,a.Tab=new is,a.Tab.Frame=this.Frame,a.Tab.Canvas=this.Canvas,a.Tab.ChartBorder=this.Frame.ChartBorder,a.Tab.Report=a,this.ChartPaint[0]=a,t&&!0===t.PageInfo){var i=new rs;i.Frame=this.Frame,i.ChartBorder=this.Frame.ChartBorder,i.Canvas=this.Canvas,i.Report=a,this.ChartPaint[1]=i}if(t&&(ha.IsBool(t.IsShowHeader)&&(a.IsShowHeader=t.IsShowHeader),ha.IsNumber(t.FixedColumn)&&(a.FixedColumn=t.FixedColumn),ha.IsNumber(t.BorderLine)&&(this.Frame.BorderLine=t.BorderLine),ha.IsBool(t.TabShow)&&(a.Tab.IsShow=t.TabShow),ha.IsNumber(t.FixedRowCount)&&(a.FixedRowCount=t.FixedRowCount),ha.IsBool(t.ItemBorder)&&(a.IsDrawBorder=t.ItemBorder),ha.IsNumber(t.SelectedModel)&&(a.SelectedModel=t.SelectedModel),ha.IsNonEmptyArray(t.FixedSymbol))){a.FixedRowCount=0,this.FixedRowData.Type=1,this.FixedRowData.Symbol=[];for(var r=t.FixedSymbol,n=0;n<r.length;++n){var s=r[n];this.FixedRowData.Symbol.push(s.Symbol),++a.FixedRowCount}}var o=!0,h=!0;t&&(!1===t.KeyDown&&(o=!1,w.Chart.Log("[JSDealChartContainer::Create] not register keydown event.")),!1===t.Wheel&&(h=!1,w.Chart.Log("[JSDealChartContainer::Create] not register wheel event."))),o&&this.UIElement.addEventListener("keydown",(function(t){e.OnKeyDown(t)}),!0),h&&this.UIElement.addEventListener("wheel",(function(t){e.OnWheel(t)}),!0),this.UIElement.ondblclick=function(t){e.UIOnDblClick(t)},this.UIElement.onmousedown=function(t){e.UIOnMouseDown(t)},this.UIElement.oncontextmenu=function(t){e.UIOnContextMenu(t)},this.UIElement.onmousemove=function(t){e.UIOnMouseMove(t)},this.UIElement.onmouseout=function(t){e.UIOnMounseOut(t)},this.UIElement.onmouseleave=function(t){e.UIOnMouseleave(t)},this.UIElement.ontouchstart=function(t){e.OnTouchStart(t)},this.UIElement.ontouchmove=function(t){e.OnTouchMove(t)},this.UIElement.ontouchend=function(t){e.OnTouchEnd(t)}},this.Draw=function(){if(!(this.UIElement.width<=0||this.UIElement.height<=0)){this.Canvas.clearRect(0,0,this.UIElement.width,this.UIElement.height);var t=U();if(this.Canvas.lineWidth=t,this.ChartSplashPaint&&this.ChartSplashPaint.IsEnableSplash)return this.Frame.Draw({IsEnableSplash:this.ChartSplashPaint.IsEnableSplash}),void this.ChartSplashPaint.Draw();this.Frame.Draw(),this.Frame.DrawLogo();for(var e=0;e<this.ChartPaint.length;++e){var a=this.ChartPaint[e];a.IsDrawFirst&&a.Draw()}for(e=0;e<this.ChartPaint.length;++e){a=this.ChartPaint[e];a.IsDrawFirst||a.Draw()}}},this.ResetReportStatus=function(){this.Data.XOffset=0,this.Data.YOffset=0},this.ResetReportSelectStatus=function(){var t=this.GetReportChart();t&&(t.SelectedRow=-1,t.SelectedFixedRow=-1)},this.ClearData=function(){this.SourceData.Data=[],this.Data.Data=[],this.BlockData=new E.default},this.ResetSortStatus=function(){this.SortInfo.Field=-1,this.SortInfo.Sort=0},this.SetSymbolList=function(t,e){if(this.ClearData(),this.ResetReportStatus(),this.ResetSortStatus(),ha.IsNonEmptyArray(t))for(var a=0;a<t.length;++a)this.Data.Data.push(t[a]);var i=this.ChartPaint[0];i&&(i.Data=this.Data),this.Draw()},this.ChangeSymbol=function(t,e){if(this.Symbol=t,this.ClearData(),this.ResetReportStatus(),this.ResetSortStatus(),this.ResetReportSelectStatus(),e){if(ha.IsNumber(e.TabSelected)){var a=this.GetTabChart();a&&(a.SelectedTabIndex=e.TabSelected)}if(Array.isArray(e.FixedSymbol)){var i=this.GetReportChart();if(i){i.FixedRowCount=0,this.FixedRowData.Type=1,this.FixedRowData.Symbol=[];for(var r=e.FixedSymbol,n=0;n<r.length;++n){var s=r[n];this.FixedRowData.Symbol.push(s.Symbol),++i.FixedRowCount}this.SetSizeChange(!0)}}if(e.SortInfo){s=e.SortInfo;ha.IsNumber(s.Field)&&(this.SortInfo.Field=s.Field),ha.IsNumber(s.Sort)&&(this.SortInfo.Sort=s.Sort)}}this.RequestMemberListData()},this.RequestMemberListData=function(){var t=this;if(this.NetworkFilter){var e={Name:"JSReportChartContainer::RequestMemberListData",Explain:"æ¿åæåæ°æ®",Request:{Data:{symbol:this.Symbol}},Self:this,PreventDefault:!1};if(this.SortInfo.Field>=0&&this.SortInfo.Sort>0){var a=this.GetReportChart();if(a){var i=a.Column[this.SortInfo.Field];e.Sort={Column:i,Field:this.SortInfo.Field,Sort:this.SortInfo.Sort}}}if(this.NetworkFilter(e,(function(e){t.ChartSplashPaint.EnableSplash(!1),t.RecvMemberListData(e)})),1==e.PreventDefault)return}throw{Name:"JSReportChartContainer::RequestMemberListData",Error:"(æ¿åæåæ°æ®)ä¸æä¾åç½®æµè¯æ°æ®"}},this.RecvMemberListData=function(t){if(this.ClearData(),ha.IsNonEmptyArray(t.data))for(var e=0;e<t.data.length;++e)this.Data.Data.push(t.data[e]),this.SourceData.Data.push(t.data[e]);this.Draw(),this.UpdateStockData()},this.AutoUpdateEvent=function(t,e){var a=t?G.RECV_START_AUTOUPDATE:G.RECV_STOP_AUTOUPDATE;if(this.mapEvent.has(a)){var i=this,r=this.mapEvent.get(a),n={Stock:{Symbol:this.Symbol,Name:this.Name,DayCount:this.DayCount},Explain:e};t&&(n.Callback=function(t){i.RecvDealUpdateData(t)}),r.Callback(r,n,this)}},this.RequestStockListData=function(t){this.ChartSplashPaint.SetTitle(this.SplashTitle.StockList),this.ChartSplashPaint.EnableSplash(!0),this.Draw();var e=this;if(this.NetworkFilter){var a={Name:"JSReportChartContainer::RequestStockListData",Explain:"ç è¡¨æ°æ®",Self:this,PreventDefault:!1};if(this.NetworkFilter(a,(function(a){e.ChartSplashPaint.EnableSplash(!1),e.RecvStockListData(a,t)})),1==a.PreventDefault)return}throw{Name:"JSReportChartContainer::RequestStockListData",Error:"(ç è¡¨æ°æ®)ä¸æä¾åç½®æµè¯æ°æ®"}},this.RecvStockListData=function(t,e){if(ha.IsNonEmptyArray(t.data))for(var a=0;a<t.data.length;++a){var i=t.data[a],r=i[0],n=null;this.MapStockData.has(r)?n=this.MapStockData.get(r):(n=new Qn,n.OriginalSymbol=r,this.MapStockData.set(r,n)),n.Symbol=this.GetSymbolNoSuffix(r),n.Name=i[1],this.ReadStockJsonData(n,i)}e&&e.Callback?e.Callback():(this.Draw(),this.UpdateStockData())},this.UpdateMapStockData=function(t){if(t&&ha.IsNonEmptyArray(t.data))for(var e=0;e<t.data.length;++e){var a=t.data[e],i=a[0],r=null;this.MapStockData.has(i)?r=this.MapStockData.get(i):(r=new Qn,r.OriginalSymbol=i,this.MapStockData.set(i,r)),r.Symbol=this.GetSymbolNoSuffix(i),r.Name=a[1],this.ReadStockJsonData(r,a)}},this.GetStockData=function(t){return this.MapStockData&&this.MapStockData.has(t)?this.MapStockData.get(t):null},this.GetBlockData=function(t){return this.BlockData&&this.BlockData.has(t)?this.BlockData.get(t):null},this.DelayUpdateStockData=function(){var t=this;null!=this.DelayUpdateTimer&&(clearTimeout(this.DelayUpdateTimer),this.DelayUpdateTimer=null);var e=this.DelayUpdateFrequency;this.DelayUpdateTimer=setTimeout((function(){t.UpdateStockData()}),e)},this.UpdateStockData=function(){if(ha.IsNonEmptyArray(this.Data.Data)){var t=this.ChartPaint[0];if(t){if(this.SortInfo&&this.SortInfo.Field>=0&&this.SortInfo.Sort>0){var e=t.Column[this.SortInfo.Field];if(2==e.Sort)return void this.RequestStockSortData(e,this.SortInfo.Field,this.SortInfo.Sort)}var a=t.ShowSymbol;ha.IsNonEmptyArray(a)&&this.RequestStockData(a)}}},this.RequestStockData=function(t){var e=this;if(this.NetworkFilter){var a={Name:"JSDealChartContainer::RequestStockData",Explain:"æ¥ä»·åè¡¨è¡ç¥¨æ°æ®",Request:{Data:{stocks:t}},Self:this,PreventDefault:!1};if(this.NetworkFilter(a,(function(t){e.RecvStockData(t),e.AutoUpdate()})),1==a.PreventDefault)return}throw{Name:"JSReportChartContainer::RequestStockData",Error:"(æ¥ä»·åè¡¨è¡ç¥¨æ°æ®)ä¸æä¾åç½®æµè¯æ°æ®"}},this.RecvStockData=function(t){var e=new I.default;if(ha.IsNonEmptyArray(t.data))for(var a=0;a<t.data.length;++a){var i=t.data[a],r=i[0];if(r){var n=null;this.MapStockData.has(r)?n=this.MapStockData.get(r):(n=new Qn,n.OriginalSymbol=r,n.Symbol=this.GetSymbolNoSuffix(r),this.MapStockData.set(r,n)),this.ReadStockJsonData(n,i),e.has(r)||e.add(r)}}var s=this.ChartPaint[0];if(s){var o=!1,h=s.ShowSymbol;for(a=0;a<h.length;++a)if(e.has(h[a].Symbol)){o=!0;break}o&&this.Draw()}},this.ReadStockJsonData=function(t,e){ha.IsString(e[1])&&(t.Name=e[1]),ha.IsNumber(e[2])&&(t.YClose=e[2]),ha.IsNumber(e[3])&&(t.Open=e[3]),ha.IsNumber(e[4])&&(t.High=e[4]),ha.IsNumber(e[5])&&(t.Low=e[5]),ha.IsNumber(e[6])&&(t.Price=e[6]),ha.IsNumber(e[7])&&(t.Vol=e[7]),ha.IsNumber(e[8])&&(t.Amount=e[8]),ha.IsNumber(e[9])&&(t.BuyPrice=e[9]),ha.IsNumber(e[10])&&(t.BuyVol=e[10]),ha.IsNumber(e[11])&&(t.SellPrice=e[11]),ha.IsNumber(e[12])&&(t.SellVol=e[12]),ha.IsNumber(e[13])&&(t.AvPrice=e[13]),ha.IsNumber(e[14])&&(t.OutShares=e[14]),ha.IsNumber(e[15])&&(t.TotalShares=e[15]),ha.IsNumber(e[16])&&(t.LimitHigh=e[16]),ha.IsNumber(e[17])&&(t.LimitLow=e[17]),ha.IsNumber(e[18])&&(t.VolIn=e[18]),ha.IsNumber(e[19])&&(t.VolOut=e[19]),ha.IsNumber(e[20])&&(t.DealNum=e[20]),ha.IsNumber(e[21])&&(t.Increase=e[21]),ha.IsNumber(e[22])&&(t.UpDown=e[22]),ha.IsNumber(e[23])&&(t.Exchange=e[23]),ha.IsNumber(e[24])&&(t.Amplitude=e[24]),ha.IsNumber(e[25])&&(t.CircMarketValue=e[25]),ha.IsNumber(e[26])&&(t.MarketValue=e[26]),ha.IsNumber(e[21])||ha.IsNumber(t.Price)&&ha.IsNumber(t.YClose)&&0!=t.YClose&&(t.Increase=(t.Price-t.YClose)/t.YClose*100),ha.IsNumber(e[22])||ha.IsNumber(t.Price)&&ha.IsNumber(t.YClose)&&(t.UpDown=t.Price-t.YClose),ha.IsNumber(e[23])||ha.IsNumber(t.Vol)&&ha.IsNumber(t.OutShares)&&t.OutShares>0&&(t.Exchange=t.Vol/t.OutShares*100),ha.IsNumber(e[24])||ha.IsNumber(t.High)&&ha.IsNumber(t.Low)&&ha.IsNumber(t.YClose)&&0!=t.YClose&&(t.Amplitude=(t.High-t.Low)/t.YClose*100),ha.IsNumber(e[25])||ha.IsNumber(t.OutShares)&&ha.IsNumber(t.Price)&&(t.CircMarketValue=t.OutShares*t.Price),ha.IsNumber(e[26])||ha.IsNumber(t.TotalShares)&&ha.IsNumber(t.Price)&&(t.MarketValue=t.TotalShares*t.Price),e[30]&&(t.ExtendData=e[30]),e[31]&&this.BlockData.set(t.OriginalSymbol,e[31])},this.GetSymbolNoSuffix=function(t){var e=t.lastIndexOf(".");return e>0?t.substring(0,e):t},this.CancelAutoUpdate=function(){"number"==typeof this.AutoUpdateTimer&&(clearTimeout(this.AutoUpdateTimer),this.AutoUpdateTimer=null)},this.AutoUpdate=function(t){if(this.CancelAutoUpdate(),this.IsAutoUpdate){var e=this,a=2,i=this.GetEventCallback(G.ON_REPORT_MARKET_STATUS);if(i&&i.Callback){var r={MarketStatus:2};i.Callback(i,r,this),ha.IsNumber(r.MarketStatus)&&(a=r.MarketStatus)}if(0!=a&&3!=a){var n=this.AutoUpdateFrequency;1==a?this.AutoUpdateTimer=setTimeout((function(){e.AutoUpdate()}),n):2==a&&(this.AutoUpdateTimer=setTimeout((function(){e.UpdateStockData()}),n))}}},this.StopAutoUpdate=function(){this.CancelAutoUpdate(),this.AutoUpdateEvent(!1,"JSDealChartContainer::StopAutoUpdate"),this.IsAutoUpdate&&(this.IsAutoUpdate=!1)},this.AddEventCallback=function(t){if(t&&t.event&&t.callback){var e={Callback:t.callback,Source:t};this.mapEvent.set(t.event,e)}},this.RemoveEventCallback=function(t){this.mapEvent.has(t)&&this.mapEvent.delete(t)},this.GetEventCallback=function(t){if(!this.mapEvent.has(t))return null;var e=this.mapEvent.get(t);return e},this.OnSize=function(){this.Frame&&(this.SetSizeChange(!0),this.Draw(),this.DelayUpdateStockData())},this.SetSizeChange=function(t){for(var e=0;e<this.ChartPaint.length;++e){var a=this.ChartPaint[e];a&&(a.SizeChange=t)}},this.OnWheel=function(t){if(w.Chart.Log("[JSReportChartContainer::OnWheel]",t),(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash)&&this.Data&&ha.IsNonEmptyArray(this.Data.Data)){var e=t.clientX-this.UIElement.getBoundingClientRect().left,a=t.clientY-this.UIElement.getBoundingClientRect().top,i=!1;if(this.Canvas.beginPath(),this.Canvas.rect(this.Frame.ChartBorder.GetLeft(),this.Frame.ChartBorder.GetTop(),this.Frame.ChartBorder.GetWidth(),this.Frame.ChartBorder.GetHeight()),i=this.Canvas.isPointInPath(e,a),i){var r=this.ChartPaint[0];if(r){var n=t.wheelDelta;ha.IsObjectExist(t.wheelDelta)||(n=-.01*t.deltaY),n<0?this.GotoNextPage(this.PageUpDownCycle)&&(this.Draw(),this.DelayUpdateStockData()):n>0&&this.GotoPreviousPage(this.PageUpDownCycle)&&(this.Draw(),this.DelayUpdateStockData()),t.preventDefault?t.preventDefault():t.returnValue=!1}}}},this.OnKeyDown=function(t){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var e=this.GetReportChart();if(e){var a=t.keyCode?t.keyCode:t.which;switch(a){case 33:this.GotoPreviousPage(this.PageUpDownCycle)&&(this.Draw(),this.DelayUpdateStockData());break;case 34:this.GotoNextPage(this.PageUpDownCycle)&&(this.Draw(),this.DelayUpdateStockData());break;case 38:var i=this.MoveSelectedRow(-1);i&&(i.Redraw&&this.Draw(),i.Update&&this.DelayUpdateStockData());break;case 40:i=this.MoveSelectedRow(1);i&&(i.Redraw&&this.Draw(),i.Update&&this.DelayUpdateStockData());break;case 37:this.MoveXOffset(-1)&&this.Draw();break;case 39:this.MoveXOffset(1)&&this.Draw();break}t.preventDefault?t.preventDefault():t.returnValue=!1}}},this.UIOnDblClick=function(t){var e=U(),a=(t.clientX-this.UIElement.getBoundingClientRect().left)*e,i=(t.clientY-this.UIElement.getBoundingClientRect().top)*e,r=this.ChartPaint[0];r&&r.OnDblClick(a,i,t)},this.UIOnMouseDown=function(t){var e=this;this.DragXScroll=null,this.DragMove={Click:{X:t.clientX,Y:t.clientY},Move:{X:t.clientX,Y:t.clientY},PreMove:{X:t.clientX,Y:t.clientY}};var a=U(),i=(t.clientX-this.UIElement.getBoundingClientRect().left)*a,r=(t.clientY-this.UIElement.getBoundingClientRect().top)*a,n=this.ChartPaint[0];if(n){var s=n.OnMouseDown(i,r,t);if(!s)return;if(2!=s.Type&&4!=s.Type||0!=t.button&&2!=t.button){if(3==s.Type&&0==t.button)this.OnClickHeader(s,t);else if(1==s.Type&&0==t.button){var o=s.Tab;1==o.Type?this.MoveXOffset(-1)&&this.Draw():2==o.Type?this.MoveXOffset(1)&&this.Draw():3==o.Type?this.DragXScroll={Click:{X:i,Y:r},LastMove:{X:i,Y:r}}:4==o.Type?this.SetXOffset(o.Pos)&&this.Draw():5==o.Type&&this.OnClickTab(o,t)}}else 0==t.button&&2==s.Type&&this.EnableDragRow&&this.SortInfo.Sort<=0&&(this.DragRow={Click:{X:t.clientX,Y:t.clientY},LastMove:{X:t.clientX,Y:t.clientY},Data:s}),1==s.Redraw&&this.Draw()}document.onmousemove=function(t){e.DocOnMouseMove(t)},document.onmouseup=function(t){e.DocOnMouseUp(t)}},this.UIOnContextMenu=function(t){t.preventDefault()},this.UIOnMouseMove=function(t){var e=U(),a=(t.clientX-this.UIElement.getBoundingClientRect().left)*e,i=(t.clientY-this.UIElement.getBoundingClientRect().top)*e;if(!this.DragRow){var r=this.GetTabChart();if(r){var n=r.PtInTab(a,i);if(n){var s=n.Index;r.MoveOnTabIndex!=s&&(r.MoveOnTabIndex=s,this.Draw())}}}},this.UIOnMounseOut=function(t){var e=this.GetTabChart();e&&e.MoveOnTabIndex>=0&&(e.MoveOnTabIndex=-1,this.Draw())},this.UIOnMouseleave=function(t){var e=this.GetTabChart();e&&e.MoveOnTabIndex>=0&&(e.MoveOnTabIndex=-1,this.Draw())},this.DocOnMouseMove=function(t){if(this.DragMove.PreMove.X=this.DragMove.Move.X,this.DragMove.PreMove.Y=this.DragMove.Move.Y,this.DragMove.Move.X=t.clientX,this.DragMove.Move.Y=t.clientX,this.DragMove.Move.X==this.DragMove.PreMove.X&&this.DragMove.Move.Y==this.DragMove.PreMove.Y||this.StopAutoDragScrollTimer(),!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var e=U(),a=(t.clientX-this.UIElement.getBoundingClientRect().left)*e,i=(t.clientY-this.UIElement.getBoundingClientRect().top)*e;if(this.DragRow){var r=this.DragRow,n=r.LastMove.Y-t.clientY;if(Math.abs(n)<2)return;var s=this.GetReportChart();if(r.LastMove.X=t.clientX,r.LastMove.Y=t.clientY,r.Inside={X:a,Y:i},s){var o=s.OnDrawgRow(a,i,t);if(o)if(2==o.Type)o.Data.DataIndex!=r.Data.Row.DataIndex&&(r.MoveRow=o);else if(7==o.Type){var h=s.GetCurrentPageStatus();h.IsEnd||(this.MoveYOffset(1,!1),r.MoveRow=null,this.EnablePageScroll=!0,this.AutoScrollPage(2))}else 5==o.Type&&this.Data.YOffset>0&&(this.MoveYOffset(-1,!1),r.MoveRow=null,this.EnablePageScroll=!0,this.AutoScrollPage(-2));s.DragRow=r}this.Draw()}else if(this.DragXScroll){var l=this.ChartPaint[0];if(!l||!l.Tab)return;this.DragXScroll.LastMove.X=a,this.DragXScroll.LastMove.Y=i;var u=l.Tab.GetScrollPostionByPoint(a,i);this.SetXOffset(u)&&this.Draw()}}},this.DocOnMouseUp=function(t){document.onmousemove=null,document.onmouseup=null,this.StopAutoDragScrollTimer();var e=!1;if(this.DragRow){var a=this.GetReportChart();a&&(this.OnDragRow(),a.DragRow=null),e=!0}this.DragXScroll=null,this.DragRow=null,this.DragMove=null,e&&this.Draw()},this.OnDragRow=function(){if(this.SourceData&&ha.IsNonEmptyArray(this.SourceData.Data)&&this.DragRow&&this.DragRow.MoveRow){var t=this.DragRow,e=t.Data.Row.DataIndex,a=t.MoveRow.Data.DataIndex;if(!(e==a||e<0||a<0)){var i=this.SourceData.Data;if(!(e>=i.length||a>=i.length)){var r=this.GetEventCallback(G.ON_REPORT_DRAG_ROW);if(r){var n={Symbol:this.Symbol,Src:{Index:e,Symbol:i[e]},To:{Index:a,Symbol:i[a]},PreventDefault:!1};if(r.Callback(r,n,this),n.PreventDefault)return}if(1==this.DragRowType){var s=i[e];i[e]=i[a],i[a]=s,this.Data.Data=i.slice(0)}else{var o=i[e];i.splice(e,1),i.splice(a,0,o),this.Data.Data=i.slice(0)}var h=this.GetReportChart();h&&(0==h.SelectedModel?h.SelectedRow=t.MoveRow.Data.Index:h.SelectedRow=t.MoveRow.Data.DataIndex)}}}},this.IsPhoneDragging=function(t){var e=t.changedTouches.length,a=t.touches.length;return 1==e&&1==a},this.GetTouchData=function(t){for(var e=[],a=U(),i=0;i<t.touches.length;++i){var r=t.touches[i],n={clientX:r.clientX*a,clientY:r.clientY*a,pageX:r.pageX*a,pageY:r.pageY*a,InsideX:(r.clientX-this.UIElement.getBoundingClientRect().left)*a,InsideY:(r.clientY-this.UIElement.getBoundingClientRect().top)*a};e.push(n)}return e},this.GetMoveAngle=function(t,e){var a=Math.abs(t.X-e.X),i=Math.abs(t.Y-e.Y),r=180*Math.atan(a/i)/Math.PI;return r},this.PreventTouchEvent=function(t){t.cancelable&&t.preventDefault(),t.stopPropagation()},this.OnTouchStart=function(t){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){this.IsOnTouch=!0;var e=this.GetReportChart();if(e&&this.IsPhoneDragging(t)){var a={Click:{},LastMove:{},InsideClick:{}},i=this.GetTouchData(t);a.Click.X=i[0].clientX,a.Click.Y=i[0].clientY,a.InsideClick.X=i[0].InsideX,a.InsideClick.Y=i[0].InsideY,a.LastMove.X=i[0].clientX,a.LastMove.Y=i[0].clientY,a.IsXMove=!1,a.IsYMove=!1,e.IsPtInBody(a.InsideClick.X,a.InsideClick.Y)&&(this.TouchDrag=a),this.TouchInfo={InsideClick:{X:i[0].InsideX,Y:i[0].InsideY},Click:{X:i[0].clientX,Y:i[0].clientY}},this.PreventTouchEvent(t)}}},this.OnDragYOffset=function(t,e,a,i){if(a<5)return!1;var r=!0;t.LastMove.Y<e[0].clientY&&(r=!1);var n=this.YStepPixel;n<=0&&(n=5);var s=parseInt(a/n);return!(s<=0)&&(0==r&&(s*=-1),this.MoveYOffset(s,this.DragPageCycle)&&(t.IsYMove=!0,this.Draw(),this.DelayUpdateStockData()),!0)},this.OnDragXOffset=function(t,e,a,i){if(a<5)return!1;var r=!0;t.LastMove.X<e[0].clientX&&(r=!1);var n=this.XStepPixel;n<=0&&(n=5);var s=parseInt(a/n);return!(s<=0)&&(r||(s*=-1),this.MoveXOffset(s)&&(t.IsXMove=!0,this.Draw()),!0)},this.OnTouchMove=function(t){if(!this.ChartSplashPaint||1!=this.ChartSplashPaint.IsEnableSplash){var e=this.GetReportChart();if(e){var a=this.GetTouchData(t);if(this.IsPhoneDragging(t)){var i=this.TouchDrag;if(this.TouchInfo.Move={X:a[0].clientX,Y:a[0].clientY},i){this.PreventTouchEvent(t);var r=this.GetMoveAngle(i.LastMove,{X:a[0].clientX,Y:a[0].clientY}),n=Math.abs(i.LastMove.X-a[0].clientX),s=Math.abs(i.LastMove.Y-a[0].clientY);if(1==i.IsYMove){if(this.ShowPageInfo(!0),!this.OnDragYOffset(i,a,s,t))return}else if(1==i.IsXMove){if(!this.OnDragXOffset(i,a,n,t))return}else if(s>0&&r<this.TouchMoveMinAngle){if(this.ShowPageInfo(!0),!this.OnDragYOffset(i,a,s,t))return}else{if(!(n>0&&r>=this.TouchMoveMinAngle))return;if(!this.OnDragXOffset(i,a,n,t))return}i.LastMove.X=a[0].clientX,i.LastMove.Y=a[0].clientY}}}}},this.OnTouchEnd=function(t){w.Chart.Log("[JSReportChartContainer:OnTouchEnd]",t),this.ChartSplashPaint&&1==this.ChartSplashPaint.IsEnableSplash||(this.ShowPageInfo(!1),this.OnTouchClick(this.TouchInfo,t),this.IsOnTouch=!1,this.TouchDrag=null,this.TouchInfo=null)},this.OnTouchClick=function(t,e){if(!t||!t.Click)return!1;if(t.Move)return!1;var a=t.InsideClick,i=this.GetReportChart();if(!i)return!1;var r=i.OnMouseDown(a.X,a.Y,e);if(!r)return!1;2==r.Type||4==r.Type?1==r.Redraw&&this.Draw():3==r.Type&&this.OnClickHeader(r,e),w.Chart.Log("[JSReportChartContainer:OnTouchClick] clickData",r)},this.GetTabChart=function(){var t=this.ChartPaint[0];return t?t.Tab:null},this.GetReportChart=function(){var t=this.ChartPaint[0];return t},this.GotoNextPage=function(t){if(!this.Data||!ha.IsNonEmptyArray(this.Data.Data))return!1;var e=this.ChartPaint[0];if(!e)return!1;var a=e.GetPageSize();if(a>this.Data.Data.length)return!1;if(this.Data.YOffset+a>=this.Data.Data.length)return!0===t&&(this.Data.YOffset=0,!0);this.Data.YOffset+=a;var i=this.Data.Data.length-this.Data.YOffset;return 0==e.SelectedModel&&e.SelectedRow>i-1&&(e.SelectedRow=i-1),!0},this.GotoPreviousPage=function(t){if(!this.Data||!ha.IsNonEmptyArray(this.Data.Data))return!1;var e=this.ChartPaint[0];if(!e)return!1;var a=e.GetPageSize();if(a>this.Data.Data.length)return!1;if(this.Data.YOffset<=0)return!0===t&&(this.Data.YOffset=this.Data.Data.length-a,!0);var i=this.Data.YOffset;return i-=a,i<0&&(i=0),this.Data.YOffset=i,!0},this.MoveYOffset=function(t,e){if(!this.Data||!ha.IsNonEmptyArray(this.Data.Data))return!1;var a=this.ChartPaint[0];if(!a)return!1;var i=a.GetCurrentPageStatus();if(i.IsSinglePage)return!1;if(t>0){var r=this.Data.Data.length,n=i.PageSize,s=this.Data.YOffset;if(e)for(var o=0;o<t;++o)++s,s+n>r&&(s=0);else{if(s+n>=r)return!1;for(o=0;o<t;++o){if(s+n+1>r)break;++s}}return this.Data.YOffset=s,!0}if(t<0){t=Math.abs(t);s=this.Data.YOffset;if(e)for(n=i.PageSize,o=0;o<t;++o)--s,s<0&&(s=this.Data.Data.length-n);else{if(this.Data.YOffset<=0)return!1;for(o=0;o<t;++o){if(s-1<0)break;--s}}return this.Data.YOffset=s,!0}return!1},this.MoveSelectedRow=function(t){var e=this.ChartPaint[0];if(!e)return null;if(!ha.IsNonEmptyArray(this.Data.Data))return null;var a={Redraw:!1,Update:!1};if(0==e.SelectedModel){var i=e.GetCurrentPageStatus(),r=i.End-i.Start+1,n=i.SelectedRow;if(t>0)return n+=t,n%=r,e.SelectedRow=n,e.SelectedFixedRow=-1,a.Redraw=!0,a;if(t<0)return n+=t,n<0&&(n%=r,n=r+n),e.SelectedRow=n,e.SelectedFixedRow=-1,a.Redraw=!0,a}else if(1==e.SelectedModel){i=e.GetCurrentPageStatus(),r=i.PageSize,n=i.SelectedRow;if(t>0){if(n<0||n<i.Start||n>i.End)return e.SelectedRow=i.Start,a.Redraw=!0,a;for(var s=this.Data.YOffset,o=0;o<t;++o)++n,n>i.End&&++s,n>=this.Data.Data.length&&(n=0,s=0);return a.Redraw=!0,a.Update=s!=this.Data.YOffset,e.SelectedRow=n,this.Data.YOffset=s,a}if(t<0){if(n<0||n<i.Start||n>i.End)return e.SelectedRow=i.End,a.Redraw=!0,a;t=Math.abs(t);for(s=this.Data.YOffset,o=0;o<t;++o)--n,n<i.Start&&--s,n<0&&(n=this.Data.Data.length-1,s=this.Data.Data.length-r,s<0&&(s=0));return a.Redraw=!0,a.Update=s!=this.Data.YOffset,e.SelectedRow=n,this.Data.YOffset=s,a}}return null},this.MoveXOffset=function(t){var e=this.ChartPaint[0];if(!e)return!1;var a=e.GetXScrollRange();if(a<=0)return!1;if(t>0){if(this.Data.XOffset>=a)return!1;for(var i=0;i<t;++i){if(this.Data.XOffset>=a)break;++this.Data.XOffset}return!0}if(t<0){if(this.Data.XOffset<=0)return!1;t=Math.abs(t);for(i=0;i<t;++i){if(this.Data.XOffset-1<0)break;--this.Data.XOffset}return!0}return!1},this.SetXOffset=function(t){if(!ha.IsNumber(t))return!1;var e=this.ChartPaint[0];if(!e)return!1;var a=e.GetXScrollRange();return t<0&&(t=0),t>a&&(t=a),this.Data.XOffset=t,!0},this.GotoLastPage=function(){var t=this.ChartPaint[0];if(t){var e=t.GetPageSize(!0),a=this.Data.Data.length-e;a<0&&(a=0),this.Data.DataOffset=a}},this.SetColumn=function(t,e){var a=this.ChartPaint[0];a&&(a.SetColumn(t),a.SizeChange=!0,e&&e.Redraw&&this.Draw())},this.SetTab=function(t,e){var a=this.ChartPaint[0];if(a){var i=a.Tab;i&&(i.SetTabList(t),e&&e.Redraw&&this.Draw())}},this.SetSelectedTab=function(t,e){var a=this.ChartPaint[0];if(a){var i=a.Tab;i&&(i.SelectedTabIndex=t)}},this.ReloadResource=function(t){this.Frame.ReloadResource(t);for(var e=0;e<this.ChartPaint.length;++e){var a=this.ChartPaint[e];a.ReloadResource&&a.ReloadResource(t)}t&&t.Redraw&&(this.SetSizeChange(!0),this.Draw())},this.OnClickHeader=function(t,e){var a=this,i=t.Header;if(i.Column&&(1==i.Column.Sort||2==i.Column.Sort)){var r=i.Index,n={Field:this.SortInfo.Field,Sort:this.SortInfo.Sort},s=i.Column.SortType;if(n.Field!=r)n.Field=r,n.Sort=s[0];else if(1==s.length)n.Sort=s[0];else for(var o=0;o<s.length;++o)if(n.Sort==s[o]){n.Sort=s[(o+1)%s.length];break}if(1==i.Column.Sort||2==i.Column.Sort){if(0==n.Sort){this.Data.Data=[];for(o=0;o<this.SourceData.Data.length;++o)this.Data.Data.push(this.SourceData.Data[o])}else if(1==i.Column.Sort){var h=this.GetEventCallback(G.ON_REPORT_LOCAL_SORT);if(h&&h.Callback){var l={Column:i.Column,SortInfo:n,SymbolList:this.Data.Data,Result:null};h.Callback(h,l,this),Array.isArray(l.Result)&&(this.Data.Data=l.Result)}else this.Data.Data.sort((function(t,e){return a.LocalSort(t,e,i.Column,n.Sort)}))}else if(2==i.Column.Sort){if(!ha.IsNonEmptyArray(this.Data.Data))return;return this.SortInfo.Field=n.Field,this.SortInfo.Sort=n.Sort,this.Data.YOffset=0,this.ResetReportSelectStatus(),void this.RequestStockSortData(i.Column,n.Field,n.Sort)}this.Data.YOffset=0,this.ResetReportSelectStatus(),this.SortInfo.Field=n.Field,this.SortInfo.Sort=n.Sort,this.Draw(),this.DelayUpdateStockData()}}},this.OnClickTab=function(t,e){if(t.Tab){var a=!1,i=U(),r=(e.clientX-this.UIElement.getBoundingClientRect().left)*i,n=(e.clientY,this.UIElement.getBoundingClientRect().top,{Left:this.UIElement.getBoundingClientRect().left,Top:this.UIElement.getBoundingClientRect().top});if(t.Tab.IsMenu){var s=this.GetEventCallback(G.ON_CLICK_REPORT_TABMENU);if(s&&s.Callback){a=!0;var o=t.Rect,h={Left:o.Left/i,Right:o.Right/i,Top:o.Top/i,Bottom:o.Bottom/i},l={Data:t,IsSide:{X:r,Y:r},UIElement:n,Rect:h,e:e,Redraw:a};s.Callback(s,l,this),ha.IsBool(l.Redraw)&&(a=l.Redraw)}this.SetSelectedTab(t.Index)}else{s=this.GetEventCallback(G.ON_CLICK_REPORT_TAB);if(s&&s.Callback){l={Data:t,IsSide:{X:r,Y:r},UIElement:n,e:e,Redraw:a};s.Callback(s,l,this),ha.IsBool(l.Redraw)&&(a=l.Redraw)}this.SetSelectedTab(t.Index)}a&&this.Draw()}},this.LocalSort=function(t,e,a,i){switch(a.Type){case ts.SYMBOL_ID:case ts.NAME_ID:return this.LocalStringSort(t,e,a,i);case ts.PRICE_ID:case ts.VOL_ID:case ts.INCREASE_ID:case ts.UPDOWN_ID:case ts.BUY_PRICE_ID:case ts.SELL_PRICE_ID:case ts.AMOUNT_ID:case ts.BUY_VOL_ID:case ts.SELL_VOL_ID:case ts.YCLOSE_ID:case ts.OPEN_ID:case ts.HIGH_ID:case ts.LOW_ID:case ts.AVERAGE_PRICE_ID:case ts.OUTSTANDING_SHARES_ID:case ts.TOTAL_SHARES_ID:case ts.CIRC_MARKET_VALUE_ID:case ts.MARKET_VALUE_ID:case ts.EXCHANGE_RATE_ID:case ts.AMPLITUDE_ID:case ts.LIMIT_HIGH_ID:case ts.LIMIT_LOW_ID:case ts.VOL_IN_ID:case ts.VOL_OUT_ID:return this.LocalNumberSort(t,e,a,i);case ts.CUSTOM_NUMBER_TEXT_ID:return this.LoacCustomNumberSort(t,e,a,i);case ts.CUSTOM_STRING_TEXT_ID:return this.LoacCustomStringSort(t,e,a,i);case ts.CUSTOM_DATETIME_TEXT_ID:return this.LoacCustomDateTimeSort(t,e,a,i);default:return 0}},this.GetStockExtendData=function(t,e){if(ha.IsNumber(e.DataIndex)){if(e.DataIndex<0)return null;var a=this.GetStockData(t);return a&&a.ExtendData?a.ExtendData[e.DataIndex]:null}if(ha.IsNumber(e.BlockIndex)){if(e.BlockIndex<0)return null;a=this.GetBlockData(t);return a?a[e.BlockIndex]:null}return null},this.LocalStringSort=function(t,e,a,i){var r=this.GetStockData(t),n=this.GetStockData(e),s="",o="";2==i&&(s="ååååå",o="ååååå");var h=es.get(a.Type);return r&&r[h]&&(s=r[h]),n&&n[h]&&(o=n[h]),1==i?o<s?-1:o<s?1:0:s<o?-1:s>o?1:0},this.LocalNumberSort=function(t,e,a,i){var r=this.GetStockData(t),n=this.GetStockData(e),s=-99999999999999,o=-99999999999999;2==i&&(s=o=99999999999999);var h=es.get(a.Type);return r&&ha.IsNumber(r[h])&&(s=r[h]),n&&ha.IsNumber(n[h])&&(o=n[h]),1==i?o<s?-1:o<s?1:0:s<o?-1:s>o?1:0},this.LoacCustomNumberSort=function(t,e,a,i){var r=-99999999999999,n=-99999999999999;2==i&&(r=n=99999999999999);var s=this.GetStockExtendData(t,a);ha.IsNumber(s)&&(r=s);s=this.GetStockExtendData(e,a);return ha.IsNumber(s)&&(n=s),1==i?n<r?-1:n<r?1:0:r<n?-1:r>n?1:0},this.LoacCustomDateTimeSort=function(t,e,a,i){var r=-99999999999999,n=-99999999999999;2==i&&(r=n=99999999999999);var s=this.GetStockExtendData(t,a);ha.IsNumber(s)&&(r=s);s=this.GetStockExtendData(e,a);return ha.IsNumber(s)&&(n=s),1==i?n<r?-1:n<r?1:0:r<n?-1:r>n?1:0},this.RequestStockSortData=function(t,e,a){var i=this.ChartPaint[0];if(i){var r=this,n=this.Data.YOffset,s=i.GetPageSize(),o=n+s;if(o>=this.Data.Data.length&&(o=this.Data.Data.length-1),this.NetworkFilter){var h={Name:"JSDealChartContainer::RequestStockSortData",Explain:"æ¥ä»·åè¡¨è¡ç¥¨æåºæ°æ®",Request:{Data:{range:{start:n,end:o,count:this.Data.Data.length},column:{name:t.Title,type:t.Type,index:e,ID:t.ID},sort:a,symbol:this.Symbol,name:this.Name,pageSize:s}},Self:this,PreventDefault:!1};if(i.FixedRowCount>0&&1==i.FixedRowData.Type){for(var l=[],u=0;u<i.FixedRowData.Symbol.length;++u){var C=i.FixedRowData.Symbol[u];C&&l.push(C)}h.Request.FixedSymbol=l}if(this.NetworkFilter(h,(function(t){r.RecvStockSortData(t),r.AutoUpdate()})),1==h.PreventDefault)return}throw{Name:"JSReportChartContainer::RequestStockSortData",Error:"(æ¥ä»·åè¡¨è¡ç¥¨æåºæ°æ®)ä¸æä¾åç½®æµè¯æ°æ®"}}},this.RecvStockSortData=function(t){var e=[];if(ha.IsNonEmptyArray(t.data))for(var a=0;a<t.data.length;++a){var i=t.data[a],r=i[0];if(r){var n=null;this.MapStockData.has(r)?n=this.MapStockData.get(r):(n=new Qn,n.OriginalSymbol=r,n.Symbol=this.GetSymbolNoSuffix(r),this.MapStockData.set(r,n)),this.ReadStockJsonData(n,i),e.push(r)}}if(ha.IsNonEmptyArray(t.index))for(a=0;a<t.index.length;++a){var s=t.index[a],o=e[a],h=this.Data.Data[s];o!=h&&(this.Data.Data[s]=o)}var l=this.ChartPaint[0];if(l){var u=!0;u&&this.Draw()}},this.ShowPageInfo=function(t){var e=this.ChartPaint[1];return!!e&&(e.IsShow=t,!0)}}function $n(){this.ChartBorder,this.Canvas,this.BorderLine=null,this.BorderColor=Oi.Report.BorderColor,this.LogoTextColor=Oi.FrameLogo.TextColor,this.LogoTextFont=Oi.FrameLogo.Font,this.ReloadResource=function(t){this.BorderColor=Oi.Report.BorderColor,this.LogoTextColor=Oi.FrameLogo.TextColor,this.LogoTextFont=Oi.FrameLogo.Font},this.Draw=function(){var t=Q(this.ChartBorder.GetLeft()),e=Q(this.ChartBorder.GetTop()),a=Q(this.ChartBorder.GetRight()),i=Q(this.ChartBorder.GetBottom()),r=a-t,n=i-e;ha.IsNumber(this.BorderLine)?(this.Canvas.strokeStyle=this.BorderColor,this.Canvas.beginPath(),(1&this.BorderLine)>0&&(this.Canvas.moveTo(t,e),this.Canvas.lineTo(a,e)),(2&this.BorderLine)>0&&(this.Canvas.moveTo(t,i),this.Canvas.lineTo(a,i)),(4&this.BorderLine)>0&&(this.Canvas.moveTo(t,e),this.Canvas.lineTo(t,i)),(8&this.BorderLine)>0&&(this.Canvas.moveTo(a,e),this.Canvas.lineTo(a,i)),this.Canvas.stroke()):(this.Canvas.strokeStyle=this.BorderColor,this.Canvas.strokeRect(t,e,r,n))},this.DrawLogo=function(){var t=Oi.FrameLogo.Text;if(ha.IsString(t)){this.Canvas.fillStyle=this.LogoTextColor,this.Canvas.font=this.LogoTextFont,this.Canvas.textAlign="right",this.Canvas.textBaseline="bottom";var e=this.ChartBorder.GetRight()-30,a=this.ChartBorder.GetBottom()-5;this.Canvas.fillText(t,e,a)}}}Zn.Init=function(t){var e=new Zn(t);return e.OnSize(),e},Zn.SetStyle=function(t){t&&Oi.SetStyle(t)},Zn.GetResource=function(){return Oi};var ts={SYMBOL_ID:0,NAME_ID:1,PRICE_ID:2,VOL_ID:3,INCREASE_ID:4,UPDOWN_ID:5,BUY_PRICE_ID:6,SELL_PRICE_ID:7,AMOUNT_ID:8,BUY_VOL_ID:9,SELL_VOL_ID:10,YCLOSE_ID:11,OPEN_ID:12,HIGH_ID:13,LOW_ID:14,AVERAGE_PRICE_ID:15,INDEX_ID:16,OUTSTANDING_SHARES_ID:17,TOTAL_SHARES_ID:18,CIRC_MARKET_VALUE_ID:19,MARKET_VALUE_ID:20,EXCHANGE_RATE_ID:21,AMPLITUDE_ID:22,LIMIT_HIGH_ID:23,LIMIT_LOW_ID:24,VOL_IN_ID:25,VOL_OUT_ID:26,SYMBOL_NAME_ID:27,CUSTOM_STRING_TEXT_ID:100,CUSTOM_NUMBER_TEXT_ID:101,CUSTOM_DATETIME_TEXT_ID:102},es=new E.default([[ts.SYMBOL_ID,"Symbol"],[ts.NAME_ID,"Name"],[ts.PRICE_ID,"Price"],[ts.INCREASE_ID,"Increase"],[ts.UPDOWN_ID,"UpDown"],[ts.VOL_ID,"Vol"],[ts.BUY_PRICE_ID,"BuyPrice"],[ts.SELL_PRICE_ID,"SellPrice"],[ts.AMOUNT_ID,"Amount"],[ts.BUY_VOL_ID,"BuyVol"],[ts.SELL_VOL_ID,"SellVol"],[ts.YCLOSE_ID,"YClose"],[ts.OPEN_ID,"Open"],[ts.HIGH_ID,"High"],[ts.LOW_ID,"Low"],[ts.AVERAGE_PRICE_ID,"AvPrice"],[ts.OUTSTANDING_SHARES_ID,"OutShares"],[ts.TOTAL_SHARES_ID,"TotalShares"],[ts.CIRC_MARKET_VALUE_ID,"CircMarketValue"],[ts.MARKET_VALUE_ID,"MarketValue"],[ts.EXCHANGE_RATE_ID,"Exchange"],[ts.AMPLITUDE_ID,"Amplitude"],[ts.LIMIT_HIGH_ID,"LimitHigh"],[ts.LIMIT_LOW_ID,"LimitLow"],[ts.VOL_IN_ID,"VolIn"],[ts.VOL_OUT_ID,"VolOut"]]);function as(){this.Canvas,this.ChartBorder,this.ChartFrame,this.Name,this.ClassName="ChartReport",this.UIElement,this.IsDrawFirst=!1,this.GetEventCallback,this.GetStockDataCallback,this.GetBlockDataCallback,this.Data,this.FixedRowData,this.SortInfo,this.FixedColumn=2,this.FixedRowCount=0,this.IsShowHeader=!0,this.SizeChange=!0,this.SelectedModel=0,this.SelectedRow=-1,this.SelectedFixedRow=-1,this.IsDrawBorder=1,this.ShowSymbol=[],this.DragRow,this.Tab,this.UpColor=Oi.Report.UpTextColor,this.DownColor=Oi.Report.DownTextColor,this.UnchagneColor=Oi.Report.UnchagneTextColor,this.BorderColor=Oi.Report.BorderColor,this.SelectedColor=Oi.Report.SelectedColor,this.HeaderFontConfig={Size:Oi.Report.Header.Font.Size,Name:Oi.Report.Header.Font.Name},this.HeaderColor=Oi.Report.Header.Color,this.SortColor=Oi.Report.Header.SortColor,this.HeaderMergin={Left:Oi.Report.Header.Mergin.Left,Right:Oi.Report.Header.Mergin.Right,Top:Oi.Report.Header.Mergin.Top,Bottom:Oi.Report.Header.Mergin.Bottom},this.ItemFontConfig={Size:Oi.Report.Item.Font.Size,Name:Oi.Report.Item.Font.Name},this.ItemFixedFontConfg={Size:Oi.Report.FixedItem.Font.Size,Name:Oi.Report.FixedItem.Font.Name},this.ItemMergin={Left:Oi.Report.Item.Mergin.Left,Right:Oi.Report.Item.Mergin.Right,Top:Oi.Report.Item.Mergin.Top,Bottom:Oi.Report.Item.Mergin.Bottom},this.BarMergin={Top:Oi.Report.Item.BarMergin.Top,Left:Oi.Report.Item.BarMergin.Left,Right:Oi.Report.Item.BarMergin.Right,Bottom:Oi.Report.Item.BarMergin.Bottom},this.LimitBorderColor=Oi.Report.LimitBorder.Color,this.LimitMergin={Top:Oi.Report.LimitBorder.Mergin.Top,Left:Oi.Report.LimitBorder.Mergin.Left,Right:Oi.Report.LimitBorder.Mergin.Right,Bottom:Oi.Report.LimitBorder.Mergin.Bottom},this.DragRowColor=Oi.Report.DragRow.Color,this.DragRowTextColor=Oi.Report.DragRow.TextColor,this.DragMoveRowColor=Oi.Report.DragRow.MoveRowColor,this.DragSrcRowColor=Oi.Report.DragRow.SrcRowColor,this.ItemSymbolFontConfig={Size:Oi.Report.Item.SymbolFont.Size,Name:Oi.Report.Item.SymbolFont.Name},this.ItemNameFontConfg={Size:Oi.Report.Item.NameFont.Size,Name:Oi.Report.Item.NameFont.Name},this.HeaderFont=12*U()+"px å¾®è½¯éé»",this.ItemFont=15*U()+"px å¾®è½¯éé»",this.ItemFixedFont=15*U()+"px å¾®è½¯éé»",this.ItemSymbolFont=12*U()+"px å¾®è½¯éé»",this.ItemNameFont=15*U()+"px å¾®è½¯éé»",this.ItemNameHeight=0,this.RowCount=0,this.HeaderHeight=0,this.FixedRowHeight=0,this.RowHeight=0,this.BottomToolbarHeight=0,this.IsShowAllColumn=!1,this.Column=[{Type:ts.INDEX_ID,Title:"åºå·",TextAlign:"center",Width:null,TextColor:Oi.Report.FieldColor.Index,MaxText:"8888"},{Type:ts.SYMBOL_ID,Title:"ä»£ç ",TextAlign:"left",Width:null,TextColor:Oi.Report.FieldColor.Symbol,MaxText:"888888"},{Type:ts.NAME_ID,Title:"åç§°",TextAlign:"left",Width:null,TextColor:Oi.Report.FieldColor.Name,MaxText:"ææææ"},{Type:ts.INCREASE_ID,Title:"æ¶¨å¹%",TextAlign:"right",Width:null,MaxText:"-888.88"}],this.RectClient={},this.ReloadResource=function(t){this.UpColor=Oi.Report.UpTextColor,this.DownColor=Oi.Report.DownTextColor,this.UnchagneColor=Oi.Report.UnchagneTextColor,this.BorderColor=Oi.Report.BorderColor,this.SelectedColor=Oi.Report.SelectedColor,this.HeaderFontConfig={Size:Oi.Report.Header.Font.Size,Name:Oi.Report.Header.Font.Name},this.HeaderColor=Oi.Report.Header.Color,this.SortColor=Oi.Report.Header.SortColor,this.HeaderMergin={Left:Oi.Report.Header.Mergin.Left,Right:Oi.Report.Header.Mergin.Right,Top:Oi.Report.Header.Mergin.Top,Bottom:Oi.Report.Header.Mergin.Bottom},this.ItemFontConfig={Size:Oi.Report.Item.Font.Size,Name:Oi.Report.Item.Font.Name},this.ItemMergin={Left:Oi.Report.Item.Mergin.Left,Right:Oi.Report.Item.Mergin.Right,Top:Oi.Report.Item.Mergin.Top,Bottom:Oi.Report.Item.Mergin.Bottom},this.BarMergin={Top:Oi.Report.Item.BarMergin.Top,Left:Oi.Report.Item.BarMergin.Left,Right:Oi.Report.Item.BarMergin.Right,Bottom:Oi.Report.Item.BarMergin.Bottom},this.LimitBorderColor=Oi.Report.LimitBorder.Color,this.LimitMergin={Top:Oi.Report.LimitBorder.Mergin.Top,Left:Oi.Report.LimitBorder.Mergin.Left,Right:Oi.Report.LimitBorder.Mergin.Right,Bottom:Oi.Report.LimitBorder.Mergin.Bottom};for(var e=0;e<this.Column.length;++e){var a=this.Column[e];a.Type==ts.INDEX_ID?a.TextColor=Oi.Report.FieldColor.Index:a.Type==ts.SYMBOL_ID?a.TextColor=Oi.Report.FieldColor.Symbol:a.Type==ts.NAME_ID?a.TextColor=Oi.Report.FieldColor.Name:a.Type==ts.VOL_ID||a.Type==ts.BUY_VOL_ID||a.Type==ts.SELL_VOL_ID?a.TextColor=Oi.Report.FieldColor.Vol:a.Type==ts.AMOUNT_ID?a.TextColor=Oi.Report.FieldColor.Amount:a.Type==ts.VOL_IN_ID?a.TextColor=Oi.Report.DownTextColor:a.Type==ts.VOL_OUT_ID?a.TextColor=Oi.Report.UpTextColor:a.TextColor=Oi.Report.FieldColor.Text}this.Tab&&this.Tab.ReloadResource(t)},this.SetColumn=function(t){if(ha.IsNonEmptyArray(t)){this.Column=[];for(var e=0;e<t.length;++e){var a=t[e],i=this.GetDefaultColunm(a.Type);if(i){if(a.Title&&(i.Title=a.Title),a.TextAlign&&(i.TextAlign=a.TextAlign),a.TextColor&&(i.TextColor=a.TextColor),a.MaxText&&(i.MaxText=a.MaxText),a.ID&&(i.ID=a.ID),ha.IsNumber(a.Sort)&&(i.Sort=a.Sort),1!=a.Sort&&2!=a.Sort||(i.SortType=[1,2],ha.IsNonEmptyArray(a.SortType)&&(i.SortType=a.SortType.slice())),a.Type==ts.CUSTOM_STRING_TEXT_ID){if(!ha.IsNumber(a.DataIndex)&&!ha.IsNumber(a.BlockIndex))continue;ha.IsNumber(a.DataIndex)&&(i.DataIndex=a.DataIndex),ha.IsNumber(a.BlockIndex)&&(i.BlockIndex=a.BlockIndex),i.IsDrawCallback=!1,ha.IsBool(a.IsDrawCallback)&&(i.IsDrawCallback=a.IsDrawCallback)}else if(a.Type==ts.CUSTOM_NUMBER_TEXT_ID){if(!ha.IsNumber(a.DataIndex)&&!ha.IsNumber(a.BlockIndex))continue;ha.IsNumber(a.DataIndex)&&(i.DataIndex=a.DataIndex),ha.IsNumber(a.BlockIndex)&&(i.BlockIndex=a.BlockIndex),i.Decimal=2,i.FormatType=0,i.ColorType=0,i.IsDrawCallback=!1,ha.IsNumber(a.Decimal)&&(i.Decimal=a.Decimal),ha.IsNumber(a.FormatType)&&(i.FormatType=a.FormatType),ha.IsNumber(a.ColorType)&&(i.ColorType=a.ColorType),ha.IsBool(a.IsDrawCallback)&&(i.IsDrawCallback=a.IsDrawCallback)}else if(a.Type==ts.CUSTOM_DATETIME_TEXT_ID){if(!ha.IsNumber(a.DataIndex)&&!ha.IsNumber(a.BlockIndex))continue;ha.IsNumber(a.DataIndex)&&(i.DataIndex=a.DataIndex),ha.IsNumber(a.BlockIndex)&&(i.BlockIndex=a.BlockIndex),i.FormatType=0,i.ValueType=0,i.IsDrawCallback=!1,ha.IsNumber(a.FormatType)&&(i.FormatType=a.FormatType),ha.IsNumber(a.ValueType)&&(i.FormatType=a.ValueType),ha.IsBool(a.IsDrawCallback)&&(i.IsDrawCallback=a.IsDrawCallback)}this.Column.push(i)}}}},this.GetXScrollPos=function(){return this.Data.XOffset},this.GetXScrollRange=function(){var t=this.Column.length-this.FixedColumn-3;return t<0?0:t},this.GetDefaultColunm=function(t){for(var e=[{Type:ts.INDEX_ID,Title:"åºå·",TextAlign:"center",Width:null,TextColor:Oi.Report.FieldColor.Index,MaxText:"8888"},{Type:ts.SYMBOL_ID,Title:"ä»£ç ",TextAlign:"left",Width:null,TextColor:Oi.Report.FieldColor.Symbol,MaxText:"888888"},{Type:ts.NAME_ID,Title:"åç§°",TextAlign:"left",Width:null,TextColor:Oi.Report.FieldColor.Name,MaxText:"ææææ0"},{Type:ts.SYMBOL_NAME_ID,Title:"è¡ç¥¨åç§°",TextAlign:"left",Width:null,TextColor:Oi.Report.FieldColor.Name,MaxText:"ææææ0"},{Type:ts.INCREASE_ID,Title:"æ¶¨å¹%",TextAlign:"right",Width:null,MaxText:"-888.88"},{Type:ts.PRICE_ID,Title:"ç°ä»·",TextAlign:"right",Width:null,MaxText:"88888.88"},{Type:ts.UPDOWN_ID,Title:"æ¶¨è·",TextAlign:"right",Width:null,MaxText:"-888.88"},{Type:ts.AMPLITUDE_ID,Title:"æ¯å¹%",TextAlign:"right",Width:null,MaxText:"888.88"},{Type:ts.BUY_PRICE_ID,Title:"ä¹°ä»·",TextAlign:"right",Width:null,MaxText:"88888.88"},{Type:ts.SELL_PRICE_ID,Title:"åä»·",TextAlign:"right",Width:null,MaxText:"88888.88"},{Type:ts.AVERAGE_PRICE_ID,Title:"åä»·",TextAlign:"right",Width:null,MaxText:"88888.88"},{Type:ts.OPEN_ID,Title:"ä»å¼",TextAlign:"right",Width:null,MaxText:"88888.88"},{Type:ts.HIGH_ID,Title:"æé«",TextAlign:"right",Width:null,MaxText:"88888.88"},{Type:ts.LOW_ID,Title:"æä½",TextAlign:"right",Width:null,MaxText:"88888.88"},{Type:ts.YCLOSE_ID,Title:"æ¨æ¶",TextAlign:"right",Width:null,MaxText:"88888.88"},{Type:ts.VOL_ID,Title:"æ»é",TextAlign:"right",TextColor:Oi.Report.FieldColor.Vol,Width:null,MaxText:"8888.8æ"},{Type:ts.AMOUNT_ID,Title:"æ»éé¢",TextAlign:"right",TextColor:Oi.Report.FieldColor.Amount,Width:null,MaxText:"8888.8æ"},{Type:ts.EXCHANGE_RATE_ID,Title:"æ¢æ%",TextAlign:"right",TextColor:Oi.Report.FieldColor.Text,Width:null,MaxText:"88.88"},{Type:ts.OUTSTANDING_SHARES_ID,Title:"æµéè¡æ¬",TextAlign:"right",TextColor:Oi.Report.FieldColor.Text,Width:null,MaxText:"8888.8æ"},{Type:ts.TOTAL_SHARES_ID,Title:"æ»è¡æ¬",TextAlign:"right",TextColor:Oi.Report.FieldColor.Text,Width:null,MaxText:"8888.8æ"},{Type:ts.CIRC_MARKET_VALUE_ID,Title:"æµéå¸å¼",TextAlign:"right",TextColor:Oi.Report.FieldColor.Text,Width:null,MaxText:"8888.8æ"},{Type:ts.MARKET_VALUE_ID,Title:"æ»å¸å¼",TextAlign:"right",TextColor:Oi.Report.FieldColor.Text,Width:null,MaxText:"8888.8æ"},{Type:ts.VOL_IN_ID,Title:"åç",TextAlign:"right",TextColor:Oi.Report.DownTextColor,Width:null,MaxText:"8888.8æ"},{Type:ts.VOL_OUT_ID,Title:"å¤ç",TextAlign:"right",TextColor:Oi.Report.UpTextColor,Width:null,MaxText:"8888.8æ"},{Type:ts.BUY_VOL_ID,Title:"ä¹°é",TextAlign:"right",TextColor:Oi.Report.FieldColor.Vol,Width:null,MaxText:"8888.8æ"},{Type:ts.SELL_VOL_ID,Title:"åé",TextAlign:"right",TextColor:Oi.Report.FieldColor.Vol,Width:null,MaxText:"8888.8æ"},{Type:ts.CUSTOM_STRING_TEXT_ID,Title:"èªå®ä¹",TextAlign:"center",Width:null,TextColor:Oi.Report.FieldColor.Text,MaxText:"æææææ"},{Type:ts.CUSTOM_NUMBER_TEXT_ID,Title:"èªå®ä¹",TextAlign:"center",Width:null,TextColor:Oi.Report.FieldColor.Text,MaxText:"æææææ"},{Type:ts.CUSTOM_DATETIME_TEXT_ID,Title:"èªå®ä¹",TextAlign:"center",Width:null,TextColor:Oi.Report.FieldColor.Text,MaxText:"9999-99-99"}],a=0;a<e.length;++a){var i=e[a];if(i.Type==t)return i}return null},this.Draw=function(){if(this.ShowSymbol=[],this.SizeChange?this.CalculateSize():this.UpdateCacheData(),this.Canvas.save(),this.Canvas.beginPath(),this.Canvas.rect(this.RectClient.Left,this.RectClient.Top,this.RectClient.Right-this.RectClient.Left,this.RectClient.Bottom-this.RectClient.Top),this.Canvas.clip(),this.DrawHeader(),this.DrawBody(),this.Canvas.restore(),this.Tab&&this.BottomToolbarHeight>0){var t=this.ChartBorder.GetBottom();this.Tab.DrawTab(this.RectClient.Left,t-this.BottomToolbarHeight,this.RectClient.Right,t),this.Tab.DrawScrollbar(this.RectClient.Left,t-this.BottomToolbarHeight,this.RectClient.Right,t)}this.DrawBorder(),this.DrawDragRow(),this.SizeChange=!1},this.UpdateCacheData=function(){this.RectClient.Left=this.ChartBorder.GetLeft(),this.RectClient.Right=this.ChartBorder.GetRight(),this.RectClient.Top=this.ChartBorder.GetTop(),this.RectClient.Bottom=this.ChartBorder.GetBottom()-this.BottomToolbarHeight},this.GetPageSize=function(t){t&&this.CalculateSize();var e=this.RowCount;return e},this.GetCurrentPageStatus=function(){var t={Start:this.Data.YOffset,PageSize:this.RowCount,IsEnd:!1,SelectedRow:this.SelectedRow,IsSinglePage:!1,DataCount:0};return ha.IsNonEmptyArray(this.Data.Data)?(t.End=this.Data.YOffset+this.RowCount-1,t.IsSinglePage=this.Data.Data.length<=this.RowCount,t.DataCount=this.Data.Data.length,t.End>=this.Data.Data.length-1&&(t.IsEnd=!0),t.End>=this.Data.Data.length&&(t.End=this.Data.Data.length-1)):(t.Star=0,t.End=0,t.IsEnd=!0,t.IsSinglePage=!0),t},this.CalculateSize=function(){this.Tab&&this.Tab.IsShow?(this.Tab.CalculateSize(),this.BottomToolbarHeight=this.Tab.Height):this.BottomToolbarHeight=0,this.UpdateCacheData();var t=U();this.HeaderFont=this.HeaderFontConfig.Size*t+"px "+this.HeaderFontConfig.Name,this.ItemFont=this.ItemFontConfig.Size*t+"px "+this.ItemFontConfig.Name,this.ItemFixedFont=this.ItemFixedFontConfg.Size*t+"px "+this.ItemFixedFontConfg.Name,this.ItemSymbolFont=this.ItemSymbolFontConfig.Size*t+"px "+this.ItemSymbolFontConfig.Name,this.ItemNameFont=this.ItemNameFontConfg.Size*t+"px "+this.ItemNameFontConfg.Name,this.RowHeight=this.GetFontHeight(this.ItemFont,"æ")+this.ItemMergin.Top+this.ItemMergin.Bottom,this.FixedRowHeight=this.GetFontHeight(this.ItemFixedFont,"æ")+this.ItemMergin.Top+this.ItemMergin.Bottom,this.Canvas.font=this.ItemFont;for(var e=0,a=0;a<this.Column.length;++a){var i=this.Column[a];if(i.Type==ts.SYMBOL_NAME_ID){this.Canvas.font=this.ItemNameFont;var r=this.Canvas.measureText(i.MaxText).width,n=this.GetFontHeight(this.ItemNameFont,"æ");this.ItemNameHeight=n,this.Canvas.font=this.ItemSymbolFont;var s=this.Canvas.measureText(i.MaxText).width,o=this.GetFontHeight(this.ItemSymbolFont,"æ");this.Canvas.font=this.ItemFont,e=Math.max(r,s),i.Width=e+4+this.ItemMergin.Left+this.ItemMergin.Right;var h=n+o+this.ItemMergin.Top+this.ItemMergin.Bottom;h>this.RowHeight&&(this.RowHeight=h),h>this.FixedRowHeight&&(this.FixedRowHeight=h)}else e=this.Canvas.measureText(i.MaxText).width,i.Width=e+4+this.ItemMergin.Left+this.ItemMergin.Right}this.Canvas.font=this.HeaderFont;for(a=0;a<this.Column.length;++a){i=this.Column[a];if(i.Title&&!(i.Title.length<=0)){var l=i.Title;i.Sort>0&&(l+="â"),e=this.Canvas.measureText(l).width,e+=4+this.HeaderMergin.Left+this.HeaderMergin.Right,i.Width<e&&(i.Width=e)}}this.HeaderHeight=this.GetFontHeight(this.HeaderFont,"æ")+this.HeaderMergin.Top+this.HeaderMergin.Bottom,this.IsShowHeader||(this.HeaderHeight=0),this.FixedRowCount<=0&&(this.FixedRowHeight=0),this.RowCount=parseInt((this.RectClient.Bottom-this.RectClient.Top-this.HeaderHeight-this.FixedRowHeight*this.FixedRowCount)/this.RowHeight);var u=0,C=this.RectClient.Right-this.RectClient.Left;for(a=0;a<this.Column.length;++a){i=this.Column[a];u+=i.Width}this.IsShowAllColumn=u<C},this.DrawHeader=function(){if(this.IsShowHeader){var t=this.RectClient.Left,e=this.RectClient.Top,a=e+this.HeaderMergin.Top+(this.HeaderHeight-this.HeaderMergin.Top-this.HeaderMergin.Bottom)/2;this.Canvas.font=this.HeaderFont,this.Canvas.fillStyle=this.HeaderColor;for(var i=t,r=0;r<this.FixedColumn&&r<this.Column.length;++r){var n=this.Column[r],s=n.Width,o=s-this.HeaderMergin.Left-this.HeaderMergin.Right,h=i+this.HeaderMergin.Left;this.SortInfo&&this.SortInfo.Field==r&&this.SortInfo.Sort>0?this.DrawSortHeader(n.Title,n.TextAlign,h,a,o,this.SortInfo.Sort):this.DrawText(n.Title,n.TextAlign,h,a,o),i+=n.Width}for(r=this.FixedColumn+this.Data.XOffset;r<this.Column.length;++r){n=this.Column[r],s=n.Width,o=s-this.HeaderMergin.Left-this.HeaderMergin.Right,h=i+this.HeaderMergin.Left;this.SortInfo&&this.SortInfo.Field==r&&this.SortInfo.Sort>0?this.DrawSortHeader(n.Title,n.TextAlign,h,a,o,this.SortInfo.Sort):this.DrawText(n.Title,n.TextAlign,h,a,o),i+=n.Width}}},this.DrawText=function(t,e,a,i,r){"center"==e?(a+=r/2,this.Canvas.textAlign="center"):"right"==e?(a+=r,this.Canvas.textAlign="right"):this.Canvas.textAlign="left",this.Canvas.textBaseline="middle",this.Canvas.fillText(t,a,i)},this.DrawSortHeader=function(t,e,a,i,r,n){var s=1==n?"â":"â",o=this.Canvas.measureText(s).width,h=this.Canvas.measureText(t).width+2;this.Canvas.textBaseline="middle",this.Canvas.textAlign="left","center"==e?a=a+r/2-(o+h)/2:"right"==e&&(a=a+r-o-h),this.Canvas.fillText(t,a,i),this.Canvas.fillStyle=this.SortColor,this.Canvas.fillText(s,a+h,i),this.Canvas.fillStyle=this.HeaderColor},this.DrawBorder=function(){if(this.IsDrawBorder){var t=this.RectClient.Left,e=this.RectClient.Right,a=this.RectClient.Top;this.RectClient.Bottom;this.Canvas.strokeStyle=this.BorderColor,this.Canvas.beginPath(),this.Canvas.moveTo(t,Q(a+this.HeaderHeight)),this.Canvas.lineTo(e,Q(a+this.HeaderHeight));for(var i=a+this.HeaderHeight+this.RowHeight,r=i,n=0;n<this.FixedRowCount;++n){var s=Q(i);this.Canvas.moveTo(t,s),this.Canvas.lineTo(e,s),r=i,i+=this.FixedRowHeight}for(i=a+this.HeaderHeight+this.RowHeight+this.FixedRowHeight*this.FixedRowCount,r=i,n=0;n<this.RowCount;++n){s=Q(i);this.Canvas.moveTo(t,s),this.Canvas.lineTo(e,s),r=i,i+=this.RowHeight}var o=t;for(n=0;n<this.FixedColumn&&n<this.Column.length;++n){var h=this.Column[n],l=Q(o+h.Width);this.Canvas.moveTo(l,a),this.Canvas.lineTo(l,r),o+=h.Width}for(n=this.FixedColumn+this.Data.XOffset;n<this.Column.length;++n){h=this.Column[n],l=Q(o+h.Width);this.Canvas.moveTo(l,a),this.Canvas.lineTo(l,r),o+=h.Width}this.Canvas.stroke()}},this.DrawBody=function(){if(this.Data&&ha.IsNonEmptyArray(this.Data.Data)){this.Canvas.font=this.ItemFont;var t=this.RectClient.Top+this.HeaderHeight,e=this.RectClient.Left,a=this.RectClient.Right-this.RectClient.Left,i=t;this.Canvas.font=this.ItemFixedFont;for(var r=0;r<this.FixedRowCount;++r)this.SelectedFixedRow==r&&(this.Canvas.fillStyle=this.SelectedColor,this.Canvas.fillRect(e,i,a,this.FixedRowHeight)),1==this.FixedRowData.Type?this.DrawFixedSymbolRow(i,r):this.DrawFixedRow(i,r),i+=this.FixedRowHeight;i=t+this.FixedRowHeight*this.FixedRowCount,this.Canvas.font=this.ItemFont;r=this.Data.YOffset;for(var n=0;r<this.Data.Data.length&&n<this.RowCount;++r,++n){var s=this.Data.Data[r],o=!1;if(0==this.SelectedModel?n==this.SelectedRow&&(o=!0):r==this.SelectedRow&&(o=!0),this.DragRow){if(this.DragRow.Data){var h=this.DragRow.Data.Row.DataIndex;h==r&&(this.Canvas.fillStyle=this.DragSrcRowColor,this.Canvas.fillRect(e,i,a,this.RowHeight))}if(this.DragRow.MoveRow){h=this.DragRow.MoveRow.Data.DataIndex;h==r&&(this.Canvas.fillStyle=this.DragMoveRowColor,this.Canvas.fillRect(e,i,a,this.RowHeight))}o=!1}o&&(this.Canvas.fillStyle=this.SelectedColor,this.Canvas.fillRect(e,i,a,this.RowHeight)),this.DrawRow(s,i,r),this.ShowSymbol.push({Index:r,Symbol:s}),i+=this.RowHeight}}},this.DrawFixedSymbolRow=function(t,e){this.RectClient.Left,this.RectClient.Right;if(this.FixedRowData&&ha.IsNonEmptyArray(this.FixedRowData.Symbol)){var a=this.FixedRowData.Symbol[e];a&&(this.DrawRow(a,t,e,1),this.ShowSymbol.push({Index:e,Symbol:a,RowType:1}))}},this.DrawFixedRow=function(t,e){for(var a=this.RectClient.Left,i=this.RectClient.Right,r=0;r<this.FixedColumn&&r<this.Column.length;++r){var n=this.Column[r];if(this.DrawFixedItem(e,r,n,a,t),a+=n.Width,a>=i)break}for(r=this.FixedColumn+this.Data.XOffset;r<this.Column.length;++r){n=this.Column[r];if(this.DrawFixedItem(e,r,n,a,t),a+=n.Width,a>=i)break}},this.DrawFixedItem=function(t,e,a,i,r){var n=i+this.ItemMergin.Left,s=a.Width-this.ItemMergin.Left-this.ItemMergin.Right,o={Text:null,TextColor:a.TextColor,TextAlign:a.TextAlign};if(this.GetFixedRowTextDrawInfo(t,e,a,o))this.DrawItemText(o.Text,o.TextColor,o.TextAlign,n,r,s);else if(this.FixedRowData&&ha.IsNonEmptyArray(this.FixedRowData.Data)){var h=this.FixedRowData.Data,l=h[t];if(ha.IsNonEmptyArray(l)){var u=l[e];u&&u.Text&&(o.Text=u.Text,u.Color&&(o.TextColor=u.Color),u.TextAlign&&(o.TextAlign=u.TextAlign),this.DrawItemText(o.Text,o.TextColor,o.TextAlign,n,r,s))}}},this.DrawRow=function(t,e,a,i){var r=this.RectClient.Left,n=this.RectClient.Right,s={Symbol:t,Stock:null,Block:null};this.GetStockDataCallback&&(s.Stock=this.GetStockDataCallback(t)),this.GetBlockDataCallback&&(s.Block=this.GetBlockDataCallback(t)),s.Decimal=rn(t);for(var o=0;o<this.FixedColumn&&o<this.Column.length;++o){var h=this.Column[o];if(this.DrawItem(a,s,h,r,e,i),r+=h.Width,r>=n)break}for(o=this.FixedColumn+this.Data.XOffset;o<this.Column.length;++o){h=this.Column[o];if(this.DrawItem(a,s,h,r,e,i),r+=h.Width,r>=n)break}},this.DrawItem=function(t,e,a,i,r,n){a.Width;var s=i+this.ItemMergin.Left,o=a.Width-this.ItemMergin.Left-this.ItemMergin.Right,h=e.Stock,l={Text:null,TextColor:a.TextColor,TextAlign:a.TextAlign};if(a.Type==ts.INDEX_ID){if(1==n)return;l.Text=(t+1).toString()}else if(a.Type==ts.SYMBOL_ID)h&&h.Symbol?l.Text=h.Symbol:l.Text=e.Symbol;else if(a.Type==ts.SYMBOL_NAME_ID)this.DrawSymbolName(e,a,i,r,n);else if(a.Type==ts.NAME_ID)h&&h.Name&&(l.Text=this.TextEllipsis(h.Name,o,a.MaxText),l.TextColor=this.GetNameColor(a,e.Symbol,n));else if(a.Type==ts.PRICE_ID)h&&this.GetPriceDrawInfo(h.Price,h,e,l);else if(a.Type==ts.OPEN_ID)h&&(this.DrawLimitPriceBorder(h.Open,h,i,r,a.Width),this.GetPriceDrawInfo(h.Open,h,e,l));else if(a.Type==ts.HIGH_ID)h&&(this.DrawLimitPriceBorder(h.High,h,i,r,a.Width),this.GetPriceDrawInfo(h.High,h,e,l));else if(a.Type==ts.LOW_ID)h&&(this.DrawLimitPriceBorder(h.Low,h,i,r,a.Width),this.GetPriceDrawInfo(h.Low,h,e,l));else if(a.Type==ts.YCLOSE_ID)h&&this.GetPriceDrawInfo(h.YClose,h,e,l);else if(a.Type==ts.BUY_PRICE_ID)h&&this.GetPriceDrawInfo(h.BuyPrice,h,e,l);else if(a.Type==ts.SELL_PRICE_ID)h&&this.GetPriceDrawInfo(h.SellPrice,h,e,l);else if(a.Type==ts.AVERAGE_PRICE_ID)h&&this.GetPriceDrawInfo(h.AvPrice,h,e,l);else if(a.Type==ts.EXCHANGE_RATE_ID)h&&ha.IsNumber(h.Exchange)&&(l.Text=h.Exchange.toFixed(2));else if(a.Type==ts.BUY_VOL_ID)h&&ha.IsNumber(h.BuyVol)&&(l.Text=this.FormatVolString(h.BuyVol));else if(a.Type==ts.SELL_VOL_ID)h&&ha.IsNumber(h.SellVol)&&(l.Text=this.FormatVolString(h.SellVol));else if(a.Type==ts.VOL_ID)h&&ha.IsNumber(h.Vol)&&(l.Text=this.FormatVolString(h.Vol));else if(a.Type==ts.VOL_IN_ID)h&&ha.IsNumber(h.VolIn)&&(l.Text=this.FormatVolString(h.VolIn));else if(a.Type==ts.VOL_OUT_ID)h&&ha.IsNumber(h.VolOut)&&(l.Text=this.FormatVolString(h.VolOut));else if(a.Type==ts.TOTAL_SHARES_ID)h&&ha.IsNumber(h.TotalShares)&&(l.Text=this.FormatVolString(h.TotalShares));else if(a.Type==ts.OUTSTANDING_SHARES_ID)h&&ha.IsNumber(h.OutShares)&&(l.Text=this.FormatVolString(h.OutShares));else if(a.Type==ts.CIRC_MARKET_VALUE_ID||a.Type==ts.MARKET_VALUE_ID||a.Type==ts.AMOUNT_ID){var u=es.get(a.Type);h&&ha.IsNumber(h[u])&&(l.Text=this.FormatVolString(h[u]))}else if(a.Type==ts.INCREASE_ID||a.Type==ts.AMPLITUDE_ID||a.Type==ts.UPDOWN_ID){u=es.get(a.Type);if(h&&ha.IsNumber(h[u])){var C=h[u];l.Text=C.toFixed(2),l.TextColor=this.GetUpDownColor(C,0)}}else a.Type==ts.CUSTOM_STRING_TEXT_ID?this.GetCustomStringDrawInfo(e,a,l):a.Type==ts.CUSTOM_NUMBER_TEXT_ID?this.GetCustomNumberDrawInfo(e,a,l):a.Type==ts.CUSTOM_DATETIME_TEXT_ID&&this.GetCustomDateTimeDrawInfo(e,a,l);3==n&&(l.TextColor=this.DragRowTextColor),this.DrawItemText(l.Text,l.TextColor,l.TextAlign,s,r,o)},this.DrawSymbolName=function(t,e,a,i,r){var n,s=t.Stock,o=t.Symbol;if(s&&(o=s.Symbol,n=s.Name),o||n){var h=i+this.ItemMergin.Top+this.ItemNameHeight,l=a+this.ItemMergin.Left,u=l,C=e.Width-this.ItemMergin.Left-this.ItemMergin.Right,D=e.TextAlign;"center"==D?(u=l+C/2,this.Canvas.textAlign="center"):"right"==D?(u=l+C-2,this.Canvas.textAlign="right"):(u+=2,this.Canvas.textAlign="left");var f=this.GetNameColor(e,o,r),c=n;c&&(this.Canvas.textBaseline="ideographic",this.Canvas.fillStyle=f,this.Canvas.font=this.ItemNameFont,c=this.TextEllipsis(c,C,e.MaxText),c&&this.Canvas.fillText(c,u,h)),c=o,c&&(this.Canvas.textBaseline="top",this.Canvas.font=this.ItemSymbolFont,this.Canvas.fillStyle=f,this.Canvas.fillText(c,u,h)),this.Canvas.font=this.ItemFont}},this.DrawLimitPriceBorder=function(t,e,a,i,r){if(ha.IsNumber(t)&&e){var n=!1;if(ha.IsNumber(e.LimitHigh)&&t>=e.LimitHigh&&(n=!0),ha.IsNumber(e.LimitLow)&&t<=e.LimitLow&&(n=!0),n){var s=a+this.ItemMergin.Left+this.LimitMergin.Left,o=r-this.ItemMergin.Left-this.ItemMergin.Right-this.LimitMergin.Left-this.LimitMergin.Right,h=i+this.ItemMergin.Top+this.LimitMergin.Top,l=this.RowHeight-this.ItemMergin.Top-this.ItemMergin.Bottom-this.LimitMergin.Top-this.LimitMergin.Bottom;this.Canvas.strokeStyle=this.LimitBorderColor,this.Canvas.strokeRect(Q(s),Q(h),tt(o),tt(l))}}},this.GetExtendData=function(t,e){if(ha.IsNumber(e.DataIndex)){if(!t.Stock||!t.Stock.ExtendData)return null;if(e.DataIndex<0)return;return t.Stock.ExtendData[e.DataIndex]}if(ha.IsNumber(e.BlockIndex)){if(!t.Block)return;if(e.BlockIndex<0)return;return t.Block[e.BlockIndex]}return null},this.GetCustomStringDrawInfo=function(t,e,a){var i=this.GetExtendData(t,e);ha.IsString(i)&&(e.IsDrawCallback?this.GetCustomTextDrawInfo(e,t.Symbol,i,a,t):a.Text=i)},this.GetCustomNumberDrawInfo=function(t,e,a){var i=this.GetExtendData(t,e);if(ha.IsNumber(i))if(e.IsDrawCallback)this.GetCustomTextDrawInfo(e,t.Symbol,i,a,t);else{switch(e.FormatType){case 1:a.Text=i.toFixed(e.Decimal);break;case 2:a.Text=ha.FormatValueThousandsString(i,e.Decimal);break;case 3:a.Text=this.FormatVolString(i);break;default:a.Text=ha.FormatValueString(i,e.Decimal);break}switch(e.ColorType){case 1:a.TextColor=this.GetUpDownColor(i,0);break;case 2:ha.IsNumber(t.Stock.YClose)?a.TextColor=this.GetUpDownColor(i,t.Stock.YClose):a.TextColor=this.UnchagneColor;break;default:break}}},this.GetCustomDateTimeDrawInfo=function(t,e,a){var i=this.GetExtendData(t,e);ha.IsNumber(i)&&(e.IsDrawCallback?this.GetCustomTextDrawInfo(e,t.Symbol,i,a,t):0==e.ValueType&&(1==e.FormatType?a.Text=ha.FormatDateString(i,"YYYY/MM/DD"):a.Text=ha.FormatDateString(i)))},this.GetPriceDrawInfo=function(t,e,a,i){if(!ha.IsNumber(t))return!1;i.Text=t.toFixed(a.Decimal),ha.IsNumber(e.YClose)?i.TextColor=this.GetUpDownColor(t,e.YClose):i.TextColor=this.UnchagneColor},this.GetUpDownColor=function(t,e){return t>e?this.UpColor:t<e?this.DownColor:this.UnchagneColor},this.FormatVolString=function(t,e){return ha.FormatVolString(t,e)},this.DrawItemText=function(t,e,a,i,r,n){if(t){var s=i;"center"==a?(s=i+n/2,this.Canvas.textAlign="center"):"right"==a?(s=i+n-2,this.Canvas.textAlign="right"):(s+=2,this.Canvas.textAlign="left"),this.Canvas.textBaseline="middle",this.Canvas.fillStyle=e,this.Canvas.fillText(t,s,r+this.ItemMergin.Top+this.RowHeight/2)}},this.TextEllipsis=function(t,e,a){if(!t)return null;if(t.length<a.length)return t;var i=a.length-3;if(i<0)return null;for(var r=t.slice(0,i),n=i;n<t.length;++n){var s=r+t[n]+"...",o=this.Canvas.measureText(s).width;if(o>e){r+="...";break}r+=t[n]}return r},this.DrawMultiBar=function(t,e,a){if(!e.Source||!ha.IsNonEmptyArray(e.Source))return!1;var i=e.Source[t.DataIndex];if(!i)return!1;if(!ha.IsNonEmptyArray(i.Value))return!1;for(var r=a.Width-this.BarMergin.Left-this.BarMergin.Right,n=a.Left+this.BarMergin.Left,s=a.Top+this.RowMergin.Top+this.BarMergin.Top,o=a.Height-this.RowMergin.Top-this.RowMergin.Bottom-this.BarMergin.Top-this.BarMergin.Bottom,h=n+r,l=0;l<i.Value.length;++l){var u=i.Value[l];if(!(u<=0)){if(n>=h)break;var C=r*u;C<1&&(C=1),n+C>h&&(C=h-n);var D=l;ha.IsNonEmptyArray(i.Color)&&l<i.Color.length&&(D=i.Color[l]),this.Canvas.fillStyle=Oi.DealList.FieldColor.Bar[D],this.Canvas.fillRect(n,s,C,o),n+=C}}return!0},this.DrawCenterBar=function(t,e,a){if(!e.Source||!ha.IsNonEmptyArray(e.Source))return!1;var i=e.Source[t.DataIndex];if(!i)return!1;if(!ha.IsNonEmptyArray(i.Value))return!1;for(var r=(a.Width-this.BarMergin.Left-this.BarMergin.Right)/2,n=a.Left+this.BarMergin.Left,s=n+r,o=a.Top+this.RowMergin.Top+this.BarMergin.Top,h=a.Height-this.RowMergin.Top-this.RowMergin.Bottom-this.BarMergin.Top-this.BarMergin.Bottom,l=0;l<i.Value.length&&l<2;++l){var u=i.Value[l];if(!(u<=0)){u>1&&(u=1);var C=r*u;C<1&&(C=1);var D=l;ha.IsNonEmptyArray(i.Color)&&l<i.Color.length&&(D=i.Color[l]),this.Canvas.fillStyle=Oi.DealList.FieldColor.Bar[D],0==l?this.Canvas.fillRect(s,o,-C,h):this.Canvas.fillRect(s,o,C,h)}}},this.GetCustomTextDrawInfo=function(t,e,a,i,r){var n=this.GetEventCallback(G.ON_DRAW_CUSTOM_TEXT);if(!n||!n.Callback)return!1;var s={Symbol:e,Column:t,Value:a,Data:r,Out:{Text:null,TextColor:null,TextAlign:null}};return n.Callback(n,s,this),s.Out.Text&&(i.Text=s.Out.Text),s.Out.TextColor&&(i.TextColor=s.Out.TextColor),s.Out.TextAlign&&(i.TextAlign=s.Out.TextAlign),!0},this.GetFixedRowTextDrawInfo=function(t,e,a,i){var r=this.GetEventCallback(G.ON_DRAW_REPORT_FIXEDROW_TEXT);if(!r||!r.Callback)return!1;var n={RowIndex:t,ColIndex:e,Column:a,Data:this.FixedRowData,Out:{Text:null,TextColor:null,TextAlign:null}};return r.Callback(r,n,this),n.Out.Text&&(i.Text=n.Out.Text),n.Out.TextColor&&(i.TextColor=n.Out.TextColor),n.Out.TextAlign&&(i.TextAlign=n.Out.TextAlign),!0},this.GetVolColor=function(t,e){var a=this.GetEventCallback(G.ON_DRAW_DEAL_VOL_COLOR);if(a&&a.Callback){var i={Data:e,TextColor:null};if(a.Callback(a,i,this),i.TextColor)return i.TextColor}return t.TextColor},this.GetNameColor=function(t,e,a){var i=this.GetEventCallback(G.ON_DRAW_REPORT_NAME_COLOR);if(i&&i.Callback){var r={Symbol:e,TextColor:null,RowType:a};if(i.Callback(i,r,this),r.TextColor)return r.TextColor}return t.TextColor},this.GetFontHeight=function(t,e){return K(this.Canvas,t,e)},this.OnMouseDown=function(t,e,a){if(!this.Data)return null;if(this.Tab){var i=this.Tab.OnMouseDown(t,e,a);if(i)return{Type:1,Tab:i}}var r=U(),n={X:t/r,Y:e/r};if(this.UIElement)var s={Left:this.UIElement.getBoundingClientRect().left,Top:this.UIElement.getBoundingClientRect().top};else s={Left:null,Top:null};var o=this.PtInFixedBody(t,e);if(o){var h=!0,l=G.ON_CLICK_REPORT_FIXEDROW;return 2==a.button&&(l=G.ON_RCLICK_REPORT_FIXEDROW),this.SendClickEvent(l,{Data:o,X:t,Y:e,e:a,Inside:n,UIElement:s}),this.SelectedFixedRow=o.Index,this.SelectedRow=-1,{Type:4,Redraw:h,Row:o}}o=this.PtInBody(t,e);if(o){h=!0;0==this.SelectedModel?(this.SelectedRow==o.Index&&(h=!1),this.SelectedRow=o.Index,this.SelectedFixedRow=-1):(this.SelectedRow==o.DataIndex&&(h=!1),this.SelectedRow=o.DataIndex,this.SelectedFixedRow=-1);l=G.ON_CLICK_REPORT_ROW;return 2==a.button&&(l=G.ON_RCLICK_REPORT_ROW),this.SendClickEvent(l,{Data:o,X:t,Y:e,e:a,Inside:n,UIElement:s}),{Type:2,Redraw:h,Row:o}}var u=this.PtInHeader(t,e);if(u){l=G.ON_CLICK_REPORT_HEADER;return 2==a.button?l=G.ON_RCLICK_REPORT_HEADER:0==a.button&&(l=G.ON_CLICK_REPORT_HEADER),this.SendClickEvent(l,{Data:o,X:t,Y:e,e:a,Inside:n,UIElement:s}),{Type:3,Redraw:h,Header:u}}return null},this.OnDrawgRow=function(t,e,a){if(!this.Data)return null;if(!ha.IsNonEmptyArray(this.Data.Data))return null;var i=this.RowHeight/2,r=this.RectClient.Top+this.HeaderHeight,n=this.ChartBorder.GetChartWidth(),s=r+this.FixedRowHeight*this.FixedRowCount;if(e<s+i)return{Type:5};for(var o=this.Data.YOffset,h=0;o<this.Data.Data.length&&h<this.RowCount;++o,++h){var l=this.Data.Data[o],u={Left:0,Top:s,Right:n,Bottom:s+this.RowHeight};if(u.Top+=i,u.Bottom+=i,t>=u.Left&&t<=u.Right&&e>=u.Top&&e<=u.Bottom){var C={DataIndex:o,Index:h,Symbol:l,Pos:0};return 0==h?C.Pos=1:h==this.RowCount-1&&(C.Pos=2),{Type:2,Data:C}}s+=this.RowHeight}return h<this.RowCount?{Type:6}:{Type:7}},this.OnDblClick=function(t,e,a){if(!this.Data)return!1;var i=this.PtInBody(t,e);return!!i&&(this.SendClickEvent(G.ON_DBCLICK_REPORT_ROW,{Data:i,X:t,Y:e}),!0)},this.PtInBody=function(t,e){if(!this.Data)return null;if(!ha.IsNonEmptyArray(this.Data.Data))return null;for(var a=this.RectClient.Top+this.HeaderHeight,i=this.RectClient.Left,r=this.RectClient.Right,n=(this.RectClient.Right,this.RectClient.Left,a+this.FixedRowHeight*this.FixedRowCount),s=this.Data.YOffset,o=0;s<this.Data.Data.length&&o<this.RowCount;++s,++o){var h=this.Data.Data[s],l={Left:i,Top:n,Right:r,Bottom:n+this.RowHeight};if(t>=l.Left&&t<=l.Right&&e>=l.Top&&e<=l.Bottom){var u={Rect:l,DataIndex:s,Index:o,Symbol:h};return u.Item=this.PtInItem(t,e,l.Top,l.Bottom),u}n+=this.RowHeight}return null},this.PtInFixedBody=function(t,e){if(this.FixedRowCount<=0)return null;for(var a=this.RectClient.Top+this.HeaderHeight,i=this.RectClient.Left,r=this.RectClient.Right,n=(this.RectClient.Right,this.RectClient.Left,a),s=0;s<this.FixedRowCount;++s){var o={Left:i,Top:n,Right:r,Bottom:n+this.FixedRowHeight};if(t>=o.Left&&t<=o.Right&&e>=o.Top&&e<=o.Bottom){var h={Rect:o,Index:s};return h.Item=this.PtInItem(t,e,o.Top,o.Bottom),h}n+=this.FixedRowHeight}return null},this.PtInItem=function(t,e,a,i){for(var r=this.RectClient.Left,n=this.RectClient.Right,s=r,o=0;o<this.FixedColumn&&o<this.Column.length;++o){var h=this.Column[o],l={Left:s,Right:s+h.Width,Top:a,Bottom:i};if(t>=l.Left&&t<=l.Right&&e>=l.Top&&e<=l.Bottom)return{Rect:l,Column:h,Index:o};s+=h.Width}for(o=this.FixedColumn+this.Data.XOffset;o<this.Column.length;++o){h=this.Column[o];if(s>=n)break;l={Left:s,Right:s+h.Width,Top:a,Bottom:i};if(t>=l.Left&&t<=l.Right&&e>=l.Top&&e<=l.Bottom)return{Rect:l,Column:h,Index:o};s+=h.Width}return null},this.PtInHeader=function(t,e){if(!this.IsShowHeader)return null;var a=this.RectClient.Left,i=this.RectClient.Right,r=this.RectClient.Top,n=r+this.HeaderHeight;return t>=a&&t<=i&&e>=r&&e<=n?this.PtInItem(t,e,r,n):null},this.IsPtInBody=function(t,e){var a=this.RectClient.Top+this.HeaderHeight,i=this.RectClient.Left,r=this.RectClient.Right,n=this.RectClient.Bottom;return t>=i&&t<=r&&e>=a&&e<=n},this.IsPtInHeader=function(t,e){if(!this.IsShowHeader)return!1;var a=this.RectClient.Left,i=this.RectClient.Right,r=this.RectClient.Top,n=r+this.HeaderHeight;return t>=a&&t<=i&&e>=r&&e<=n},this.SendClickEvent=function(t,e){var a=this.GetEventCallback(t);a&&a.Callback&&a.Callback(a,e,this)},this.DrawDragRow=function(){if(this.DragRow){var t=this.DragRow;if(t.Data&&t.Inside&&t.Data.Row){var e=t.Data.Row.DataIndex;if(ha.IsNumber(e)&&!(e<0)){var a=t.Inside.Y-this.RowHeight/2,i=a,r=this.RectClient.Left,n=this.RectClient.Right-this.RectClient.Left;this.Canvas.fillStyle=this.DragRowColor,this.Canvas.fillRect(r,a,n,this.RowHeight);var s=this.Data.Data[e],o={Symbol:s,Stock:null,Block:null};this.GetStockDataCallback&&(o.Stock=this.GetStockDataCallback(s)),this.GetBlockDataCallback&&(o.Block=this.GetBlockDataCallback(s)),o.Decimal=rn(s);var h=this.RectClient.Right;this.Canvas.font=this.ItemFont;for(var l=0;l<this.FixedColumn&&l<this.Column.length;++l){var u=this.Column[l];if(this.DrawItem(e,o,u,r,i,3),r+=u.Width,r>=h)break}for(l=this.FixedColumn+this.Data.XOffset;l<this.Column.length;++l){u=this.Column[l];if(this.DrawItem(e,o,u,r,i,3),r+=u.Width,r>=h)break}}}}}}function is(){this.Canvas,this.ChartBorder,this.ChartFrame,this.Name,this.ClassName="ChartReportTab",this.IsDrawFirst=!1,this.GetEventCallback,this.Report,this.IsShow=!0,this.TabList=[],this.SelectedTabIndex=-1,this.MoveOnTabIndex=-1,this.MaxPos=15,this.CurrentPos=15,this.Step=1,this.ScrollBarWidth=Oi.Report.Tab.ScrollBarWidth,this.ButtonColor=Oi.Report.Tab.ButtonColor,this.BarColor=Oi.Report.Tab.BarColor,this.BorderColor=Oi.Report.Tab.BorderColor,this.Mergin={Left:2,Right:2,Top:2,Bottom:2},this.TabFontConfig={Size:Oi.Report.Tab.Font.Size,Name:Oi.Report.Tab.Font.Name},this.TabFont,this.TabTitleColor=Oi.Report.Tab.TabTitleColor,this.TabSelectedTitleColor=Oi.Report.Tab.TabSelectedTitleColor,this.TabSelectedBGColor=Oi.Report.Tab.TabSelectedBGColor,this.TabMoveOnTitleColor=Oi.Report.Tab.TabMoveOnTitleColor,this.TabBGColor=Oi.Report.Tab.TabBGColor,this.TabMergin={Top:Oi.Report.Tab.Mergin.Top,Left:Oi.Report.Tab.Mergin.Left,Right:Oi.Report.Tab.Mergin.Right,Bottom:Oi.Report.Tab.Mergin.Bottom},this.Height,this.ButtonSize=25,this.TabWidth=0,this.RectScroll={Left:null,Right:null,Bar:null,Client:null},this.ReloadResource=function(t){this.ScrollBarWidth=Oi.Report.Tab.ScrollBarWidth,this.ButtonColor=Oi.Report.Tab.ButtonColor,this.BarColor=Oi.Report.Tab.BarColor,this.BorderColor=Oi.Report.Tab.BorderColor,this.TabFontConfig={Size:Oi.Report.Tab.Font.Size,Name:Oi.Report.Tab.Font.Name},this.TabTitleColor=Oi.Report.Tab.TabTitleColor,this.TabSelectedTitleColor=Oi.Report.Tab.TabSelectedTitleColor,this.TabSelectedBGColor=Oi.Report.Tab.TabSelectedBGColor,this.TabMoveOnTitleColor=Oi.Report.Tab.TabMoveOnTitleColor,this.TabBGColor=Oi.Report.Tab.TabBGColor,this.TabMergin={Top:Oi.Report.Tab.Mergin.Top,Left:Oi.Report.Tab.Mergin.Left,Right:Oi.Report.Tab.Mergin.Right,Bottom:Oi.Report.Tab.Mergin.Bottom}},this.SetTabList=function(t){this.TabList=[];for(var e=0;e<t.length;++e){var a=t[e];if(a.Title){var i={Title:a.Title,IsMenu:!1,FixedSymbol:[],FixedRowCount:0};if(a.ID&&(i.ID=a.ID),a.MenuID&&(i.MenuID=a.MenuID),ha.IsBool(a.IsMenu)&&(i.IsMenu=a.IsMenu),ha.IsNonEmptyArray(a.FixedSymbol))for(var r=0;r<a.FixedSymbol.length;++r){var n=a.FixedSymbol[r];n&&n.Symbol&&(i.FixedSymbol.push(n),++i.FixedRowCount)}this.TabList.push(i)}}},this.CalculateSize=function(){var t=U();this.TabFont=this.TabFontConfig.Size*t+"px "+this.TabFontConfig.Name,this.Height=this.GetFontHeight(this.TabFont,"8")+this.Mergin.Top+this.Mergin.Bottom;var e=Math.min(25,this.Height-this.Mergin.Top-this.Mergin.Bottom);this.ButtonSize=e},this.DrawScrollbar=function(t,e,a,i){this.RectScroll={Left:null,Right:null,Bar:null,Client:null};var r=this.Report.GetXScrollPos(),n=this.Report.GetXScrollRange();if(!(n<=0)&&!this.Report.IsShowAllColumn){t=t+this.TabWidth;if(!(t+2*this.ScrollBarWidth>a)){this.MaxPos=n,this.CurrentPos=r;var s=this.ButtonSize,o={Left:t+this.Mergin.Left,Top:i-s-this.Mergin.Bottom,Width:s,Height:s};o.Right=o.Left+s,o.Bottom=o.Top+s;var h={Left:a-s-this.Mergin.Right,Top:o.Top,Width:s,Height:s};h.Right=h.Left+s,h.Bottom=h.Top+s,this.Canvas.fillStyle=this.ButtonColor,this.Canvas.fillRect(o.Left,o.Top,o.Width,o.Height),this.Canvas.fillRect(h.Left,h.Top,h.Width,h.Height),this.Canvas.strokeStyle=this.BorderColor,this.Canvas.strokeRect(o.Left,o.Top,o.Width,o.Height),this.Canvas.strokeRect(h.Left,h.Top,h.Width,h.Height);var l=h.Left-2-(o.Right+2),u=l-this.ScrollBarWidth,C=u*this.CurrentPos/this.MaxPos,D=o.Right+2+C,f={Left:D,Top:o.Top,Width:this.ScrollBarWidth,Height:o.Height};f.Right=f.Left+this.ScrollBarWidth,f.Bottom=o.Bottom,this.Canvas.fillStyle=this.BarColor,this.Canvas.fillRect(f.Left,f.Top,f.Width,f.Height),this.RectScroll.Left=o,this.RectScroll.Right=h,this.RectScroll.Bar=f,this.RectScroll.Client={Left:o.Right,Right:h.Left,Top:o.Top,Bottom:o.Bottom}}}},this.DrawTab=function(t,e,a,i){this.TabWidth=0,this.Canvas.font=this.TabFont,this.Canvas.textBaseline="bottom";var r,n=i-e,s=t+1,o=i-this.TabMergin.Bottom,h=0,l=0,u=0;for(u=0;u<this.TabList.length;++u){var C=this.TabList[u];r=C.Title,C.IsMenu&&(r+="â²"),h=s+this.TabMergin.Left,l=this.Canvas.measureText(r).width;var D={Left:s,Top:e,Width:l+this.TabMergin.Left+this.TabMergin.Right,Height:n};if(D.Right=D.Left+D.Width,D.Bottom=D.Top+D.Height,D.Right>a)break;var f=this.TabBGColor;u==this.SelectedTabIndex&&(f=this.TabSelectedBGColor),this.Canvas.fillStyle=f,this.Canvas.fillRect(D.Left,D.Top,D.Width,D.Height),this.Canvas.textAlign="left";var c=this.TabTitleColor;u==this.MoveOnTabIndex&&(c=this.TabMoveOnTitleColor),u==this.SelectedTabIndex&&(c=this.TabSelectedTitleColor),this.Canvas.fillStyle=c,this.Canvas.fillText(r,h,o),C.Rect=D,s+=D.Width+1,this.TabWidth+=D.Width+1}for(;u<this.TabList.length;++u){C=this.TabList[u];C.Rect=null}},this.OnMouseDown=function(t,e,a){var i=this.PtInTab(t,e);return i||this.PtInScroll(t,e)},this.PtInScroll=function(t,e){if(!this.RectScroll)return null;if(this.RectScroll.Left){var a=this.RectScroll.Left;if(t>=a.Left&&t<=a.Right&&e>=a.Top&&e<=a.Bottom)return{Type:1,Rect:a}}if(this.RectScroll.Right){a=this.RectScroll.Right;if(t>=a.Left&&t<=a.Right&&e>=a.Top&&e<=a.Bottom)return{Type:2,Rect:a}}if(this.RectScroll.Bar){a=this.RectScroll.Bar;if(t>=a.Left&&t<=a.Right&&e>=a.Top&&e<=a.Bottom)return{Type:3,Rect:a}}if(this.RectScroll.Client){a=this.RectScroll.Client;if(t>=a.Left&&t<=a.Right&&e>=a.Top&&e<=a.Bottom)return{Type:4,Rect:a,Pos:this.GetScrollPostionByPoint(t,e)}}return null},this.PtInTab=function(t,e){for(var a=0;a<this.TabList.length;++a){var i=this.TabList[a];if(i.Rect){var r=i.Rect;if(t>=r.Left&&t<=r.Right&&e>=r.Top&&e<=r.Bottom){var n={Type:5,Rect:r,Tab:i,Index:a};return 1==i.IsMenu&&n.Type,n}}}return null},this.GetFontHeight=function(t,e){return K(this.Canvas,t,e)},this.GetScrollPostionByPoint=function(t,e){var a=this.RectScroll.Client,i=a.Right-a.Left-this.ScrollBarWidth,r=parseInt(this.MaxPos*(t-a.Left)/i);return r}}function rs(){this.Canvas,this.ChartBorder,this.ChartFrame,this.Name,this.ClassName="ChartPageInfo",this.IsDrawFirst=!1,this.IsShow=!1,this.SizeChange=!0,this.Report,this.FontConfig={Size:Oi.Report.PageInfo.Font.Size,Name:Oi.Report.PageInfo.Font.Name},this.TextColor=Oi.Report.PageInfo.TextColor,this.BGColor=Oi.Report.PageInfo.BGColor,this.Mergin={Top:Oi.Report.PageInfo.Mergin.Top,Left:Oi.Report.PageInfo.Mergin.Left,Right:Oi.Report.PageInfo.Mergin.Right,Bottom:Oi.Report.PageInfo.Mergin.Bottom},this.Font,this.TextHeight=0,this.ReloadResource=function(t){this.FontConfig={Size:Oi.Report.PageInfo.Font.Size,Name:Oi.Report.PageInfo.Font.Name},this.TextColor=Oi.Report.PageInfo.TextColor,this.BGColor=Oi.Report.PageInfo.BGColor,this.Mergin={Top:Oi.Report.PageInfo.Mergin.Top,Left:Oi.Report.PageInfo.Mergin.Left,Right:Oi.Report.PageInfo.Mergin.Right,Bottom:Oi.Report.PageInfo.Mergin.Bottom}},this.Draw=function(){if(this.IsShow&&this.Report){var t=this.Report.GetCurrentPageStatus();if(!t.IsSinglePage){if(this.SizeChange){var e=U();this.Font=this.FontConfig.Size*e+"px "+this.FontConfig.Name,this.TextHeight=K(this.Canvas,this.Font,"æ")+this.Mergin.Top+this.Mergin.Bottom}var a=this.ChartBorder.GetLeft(),i=this.ChartBorder.GetRight(),r=this.ChartBorder.GetBottom()-2,n=a+(i-a)/2,s=t.DataCount+"/"+t.DataCount;this.Canvas.font=this.Font;var o=this.Canvas.measureText(s).width+4,h=n-o/2-this.Mergin.Left,l=r-this.TextHeight;this.Canvas.fillStyle=this.BGColor,this.Canvas.fillRect(h,l,o+(this.Mergin.Left+this.Mergin.Right),this.TextHeight),s=t.Start+1+"/"+t.DataCount,this.Canvas.textAlign="center",this.Canvas.textBaseline="bottom",this.Canvas.fillStyle=this.TextColor,this.Canvas.fillText(s,n,r-this.Mergin.Bottom),this.SizeChange=!1}}}}e.default=(r={jsChartInit:V.Init,jsChartStyle:V.SetStyle,JSChart:V,ChartData:Ot,HistoryData:xt,MARKET_SUFFIX_NAME:Br,IFrameSplitOperator:ha,FrameSplitKLinePriceY:la,FrameSplitKLineX:Ca,JSKLineInfoMap:lr,JSCHART_EVENT_ID:G,JSCHART_OPERATOR_ID:H,JSCHART_DATA_FIELD_ID:_,JSAlgorithm:Sn,JSComplier:Ln,JSIndexScript:B,GetDevicePixelRatio:U},(0,v.default)(r,"GetDevicePixelRatio",U),(0,v.default)(r,"ScriptIndexConsole",bn),(0,v.default)(r,"STYLE_TYPE_ID",Xn),(0,v.default)(r,"HQChartStyle",Wn),(0,v.default)(r,"JSConsole",w),(0,v.default)(r,"KLineTooltipPaint",ze),(0,v.default)(r,"MinuteTooltipPaint",qe),(0,v.default)(r,"ChartDrawTwoPointDemo",Fi),(0,v.default)(r,"ChartDrawThreePointDemo",yi),(0,v.default)(r,"CoordinateInfo",rt),(0,v.default)(r,"JSDealChart",Un),(0,v.default)(r,"DEAL_COLUMN_ID",zn),(0,v.default)(r,"JSReportChart",Zn),(0,v.default)(r,"REPORT_COLUMN_ID",ts),(0,v.default)(r,"IChartPainting",Xt),(0,v.default)(r,"IExtendChartPainting",Je),(0,v.default)(r,"IChartTitlePainting",Pa),(0,v.default)(r,"IChartDrawPicture",ka),(0,v.default)(r,"DynamicTitleData",Ha),r)},"66f0":function(t,e,a){e.f=a("a12e")},"6a78":function(t,e,a){var i=a("2194"),r=a("d8ed"),n="__core-js_shared__",s=r[n]||(r[n]={});(t.exports=function(t,e){return s[t]||(s[t]=void 0!==e?e:{})})("versions",[]).push({version:i.version,mode:a("d04b")?"pure":"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"})},"702e":function(t,e,a){"use strict";var i,r,n,s,o=a("d04b"),h=a("d8ed"),l=a("ccbf"),u=a("3b3b"),C=a("db81"),D=a("fab1"),f=a("d291"),c=a("919c"),d=a("23e3"),m=a("c1a3"),v=a("d922").set,S=a("5e48")(),I=a("3ca0"),p=a("c22a"),T=a("82f1"),g=a("7e32"),x="Promise",F=h.TypeError,y=h.process,L=y&&y.versions,E=L&&L.v8||"",M=h[x],A="process"==u(y),N=function(){},w=r=I.f,O=!!function(){try{var t=M.resolve(1),e=(t.constructor={})[a("a12e")("species")]=function(t){t(N,N)};return(A||"function"==typeof PromiseRejectionEvent)&&t.then(N)instanceof e&&0!==E.indexOf("6.6")&&-1===T.indexOf("Chrome/66")}catch(i){}}(),R=function(t){var e;return!(!D(t)||"function"!=typeof(e=t.then))&&e},P=function(t,e){if(!t._n){t._n=!0;var a=t._c;S((function(){var i=t._v,r=1==t._s,n=0,s=function(e){var a,n,s,o=r?e.ok:e.fail,h=e.resolve,l=e.reject,u=e.domain;try{o?(r||(2==t._h&&V(t),t._h=1),!0===o?a=i:(u&&u.enter(),a=o(i),u&&(u.exit(),s=!0)),a===e.promise?l(F("Promise-chain cycle")):(n=R(a))?n.call(a,h,l):h(a)):l(i)}catch(C){u&&!s&&u.exit(),l(C)}};while(a.length>n)s(a[n++]);t._c=[],t._n=!1,e&&!t._h&&b(t)}))}},b=function(t){v.call(h,(function(){var e,a,i,r=t._v,n=B(t);if(n&&(e=p((function(){A?y.emit("unhandledRejection",r,t):(a=h.onunhandledrejection)?a({promise:t,reason:r}):(i=h.console)&&i.error&&i.error("Unhandled promise rejection",r)})),t._h=A||B(t)?2:1),t._a=void 0,n&&e.e)throw e.v}))},B=function(t){return 1!==t._h&&0===(t._a||t._c).length},V=function(t){v.call(h,(function(){var e;A?y.emit("rejectionHandled",t):(e=h.onrejectionhandled)&&e({promise:t,reason:t._v})}))},G=function(t){var e=this;e._d||(e._d=!0,e=e._w||e,e._v=t,e._s=2,e._a||(e._a=e._c.slice()),P(e,!0))},H=function(t){var e,a=this;if(!a._d){a._d=!0,a=a._w||a;try{if(a===t)throw F("Promise can't be resolved itself");(e=R(t))?S((function(){var i={_w:a,_d:!1};try{e.call(t,l(H,i,1),l(G,i,1))}catch(r){G.call(i,r)}})):(a._v=t,a._s=1,P(a,!1))}catch(i){G.call({_w:a,_d:!1},i)}}};O||(M=function(t){c(this,M,x,"_h"),f(t),i.call(this);try{t(l(H,this,1),l(G,this,1))}catch(e){G.call(this,e)}},i=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},i.prototype=a("2130")(M.prototype,{then:function(t,e){var a=w(m(this,M));return a.ok="function"!=typeof t||t,a.fail="function"==typeof e&&e,a.domain=A?y.domain:void 0,this._c.push(a),this._a&&this._a.push(a),this._s&&P(this,!1),a.promise},catch:function(t){return this.then(void 0,t)}}),n=function(){var t=new i;this.promise=t,this.resolve=l(H,t,1),this.reject=l(G,t,1)},I.f=w=function(t){return t===M||t===s?new n(t):r(t)}),C(C.G+C.W+C.F*!O,{Promise:M}),a("74ac")(M,x),a("09cf")(x),s=a("2194")[x],C(C.S+C.F*!O,x,{reject:function(t){var e=w(this),a=e.reject;return a(t),e.promise}}),C(C.S+C.F*(o||!O),x,{resolve:function(t){return g(o&&this===s?M:this,t)}}),C(C.S+C.F*!(O&&a("a52e")((function(t){M.all(t)["catch"](N)}))),x,{all:function(t){var e=this,a=w(e),i=a.resolve,r=a.reject,n=p((function(){var a=[],n=0,s=1;d(t,!1,(function(t){var o=n++,h=!1;a.push(void 0),s++,e.resolve(t).then((function(t){h||(h=!0,a[o]=t,--s||i(a))}),r)})),--s||i(a)}));return n.e&&r(n.v),a.promise},race:function(t){var e=this,a=w(e),i=a.reject,r=p((function(){d(t,!1,(function(t){e.resolve(t).then(a.resolve,i)}))}));return r.e&&i(r.v),a.promise}})},7227:function(t,e,a){a("3700"),a("f7bd"),t.exports=a("2194").Array.from},"73ff":function(t,e,a){var i=a("fab1");t.exports=function(t,e){if(!i(t))return t;var a,r;if(e&&"function"==typeof(a=t.toString)&&!i(r=a.call(t)))return r;if("function"==typeof(a=t.valueOf)&&!i(r=a.call(t)))return r;if(!e&&"function"==typeof(a=t.toString)&&!i(r=a.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},"74ac":function(t,e,a){var i=a("9492").f,r=a("e3b0"),n=a("a12e")("toStringTag");t.exports=function(t,e,a){t&&!r(t=a?t:t.prototype,n)&&i(t,n,{configurable:!0,value:e})}},"760a":function(t,e){var a=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++a+i).toString(36))}},7737:function(t,e,a){var i=a("9492"),r=a("d8ec");t.exports=a("be29")?function(t,e,a){return i.f(t,e,r(1,a))}:function(t,e,a){return t[e]=a,t}},"77c9":function(t,e,a){a("4682"),a("3700"),t.exports=a("fefb")},"78b8":function(t,e,a){"use strict";var i=a("db81"),r=a("3ca0"),n=a("c22a");i(i.S,"Promise",{try:function(t){var e=r.f(this),a=n(t);return(a.e?e.reject:e.resolve)(a.v),e.promise}})},7992:function(t,e,a){a("369d");var i=a("2194").Object;t.exports=function(t,e,a){return i.defineProperty(t,e,a)}},"7ba0":function(t,e){},"7cbb":function(t,e,a){t.exports={default:a("a66e"),__esModule:!0}},"7e32":function(t,e,a){var i=a("c7a9"),r=a("fab1"),n=a("3ca0");t.exports=function(t,e){if(i(t),r(e)&&e.constructor===t)return e;var a=n.f(t),s=a.resolve;return s(e),a.promise}},8144:function(t,e){e.f={}.propertyIsEnumerable},"82f1":function(t,e,a){var i=a("d8ed"),r=i.navigator;t.exports=r&&r.userAgent||""},"847c":function(t,e,a){"use strict";var i=a("9492"),r=a("d8ec");t.exports=function(t,e,a){e in t?i.f(t,e,r(0,a)):t[e]=a}},8494:function(t,e,a){var i=a("9fff");t.exports=function(t){return Object(i(t))}},"86af":function(t,e,a){a("e93b");var i=a("2194").Object;t.exports=function(t,e){return i.defineProperties(t,e)}},8713:function(t,e,a){a("d54d")("Set")},8788:function(t,e,a){var i=a("fd84"),r=a("91d6"),n=a("fb59");t.exports=function(t){return function(e,a,s){var o,h=i(e),l=r(h.length),u=n(s,l);if(t&&a!=a){while(l>u)if(o=h[u++],o!=o)return!0}else for(;l>u;u++)if((t||u in h)&&h[u]===a)return t||u||0;return!t&&-1}}},"8a50":function(t,e,a){t.exports={default:a("bcdb"),__esModule:!0}},"8d4a":function(t,e,a){var i=a("db81");i(i.P+i.R,"Map",{toJSON:a("9c30")("Map")})},"8e09":function(t,e,a){t.exports={default:a("7227"),__esModule:!0}},"8fa6":function(t,e,a){var i=a("ccbf"),r=a("374f"),n=a("8494"),s=a("91d6"),o=a("5feb");t.exports=function(t,e){var a=1==t,h=2==t,l=3==t,u=4==t,C=6==t,D=5==t||C,f=e||o;return function(e,o,c){for(var d,m,v=n(e),S=r(v),I=i(o,c,3),p=s(S.length),T=0,g=a?f(e,p):h?f(e,0):void 0;p>T;T++)if((D||T in S)&&(d=S[T],m=I(d,T,v),t))if(a)g[T]=m;else if(m)switch(t){case 3:return!0;case 5:return d;case 6:return T;case 2:g.push(d)}else if(u)return!1;return C?-1:l||u?u:g}}},"910c":function(t,e){var a=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:a)(t)}},"919c":function(t,e){t.exports=function(t,e,a,i){if(!(t instanceof e)||void 0!==i&&i in t)throw TypeError(a+": incorrect invocation!");return t}},"91d6":function(t,e,a){var i=a("910c"),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},9492:function(t,e,a){var i=a("c7a9"),r=a("97f9"),n=a("73ff"),s=Object.defineProperty;e.f=a("be29")?Object.defineProperty:function(t,e,a){if(i(t),e=n(e,!0),i(a),r)try{return s(t,e,a)}catch(o){}if("get"in a||"set"in a)throw TypeError("Accessors not supported!");return"value"in a&&(t[e]=a.value),t}},"97f9":function(t,e,a){t.exports=!a("be29")&&!a("a4bc")((function(){return 7!=Object.defineProperty(a("c023")("div"),"a",{get:function(){return 7}}).a}))},"9ae4":function(t,e,a){"use strict";e.__esModule=!0;var i=a("d933"),r=n(i);function n(t){return t&&t.__esModule?t:{default:t}}e.default=function(t,e,a){return e in t?(0,r.default)(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}},"9b21":function(t,e,a){var i=a("e472"),r=a("ea39").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},"9bda":function(t,e){t.exports=function(){}},"9c30":function(t,e,a){var i=a("3b3b"),r=a("9dee");t.exports=function(t){return function(){if(i(this)!=t)throw TypeError(t+"#toJSON isn't generic");return r(this)}}},"9dee":function(t,e,a){var i=a("23e3");t.exports=function(t,e){var a=[];return i(t,!1,a.push,a,e),a}},"9f34":function(t,e,a){var i=a("9492"),r=a("c7a9"),n=a("0ef2");t.exports=a("be29")?Object.defineProperties:function(t,e){r(t);var a,s=n(e),o=s.length,h=0;while(o>h)i.f(t,a=s[h++],e[a]);return t}},"9fff":function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},a12e:function(t,e,a){var i=a("6a78")("wks"),r=a("760a"),n=a("d8ed").Symbol,s="function"==typeof n,o=t.exports=function(t){return i[t]||(i[t]=s&&n[t]||(s?n:r)("Symbol."+t))};o.store=i},a14b:function(t,e,a){a("f7a9")("asyncIterator")},a266:function(t,e,a){t.exports={default:a("77c9"),__esModule:!0}},a2bf:function(t,e,a){"use strict";var i=a("e8b5"),r=a("50c4"),n=a("0366"),s=function(t,e,a,o,h,l,u,C){var D,f=h,c=0,d=!!u&&n(u,C,3);while(c<o){if(c in a){if(D=d?d(a[c],c,e):a[c],l>0&&i(D))f=s(t,e,D,r(D.length),f,l-1)-1;else{if(f>=9007199254740991)throw TypeError("Exceed the acceptable array length");t[f]=D}f++}c++}return f};t.exports=s},a3b7:function(t,e,a){"use strict";var i=a("6309"),r=a("57fb"),n="Set";t.exports=a("3af9")(n,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(t){return i.def(r(this,n),t=0===t?0:t,t)}},i)},a4bc:function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},a52e:function(t,e,a){var i=a("a12e")("iterator"),r=!1;try{var n=[7][i]();n["return"]=function(){r=!0},Array.from(n,(function(){throw 2}))}catch(s){}t.exports=function(t,e){if(!e&&!r)return!1;var a=!1;try{var n=[7],o=n[i]();o.next=function(){return{done:a=!0}},n[i]=function(){return o},t(n)}catch(s){}return a}},a66e:function(t,e,a){a("3700"),a("4682"),t.exports=a("66f0").f("iterator")},a812d:function(t,e,a){t.exports={default:a("86af"),__esModule:!0}},ae44:function(t,e,a){"use strict";var i=a("4ea4");a("99af"),a("4160"),a("fb6a"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=i(a("d4ec")),n=i(a("bee2")),s=function(){function t(e,a){(0,r.default)(this,t),this.ctx=e,this.canvasId=a,this.chart=null,t.initStyle(e),this.initEvent()}return(0,n.default)(t,[{key:"getContext",value:function(t){return"2d"===t?this.ctx:null}},{key:"setChart",value:function(t){this.chart=t}},{key:"attachEvent",value:function(){}},{key:"detachEvent",value:function(){}},{key:"initEvent",value:function(){var t=this;this.event={};var e=[{wxName:"touchStart",ecName:"mousedown"},{wxName:"touchMove",ecName:"mousemove"},{wxName:"touchEnd",ecName:"mouseup"},{wxName:"touchEnd",ecName:"click"}];e.forEach((function(e){t.event[e.wxName]=function(a){var i=a.mp.touches[0];t.chart.getZr().handler.dispatch(e.ecName,{zrX:"tap"===e.wxName?i.clientX:i.x,zrY:"tap"===e.wxName?i.clientY:i.y})}}))}}],[{key:"initStyle",value:function(t){var e=arguments,a=["fillStyle","strokeStyle","globalAlpha","textAlign","textBaseAlign","shadow","lineWidth","lineCap","lineJoin","lineDash","miterLimit","fontSize"];a.forEach((function(e){Object.defineProperty(t,e,{set:function(a){("fillStyle"!==e&&"strokeStyle"!==e||"none"!==a&&null!==a)&&t["set".concat(e.charAt(0).toUpperCase()).concat(e.slice(1))](a)}})})),t.createRadialGradient=function(){return t.createCircularGradient(e)}}}]),t}();e.default=s},afd1:function(t,e,a){var i=a("db81");i(i.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}})},b22c:function(t,e){e.f=Object.getOwnPropertySymbols},b2e7:function(t,e,a){"use strict";var i=a("d04b"),r=a("db81"),n=a("468f"),s=a("7737"),o=a("1b2a"),h=a("2721"),l=a("74ac"),u=a("16d8"),C=a("a12e")("iterator"),D=!([].keys&&"next"in[].keys()),f="@@iterator",c="keys",d="values",m=function(){return this};t.exports=function(t,e,a,v,S,I,p){h(a,e,v);var T,g,x,F=function(t){if(!D&&t in M)return M[t];switch(t){case c:return function(){return new a(this,t)};case d:return function(){return new a(this,t)}}return function(){return new a(this,t)}},y=e+" Iterator",L=S==d,E=!1,M=t.prototype,A=M[C]||M[f]||S&&M[S],N=A||F(S),w=S?L?F("entries"):N:void 0,O="Array"==e&&M.entries||A;if(O&&(x=u(O.call(new t)),x!==Object.prototype&&x.next&&(l(x,y,!0),i||"function"==typeof x[C]||s(x,C,m))),L&&A&&A.name!==d&&(E=!0,N=function(){return A.call(this)}),i&&!p||!D&&!E&&M[C]||s(M,C,N),o[e]=N,o[y]=m,S)if(T={values:L?N:F(d),keys:I?N:F(c),entries:w},p)for(g in T)g in M||n(M,g,T[g]);else r(r.P+r.F*(D||E),e,T);return T}},b85c:function(t,e,a){"use strict";a("a4d3"),a("e01a"),a("d28b"),a("d3b7"),a("3ca3"),a("ddb0"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=n;var i=r(a("06c5"));function r(t){return t&&t.__esModule?t:{default:t}}function n(t,e){var a;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(a=(0,i.default)(t))||e&&t&&"number"===typeof t.length){a&&(t=a);var r=0,n=function(){};return{s:n,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,h=!1;return{s:function(){a=t[Symbol.iterator]()},n:function(){var t=a.next();return o=t.done,t},e:function(t){h=!0,s=t},f:function(){try{o||null==a["return"]||a["return"]()}finally{if(h)throw s}}}}},bcdb:function(t,e,a){a("7ba0"),a("3700"),a("4682"),a("702e"),a("f67a"),a("78b8"),t.exports=a("2194").Promise},bd44:function(t,e,a){"use strict";var i=a("6309"),r=a("57fb"),n="Map";t.exports=a("3af9")(n,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(t){var e=i.getEntry(r(this,n),t);return e&&e.v},set:function(t,e){return i.def(r(this,n),0===t?0:t,e)}},i,!0)},be29:function(t,e,a){t.exports=!a("a4bc")((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},bf2f:function(t,e,a){a("dd0f")("Set")},c023:function(t,e,a){var i=a("fab1"),r=a("d8ed").document,n=i(r)&&i(r.createElement);t.exports=function(t){return n?r.createElement(t):{}}},c1a3:function(t,e,a){var i=a("c7a9"),r=a("d291"),n=a("a12e")("species");t.exports=function(t,e){var a,s=i(t).constructor;return void 0===s||void 0==(a=i(s)[n])?e:r(a)}},c22a:function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(e){return{e:!0,v:e}}}},c7a9:function(t,e,a){var i=a("fab1");t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},cb17:function(t,e,a){t.exports={default:a("0249"),__esModule:!0}},ccbf:function(t,e,a){var i=a("d291");t.exports=function(t,e,a){if(i(t),void 0===e)return t;switch(a){case 1:return function(a){return t.call(e,a)};case 2:return function(a,i){return t.call(e,a,i)};case 3:return function(a,i,r){return t.call(e,a,i,r)}}return function(){return t.apply(e,arguments)}}},cd9b:function(t,e,a){"use strict";a("a4d3"),a("e01a"),a("7db0"),a("4160"),a("c975"),a("45fc"),a("4e82"),a("d3b7"),a("e25e"),a("ac1f"),a("25f0"),a("5319"),a("159b"),Object.defineProperty(e,"__esModule",{value:!0});var i,r=a("9ae4"),n=c(r),s=a("a266"),o=c(s),h=a("cb17"),l=c(h),u=a("09b7"),C=c(u),D=a("554f"),f=c(D);function c(t){return t&&t.__esModule?t:{default:t}}function d(){this.Domain="https://opensource.zealink.com",this.CacheDomain="https://opensourcecache.zealink.com"}var m=new d;function v(){this.Stop,this.Down,this.Up,this.Unchanged,this.UpStock={Symbol:null,Name:null},this.DownStock={Symbol:null,Name:null}}function S(){this.Good,this.GoodIncrease={Day1:null,Week1:null,Week4:null}}function I(t,e,a){this.arySymbol=new Array,this.SortField=t,this.Order=e,this.TagID=new C.default([a])}function p(){this.ROE,this.Date,this.PerSEarning,this.EPS,this.PerNetAsset,this.NProfit,this.NProfitIncrease,this.NnetProfit,this.NnProfitIncrease,this.NnProfitSpeed,this.Benford,this.SetData=function(t){isNaN(t.roe)||(this.ROE=t.roe),isNaN(t.finance.date)||(this.Date=t.finance.date),isNaN(t.finance.persearning)||(this.PerSEarning=t.finance.persearning),isNaN(t.finance.eps)||(this.EPS=t.finance.eps),isNaN(t.finance.pernetasset)||(this.PerNetAsset=t.finance.pernetasset),isNaN(t.finance.nprofit)||(this.NProfit=t.finance.nprofit),isNaN(t.finance.nprofitincrease)||(this.NProfitIncrease=t.finance.nprofitincrease),isNaN(t.finance.nnetprofit)||(this.NnetProfit=t.finance.nnetprofit),isNaN(t.finance.nnprofitincrease)||(this.NnProfitIncrease=t.finance.nnprofitincrease),isNaN(t.finance.nnprofitspeed)||(this.NnProfitSpeed=t.finance.nnprofitspeed),isNaN(t.finance.benford)||(this.Benford=t.finance.benford)}}function T(){this.Date,this.A,this.Total,this.ARate,this.SetData=function(t){isNaN(t.capital.date)||(this.Date=t.capital.date),isNaN(t.capital.a)||(this.A=t.capital.a),isNaN(t.capital.total)||(this.Total=t.capital.total),isNaN(t.capital.arate)||(this.ARate=t.capital.arate)}}function g(){this.SuperIn,this.SuperOut,this.BigIn,this.BigOut,this.MidIn,this.MidOut,this.SmallIn,this.SmallOut,this.MainIn,this.MainOut,this.MainNetIn,this.SetData=function(t){this.SuperIn=t.superin,this.SuperOut=t.superout,this.BigIn=t.bigin,this.BigOut=t.bigout,this.MidIn=t.midin,this.MidOut=t.midout,this.SmallIn=t.smallin,this.SmallOut=t.smallout,this.MainIn=t.mainin,this.MainOut=t.mainout,this.MainNetIn=t.mainnetin}}function x(){this.SuperIn,this.SuperOut,this.BigIn,this.BigOut,this.MidIn,this.MidOut,this.SmallIn,this.SmallOut,this.MainIn,this.MainOut,this.MainNetIn,this.MainNetInRatio,this.SetData=function(t){this.SuperIn=t.superin,this.SuperOut=t.superout,this.BigIn=t.bigin,this.BigOut=t.bigout,this.MidIn=t.midin,this.MidOut=t.midout,this.SmallIn=t.smallin,this.SmallOut=t.smallout,this.MainIn=t.mainin,this.MainOut=t.mainout,this.MainNetIn=t.mainnetin,this.MainNetInRatio=t.mainnetinratio}}function F(){this.DDX,this.DDY,this.DDZ,this.SetData=function(t){this.DDX=t.ddx,this.DDY=t.ddy,this.DDZ=t.ddz}}function y(){this.Name,this.Business,this.Vol,this.Price,this.ReleaseDate,this.Competence,this.SetData=function(t){t.company&&(this.Name=t.company.name,this.Business=t.company.business,this.Vol=t.company.vol,this.Price=t.company.price,this.ReleaseDate=t.company.releasedate,this.Competence=t.company.corecompetence)}}function L(){this.Industry,this.Region,this.Concept,this.SetData=function(t){this.SetIndustryData(t),this.SetRegionData(t),this.SetConceptData(t)},this.SetIndustryData=function(t){if(t.industry)for(var e in this.Industry=[],t.industry){var a=t.industry[e];this.Industry.push({Name:a.name,Symbol:a.symbol})}},this.SetRegionData=function(t){if(t.region)for(var e in this.Region=[],t.region){var a=t.region[e];this.Region.push({Name:a.name,Symbol:a.symbol})}},this.SetConceptData=function(t){if(t.concept)for(var e in this.Concept=[],t.concept){var a=t.concept[e];this.Concept.push({Name:a.name,Symbol:a.symbol})}}}function E(){this.IsMargin=!1,this.IsHK=!1,this.IsSHHK=!1,this.IsSZHK=!1,this.STType=0,this.HK,this.SetData=function(t){t.events&&(isNaN(t.events.margin)||(this.IsMargin=1==t.events.margin),isNaN(t.events.hk)||(this.IsHK=1==t.events.hk),isNaN(t.events.shhk)||(this.IsSHHK=1==t.events.shhk),isNaN(t.events.szhk)||(this.IsSZHK=1==t.events.szhk),isNaN(t.events.st)||(this.STType=t.events.st),this.IsHK&&t.events.hksymbol&&t.events.hkname&&(this.HK={Symbol:t.events.hksymbol,Name:t.events.hkname}))}}function M(t){var e=t.toUpperCase();if(e.indexOf(".SH")>0){if(e=e.replace(".SH",""),"0"==e.charAt(0)&&parseInt(e)<=3e3)return!0}else if(e.indexOf(".SZ")>0){if(e=e.replace(".SZ",""),"3"==e.charAt(0)&&"9"==e.charAt(1))return!0}else if(e.indexOf(".CI")>0)return!0;return!1}function A(t){this.Symbol=t,this.Name,this.Open,this.Price,this.High,this.Low,this.YClose,this.Vol,this.Amount,this.Date,this.Time,this.ExchangeRate,this.Amplitude,this.VolRatio,this.Increase,this.MaxPrice,this.MinPrice,this.RFPrice,this.IndexTop,this.Week,this.MinuteAmplitude={},this.RiseFallSpeed={},this.MAmount={},this.GetBaseData=function(t,e){switch(this.BaseDataTagID.add(t),e){case N.SYMBOL:return this.Symbol;case N.NAME:return this.Name;case N.OPEN:return this.Open;case N.PRICE:return this.Price;case N.YCLOSE:return this.YClose;case N.HIGH:return this.High;case N.LOW:return this.Low;case N.VOL:return this.Vol;case N.AMOUNT:return this.Amount;case N.DATE:return this.Date;case N.TIME:return this.Time;case N.INCREASE:return this.Increase;case N.EXCHANGE_RATE:return this.ExchangeRate;case N.AMPLITUDE:return this.Amplitude;case N.MAX_PRICE:return this.MaxPrice;case N.MIN_PRICE:return this.MinPrice;case N.RISE_FALL_PRICE:return this.RFPrice;case N.VOLRATIO:return this.VolRatio;case N.INDEXTOP:return this.IndexTop;case N.WEEK:return this.Week}},this.Heat,this.GetHeatData=function(t){return this.HeatTagID.add(t),this.Heat},this.Sort=new l.default,this.GetSortData=function(t,e,a){var i=e.toString()+"-"+a.toString();if(!this.Sort.has(i)){var r=new I(e,a,t);return this.Sort.set(i,r),r}r=this.Sort.get(i);return r.TagID.add(t),r},this.Buy5,this.GetBuy5=function(t){return this.BuySellTagID.add(t),this.Buy5},this.Sell5,this.GetSell5=function(t){return this.BuySellTagID.add(t),this.Sell5},this.Deal,this.GetDeal=function(t){return this.DealTagID.add(t),this.Deal},this.MarketValue,this.FlowMarketValue,this.Bookrate,this.Bookdiffer,this.PE,this.PE2,this.PE3,this.PB,this.GetDerivative=function(t,e){switch(this.DerivativeTagID.add(t),e){case N.MARKET_VALUE:return this.MarketValue;case N.FLOW_MARKET_VALUE:return this.FlowMarketValue;case N.BOOK_RATE:return this.Bookrate;case N.BOOK_DIFFER:return this.Bookdiffer;case N.PE:return this.PE;case N.PE2:return this.PE2;case N.PE3:return this.PE3;case N.PB:return this.PB}},this.Finance,this.GetFinance=function(t,e){if(!this.Finance)return this.FinanceTagID.add(t),null;switch(e){case N.ROE:return this.Finance.ROE;case N.FINANCE_DATE:return this.Finance.Date;case N.FINANCE_PERSEARNING:return this.Finance.PerSEarning;case N.FINANCE_PERNETASSET:return this.Finance.PerNetAsset;case N.FINANCE_NPROFIT:return this.Finance.NProfit;case N.FINANCE_NPROFITINCREASE:return this.Finance.NProfitIncrease;case N.FINANCE_NNETPROFIT:return this.Finance.NnetProfit;case N.FINANCE_NNPROFITINCREASE:return this.Finance.NnProfitIncrease;case N.FINANCE_NNPROFITSPEED:return this.Finance.NnProfitSpeed;case N.FINANCE_EPS:return this.Finance.EPS;case N.FINANCE_BENFORD:return this.Finance.Benford}},this.Capital,this.GetCapital=function(t,e){if(!this.Capital)return this.CapitalTagID.add(t),null;switch(e){case N.CAPITAL_TOTAL:return this.Capital.Total;case N.CAPITAL_A:return this.Capital.A;case N.CAPTIAL_ARATE:return this.Capital.ARate}},this.CapitalFlowDay,this.CapitalFlowDay3,this.CapitalFlowDay5,this.CapitalFlowDay10,this.GetCapitalFlowDay=function(t,e){var a=null;switch(e){case N.CAPITAL_FLOW_DAY:this.CapitalFlowDayID.add(t),this.CapitalFlowDay&&(a=this.CapitalFlowDay);break;case N.CAPITAL_FLOW_DAY3:this.CapitalFlowDay3ID.add(t),this.CapitalFlowDay3&&(a=this.CapitalFlowDay3);break;case N.CAPITAL_FLOW_DAY5:this.CapitalFlowDay5ID.add(t),this.CapitalFlowDay5&&(a=this.CapitalFlowDay5);break;case N.CAPITAL_FLOW_DAY10:this.CapitalFlowDay10ID.add(t),this.CapitalFlowDay10&&(a=this.CapitalFlowDay10);break}return a},this.DDE,this.DDE3,this.DDE5,this.DDE10,this.GetDDE=function(t,e){var a=null;switch(e){case N.DDE:this.DDEID.add(t),this.DDE&&(a=this.DDE);break;case N.DDE3:this.DDE3ID.add(t),this.DDE3&&(a=this.DDE3);break;case N.DDE5:this.DDE5ID.add(t),this.DDE5&&(a=this.DDE5);break;case N.DDE10:this.DDE10ID.add(t),this.DDE10&&(a=this.DDE10);break}return a},this.Event,this.GetEvent=function(t,e){return this.Event?this.Event:(this.EventTagID.add(t),null)},this.Company,this.GetCompany=function(t,e){if(!this.Company)return this.CompanyTagID.add(t),null;switch(e){case N.COMPANY_NAME:return this.Company.Name;case N.COMPANY_BUSINESS:return this.Company.Business;case N.COMPANY_VOL:return this.Company.Vol;case N.COMPANY_PRICE:return this.Company.Price;case N.COMPANY_RELEASEDATE:return this.Company.ReleaseDate;case N.COMPANY_COMPETENCE:return this.Company.Competence}},this.Plate,this.GetPlate=function(t,e){if(!this.Plate)return this.PlateTagID.add(t),null;switch(e){case N.PLATE_INDUSTRY:return this.Plate.Industry;case N.PLATE_CONCEPT:return this.Plate.Concept;case N.PLATE_REGION:return this.Plate.Region}},this.TagID=new C.default,this.BaseDataTagID=new C.default,this.HeatTagID=new C.default,this.BuySellTagID=new C.default,this.DealTagID=new C.default,this.DerivativeTagID=new C.default,this.FinanceTagID=new C.default,this.CapitalTagID=new C.default,this.CapitalFlowDayID=new C.default,this.CapitalFlowDay3ID=new C.default,this.CapitalFlowDay5ID=new C.default,this.CapitalFlowDay10ID=new C.default,this.DDEID=new C.default,this.DDE3ID=new C.default,this.DDE5ID=new C.default,this.DDE10ID=new C.default,this.EventTagID=new C.default,this.CompanyTagID=new C.default,this.PlateTagID=new C.default,this.AttachTagID=function(t){this.TagID.add(t)},this.ClearTagID=function(){this.TagID.clear(),this.BaseDataTagID.clear(),this.HeatTagID.clear(),this.BuySellTagID.clear(),this.DealTagID.clear(),this.DerivativeTagID.clear(),this.FinanceTagID.clear(),this.CapitalTagID.clear(),this.CapitalFlowDayID.clear(),this.CapitalFlowDay3ID.clear(),this.CapitalFlowDay5ID.clear(),this.CapitalFlowDay10ID.clear(),this.DDEID.clear(),this.DDE3ID.clear(),this.DDE5ID.clear(),this.DDE10ID.clear(),this.EventTagID.clear(),this.CompanyTagID.clear();var t=!0,e=!1,a=void 0;try{for(var i,r=(0,o.default)(this.Sort);!(t=(i=r.next()).done);t=!0){var n=i.value;n[1].TagID.clear()}}catch(s){e=!0,a=s}finally{try{!t&&r.return&&r.return()}finally{if(e)throw a}}},this.RemoveTagID=function(t){this.TagID.delete(t),this.BaseDataTagID.delete(t),this.HeatTagID.delete(t),this.BuySellTagID.delete(t),this.DealTagID.delete(t),this.DerivativeTagID.delete(t),this.FinanceTagID.delete(t),this.CapitalTagID.delete(t),this.CapitalFlowDayID.delete(t),this.CapitalFlowDay3ID.delete(t),this.CapitalFlowDay5ID.delete(t),this.CapitalFlowDay10ID.delete(t),this.DDEID.delete(t),this.DDE3ID.delete(t),this.DDE5ID.delete(t),this.DDE10ID.delete(t),this.EventTagID.delete(t),this.CompanyTagID.delete(t);var e=!0,a=!1,i=void 0;try{for(var r,n=(0,o.default)(this.Sort);!(e=(r=n.next()).done);e=!0){var s=r.value;s[1].TagID.delete(t)}}catch(h){a=!0,i=h}finally{try{!e&&n.return&&n.return()}finally{if(a)throw i}}},this.SetBaseData=function(t){this.Name=t.name,this.YClose=t.yclose,this.Price=t.price,this.High=t.high,this.Low=t.low,this.Open=t.open,this.Vol=t.vol,this.Amount=t.amount,this.Date=t.date,this.Time=t.time,this.Increase=t.increase,isNaN(t.exchangerate)||(this.ExchangeRate=t.exchangerate),isNaN(t.amplitude)||(this.Amplitude=t.amplitude),isNaN(t.volratio)||(this.VolRatio=t.volratio),this.Name.indexOf("ST")>=0?(this.MaxPrice=1.05*this.Open,this.MinPrice=.95*this.Open):(this.MaxPrice=1.1*this.Open,this.MinPrice=.9*this.Open),this.Price&&this.YClose&&(this.RFPrice=this.Price-this.YClose),t.week&&(this.Week={},this.Week.Week1=t.week.week1,this.Week.Week4=t.week.week4,this.Week.Week13=t.week.week13,this.Week.Week26=t.week.week26,this.Week.Week52=t.week.week52)},this.SetDerivativeData=function(t){this.MarketValue=t.marketvalue,this.FlowMarketValue=t.flowmarketvalue,this.Bookrate=t.bookrate,this.Bookdiffer=t.bookdiffer,this.PE=t.pe,this.PE2=t.pe2,this.PE3=t.pe3,this.PB=t.pb},this.SetFinanceData=function(t){console.log(t),t.finance&&(this.Finance=new p,this.Finance.SetData(t))},this.SetCapitalData=function(t){t.capital&&(this.Capital=new T,this.Capital.SetData(t))},this.SetIndexBaseData=function(t){this.SetBaseData(t);var e=new v;t.indextop&&(e.Up=t.indextop.up,e.Down=t.indextop.down,e.Unchanged=t.indextop.unchanged,e.Stop=t.indextop.stop,e.UpStock.Symbol=t.indextop.upstock.symbol,e.UpStock.Name=t.indextop.upstock.name,e.DownStock.Symbol=t.indextop.downstock.symbol,e.DownStock.Name=t.indextop.downstock.name),this.IndexTop=e},this.SetBuySellData=function(t){for(var e in this.SetBaseData(t),this.Buy5=new Array,this.Sell5=new Array,t.buy){var a=t.buy[e];this.Buy5.push({Price:a.price,Vol:a.vol})}for(var e in t.sell){a=t.sell[e];this.Sell5.push({Price:a.price,Vol:a.vol})}},this.SetDealData=function(t){for(var e in this.Price=t.price,this.High=t.high,this.Low=t.low,this.Vol=t.vol,this.Amount=t.amount,this.Date=t.date,this.Time=t.time,this.Increase=t.increase,this.Deal=new Array,t.deal){var a=t.deal[e];if(!isNaN(a.price)&&!isNaN(a.time)){var i="";0===a.bs?i="B":1===a.bs&&(i="S"),this.Deal.push({Price:a.price,Amount:a.amount,Vol:a.vol,Time:a.time,BS:i})}}},this.SetHeatData=function(t){var e=new S;e.Good=t.quadrant.good,e.GoodIncrease.Day1=t.quadrant.gincrease.day1,e.GoodIncrease.Week1=t.quadrant.gincrease.week1,e.GoodIncrease.Week4=t.quadrant.gincrease.week4,this.Heat=e},this.SetCapitalFlowDayData=function(t,e){if(t)switch(e){case P.CAPITAL_FLOW_DAY_DATA:this.CapitalFlowDay=new g,this.CapitalFlowDay.SetData(t);break;case P.CAPITAL_FLOW_DAY3_DATA:this.CapitalFlowDay3=new x,this.CapitalFlowDay3.SetData(t);break;case P.CAPITAL_FLOW_DAY5_DATA:this.CapitalFlowDay5=new x,this.CapitalFlowDay5.SetData(t);break;case P.CAPITAL_FLOW_DAY10_DATA:this.CapitalFlowDay10=new x,this.CapitalFlowDay10.SetData(t);break}},this.SetDDE=function(t,e){if(t){switch(e){case P.DDE_DAY_DATA:this.DDE=new F,this.DDE.SetData(t);break;case P.DDE_DAY3_DATA:this.DDE3=new F,this.DDE3.SetData(t);break;case P.DDE_DAY5_DATA:this.DDE5=new F,this.DDE5.SetData(t);break;case P.DDE_DAY10_DATA:this.DDE10=new F,this.DDE10.SetData(t);break}return t}},this.SetEventData=function(t){t.events&&(this.Event=new E,this.Event.SetData(t))},this.SetCompanyData=function(t){t.company&&(this.Company=new y,this.Company.SetData(t))},this.SetPlateData=function(t){(t.industry||t.region||t.concept)&&(this.Plate=new L,this.Plate.SetData(t))},this.SetData=function(t){t.name&&(this.Name=t.name),isNaN(t.yclose)||(this.YClose=t.yclose),isNaN(t.price)||(this.Price=t.price),isNaN(t.high)||(this.High=t.high),isNaN(t.low)||(this.Low=t.low),isNaN(t.vol)||(this.Vol=t.vol),isNaN(t.amount)||(this.Amount=t.amount),isNaN(t.date)||(this.Date=t.date),isNaN(t.time)||(this.Time=t.time),isNaN(t.increase)||(this.Increase=t.increase),isNaN(t.marketvalue)||(this.MarketValue=t.marketvalue),isNaN(t.flowmarketvalue)||(this.FlowMarketValue=t.flowmarketvalue),isNaN(t.bookrate)||(this.Bookrate=t.bookrate),isNaN(t.bookdiffer)||(this.Bookdiffer=t.bookdiffer),isNaN(t.pe)||(this.PE=t.pe),isNaN(t.pb)||(this.PB=t.pb),t.finance&&this.SetFinanceData(t),t.finance&&this.SetFinanceDetailData(t),t.capital&&this.SetCapitalData(t),t.mamplitude&&(isNaN(t.mamplitude[1])||(this.MinuteAmplitude.M1=t.mamplitude[1]),isNaN(t.mamplitude[3])||(this.MinuteAmplitude.M3=t.mamplitude[3]),isNaN(t.mamplitude[5])||(this.MinuteAmplitude.M5=t.mamplitude[5]),isNaN(t.mamplitude[10])||(this.MinuteAmplitude.M10=t.mamplitude[10]),isNaN(t.mamplitude[15])||(this.MinuteAmplitude.M15=t.mamplitude[15])),t.risefallspeed&&(isNaN(t.risefallspeed[1])||(this.RiseFallSpeed.M1=t.risefallspeed[1]),isNaN(t.risefallspeed[3])||(this.RiseFallSpeed.M3=t.risefallspeed[3]),isNaN(t.risefallspeed[5])||(this.RiseFallSpeed.M5=t.risefallspeed[5]),isNaN(t.risefallspeed[10])||(this.RiseFallSpeed.M10=t.risefallspeed[10]),isNaN(t.risefallspeed[15])||(this.RiseFallSpeed.M15=t.risefallspeed[15])),t.mamount&&(isNaN(t.mamount[1])||(this.MAmount.M1=t.mamount[1]),isNaN(t.mamount[3])||(this.MAmount.M5=t.mamount[3]),isNaN(t.mamount[5])||(this.MAmount.M5=t.mamount[5]),isNaN(t.mamount[10])||(this.MAmount.M10=t.mamount[10]),isNaN(t.mamount[15])||(this.MAmount.M15=t.mamount[15]))}}var N={SYMBOL:0,NAME:1,OPEN:2,PRICE:3,HIGH:4,LOW:5,YCLOSE:6,VOL:7,AMOUNT:8,DATE:9,TIME:10,INCREASE:11,BUY5:12,SELL5:13,DEAL:14,AMPLITUDE:15,MARKET_VALUE:16,FLOW_MARKET_VALUE:17,BOOK_RATE:18,BOOK_DIFFER:19,PE:20,PB:21,EXCHANGE_RATE:23,ROE:24,FINANCE_DATE:25,FINANCE_PERSEARNING:26,FINANCE_PERNETASSET:27,FINANCE_NPROFIT:28,FINANCE_NPROFITINCREASE:29,FINANCE_NNETPROFIT:30,FINANCE_NNPROFITINCREASE:31,FINANCE_NNPROFITSPEED:32,FINANCE_EPS:33,MAX_PRICE:34,MIN_PRICE:35,RISE_FALL_PRICE:36,FINANCE_BENFORD:37,RISEFALLSPEED_1:38,RISEFALLSPEED_3:39,RISEFALLSPEED_5:40,RISEFALLSPEED_10:41,RISEFALLSPEED_15:42,MINUTE_AMPLITUDE_1:43,MINUTE_AMPLITUDE_3:44,MINUTE_AMPLITUDE_5:45,MINUTE_AMPLITUDE_10:46,MINUTE_AMPLITUDE_15:47,MINUTE_AMOUNT_1:48,MINUTE_AMOUNT_3:49,MINUTE_AMOUNT_5:50,MINUTE_AMOUNT_10:51,MINUTE_AMOUNT_15:52,COMPANY_NAME:53,PLATE_INDUSTRY:54,PLATE_CONCEPT:55,PLATE_REGION:56,COMPANY_BUSINESS:57,COMPANY_VOL:58,COMPANY_PRICE:59,COMPANY_RELEASEDATE:60,COMPANY_COMPETENCE:61,CAPITAL_FLOW_DAY:67,CAPITAL_FLOW_DAY3:68,CAPITAL_FLOW_DAY5:69,CAPITAL_FLOW_DAY10:70,DDE:71,DDE3:72,DDE5:73,DDE10:74,EVENTS:75,CAPITAL_A:76,CAPITAL_TOTAL:77,CAPTIAL_ARATE:78,VOLRATIO:79,PE2:80,PE3:81,INDEXTOP:100,WEEK:101,HEAT:102},w={m_mapFiled:new l.default([[N.NAME,"name"],[N.SYMBOL,"symbol"],[N.PRICE,"price"],[N.INCREASE,"increase"],[N.PE,"pe"],[N.FINANCE_BENFORD,"finance.benford"],[N.YCLOSE,"yclose"],[N.RISEFALLSPEED_1,"risefallspeed.1"],[N.RISEFALLSPEED_3,"risefallspeed.3"],[N.RISEFALLSPEED_5,"risefallspeed.5"],[N.RISEFALLSPEED_10,"risefallspeed.10"],[N.RISEFALLSPEED_15,"risefallspeed.15"],[N.MINUTE_AMPLITUDE_1,"mamplitude.1"],[N.MINUTE_AMPLITUDE_3,"mamplitude.3"],[N.MINUTE_AMPLITUDE_5,"mamplitude.5"],[N.MINUTE_AMPLITUDE_10,"mamplitude.10"],[N.MINUTE_AMPLITUDE_15,"mamplitude.15"],[N.MINUTE_AMOUNT_1,"mamount.1"],[N.MINUTE_AMOUNT_3,"mamount.3"],[N.MINUTE_AMOUNT_5,"mamount.5"],[N.MINUTE_AMOUNT_10,"mamount.10"],[N.MINUTE_AMOUNT_15,"mamount.15"]]),GetFieldName:function(t){return this.m_mapFiled.has(t)?this.m_mapFiled.get(t):null}};function O(t,e){this.JSStock=t,this.TagID=e,this.Get=function(e,a){var i=t.Get(e,this.TagID);if(!i)return null;switch(a){case N.SYMBOL:case N.NAME:case N.OPEN:case N.PRICE:case N.YCLOSE:case N.HIGH:case N.LOW:case N.VOL:case N.AMOUNT:case N.DATE:case N.TIME:case N.INCREASE:case N.EXCHANGE_RATE:case N.AMPLITUDE:case N.MAX_PRICE:case N.MIN_PRICE:case N.RISE_FALL_PRICE:case N.INDEXTOP:case N.WEEK:case N.VOLRATIO:return i.GetBaseData(this.TagID,a);case N.HEAT:return i.GetHeatData(this.TagID);case N.BUY5:return i.GetBuy5(this.TagID);case N.SELL5:return i.GetSell5(this.TagID);case N.DEAL:return i.GetDeal(this.TagID);case N.MARKET_VALUE:case N.FLOW_MARKET_VALUE:case N.BOOK_RATE:case N.BOOK_DIFFER:case N.PE:case N.PE2:case N.PE3:case N.PB:return i.GetDerivative(this.TagID,a);case N.ROE:case N.FINANCE_DATE:case N.FINANCE_PERSEARNING:case N.FINANCE_PERNETASSET:case N.FINANCE_NPROFIT:case N.FINANCE_NPROFITINCREASE:case N.FINANCE_NNETPROFIT:case N.FINANCE_NNPROFITINCREASE:case N.FINANCE_NNPROFITSPEED:case N.FINANCE_EPS:case N.FINANCE_BENFORD:return i.GetFinance(this.TagID,a);case N.PLATE_INDUSTRY:case N.PLATE_CONCEPT:case N.PLATE_REGION:return i.GetPlate(this.TagID,a);case N.CAPITAL_FLOW_DAY:case N.CAPITAL_FLOW_DAY3:case N.CAPITAL_FLOW_DAY5:case N.CAPITAL_FLOW_DAY10:return i.GetCapitalFlowDay(this.TagID,a);case N.DDE:case N.DDE3:case N.DDE5:case N.DDE10:return i.GetDDE(this.TagID,a);case N.EVENTS:return i.GetEvent(this.TagID,a);case N.COMPANY_NAME:case N.COMPANY_BUSINESS:case N.COMPANY_VOL:case N.COMPANY_PRICE:case N.COMPANY_RELEASEDATE:case N.COMPANY_COMPETENCE:return i.GetCompany(this.TagID,a);case N.CAPITAL_A:case N.CAPTIAL_ARATE:case N.CAPITAL_TOTAL:return i.GetCapital(this.TagID,a);default:return null}},this.GetSort=function(e,a,i){var r=t.Get(e,this.TagID);return null==r?r:r.GetSortData(this.TagID,a,i)},this.EndRead=function(t){1==t&&this.JSStock.ReqeustData()},this.SetQueryField=function(t,e){for(var a in e)this.Get(t,e[a])}}function R(){this.Symbol,this.Callback,this.Order=-1,this.SortField,this.Field,this.Plate,this.Data=new l.default,this.ApiUrl=m.Domain+"/API/StockHistoryDay",this.PageSize=20,this.PageIndex=1,this.Count,this.currentData=null,this.RequsetData=function(t,e){var a=this,i="string"==typeof a.Symbol?[this.Symbol]:this.Symbol,r=i?i.length:0;this.Plate?this.currentData={plate:this.Plate,symbol:i,start:0,end:this.PageSize,field:this.Field,orderfield:this.SortField,order:this.Order,condition:t.GetQuery(),condition2:e?e.GetQuery():[]}:this.currentData={symbol:i,start:0,end:r,field:this.Field,orderfield:this.SortField,order:this.Order,condition:t.GetQuery(),condition2:e?e.GetQuery():[]},f.default.ajax({url:this.ApiUrl,data:a.currentData,method:"POST",dataType:"json",success:function(e){a.Count=e.data.count,a.RecvData(e,t)},fail:function(e){a.RecvError(e,t)}})},this.GetNextPage=function(){var t=this;this.PageSize*this.PageIndex<this.Count?(this.currentData.start=this.PageSize*this.PageIndex,this.PageIndex++,this.currentData.end=this.PageSize*this.PageIndex,f.default.ajax({url:this.ApiUrl,data:t.currentData,method:"POST",dataType:"json",success:function(e){t.RecvData(e)},fail:function(e){t.RecvError(e)}})):alert("æ°æ®å·²å¨é¨å è½½")},this.RecvData=function(t,e){var a=t.data;for(var i in a.stock){var r=a.stock[i],n=r.symbol,s={};this.Data.has(n)?s=this.Data.get(n):(s={Symbol:r.symbol,Name:r.name,Data:new l.default},this.Data.set(n,s)),this.SetStockData(r,s)}this.Callback&&this.Callback(this,e)},this.SetStockData=function(t,e){for(var a in t.stockday){var i=t.stockday[a],r=i.date,n=new l.default;this.SetFinanceData(i,n),this.SetBlocktradingData(i,n),this.SetChangesData(i,n),this.SetLiftingData(i,n),this.SetPforecastData(i,n),this.SetShortIndicatorsData(i,n),e.Data.set(r,n)}return e},this.SetFinanceData=function(t,e){var a=t.finance1;a&&(isNaN(a.nprofitincrease)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE1_NPROFITINCREASE,a.nprofitincrease),isNaN(a.nnprofitincrease)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE1_NNPROFITINCREASE,a.nnprofitincrease),isNaN(a.nnprofitspeed)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE1_NNPROFITSPEED,a.nnprofitspeed),isNaN(a.benford)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE1_BENFORD,a.benford));var i=t.announcement1;i&&(isNaN(i.year)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE1_YEAR,i.year),isNaN(i.quarter)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE1_QUARTER,i.quarter));a=t.finance2;a&&(isNaN(a.nprofitincrease)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE2_NPROFITINCREASE,a.nprofitincrease),isNaN(a.nnprofitincrease)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE2_NNPROFITINCREASE,a.nnprofitincrease),isNaN(a.nnprofitspeed)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE2_NNPROFITSPEED,a.nnprofitspeed),isNaN(a.benford)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE2_BENFORD,a.benford));i=t.announcement2;i&&(isNaN(i.year)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE2_YEAR,i.year),isNaN(i.quarter)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE2_QUARTER,i.quarter));a=t.finance3;a&&(isNaN(a.nprofitincrease)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE3_NPROFITINCREASE,a.nprofitincrease),isNaN(a.nnprofitincrease)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE3_NNPROFITINCREASE,a.nnprofitincrease),isNaN(a.nnprofitspeed)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE3_NNPROFITSPEED,a.nnprofitspeed),isNaN(a.benford)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE3_BENFORD,a.benford));i=t.announcement3;i&&(isNaN(i.year)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE3_YEAR,i.year),isNaN(i.quarter)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE3_QUARTER,i.quarter));a=t.finance4;a&&(isNaN(a.nprofitincrease)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE4_NPROFITINCREASE,a.nprofitincrease),isNaN(a.nnprofitincrease)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE4_NNPROFITINCREASE,a.nnprofitincrease),isNaN(a.nnprofitspeed)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE4_NNPROFITSPEED,a.nnprofitspeed),isNaN(a.benford)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE4_BENFORD,a.benford));i=t.announcement4;i&&(isNaN(i.year)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE4_YEAR,i.year),isNaN(i.quarter)||e.set(STOCK_HISTORY_FIELD_NAME.FINANCE4_QUARTER,i.quarter))},this.SetBlocktradingData=function(t,e){var a=t.blocktrading;a&&e.set(STOCK_HISTORY_FIELD_NAME.BLOCK_TRADING,{Premium:a.premium,Price:a.price,Vol:a.vol,Amount:a.amount})},this.SetChangesData=function(t,e){var a=t.changes;a&&e.set(STOCK_HISTORY_FIELD_NAME.HOLDERS_CHANGES,{List:a.list})},this.SetLiftingData=function(t,e){var a=t.lifting;a&&e.set(STOCK_HISTORY_FIELD_NAME.LIFTING,{Lifting:a})},this.SetPforecastData=function(t,e){var a=t.pforecast;a&&e.set(STOCK_HISTORY_FIELD_NAME.PFORECAST,{Lowprofit:a[0].lowprofit,Highprofit:a[0].highprofit,Lowchange:a[0].lowchange,Highchange:a[0].highchange,Reportdate:a[0].reportdate})},this.SetShortIndicatorsData=function(t,e){var a=t.policy;if(a){var i=["ä¸åªä¹é¸¦","ä¹äºçé¡¶","é»æä¹æ","å·¨éé´çº¿","å¤´è©é¡¶","å°å»ä¹æ","å¾çå¤§é¨","æ­å¤´é¡å","æ·¡ååæ»","ç©ºæ¹ç®","è¿ç»­1å¨ç©ºå¤´æå"],r=0,n=[],s=0,o="";a.forEach((function(t){var e=i.some((function(e){return e===t.name}));e&&(r++,n.push(t.time))})),r?(s=Math.max.apply(n,n),o=a.find((function(t){return t.time===s})).name):o="",console.log(o,r,"latestName-targetedCount"),e.set(STOCK_HISTORY_FIELD_NAME.SHORTIND_ICATORS,{latestIndicatorName:o,indicatorCount:r})}},this.RecvError=function(t,e){},this.CreateCondition=function(t){return new QueryCondition(t)}}b.Init=function(){var t=new b;return t},b.SetDomain=function(t,e){t&&(m.Domain=t),e&&(m.CacheDomain=e)},b.GetSearchStock=function(t){return new B(t)},b.GetShortTerm=function(t){return new G(t)},b.GetDealDay=function(t){return new H(t)},b.GetBlockMember=function(t){return new Y(t)},b.GetBlockTop=function(){return new k},b.GetMinuteImage=function(t){return new _(t)},b.GetHistoryDayData=function(t){return new X(t)},b.GetDealPriceListData=function(t){return new W(t)},b.GetLatestDetailData=function(t){return new U(t)},b.GetAnalylisPlate=function(){return new K},b.GetStockHistory=function(){return new R};var P={BASE_DATA:1,INDEX_BASE_DATA:2,HEAT_DATA:3,SORT_DATA:4,BUY_SELL_DATA:5,DEAL_DATA:6,DERIVATIVE_DATA:7,FINANCE_DATA:8,SEARCH_STOCK_DATA:9,SELF_STOCK_DATA:10,LOGON_DATA:11,BLOCK_MEMBER_DATA:13,SHORT_TERM_DATA:14,COMPANY_DATA:15,PLATE_DATA:16,CAPITAL_DATA:17,CAPITAL_FLOW_DAY_DATA:23,CAPITAL_FLOW_DAY3_DATA:24,CAPITAL_FLOW_DAY5_DATA:25,CAPITAL_FLOW_DAY10_DATA:26,DDE_DAY_DATA:27,DDE_DAY3_DATA:28,DDE_DAY5_DATA:29,DDE_DAY10_DATA:30,DEAL_DAY_DATA:105,EVENT_DATA:106,IMAGE_MINUTE_DATA:107,HISTORY_DAY_DATA:108,DEAL_PRICE_LIST_DATA:109,LATEST_DETAIL_DATA:110};function b(){this.MapStock=new l.default,this.MapTagCallback=new l.default,this.RequestVersion=new Array([100,100,100]),this.RealtimeApiUrl=m.Domain+"/API/Stock",this.PlateQuadrantApiUrl=m.Domain+"/API/StockPlateQuadrant",this.IsAutoUpdate=!0,this.AutoUpateTimeout=15e3,this.Timeout,this.NetworkFilter,this.GetStockRead=function(t,e){var a=!0,i=!1,r=void 0;try{for(var n,s=(0,o.default)(this.MapStock);!(a=(n=s.next()).done);a=!0){var h=n.value;h[1].RemoveTagID(t)}}catch(u){i=!0,r=u}finally{try{!a&&s.return&&s.return()}finally{if(i)throw r}}this.MapTagCallback.set(t,e);var l=new O(this,t);return l},this.Unsubscribe=function(t){var e=!0,a=!1,i=void 0;try{for(var r,n=(0,o.default)(this.MapStock);!(e=(r=n.next()).done);e=!0){var s=r.value;s[1].RemoveTagID(t)}}catch(h){a=!0,i=h}finally{try{!e&&n.return&&n.return()}finally{if(a)throw i}}},this.UnsubscribeStock=function(t,e){var a=!0,i=!1,r=void 0;try{for(var n,s=(0,o.default)(this.MapStock);!(a=(n=s.next()).done);a=!0){var h=n.value;if(h[0]===t){e?h[1].RemoveTagID(e):h[1].ClearTagID(),console.log("[JSStock::UnsubscribeStock] symbol="+t+", tagID="+e);break}}}catch(l){i=!0,r=l}finally{try{!a&&s.return&&s.return()}finally{if(i)throw r}}},this.Get=function(t,e){this.MapStock.has(t)||this.MapStock.set(t,new A(t));var a=this.MapStock.get(t);return e&&a.AttachTagID(e),a},this.RequestData=function(){this.ClearTimer();var t=new Array,e=new Array,a=new Array,i=new Array,r=new Array,n=new Array,s=new Array,h=[],l=[],u=[],C=[],D=[],f=[],c=[],d=[],m=new Array,v=new Array,S=new Array,I=new Array,p=!0,T=!1,g=void 0;try{for(var x,F=(0,o.default)(this.MapStock);!(p=(x=F.next()).done);p=!0){var y=x.value,L=y[1],E=y[0];L.BaseDataTagID.size>0&&(M(E)?e.push(E):t.push(E)),L.BuySellTagID.size>0&&i.push(E),L.CapitalFlowDayID.size>0&&h.push(E),L.CapitalFlowDay3ID.size>0&&l.push(E),L.CapitalFlowDay5ID.size>0&&u.push(E),L.CapitalFlowDay10ID.size>0&&C.push(E),L.DDEID.size>0&&D.push(E),L.DDE3ID.size>0&&f.push(E),L.DDE5ID.size>0&&c.push(E),L.DDE10ID.size>0&&d.push(E),L.HeatTagID.size>0&&a.push(E),L.DealTagID.size>0&&r.push(E),L.DerivativeTagID.size>0&&n.push(E),L.FinanceTagID.size>0&&s.push(E),L.CapitalTagID.size>0&&I.push(E),null==L.Event&&L.EventTagID.size>0&&m.push(E),null==L.Company&&L.CompanyTagID.size>0&&v.push(E),null==y[1].Plate&&y[1].PlateTagID.size>0&&S.push(y[0])}}catch(A){T=!0,g=A}finally{try{!p&&F.return&&F.return()}finally{if(T)throw g}}i.length>0&&this.RequestBuySellData(i),t.length>0&&this.RequestBaseData(t),e.length>0&&this.RequestIndexBaseData(e),a.length>0&&this.RequestIndexHeatData(a),r.length>0&&this.RequestDealData(r),n.length>0&&this.RequestDerivativeData(n),s.length>0&&this.RequestFinanceData(s),I.length>0&&this.RequestCapitalData(I),h.length>0&&this.RequestSubDocumentData(h,"flowday"),l.length>0&&this.RequestSubDocumentData(l,"flowday3"),u.length>0&&this.RequestSubDocumentData(u,"flowday5"),C.length>0&&this.RequestSubDocumentData(C,"flowday10"),D.length>0&&this.RequestSubDocumentData(D,"dde"),f.length>0&&this.RequestSubDocumentData(f,"dde3"),c.length>0&&this.RequestSubDocumentData(c,"dde5"),d.length>0&&this.RequestSubDocumentData(d,"dde10"),m.length>0&&this.RequestEventData(m),v.length>0&&this.RequestCompanyData(v),S.length>0&&this.RequestPlateData(S),this.ReqeustAllSortData()},this.ReqeustData=this.RequestData,this.RequestBaseData=function(t){var e=this,a=["name","symbol","yclose","open","price","high","low","vol","amount","date","time","week","increase","exchangerate","amplitude","volratio"];if(this.NetworkFilter){var i={Name:"JSStock::RequestBaseData",Explain:"è¡ç¥¨åºç¡æ°æ®",ID:P.BASE_DATA,Request:{Url:e.RealtimeApiUrl,Data:{field:a,symbol:t},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(i,(function(t){e.RecvData(t,P.BASE_DATA)})),1==i.PreventDefault)return}f.default.ajax({url:this.RealtimeApiUrl,data:{field:a,symbol:t},type:"post",dataType:"json",async:!0,success:function(t){e.RecvData(t,P.BASE_DATA)},error:function(t){e.RecvError(t,P.BASE_DATA)}})},this.RequestDerivativeData=function(t){var e=this,a=["name","symbol","marketvalue","flowmarketvalue","pe","pe2","pe3","pb","bookrate","bookdiffer"];if(this.NetworkFilter){var i={Name:"JSStock::RequestDerivativeData",Explain:"å®æ¶è¡çæ°æ®",ID:P.DERIVATIVE_DATA,Request:{Url:e.RealtimeApiUrl,Data:{field:a,symbol:t},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(i,(function(t){e.RecvData(t,P.DERIVATIVE_DATA)})),1==i.PreventDefault)return}f.default.ajax({url:this.RealtimeApiUrl,data:{field:a,symbol:t},type:"post",dataType:"json",async:!0,success:function(t){e.RecvData(t,P.DERIVATIVE_DATA)},error:function(t){e.RecvError(t,P.DERIVATIVE_DATA)}})},this.RequestFinanceData=function(t){var e=this,a=["name","symbol","roe","finance"];if(this.NetworkFilter){var i={Name:"JSStock::RequestFinanceData",Explain:"è´¢å¡æ°æ®",ID:P.FINANCE_DATA,Request:{Url:e.RealtimeApiUrl,Data:{field:a,symbol:t},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(i,(function(t){e.RecvData(t,P.FINANCE_DATA)})),1==i.PreventDefault)return}f.default.ajax({url:this.RealtimeApiUrl,data:{field:a,symbol:t},type:"post",dataType:"json",async:!0,success:function(t){e.RecvData(t,P.FINANCE_DATA)},error:function(t){e.RecvError(t,P.FINANCE_DATA)}})},this.RequestCapitalData=function(t){var e=this,a=["name","symbol","capital"];if(this.NetworkFilter){var i={Name:"JSStock::RequestCapitalData",Explain:"è¡æ¬æ°æ®",ID:P.CAPITAL_DATA,Request:{Url:e.RealtimeApiUrl,Data:{field:a,symbol:t},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(i,(function(t){e.RecvData(t,P.CAPITAL_DATA)})),1==i.PreventDefault)return}f.default.ajax({url:this.RealtimeApiUrl,data:{field:a,symbol:t},type:"post",dataType:"json",async:!0,success:function(t){e.RecvData(t,P.CAPITAL_DATA)},error:function(t){e.RecvError(t,P.CAPITAL_DATA)}})},this.RequestBuySellData=function(t){var e=this,a=["name","symbol","yclose","open","price","high","low","vol","amount","date","time","week","increase","buy","sell","exchangerate","amplitude"];if(this.NetworkFilter){var i={Name:"JSStock::RequestBuySellData",Explain:"ä¹°åçæ°æ®",ID:P.BUY_SELL_DATA,Request:{Url:e.RealtimeApiUrl,Data:{field:a,symbol:t},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(i,(function(t){e.RecvData(t,P.BUY_SELL_DATA)})),1==i.PreventDefault)return}f.default.ajax({url:this.RealtimeApiUrl,data:{field:a,symbol:t},type:"post",dataType:"json",async:!0,success:function(t){e.RecvData(t,P.BUY_SELL_DATA)},error:function(t){e.RecvError(t,P.BUY_SELL_DATA)}})},this.RequestDealData=function(t){var e=this,a=["name","symbol","price","high","low","vol","amount","date","time","increase","deal"];if(this.NetworkFilter){var i={Name:"JSStock::RequestDealData",Explain:"åç¬æ°æ®",ID:P.DEAL_DATA,Request:{Url:e.RealtimeApiUrl,Data:{field:a,symbol:t},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(i,(function(t){e.RecvData(t,P.DEAL_DATA)})),1==i.PreventDefault)return}f.default.ajax({url:this.RealtimeApiUrl,data:{field:a,symbol:t},type:"post",dataType:"json",async:!0,success:function(t){e.RecvData(t,P.DEAL_DATA)},error:function(t){e.RecvError(t,P.DEAL_DATA)}})},this.RequestIndexBaseData=function(t){var e=this,a=["name","symbol","yclose","open","price","high","low","vol","amount","date","time","week","indextop","increase"];if(this.NetworkFilter){var i={Name:"JSStock::RequestIndexBaseData",Explain:"ææ°åºç¡æ°æ®(åå«ä¸æ¶¨ä¸è·å®¶æ°)",ID:P.INDEX_BASE_DATA,Request:{Url:e.RealtimeApiUrl,Data:{field:a,symbol:t},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(i,(function(t){e.RecvData(t,P.INDEX_BASE_DATA)})),1==i.PreventDefault)return}f.default.ajax({url:this.RealtimeApiUrl,data:{field:a,symbol:t},type:"post",dataType:"json",async:!0,success:function(t){console.log(t),e.RecvData(t,P.INDEX_BASE_DATA)},error:function(t){e.RecvError(t,P.INDEX_BASE_DATA)}})},this.RequestIndexHeatData=function(t){var e=this;f.default.ajax({url:this.PlateQuadrantApiUrl,data:{plate:t},type:"post",dataType:"json",async:!0,success:function(t){e.RecvData(t,P.HEAT_DATA)},error:function(t){e.RecvError(t,P.HEAT_DATA)}})},this.ReqeustAllSortData=function(){var t=new Array,e=!0,a=!1,i=void 0;try{for(var r,n=(0,o.default)(this.MapStock);!(e=(r=n.next()).done);e=!0){var s=r.value;if(M(s[0])&&!(null==s[1].Sort||s[1].Sort.size<=0)){var h=!0,l=!1,u=void 0;try{for(var C,D=(0,o.default)(s[1].Sort);!(h=(C=D.next()).done);h=!0){var f=C.value,c=f[1],d={Plate:s[0],SortField:c.SortField,Order:c.Order,TagID:c.TagID};t.push(d)}}catch(v){l=!0,u=v}finally{try{!h&&D.return&&D.return()}finally{if(l)throw u}}}}}catch(v){a=!0,i=v}finally{try{!e&&n.return&&n.return()}finally{if(a)throw i}}for(var m in t){f=t[m];this.ReqeustSortData(f)}},this.ReqeustSortData=function(t){var e=this,a=t,i="";switch(a.SortField){case N.INCREASE:i="increase";break;case N.PRICE:i="price";break;default:return}var r=["name","symbol","yclose","open","price","high","low","vol","amount","date","time","week","increase","exchangerate"];if(this.NetworkFilter){var n={Name:"JSStock::ReqeustSortData",Explain:"æ¿åæåºæ°æ®",ID:P.SORT_DATA,Request:{Url:e.RealtimeApiUrl,Data:{field:r,plate:[t.Plate],orderfield:i,order:t.Order,ordernull:1,filterstop:1},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(n,(function(t){e.RecvData(t,P.SORT_DATA,a)})),1==n.PreventDefault)return}f.default.ajax({url:this.RealtimeApiUrl,data:{field:r,plate:[t.Plate],orderfield:i,order:t.Order,ordernull:1,filterstop:1},type:"post",dataType:"json",async:!0,success:function(t){e.RecvData(t,P.SORT_DATA,a)},error:function(t){e.RecvError(t,P.SORT_DATA,a)}})},this.RequestSubDocumentData=function(t,e){var a=this,i=new l.default([["flowday",{Field:"flowday",RecvID:P.CAPITAL_FLOW_DAY_DATA}],["flowday3",{Field:"flowday3",RecvID:P.CAPITAL_FLOW_DAY3_DATA}],["flowday5",{Field:"flowday5",RecvID:P.CAPITAL_FLOW_DAY5_DATA}],["flowday10",{Field:"flowday10",RecvID:P.CAPITAL_FLOW_DAY10_DATA}],["dde",{Field:"dde",RecvID:P.DDE_DAY_DATA}],["dde3",{Field:"dde3",RecvID:P.DDE_DAY3_DATA}],["dde5",{Field:"dde5",RecvID:P.DDE_DAY5_DATA}],["dde10",{Field:"dde10",RecvID:P.DDE_DAY10_DATA}]]);if(i.has(e)){var r=i.get(e);if(this.NetworkFilter){var n={Name:"JSStock::RequestSubDocumentData",Explain:"å­ææ¡£æ°æ®",ID:r.RecvID,Request:{Url:a.RealtimeApiUrl,Data:{field:["symbol",r.Field],symbol:t,start:0,end:50},Type:"POST"},Self:this,PreventDefault:!1};if(this.NetworkFilter(n,(function(t){a.RecvData(t,r.RecvID)})),1==n.PreventDefault)return}f.default.ajax({url:this.RealtimeApiUrl,data:{field:["symbol",r.Field],symbol:t,start:0,end:50},type:"post",dataType:"json",success:function(t){a.RecvData(t,r.RecvID)},error:function(t){a.RecvError(t,r.RecvID)}})}},this.RequestEventData=function(t){var e=this;f.default.ajax({url:this.RealtimeApiUrl,data:{field:["symbol","events.margin","events.shhk","events.hk","events.st","events.hksymbol","events.hkname","events.szhk"],symbol:t,start:0,end:50},type:"POST",dataType:"json",success:function(t){e.RecvData(t,P.EVENT_DATA)},error:function(t){e.RecvError(t,P.EVENT_DATA)}})},this.RequestCompanyData=function(t){var e=this;f.default.ajax({url:this.RealtimeApiUrl,data:{field:["name","symbol","company"],symbol:t,start:0,end:50},type:"POST",dataType:"json",success:function(t){e.RecvData(t,P.COMPANY_DATA)},error:function(t){e.RecvError(t,P.COMPANY_DATA)}})},this.RequestPlateData=function(t){var e=this;f.default.ajax({url:this.RealtimeApiUrl,data:{field:["name","symbol","industry","region","concept"],symbol:t,start:0,end:50},type:"POST",dataType:"json",success:function(t){e.RecvData(t,P.PLATE_DATA)},error:function(t){e.RecvError(t,P.PLATE_DATA)}})},this.RecvError=function(t,e,a){console.log("RecvError: datatype="+e.toString()),console.log(t);var i=this;this.Timeout&&clearTimeout(this.Timeout),this.Timeout=setTimeout((function(){i.ReqeustData()}),2*this.AutoUpateTimeout)},this.RecvData=function(t,e,a){var i;switch(e){case P.BASE_DATA:case P.INDEX_BASE_DATA:i=this.RecvBaseData(t,e);break;case P.HEAT_DATA:i=this.RecvHeatData(t,e);break;case P.SORT_DATA:i=this.RecvSortData(t,e,a);break;case P.BUY_SELL_DATA:i=this.RecvBuySellData(t,e);break;case P.DEAL_DATA:i=this.RecvDealData(t,e);break;case P.DERIVATIVE_DATA:i=this.RecvDerivativeData(t,e);break;case P.FINANCE_DATA:i=this.RecvFinanceData(t,e);break;case P.CAPITAL_DATA:i=this.RecvCapitalData(t,e);break;case P.CAPITAL_FLOW_DAY_DATA:case P.CAPITAL_FLOW_DAY3_DATA:case P.CAPITAL_FLOW_DAY5_DATA:case P.CAPITAL_FLOW_DAY10_DATA:case P.DDE_DAY_DATA:case P.DDE_DAY3_DATA:case P.DDE_DAY5_DATA:case P.DDE_DAY10_DATA:i=this.RecvSubDocumentData(t,e);break;case P.EVENT_DATA:i=this.RecvEventData(t,e);break;case P.COMPANY_DATA:i=this.RecvCompanyData(t,e);break;case P.PLATE_DATA:i=this.RecvPlateData(t,e);break}var r=!0,n=!1,s=void 0;try{for(var h,l=(0,o.default)(i);!(r=(h=l.next()).done);r=!0){var u=h.value;this.MapTagCallback.has(u[0])&&this.MapTagCallback.get(u[0])(u[0],u[1],e,this)}}catch(C){n=!0,s=C}finally{try{!r&&l.return&&l.return()}finally{if(n)throw s}}this.AutoUpdate()},this.ClearTimer=function(){this.Timeout&&(clearTimeout(this.Timeout),this.Timeout=null)},this.AutoUpdate=function(){if(this.ClearTimer(),this.IsAutoUpdate){var t=this,e=!1,a=!0,i=!1,r=void 0;try{for(var n,s=(0,o.default)(this.MapStock);!(a=(n=s.next()).done);a=!0){var h=n.value,l=J.GetMarketStatus(h[0]);if(2==l)return void(this.Timeout=setTimeout((function(){t.ReqeustData()}),this.AutoUpateTimeout));1==l&&(e=!0)}}catch(u){i=!0,r=u}finally{try{!a&&s.return&&s.return()}finally{if(i)throw r}}e&&(this.Timeout=setTimeout((function(){t.AutoUpdate()}),this.AutoUpateTimeout))}},this.RecvBaseData=function(t,e){var a=new l.default;for(var i in t.stock){var r=t.stock[i],n=this.MapStock.get(r.symbol);if(n){switch(e){case P.BASE_DATA:n.SetBaseData(r);break;case P.INDEX_BASE_DATA:n.SetIndexBaseData(r);break;default:continue}if(n.TagID.size>0){var s=!0,h=!1,u=void 0;try{for(var C,D=(0,o.default)(n.TagID);!(s=(C=D.next()).done);s=!0){var f=C.value;a.has(f)?a.get(f).push(n.Symbol):a.set(f,new Array(n.Symbol))}}catch(c){h=!0,u=c}finally{try{!s&&D.return&&D.return()}finally{if(h)throw u}}}}}return a},this.RecvBuySellData=function(t,e){var a=new l.default;for(var i in t.stock){var r=t.stock[i],n=this.MapStock.get(r.symbol);if(n){if(n.SetBuySellData(r),n.TagID.size>0){var s=!0,h=!1,u=void 0;try{for(var C,D=(0,o.default)(n.TagID);!(s=(C=D.next()).done);s=!0){var f=C.value;a.has(f)?a.get(f).push(n.Symbol):a.set(f,new Array(n.Symbol))}}catch(I){h=!0,u=I}finally{try{!s&&D.return&&D.return()}finally{if(h)throw u}}}if(n.BuySellTagID.size>0){var c=!0,d=!1,m=void 0;try{for(var v,S=(0,o.default)(n.BuySellTagID);!(c=(v=S.next()).done);c=!0){f=v.value;a.has(f)?a.get(f).push(n.Symbol):a.set(f,new Array(n.Symbol))}}catch(I){d=!0,m=I}finally{try{!c&&S.return&&S.return()}finally{if(d)throw m}}}}}return a},this.RecvDerivativeData=function(t,e){var a=new l.default;for(var i in t.stock){var r=t.stock[i],n=this.MapStock.get(r.symbol);if(n&&(n.SetDerivativeData(r),n.DerivativeTagID.size>0)){var s=!0,h=!1,u=void 0;try{for(var C,D=(0,o.default)(n.DerivativeTagID);!(s=(C=D.next()).done);s=!0){var f=C.value;a.has(f)?a.get(f).push(n.Symbol):a.set(f,new Array(n.Symbol))}}catch(c){h=!0,u=c}finally{try{!s&&D.return&&D.return()}finally{if(h)throw u}}}}return a},this.RecvFinanceData=function(t,e){var a=new l.default;for(var i in t.stock){var r=t.stock[i],n=this.MapStock.get(r.symbol);if(n&&(n.SetFinanceData(r),n.FinanceTagID.size>0)){var s=!0,h=!1,u=void 0;try{for(var C,D=(0,o.default)(n.FinanceTagID);!(s=(C=D.next()).done);s=!0){var f=C.value;a.has(f)?a.get(f).push(n.Symbol):a.set(f,new Array(n.Symbol))}}catch(c){h=!0,u=c}finally{try{!s&&D.return&&D.return()}finally{if(h)throw u}}}}return a},this.RecvCapitalData=function(t,e){var a=new l.default;for(var i in t.stock){var r=t.stock[i],n=this.MapStock.get(r.symbol);if(n&&(n.SetCapitalData(r),n.CapitalTagID.size>0)){var s=!0,h=!1,u=void 0;try{for(var C,D=(0,o.default)(n.CapitalTagID);!(s=(C=D.next()).done);s=!0){var f=C.value;a.has(f)?a.get(f).push(n.Symbol):a.set(f,new Array(n.Symbol))}}catch(c){h=!0,u=c}finally{try{!s&&D.return&&D.return()}finally{if(h)throw u}}}}return a},this.RecvDealData=function(t,e){var a=new l.default;for(var i in t.stock){var r=t.stock[i],n=this.MapStock.get(r.symbol);if(n&&(n.SetDealData(r),n.DealTagID.size>0)){var s=!0,h=!1,u=void 0;try{for(var C,D=(0,o.default)(n.DealTagID);!(s=(C=D.next()).done);s=!0){var f=C.value;a.has(f)?a.get(f).push(n.Symbol):a.set(f,new Array(n.Symbol))}}catch(c){h=!0,u=c}finally{try{!s&&D.return&&D.return()}finally{if(h)throw u}}}}return a},this.RecvHeatData=function(t,e){var a=new l.default;for(var i in t.data){var r=t.data[i],n=this.MapStock.get(r.symbol);if(n&&(n.SetHeatData(r),n.HeatTagID.size>0)){var s=!0,h=!1,u=void 0;try{for(var C,D=(0,o.default)(n.HeatTagID);!(s=(C=D.next()).done);s=!0){var f=C.value;a.has(f)?a.get(f).push(n.Symbol):a.set(f,new Array(n.Symbol))}}catch(c){h=!0,u=c}finally{try{!s&&D.return&&D.return()}finally{if(h)throw u}}}}return a},this.RecvSortData=function(t,e,a){var i=new l.default,r=new Array,n=this.MapStock.get(a.Plate);for(var s in t.stock){var h=t.stock[s];if(r.push(h.symbol),this.MapStock.has(h.symbol)){var u=this.MapStock.get(h.symbol);u.SetBaseData(h)}else{u=new A(h.symbol);u.SetBaseData(h),this.MapStock.set(h.symbol,u)}}var C=a.SortField.toString()+"-"+a.Order.toString();if(!n.Sort.has(C))return i;var D=n.Sort.get(C);D.arySymbol=r;var f=!0,c=!1,d=void 0;try{for(var m,v=(0,o.default)(a.TagID);!(f=(m=v.next()).done);f=!0){h=m.value;i.set(h,new Array([n.Symbol]))}}catch(S){c=!0,d=S}finally{try{!f&&v.return&&v.return()}finally{if(c)throw d}}return i},this.RecvSubDocumentData=function(t,e){var a=new l.default;for(var i in t.stock){var r=t.stock[i],n=this.MapStock.get(r.symbol);if(n){var s=null;switch(e){case P.CAPITAL_FLOW_DAY_DATA:n.SetCapitalFlowDayData(r.flowday,e),s=n.CapitalFlowDayID;break;case P.CAPITAL_FLOW_DAY3_DATA:n.SetCapitalFlowDayData(r.flowday3,e),s=n.CapitalFlowDay3ID;break;case P.CAPITAL_FLOW_DAY5_DATA:n.SetCapitalFlowDayData(r.flowday5,e),s=n.CapitalFlowDay5ID;break;case P.CAPITAL_FLOW_DAY10_DATA:n.SetCapitalFlowDayData(r.flowday10,e),s=n.CapitalFlowDay10ID;break;case P.DDE_DAY_DATA:n.SetDDE(r.dde,e),s=n.DDEID;break;case P.DDE_DAY3_DATA:n.SetDDE(r.dde3,e),s=n.DDE3ID;break;case P.DDE_DAY5_DATA:n.SetDDE(r.dde5,e),s=n.DDE5ID;break;case P.DDE_DAY10_DATA:n.SetDDE(r.dde10,e),s=n.DDE10ID;break}if(s&&s.size>0){var h=!0,u=!1,C=void 0;try{for(var D,f=(0,o.default)(s);!(h=(D=f.next()).done);h=!0){var c=D.value;a.has(c)?a.get(c).push(n.Symbol):a.set(c,new Array(n.Symbol))}}catch(d){u=!0,C=d}finally{try{!h&&f.return&&f.return()}finally{if(u)throw C}}}}}return a},this.RecvEventData=function(t,e){var a=new l.default;for(var i in t.stock){var r=t.stock[i],n=this.MapStock.get(r.symbol);if(n&&(n.SetEventData(r),n.EventTagID.size>0)){var s=!0,h=!1,u=void 0;try{for(var C,D=(0,o.default)(n.EventTagID);!(s=(C=D.next()).done);s=!0){var f=C.value;a.has(f)?a.get(f).push(n.Symbol):a.set(f,new Array(n.Symbol))}}catch(c){h=!0,u=c}finally{try{!s&&D.return&&D.return()}finally{if(h)throw u}}}}return a},this.RecvCompanyData=function(t,e){var a=new l.default;for(var i in t.stock){var r=t.stock[i],n=this.MapStock.get(r.symbol);if(n&&(n.SetCompanyData(r),n.CompanyTagID.size>0)){var s=!0,h=!1,u=void 0;try{for(var C,D=(0,o.default)(n.CompanyTagID);!(s=(C=D.next()).done);s=!0){var f=C.value;a.has(f)?a.get(f).push(n.Symbol):a.set(f,new Array(n.Symbol))}}catch(c){h=!0,u=c}finally{try{!s&&D.return&&D.return()}finally{if(h)throw u}}}}return a},this.RecvPlateData=function(t,e){var a=new l.default;for(var i in t.stock){var r=t.stock[i],n=this.MapStock.get(r.symbol);if(n&&(n.SetPlateData(r),n.PlateTagID.size>0)){var s=!0,h=!1,u=void 0;try{for(var C,D=(0,o.default)(n.PlateTagID);!(s=(C=D.next()).done);s=!0){var f=C.value;a.has(f)?a.get(f).push(n.Symbol):a.set(f,new Array(n.Symbol))}}catch(c){h=!0,u=c}finally{try{!s&&D.return&&D.return()}finally{if(h)throw u}}}}return a}}function B(t){this.SearchStockApiUrl=m.Domain+"/API/StockSpell",this.UpdateUICallback=t,this.PageSize=50,this.Count,this.EndOffset,this.Data=new Array,this.SearchString="",this.SearchType=0,this.Search=function(t,e){if(this.SearchString==t&&this.SearchType==e)"function"==typeof this.UpdateUICallback&&this.UpdateUICallback(this);else{this.SearchString=t,this.SearchType=e,this.Count=0,this.EndOffset=0,this.Data=[];var a=this.PageSize-1;this.ReqeustSearchStock(this.SearchString,this.SearchType,this.EndOffset,a)}},this.IsEndPage=function(){return this.Count<=0||this.EndOffset>this.Count-1},this.NextPage=function(){if(!(this.EndOffset+1>this.Count)){var t=this.EndOffset+this.PageSize;this.ReqeustSearchStock(this.SearchString,this.SearchType,this.EndOffset,t)}},this.ReqeustSearchStock=function(t,e,a,i){var r=this;f.default.ajax({url:this.SearchStockApiUrl,data:{input:t,start:a,end:i,type:e},type:"post",dataType:"json",async:!0,success:function(t){r.RecvSearchStockData(t,P.SEARCH_STOCK_DATA)},error:function(t){r.RecvError(t,P.SEARCH_STOCK_DATA)}})},this.RecvSearchStockData=function(t){for(var e in t.stock){var a=t.stock[e];this.Data.push({Name:a.name,Symbol:a.symbol,Type:a.type})}0==t.count?(this.Count=0,this.EndOffset=0):(0==this.Count&&(this.Count=t.count),this.EndOffset=t.end,this.Count>0&&this.EndOffset>this.Count&&(this.EndOffset=this.Count-1)),"function"==typeof this.UpdateUICallback&&this.UpdateUICallback(this)},this.RecvError=function(t,e){console.log("[SearchStock::RecvError] datatype="+e.toString()),console.log(t),"function"==typeof this.UpdateUICallback&&this.UpdateUICallback(this,"error")}}function V(){this.IsAutoUpdate=!0,this.AutoUpateTimeout=5e3,this.Timeout,this.ApiUrl,this.Data,this.Error,this.UpdateUICallback,this.RequestData=function(){},this.Stop=function(){this.IsAutoUpdate=!1,this.Timeout&&clearTimeout(this.Timeout)},this.AutoUpate=function(){if(this.Timeout&&clearTimeout(this.Timeout),this.IsAutoUpdate&&(this.Timeout&&clearTimeout(this.Timeout),this.IsAutoUpdate)){var t=this;if(this.Symbol){var e=J.GetMarketStatus(this.Symbol);2==e?this.Timeout=setTimeout((function(){t.RequestData()}),this.AutoUpateTimeout):1==e&&(this.Timeout=setTimeout((function(){t.AutoUpdate()}),this.AutoUpateTimeout))}else{t=this;var a=new Date,i=100*a.getHours()+a.getMinutes();a.getDay()>0&&a.getDay()<6&&i>=930&&i<1530&&(this.Timeout=setTimeout((function(){t.RequestData()}),this.AutoUpateTimeout))}}},this.InvokeUpdateUICallback=function(){this.UpdateUICallback&&this.UpdateUICallback(this)}}function G(t){this.newMethod=V,this.newMethod(),delete this.newMethod,this.Symbol=t,this.ApiUrl=m.Domain+"/API/StockShortTerm",this.Count=20,this.RequestData=function(){var t=this,e={count:this.Count};this.Symbol&&(e.symbol=this.Symbol),f.default.ajax({url:this.ApiUrl,data:e,type:"post",dataType:"json",async:!0,success:function(e){t.RecvData(e,P.SHORT_TERM_DATA)},fail:function(e){t.RecvError(e,P.SHORT_TERM_DATA)}})},this.RecvData=function(t,e){for(var a in this.Data=[],t.shortterm){var i=t.shortterm[a];this.Data.push({Date:i.date,Name:i.name,Symbol:i.symbol,Time:i.time,Content:i.content,TypeInfo:i.typeinfo,Type:i.type})}this.UpdateUICallback&&this.UpdateUICallback(this),this.AutoUpate()},this.RecvError=function(t,e){}}function H(t){this.newMethod=V,this.newMethod(),delete this.newMethod,this.Symbol=t,this.Date,this.RequestData=function(){this.Data=null,this.Error=null;var t=this,e=m.CacheDomain+"/cache/dealday/day/"+this.Date+"/"+this.Symbol+".json";console.log("[DealDay::RequestData] cache url ",e),f.default.ajax({url:e,type:"get",dataType:"json",async:!0,success:function(e){t.RecvData(e,P.DEAL_DAY_DATA)},error:function(e){t.RecvError(e,P.DEAL_DAY_DATA)}})},this.RecvData=function(t,e){if(t.day&&t.deal){var a=t.deal.amount,i=t.deal.price,r=t.deal.time,n=t.deal.vol,s=t.deal.flag;if(s&&n&&r&&i&&a){for(var h={Date:t.date,Open:t.day.open,Close:t.day.price,YClose:t.day.yclose,Symbol:t.symbol,Name:t.name,Deal:[],PriceList:[]},u=new l.default,C=0,D=Math.min(r.length,n.length,s.length,i.length,a.length),f=0;f<D;++f){var c,d={Time:r[f],Vol:n[f],Flag:"",Price:i[f],Amount:a[f]};0===s[f]?d.Flag="B":1===s[f]&&(d.Flag="S"),d.Time>15e4&&(d.Time=15e4),h.Deal.push(d),u.has(d.Price)?(c=u.get(d.Price),c.Vol+=d.Vol):(c={Vol:d.Vol,Price:d.Price,BuyVol:0,SellVol:0,NoneVol:0},u.set(d.Price,c)),0===s[f]?c.BuyVol+=d.Vol:1===s[f]?c.SellVol+=d.Vol:c.NoneVol+=d.Vol,C+=d.Vol}var m=!0,v=!1,S=void 0;try{for(var I,p=(0,o.default)(u);!(m=(I=p.next()).done);m=!0){var T=I.value,g=T[1];C>0&&(g.Proportion=g.Vol/C),h.PriceList.push(g)}}catch(x){v=!0,S=x}finally{try{!m&&p.return&&p.return()}finally{if(v)throw S}}h.PriceList.sort((function(t,e){return e.Price-t.Price})),this.Data=h,this.InvokeUpdateUICallback()}else this.InvokeUpdateUICallback()}else this.InvokeUpdateUICallback()},this.RecvError=function(t,e){console.log("[DealDay::RecvError] status="+t.status+" statusText="+t.statusText+" responseText="+t.responseText),this.Error={Status:t.status,Message:t.responseText},this.InvokeUpdateUICallback()}}function Y(t){this.newMethod=V,this.newMethod(),delete this.newMethod,this.ApiUrl=m.Domain+"/API/StockBlockMember",this.PageSize=10,this.Start=0,this.OrderField,this.Order,this.Symbol=t,this.OrderNull=0,this.Field=new Array,this.Data=new Array,this.PageInfo,this.SetField=function(t){for(var e in this.Field=new Array,t){var a=t[e],i=w.GetFieldName(a);null!=i&&this.Field.push(i)}return this.Field.length>0},this.SetOrder=function(t,e){this.Order=null,this.OrderField=null;var a=w.GetFieldName(t);return null!=a&&(this.OrderField=a,this.Order=e,!0)},this.RequestData=function(){this.Data=[];var t=this;f.default.ajax({url:this.ApiUrl,data:{symbol:this.Symbol,field:this.Field,order:this.Order,orderfield:this.OrderField,start:this.Start,end:this.Start+this.PageSize,ordernull:this.OrderNull},type:"post",dataType:"json",success:function(e){t.RecvData(e,P.BLOCK_MEMBER_DATA)},error:function(e){t.RecvError(e,P.BLOCK_MEMBER_DATA)}})},this.RecvData=function(t,e){for(var a in t.stock){var i=t.stock[a];if(null!=i.symbol){var r=new A(i.symbol);r.SetData(i),this.Data.push(r)}}this.PageInfo={Count:t.count,Start:t.start,End:t.end},"function"==typeof this.UpdateUICallback&&this.UpdateUICallback(this),this.AutoUpate()},this.RecvError=function(t,e){}}function k(){this.newMethod=V,this.newMethod(),delete this.newMethod,this.BlockType=1,this.Count=20,this.OrderField="increase",this.Order=-1,this.Field=["symbol","price","name","vol","increase","indextop","risefall"],this.ApiUrl=m.Domain+"/API/StockBlockTop",this.SetField=function(t){},this.ReqeustData=function(){var t=this;f.default.ajax({url:this.ApiUrl,data:{blocktype:this.BlockType,start:0,end:this.Count,field:this.Field,orderfield:this.OrderField,order:this.Order},type:"post",dataType:"json",async:!0,success:function(e){t.RecvData(e,P.BLOCK_TOP_DATA)},fail:function(e){t.RecvError(e,P.BLOCK_TOP_DATA)}})},this.RecvData=function(t,e){var a=t;for(var i in this.Data=[],this.resCount=a.count,a.stock){var r=a.stock[i];if(null!=r.indextop)var n={Down:r.indextop.down,Stop:r.indextop.stop,Up:r.indextop.up,Unchanged:r.indextop.unchanged,DownStock:{Name:r.indextop.downstock.name,Symbol:r.indextop.downstock.symbol},UpStock:{Name:r.indextop.upstock.name,Symbol:r.indextop.upstock.symbol}};this.Data.push({Name:r.name,Symbol:r.symbol,Increase:r.increase,Risefall:r.risefall,IndexTop:n})}this.UpdateUICallback&&this.UpdateUICallback(this),this.AutoUpate()},this.RecvError=function(t,e){}}function _(t){this.newMethod=V,this.newMethod(),delete this.newMethod,this.ApiUrl=m.Domain+"/API/StockMinuteImage",this.Symbol=[t],this.Data=[],this.RequestData=function(){this.Data=[];var t=this;f.default.ajax({url:this.ApiUrl,data:{symbol:this.Symbol},type:"post",dataType:"json",success:function(e){t.RecvData(e,P.IMAGE_MINUTE_DATA)},error:function(e){t.RecvError(e,P.IMAGE_MINUTE_DATA)}})},this.RecvData=function(t,e){for(var a in t.symbol){var i={Symbol:t.symbol[a],Image:t.imagerelative[a]};this.Data.push(i)}"function"==typeof this.UpdateUICallback&&this.UpdateUICallback(this)},this.RecvError=function(t,e){}}function X(t){this.newMethod=V,this.newMethod(),delete this.newMethod,this.Symbol=t,this.RequestData=function(){this.Data=null,this.Error=null;var t=this,e=m.CacheDomain+"/cache/historyday/all/"+this.Symbol+".json";console.log("[HistoryDayData::RequestData] cache url ",e),f.default.ajax({url:e,type:"get",dataType:"json",async:!0,success:function(e){t.RecvData(e,P.HISTORY_DAY_DATA)},error:function(e){t.RecvError(e,P.HISTORY_DAY_DATA)}})},this.RecvData=function(t,e){if(t.symbol&&t.name){var a=t.amount,i=t.close,r=t.date,n=t.high,s=t.low,o=t.open,h=t.vol,l=t.yclose;if(a&&i&&r&&n&&s&&o&&h&&l){for(var u={UpdateDate:t.update,Symbol:t.symbol,Name:t.name,KLine:[]},C=0;C<r.length;++C){var D={Date:r[C],YClose:l[C],Open:o[C],High:n[C],Low:s[C],Close:i[C],Vol:h[C],Amount:a[C]};u.KLine.push(D)}this.Data=u,this.InvokeUpdateUICallback()}else this.InvokeUpdateUICallback()}else this.InvokeUpdateUICallback()},this.RecvError=function(t,e){console.log("[HistoryDayData::RecvError] status="+t.status+" statusText="+t.statusText+" responseText="+t.responseText),this.Error={Status:t.status,Message:t.responseText},this.InvokeUpdateUICallback()},this.GetWeekData=function(){if(!this.Data||!this.Data.KLine)return[];var t=this.GetDayPeriodData(1);return t},this.GetMonthData=function(){if(!this.Data||!this.Data.KLine)return[];var t=this.GetDayPeriodData(2);return t},this.GetDayPeriodData=function(t){var e=new Array,a=0,i=null;for(var r in this.Data.KLine){var n=!1,s=this.Data.KLine[r];switch(t){case 1:var o=this.GetFirday(s.Date);o!=a&&(n=!0,a=o);break;case 2:parseInt(s.Date/100)!=parseInt(a/100)&&(n=!0,a=s.Date);break;case 3:parseInt(s.Date/1e4)!=parseInt(a/1e4)&&(n=!0,a=s.Date);break}if(n){if(i={},i.Date=s.Date,e.push(i),null==s.Open||null==s.Close)continue;i.Open=s.Open,i.High=s.High,i.Low=s.Low,i.YClose=s.YClose,i.Close=s.Close,i.Vol=s.Vol,i.Amount=s.Amount}else{if(null==i)continue;if(null==s.Open||null==s.Close)continue;null==i.Open||null==i.Close?(i.Open=s.Open,i.High=s.High,i.Low=s.Low,i.YClose=s.YClose,i.Close=s.Close,i.Vol=s.Vol,i.Amount=s.Amount):(i.High<s.High&&(i.High=s.High),i.Low>s.Low&&(i.Low=s.Low),i.Close=s.Close,i.Vol+=s.Vol,i.Amount+=s.Amount,i.Date=s.Date)}}return e},this.GetFirday=function(t){var e=new Date(parseInt(t/1e4),t/100%100-1,t%100),a=e.getDay();if(5==a)return t;var i=e.getTime();if(a<5){var r=864e5*(5-a);i+=r}else{r=864e5*(a-5);i-=r}e.setTime(i);var n=1e4*e.getFullYear()+100*(e.getMonth()+1)+e.getDate();e.getDay();return n}}function W(t){this.newMethod=V,this.newMethod(),delete this.newMethod,this.Symbol=t,this.ApiUrl=m.Domain+"/API/StockPriceList",this.RequestData=function(){if(this.Symbol){var t=this,e={};Array.isArray(this.Symbol)?e.Symbol=this.Symbol:e.Symbol=[this.Symbol],f.default.ajax({url:this.ApiUrl,data:e,type:"post",dataType:"json",async:!0,success:function(e){t.RecvData(e,P.DEAL_PRICE_LIST_DATA)},fail:function(e){t.RecvError(e,P.DEAL_PRICE_LIST_DATA)}})}},this.RecvData=function(t,e){if(this.Data=null,!(t.statistics.length<=0)){this.Data={Day:{},PriceList:[]};var a=t.data[0];this.Data.Day={Date:a.date,YClose:a.yclose,Price:a.price,Vol:a.vol,Time:a.time},this.Data.Stock={Symbol:a.symbol,Name:a.name};var i=t.statistics[0];for(var r in i.list){var n=i.list[r],s={Price:n[0],Vol:n[1],BuyVol:n[2],SellVol:n[3],NoneVol:n[4]};a.vol>0&&(s.Proportion=s.Vol/a.vol),this.Data.PriceList.push(s)}this.UpdateUICallback&&this.UpdateUICallback(this),this.AutoUpate()}},this.RecvError=function(t,e){}}function U(t){this.newMethod=V,this.newMethod(),delete this.newMethod,this.IsAutoUpdate=!1,this.Symbol=t,this.PageSize=20,this.Request=function(t,e){this.Error=null;var a=this,i=t*e,r=i+e,n=m.Domain+"/API/StockDetail";console.log("[LatestDetailData::RequestData] url="+n+", start="+i+" , end="+r),f.default.ajax({url:n,data:{symbol:this.Symbol,start:i,end:r},type:"post",dataType:"json",async:!0,success:function(t){a.RecvData(t,P.LATEST_DETAIL_DATA)},error:function(t){a.RecvError(t,P.LATEST_DETAIL_DATA)}})},this.RequestData=function(){this.Data={Deal:[],Count:0,Reqeust:{PageIndex:0},Response:{}},this.Request(0,this.PageSize)},this.RequestPage=function(t){this.Data||(this.Data={Deal:[],Count:0}),this.Data.Reqeust={PageIndex:t},this.Data.Response={};for(var e=t*this.PageSize,a=e+this.PageSize,i=!0,r=e;r<a;++r)if(!this.Data.Deal[r]){i=!1;break}i?(this.Data.Response={Start:e,End:a},this.InvokeUpdateUICallback()):this.Request(t,this.PageSize)},this.RecvData=function(t,e){if(this.Data.Count=t.count,t.detail){this.Data.Day={YClose:t.yclose,Open:t.open,Close:t.price,Date:t.date},this.Data.Stock={Symbol:t.symbol,Name:t.name};for(var a=t.start,i=0,r=a;i<t.detail.length;++i,++r){var n=t.detail[i],s={Time:n[0],Price:n[1],Vol:n[2],Amount:n[3],Flag:""};0===n[4]?s.Flag="B":1===n[4]&&(s.Flag="S"),this.Data.Deal[r]=s}this.Data.Response={Start:t.start,End:t.end},this.InvokeUpdateUICallback()}else this.InvokeUpdateUICallback()},this.RecvError=function(t,e){console.log("[LatestDetailData::RecvError] status="+t.status+" statusText="+t.statusText+" responseText="+t.responseText),this.Error={Status:t.status,Message:t.responseText},this.InvokeUpdateUICallback()}}function K(){this.newMethod=V,this.newMethod(),delete this.newMethod,this.ApiUrl=m.Domain+"/api/StockListAnalyze",this.PolicyGuid,this.Plate="",this.SymbolList=[],this.RequestData=function(){var t=this;f.default.ajax({url:t.ApiUrl,data:{PolicyGuid:t.PolicyGuid,Plate:t.Plate,Symbol:t.SymbolList},type:"post",dataType:"json",async:!0,success:function(e){t.RecvData(e)},error:function(e){t.RecvError(e)}})},this.RecvData=function(t){this.Data={};var e=t;if(0!=e.count){if(e.concept){var a=[];for(var i in e.concept.data){var r=e.concept.data[i],n={};n.Name=r[0],n.Symbol=r[1],n.Ratio=r[2],n.Count=r[3],n.Increase=r[4],n.Price=r[5],n.Week1=r[6],n.Week4=r[7],a.push(n)}this.Data.Concept=a}e.distributed&&(this.Data.Distributed=e.distributed),e.industry&&(this.Data.Industry=e.industry),e.quadrant&&(this.Data.Quadrant=e.quadrant),e.region&&(this.Data.Region=e.region),this.UpdateUICallback&&this.UpdateUICallback(this)}},this.RecvError=function(t){console.log(t)}}var J={SH:".SH",SZ:".SZ",HK:".HK",SHFE:".SHF",CFFEX:".CFE",DCE:".DCE",CZCE:".CZC",USA:".USA",IsUSA:function(t){return!!t&&t.indexOf(this.USA)>0},IsSH:function(t){var e=t.length-this.SH.length,a=t.indexOf(this.SH);return a==e},IsSZ:function(t){var e=t.length-this.SZ.length,a=t.indexOf(this.SZ);return a==e},IsHK:function(t){var e=t.length-this.HK.length,a=t.indexOf(this.HK);return a==e},IsSHFE:function(t){return t.indexOf(this.SHFE)>0},IsCFFEX:function(t){return t.indexOf(this.CFFEX)>0},IsDCE:function(t){return t.indexOf(this.DCE)>0},IsCZCE:function(t){return t.indexOf(this.CZCE)>0},IsChinaFutures:function(t){return this.IsCFFEX(t)||this.IsCZCE(t)||this.IsDCE(t)||this.IsSHFE(t)},IsSHSZ:function(t){return this.IsSZ(t)||this.IsSH(t)},IsSHSZFund:function(t){if(!t)return!1;if(this.IsSH(t)){if("5"==t.charAt(0)&&"1"==t.charAt(1))return!0}else if(this.IsSZ(t)&&"1"==t.charAt(0)&&("5"==t.charAt(1)||"6"==t.charAt(1)||"7"==t.charAt(1)||"8"==t.charAt(1)))return!0;return!1},IsSHSZIndex:function(t){if(!t)return!1;var e=t.toUpperCase();if(this.IsSH(e)){var a=e.replace(".SH","");if("0"==e.charAt(0)&&parseInt(a)<=3e3)return!0}else if(this.IsSZ(e)){if("3"==e.charAt(0)&&"9"==e.charAt(1))return!0}else if(e.indexOf(".CI")>0)return!0;return!1},IsSHSZStockA:function(t){if(!t)return!1;var e=t.toUpperCase();if(this.IsSH(e)){e.replace(".SH","");if("6"==e.charAt(0))return!0}else if(this.IsSZ(e)&&"0"==e.charAt(0)){if("0"==e.charAt(1)&&"2"==e.charAt(1))return!0;if("7"!=e.charAt(1)&&"8"!=e.charAt(1))return!0}return!1},IsSHStockSTAR:function(t){if(!t)return!1;var e=t.toUpperCase();return!!this.IsSH(e)&&("6"==e.charAt(0)&&"8"==e.charAt(1)&&"8"==e.charAt(2))},GetMarketStatus:function(t){if(!t)return 0;var e=t.toUpperCase();if(this.IsUSA(e)){var a=GetLocalTime(-4);return r=a.getDay(),n=100*a.getHours()+a.getMinutes(),6==r||0==r?0:n>1730?3:n<930?1:2}var i=new Date,r=i.getDay(),n=100*i.getHours()+i.getMinutes();return 6==r||0==r?0:n>1540?3:n<925?1:2}};e.default=(i={JSStockInit:b.Init,STOCK_FIELD_NAME:N,JSStock:b,StockRead:O},(0,n.default)(i,"STOCK_FIELD_NAME",N),(0,n.default)(i,"RECV_DATA_TYPE",P),i)},d04b:function(t,e){t.exports=!0},d291:function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},d54d:function(t,e,a){"use strict";var i=a("db81");t.exports=function(t){i(i.S,t,{of:function(){var t=arguments.length,e=new Array(t);while(t--)e[t]=arguments[t];return new this(e)}})}},d8ec:function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},d8ed:function(t,e){var a=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=a)},d922:function(t,e,a){var i,r,n,s=a("ccbf"),o=a("0a9b"),h=a("e4a9"),l=a("c023"),u=a("d8ed"),C=u.process,D=u.setImmediate,f=u.clearImmediate,c=u.MessageChannel,d=u.Dispatch,m=0,v={},S="onreadystatechange",I=function(){var t=+this;if(v.hasOwnProperty(t)){var e=v[t];delete v[t],e()}},p=function(t){I.call(t.data)};D&&f||(D=function(t){var e=[],a=1;while(arguments.length>a)e.push(arguments[a++]);return v[++m]=function(){o("function"==typeof t?t:Function(t),e)},i(m),m},f=function(t){delete v[t]},"process"==a("e1b6")(C)?i=function(t){C.nextTick(s(I,t,1))}:d&&d.now?i=function(t){d.now(s(I,t,1))}:c?(r=new c,n=r.port2,r.port1.onmessage=p,i=s(n.postMessage,n,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(i=function(t){u.postMessage(t+"","*")},u.addEventListener("message",p,!1)):i=S in l("script")?function(t){h.appendChild(l("script"))[S]=function(){h.removeChild(this),I.call(t)}}:function(t){setTimeout(s(I,t,1),0)}),t.exports={set:D,clear:f}},d933:function(t,e,a){t.exports={default:a("7992"),__esModule:!0}},db81:function(t,e,a){var i=a("d8ed"),r=a("2194"),n=a("ccbf"),s=a("7737"),o=a("e3b0"),h="prototype",l=function(t,e,a){var u,C,D,f=t&l.F,c=t&l.G,d=t&l.S,m=t&l.P,v=t&l.B,S=t&l.W,I=c?r:r[e]||(r[e]={}),p=I[h],T=c?i:d?i[e]:(i[e]||{})[h];for(u in c&&(a=e),a)C=!f&&T&&void 0!==T[u],C&&o(I,u)||(D=C?T[u]:a[u],I[u]=c&&"function"!=typeof T[u]?a[u]:v&&C?n(D,i):S&&T[u]==D?function(t){var e=function(e,a,i){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,a)}return new t(e,a,i)}return t.apply(this,arguments)};return e[h]=t[h],e}(D):m&&"function"==typeof D?n(Function.call,D):D,m&&((I.virtual||(I.virtual={}))[u]=D,t&l.R&&p&&!p[u]&&s(p,u,D)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},db84:function(t,e,a){var i=a("db81");i(i.P+i.R,"Set",{toJSON:a("9c30")("Set")})},dd0f:function(t,e,a){"use strict";var i=a("db81"),r=a("d291"),n=a("ccbf"),s=a("23e3");t.exports=function(t){i(i.S,t,{from:function(t){var e,a,i,o,h=arguments[1];return r(this),e=void 0!==h,e&&r(h),void 0==t?new this:(a=[],e?(i=0,o=n(h,arguments[2],2),s(t,!1,(function(t){a.push(o(t,i++))}))):s(t,!1,a.push,a),new this(a))}})}},df7e:function(t,e,a){"use strict";a.r(e);var i=a("e11c"),r=a.n(i);for(var n in i)"default"!==n&&function(t){a.d(e,t,(function(){return i[t]}))}(n);e["default"]=r.a},dff4:function(t,e,a){var i=a("fd84"),r=a("9b21").f,n={}.toString,s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],o=function(t){try{return r(t)}catch(e){return s.slice()}};t.exports.f=function(t){return s&&"[object Window]"==n.call(t)?o(t):r(i(t))}},e003:function(t,e,a){a("d54d")("Map")},e11c:function(t,e,a){"use strict";var i=a("4ea4");a("d81d"),a("e25e"),a("ac1f"),a("1276"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=i(a("5530")),n=i(a("ae44"));function s(t){for(var e=0;e<t.mp.touches.length;e+=1){var a=t.mp.touches[e];a.offsetX=a.x,a.offsetY=a.y}return t}var o={props:{echarts:{required:!0,type:Object,default:function(){return null}},onInit:{type:Function,default:null},canvasId:{type:String,default:"ec-canvas"},lazyLoad:{type:Boolean,default:!1},disableTouch:{type:Boolean,default:!1},throttleTouch:{type:Boolean,default:!1}},onReady:function(){this.echarts?this.lazyLoad||this.init():console.warn('ç»ä»¶éç»å® echarts åéï¼ä¾ï¼<ec-canvas id="mychart-dom-bar" canvas-id="mychart-bar" :echarts="echarts"></ec-canvas>')},methods:{init:function(t){var e=this,a=wx.version.version.split(".").map((function(t){return parseInt(t,10)})),i=a[0]>1||1===a[0]&&a[1]>9||1===a[0]&&9===a[1]&&a[2]>=91;if(i){var r=this.canvasId;this.ctx=wx.createCanvasContext(r);var s=new n.default(this.ctx,r);this.echarts.setCanvasCreator((function(){return s}));var o=wx.createSelectorQuery();o.select("#".concat(r)).boundingClientRect((function(a){if(a){var i=a.width,r=a.height;if("function"===typeof t?e.chart=t(s,i,r):"function"===typeof e.onInit&&(e.chart=e.onInit(s,i,r)),e.chart){var n=e.chart.getZr(),o=n.handler;e.handler=o,e.processGesture=o.proxy.processGesture||function(){}}}else setTimeout((function(){return e.init()}),50)})).exec()}else console.error("å¾®ä¿¡åºç¡åºçæ¬è¿ä½ï¼éå¤§äºç­äº 1.9.91ãåè§ï¼https://github.com/ecomfe/echarts-for-weixin#%E5%BE%AE%E4%BF%A1%E7%89%88%E6%9C%AC%E8%A6%81%E6%B1%82")},canvasToTempFilePath:function(t){var e=this.canvasId;this.ctx.draw(!0,(function(){wx.canvasToTempFilePath((0,r.default)({canvasId:e},t))}))},touchStart:function(t){var e=this.disableTouch,a=this.chart;if(!e&&a&&t.mp.touches.length){var i=t.mp.touches[0];this.handler.dispatch("mousedown",{zrX:i.x,zrY:i.y}),this.handler.dispatch("mousemove",{zrX:i.x,zrY:i.y}),this.processGesture(s(t),"start")}},touchMove:function(t){var e=this.disableTouch,a=this.throttleTouch,i=this.chart,r=this.lastMoveTime;if(!e&&i&&t.mp.touches.length){if(a){var n=Date.now();if(n-r<240)return;this.lastMoveTime=n}var o=t.mp.touches[0];this.handler.dispatch("mousemove",{zrX:o.x,zrY:o.y}),this.processGesture(s(t),"change")}},touchEnd:function(t){var e=this.disableTouch,a=this.chart;if(!e&&a){var i=t.mp.changedTouches?t.mp.changedTouches[0]:{};this.handler.dispatch("mouseup",{zrX:i.x,zrY:i.y}),this.handler.dispatch("click",{zrX:i.x,zrY:i.y}),this.processGesture(s(t),"end")}}}};e.default=o},e1b6:function(t,e){var a={}.toString;t.exports=function(t){return a.call(t).slice(8,-1)}},e3b0:function(t,e){var a={}.hasOwnProperty;t.exports=function(t,e){return a.call(t,e)}},e42f:function(t,e,a){var i=a("1b2a"),r=a("a12e")("iterator"),n=Array.prototype;t.exports=function(t){return void 0!==t&&(i.Array===t||n[r]===t)}},e472:function(t,e,a){var i=a("e3b0"),r=a("fd84"),n=a("8788")(!1),s=a("3a23")("IE_PROTO");t.exports=function(t,e){var a,o=r(t),h=0,l=[];for(a in o)a!=s&&i(o,a)&&l.push(a);while(e.length>h)i(o,a=e[h++])&&(~n(l,a)||l.push(a));return l}},e4a9:function(t,e,a){var i=a("d8ed").document;t.exports=i&&i.documentElement},e93b:function(t,e,a){var i=a("db81");i(i.S+i.F*!a("be29"),"Object",{defineProperties:a("9f34")})},ea39:function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},ee8a:function(t,e,a){var i=a("0ef2"),r=a("b22c"),n=a("8144");t.exports=function(t){var e=i(t),a=r.f;if(a){var s,o=a(t),h=n.f,l=0;while(o.length>l)h.call(t,s=o[l++])&&e.push(s)}return e}},f67a:function(t,e,a){"use strict";var i=a("db81"),r=a("2194"),n=a("d8ed"),s=a("c1a3"),o=a("7e32");i(i.P+i.R,"Promise",{finally:function(t){var e=s(this,r.Promise||n.Promise),a="function"==typeof t;return this.then(a?function(a){return o(e,t()).then((function(){return a}))}:t,a?function(a){return o(e,t()).then((function(){throw a}))}:t)}})},f7a9:function(t,e,a){var i=a("d8ed"),r=a("2194"),n=a("d04b"),s=a("66f0"),o=a("9492").f;t.exports=function(t){var e=r.Symbol||(r.Symbol=n?{}:i.Symbol||{});"_"==t.charAt(0)||t in e||o(e,t,{value:s.f(t)})}},f7bd:function(t,e,a){"use strict";var i=a("ccbf"),r=a("db81"),n=a("8494"),s=a("3762"),o=a("e42f"),h=a("91d6"),l=a("847c"),u=a("295c");r(r.S+r.F*!a("a52e")((function(t){Array.from(t)})),"Array",{from:function(t){var e,a,r,C,D=n(t),f="function"==typeof this?this:Array,c=arguments.length,d=c>1?arguments[1]:void 0,m=void 0!==d,v=0,S=u(D);if(m&&(d=i(d,c>2?arguments[2]:void 0,2)),void 0==S||f==Array&&o(S))for(e=h(D.length),a=new f(e);e>v;v++)l(a,v,m?d(D[v],v):D[v]);else for(C=S.call(D),a=new f;!(r=C.next()).done;v++)l(a,v,m?s(C,d,[r.value,v],!0):r.value);return a.length=v,a}})},f7cb:function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},f98a:function(t,e,a){var i=a("910c"),r=a("9fff");t.exports=function(t){return function(e,a){var n,s,o=String(r(e)),h=i(a),l=o.length;return h<0||h>=l?t?"":void 0:(n=o.charCodeAt(h),n<55296||n>56319||h+1===l||(s=o.charCodeAt(h+1))<56320||s>57343?t?o.charAt(h):n:t?o.slice(h,h+2):s-56320+(n-55296<<10)+65536)}}},fab1:function(t,e){t.exports=function(t){return"object"===typeof t?null!==t:"function"===typeof t}},fb59:function(t,e,a){var i=a("910c"),r=Math.max,n=Math.min;t.exports=function(t,e){return t=i(t),t<0?r(t+e,0):n(t,e)}},fb65:function(t,e,a){var i=a("8144"),r=a("d8ec"),n=a("fd84"),s=a("73ff"),o=a("e3b0"),h=a("97f9"),l=Object.getOwnPropertyDescriptor;e.f=a("be29")?l:function(t,e){if(t=n(t),e=s(e,!0),h)try{return l(t,e)}catch(a){}if(o(t,e))return r(!i.f.call(t,e),t[e])}},fd84:function(t,e,a){var i=a("374f"),r=a("9fff");t.exports=function(t){return i(r(t))}},fefb:function(t,e,a){var i=a("c7a9"),r=a("295c");t.exports=a("2194").getIterator=function(t){var e=r(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return i(e.call(t))}}}]);